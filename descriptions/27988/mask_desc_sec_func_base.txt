void ndpi_free_flow(struct ndpi_flow_struct *flow) {
  if(flow) {
    // Release the memory allocated for various protocol-specific buffers associated
    // with the flow object, if they are not already freed. This includes freeing
    // buffers related to HTTP data, Kerberos packets, and if applicable, buffers
    // related to TLS/SSL or QUIC protocols. This ensures that all dynamically
    // allocated resources tied to the flow are properly deallocated before the
    // flow itself is freed.
    // <MASK>

    if(flow->l4_proto == IPPROTO_TCP) {
      if(flow->l4.tcp.tls.message.buffer)
	ndpi_free(flow->l4.tcp.tls.message.buffer);
    }

    ndpi_free(flow);
  }
}