// Here are some relevant code fragments from other files of the repo:

// the below code fragment can be found in:
// src/lib/libdwarf/dwarf_form.c
static void
show_not_ref_error(Dwarf_Debug dbg,
    Dwarf_Error *error,
    Dwarf_Half form,
    Dwarf_Half attr)
{
    dwarfstring m;
    const char *fname = 0;
    const char *aname = 0;

    /*DW_DLE_NOT_REF_FORM */
    dwarfstring_constructor(&m);
    
    dwarf_get_FORM_name(form,&fname);
    dwarf_get_AT_name(attr,&aname);
    dwarfstring_append(&m,"DW_DLE_NOT_REF_FORM: ");
    dwarfstring_append(&m,(char *)fname);
    dwarfstring_append_printf_s(&m," (on attribute %s )",
        (char *)aname);
    dwarfstring_append(&m," for versions >= 4 ");
    dwarfstring_append(&m,"is not a valid reference form");
    _dwarf_error_string(dbg,error,DW_DLE_NOT_REF_FORM,
        dwarfstring_string(&m));
    dwarfstring_destructor(&m);
}

// the below code fragment can be found in:
// src/lib/libdwarf/dwarf_die_deliv.c
static int
is_cu_tag(int t)
{
    if (t == DW_TAG_compile_unit  ||
        t == DW_TAG_partial_unit  ||
        t == DW_TAG_skeleton_unit ||
        t == DW_TAG_type_unit) {
        return 1;
    }
    return 0;
}

// the below code fragment can be found in:
// src/lib/libdwarf/dwarf_die_deliv.c
static int
reloc_incomplete(int res,Dwarf_Error err)
{
    Dwarf_Unsigned e = 0;

    if (res == DW_DLV_OK) {
        return FALSE;
    }
    if (res == DW_DLV_NO_ENTRY) {
        return FALSE;
    }
    e = dwarf_errno(err);
    switch(e) {
    case DW_DLE_RELOC_MISMATCH_INDEX:
    case DW_DLE_RELOC_MISMATCH_RELOC_INDEX:
    case DW_DLE_RELOC_MISMATCH_STRTAB_INDEX:
    case DW_DLE_RELOC_SECTION_MISMATCH:
    case DW_DLE_RELOC_SECTION_MISSING_INDEX:
    case DW_DLE_RELOC_SECTION_LENGTH_ODD:
    case DW_DLE_RELOC_SECTION_PTR_NULL:
    case DW_DLE_RELOC_SECTION_MALLOC_FAIL:
    case DW_DLE_SEEK_OFF_END:
    case DW_DLE_RELOC_INVALID:
    case DW_DLE_RELOC_SECTION_SYMBOL_INDEX_BAD:
    case DW_DLE_ELF_RELOC_SECTION_ERROR:
    case DW_DLE_RELOCATION_SECTION_SIZE_ERROR:
        return TRUE;
    default: break;
    }
    return FALSE;
}

// the below code fragment can be found in:
// src/lib/libdwarf/dwarf_query.c
int
dwarf_bytesize(Dwarf_Die die,
    Dwarf_Unsigned *ret_size, Dwarf_Error *error)
{
    Dwarf_Unsigned luns = 0;
    int res = _dwarf_die_attr_unsigned_constant(die, DW_AT_byte_size,
        &luns, error);
    *ret_size = luns;
    return res;
}

// the below code fragment can be found in:
// src/lib/libdwarf/dwarf_loc.c
int
dwarf_get_loclist_head_kind(Dwarf_Loc_Head_c ll_header,
    unsigned int * kind,
    Dwarf_Error  * error)
{
    if (!ll_header) {
        _dwarf_error_string(NULL, error,DW_DLE_DBG_NULL,
            "DW_DLE_DBG_NULL: "
            "NULL Dwarf_Loc_Head_c "
            "argument passed to "
            "dwarf_get_loclist_head_kind()");
        return DW_DLV_ERROR;
    }
    *kind = ll_header->ll_kind;
    return DW_DLV_OK;
}

