static int add_candidate_ref(HEVCContext *s, RefPicList *list,
                             int poc, int ref_flag)
{
    // Attempt to find a reference frame for the given Picture Order Count (POC).
    // If the reference frame is invalid, return an error indicating invalid data.
    // If the reference frame does not exist, generate a missing reference frame.
    // If generating the missing reference frame fails, return an error indicating memory allocation failure.
    // Continue processing only if a valid reference frame is obtained.
    // <MASK>

    list->list[list->nb_refs] = ref->poc;
    list->ref[list->nb_refs]  = ref;
    list->nb_refs++;

    mark_ref(ref, ref_flag);
    return 0;
}