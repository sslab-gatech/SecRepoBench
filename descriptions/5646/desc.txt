// Null-terminate the token string.
  token[i]='\0';

  // Check if the token starts with "url(" and has more than four or five characters.
  // If true, extract the actual URL by skipping the "url(" prefix and optional '#' character.
  // Then copy the URL to the beginning of the token string, replacing the original content.
  if ((LocaleNCompare(token,"url(",4) == 0) && (strlen(token) > 4))  // Snippet 1
  // if ((LocaleNCompare(token,"url(",4) == 0) && (strlen(token) > 5))  // Snippet 2
  {
    ssize_t
      offset;

    // Set the initial offset to skip "url(" and adjust for optional '#'.
    offset=4;
    if (token[offset] == '#')
      offset++;

    // Calculate the length of the original token and copy the relevant part.
    i=(ssize_t) strlen(token);
    (void) CopyMagickString(token,token+offset,MagickPathExtent);
    
    // Adjust the length of the token to exclude the trailing ')' character.
    token[i-offset-1]='\0';
  }