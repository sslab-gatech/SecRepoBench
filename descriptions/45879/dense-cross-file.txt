// Here are some relevant code fragments from other files of the repo:

// the below code fragment can be found in:
// include/fluent-bit/flb_mem.h
static inline FLB_ALLOCSZ_ATTR(1)
void *flb_malloc(const size_t size) {

#ifdef FLB_HAVE_TESTS_OSSFUZZ
   // 1% chance of failure
   if (flb_fuzz_get_probability(1)) {
     return NULL;
   }

// the below code fragment can be found in:
// include/fluent-bit/flb_router.h
static inline int flb_router_match_type(int in_event_type,
                                        struct flb_output_instance *ins)
{
    if (in_event_type == FLB_INPUT_LOGS &&
        !(ins->event_type & FLB_OUTPUT_LOGS)) {
        return FLB_FALSE;
    }
    else if (in_event_type == FLB_INPUT_METRICS &&
             !(ins->event_type & FLB_OUTPUT_METRICS)) {
        return FLB_FALSE;
    }

    return FLB_TRUE;
}

// the below code fragment can be found in:
// include/fluent-bit/flb_log.h
static inline int flb_log_check_level(int level_set, int msg_level)
{
    if (msg_level <= level_set) {
        return FLB_TRUE;
    }

    return FLB_FALSE;
}

// the below code fragment can be found in:
// include/fluent-bit/flb_log.h
static inline int flb_log_check(int l) {
    struct flb_worker *w;
    w = (struct flb_worker *) FLB_TLS_GET(flb_worker_ctx);
    if (!w && l <= 3) {
        return FLB_TRUE;
    }

    if (w == NULL || flb_worker_log_level(w) < l) {
        return FLB_FALSE;
    }
    return FLB_TRUE;
}

// the below code fragment can be found in:
// src/flb_scheduler.c
{
#else
    if (ret <= 0) {
#endif
        flb_errno();
        return -1;
    }

    return 0;
}

