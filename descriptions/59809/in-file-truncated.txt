#ifndef PACKETPP_TLV_DATA
#define PACKETPP_TLV_DATA

#include "Layer.h"
#include "IpAddress.h"
#include <string.h>

/// @file

/**
 * \namespace pcpp
 * \brief The main namespace for the PcapPlusPlus lib
 */
namespace pcpp
{
	/**
	 * @class TLVRecord
	 * A wrapper class for a Type-Length-Value (TLV) record. This class does not create or modify TLV records, but rather
	 * serves as a wrapper and provides useful methods for retrieving data from them. This class has several abstract methods
	 * that should be implemented in derived classes. These methods are for record length value calculation (the 'L' in TLV)
	 * which is implemented differently in different protocols
	 */
	template<typename TRecType, typename TRecLen>
	class TLVRecord
	{
	protected:

		/** A struct representing the TLV construct */
		struct TLVRawData
		{
			/** Record type */
			TRecType recordType;
			/** Record length in bytes */
			TRecLen recordLen;
			/** Record value (variable size) */
			uint8_t recordValue[];
		};

		TLVRawData* m_Data;

	public:

		/**
		 * A c'tor for this class that gets a pointer to the TLV record raw data (byte array)
		 * @param[in] recordRawData A pointer to the TLV record raw data
		 */
		TLVRecord(uint8_t* recordRawData)
		{
			assign(recordRawData);
		}

		/**
		 * A copy c'tor for this class. This copy c'tor doesn't copy the TLV data, but only the pointer to it,
		 * which means that after calling it both the old and the new instance will point to the same TLV raw data
		 * @param[in] other The TLVRecord instance to copy from
		 */
		TLVRecord(const TLVRecord& other)
		{
			m_Data = other.m_Data;
		}

		/**
		 * A d'tor for this class, currently does nothing
		 */
		virtual ~TLVRecord() { }

		/**
		 * Assign a pointer to the TLV record raw data (byte array)
		 * @param[in] recordRawData A pointer to the TLV record raw data
		 */
		void assign(uint8_t* recordRawData)
		{
			if(recordRawData == NULL)
				m_Data = NULL;
			else
				m_Data = (TLVRawData*)recordRawData;
		}

		/**
		 * Overload of the assignment operator. This operator doesn't copy the TLV data, but rather copies the pointer to it,
		 * which means that after calling it both the old and the new instance will point to the same TLV raw data
		 * @param[in] other The TLV

// --- CODE TRUNCATED HERE ---

TLVRecordType getFirstTLVRecord(uint8_t* tlvDataBasePtr, size_t tlvDataLength) const
		{
			// Get the first TLV record out of a byte stream.
			// Return a instance of type TLVRecordType that contains the first TLV record.
			// If tlvDataBasePtr is NULL or tlv data length is zero the returned TLVRecordType 
			// instance will be logically NULL, meaning TLVRecordType.isNull() will return true.
			// <MASK>
		}