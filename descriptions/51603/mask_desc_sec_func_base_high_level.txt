private int
parse_strength(struct magic_set *ms, struct magic_entry *me, const char *line,
    size_t len __attribute__((__unused__)))
{
	const char *l = line;
	char *el;
	unsigned long factor;
	// Initialize a pointer to the first magic structure in the magic entry array.
	// Check if the current magic entry already has a strength operation defined,
	// and if so, issue a warning and return an error. Ensure that the strength
	// setting is not applied to "name" type magic entries, issuing a warning and
	// returning an error if it is. Skip any whitespace in the input line. Determine
	// the type of factor operation specified by the character at the current position
	// in the input line and update the magic structure with this operation if it's valid.
	// If the factor operation character is not recognized, issue a warning and return an error.
	// <MASK>
	EATAB;
	factor = strtoul(l, &el, 0);
	if (factor > 255) {
		file_magwarn(ms, "Too large factor `%lu'", factor);
		goto out;
	}
	if (*el && !isspace(CAST(unsigned char, *el))) {
		file_magwarn(ms, "Bad factor `%s'", l);
		goto out;
	}
	m->factor = CAST(uint8_t, factor);
	if (m->factor == 0 && m->factor_op == FILE_FACTOR_OP_DIV) {
		file_magwarn(ms, "Cannot have factor op `%c' and factor %u",
		    m->factor_op, m->factor);
		goto out;
	}
	return 0;
out:
	m->factor_op = FILE_FACTOR_OP_NONE;
	m->factor = 0;
	return -1;
}