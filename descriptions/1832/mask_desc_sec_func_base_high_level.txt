static int read_matrix_params(MLPDecodeContext *m, unsigned int substr, GetBitContext *gbp)
{
    SubStream *s = &m->substream[substr];
    unsigned int mat, ch;
    const int max_primitive_matrices = m->avctx->codec_id == AV_CODEC_ID_MLP
                                     ? MAX_MATRICES_MLP
                                     : MAX_MATRICES_TRUEHD;

    if (m->matrix_changed++ > 1) {
        av_log(m->avctx, AV_LOG_ERROR, "Matrices may change only once per access unit.\n");
        return AVERROR_INVALIDDATA;
    }

    s->num_primitive_matrices = get_bits(gbp, 4);

    // Validate the number of primitive matrices against the maximum allowed value.
    // For each primitive matrix, read and validate properties such as output channel,
    // fractional bits, and least significant bit bypass flag from the bitstream.
    // Ensure output channel and fractional bits are within valid ranges.
    // Calculate and store matrix coefficients for the channel, scaling them based on
    // the fractional bits read. If noise is enabled, retrieve the noise shift value;
    // otherwise, set it to zero. Handle errors by resetting the number of matrices
    // and returning an error code.
    // <MASK>
}