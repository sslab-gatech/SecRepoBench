void ndpi_parse_packet_line_info(struct ndpi_detection_module_struct *ndpi_str, struct ndpi_flow_struct *flow) {
  u_int32_t a;
  struct ndpi_packet_struct *packet = &flow->packet;
    
  if((packet->payload_packet_len < 3) || (packet->payload == NULL))
    return;

  if(packet->packet_lines_parsed_complete != 0)
    return;

  packet->packet_lines_parsed_complete = 1;
  ndpi_reset_packet_line_info(packet);

  packet->line[packet->parsed_lines].ptr = packet->payload;
  packet->line[packet->parsed_lines].len = 0;

  // Parse the payload of a packet to identify and extract lines separated by the CR+NL ("\r\n") sequence.
  // For each line found, determine its length and attempt to parse HTTP header lines such as "Server:",
  // "Host:", "Content-Type:", etc., extracting key information and updating appropriate packet structures.
  // If a double CR+NL ("\r\n\r\n") sequence is detected, handle it as a possible end of headers section
  // in HTTP, and store any subsequent binary data. Update packet information regarding the lines parsed
  // and any HTTP-specific data identified. The parsing loop continues until either all payload bytes are
  // processed or a maximum number of lines is reached.
  // <MASK>

  if(packet->parsed_lines >= 1) {
    packet->line[packet->parsed_lines].len =
      (u_int16_t)(((unsigned long) &packet->payload[packet->payload_packet_len]) -
		  ((unsigned long) packet->line[packet->parsed_lines].ptr));
    packet->parsed_lines++;
  }
}