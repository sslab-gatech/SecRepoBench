unsigned int len = *ptr++;

  if (len > maxlen)
    return NULL;