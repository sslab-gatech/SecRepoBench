To prevent buffer overflow in this context, ensure that any arithmetic operations affecting memory allocation, such as those involving `points_extent`, are carefully validated to prevent excessive values. Specifically, verify that the computation of `points_extent` uses operations that won't result in unexpectedly large allocations, and consider using safe mathematical approximations or limits to maintain controlled buffer sizes.