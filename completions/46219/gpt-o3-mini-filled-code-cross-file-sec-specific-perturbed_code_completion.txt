{
  const StringInfo
    *profile_info;

  size_t
    profile_length;

  profile_info=GetImageProfile(image,"icc");
  if (profile_info == (StringInfo *) NULL)
    profile_info=GetImageProfile(image,"icm");
  if (profile_info == (StringInfo *) NULL)
    return((const char *) NULL);
  profile_length=GetStringInfoLength(profile_info);
  if (profile_length < 128)
    return((const char *) NULL);

#ifdef LCMS
  {
    cmsHPROFILE
      hProfile;

    hProfile=cmsOpenProfileFromMem((cmsUInt8Number *) GetStringInfoDatum(profile_info),
                                    (cmsUInt32Number) profile_length);
    if (hProfile != NULL)
      {
        const char
          *description,
          *manufacturer,
          *model,
          *copyright;

        description=cmsGetProfileInfoASCII(hProfile,cmsInfoDescription);
        manufacturer=cmsGetProfileInfoASCII(hProfile,cmsInfoManufacturer);
        model=cmsGetProfileInfoASCII(hProfile,cmsInfoModel);
        copyright=cmsGetProfileInfoASCII(hProfile,cmsInfoCopyright);

        cmsCloseProfile(hProfile);

        if (description != (const char *) NULL)
          (void) SetImageProperty((Image *) image, "profile-icc-description", description);
        if (manufacturer != (const char *) NULL)
          (void) SetImageProperty((Image *) image, "profile-icc-manufacturer", manufacturer);
        if (model != (const char *) NULL)
          (void) SetImageProperty((Image *) image, "profile-icc-model", model);
        if (copyright != (const char *) NULL)
          (void) SetImageProperty((Image *) image, "profile-icc-copyright", copyright);

        return(GetImageProperty((Image *) image, "profile-icc-description", exception_info));
      }
  }
#endif
  return((const char *) NULL);
}