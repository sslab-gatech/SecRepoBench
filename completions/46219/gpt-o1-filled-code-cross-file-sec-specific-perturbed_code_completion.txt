const StringInfo *icc_profile;

  /*
    Attempt to retrieve the ICC profile from the image using "icc" or
    "icm". If none is found or the profile is too small, return NULL.
  */
  icc_profile=GetImageProfile(image,"icc");
  if (icc_profile == (const StringInfo *) NULL)
    icc_profile=GetImageProfile(image,"icm");
  if (icc_profile == (const StringInfo *) NULL)
    return((const char *) NULL);
  if (GetStringInfoLength(icc_profile) < 128)
    return((const char *) NULL);

  /*
    Remove existing ICC-related properties to avoid stale data.
  */
  (void) DeleteImageProperty((Image *) image,"icc:description");
  (void) DeleteImageProperty((Image *) image,"icc:manufacturer");
  (void) DeleteImageProperty((Image *) image,"icc:model");
  (void) DeleteImageProperty((Image *) image,"icc:copyright");

#if defined(MAGICKCORE_LCMS_DELEGATE)
  {
    cmsHPROFILE cms_profile = cmsOpenProfileFromMem(
      GetStringInfoDatum(icc_profile),
      (cmsUInt32Number) GetStringInfoLength(icc_profile));
    if (cms_profile != (cmsHPROFILE) NULL)
      {
        char info[MagickPathExtent];

        if (cmsGetProfileInfoASCII(cms_profile,cmsInfoDescription,"en","US",
            info,MagickPathExtent) > 0)
          (void) SetImageProperty((Image *) image,"icc:description",info);

        if (cmsGetProfileInfoASCII(cms_profile,cmsInfoManufacturer,"en","US",
            info,MagickPathExtent) > 0)
          (void) SetImageProperty((Image *) image,"icc:manufacturer",info);

        if (cmsGetProfileInfoASCII(cms_profile,cmsInfoModel,"en","US",
            info,MagickPathExtent) > 0)
          (void) SetImageProperty((Image *) image,"icc:model",info);

        if (cmsGetProfileInfoASCII(cms_profile,cmsInfoCopyright,"en","US",
            info,MagickPathExtent) > 0)
          (void) SetImageProperty((Image *) image,"icc:copyright",info);

        cmsCloseProfile(cms_profile);
      }
  }
#endif

  /*
    Finally, return the requested property stored in the image.
  */
  return(GetImageProperty(image,key,exception_info));