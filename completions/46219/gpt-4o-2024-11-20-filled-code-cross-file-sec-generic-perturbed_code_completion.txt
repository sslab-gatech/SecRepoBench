const StringInfo
    *profile;

  MagickBooleanType
    status;

  profile=GetImageProfile(image,"icc");
  if (profile == (StringInfo *) NULL)
    profile=GetImageProfile(image,"icm");
  if (profile == (StringInfo *) NULL)
    return((const char *) NULL);

  if (GetStringInfoLength(profile) < 128)
    {
      (void) ThrowMagickException(exception_info,GetMagickModule(),
        OptionError,"InvalidProfile","`%s'","ICC profile is too small");
      return((const char *) NULL);
    }

#if defined(MAGICKCORE_LCMS_DELEGATE)
  {
    cmsHPROFILE
      icc_profile;

    icc_profile=cmsOpenProfileFromMem(GetStringInfoDatum(profile),
      (cmsUInt32Number) GetStringInfoLength(profile));
    if (icc_profile == (cmsHPROFILE) NULL)
      {
        (void) ThrowMagickException(exception_info,GetMagickModule(),
          OptionError,"InvalidProfile","`%s'","Unable to open ICC profile");
        return((const char *) NULL);
      }

    char
      property[MagickPathExtent];

    cmsUInt32Number
      length;

    length=cmsGetProfileInfoASCII(icc_profile,cmsInfoDescription,"en","US",
      property,MagickPathExtent);
    if (length > 0)
      (void) SetImageProperty(image,"icc:description",property,exception_info);

    length=cmsGetProfileInfoASCII(icc_profile,cmsInfoManufacturer,"en","US",
      property,MagickPathExtent);
    if (length > 0)
      (void) SetImageProperty(image,"icc:manufacturer",property,exception_info);

    length=cmsGetProfileInfoASCII(icc_profile,cmsInfoModel,"en","US",
      property,MagickPathExtent);
    if (length > 0)
      (void) SetImageProperty(image,"icc:model",property,exception_info);

    length=cmsGetProfileInfoASCII(icc_profile,cmsInfoCopyright,"en","US",
      property,MagickPathExtent);
    if (length > 0)
      (void) SetImageProperty(image,"icc:copyright",property,exception_info);

    cmsCloseProfile(icc_profile);
  }
#endif
  return(GetImageProperty(image,key,exception_info));