const StringInfo
  *profile;

profile=GetImageProfile(image,"icc");
if (profile == (StringInfo *) NULL)
  profile=GetImageProfile(image,"icm");
if (profile != (StringInfo *) NULL)
  {
    size_t length=GetStringInfoLength(profile);
    if (length >= 32)
      {
#ifdef LCMS_DEVELOPER_VERSION
        cmsHPROFILE lcms_profile;
        char desc[512], mfg[512], model[512], cprt[512];
        int ret;

        lcms_profile=cmsOpenProfileFromMem(GetStringInfoDatum(profile),
          GetStringInfoLength(profile));
        if (lcms_profile != NULL)
          {
            ret=cmsGetProfileInfo(lcms_profile,cmsInfoDescription,
              cmsAnyLanguage,cmsNoLocal,desc,sizeof(desc));
            if (ret && strlen(desc) > 0)
              (void) SetImageProperty(image,"icc:description",desc,
                exception);
            ret=cmsGetProfileInfo(lcms_profile,cmsInfoManufacturer,
              cmsAnyLanguage,cmsNoLocal,mfg,sizeof(mfg));
            if (ret && strlen(mfg) > 0)
              (void) SetImageProperty(image,"icc:manufacturer",mfg,exception);
            ret=cmsGetProfileInfo(lcms_profile,cmsInfoModel,
              cmsAnyLanguage,cmsNoLocal,model,sizeof(model));
            if (ret && strlen(model) > 0)
              (void) SetImageProperty(image,"icc:model",model,exception);
            ret=cmsGetProfileInfo(lcms_profile,cmsInfoCopyright,
              cmsAnyLanguage,cmsNoLocal,cprt,sizeof(cprt));
            if (ret && strlen(cprt) > 0)
              (void) SetImageProperty(image,"icc:copyright",cprt,exception);
            cmsCloseProfile(lcms_profile);
          }
#endif
      }
  }
return(GetImageProperty(image,key,exception));