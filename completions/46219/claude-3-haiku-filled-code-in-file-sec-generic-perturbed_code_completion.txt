static const char *GetICCProperty(const Image *image,const char *key,
  ExceptionInfo *exception_info)
{
  const StringInfo *profile;
  const char *value = NULL;

  // Retrieve ICC profile from the image
  profile = GetImageProfile(image, "icc");
  if (profile == NULL)
    profile = GetImageProfile(image, "icm");
  if (profile == NULL)
    return NULL;

  // Ensure the profile length is adequate for processing
  if (GetStringInfoLength(profile) < sizeof(cmsHPROFILE))
    return NULL;

  #if defined(MAGICKCORE_LCMS_DELEGATE)
  {
    cmsHPROFILE icc_profile;
    char buffer[MagickPathExtent];

    // Open the ICC profile and extract profile information
    icc_profile = cmsOpenProfileFromMem(GetStringInfoDatum(profile),
      (cmsUInt32Number)GetStringInfoLength(profile));
    if (icc_profile != NULL)
    {
      #if defined(LCMS_VERSION) && (LCMS_VERSION < 2000)
      value = cmsTakeProductName(icc_profile);
      #else
      if (cmsGetProfileInfoASCII(icc_profile, cmsInfoDescription, "en", "US",
          buffer, sizeof(buffer)) != 0)
        value = buffer;
      #endif
      cmsCloseProfile(icc_profile);
    }

    // Store the profile information as properties in the image
    if (value != NULL)
      (void)SetImageProperty((Image *)image, key, value, exception_info);
  }
  #endif

  return value;
}