const StringInfo
    *profile;

  profile=GetImageProfile(image,"icc");
  if (profile == (StringInfo *) NULL)
    profile=GetImageProfile(image,"icm");
  if (profile != (StringInfo *) NULL)
  {
    if (GetStringInfoLength(profile) < 128)
      return((const char *) NULL);
#ifdef LCMS
    cmsHPROFILE
      lcms_profile;

    cmsUInt32Number
      flags;

    lcms_profile=cmsOpenProfileFromMem(GetStringInfoDatum(profile),
      (cmsUInt32Number) GetStringInfoLength(profile));
    if (lcms_profile != (cmsHPROFILE) NULL)
    {
      const char
        *description,
        *manufacturer,
        *model,
        *copyright;

      description=(const char *) cmsGetProfileDescription(lcms_profile);
      manufacturer=(const char *) cmsGetProfileManufacturer(lcms_profile);
      model=(const char *) cmsGetProfileCreator(lcms_profile);
      copyright=(const char *) cmsGetProfileCopyright(lcms_profile);

      if (description != (const char *) NULL)
        (void) SetImageProperty(image,"icc:description",description,exception_info);
      if (manufacturer != (const char *) NULL)
        (void) SetImageProperty(image,"icc:manufacturer",manufacturer,exception_info);
      if (model != (const char *) NULL)
        (void) SetImageProperty(image,"icc:model",model,exception_info);
      if (copyright != (const char *) NULL)
        (void) SetImageProperty(image,"icc:copyright",copyright,exception_info);

      cmsCloseProfile(lcms_profile);
    }
#endif
  }
  return(GetImageProperty(image,key,exception_info));