static const char *GetICCProperty(const Image *image,const char *key,
  ExceptionInfo *exception_info)
{
  // Retrieve ICC profile properties from an image. First, attempt to get the
  // ICC profile from the image using "icc" or "icm" profile keys. If found,
  // ensure the profile length is adequate for processing. If LCMS is defined,
  // open the ICC profile and extract profile information such as description,
  // manufacturer, model, and copyright. Store these as properties in the image.
  if (image!= (Image *) NULL)
  {
    if (image->properties == (void *) NULL)
      image->properties = AcquireCriticalMemory(sizeof(*image->properties));
    if (image->properties!= (void *) NULL)
    {
      if (DeleteNodeFromSplayTree((SplayTreeInfo *) image->properties, "icc") == MagickFalse)
        (void) DeleteImageProperty(image, "icc");
      if (DeleteNodeFromSplayTree((SplayTreeInfo *) image->properties, "icm") == MagickFalse)
        (void) DeleteImageProperty(image, "icm");
    }
    if (image->icc_profile!= (void *) NULL)
    {
      if (image->icc_profile->signature!= MagickCoreSignature)
      {
        (void) ThrowMagickException(exception_info,GetMagickModule(),OptionError,
          "InvalidArgument","'%s': %s","icc-profile","Invalid ICC Profile");
        return((const char *) NULL);
      }
      if (image->icc_profile->length < 0)
      {
        (void) ThrowMagickException(exception_info,GetMagickModule(),OptionError,
          "InvalidArgument","'%s': %s","icc-profile","Invalid ICC Profile Length");
        return((const char *) NULL);
      }
      if (LCMS!= (void *) NULL)
      {
        lcms_profile_info info;
        lcms_status status;
        status = lcms_open_image(image->icc_profile, &info);
        if (status!= LCMS_PROFILE_OK)
        {
          (void) ThrowMagickException(exception_info,GetMagickModule(),OptionError,
            "InvalidArgument","'%s': %s","icc-profile","Invalid ICC Profile");
          return((const char *) NULL);
        }
        (void) lcms_get_description(&info);
        (void) lcms_get_manufacturer(&info);
        (void) lcms_get_model(&info);
        (void) lcms_get_copyright(&info);
        (void) lcms_close_image(&info);
      }
      (void) SetImageArtifact(image, "icc-profile", image->icc_profile);
      return(GetImageArtifact(image, "icc-profile"));
    }
  }
  return((const char *) NULL);
}