static const char *GetICCProperty(const Image *image,const char *key,
  ExceptionInfo *exception_info)
{
  // Retrieve ICC profile properties from an image. First, attempt to get the
  // ICC profile from the image using "icc" or "icm" profile keys. If found,
  // ensure the profile length is adequate for processing. If LCMS is defined,
  // open the ICC profile and extract profile information such as description,
  // manufacturer, model, and copyright. Store these as properties in the image.
  const StringInfo
    *profile;

  profile=GetImageProfile(image,"icc");
  if (profile == (StringInfo *) NULL)
    profile=GetImageProfile(image,"icm");
  if (profile == (StringInfo *) NULL)
    return((const char *) NULL);
  if (GetStringInfoLength(profile) < 128)
    return((const char *) NULL);
#if defined(MAGICKCORE_LCMS_DELEGATE)
#if!defined(LCMS_VERSION) || (LCMS_VERSION < 2000)
#define cmsUInt32Number  DWORD
#endif
  cmsHPROFILE
    icc_profile;

  icc_profile=cmsOpenProfileFromMem(GetStringInfoDatum(profile),
    (cmsUInt32Number) GetStringInfoLength(profile));
  if (icc_profile!= (cmsHPROFILE *) NULL)
    {
      char
        *description,
        *manufacturer,
        *model,
        *copyright;

      description=(char *) NULL;
      manufacturer=(char *) NULL;
      model=(char *) NULL;
      copyright=(char *) NULL;
#if defined(LCMS_VERSION) && (LCMS_VERSION < 2000)
      description=cmsTakeProductName(icc_profile);
#else
      (void) cmsGetProfileInfoASCII(icc_profile,cmsInfoDescription,
        "en","US",description,MagickPathExtent);
#endif
      (void) cmsGetProfileInfoASCII(icc_profile,cmsInfoManufacturer,
        "en","US",manufacturer,MagickPathExtent);
      (void) cmsGetProfileInfoASCII(icc_profile,cmsInfoModel,
        "en","US",model,MagickPathExtent);
      (void) cmsGetProfileInfoASCII(icc_profile,cmsInfoCopyright,
        "en","US",copyright,MagickPathExtent);
      (void) cmsCloseProfile(icc_profile);
      if (description!= (char *) NULL)
        (void) SetImageProperty((Image *) image,key,(const char *) description,
          exception_info);
      if (manufacturer!= (char *) NULL)
        (void) SetImageProperty((Image *) image,key,(const char *) manufacturer,
          exception_info);
      if (model!= (char *) NULL)
        (void) SetImageProperty((Image *) image,key,(const char *) model,
          exception_info);
      if (copyright!= (char *) NULL)
        (void) SetImageProperty((Image *) image,key,(const char *) copyright,
          exception_info);
      description=DestroyString(description);
      manufacturer=DestroyString(manufacturer);
      model=DestroyString(model);
      copyright=DestroyString(copyright);
    }
#endif
  return((const char *) NULL);
}