const StringInfo
    *profile;

  const unsigned char
    *directory,
    *info;

  size_t
    length;

  ssize_t
    count;

  /*
    Get ICC profile.
  */
  profile=GetImageProfile(image,"icc");
  if (profile == (StringInfo *) NULL)
    profile=GetImageProfile(image,"icm");
  if (profile == (StringInfo *) NULL)
    return((const char *) NULL);
  length=GetStringInfoLength(profile);
  if (length < 132)
    return((const char *) NULL);
  info=GetStringInfoDatum(profile);
  directory=info+128;
  count=(ssize_t) ((*(directory) << 24) | (*(directory+1) << 16) |
    (*(directory+2) << 8) | *(directory+3));
  if (count < 1)
    return((const char *) NULL);
  /*
    Extract ICC profile properties.
  */
#if defined(MAGICKCORE_LCMS_DELEGATE)
  {
    cmsHPROFILE
      icc_profile;

    icc_profile=cmsOpenProfileFromMem(info,(cmsUInt32Number) length);
    if (icc_profile != (cmsHPROFILE) NULL)
      {
        char
          name[MaxTextExtent];

        cmsUInt32Number
          intent;

        intent=0;
        if (cmsIsIntentSupported(icc_profile,intent,LCMS_USED_AS_INPUT) != 0)
          {
            (void) cmsGetProfileInfoASCII(icc_profile,cmsInfoDescription,
              "en","US",name,sizeof(name));
            (void) SetImageProperty(image,"icc:description",name,exception_info);
            (void) cmsGetProfileInfoASCII(icc_profile,cmsInfoManufacturer,
              "en","US",name,sizeof(name));
            (void) SetImageProperty(image,"icc:manufacturer",name,exception_info);
            (void) cmsGetProfileInfoASCII(icc_profile,cmsInfoModel,
              "en","US",name,sizeof(name));
            (void) SetImageProperty(image,"icc:model",name,exception_info);
            (void) cmsGetProfileInfoASCII(icc_profile,cmsInfoCopyright,
              "en","US",name,sizeof(name));
            (void) SetImageProperty(image,"icc:copyright",name,exception_info);
          }
        cmsCloseProfile(icc_profile);
      }
  }
#endif
  return(GetImageProperty(image,key,exception_info));