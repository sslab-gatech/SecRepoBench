static const char *GetICCProperty(const Image *image,const char *key,
  ExceptionInfo *exception_info)
{
  const StringInfo *profile;
  const char *value = NULL;

  // Retrieve ICC profile properties from an image. First, attempt to get the
  // ICC profile from the image using "icc" or "icm" profile keys. If found,
  // ensure the profile length is adequate for processing. If LCMS is defined,
  // open the ICC profile and extract profile information such as description,
  // manufacturer, model, and copyright. Store these as properties in the image.
#if defined(MAGICKCORE_LCMS_DELEGATE)
  profile = GetImageProfile(image, "icc");
  if (profile == NULL)
    profile = GetImageProfile(image, "icm");
  if (profile != NULL && GetStringInfoLength(profile) >= 128) {
    cmsHPROFILE icc_profile = cmsOpenProfileFromMem(GetStringInfoDatum(profile),
                                                   GetStringInfoLength(profile));
    if (icc_profile != NULL) {
#if defined(LCMS_VERSION) && (LCMS_VERSION < 2000)
      value = cmsTakeProductName(icc_profile);
#else
      char buffer[MagickPathExtent];
      if (cmsGetProfileInfoASCII(icc_profile, cmsInfoDescription, "en", "US",
                                buffer, sizeof(buffer)) > 0)
        value = ConstantString(buffer);
#endif
      cmsCloseProfile(icc_profile);
    }
  }
#endif
  return value;
}