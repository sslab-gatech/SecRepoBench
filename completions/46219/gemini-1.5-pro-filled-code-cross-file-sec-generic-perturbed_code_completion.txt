const StringInfo
    *profile;

  cmsHPROFILE
    icc_profile;

  cmsMLU
    *description,
    *manufacturer,
    *model,
    *copyright;

  profile=GetImageProfile(image,"icc");
  if (profile == (StringInfo *) NULL)
    profile=GetImageProfile(image,"icm");
  if (profile == (StringInfo *) NULL)
    return((const char *) NULL);
  if (GetStringInfoLength(profile) < 128)
    return((const char *) NULL);  /* minimum ICC profile length */
#if defined(LCMS_VERSION)
  icc_profile=cmsOpenProfileFromMem(GetStringInfoDatum(profile),
    (cmsUInt32Number) GetStringInfoLength(profile));
  if (icc_profile == (cmsHPROFILE *) NULL)
    return((const char *) NULL);
  description=cmsReadTag(icc_profile,cmsSigProfileDescriptionTag);
  if (description != (cmsMLU *) NULL)
    (void) SetImageProperty(image,"icc:description",(const char *)
      cmsMLUgetASCII(description,cmsNoLanguage,cmsNoCountry),exception_info);
  manufacturer=cmsReadTag(icc_profile,cmsSigDeviceMfgDescTag);
  if (manufacturer != (cmsMLU *) NULL)
    (void) SetImageProperty(image,"icc:manufacturer",(const char *)
      cmsMLUgetASCII(manufacturer,cmsNoLanguage,cmsNoCountry),exception_info);
  model=cmsReadTag(icc_profile,cmsSigDeviceModelDescTag);
  if (model != (cmsMLU *) NULL)
    (void) SetImageProperty(image,"icc:model",(const char *)
      cmsMLUgetASCII(model,cmsNoLanguage,cmsNoCountry),exception_info);
  copyright=cmsReadTag(icc_profile,cmsSigCopyrightTag);
  if (copyright != (cmsMLU *) NULL)
    (void) SetImageProperty(image,"icc:copyright",(const char *)
      cmsMLUgetASCII(copyright,cmsNoLanguage,cmsNoCountry),exception_info);
   cmsCloseProfile(icc_profile);
#endif
  return(GetImageProperty(image,key,exception_info));