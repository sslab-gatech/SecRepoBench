static const char *GetICCProperty(const Image *image,const char *key,
  ExceptionInfo *exception_info)
{
  const StringInfo
    *profile;

  cmsHPROFILE
    icc_profile;

  char
    name[MagickPathExtent];

  profile=GetImageProfile(image,"icc");
  if (profile == (StringInfo *) NULL)
    profile=GetImageProfile(image,"icm");
  if (profile == (StringInfo *) NULL)
    return((const char *) NULL);
  if (GetStringInfoLength(profile) < 132)
    return((const char *) NULL);
#if defined(MAGICKCORE_LCMS_DELEGATE)
  icc_profile=cmsOpenProfileFromMem(GetStringInfoDatum(profile),
    (cmsUInt32Number) GetStringInfoLength(profile));
  if (icc_profile == (cmsHPROFILE *) NULL)
    return((const char *) NULL);
  if (LocaleCompare(key,"icc:description") == 0)
    {
#if defined(LCMS_VERSION) && (LCMS_VERSION < 2000)
      (void) CopyMagickString(name,cmsTakeProductDesc(icc_profile),
        MagickPathExtent);
#else
      (void) cmsGetProfileInfoASCII(icc_profile,cmsInfoDescription,"en","US",
        name,MagickPathExtent);
#endif
      (void) SetImageProperty((Image *) image,key,name,exception_info);
    }
  else if (LocaleCompare(key,"icc:manufacturer") == 0)
    {
#if defined(LCMS_VERSION) && (LCMS_VERSION < 2000)
      (void) CopyMagickString(name,cmsTakeManufacturer(icc_profile),
        MagickPathExtent);
#else
      (void) cmsGetProfileInfoASCII(icc_profile,cmsInfoManufacturer,"en","US",
        name,MagickPathExtent);
#endif
      (void) SetImageProperty((Image *) image,key,name,exception_info);
    }
  else if (LocaleCompare(key,"icc:model") == 0)
    {
#if defined(LCMS_VERSION) && (LCMS_VERSION < 2000)
      (void) CopyMagickString(name,cmsTakeModel(icc_profile),MagickPathExtent);
#else
      (void) cmsGetProfileInfoASCII(icc_profile,cmsInfoModel,"en","US",name,
        MagickPathExtent);
#endif
      (void) SetImageProperty((Image *) image,key,name,exception_info);
    }
  else if (LocaleCompare(key,"icc:copyright") == 0)
    {
#if defined(LCMS_VERSION) && (LCMS_VERSION < 2000)
      (void) CopyMagickString(name,cmsTakeCopyright(icc_profile),
        MagickPathExtent);
#else
      (void) cmsGetProfileInfoASCII(icc_profile,cmsInfoCopyright,"en","US",
        name,MagickPathExtent);
#endif
      (void) SetImageProperty((Image *) image,key,name,exception_info);
    }
  (void) cmsCloseProfile(icc_profile);
#endif
  return(GetImageProperty(image,key,exception_info));
}