const char *icc_profile = GetImageProperty(image, "icc", exception_info);
if (icc_profile == (const char *) NULL)
  icc_profile = GetImageProperty(image, "icm", exception_info);
if (icc_profile!= (const char *) NULL)
{
  size_t length = strlen(icc_profile);
  if (length >= 128)
  {
    cmsHPROFILE hProfile = cmsOpenProfileFromMem(icc_profile, length);
    if (hProfile!= (cmsHPROFILE) NULL)
    {
      char description[256];
      char manufacturer[256];
      char model[256];
      char copyright[256];
      cmsInfoType info_type = cmsInfoDescription;
      cmsGetProfileInfo(hProfile, info_type, "en", "US", description);
      info_type = cmsInfoManufacturer;
      cmsGetProfileInfo(hProfile, info_type, "en", "US", manufacturer);
      info_type = cmsInfoModel;
      cmsGetProfileInfo(hProfile, info_type, "en", "US", model);
      info_type = cmsInfoCopyright;
      cmsGetProfileInfo(hProfile, info_type, "en", "US", copyright);
      SetImageProperty(image, "icc:description", description, exception_info);
      SetImageProperty(image, "icc:manufacturer", manufacturer, exception_info);
      SetImageProperty(image, "icc:model", model, exception_info);
      SetImageProperty(image, "icc:copyright", copyright, exception_info);
      cmsCloseProfile(hProfile);
    }
  }
}
return GetImageProperty(image, key, exception_info);