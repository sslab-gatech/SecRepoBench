if (image == NULL)
    return NULL;
  
  const char *icc_profile = GetImageProfile(image, "icc", NULL);
  if (icc_profile == NULL)
    return NULL;
  
  size_t length = GetImageProfileLength(image, "icc");
  if (length < 128) { // Minimum reasonable ICC profile size
    (void) ThrowMagickException(exception, GetMagickModule(), CorruptImageWarning,
      "ICCProfileTooShort", "Profile length: %zu", length);
    return NULL;
  }
  
  cmsHPROFILE hProfile = cmsOpenProfileFromMem(NULL, (const cmsUInt8Ptr)icc_profile, length);
  if (hProfile == NULL) {
    (void) ThrowMagickException(exception, GetMagickModule(), CorruptImageWarning,
      "FailedToOpenICCProfile", "Profile parsing failed");
    return NULL;
  }
  
  cmsChar* description = NULL;
  cmsGetProfileDescription(hProfile, &description);
  
  cmsChar* manufacturer = NULL;
  cmsGetProfileManufacturer(hProfile, &manufacturer);
  
  cmsChar* model = NULL;
  cmsGetProfileModel(hProfile, &model);
  
  cmsChar* copyright = NULL;
  cmsGetProfileCopyright(hProfile, &copyright);
  
  // Set properties
  if (description != NULL && *description != '\0')
    (void) SetImageProperty(image, "icc:description", description, exception);
  if (manufacturer != NULL && *manufacturer != '\0')
    (void) SetImageProperty(image, "icc:manufacturer", manufacturer, exception);
  if (model != NULL && *model != '\0')
    (void) SetImageProperty(image, "icc:model", model, exception);
  if (copyright != NULL && *copyright != '\0')
    (void) SetImageProperty(image, "icc:copyright", copyright, exception);
  
  cmsCloseProfile(hProfile);
  
  return GetImageProperty(image, key, exception);