{
  const StringInfo
    *profile;

  cmsHPROFILE
    icc_profile;

  cmsUInt32Number
    intent;

  char
    intent_name[MagickPathExtent],
    profile_description[MagickPathExtent],
    manufacturer[MagickPathExtent],
    model[MagickPathExtent],
    copyright[MagickPathExtent];

  profile=GetImageProfile(image,"icc");
  if (profile == (StringInfo *) NULL)
    profile=GetImageProfile(image,"icm");
  if (profile == (StringInfo *) NULL)
    return((const char *) NULL);
  if (GetStringInfoLength(profile) < 132)
    return((const char *) NULL);
#if defined(MAGICKCORE_LCMS_DELEGATE)
  icc_profile=cmsOpenProfileFromMem(GetStringInfoDatum(profile),
    (cmsUInt32Number) GetStringInfoLength(profile));
  if (icc_profile == (cmsHPROFILE *) NULL)
    return((const char *) NULL);
  (void) cmsGetProfileInfoASCII(icc_profile,cmsInfoDescription,"en","US",
    profile_description,MagickPathExtent);
  (void) SetImageProperty((Image *) image,"icc:description",
    profile_description,exception);
  (void) cmsGetProfileInfoASCII(icc_profile,cmsInfoManufacturer,"en","US",
    manufacturer,MagickPathExtent);
  (void) SetImageProperty((Image *) image,"icc:manufacturer",manufacturer,
    exception);
  (void) cmsGetProfileInfoASCII(icc_profile,cmsInfoModel,"en","US",model,
    MagickPathExtent);
  (void) SetImageProperty((Image *) image,"icc:model",model,exception);
  (void) cmsGetProfileInfoASCII(icc_profile,cmsInfoCopyright,"en","US",
    copyright,MagickPathExtent);
  (void) SetImageProperty((Image *) image,"icc:copyright",copyright,exception);
  intent=cmsGetHeaderRenderingIntent(icc_profile);
  (void) CopyMagickString(intent_name,CommandOptionToMnemonic(
    MagickIntentOptions,(ssize_t) intent),MagickPathExtent);
  (void) SetImageProperty((Image *) image,"icc:rendering-intent",intent_name,
    exception);
  (void) cmsCloseProfile(icc_profile);
#endif
  return(GetImageProperty(image,key,exception));
}