const StringInfo
  *profile;

size_t
  profile_length;

cmsHPROFILE
  icc_profile;

char
  *property;

profile=GetImageProfile(image,"icc");
if (profile == (StringInfo *) NULL)
  profile=GetImageProfile(image,"icm");
if (profile == (StringInfo *) NULL)
  return((const char *) NULL);
profile_length=GetStringInfoLength(profile);
if (profile_length < 128)
  return((const char *) NULL);

icc_profile=cmsOpenProfileFromMem(GetStringInfoDatum(profile),
  (cmsUInt32Number) profile_length);
if (icc_profile == (cmsHPROFILE) NULL)
  return((const char *) NULL);

property=(char *) NULL;
if (LocaleCompare(key,"icc:description") == 0)
  property=GetICCPropertyInfo(icc_profile,cmsSigProfileDescriptionTag);
else if (LocaleCompare(key,"icc:manufacturer") == 0)
  property=GetICCPropertyInfo(icc_profile,cmsSigDeviceMfgDescTag);
else if (LocaleCompare(key,"icc:model") == 0)
  property=GetICCPropertyInfo(icc_profile,cmsSigDeviceModelDescTag);
else if (LocaleCompare(key,"icc:copyright") == 0)
  property=GetICCPropertyInfo(icc_profile,cmsSigCopyrightTag);

cmsCloseProfile(icc_profile);
if (property == (char *) NULL)
  return((const char *) NULL);
(void) SetImageProperty((Image *) image,key,property,exception_info);
property=DestroyString(property);
return(GetImageProperty(image,key,exception_info));