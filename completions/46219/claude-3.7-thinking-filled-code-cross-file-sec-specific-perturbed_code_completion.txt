const StringInfo
    *profile;

const char
    *property;

char
    format[MagickPathExtent];

if (image == (const Image *) NULL)
  return((const char *) NULL);

if (image->debug != MagickFalse)
  (void) LogMagickEvent(TraceEvent,GetMagickModule(),"%s",image->filename);

// Try to get ICC profile: first "icc", then "icm"
profile=GetImageProfile(image,"icc");
if (profile == (StringInfo *) NULL)
  profile=GetImageProfile(image,"icm");
if (profile == (StringInfo *) NULL)
  return((const char *) NULL);

// Ensure profile length is adequate
if (GetStringInfoLength(profile) < 128)
  return((const char *) NULL);

#if defined(MAGICKCORE_LCMS_DELEGATE)
{
  cmsHPROFILE
    icc_profile;

  icc_profile=cmsOpenProfileFromMem(GetStringInfoDatum(profile),
    (cmsUInt32Number) GetStringInfoLength(profile));
  if (icc_profile != (cmsHPROFILE) NULL)
  {
    char
      *info;

    cmsUInt32Number
      length;

    // Extract and set profile description
    length=cmsGetProfileInfoASCII(icc_profile,cmsInfoDescription,"en","US",NULL,0);
    if (length > 0)
    {
      info=(char *) AcquireQuantumMemory(length,sizeof(*info));
      if (info != (char *) NULL)
      {
        (void) cmsGetProfileInfoASCII(icc_profile,cmsInfoDescription,"en","US",
          info,length);
        (void) SetImageProperty((Image *) image,"icc:description",info,
          exception_info);
        info=(char *) RelinquishMagickMemory(info);
      }
    }

    // Extract and set profile manufacturer
    length=cmsGetProfileInfoASCII(icc_profile,cmsInfoManufacturer,"en","US",NULL,0);
    if (length > 0)
    {
      info=(char *) AcquireQuantumMemory(length,sizeof(*info));
      if (info != (char *) NULL)
      {
        (void) cmsGetProfileInfoASCII(icc_profile,cmsInfoManufacturer,"en","US",
          info,length);
        (void) SetImageProperty((Image *) image,"icc:manufacturer",info,
          exception_info);
        info=(char *) RelinquishMagickMemory(info);
      }
    }

    // Extract and set profile model
    length=cmsGetProfileInfoASCII(icc_profile,cmsInfoModel,"en","US",NULL,0);
    if (length > 0)
    {
      info=(char *) AcquireQuantumMemory(length,sizeof(*info));
      if (info != (char *) NULL)
      {
        (void) cmsGetProfileInfoASCII(icc_profile,cmsInfoModel,"en","US",
          info,length);
        (void) SetImageProperty((Image *) image,"icc:model",info,
          exception_info);
        info=(char *) RelinquishMagickMemory(info);
      }
    }

    // Extract and set profile copyright
    length=cmsGetProfileInfoASCII(icc_profile,cmsInfoCopyright,"en","US",NULL,0);
    if (length > 0)
    {
      info=(char *) AcquireQuantumMemory(length,sizeof(*info));
      if (info != (char *) NULL)
      {
        (void) cmsGetProfileInfoASCII(icc_profile,cmsInfoCopyright,"en","US",
          info,length);
        (void) SetImageProperty((Image *) image,"icc:copyright",info,
          exception_info);
        info=(char *) RelinquishMagickMemory(info);
      }
    }

    cmsCloseProfile(icc_profile);
  }
}
#endif

// Return the requested ICC property
(void) FormatLocaleString(format,MagickPathExtent,"icc:%s",key);
property=GetImageProperty(image,format,exception_info);
return(property);