{
  const char
    *icc_profile;
  size_t
    profile_length;

  icc_profile=GetImageProfile(image,"icc");
  if (icc_profile == (const char *) NULL)
    icc_profile=GetImageProfile(image,"icm");
  if (icc_profile == (const char *) NULL)
    return((const char *) NULL);
  if (GetImageProfile(image,"icc") != (const char *) NULL)
    profile_length=GetImageProfileLength(image,"icc");
  else
    profile_length=GetImageProfileLength(image,"icm");
  if (profile_length < 128)
  {
    (void) ThrowMagickException(exception_info,GetMagickModule(),OptionError,
      "InvalidICCProfile","Profile length (%" MAGICK_FORMAT_SIZE_T ") too short",
      profile_length);
    return((const char *) NULL);
  }
#if defined(LCMS) || defined(LCMS_VERSION)
  {
    cmsHPROFILE
      profile;
    char
      description[256] = "",
      manufacturer[256] = "",
      model[256] = "",
      copyright[256] = "";

    profile=cmsOpenProfileFromMem((const void *) icc_profile,(cmsUInt32Number) profile_length);
    if (profile != (cmsHPROFILE) NULL)
    {
      cmsGetProfileInfoASCII(profile,cmsInfoDescription,"en","US",description,sizeof(description));
      cmsGetProfileInfoASCII(profile,cmsInfoManufacturer,"en","US",manufacturer,sizeof(manufacturer));
      cmsGetProfileInfoASCII(profile,cmsInfoModel,"en","US",model,sizeof(model));
      cmsGetProfileInfoASCII(profile,cmsInfoCopyright,"en","US",copyright,sizeof(copyright));
      cmsCloseProfile(profile);
      (void) SetImageProperty(image,"icc:description",description);
      (void) SetImageProperty(image,"icc:manufacturer",manufacturer);
      (void) SetImageProperty(image,"icc:model",model);
      (void) SetImageProperty(image,"icc:copyright",copyright);
    }
  }
#endif
  return(icc_profile);
}