#if defined(MAGICKCORE_LCMS_DELEGATE)
{
  const StringInfo
    *profile;

  cmsHPROFILE
    icc_profile;

  profile=GetImageProfile(image,"icc");
  if (profile == (StringInfo *) NULL)
    profile=GetImageProfile(image,"icm");
  if (profile == (const StringInfo *) NULL)
    return((const char *) NULL);
  if (GetStringInfoLength(profile) < 128)
    return((const char *) NULL);
  icc_profile=cmsOpenProfileFromMem(GetStringInfoDatum(profile),
    (cmsUInt32Number) GetStringInfoLength(profile));
  if (icc_profile != (cmsHPROFILE *) NULL)
    {
      char
        **icc_info;

      icc_info=GetICCProfileInfo(icc_profile,key);
      if (icc_info != (char **) NULL)
        {
          const char
            *property;

          property=ConstantString(*icc_info);
          (void) SetImageProperty(image,key,property,exception_info);
          icc_info=DestroyICCProfileInfo(icc_info);
          return(property);
        }
    }
}
#else
  {
    const char
      *property;

    property=GetImageProperty(image,key,exception_info);
    if (property != (const char *) NULL)
      return(property);
  }
#endif