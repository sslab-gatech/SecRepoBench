static const char *GetICCProperty(const Image *image,const char *key,
  ExceptionInfo *exception_info)
{
  const StringInfo *profile;
  const char *value;

  profile = GetImageProfile(image, "icc");
  if (profile == (StringInfo *) NULL)
    profile = GetImageProfile(image, "icm");
  if (profile == (StringInfo *) NULL)
    return NULL;

  if (GetStringInfoLength(profile) < sizeof(cmsHPROFILE))
    return NULL;

#if defined(MAGICKCORE_LCMS_DELEGATE)
  cmsHPROFILE icc_profile = cmsOpenProfileFromMem(GetStringInfoDatum(profile),
    (cmsUInt32Number) GetStringInfoLength(profile));
  if (icc_profile != NULL)
  {
#if defined(LCMS_VERSION) && (LCMS_VERSION < 2000)
    value = cmsTakeProductName(icc_profile);
#else
    char description[MagickPathExtent];
    (void) cmsGetProfileInfoASCII(icc_profile, cmsInfoDescription, "en", "US",
      description, sizeof(description));
    value = description;
#endif
    cmsCloseProfile(icc_profile);
  }
  else
#endif
    value = NULL;

  return value;
}