const char *icc_profile = GetImageProperty(image, "icc");
  if (icc_profile == (const char *) NULL)
    icc_profile = GetImageProperty(image, "icm");
  if (icc_profile == (const char *) NULL)
    return((const char *) NULL);
  
  /* Ensure the ICC profile length is adequate.
     The ICC header requires at least 128 bytes. */
  if (strlen(icc_profile) < 128)
    return(icc_profile);
  
#ifdef LCMS_PROFILE
  {
    cmsHPROFILE hProfile = cmsOpenProfileFromMem((const cmsUInt8Number *) icc_profile,
                                                  (cmsUInt32Number) strlen(icc_profile));
    if (hProfile != NULL)
      {
        char info[256];
  
        if (cmsGetProfileInfoASCII(hProfile, cmsInfoDescription, info, sizeof(info)))
          (void) SetImageProperty(image, "icc:description", info);
        if (cmsGetProfileInfoASCII(hProfile, cmsInfoManufacturer, info, sizeof(info)))
          (void) SetImageProperty(image, "icc:manufacturer", info);
        if (cmsGetProfileInfoASCII(hProfile, cmsInfoModel, info, sizeof(info)))
          (void) SetImageProperty(image, "icc:model", info);
        if (cmsGetProfileInfoASCII(hProfile, cmsInfoCopyright, info, sizeof(info)))
          (void) SetImageProperty(image, "icc:copyright", info);
  
        cmsCloseProfile(hProfile);
      }
  }
#endif
  
  return(icc_profile);