i += 8;
if (length < 56)
    return 0;
if (AV_RL32(p->buf + i) != MKTAG('S','H','D','R'))
    return 0;
i += 28;

if (AV_RB32(p->buf + i) <= 0)
    return 0;
i += 4;
if (AV_RB32(p->buf + i) <= 0)
    return 0;
i += 4;
if (AV_RL32(p->buf + i) == MKTAG('S','D','X','2'))
    return AVPROBE_SCORE_MAX;
else
    return 0;