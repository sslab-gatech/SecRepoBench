if (i + 8 > p->buf_size)
    return 0;
if (length < 8)
    return 0;
if (i + length > p->buf_size)
    return 0;
/* Move the index past the header */
i += 8;