if (i + 8 > p->buf_size)
    return 0;  // Not enough data for the chunk header

if (length < 8)
    return 0;  // Length value is too small

if (length > (unsigned)p->buf_size || i > (unsigned)p->buf_size - length)
    return 0;  // Buffer doesn't have enough data for the entire chunk

i += 8;  // Move past the header