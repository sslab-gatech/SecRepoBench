if (i + 8 > p->buf_size) // Check if there's enough buffer left to read chunk and length
    return 0;
if (length < 8 || i + length > p->buf_size) // Check if length is valid and within buffer bounds
    return 0;
i += 8; // Move past the header