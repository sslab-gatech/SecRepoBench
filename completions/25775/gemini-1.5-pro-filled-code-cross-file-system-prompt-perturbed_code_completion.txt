if (i + 8 > p->buf_size)
            return 0;
        if (length > p->buf_size || i + length > p->buf_size || length + 8 < 8)
            return 0;

        i += 8;