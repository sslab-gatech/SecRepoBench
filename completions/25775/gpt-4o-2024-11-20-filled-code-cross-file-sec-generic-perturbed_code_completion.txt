// Ensure the buffer has enough data for the chunk and length fields
        if (i + 8 > p->buf_size)
            return 0;

        // Validate the length field to prevent integer underflow or overflow
        if (length < 8 || i + length > p->buf_size)
            return 0;

        // Move the index past the header
        i += 8;