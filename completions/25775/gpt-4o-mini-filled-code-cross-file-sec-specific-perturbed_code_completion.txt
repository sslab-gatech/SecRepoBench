if (length < 0 || i + length + 8 > p->buf_size) {
            return 0;
        }
        i += 8;