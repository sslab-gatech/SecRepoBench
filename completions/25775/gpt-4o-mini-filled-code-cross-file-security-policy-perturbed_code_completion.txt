if (length < 0 || i + 8 + length > p->buf_size) {
            return 0;
        }
        i += 8;