i += length;
        if (i > p->buf_size)
            return 0;