if (length < 0 || i + length > p->buf_size) {
            return 0; // Invalid length or out of bounds access
        }
        i += 8; // Move past the header