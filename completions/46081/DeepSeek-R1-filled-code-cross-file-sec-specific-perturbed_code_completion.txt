quantum=(quantumdata->format == FloatingPointQuantumFormat) ?
    (quantumdata->depth <= 32 ? sizeof(float) : sizeof(double)) :
    ((quantumdata->depth <= 8) ? 1 : (quantumdata->depth <= 16) ? 2 :
    (quantumdata->depth <= 32) ? 4 : 8);
  if ((image->columns != 0) && (image->channels != 0) &&
      ((SIZE_MAX/(image->columns*image->channels)) < quantum))
    return(MagickFalse);
  extent=image->columns*image->channels*quantum+quantumdata->pad;
  if (quantumdata->extent >= extent)
    return(MagickTrue);
  if (quantumdata->pixels != (unsigned char *) NULL)
    quantumdata->pixels=(unsigned char *) RelinquishMagickMemory(
      quantumdata->pixels);
  quantumdata->pixels=(unsigned char *) AcquireQuantumMemory(extent,
    sizeof(*quantumdata->pixels));
  if (quantumdata->pixels == (unsigned char *) NULL)
    {
      quantumdata->extent=0;
      return(MagickFalse);
    }
  (void) memset(quantumdata->pixels,0,extent*sizeof(*quantumdata->pixels));
  quantumdata->extent=extent;
  return(MagickTrue);