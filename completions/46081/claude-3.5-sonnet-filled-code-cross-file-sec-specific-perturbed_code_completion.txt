quantum=GetQuantumRange(quantumdata->depth);
if (quantum == 0)
  return(MagickFalse);
if (quantumdata->format == FloatingPointQuantumFormat)
  {
    if (quantumdata->depth == 16)
      quantum=65535;
    else
      if (quantumdata->depth == 32)
        quantum=4294967295U;
  }
extent=(image->columns*image->rows*GetPixelChannels(image)*
  (quantumdata->depth+7)/8);
if (extent < (image->columns*image->rows*sizeof(Quantum)))
  extent=image->columns*image->rows*sizeof(Quantum);
if (quantumdata->pixels != (unsigned char *) NULL)
  quantumdata->pixels=(unsigned char *) RelinquishMagickMemory(
    quantumdata->pixels);
quantumdata->pixels=(unsigned char *) AcquireQuantumMemory(extent,
  sizeof(*quantumdata->pixels));
if (quantumdata->pixels == (unsigned char *) NULL)
  return(MagickFalse);
return(MagickTrue);