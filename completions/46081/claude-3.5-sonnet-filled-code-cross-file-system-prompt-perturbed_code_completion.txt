if (quantumdata->format == FloatingPointQuantumFormat)
  quantumdata->depth=32;
if (quantumdata->depth <= 8)
  quantum=8;
else if (quantumdata->depth <= 16)
  quantum=16;
else if (quantumdata->depth <= 32)
  quantum=32;
else
  quantum=64;
extent=(quantum*image->number_channels*image->columns)/8;
if (extent < ((image->columns*image->number_channels*
     quantumdata->depth+7)/8))
  extent=((image->columns*image->number_channels*quantumdata->depth+7)/8);
extent+=image->columns*sizeof(Quantum);
if (quantumdata->pixels == (unsigned char *) NULL)
  quantumdata->pixels=(unsigned char *) AcquireQuantumMemory(extent,
    sizeof(*quantumdata->pixels));
else
  quantumdata->pixels=(unsigned char *) ResizeQuantumMemory(
    quantumdata->pixels,extent,sizeof(*quantumdata->pixels));
if (quantumdata->pixels == (unsigned char *) NULL)
  return(MagickFalse);
quantumdata->extent=extent;
return(MagickTrue);