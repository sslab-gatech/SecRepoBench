quantum = MagickMax(sizeof(double) * image->channels,sizeof(Quantum)) * image->columns;
extent = quantum * image->rows;
if (quantumdata->pixels == (Quantum *) NULL)
{
  quantumdata->pixels=(Quantum *) AcquireQuantumMemory(image->columns,
    extent/sizeof(Quantum));
  if (quantumdata->pixels == (Quantum *) NULL)
    return(MagickFalse);
  quantumdata->length=extent;
}
else if (quantumdata->length < extent)
{
  quantumdata->pixels=(Quantum *) ResizeQuantumMemory(quantumdata->pixels,
    image->columns,extent/sizeof(Quantum));
  if (quantumdata->pixels == (Quantum *) NULL)
    return(MagickFalse);
  quantumdata->length=extent;
}