quantum=quantumdata->quantum;
if (quantumdata->format == FloatingPointQuantumFormat)
  {
    if (quantumdata->depth <= 16)
      quantum=32;
    else
      if (quantumdata->depth <= 32)
        quantum=64;
  }
extent=GetQuantumExtent(image,quantumdata,GetQuantumType(image,(ExceptionInfo *) NULL));
if (quantumdata->pack == MagickFalse)
  extent=(size_t) ((extent+7)/8);
if (quantumdata->pixels == (MemoryInfo **) NULL)
  {
    if (AcquireQuantumPixels(quantumdata,extent) == MagickFalse)
      return(MagickFalse);
  }
else
  {
    size_t
      memory;

    memory=extent;
    if (quantumdata->pack == MagickFalse)
      memory=(size_t) ((extent+7)/8);
    if (quantumdata->extent < memory)
      {
        DestroyQuantumPixels(quantumdata);
        if (AcquireQuantumPixels(quantumdata,extent) == MagickFalse)
          return(MagickFalse);
      }
  }
return(MagickTrue);