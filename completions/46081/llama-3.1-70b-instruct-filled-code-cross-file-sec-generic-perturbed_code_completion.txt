/*
  Adjust the quantum depth based on the format and specified depth,
  particularly for floating point formats.
*/
if ((quantumdata->format == FloatingPointQuantumFormat) ||
    (quantumdata->format == DoublePrecisionQuantumFormat))
  quantumdata->depth=64;
extent=GetQuantumExtent(quantumdata);
quantum=image->columns*image->rows*extent;
if (quantumdata->quantum_type == UndefinedQuantum)
  {
    if ((quantumdata->format == FloatingPointQuantumFormat) ||
        (quantumdata->format == DoublePrecisionQuantumFormat))
      quantumdata->quantum_type=FloatQuantum;
    else
      quantumdata->quantum_type=UnsignedQuantum;
  }
if (quantumdata->quantum_type == FloatQuantum)
  {
    if (quantumdata->format == FloatingPointQuantumFormat)
      quantumdata->depth=32;
    else
      quantumdata->depth=64;
  }
if ((quantumdata->depth < 8) && (quantumdata->format!= FloatingPointQuantumFormat) &&
    (quantumdata->format!= DoublePrecisionQuantumFormat))
  {
    quantumdata->depth=8;
    extent=GetQuantumExtent(quantumdata);
    quantum=image->columns*image->rows*extent;
  }
if (quantumdata->depth > 32)
  {
    quantumdata->depth=32;
    extent=GetQuantumExtent(quantumdata);
    quantum=image->columns*image->rows*extent;
  }
if (quantumdata->depth < 8)
  {
    quantumdata->depth=8;
    extent=GetQuantumExtent(quantumdata);
    quantum=image->columns*image->rows*extent;
  }
if (quantumdata->quantum_type == SignedQuantum)
  {
    if (quantumdata->depth == 8)
      quantumdata->min_is_white=MagickFalse;
    else
      quantumdata->min_is_white=MagickTrue;
  }
if (quantumdata->quantum_type == UnsignedQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == FloatQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == LogQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == Log256Quantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == LogLuvQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == LogL16Quantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == CineonLogQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == ArriLogQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == RGB565Quantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == RGBQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == RGBAQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == CMYKQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == CMYKAQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == YCbCrQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == YUVQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == YIQQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == XYZQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == LabQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == sRGBQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == scRGBQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == LinearGRAYQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == LinearRGBQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == DPXQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == GrayQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == GrayAlphaQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == CyanQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == MagentaQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == YellowQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == BlackQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == OpacityQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == IndexQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == IndexAlphaQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == BilevelQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == AlphaQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == TrueColorMatteQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == TrueColorAlphaQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == ColorSeparationQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == ColorSeparationAlphaQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == ColorSeparationMatteQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == PaletteBilevelMatteQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == PaletteBilevelAlphaQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == PaletteTrueColorMatteQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == PaletteTrueColorAlphaQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == PaletteTrueColorMatteQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == PaletteTrueColorAlphaQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == BilevelAlphaQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == PaletteBilevelMatteQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == PaletteBilevelAlphaQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == PaletteTrueColorMatteQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == PaletteTrueColorAlphaQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == BilevelAlphaQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == CMYKAQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == YCbCrAQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == IHSQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == YIQQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == YUVQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == XYZQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == LabQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == sRGBQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == scRGBQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == DPXQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == LinearGRAYQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == LinearRGBQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == LinearYCbCrQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == LinearYUVQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == LinearYIQQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == LinearXYZQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == LinearLabQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == LinearRec709Quantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == LinearRec601Quantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == LinearRec709AlphaQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == LinearRec601AlphaQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == BGRQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == BGRAQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == RGB565Quantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == RGBQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == RGBAQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == CMYKQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == CMYKAQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == YCbCrQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == YUVQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == YIQQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == XYZQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == LabQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == sRGBQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == scRGBQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == DPXQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == LinearGRAYQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == LinearRGBQuantum)
  quantumdata->min_is_white=MagickTrue;
if (quantumdata->quantum_type == LinearYCbCrQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == LinearYUVQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == LinearYIQQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == LinearXYZQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == LinearLabQuantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == LinearRec709Quantum)
  quantumdata->min_is_white=MagickFalse;
if (quantumdata->quantum_type == LinearRec601Quantum)