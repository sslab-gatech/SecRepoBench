extent=image->columns*image->channels;
if (quantumdata->format == FloatingPointQuantumFormat)
  quantum=MagickMin(depth,64);
else
  quantum=MagickMin(depth,16);
if (quantumdata->depth!= quantum)
{
  size_t
    quantum_size;

  quantum_size=sizeof(double)*quantum;
  if (quantumdata->pixels!= (unsigned char *) NULL)
    quantumdata->pixels=(unsigned char *) RelinquishMagickMemory(quantumdata->pixels);
  quantumdata->pixels=(unsigned char *) AcquireQuantumMemory(quantum_size*extent);
  if (quantumdata->pixels == (unsigned char *) NULL)
    return(MagickFalse);
  quantumdata->depth=quantum;
}
if (quantumdata->endian == UndefinedEndian)
  quantumdata->endian=IS_LITTLE_ENDIAN? LSBEndian : MSBEndian;
if (quantumdata->min_is_white == MagickFalse)
  SetQuantumMinIsWhite(quantum_info,MagickTrue);
SetQuantumImageType(image,quantumdata->format == FloatingPointQuantumFormat?
  DoubleQuantum : (quantumdata->depth == 8? UnsignedQuantum : SignedQuantum));
return(MagickTrue);