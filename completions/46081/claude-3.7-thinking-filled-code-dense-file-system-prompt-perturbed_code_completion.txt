switch (quantumdata->format)
{
  case FloatingPointQuantumFormat:
  {
    if (quantumdata->depth == 32)
      quantum=sizeof(float);
    else
      if (quantumdata->depth == 64)
        quantum=sizeof(double);
      else
        quantum=quantumdata->depth/8;
    break;
  }
  default:
  {
    quantum=quantumdata->depth/8;
    if (quantum < 1)
      quantum=1;
    break;
  }
}
extent=quantum;
if (quantumdata->pad > 1)
  extent=(quantum*((quantum*8+quantumdata->pad-1)/quantumdata->pad))*
    ((quantumdata->pad+7)/8);
quantumdata->extent=extent;
if (quantumdata->pixels != (unsigned char *) NULL)
  quantumdata->pixels=(unsigned char *) RelinquishMagickMemory(
    quantumdata->pixels);
quantum=extent;
if ((GetPixelChannels(image)*quantum) != (size_t) ((size_t)
    GetPixelChannels(image)*quantum))
  return(MagickFalse);
extent=(size_t) GetPixelChannels(image)*quantum;
if ((extent*image->columns) != (size_t) ((size_t) extent*image->columns))
  return(MagickFalse);
extent=(size_t) extent*image->columns;
quantumdata->pixels=(unsigned char *) AcquireQuantumMemory(extent,
  sizeof(*quantumdata->pixels));
if (quantumdata->pixels == (unsigned char *) NULL)
  return(MagickFalse);
return(MagickTrue);