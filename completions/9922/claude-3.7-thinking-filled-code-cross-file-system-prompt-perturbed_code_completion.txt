if (uc >= endptr)
    goto out;  // Unexpected end of data
switch (*uc) {
case '\\': case '"': case '/':
case 'b': case 'f': case 'n': case 'r': case 't':
    uc++;  // Valid escape sequence, advance the pointer
    break;
case 'u':
    uc++;  // Move past 'u'
    // Check for 4 hexadecimal digits
    for (i = 0; i < 4; i++) {
        if (uc >= endptr)
            goto out;  // Unexpected end of data
        if (!((*uc >= '0' && *uc <= '9') || 
               (*uc >= 'a' && *uc <= 'f') || 
               (*uc >= 'A' && *uc <= 'F')))
            goto out;  // Not a valid hex digit
        uc++;
    }
    break;
default:
    goto out;  // Invalid escape sequence
}