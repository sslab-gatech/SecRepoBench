if (uc >= endptr)
	goto out;
{
	unsigned char esc = *uc++;
	switch (esc) {
	case '"':
	case '\\':
	case '/':
	case 'b':
	case 'f':
	case 'n':
	case 'r':
	case 't':
		break;
	case 'u':
		/* Expect exactly 4 hex digits for Unicode escape */
		for (i = 0; i < 4; i++) {
			if (uc >= endptr ||
			    !((*uc >= '0' && *uc <= '9') ||
			      (*uc >= 'A' && *uc <= 'F') ||
			      (*uc >= 'a' && *uc <= 'f')))
				goto out;
			uc++;
		}
		break;
	default:
		goto out;
	}
}