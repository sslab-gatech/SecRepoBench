if (uc >= endptr) {
    goto out;
}
switch (*uc) {
    case '\\':
    case '"':
    case '/':
    case 'b':
    case 'f':
    case 'n':
    case 'r':
    case 't':
        uc++;
        break;
    case 'u':
        if (uc + 4 < endptr) {
            for (i = 1; i <= 4; i++) {
                if (!isxdigit(uc[i])) {
                    goto out;
                }
            }
            uc += 5;
        } else {
            goto out;
        }
        break;
    default:
        goto out;
}