if (ret == NULL) {
	xsltTransformError(tctxt, NULL, tctxt->inst,
	    "exsltCryptoRc4EncryptFunction: Failed to allocate decrypted string\n");
	tctxt->state = XSLT_STATE_STOPPED;
	xmlXPathReturnEmptyString (parsercontext);
	goto done;
    }
    ret_len = exsltCryptoRc4Decrypt(bin, ret_len, padkey, ret);
    ret[ret_len] = 0;
    xmlXPathReturnString(parsercontext, ret);
done:
    if (ret != NULL)
	xmlFree (ret);