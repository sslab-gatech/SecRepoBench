if (str != NULL)
    xmlFree (str);
if (padkey != NULL)
    xmlFree (padkey);
if (bin != NULL)
    xmlFree (bin);

memcpy (ret, bin, ret_len);
ret[ret_len] = '\0';
xmlXPathReturnString (parsercontext, ret);