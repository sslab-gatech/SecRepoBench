if (ret == NULL) {
        xsltTransformError(tctxt, NULL, tctxt->inst,
            "exsltCryptoRc4DecryptFunction: Failed to allocate memory for decrypted result\n");
        tctxt->state = XSLT_STATE_STOPPED;
        xmlXPathReturnEmptyString(parsercontext);
        goto done;
    }
    memset(ret, 0, ret_len + 1);
    
    // Perform the decryption (assuming a function `RC4_decrypt` exists)
    RC4_decrypt(padkey, key_len, bin, bin_len, ret);

    // Return the decrypted string to the caller
    xmlXPathReturnString(parsercontext, ret);

done:
    if (ret != NULL)
        xmlFree(ret);