if (magic != NULL)
    {
      LockSemaphoreInfo(magic_cache_semaphore);
      p = SearchLinkedList(magic_cache,magic,MagicCompare);
      UnlockSemaphoreInfo(magic_cache_semaphore);
      if (p != NULL)
        {
          return p;
        }
    }

  LockSemaphoreInfo(magic_list_semaphore);
  p = SearchLinkedList(magic_list,magic,MagicCompare);
  UnlockSemaphoreInfo(magic_list_semaphore);
  if (p != NULL)
    {
      return p;
    }

  return NULL;