assert(exception != (ExceptionInfo *) NULL);
  p=(const MagicInfo *) NULL;
  if (magic == (const unsigned char *) NULL)
    return(p);
  if (IsMagicCacheInstantiated() == MagickFalse)
    return(p);
  LockSemaphoreInfo(magic_cache_semaphore);
  if (magic_cache != (LinkedListInfo *) NULL)
    {
      const LinkedListInfo
        *list;

      list=magic_cache;
      p=(const MagicInfo *) GetNextValueInLinkedList(list);
      while (p != (const MagicInfo *) NULL)
      {
        if ((size >= p->extent) && (memcmp(magic,p->magic,p->extent) == 0))
          break;
        p=(const MagicInfo *) GetNextValueInLinkedList(list);
      }
    }
  UnlockSemaphoreInfo(magic_cache_semaphore);
  if (p != (const MagicInfo *) NULL)
    return(p);
  if (magic_list_semaphore == (SemaphoreInfo *) NULL)
    ActivateSemaphoreInfo(&magic_list_semaphore);
  LockSemaphoreInfo(magic_list_semaphore);
  if (magic_list != (LinkedListInfo *) NULL)
    {
      const LinkedListInfo
        *list;

      list=magic_list;
      p=(const MagicInfo *) GetNextValueInLinkedList(list);
      while (p != (const MagicInfo *) NULL)
      {
        if ((size >= p->extent) && (memcmp(magic,p->magic,p->extent) == 0))
          break;
        p=(const MagicInfo *) GetNextValueInLinkedList(list);
      }
    }