if (exception == (ExceptionInfo *) NULL)
    return((const MagicInfo *) NULL);
if (IsMagicCacheInstantiated() == MagickFalse)
    return((const MagicInfo *) NULL);
if (magic != (unsigned char *) NULL)
  {
    LockSemaphoreInfo(magic_cache_semaphore);
    p = (const MagicInfo *) GetValueFromSortedLinkedList(magic_cache, magic, size);
    UnlockSemaphoreInfo(magic_cache_semaphore);
    if (p != (const MagicInfo *) NULL)
      return(p);
  }
LockSemaphoreInfo(magic_list_semaphore);
p = (const MagicInfo *) GetValueFromSortedLinkedList(magic_list, magic, size);
UnlockSemaphoreInfo(magic_list_semaphore);