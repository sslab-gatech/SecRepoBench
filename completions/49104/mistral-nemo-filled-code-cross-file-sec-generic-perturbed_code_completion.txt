if (magic != (const unsigned char *) NULL)
{
  LockSemaphoreInfo(magic_cache_semaphore);
  p = (const MagicInfo *) FindValueInSortedLinkedList(magic_cache, magic, size,
    MagicCompare);
  UnlockSemaphoreInfo(magic_cache_semaphore);
  if (p == (const MagicInfo *) NULL)
    {
      LockSemaphoreInfo(magic_list_semaphore);
      p = (const MagicInfo *) FindValueInSortedLinkedList(magic_list, magic, size,
        MagicInfoCompare);
      UnlockSemaphoreInfo(magic_list_semaphore);
    }
}