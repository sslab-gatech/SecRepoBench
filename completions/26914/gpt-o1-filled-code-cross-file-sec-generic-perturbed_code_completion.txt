if (charcode == EOF)
  return EOF;

if (charcode < 0 || charcode > 255)
  return charcode;

return (int) tolower((unsigned char) charcode);