if (charcode == EOF)
    return EOF;

if (charcode >= 0 && charcode <= UCHAR_MAX) {
    return tolower((unsigned char)charcode);
} else {
    return charcode;
}