for (t = 1; t < rounds; t++) {
        if (!decrypt) {
            aes_crypt(a, t, sbox, enc_multbl);
            addkey_s(&a->round_key[t], &a->round_key[t - 1], &rcon[rconpointer++]);
        } else {
            addkey_s(&a->round_key[t], &a->round_key[t - 1], &rcon[rconpointer++]);
            aes_crypt(a, t, inv_sbox, dec_multbl);
        }
    }
    if (decrypt) {
        for (t = 0; t < rounds; t++) {
            uint8_t *tmp = a->round_key[t].u8;
            a->round_key[t].u8 = a->round_key[rounds - 1 - t].u8;
            a->round_key[rounds - 1 - t].u8 = tmp;
        }
    }