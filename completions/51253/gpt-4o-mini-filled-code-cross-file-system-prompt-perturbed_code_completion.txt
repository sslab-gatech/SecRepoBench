for (i = 0; i < rounds; i++) {
        if (i < KC) {
            a->round_key[i + 1].u32[0] = ((uint32_t *)tk)[i];
        } else {
            uint32_t temp = a->round_key[i].u32[3];
            if (i % KC == 0) {
                temp = (temp >> 8) | (temp << 24);
                temp ^= rcon[rconpointer++];
            } else if (KC > 6 && i % KC == 4) {
                temp = sbox[temp & 0xff] | (sbox[(temp >> 8) & 0xff] << 8) |
                       (sbox[(temp >> 16) & 0xff] << 16) | (sbox[(temp >> 24) & 0xff] << 24);
            }
            a->round_key[i + 1].u32[0] = a->round_key[i].u32[0] ^ temp;
        }
        for (t = 1; t < 4; t++) {
            a->round_key[i + 1].u32[t] = a->round_key[i].u32[t] ^ a->round_key[i + 1].u32[t - 1];
        }
    }