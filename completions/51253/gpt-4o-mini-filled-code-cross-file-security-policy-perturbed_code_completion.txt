for (i = 0; i < rounds; i++) {
        if (i < 6) {
            memcpy(a->round_key[i + 1].u8, a->round_key[i].u8, 16);
        } else {
            uint8_t temp[4];
            memcpy(temp, a->round_key[i].u8 + 12, 4);
            // Rotate and substitute
            uint8_t t = temp[0];
            temp[0] = sbox[temp[1]];
            temp[1] = sbox[temp[2]];
            temp[2] = sbox[temp[3]];
            temp[3] = sbox[t];
            // XOR with Rcon
            if (rconpointer < sizeof(rcon) / sizeof(rcon[0])) {
                temp[0] ^= rcon[rconpointer++];
            }
            for (t = 0; t < 4; t++) {
                a->round_key[i + 1].u8[t] = a->round_key[i].u8[t] ^ temp[t];
                a->round_key[i + 1].u8[t + 4] = a->round_key[i].u8[t + 4] ^ a->round_key[i + 1].u8[t];
            }
        }
    }