for (i = 1; i <= rounds; i++) {
        av_aes_block *round_key = &a->round_key[i];
        memcpy(round_key, &a->round_key[i - 1], sizeof(av_aes_block));

        if (i % KC == 0) {
            uint8_t temp[4];
            memcpy(temp, &round_key->u8[12], 4);
            // Rotate and substitute
            round_key->u8[0] = sbox[temp[1]] ^ rcon[rconpointer];
            round_key->u8[1] = sbox[temp[2]];
            round_key->u8[2] = sbox[temp[3]];
            round_key->u8[3] = sbox[temp[0]];
            rconpointer++;
        }

        for (t = 0; t < 4; t++) {
            round_key->u32[t] ^= a->round_key[i - 1].u32[t];
        }
    }