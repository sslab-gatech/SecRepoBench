for (i = 1; i < rounds; i++) {
        for (t = 0; t < 4; t++) {
            int temp = tk[(i - 1) * 4 + t];
            if (t == 0) {
                temp = sbox[temp ^ rcon[rconpointer]];
                rconpointer++;
            }
            tk[i * 4 + t] = temp ^ tk[(i - 1) * 4 + (t + 1) % 4];
        }
        memcpy(a->round_key[i].u8, tk[i * 4], 16);
    }