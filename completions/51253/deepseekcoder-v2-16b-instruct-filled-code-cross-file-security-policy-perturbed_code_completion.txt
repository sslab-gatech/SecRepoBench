for (i = 1; i < rounds; i++) {
        for (t = 0; t < 4; t++) {
            tk[i][t] = tk[i - 1][t] ^ tk[i - 1][(t + 1) & 3] ^ tk[i - 1][(t + 2) & 3] ^ tk[i - 1][(t + 3) & 3] ^ rcon[rconpointer++];
        }
        for (t = 0; t < 4; t++) {
            tk[i][t] ^= tk[i - 1][t];
        }
    }
    for (i = 0; i < rounds; i++) {
        for (t = 0; t < 4; t++) {
            a->round_key[i].u8[t] = tk[i][t];
        }
    }
    if (decrypt) {
        for (i = 0; i < rounds; i++) {
            for (t = 0; t < 4; t++) {
                a->round_key[i].u8[t] = tk[rounds - i - 1][t];
            }
        }
    }