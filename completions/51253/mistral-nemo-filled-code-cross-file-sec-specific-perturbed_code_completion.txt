for (i = 0; i < rounds; i++) {
        if (decrypt) {
            aes_decrypt(a, a->round_key[i].u8, a->round_key[i + 1].u8, 1, NULL, rounds - i - 1);
        } else {
            aes_encrypt(a, a->round_key[i].u8, a->round_key[i + 1].u8, 1, NULL, i + 1);
        }
    }
    if (decrypt) {
        for (i = 0; i < rounds / 2; i++) {
            uint8_t tmp[16];
            memcpy(tmp, a->round_key[i].u8, 16);
            memcpy(a->round_key[i].u8, a->round_key[rounds - i - 1].u8, 16);
            memcpy(a->round_key[rounds - i - 1].u8, tmp, 16);
        }
    }