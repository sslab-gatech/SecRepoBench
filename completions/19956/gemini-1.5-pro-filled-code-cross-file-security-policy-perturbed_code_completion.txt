if (unlikely (!c->extend_min (*src))) return_trace (false);

    unsigned int num_regions = regionmapping.get_population ();
    src->axis_count = regionmapping.max_axis_index () + 1;
    if (unlikely (src->axis_count > regionmapping.get_population ())) return_trace (false);
    src->region_count = num_regions;

    if (unlikely (!c->allocate_size<VarRegion> (num_regions))) return_trace (false);
    if (unlikely (!c->allocate_size<float> (src->axis_count * num_regions))) return_trace (false);

    for (unsigned int i = 0; i < num_regions; i++)
    {
      if (unlikely(i >= src->region_count)) return_trace(false); // Check index against region count
      unsigned int axis_index = regionmapping.backward (i);
      if (unlikely(axis_index >= src->axis_count || i >= src->region_count)) return_trace(false); // Check indices
      src->regions[i].set_axis_start (axis_index, &src->coords[i * src->axis_count]);
    }

    return_trace (true);