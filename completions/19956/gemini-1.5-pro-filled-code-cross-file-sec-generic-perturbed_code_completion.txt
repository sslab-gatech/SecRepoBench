TRACE_SERIALIZE (this);

    unsigned int axis_count = src->axis_count;
    unsigned int region_count = regionmapping.get_population ();

    if (unlikely (!hb_serialize_alloc (c, sizeof (VarRegionList) +
                                      axis_count * sizeof (src->axes[0]) +
                                      region_count * sizeof (src->regions[0])))) return false;

    hb_serialize_write_uint16 (c, axis_count);
    hb_serialize_write_uint16 (c, region_count);

    VarRegionList *dest = reinterpret_cast<VarRegionList *> (c->allocate (sizeof (VarRegionList)));
    if (unlikely (!dest)) return false;

    dest->axis_count = axis_count;
    dest->region_count = region_count;

    dest->axes = reinterpret_cast<const hb_variation_axis_info_t *> (c->allocate (axis_count * sizeof (src->axes[0])));
    if (unlikely (!dest->axes)) return false;

    dest->regions = reinterpret_cast<const hb_variation_region_t *> (c->allocate (region_count * sizeof (src->regions[0])));
    if (unlikely (!dest->regions)) return false;


    for (unsigned int i = 0; i < axis_count; i++)
    {
      if (unlikely (!hb_serialize_copy (c, &src->axes[i], &dest->axes[i]))) return false;
    }

    for (unsigned int i = 0; i < region_count; i++)
    {
      unsigned int old_index = regionmapping.get_reverse (i);
      if (unlikely (!hb_serialize_copy (c, &src->regions[old_index], &dest->regions[i]))) return false;
    }

    return true;