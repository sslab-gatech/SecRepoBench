bool serialize (hb_serialize_context_t *c, const VarRegionList *src, const hb_bimap_t &regionmapping)
{
  TRACE_SERIALIZE (this);
  if (unlikely (!c->extend_min (*this)))
    return_trace (false);
  
  axisCount = src->axisCount;
  regionCount = regionmapping.get_population();
  
  unsigned int axes_size = VarRegionAxis::static_size * axisCount * regionCount;
  if (unlikely (!c->allocate_size<HBUINT8> (axes_size)))
    return_trace (false);
  
  for (unsigned int new_region = 0; new_region < regionmapping.get_population(); new_region++)
  {
    unsigned int old_region = regionmapping.backward (new_region);
    for (unsigned int axis = 0; axis < axisCount; axis++)
    {
      unsigned int new_index = new_region * axisCount + axis;
      unsigned int old_index = old_region * axisCount + axis;
      
      axesZ.arrayZ[new_index].startCoord = src->axesZ.arrayZ[old_index].startCoord;
      axesZ.arrayZ[new_index].peakCoord = src->axesZ.arrayZ[old_index].peakCoord;
      axesZ.arrayZ[new_index].endCoord = src->axesZ.arrayZ[old_index].endCoord;
    }
  }
  
  return_trace (true);
}