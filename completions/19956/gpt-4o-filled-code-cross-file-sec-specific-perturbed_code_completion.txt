TRACE_SERIALIZE(this);

    // Calculate the size needed for serialization
    unsigned int numRegions = src->get_num_regions();
    unsigned int numAxes = regionmapping.get_num_axes();
    unsigned int sizeNeeded = sizeof(VarRegionList) + numRegions * sizeof(VarRegion) + numRegions * numAxes * sizeof(Axis);

    // Allocate memory for the VarRegionList
    VarRegionList *dest = c->allocate_size<VarRegionList>(sizeNeeded);
    if (unlikely(dest == nullptr)) return_trace(false);

    // Set the number of regions and axes
    dest->numRegions = numRegions;
    dest->numAxes = numAxes;

    // Serialize each region
    for (unsigned int i = 0; i < numRegions; i++) {
        const VarRegion &srcRegion = src->get_region(i);
        VarRegion *destRegion = &dest->regions[i];

        // Copy region data
        for (unsigned int j = 0; j < numAxes; j++) {
            destRegion->axes[j] = srcRegion.axes[regionmapping.get_axis_index(j)];
        }
    }

    return_trace(true);