VarRegionList *dest = c->allocate_size<VarRegionList> (VarRegionList::get_size (src->axes.length, regionmapping.size ()));
    if (unlikely (dest == nullptr)) return false;
    dest->axes.length = src->axes.length;
    dest->regions.length = regionmapping.size ();
    unsigned int total_region_size = 0;
    for (const auto &pair : regionmapping) {
      total_region_size += src->regions[pair.second].get_size ();
    }
    unsigned char *region_data = c->allocate_size<unsigned char> (total_region_size);
    if (unlikely (region_data == nullptr)) return false;
    unsigned int offset = 0;
    for (const auto &pair : regionmapping) {
      const auto &region = src->regions[pair.second];
      unsigned int size = region.get_size ();
      memcpy (region_data + offset, &region[0], size);
      dest->regions[pair.first] = region_data + offset;
      offset += size;
    }
    return true;