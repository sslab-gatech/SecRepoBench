unsigned int region_count = regionmapping.length;
size_t header_size = offsetof(VarRegionList, regions);
size_t alloc_size = header_size + region_count * sizeof(VarRegion);
VarRegionList *dest = c->allocate_size<VarRegionList>(alloc_size);
if (unlikely(dest == nullptr))
  return_trace(false);

dest->axis_count  = src->axis_count;
dest->region_count = region_count;

for (unsigned int i = 0; i < region_count; i++)
{
  unsigned int src_index  = regionmapping[i].first;
  unsigned int dest_index = regionmapping[i].second;
  memcpy(&dest->regions[dest_index], &src->regions[src_index], sizeof(VarRegion));
}

return_trace(true);