hb_buffer_t *buf = hb_serialize_context_get_buffer (c);
VarRegionList *dest = hb_buffer_alloc (buf, sizeof (VarRegionList), &regionmapping);
if (unlikely (!dest)) return false;

dest->axes = src->axes;
dest->region_count = regionmapping.size;

for (unsigned int i = 0; i < regionmapping.size; i++) {
  VarRegion *region = hb_buffer_alloc (buf, sizeof (VarRegion), &regionmapping);
  if (unlikely (!region)) return false;

  region->axis = src->regions[regionmapping.forward[i]].axis;
  region->peak = src->regions[regionmapping.forward[i]].peak;
  region->start = src->regions[regionmapping.forward[i]].start;
  region->end = src->regions[regionmapping.forward[i]].end;
}

return true;