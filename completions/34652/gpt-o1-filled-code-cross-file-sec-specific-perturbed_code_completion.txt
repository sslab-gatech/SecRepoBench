if (originalformat == 'g') {
  /* Increase precision by (e - 1), ensuring we don't exceed buffer space */
  if (e > 1) {
    prec += (e - 1);
    if (prec < 1) {
      prec = 1;
    }
    if ((size_t)prec > buf_remaining - FLT_MIN_BUF_SIZE) {
      prec = (int)(buf_remaining - FLT_MIN_BUF_SIZE);
      if (prec < 0) {
        prec = 0;
      }
    }
  }
}