if (originalformat == 'g') {
  num_digits = prec + e;
  if (e > 1) {
    num_digits -= (e - 1);
  }
}