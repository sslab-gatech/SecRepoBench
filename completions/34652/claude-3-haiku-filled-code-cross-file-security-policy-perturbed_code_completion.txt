// Adjust the precision to prevent buffer overflow while formatting a float.
// Depending on the original format ('g'), it modifies precision based on the
// exponent value 'e'. If the format is 'g', increases precision by (e - 1).
if (fmt == 'g') {
  if (e > 0) {
    prec = prec > (e - 1) ? prec : (e - 1);
  } else {
    prec = prec > (-e + 1) ? prec : (-e + 1);
  }
}
num_digits = prec;