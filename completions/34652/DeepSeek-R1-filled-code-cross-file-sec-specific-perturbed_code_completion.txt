if (originalformat == 'g') {
        prec += (e - 1);
        if (prec > buf_remaining - 2) {  // Account for '.' and first digit
          prec = buf_remaining - 2;
          if (prec < 0) prec = 0;
        }
      }
      num_digits = prec;
      if (num_digits || alt_form) {
        *s++ = '.';
        while (--e && num_digits) {
          *s++ = '0';
          num_digits--;
        }
      }