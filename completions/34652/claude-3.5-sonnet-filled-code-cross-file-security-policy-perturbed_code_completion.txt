if (originalformat == 'g') {
  prec += (e - 1);
}
// Ensure precision doesn't exceed remaining buffer space
if (prec > buf_remaining - FLT_MIN_BUF_SIZE) {
  prec = buf_remaining - FLT_MIN_BUF_SIZE;
}
if (prec < 0) {
  prec = 0;
}