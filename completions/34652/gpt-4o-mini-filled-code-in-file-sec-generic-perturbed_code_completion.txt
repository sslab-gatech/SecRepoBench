if (num_digits + e > buf_remaining) {
        num_digits = buf_remaining - e;
      }