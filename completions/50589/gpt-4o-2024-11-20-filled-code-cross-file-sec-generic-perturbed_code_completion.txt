line.clear();

    while (true) {
        // Check if the cache is exhausted
        if (m_cachePos >= m_cache.size()) {
            if (!readNextBlock()) {
                // End of stream reached
                return !line.empty(); // Return true if we have read any data into the line
            }
        }

        // Process the cache
        while (m_cachePos < m_cache.size()) {
            T currentChar = m_cache[m_cachePos++];
            
            // Check for end-of-line characters
            if (currentChar == '\n') {
                return true; // Line successfully read
            } else if (currentChar != '\r') {
                // Append character to the line, skipping '\r'
                line.push_back(currentChar);
            }
        }
    }