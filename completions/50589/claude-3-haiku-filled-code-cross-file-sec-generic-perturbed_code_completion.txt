// <MASK>
    // Check if the cache is exhausted and needs to be refilled
    if (m_cachePos >= m_cache.size()) {
        // Refill the cache by reading the next block from the stream
        if (!readNextBlock()) {
            // If no more data could be read, return false to indicate end of stream
            return false;
        }
        // Reset the cache position to the beginning
        m_cachePos = 0;
    }

    // Initialize a vector to store the current line
    line.clear();

    // Loop until a newline character is found or the end of the cache is reached
    while (m_cachePos < m_cache.size()) {
        // Get the current character from the cache
        T c = m_cache[m_cachePos++];

        // Check if the current character is a newline character
        if (c == '\n' || c == '\r') {
            // If so, return true to indicate a line has been read
            return true;
        }

        // Otherwise, append the current character to the line vector
        line.push_back(c);

        // If the line vector has grown too large, resize it to accommodate the new character
        if (line.size() > line.capacity()) {
            line.reserve(line.size() * 2);
        }
    }

    // If the loop completed without finding a newline character, return false to indicate end of stream
    return false;