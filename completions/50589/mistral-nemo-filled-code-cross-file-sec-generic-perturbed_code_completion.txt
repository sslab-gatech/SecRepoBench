if (m_cachePos < m_cache.size()) {
    line = std::vector<T>(m_cache.begin() + m_cachePos, m_cache.end());
    m_cachePos = m_cache.size();
    return true;
}

if (!readNextBlock()) {
    return false;
}

size_t lineStart = 0;
for (size_t i = 0; i < m_cache.size(); ++i) {
    if (m_cache[i] == '\n') {
        line = std::vector<T>(m_cache.begin() + lineStart, m_cache.begin() + i);
        m_cachePos = i + 1;
        return true;
    }
    if (m_cache[i] == '\r' && (i + 1 < m_cache.size() && m_cache[i + 1] == '\n')) {
        line = std::vector<T>(m_cache.begin() + lineStart, m_cache.begin() + i);
        m_cachePos = i + 2;
        return true;
    }
}

line = std::vector<T>(m_cache.begin() + lineStart, m_cache.end());
m_cachePos = m_cache.size();
return true;