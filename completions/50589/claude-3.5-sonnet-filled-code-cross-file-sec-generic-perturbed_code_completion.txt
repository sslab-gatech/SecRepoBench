if (m_cachePos >= m_cache.size()) {
    if (!readNextBlock()) {
        return false;
    }
    m_cachePos = 0;
}

line.clear();
while (m_cachePos < m_cache.size()) {
    T c = m_cache[m_cachePos++];
    if (c == '\r' || c == '\n') {
        if (c == '\r' && m_cachePos < m_cache.size() && m_cache[m_cachePos] == '\n') {
            m_cachePos++;
        }
        if (!line.empty()) {
            return true;
        }
        continue;
    }
    line.push_back(c);
}

if (!line.empty()) {
    return true;
}

return getNextLine(line);