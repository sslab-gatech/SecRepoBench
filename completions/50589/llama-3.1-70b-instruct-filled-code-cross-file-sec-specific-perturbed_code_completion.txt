// Check if the cache is exhausted and requires refilling
if (m_cachePos >= m_cache.size()) {
    if (!readNextBlock()) {
        return false;
    }
    m_cachePos = 0;
}

// Initialize the line buffer
line.clear();

// Iterate over the cache to find the end of the line
while (m_cachePos < m_cache.size()) {
    // Check if the current character is an end-of-line character
    if (m_cache[m_cachePos] == '\n' || m_cache[m_cachePos] == '\r') {
        // Skip the end-of-line character
        m_cachePos++;
        break;
    }
    // Add the character to the line buffer
    line.push_back(m_cache[m_cachePos]);
    m_cachePos++;
}

// If the line buffer is empty and the end of the stream is reached, return false
if (line.empty() && m_cachePos >= m_cache.size()) {
    return false;
}

// Return true if a line is successfully read
return true;