template <class T>
AI_FORCE_INLINE bool IOStreamBuffer<T>::getNextLine(std::vector<T> &line) {
    line.clear();
    while (!isEndOfCache(m_cachePos, m_cacheSize)) {
        if (IsLineEnd(m_cache[m_cachePos])) {
            line.push_back(m_cache[m_cachePos]);
            m_cachePos++;
            return true;
        }
        line.push_back(m_cache[m_cachePos]);
        m_cachePos++;
        if (line.size() == line.capacity()) {
            line.reserve(line.size() * 2);
        }
    }

    if (m_blockIdx < m_numBlocks) {
        if (!readNextBlock()) {
            return false;
        }
        return getNextLine(line);
    }

    return !line.empty();
}