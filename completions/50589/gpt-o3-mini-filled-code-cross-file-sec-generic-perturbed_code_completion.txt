line.clear();
while (true) {
    if (m_cachePos >= m_cache.size()) {
        if (!readNextBlock()) {
            // End of stream reached. Return true if any data was read; otherwise, false.
            return !line.empty();
        }
    }
    for (; m_cachePos < m_cache.size(); ++m_cachePos) {
        T ch = m_cache[m_cachePos];
        // Check for end-of-line characters
        if (ch == '\n' || ch == '\r') {
            // Handle CR+LF sequence: if current char is '\r' and next exists and is '\n', skip it.
            if (ch == '\r' && (m_cachePos + 1) < m_cache.size() && m_cache[m_cachePos + 1] == '\n') {
                ++m_cachePos;
            }
            ++m_cachePos; // Move past the newline character.
            return true;
        }
        line.push_back(ch);
    }
}