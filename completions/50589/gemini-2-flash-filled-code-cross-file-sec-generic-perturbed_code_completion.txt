line.clear();
    while (true) {
        if (m_cachePos >= m_cacheSize) {
            if (!readNextBlock()) {
                // End of stream reached
                if (line.empty()) {
                    return false; // No data read at all
                }
                return true; // Return what we have
            }
        }

        T currentChar = m_cache[m_cachePos++];

        // Check for end-of-line characters
        if (currentChar == '\n' || currentChar == '\r') {
            // Skip consecutive '\r' or '\n' characters
            while (m_cachePos < m_cacheSize && (m_cache[m_cachePos] == '\n' || m_cache[m_cachePos] == '\r')) {
                m_cachePos++;
            }
            return true;
        }

        line.push_back(currentChar);
    }