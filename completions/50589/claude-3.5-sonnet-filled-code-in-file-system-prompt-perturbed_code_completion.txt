line.clear();
line.reserve(m_cacheSize);

if (m_cachePos >= m_cacheSize || 0 == m_filePos) {
    if (!readNextBlock()) {
        return false;
    }
}

while (true) {
    if (IsLineEnd(m_cache[m_cachePos])) {
        ++m_cachePos;
        if (m_cache[m_cachePos - 1] == '\r' && m_cache[m_cachePos] == '\n') {
            ++m_cachePos;
        }
        break;
    }

    line.push_back(m_cache[m_cachePos]);
    ++m_cachePos;

    if (isEndOfCache(m_cachePos, m_cacheSize)) {
        if (!readNextBlock()) {
            return !line.empty();
        }
    }
}

return true;