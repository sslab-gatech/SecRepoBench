bool IOStreamBuffer<T>::getNextLine(std::vector<T> &line) {
    // Check if the cache is exhausted and requires refilling
    if (m_cachePos >= m_cache.size()) {
        if (!readNextBlock()) {
            return false;
        }
        m_cachePos = 0;
    }

    // Initialize the line buffer
    line.clear();

    // Read the next line from the cache
    while (m_cachePos < m_cache.size()) {
        // Check for end-of-line characters
        if (m_cache[m_cachePos] == '\n' || m_cache[m_cachePos] == '\r') {
            // Skip end-of-line characters
            m_cachePos++;
            if (m_cachePos < m_cache.size() && m_cache[m_cachePos - 1] == '\r' && m_cache[m_cachePos] == '\n') {
                m_cachePos++;
            }
            return true;
        }

        // Add the character to the line buffer
        line.push_back(m_cache[m_cachePos]);
        m_cachePos++;
    }

    // If the end of the cache is reached without finding an end-of-line character,
    // refill the cache and continue reading
    if (!readNextBlock()) {
        return false;
    }

    // Continue reading from the refilled cache
    return getNextLine(line);
}