line.clear();
bool hasReadData = false;

// Skip any preceding newline or carriage return characters
while (true) {
    if (m_cachePos >= m_cache.size()) {
        if (!readNextBlock()) {
            // End of stream
            return false;
        }
    }
    T c = m_cache[m_cachePos];
    if (c == static_cast<T>('\n') || c == static_cast<T>('\r')) {
        ++m_cachePos;
        continue;
    }
    break;
}

// Read characters until we encounter a newline or carriage return
while (true) {
    if (m_cachePos >= m_cache.size()) {
        if (!readNextBlock()) {
            // End of stream
            break;
        }
    }
    T c = m_cache[m_cachePos];
    // Stop if we reach a newline or carriage return
    if (c == static_cast<T>('\n') || c == static_cast<T>('\r')) {
        break;
    }
    line.push_back(c);
    hasReadData = true;
    ++m_cachePos;
}

// Return true if we have read any data, otherwise false
return hasReadData;