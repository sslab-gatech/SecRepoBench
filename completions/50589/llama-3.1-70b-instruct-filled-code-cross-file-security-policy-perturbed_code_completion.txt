// Check if the buffer is already exhausted
if (m_cachePos >= m_cache.size()) {
    // If the buffer is exhausted, try to read the next block
    if (!readNextBlock()) {
        // If reading the next block fails, return false
        return false;
    }
}

// Initialize the line buffer
line.clear();

// Iterate over the characters in the buffer
while (m_cachePos < m_cache.size()) {
    // Get the current character
    T c = m_cache[m_cachePos++];

    // Check if the character is a newline
    if (c == '\n') {
        // If the character is a newline, break the loop
        break;
    } else if (c == '\r') {
        // If the character is a carriage return, skip it
        continue;
    }

    // Add the character to the line buffer
    line.push_back(c);
}

// Check if the end of the stream is reached
if (m_cachePos >= m_cache.size() &&!readNextBlock()) {
    // If the end of the stream is reached, return false
    return false;
}

// Return true if a line is successfully read
return true;