//ready to send packet
if (sync[size] == 0xFF && (sync[size + 1] == 0xD0 || sync[size + 1] == 0xD1 || sync[size + 1] == 0xD2 || sync[size + 1] == 0xD3 || sync[size + 1] == 0xD4 || sync[size + 1] == 0xD5 || sync[size + 1] == 0xD6 || sync[size + 1] == 0xD7 || sync[size + 1] == 0xD8 || sync[size + 1] == 0xD9 || sync[size + 1] == 0xDA || sync[size + 1] == 0xDB || sync[size + 1] == 0xDC || sync[size + 1] == 0xDD || sync[size + 1] == 0xDE || sync[size + 1] == 0xDF)) {
    // Check for ID3v1 tag
    if (remain >= 128 && sync[remain - 128] == 'T' && sync[remain - 127] == 'A' && sync[remain - 126] == 'G') {
        skip_id3v1 = GF_TRUE;
    }
} else {
    // Attempt to resync by searching for the next sync byte
    u8 *sync_byte = memmem(start, remain, "\xFF", 1);
    if (sync_byte) {
        start = sync_byte;
        remain = ctx->mp3_buffer_size - (start - ctx->mp3_buffer);
    } else {
        // If no sync byte is found, reset the buffer and try again
        ctx->mp3_buffer_size = 0;
        return GF_OK;
    }
}