size = gf_mp3_frame_size(ctx->hdr);

// Make sure we have enough data for the complete frame
if (remain < offsetskipped + size) {
    // Not enough data and not at end of stream, wait for more
    if (!is_eos) {
        ctx->resume_from = (u32) (start - ctx->mp3_buffer + remain);
        break;
    }
    // At end of stream, just process what we have
    size = remain - offsetskipped;
}

// Check for ID3v1 tag after this frame
if (remain >= offsetskipped + size + 3) {
    if ((sync[size] == 'T') && (sync[size+1] == 'A') && (sync[size+2] == 'G')) {
        skip_id3v1 = GF_TRUE;
        GF_LOG(GF_LOG_DEBUG, GF_LOG_MEDIA, ("[MP3Dmx] detected ID3v1 tag\n"));
    }
}