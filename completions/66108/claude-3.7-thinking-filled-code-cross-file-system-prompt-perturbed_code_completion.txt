size = gf_mp3_frame_size(ctx->hdr);
if (offsetskipped + size > remain) {
    if (!is_eos) {
        //not enough bytes, need to wait for more data
        break;
    }
    //incomplete frame at end of stream, let's just send what we have
    size = remain - offsetskipped;
}

// Check if we can verify sync by looking at the next potential frame header
if (offsetskipped + size + 1 <= remain) {
    // Check for ID3v1 tag
    if ((offsetskipped + size + 3 <= remain) && 
        (sync[size] == 'T' && sync[size+1] == 'A' && sync[size+2] == 'G')) {
        skip_id3v1 = GF_TRUE;
        GF_LOG(GF_LOG_DEBUG, GF_LOG_MEDIA, ("[MP3Dmx] Found ID3v1 tag\n"));
    }
    // If not an ID3v1 tag, and the next byte isn't a sync byte, log a warning
    else if (sync[size] != 0xFF) {
        GF_LOG(GF_LOG_WARNING, GF_LOG_MEDIA, ("[MP3Dmx] Invalid frame sync at offset %d - attempting to resync\n", offsetskipped + size));
    }
}