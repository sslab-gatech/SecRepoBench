bool axis_not_pinned = true;
for (unsigned int i = 0; i < axes.length; i++) {
  hb_tag_t axis_tag = axes[i].axisTag;
  plan->old_index_to_tag.set (i, axis_tag);

  if (plan->user_axes_location.has (axis_tag)) {
    float user_value = plan->user_axes_location[axis_tag];
    float normalized_value = fontface->table.fvar->normalize_axis_value (i, user_value);
    if (has_avar) {
      normalized_value = seg_maps->map_axis_value (i, normalized_value);
    }
    plan->axes_location.set (axis_tag, normalized_value);
    plan->normalized_coords[i] = normalized_value;
    if (fabsf (normalized_value) > 0.0f) {
      plan->all_axes_pinned = false;
      axis_not_pinned = false;
    }
  } else {
    axis_not_pinned = false;
    plan->old_index_to_tag.set (i, axis_tag);
    plan->normalized_coords[i] = 0.0f;
  }

  if (has_avar) {
    seg_maps = seg_maps->next_axis ();
  }
}