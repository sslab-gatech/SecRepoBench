bool axis_not_pinned = false;
for (unsigned i = 0; i < axes.length; i++)
{
    const OT::AxisRecord &axis = axes[i];
    hb_tag_t tag = axis.axisTag;

    // Update the map from old index to tag
    plan->axis_index_map.set(i, tag);

    // Check if the axis is present in the user's axis location settings
    if (!plan->user_axes_location.has(tag))
    {
        axis_not_pinned = true; // Mark as not pinned
        continue;
    }

    // Normalize the axis value using user settings
    float user_value = plan->user_axes_location.get(tag);
    float normalized_value = user_value; // Apply any necessary normalization logic here

    // If 'avar' data is available, remap the normalized value using the segment maps
    if (has_avar && seg_maps)
    {
        normalized_value = seg_maps->map_value(tag, normalized_value);
    }

    // Set the normalized value in the plan's axes location and coordinates
    plan->normalized_coords[i] = normalized_value;

    // If the normalized value is not zero, mark the plan as not pinned at default
    if (normalized_value != 0)
        axis_not_pinned = true;

    // Update segment maps for 'avar' for the next axis, if applicable
    if (has_avar)
    {
        seg_maps = seg_maps->next(tag);
    }
}