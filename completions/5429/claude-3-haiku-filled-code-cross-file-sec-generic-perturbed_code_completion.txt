// Allocate memory for the colormap index based on the number of colors in the image.
colormap_index=(ssize_t *) AcquireQuantumMemory(MaxColormapSize,sizeof(*colormap_index));
if (colormap_index == (ssize_t *) NULL)
  {
    ThrowBinaryException(ResourceLimitError,"MemoryAllocationFailed",
      image->filename);
    return(MagickFalse);
  }
(void) ResetMagickMemory(colormap_index,(-1),MaxColormapSize*sizeof(*colormap_index));