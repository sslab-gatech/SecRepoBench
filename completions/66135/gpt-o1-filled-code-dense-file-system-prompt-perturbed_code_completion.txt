buffer[0] = '\0';
value = (char *) NULL;

/* Check if the pointer p is within the bounds of the EXIF data */
if ((p < exif_data) || (p > (exif_data + length - number_bytes)))
  break;

/* If the format is not valid, break the loop */
if ((format == 0) || (format >= EXIF_NUM_FORMATS))
  break;