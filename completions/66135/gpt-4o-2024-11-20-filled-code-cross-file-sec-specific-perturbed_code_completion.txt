// Initialize a buffer to store formatted property values and a pointer for the value.
// Check if the pointer `p` is within the bounds of the EXIF data.
// If the format is not valid, break the loop.
// Reset the buffer and initialize the value pointer to NULL.

if ((p < exif_data) || (p > (exif_data + length - number_bytes)))
  break; // Ensure `p` is within bounds to prevent buffer overflows.

value = (char *) NULL;
if (number_bytes > 0 && ~((size_t) number_bytes) >= 1)
{
  value = (char *) AcquireQuantumMemory((size_t) number_bytes + 1UL, sizeof(*value));
  if (value == (char *) NULL)
    break; // Memory allocation failed, exit to avoid undefined behavior.

  // Safely copy data from `p` to `value` while ensuring null-termination.
  for (i = 0; i < (ssize_t) number_bytes; i++)
  {
    value[i] = '.';
    if ((p + i) < (exif_data + length) && isprint((int) p[i]) != 0)
      value[i] = (char) p[i];
  }
  value[number_bytes] = '\0'; // Null-terminate the string.
}