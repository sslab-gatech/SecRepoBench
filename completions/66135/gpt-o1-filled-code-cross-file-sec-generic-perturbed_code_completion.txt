{
  char
    buffer[MagickPathExtent];

  /*
    Reset the buffer and ensure our value pointer starts as NULL.
  */
  (void) memset(buffer,0,sizeof(buffer));
  value=(char *) NULL;

  /*
    Confirm pointer validity: make sure 'p' plus 'number_bytes' never exceeds our total EXIF data.
    If it does, break to avoid out-of-bounds access.
  */
  if ((p < exif_data) || ((size_t) (p - exif_data) + number_bytes > length))
    break;

  /*
    Confirm the format is within the valid range.
    This check doubles up on the earlier "format == 0" or out-of-bounds check.
  */
  if ((format < 1) || (format > EXIF_NUM_FORMATS))
    break;
}