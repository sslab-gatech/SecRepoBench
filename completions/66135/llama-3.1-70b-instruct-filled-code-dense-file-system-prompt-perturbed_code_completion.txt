case 0x1203:
            {
              unsigned short
                index;

              /*
                Populate bluemap.
              */
              if (data == (unsigned char *) NULL)
                break;
              colors=(size_t) (length/info.bytes_per_pixel);
              datum=(int) colors;
              if (map.blue!= (int *) NULL)
                map.blue=(int *) RelinquishMagickMemory(map.blue);
              map.blue=(int *) AcquireQuantumMemory(MagickMax(colors,65536),
                sizeof(*map.blue));
              if (map.blue == (int *) NULL)
                ThrowDCMException(ResourceLimitError,"MemoryAllocationFailed")
              (void) memset(map.blue,0,MagickMax(colors,65536)*
                sizeof(*map.blue));
              p=data;
              for (i=0; i < (ssize_t) colors; i++)
              {
                if (image->endian == MSBEndian)
                  index=(unsigned short) ((*p << 8) | *(p+1));
                else
                  index=(unsigned short) (*p | (*(p+1) << 8));
                map.blue[i]=(int) index;
                p+=2;
              }
              break;
            }
            case 0x1400:
            {
              /*
                Populate scale.
              */
              if (data == (unsigned char *) NULL)
                break;
              colors=(size_t) (length/info.bytes_per_pixel);
              datum=(int) colors;
              if (info.scale!= (Quantum *) NULL)
                info.scale=(Quantum *) RelinquishMagickMemory(info.scale);
              info.scale=(Quantum *) AcquireQuantumMemory(MagickMax(colors,
                65536),sizeof(*info.scale));
              if (info.scale == (Quantum *) NULL)
                ThrowDCMException(ResourceLimitError,"MemoryAllocationFailed")
              (void) memset(info.scale,0,MagickMax(colors,65536)*
                sizeof(*info.scale));
              for (i=0; i < (ssize_t) colors; i++)
                if (info.bytes_per_pixel == 1)
                  info.scale[i]=(Quantum) data[i];
                else
                  info.scale[i]=(Quantum) ((short *) data)[i];
              info.scale_size=colors;
              break;
            }
            default:
              break;
          }
          break;
        }
        case 0x0028:
        case 0x0032:
        {
          switch (element)
          {
            case 0x0002:
            {
              /*
                Image orientation.
              */
              if (datum == 1)
                image->orientation=TopLeftOrientation;
              else
                if (datum == 2)
                  image->orientation=TopRightOrientation;
                else
                  if (datum == 3)
                    image->orientation=BottomRightOrientation;
                  else
                    if (datum == 4)
                      image->orientation=BottomLeftOrientation;
                    else
                      if (datum == 5)
                        image->orientation=LeftTopOrientation;
                      else
                        if (datum == 6)
                          image->orientation=RightTopOrientation;
                        else
                          if (datum == 7)
                            image->orientation=RightBottomOrientation;
                          else
                            if (datum == 8)
                              image->orientation=LeftBottomOrientation;
              break;
            }
            case 0x0004:
            {
              /*
                Image orientation.
              */
              if (datum == 1)
                image->orientation=TopLeftOrientation;
              else
                if (datum == 2)
                  image->orientation=TopRightOrientation;
                else
                  if (datum == 3)
                    image->orientation=BottomRightOrientation;
                  else
                    if (datum == 4)
                      image->orientation=BottomLeftOrientation;
                    else
                      if (datum == 5)
                        image->orientation=LeftTopOrientation;
                      else
                        if (datum == 6)
                          image->orientation=RightTopOrientation;
                        else
                          if (datum == 7)
                            image->orientation=RightBottomOrientation;
                          else
                            if (datum == 8)
                              image->orientation=LeftBottomOrientation;
              break;
            }
            case 0x0006:
            {
              /*
                Image orientation.
              */
              if (datum == 1)
                image->orientation=TopLeftOrientation;
              else
                if (datum == 2)
                  image->orientation=TopRightOrientation;
                else
                  if (datum == 3)
                    image->orientation=BottomRightOrientation;
                  else
                    if (datum == 4)
                      image->orientation=BottomLeftOrientation;
                    else
                      if (datum == 5)
                        image->orientation=LeftTopOrientation;
                      else
                        if (datum == 6)
                          image->orientation=RightTopOrientation;
                        else
                          if (datum == 7)
                            image->orientation=RightBottomOrientation;
                          else
                            if (datum == 8)
                              image->orientation=LeftBottomOrientation;
              break;
            }
            case 0x0008:
            {
              /*
                Image orientation.
              */
              if (datum == 1)
                image->orientation=TopLeftOrientation;
              else
                if (datum == 2)
                  image->orientation=TopRightOrientation;
                else
                  if (datum == 3)
                    image->orientation=BottomRightOrientation;
                  else
                    if (datum == 4)
                      image->orientation=BottomLeftOrientation;
                    else
                      if (datum == 5)
                        image->orientation=LeftTopOrientation;
                      else
                        if (datum == 6)
                          image->orientation=RightTopOrientation;
                        else
                          if (datum == 7)
                            image->orientation=RightBottomOrientation;
                          else
                            if (datum == 8)
                              image->orientation=LeftBottomOrientation;
              break;
            }
            case 0x0009:
            {
              /*
                Image orientation.
              */
              if (datum == 1)
                image->orientation=TopLeftOrientation;
              else
                if (datum == 2)
                  image->orientation=TopRightOrientation;
                else
                  if (datum == 3)
                    image->orientation=BottomRightOrientation;
                  else
                    if (datum == 4)
                      image->orientation=BottomLeftOrientation;
                    else
                      if (datum == 5)
                        image->orientation=LeftTopOrientation;
                      else
                        if (datum == 6)
                          image->orientation=RightTopOrientation;
                        else
                          if (datum == 7)
                            image->orientation=RightBottomOrientation;
                          else
                            if (datum == 8)
                              image->orientation=LeftBottomOrientation;
              break;
            }
            case 0x000a:
            {
              /*
                Image orientation.
              */
              if (datum == 1)
                image->orientation=TopLeftOrientation;
              else
                if (datum == 2)
                  image->orientation=TopRightOrientation;
                else
                  if (datum == 3)
                    image->orientation=BottomRightOrientation;
                  else
                    if (datum == 4)
                      image->orientation=BottomLeftOrientation;
                    else
                      if (datum == 5)
                        image->orientation=LeftTopOrientation;
                      else
                        if (datum == 6)
                          image->orientation=RightTopOrientation;
                        else
                          if (datum == 7)
                            image->orientation=RightBottomOrientation;
                          else
                            if (datum == 8)
                              image->orientation=LeftBottomOrientation;
              break;
            }
            case 0x000b:
            {
              /*
                Image orientation.
              */
              if (datum == 1)
                image->orientation=TopLeftOrientation;
              else
                if (datum == 2)
                  image->orientation=TopRightOrientation;
                else
                  if (datum == 3)
                    image->orientation=BottomRightOrientation;
                  else
                    if (datum == 4)
                      image->orientation=BottomLeftOrientation;
                    else
                      if (datum == 5)
                        image->orientation=LeftTopOrientation;
                      else
                        if (datum == 6)
                          image->orientation=RightTopOrientation;
                        else
                          if (datum == 7)
                            image->orientation=RightBottomOrientation;
                          else
                            if (datum == 8)
                              image->orientation=LeftBottomOrientation;
              break;
            }
            case 0x000c:
            {
              /*
                Image orientation.
              */
              if (datum == 1)
                image->orientation=TopLeftOrientation;
              else
                if (datum == 2)
                  image->orientation=TopRightOrientation;
                else
                  if (datum == 3)
                    image->orientation=BottomRightOrientation;
                  else
                    if (datum == 4)
                      image->orientation=BottomLeftOrientation;
                    else
                      if (datum == 5)
                        image->orientation=LeftTopOrientation;
                      else
                        if (datum == 6)
                          image->orientation=RightTopOrientation;
                        else
                          if (datum == 7)
                            image->orientation=RightBottomOrientation;
                          else
                            if (datum == 8)
                              image->orientation=LeftBottomOrientation;
              break;
            }
            case 0x000d:
            {
              /*
                Image orientation.
              */
              if (datum == 1)
                image->orientation=TopLeftOrientation;
              else
                if (datum == 2)
                  image->orientation=TopRightOrientation;
                else
                  if (datum == 3)
                    image->orientation=BottomRightOrientation;
                  else
                    if (datum == 4)
                      image->orientation=BottomLeftOrientation;
                    else
                      if (datum == 5)
                        image->orientation=LeftTopOrientation;
                      else
                        if (datum == 6)
                          image->orientation=RightTopOrientation;
                        else
                          if (datum == 7)
                            image->orientation=RightBottomOrientation;
                          else
                            if (datum == 8)
                              image->orientation=LeftBottomOrientation;
              break;
            }
            case 0x000e:
            {
              /*
                Image orientation.
              */
              if (datum == 1)
                image->orientation=TopLeftOrientation;
              else
                if (datum == 2)
                  image->orientation=TopRightOrientation;
                else
                  if (datum == 3)
                    image->orientation=BottomRightOrientation;
                  else
                    if (datum == 4)
                      image->orientation=BottomLeftOrientation;
                    else
                      if (datum == 5)
                        image->orientation=LeftTopOrientation;
                      else
                        if (datum == 6)
                          image->orientation=RightTopOrientation;
                        else
                          if (datum == 7)
                            image->orientation=RightBottomOrientation;
                          else
                            if (datum == 8)
                              image->orientation=LeftBottomOrientation;
              break;
            }
            case 0x000f:
            {
              /*
                Image orientation.
              */
              if (datum == 1)
                image->orientation=TopLeftOrientation;
              else
                if (datum == 2)
                  image->orientation=TopRightOrientation;
                else
                  if (datum == 3)
                    image->orientation=BottomRightOrientation;
                  else
                    if (datum == 4)
                      image->orientation=BottomLeftOrientation;
                    else
                      if (datum == 5)
                        image->orientation=LeftTopOrientation;
                      else
                        if (datum == 6)
                          image->orientation=RightTopOrientation;
                        else
                          if (datum == 7)
                            image->orientation=RightBottomOrientation;
                          else
                            if (datum == 8)
                              image->orientation=LeftBottomOrientation;
              break;
            }
            case 0x0010:
            {
              /*
                Image orientation.
              */
              if (datum == 1)
                image->orientation=TopLeftOrientation;
              else
                if (datum == 2)
                  image->orientation=TopRightOrientation;
                else
                  if (datum == 3)
                    image->orientation=BottomRightOrientation;
                  else
                    if (datum == 4)
                      image->orientation=BottomLeftOrientation;
                    else
                      if (datum == 5)
                        image->orientation=LeftTopOrientation;
                      else
                        if (datum == 6)
                          image->orientation=RightTopOrientation;
                        else
                          if (datum == 7)
                            image->orientation=RightBottomOrientation;
                          else
                            if (datum == 8)
                              image->orientation=LeftBottomOrientation;
              break;
            }
            case 0x0011:
            {
              /*
                Image orientation.
              */
              if (datum == 1)
                image->orientation=TopLeftOrientation;
              else
                if (datum == 2)
                  image->orientation=TopRightOrientation;
                else
                  if (datum == 3)
                    image->orientation=BottomRightOrientation;
                  else
                    if (datum == 4)
                      image->orientation=BottomLeftOrientation;
                    else
                      if (datum == 5)
                        image->orientation=LeftTopOrientation;
                      else
                        if (datum == 6)
                          image->orientation=RightTopOrientation;
                        else
                          if (datum == 7)
                            image->orientation=RightBottomOrientation;
                          else
                            if (datum == 8)
                              image->orientation=LeftBottomOrientation;
              break;
            }
            case 0x0012:
            {
              /*
                Image orientation.
              */
              if (datum == 1)
                image->orientation=TopLeftOrientation;
              else
                if (datum == 2)
                  image->orientation=TopRightOrientation;
                else
                  if (datum == 3)
                    image->orientation=BottomRightOrientation;
                  else
                    if (datum == 4)
                      image->orientation=BottomLeftOrientation;
                    else
                      if (datum == 5)
                        image->orientation=LeftTopOrientation;
                      else
                        if (datum == 6)
                          image->orientation=RightTopOrientation;
                        else
                          if (datum == 7)
                            image->orientation=RightBottomOrientation;
                          else
                            if (datum == 8)
                              image->orientation=LeftBottomOrientation;
              break;
            }
            case 0x0013:
            {
              /*
                Image orientation.
              */
              if (datum == 1)
                image->orientation=