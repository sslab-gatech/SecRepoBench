case 'X':
case 'x': {
  static const char *suspicious_headers[] = {
    "X-Attack", "X-Malicious", "X-Exploit", NULL
  };
  for (int j = 0; suspicious_headers[j] != NULL; j++) {
    size_t key_len = strlen(suspicious_headers[j]);
    if (packet->line[i].len >= key_len &&
        strncasecmp(packet->line[i].ptr, suspicious_headers[j], key_len) == 0) {
      char risk_message[256];
      snprintf(risk_message, sizeof(risk_message),
               "Suspicious HTTP header detected: %.*s",
               packet->line[i].len, packet->line[i].ptr);
      ndpiflow->risk_flag = 1;
      ndpiflow->risk_message = strdup(risk_message);
      if (ndpiflow->risk_message == NULL) {
        /* Allocation failed; assign a fallback constant message */
        ndpiflow->risk_message = "Suspicious HTTP header detected";
      }
      return;
    }
  }
  break;
}
default:
  break;