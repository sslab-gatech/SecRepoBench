case 'A':
  if((packet->line[i].len > 14) && (strncasecmp((char*)packet->line[i].ptr, "Authorization:", 14) == 0)) {
    char msg[128];
    
    snprintf(msg, sizeof(msg), "Suspicious header detected [Authorization]");
    
    ndpiflow->risk |= NDPI_HTTP_SUSPICIOUS_HEADER;
    ndpiflow->risk_str = ndpi_strdup(msg);
    
    return;
  }
  break;

case 'C':
  if((packet->line[i].len > 13) && (strncasecmp((char*)packet->line[i].ptr, "Content-Type:", 13) == 0)) {
    if(strstr((char*)packet->line[i].ptr, "application/x-msdownload") || 
       strstr((char*)packet->line[i].ptr, "application/x-dosexec")) {
      char msg[128];
      
      snprintf(msg, sizeof(msg), "Suspicious header detected [Content-Type: executable]");
      
      ndpiflow->risk |= NDPI_HTTP_SUSPICIOUS_HEADER;
      ndpiflow->risk_str = ndpi_strdup(msg);
      
      return;
    }
  } else if((packet->line[i].len > 7) && (strncasecmp((char*)packet->line[i].ptr, "Cookie:", 7) == 0)) {
    if(packet->line[i].len > 50) {  // Example threshold
      char msg[128];
      
      snprintf(msg, sizeof(msg), "Suspicious header detected [Cookie with length > 50]");
      
      ndpiflow->risk |= NDPI_HTTP_SUSPICIOUS_HEADER;
      ndpiflow->risk_str = ndpi_strdup(msg);
      
      return;
    }
  }
  break;

case 'P':
  if((packet->line[i].len > 20) && (strncasecmp((char*)packet->line[i].ptr, "Proxy-Authorization:", 20) == 0)) {
    char msg[128];
    
    snprintf(msg, sizeof(msg), "Suspicious header detected [Proxy-Authorization]");
    
    ndpiflow->risk |= NDPI_HTTP_SUSPICIOUS_HEADER;
    ndpiflow->risk_str = ndpi_strdup(msg);
    
    return;
  }
  break;

case 'U':
  if((packet->line[i].len > 11) && (strncasecmp((char*)packet->line[i].ptr, "User-Agent:", 11) == 0)) {
    if(strstr((char*)packet->line[i].ptr, "MSIE 6.0") || 
       strstr((char*)packet->line[i].ptr, "Mozilla/4.0") ||
       strstr((char*)packet->line[i].ptr, "curl")) {
      char msg[128];
      
      snprintf(msg, sizeof(msg), "Suspicious header detected [User-Agent: old browser or tool]");
      
      ndpiflow->risk |= NDPI_HTTP_SUSPICIOUS_HEADER;
      ndpiflow->risk_str = ndpi_strdup(msg);
      
      return;
    }
  }
  break;

case 'X':
  if((packet->line[i].len > 10) && (strncasecmp((char*)packet->line[i].ptr, "X-Forwarded", 11) == 0)) {
    char msg[128];
    
    snprintf(msg, sizeof(msg), "Suspicious header detected [X-Forwarded*]");
    
    ndpiflow->risk |= NDPI_HTTP_SUSPICIOUS_HEADER;
    ndpiflow->risk_str = ndpi_strdup(msg);
    
    return;
  }
  break;