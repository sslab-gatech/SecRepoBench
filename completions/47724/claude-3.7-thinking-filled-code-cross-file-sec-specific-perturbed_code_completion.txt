case 'A':
case 'a':
  // Authorization header could be suspicious if it contains insecure authentication
  if(packet->line[i].len > 14) {
    if(strncasecmp((const char *)packet->line[i].ptr, "Authorization:", 14) == 0) {
      char msg[256]; // Buffer for risk message
      
      // Safely format the risk message
      snprintf(msg, sizeof(msg), "Suspicious HTTP header: %.*s", 
               packet->line[i].len > 100 ? 100 : packet->line[i].len,  // Limit length to prevent buffer overflow
               packet->line[i].ptr);
      
      // Set risk flag
      ndpi_set_risk(ndpiflow, NDPI_SUSPICIOUS_HEADER, msg);
      return;
    }
  }
  break;

case 'C':
case 'c':
  // Cookie or Custom headers could be suspicious
  if(packet->line[i].len > 7) {
    if(strncasecmp((const char *)packet->line[i].ptr, "Cookie:", 7) == 0) {
      char msg[256];
      
      snprintf(msg, sizeof(msg), "Suspicious HTTP header: %.*s", 
               packet->line[i].len > 100 ? 100 : packet->line[i].len,
               packet->line[i].ptr);
      
      ndpi_set_risk(ndpiflow, NDPI_SUSPICIOUS_HEADER, msg);
      return;
    }
  }
  break;

case 'U':
case 'u':
  // User-Agent could contain suspicious patterns
  if(packet->line[i].len > 11) {
    if(strncasecmp((const char *)packet->line[i].ptr, "User-Agent:", 11) == 0) {
      char msg[256];
      
      snprintf(msg, sizeof(msg), "Suspicious HTTP header: %.*s", 
               packet->line[i].len > 100 ? 100 : packet->line[i].len,
               packet->line[i].ptr);
      
      ndpi_set_risk(ndpiflow, NDPI_SUSPICIOUS_HEADER, msg);
      return;
    }
  }
  break;

case 'R':
case 'r':
  // Referer header could be suspicious
  if(packet->line[i].len > 8) {
    if(strncasecmp((const char *)packet->line[i].ptr, "Referer:", 8) == 0) {
      char msg[256];
      
      snprintf(msg, sizeof(msg), "Suspicious HTTP header: %.*s", 
               packet->line[i].len > 100 ? 100 : packet->line[i].len,
               packet->line[i].ptr);
      
      ndpi_set_risk(ndpiflow, NDPI_SUSPICIOUS_HEADER, msg);
      return;
    }
  }
  break;

default:
  // No match for known suspicious header patterns
  break;