case 'U': // Check for User-Agent header
      if(packet->line[i].len >= 10 && strncasecmp(packet->line[i].ptr, "User-Agent", 10) == 0) {
        if(ndpi_is_suspicious_user_agent(packet->line[i].ptr, packet->line[i].len)) {
          snprintf(ndpiflow->risk_message, sizeof(ndpiflow->risk_message),
                   "Suspicious User-Agent header detected: %.*s",
                   packet->line[i].len, packet->line[i].ptr);
          ndpiflow->risk |= NDPI_FLOW_RISK_SUSPICIOUS_HEADER;
          return;
        }
      }
      break;

    case 'C': // Check for Cookie header
      if(packet->line[i].len >= 6 && strncasecmp(packet->line[i].ptr, "Cookie", 6) == 0) {
        if(ndpi_is_suspicious_cookie(packet->line[i].ptr, packet->line[i].len)) {
          snprintf(ndpiflow->risk_message, sizeof(ndpiflow->risk_message),
                   "Suspicious Cookie header detected: %.*s",
                   packet->line[i].len, packet->line[i].ptr);
          ndpiflow->risk |= NDPI_FLOW_RISK_SUSPICIOUS_HEADER;
          return;
        }
      }
      break;

    case 'R': // Check for Referer header
      if(packet->line[i].len >= 7 && strncasecmp(packet->line[i].ptr, "Referer", 7) == 0) {
        if(ndpi_is_suspicious_referer(packet->line[i].ptr, packet->line[i].len)) {
          snprintf(ndpiflow->risk_message, sizeof(ndpiflow->risk_message),
                   "Suspicious Referer header detected: %.*s",
                   packet->line[i].len, packet->line[i].ptr);
          ndpiflow->risk |= NDPI_FLOW_RISK_SUSPICIOUS_HEADER;
          return;
        }
      }
      break;

    case 'H': // Check for Host header
      if(packet->line[i].len >= 4 && strncasecmp(packet->line[i].ptr, "Host", 4) == 0) {
        if(ndpi_is_suspicious_host(packet->line[i].ptr, packet->line[i].len)) {
          snprintf(ndpiflow->risk_message, sizeof(ndpiflow->risk_message),
                   "Suspicious Host header detected: %.*s",
                   packet->line[i].len, packet->line[i].ptr);
          ndpiflow->risk |= NDPI_FLOW_RISK_SUSPICIOUS_HEADER;
          return;
        }
      }
      break;

    default:
      // No action for other headers
      break;