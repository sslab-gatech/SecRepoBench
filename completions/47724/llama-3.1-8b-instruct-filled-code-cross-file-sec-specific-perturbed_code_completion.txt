switch(packet->line[i].ptr[0]){
  case 'I': // IRC
    if (ndpi_search_irc_tcp(ndpi_struct, packet, ndpiflow) == 1) {
      char *msg = malloc(strlen("IRC detected") + 1);
      strcpy(msg, "IRC detected");
      ndpiflow->risk = msg;
      break;
    }
  case 'A': // IceCast
    if (ndpi_search_icecast_tcp(ndpi_struct, packet, ndpiflow) == 1) {
      char *msg = malloc(strlen("IceCast detected") + 1);
      strcpy(msg, "IceCast detected");
      ndpiflow->risk = msg;
      break;
    }
  case 'M': // MpegDash
    if (ndpi_search_mpegdash_http(ndpi_struct, packet, ndpiflow) == 1) {
      char *msg = malloc(strlen("MpegDash detected") + 1);
      strcpy(msg, "MpegDash detected");
      ndpiflow->risk = msg;
      break;
    }
  case 'F': // FastTrack
    if (ndpi_search_fasttrack_tcp(ndpi_struct, packet, ndpiflow) == 1) {
      char *msg = malloc(strlen("FastTrack detected") + 1);
      strcpy(msg, "FastTrack detected");
      ndpiflow->risk = msg;
      break;
    }
  default:
    break;
}