);
      check_content_type_and_change_protocol(ndpi_struct, flow);
      ndpi_validate_http_content(ndpi_struct, flow);
      ndpi_int_http_add_connection(ndpi_struct, flow, NDPI_PROTOCOL_HTTP, NDPI_PROTOCOL_CATEGORY_WEB);
      return;
    } else {
      NDPI_LOG_DBG2(ndpi_struct,
		    "SECOND PAYLOAD TRAFFIC FROM CLIENT, FIRST PACKET MIGHT HAVE BEEN HTTP...UNKNOWN TRAFFIC, HERE FOR HTTP again.. \n");

      ndpi_parse_packet_line_info(ndpi_struct, flow);
      check_content_type_and_change_protocol(ndpi_struct, flow);
      ndpi_validate_http_content(ndpi_struct, flow);
      ndpi_int_http_add_connection(ndpi_struct, flow, NDPI_PROTOCOL_HTTP, NDPI_PROTOCOL_CATEGORY_WEB);
      return;
    }
  }
}

/* *********************************************************************************************** */

static void ndpi_init_http_dissector(struct ndpi_detection_module_struct *ndpi_struct, u_int32_t *id,
				     struct ndpi_flow_struct *flow) {
  flow->l4.tcp.http_stage = 0;
  flow->http_detected = 0;
  flow->http.request_version = 0;
  flow->http.response_status_code = 0;
  flow->http.request_content_type = NULL;
  flow->http.content_type = NULL;
  flow->http.url = NULL;
  flow->http.nat_ip = NULL;
  flow->http.detected_os = NULL;
  flow->http.user_agent = NULL;
  flow->http.request_content_length = 0;
  flow->http.content_length = 0;
  flow->http.content_disposition_line.ptr = NULL;
  flow->http.content_disposition_line.len = 0;
  flow->http.request_content_disposition_filename = NULL;
  flow->http.request_content_disposition_filename_len = 0;
  flow->http.request_content_disposition_filename_is_url_encoded = 0;
  flow->http.request_content_disposition_filename_is_utf8 = 0;
  flow->http.request_content_disposition_filename_is_binary = 0;
  flow->http.request_content_disposition_filename_is_url_encoded_binary = 0;
  flow->http.request_content_disposition_filename_is_utf8_binary = 0;
  flow->http.request_content_disposition_filename_is_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_url_encoded_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_utf8_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_url_encoded_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_utf8_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_url_encoded_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_utf8_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_url_encoded_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_utf8_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_url_encoded_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_utf8_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_url_encoded_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_utf8_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_url_encoded_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_utf8_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_url_encoded_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_utf8_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_url_encoded_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_utf8_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_url_encoded_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_utf8_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_url_encoded_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_utf8_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_url_encoded_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_utf8_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_url_encoded_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_utf8_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_url_encoded_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_utf8_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_url_encoded_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_utf8_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_url_encoded_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_utf8_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_url_encoded_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_utf8_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_url_encoded_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_utf8_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_url_encoded_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_utf8_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_url_encoded_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary_binary = 0;
  flow->http.request_content_disposition_filename_is_