case 'X':
    case 'x': {
        const char *suspicious_headers[] = {"X-Malicious", "X-Exploit", "X-Suspicious", NULL};
        for (int j = 0; suspicious_headers[j] != NULL; j++) {
            size_t key_len = strlen(suspicious_headers[j]);
            if (packet->line[i].len >= key_len &&
                strncasecmp(packet->line[i].ptr, suspicious_headers[j], key_len) == 0) {
                char risk_msg[256];
                snprintf(risk_msg, sizeof(risk_msg), "Suspicious HTTP header detected: %.*s", (int)packet->line[i].len, packet->line[i].ptr);
                ndpiflow->risk_flag = 1;
                strncpy(ndpiflow->risk_message, risk_msg, sizeof(ndpiflow->risk_message) - 1);
                ndpiflow->risk_message[sizeof(ndpiflow->risk_message) - 1] = '\0';
                return;
            }
        }
        break;
    }