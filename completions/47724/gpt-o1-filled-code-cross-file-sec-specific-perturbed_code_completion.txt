case 'C':
      {
        /* Check if the line starts with "Cookie", ignoring case */
        if(packet->line[i].len >= 6 && !strncasecmp(packet->line[i].ptr, "Cookie", 6)) {
          char risk_message[256];
          /* Format a message indicating the suspicious header. Safely limit the output length. */
          snprintf(risk_message, sizeof(risk_message),
                   "Detected suspicious header: %.*s",
                   (int)packet->line[i].len, packet->line[i].ptr);

          /* Set a risk flag and store the message in the flow structure */
          ndpiflow->risk = 1;  /* Example risk flag assignment */
          strncpy(ndpiflow->risk_string, risk_message, sizeof(ndpiflow->risk_string) - 1);
          ndpiflow->risk_string[sizeof(ndpiflow->risk_string) - 1] = '\0';

          /* Exit after detecting the first suspicious header */
          return;
        }
        break;
      }

      case 'A':
      {
        /* Check if the line starts with "Authorization", ignoring case */
        if(packet->line[i].len >= 13 && !strncasecmp(packet->line[i].ptr, "Authorization", 13)) {
          char risk_message[256];
          snprintf(risk_message, sizeof(risk_message),
                   "Detected suspicious header: %.*s",
                   (int)packet->line[i].len, packet->line[i].ptr);

          ndpiflow->risk = 1; 
          strncpy(ndpiflow->risk_string, risk_message, sizeof(ndpiflow->risk_string) - 1);
          ndpiflow->risk_string[sizeof(ndpiflow->risk_string) - 1] = '\0';

          return;
        }
        break;
      }

      case 'X':
      {
        /* Check if the line starts with "X-Forwarded-For", ignoring case */
        if(packet->line[i].len >= 15 && !strncasecmp(packet->line[i].ptr, "X-Forwarded-For", 15)) {
          char risk_message[256];
          snprintf(risk_message, sizeof(risk_message),
                   "Detected suspicious header: %.*s",
                   (int)packet->line[i].len, packet->line[i].ptr);

          ndpiflow->risk = 1;
          strncpy(ndpiflow->risk_string, risk_message, sizeof(ndpiflow->risk_string) - 1);
          ndpiflow->risk_string[sizeof(ndpiflow->risk_string) - 1] = '\0';

          return;
        }
        break;
      }