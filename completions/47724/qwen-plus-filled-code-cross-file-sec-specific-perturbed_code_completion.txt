case 'X':
case 'x': {
  const char suspicious_header[] = "X-Injected-By";
  size_t suspicious_len = sizeof(suspicious_header) - 1;

  if (packet->line[i].len >= suspicious_len &&
      memcmp(packet->line[i].ptr, suspicious_header, suspicious_len) == 0) {
    char message[256];
    snprintf(message, sizeof(message), "Suspicious header detected: %.*s", (int)packet->line[i].len, packet->line[i].ptr);
    ndpi_set_risk(ndpi_struct, ndpiflow, NDPI_HTTP_SUSPICIOUS_HEADER, message);
    return;
  }
  break;
}