while (probelength > 0) {
		// Skip leading whitespace and newlines
		while (probelength && probe_data[0] && strchr(" \t\n\r", probe_data[0])) {
			probe_data++;
			probelength--;
		}
		if (probelength == 0) break;

		// Skip XML declaration
		if (my_strstr(probe_data, "<?xml", probelength)) {
			const char *xml_end = my_strstr(probe_data, "?>", probelength);
			if (xml_end) {
				probelength -= (xml_end - probe_data) + 2;
				probe_data = xml_end + 2;
			} else {
				break;
			}
		}
		// Skip DOCTYPE declaration
		else if (my_strstr(probe_data, "<!DOCTYPE", probelength)) {
			const char *doctype_end = my_strstr(probe_data, ">", probelength);
			if (doctype_end) {
				probelength -= (doctype_end - probe_data) + 1;
				probe_data = doctype_end + 1;
			} else {
				break;
			}
		}
		// Skip XML comments
		else if (my_strstr(probe_data, "<!--", probelength)) {
			const char *comment_end = my_strstr(probe_data, "-->", probelength);
			if (comment_end) {
				probelength -= (comment_end - probe_data) + 3;
				probe_data = comment_end + 3;
			} else {
				break;
			}
		} else {
			// No more XML headers, exit loop
			break;
		}
	}