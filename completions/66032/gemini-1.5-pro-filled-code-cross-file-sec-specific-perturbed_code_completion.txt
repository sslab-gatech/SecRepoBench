u32 len = probelength;
	char *sep;

	while (len && probe_data[0] && strchr("\n\r\t ", (char) probe_data[0])) {
		probe_data ++;
		len--;
	}

	if (len>2 && probe_data[0]=='<' && probe_data[1]=='?') {
		sep = my_strstr(probe_data, "?>", len);
		if (sep) {
			len -= (u32) (sep + 2 - (char*)probe_data);
			probe_data = sep+2;
		}
	}

	while (len && probe_data[0] && strchr("\n\r\t ", (char) probe_data[0])) {
		probe_data ++;
		len--;
	}

	//check doctype
	if (len>10 && !strncmp(probe_data, "<!DOCTYPE", 9)) {
		sep = my_strstr(probe_data, ">", len);
		if (sep) {
			len -= (u32) (sep + 1 - (char*)probe_data);
			probe_data = sep+1;
		}
	}

	while (len && probe_data[0] && strchr("\n\r\t ", (char) probe_data[0])) {
		probe_data ++;
		len--;
	}
	probelength = len;

	//comments
	while (probelength>4 && !strncmp(probe_data, "<!--", 4)) {
		char *end = my_strstr(probe_data+4, "-->", probelength-4);
		if (!end)
			break;
		//move to end of comment
		u32 diff = (u32) (end + 3 - (char*)probe_data);
		probe_data += diff;
		probelength -= diff;
	}
	while (probelength && probe_data[0] && strchr("\n\r\t ", (char) probe_data[0])) {
		probe_data ++;
		probelength--;
	}