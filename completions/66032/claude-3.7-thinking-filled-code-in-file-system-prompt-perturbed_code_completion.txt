// Strip leading whitespace and newline characters
while (probelength && probe_data[0] && strchr("\n\r\t ", (char) probe_data[0])) {
    probe_data++;
    probelength--;
}

// Skip XML declaration if present
if (probelength>5 && !strncmp(probe_data, "<?xml", 5)) {
    const char *xml_end = my_strstr(probe_data, "?>", probelength);
    if (xml_end) {
        u32 xml_len = (u32) (xml_end - (char*)probe_data) + 2;
        probe_data += xml_len;
        probelength -= xml_len;
        
        // Skip whitespace again
        while (probelength && probe_data[0] && strchr("\n\r\t ", (char) probe_data[0])) {
            probe_data++;
            probelength--;
        }
    }
}

// Skip DOCTYPE if present
if (probelength>9 && !strncmp(probe_data, "<!DOCTYPE", 9)) {
    const char *doctype_end = my_strstr(probe_data, ">", probelength);
    if (doctype_end) {
        u32 doctype_len = (u32) (doctype_end - (char*)probe_data) + 1;
        probe_data += doctype_len;
        probelength -= doctype_len;
        
        // Skip whitespace again
        while (probelength && probe_data[0] && strchr("\n\r\t ", (char) probe_data[0])) {
            probe_data++;
            probelength--;
        }
    }
}

// Skip comments if present
while (probelength>4 && !strncmp(probe_data, "<!--", 4)) {
    const char *comment_end = my_strstr(probe_data, "-->", probelength);
    if (comment_end) {
        u32 comment_len = (u32) (comment_end - (char*)probe_data) + 3;
        probe_data += comment_len;
        probelength -= comment_len;
        
        // Skip whitespace again
        while (probelength && probe_data[0] && strchr("\n\r\t ", (char) probe_data[0])) {
            probe_data++;
            probelength--;
        }
    } else {
        break;
    }
}