while (probelength && probe_data[0] && strchr("\n\r\t ", probe_data[0])) {
    probe_data++;
    probelength--;
}

if (probelength >= 5 && !strncmp((const char*)probe_data, "<?xml", 5)) {
    const char *xml_end = strstr((const char*)probe_data, "?>");
    if (xml_end) {
        u32 skip = (u32)(xml_end - (const char*)probe_data + 2);
        if (skip <= probelength) {
            probe_data += skip;
            probelength -= skip;
        }
    }
}

if (probelength >= 9 && !strncmp((const char*)probe_data, "<!DOCTYPE", 9)) {
    const char *doctype_end = strchr((const char*)probe_data, '>');
    if (doctype_end) {
        u32 skip = (u32)(doctype_end - (const char*)probe_data + 1);
        if (skip <= probelength) {
            probe_data += skip;
            probelength -= skip;
        }
    }
}

if (probelength >= 4 && !strncmp((const char*)probe_data, "<!--", 4)) {
    const char *comment_end = strstr((const char*)probe_data, "-->");
    if (comment_end) {
        u32 skip = (u32)(comment_end - (const char*)probe_data + 3);
        if (skip <= probelength) {
            probe_data += skip;
            probelength -= skip;
        }
    }
}

while (probelength && probe_data[0] && strchr("\n\r\t ", probe_data[0])) {
    probe_data++;
    probelength--;
}