while (probelength && probe_data[0] && strchr("\n\r\t ", (char) probe_data[0])) {
    probe_data++;
    probelength--;
}
if (!probelength) goto exit;

// Check for XML declaration
if (!strncmp(probe_data, "<?xml", strlen("<?xml"))) {
    // Skip to the end of the XML declaration
    const char *end_xml_decl = my_strstr(probe_data, "?>", probelength);
    if (end_xml_decl) {
        probelength -= (u32)(end_xml_decl - probe_data + 2);
        probe_data = end_xml_decl + 2;
    }
}

// Skip DOCTYPE declaration
if (!strncmp(probe_data, "<!DOCTYPE", strlen("<!DOCTYPE"))) {
    const char *end_doctype = my_strstr(probe_data, ">", probelength);
    if (end_doctype) {
        probelength -= (u32)(end_doctype - probe_data + 1);
        probe_data = end_doctype + 1;
    }
}

// Skip comments
while (probelength && !strncmp(probe_data, "<!--", 4)) {
    const char *end_comment = my_strstr(probe_data, "-->", probelength);
    if (end_comment) {
        probelength -= (u32)(end_comment - probe_data + 3);
        probe_data = end_comment + 3;
    } else {
        break; // No closing comment found, exit
    }
}