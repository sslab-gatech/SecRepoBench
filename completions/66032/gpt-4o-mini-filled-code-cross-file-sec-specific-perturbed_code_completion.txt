// Remove leading whitespace and newline characters
	while (probelength && probe_data[0] && strchr("\n\r\t ", (char) probe_data[0])) {
		probe_data++;
		probelength--;
	}

	// Check for XML declaration
	if (probelength >= 5 && !strncmp(probe_data, "<?xml", 5)) {
		probe_data += 5;
		probelength -= 5;
	}

	// Remove comments
	while (probelength > 0) {
		const char *comment_start = my_strstr(probe_data, "<!--", probelength);
		if (!comment_start) break;

		const char *comment_end = my_strstr(comment_start, "-->", probelength);
		if (!comment_end) break;

		probelength -= (u32)(comment_end - comment_start + 3);
		probe_data = comment_end + 3;
	}

	// Ensure we do not exceed the original buffer size
	if (probelength > size) {
		probelength = size;
	}