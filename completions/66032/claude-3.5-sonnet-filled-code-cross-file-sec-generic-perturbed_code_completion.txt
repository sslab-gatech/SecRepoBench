while (probelength && (probe_data[0] == ' ' || probe_data[0] == '\t' || probe_data[0] == '\n' || probe_data[0] == '\r')) {
    probe_data++;
    probelength--;
}

// Remove XML declaration
if (probelength > 5 && !strncmp((const char *)probe_data, "<?xml", 5)) {
    const char *end = my_strstr(probe_data, "?>", probelength);
    if (end) {
        probelength -= (u32)(end - (const char *)probe_data) + 2;
        probe_data = (const u8 *)(end + 2);
    }
}

// Remove DOCTYPE declaration
if (probelength > 9 && !strncmp((const char *)probe_data, "<!DOCTYPE", 9)) {
    const char *end = my_strstr(probe_data, ">", probelength);
    if (end) {
        probelength -= (u32)(end - (const char *)probe_data) + 1;
        probe_data = (const u8 *)(end + 1);
    }
}

// Remove comments
while (probelength > 4 && !strncmp((const char *)probe_data, "<!--", 4)) {
    const char *end = my_strstr(probe_data, "-->", probelength);
    if (end) {
        probelength -= (u32)(end - (const char *)probe_data) + 3;
        probe_data = (const u8 *)(end + 3);
    } else {
        break;
    }
}

// Strip leading whitespace again
while (probelength && (probe_data[0] == ' ' || probe_data[0] == '\t' || probe_data[0] == '\n' || probe_data[0] == '\r')) {
    probe_data++;
    probelength--;
}