while (probelength && strchr("\n\r\t ", probe_data[0])) {
    probe_data++;
    probelength--;
}
if (!probelength) goto exit;

if (!strncmp(probe_data, "<?xml", 5)) {
    // Skip XML declaration
    const char *end_xml = my_strstr(probe_data, "?>", probelength);
    if (end_xml) {
        probelength -= (u32)(end_xml - probe_data) + 2;
        probe_data = end_xml + 2;
    }
}

// Skip DOCTYPE declaration if present
if (!strncmp(probe_data, "<!DOCTYPE", 9)) {
    const char *end_doctype = my_strstr(probe_data, ">", probelength);
    if (end_doctype) {
        probelength -= (u32)(end_doctype - probe_data) + 1;
        probe_data = end_doctype + 1;
    }
}

// Skip comments
while (!strncmp(probe_data, "<!--", 4)) {
    const char *end_comment = my_strstr(probe_data, "-->", probelength);
    if (!end_comment) goto exit;
    probelength -= (u32)(end_comment - probe_data) + 3;
    probe_data = end_comment + 3;
    
    // Skip whitespace after comment
    while (probelength && strchr("\n\r\t ", probe_data[0])) {
        probe_data++;
        probelength--;
    }
}

if (!probelength) goto exit;