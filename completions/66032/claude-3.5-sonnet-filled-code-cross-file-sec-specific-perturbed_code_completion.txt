while (probelength && (*probe_data == ' ' || *probe_data == '\n' || *probe_data == '\r' || *probe_data == '\t')) {
    probe_data++;
    probelength--;
}

// Remove XML declaration if present
if (probelength > 5 && !strncmp((const char *)probe_data, "<?xml", 5)) {
    const char *end = my_strstr((const char *)probe_data, "?>", probelength);
    if (end) {
        u32 skip = (u32)(end - (const char *)probe_data) + 2;
        probe_data += skip;
        probelength -= skip;
    }
}

// Remove DOCTYPE declaration if present
if (probelength > 9 && !strncmp((const char *)probe_data, "<!DOCTYPE", 9)) {
    const char *end = my_strstr((const char *)probe_data, ">", probelength);
    if (end) {
        u32 skip = (u32)(end - (const char *)probe_data) + 1;
        probe_data += skip;
        probelength -= skip;
    }
}

// Remove comments
while (probelength > 4 && !strncmp((const char *)probe_data, "<!--", 4)) {
    const char *end = my_strstr((const char *)probe_data, "-->", probelength);
    if (end) {
        u32 skip = (u32)(end - (const char *)probe_data) + 3;
        probe_data += skip;
        probelength -= skip;
    } else {
        break;
    }
}

// Trim leading whitespace again
while (probelength && (*probe_data == ' ' || *probe_data == '\n' || *probe_data == '\r' || *probe_data == '\t')) {
    probe_data++;
    probelength--;
}