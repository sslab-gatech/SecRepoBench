// Strip leading whitespace and newline characters from the probe_data.
while (probelength && probe_data[0] && strchr("\n\r\t ", (char) probe_data[0])) {
    probe_data++;
    probelength--;
}

// Continue processing the probe_data to remove XML-specific components, such as DOCTYPE declarations, XML headers, and comments.
// Skip XML declaration <?xml ... ?>
if (probelength>5 && !strncmp((const char*)probe_data, "<?xml", 5)) {
    const char *end = my_strstr(probe_data, "?>", probelength);
    if (end) {
        u32 skip = (u32) (end - (const char*)probe_data) + 2; // +2 for "?>"
        probe_data += skip;
        probelength -= skip;
        
        // Skip whitespace after XML declaration
        while (probelength && probe_data[0] && strchr("\n\r\t ", (char) probe_data[0])) {
            probe_data++;
            probelength--;
        }
    }
}

// Skip DOCTYPE declaration <!DOCTYPE ... >
if (probelength>9 && !strncmp((const char*)probe_data, "<!DOCTYPE", 9)) {
    const char *end = my_strstr(probe_data, ">", probelength);
    if (end) {
        u32 skip = (u32) (end - (const char*)probe_data) + 1; // +1 for ">"
        probe_data += skip;
        probelength -= skip;
        
        // Skip whitespace after DOCTYPE declaration
        while (probelength && probe_data[0] && strchr("\n\r\t ", (char) probe_data[0])) {
            probe_data++;
            probelength--;
        }
    }
}

// Skip XML comments <!-- ... -->
while (probelength>4 && !strncmp((const char*)probe_data, "<!--", 4)) {
    const char *end = my_strstr(probe_data, "-->", probelength);
    if (!end) break;
    u32 skip = (u32) (end - (const char*)probe_data) + 3; // +3 for "-->"
    probe_data += skip;
    probelength -= skip;
    
    // Skip whitespace after comments
    while (probelength && probe_data[0] && strchr("\n\r\t ", (char) probe_data[0])) {
        probe_data++;
        probelength--;
    }
}