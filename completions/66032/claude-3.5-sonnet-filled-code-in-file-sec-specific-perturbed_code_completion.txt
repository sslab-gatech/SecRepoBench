while (probelength && strchr(" \t\r\n", probe_data[0])) {
    probe_data++;
    probelength--;
}

if (probelength > 5 && !strncmp(probe_data, "<?xml", 5)) {
    const char *end = my_strstr(probe_data, ">", probelength);
    if (end) {
        probelength -= (end - probe_data + 1);
        probe_data = end + 1;
    }
}

while (probelength > 2 && probe_data[0] == '<' && probe_data[1] == '!') {
    const char *end = my_strstr(probe_data, ">", probelength);
    if (!end) break;
    probelength -= (end - probe_data + 1);
    probe_data = end + 1;
}

while (probelength && strchr(" \t\r\n", probe_data[0])) {
    probe_data++;
    probelength--;
}