while (probelength && probe_data[0] && strchr("\n\r\t ", (char)probe_data[0])) {
	probe_data++;
	probelength--;
}

/* Strip XML headers, DOCTYPE declarations, and comments if present */
while (1) {
	/* remove XML declaration */
	if ((probelength > 5) && !strncmp((char*)probe_data, "<?xml", 5)) {
		const char *end = my_strstr(probe_data, "?>", probelength);
		if (!end) break;
		u32 skip_len = (u32)(end + 2 - (char*)probe_data);
		if (skip_len > probelength) break;
		probe_data += skip_len;
		probelength -= skip_len;
	}
	/* remove XML comments */
	else if ((probelength > 4) && !strncmp((char*)probe_data, "<!--", 4)) {
		const char *end = my_strstr(probe_data, "-->", probelength);
		if (!end) break;
		u32 skip_len = (u32)(end + 3 - (char*)probe_data);
		if (skip_len > probelength) break;
		probe_data += skip_len;
		probelength -= skip_len;
	}
	/* remove DOCTYPE declarations */
	else if ((probelength > 9) && !strncmp((char*)probe_data, "<!DOCTYPE", 9)) {
		const char *end = my_strstr(probe_data, ">", probelength);
		if (!end) break;
		u32 skip_len = (u32)(end + 1 - (char*)probe_data);
		if (skip_len > probelength) break;
		probe_data += skip_len;
		probelength -= skip_len;
	}
	else {
		break;
	}

	/* strip leading whitespace again after skipping content */
	while (probelength && probe_data[0] && strchr("\n\r\t ", (char)probe_data[0])) {
		probe_data++;
		probelength--;
	}
}