// Strip leading whitespace and newline characters from the probe_data.
while (probelength && strchr("\n\r\t ", (char)probe_data[0])) {
    probe_data++;
    probelength--;
}

// Remove XML-specific components, such as DOCTYPE declarations, XML headers, and comments.
if (my_strstr(probe_data, "<?xml", probelength)) {
    const char *next = my_strstr(probe_data, "?>", probelength);
    if (next) {
        u32 xml_header_len = next - (const char *)probe_data + 2;
        if (xml_header_len < probelength) {
            memmove((void *)probe_data, (const void *)(probe_data + xml_header_len), probelength - xml_header_len);
            probe_data += xml_header_len;
            probelength -= xml_header_len;
        }
    }
}

if (my_strstr(probe_data, "<!DOCTYPE", probelength)) {
    const char *doctype_end = my_strstr(probe_data, ">", probelength);
    if (doctype_end) {
        u32 doctype_len = doctype_end - (const char *)probe_data + 1;
        if (doctype_len < probelength) {
            memmove((void *)probe_data, (const void *)(probe_data + doctype_len), probelength - doctype_len);
            probe_data += doctype_len;
            probelength -= doctype_len;
        }
    }
}

// Strip XML comments
if (my_strstr(probe_data, "<!--", probelength)) {
    const char *comment_start = my_strstr(probe_data, "<!--", probelength);
    const char *comment_end = my_strstr(comment_start, "-->", probelength);
    if (comment_end) {
        u32 comment_len = comment_end - comment_start + 3;
        if (comment_len < probelength) {
            memmove((void *)probe_data, (const void *)(probe_data + comment_len), probelength - comment_len);
            probe_data += comment_len;
            probelength -= comment_len;
        }
    }
}