// Strip leading whitespace and newline characters from the probe_data.
while (probelength && probe_data[0] && strchr("\n\r\t ", (char) probe_data[0])) {
    probe_data++;
    probelength--;
}
if (!probelength) {
    if (dst) gf_free(dst);
    *score = GF_FPROBE_NOT_SUPPORTED;
    return NULL;
}

// Continue processing the probe_data to remove XML-specific components, such as DOCTYPE declarations, XML headers, and comments.
while (probelength > 0) {
    if (!strncmp(probe_data, "<?xml", 5)) {
        const char *end = my_strstr(probe_data, "?>", probelength);
        if (!end) break;
        probelength -= (u32)(end - probe_data + 2);
        probe_data = end + 2;
    } else if (!strncmp(probe_data, "<!--", 4)) {
        const char *end = my_strstr(probe_data, "-->", probelength);
        if (!end) break;
        probelength -= (u32)(end - probe_data + 3);
        probe_data = end + 3;
    } else if (!strncmp(probe_data, "<!DOCTYPE", 9)) {
        const char *end = my_strstr(probe_data, ">", probelength);
        if (!end) break;
        probelength -= (u32)(end - probe_data + 1);
        probe_data = end + 1;
    } else {
        break;
    }
}