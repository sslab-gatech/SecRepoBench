{
      // Server Hello
      offset += 1 + session_id_len; // Move past session ID length and session ID
      if (offset + 2 > total_len) return 0; // Ensure we don't read out of bounds

      // Extract the server's cipher suite
      u_int16_t server_cipher_suite = (packet->payload[offset] << 8) + packet->payload[offset + 1];
      offset += 2;

      // Construct JA3 string for Server Hello
      snprintf(ja3_str, sizeof(ja3_str), "%u,%u", tls_version, server_cipher_suite);

      // Compute MD5 hash of the JA3 string
      ndpi_MD5_Init(&ctx);
      ndpi_MD5_Update(&ctx, (unsigned char*)ja3_str, strlen(ja3_str));
      ndpi_MD5_Final(md5_hash, &ctx);

      // Store the computed JA3 hash in the flow structure
      memcpy(flow->protos.stun_ssl.ssl.server_ja3_hash, md5_hash, sizeof(md5_hash));

      return 2; // Indicate Server Hello processed
    }