if(handshake_type == 0x02 /* Server Hello */) {
  u_int16_t cipher_suite_offset = offset + 3 + session_id_len;
  u_int16_t cipher_suite_len = (packet->payload[cipher_suite_offset] << 16) + (packet->payload[cipher_suite_offset+1] << 8) + packet->payload[cipher_suite_offset+2];
  u_int16_t extensions_offset = cipher_suite_offset + 3 + cipher_suite_len;

  if((cipher_suite_len > 0) && (cipher_suite_offset + cipher_suite_len <= total_len)) {
    u_int16_t i;
    for(i = 0; i < cipher_suite_len; i += 2) {
      u_int16_t cipher_suite = (packet->payload[cipher_suite_offset+i] << 8) + packet->payload[cipher_suite_offset+i+1];
      // Process cipher suite
    }
  }

  if((packet->payload[extensions_offset] != 0x0) && (extensions_offset + 2 <= total_len)) {
    u_int16_t extensions_len = (packet->payload[extensions_offset] << 16) + (packet->payload[extensions_offset+1] << 8) + packet->payload[extensions_offset+2];
    u_int16_t ext_offset = extensions_offset + 3;

    while(ext_offset + 4 <= extensions_len + extensions_offset) {
      u_int16_t ext_type = (packet->payload[ext_offset] << 8) + packet->payload[ext_offset+1];
      u_int16_t ext_len = (packet->payload[ext_offset+2] << 8) + packet->payload[ext_offset+3];
      // Process extension
      ext_offset += 4 + ext_len;
    }
  }

  // Construct JA3 string and compute MD5 hash
  // ...
}