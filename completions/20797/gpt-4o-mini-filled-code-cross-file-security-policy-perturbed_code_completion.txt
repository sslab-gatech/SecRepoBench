{
        u_int16_t cipher_suite_offset = base_offset + 1 + session_id_len;
        u_int16_t cipher_suite_length = 2; // Length of the cipher suite
        u_int16_t cipher_suite;

        // Extract the cipher suite
        cipher_suite = (packet->payload[cipher_suite_offset] << 8) | packet->payload[cipher_suite_offset + 1];

        // Construct the JA3 string
        ja3_str_len = snprintf(ja3_str, sizeof(ja3_str), "%u,", tls_version);
        if (ja3_str_len >= sizeof(ja3_str)) return 0; // Prevent overflow

        ja3_str_len += snprintf(ja3_str + ja3_str_len, sizeof(ja3_str) - ja3_str_len, "%04X,", cipher_suite);
        if (ja3_str_len >= sizeof(ja3_str)) return 0; // Prevent overflow

        // Add more details to the JA3 string as needed (e.g., extensions)
        // ...

        // Compute the MD5 hash of the JA3 string
        md5_hash[0] = 0; // Initialize MD5 context
        // ... (MD5 computation logic here)

        // Store the computed JA3 hash in the flow structure
        memcpy(flow->l4.tcp.tls.ja3_hash, md5_hash, sizeof(md5_hash));

        return 1; // Indicate successful processing
    }