if (scpd > checkcpdtable.size())
            scpd = 0;
        }

        if (scpd > 0) {
          if (checkcpdtable[scpd - 1].pattern3.empty()) {
            if (checkcpdtable[scpd - 1].pattern2.empty()) {
              if (checkcpdtable[scpd - 1].pattern.empty()) {
                if (checkcpdtable[scpd - 1].cond) {
                  if (words[wordnum]->astr &&
                      TESTAFF(words[wordnum]->astr, checkcpdtable[scpd - 1].cond, words[wordnum]->alen))
                    rv = words[wordnum];
                } else
                  rv = words[wordnum];
              } else {
                if (checkcpdtable[scpd - 1].pattern[0] == '0') {
                  if (words[wordnum]->blen <= i &&
                      strncmp(word.c_str() + i - words[wordnum]->blen, words[wordnum]->word, words[wordnum]->blen) == 0)
                    rv = words[wordnum];
                } else {
                  size_t len = checkcpdtable[scpd - 1].pattern.size();
                  if (len <= i &&
                      strncmp(word.c_str() + i - len, checkcpdtable[scpd - 1].pattern.c_str(), len) == 0)
                    rv = words[wordnum];
                }
              }
            } else {
              if (checkcpdtable[scpd - 1].pattern2[0] == '0') {
                if (words[wordnum]->blen2 <= i &&
                    strncmp(word.c_str() + i - words[wordnum]->blen2, words[wordnum]->word2, words[wordnum]->blen2) == 0)
                  rv = words[wordnum];
              } else {
                size_t len = checkcpdtable[scpd - 1].pattern2.size();
                if (len <= i &&
                    strncmp(word.c_str() + i - len, checkcpdtable[scpd - 1].pattern2.c_str(), len) == 0)
                  rv = words[wordnum];
              }
            }
          } else {
            if (checkcpdtable[scpd - 1].pattern2.empty()) {
              if (checkcpdtable[scpd - 1].pattern[0] == '0') {
                if (words[wordnum]->blen <= i &&
                    strncmp(word.c_str() + i - words[wordnum]->blen, words[wordnum]->word, words[wordnum]->blen) == 0)
                  rv = words[wordnum];
              } else {
                size_t len = checkcpdtable[scpd - 1].pattern.size();
                if (len <= i &&
                    strncmp(word.c_str() + i - len, checkcpdtable[scpd - 1].pattern.c_str(), len) == 0)
                  rv = words[wordnum];
              }
            } else {
              if (checkcpdtable[scpd - 1].pattern2[0] == '0') {
                if (words[wordnum]->blen2 <= i &&
                    strncmp(word.c_str() + i - words[wordnum]->blen2, words[wordnum]->word2, words[wordnum]->blen2) == 0)
                  rv = words[wordnum];
              } else {
                size_t len = checkcpdtable[scpd - 1].pattern2.size();
                if (len <= i &&
                    strncmp(word.c_str() + i - len, checkcpdtable[scpd - 1].pattern2.c_str(), len) == 0)
                  rv = words[wordnum];
              }
            }
          }
        }

        if (rv) {
          if (TESTAFF(rv->astr, forbiddenword, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, nosuggest, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, nongramsuggest, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, needaffix, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, circumfix, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, onlyincompound, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, lemma_present, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, substandard, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, warn, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, forbidwarn, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checksharps, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, fullstrip, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, keepcase, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, forceucase, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, sugswithdots, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, nosplitsugs, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checknum, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompounddup, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundrep, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundcase, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundtriple, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, simplifiedtriple, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(rv->astr, checkcompoundpat, rv->alen)) {
            rv = NULL;
            break;
          }
          if (TESTAFF(