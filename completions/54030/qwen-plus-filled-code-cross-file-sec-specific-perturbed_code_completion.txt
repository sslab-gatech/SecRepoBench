if (checkcompoundrep && cpdrep_check(word, len))
  return NULL;

// Allocate memory for the compound result dynamically
size_t word_len = word.size();
char* compound_result = new (std::nothrow) char[word_len + 1];
if (!compound_result) {
  // Handle memory allocation failure
  return NULL;
}

// Ensure null termination
compound_result[word_len] = '\0';
 strncpy(compound_result, word.c_str(), word_len);

// Validate against compound pattern table conditions
bool isValidCompound = true;
for (const auto& pattern : checkcpdtable) {
  if (pattern.cond != FLAG_NULL &&
      !TESTAFF(rv->astr, pattern.cond, rv->alen)) {
    isValidCompound = false;
    break;
  }
}

// Free allocated memory to prevent memory leaks
delete[] compound_result;

if (!isValidCompound) {
  rv = NULL;
}