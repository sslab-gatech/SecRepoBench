mpz_t t;
  mpz_init(mrb, &t);
  mpz_div_2exp(mrb, &t, yy, ns);
  mpz_tdiv_q(mrb, &q, &x, &t);
  mpz_mul(mrb, &t, &q, yy);
  mpz_sub(mrb, &x, &x, &t);
  mpz_tdiv_q_2exp(mrb, &q, &q, ns);
  mpz_clear(mrb, &t);