for (index = xd - yd; index != (size_t)-1; index--) {
  mp_limb2 n = (index + 1 < xd ? ((mp_limb2)x.p[index + 1] << DIG_SIZE) : 0) | x.p[index];
  mp_limb d = n / z;
  mp_limb r = n % z;
  while (r <= MP_LIMB_MAX - y.p[yd - 2] && d * y.p[yd - 2] > (r << DIG_SIZE) + x.p[index - 1]) {
    d--;
    r += z;
  }
  submul(mrb, &x, &y, index, d);
  q.p[index] = d;
}