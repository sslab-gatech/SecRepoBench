for (index = 0; index < yd; index++) {
    if (mpz_cmp(mrb, &x, &y) >= 0) {
      mpz_sub(mrb, &x, &x, &y);
      mpz_setbit(mrb, &q, index);
    }
    urshift(mrb, &x, &x, 1);
  }