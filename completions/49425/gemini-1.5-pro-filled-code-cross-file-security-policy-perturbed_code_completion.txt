for (index = xd - yd; index >= 0; index--) {
    mp_limb2 qhat = udiv_qhat(x.p[index+yd-1], x.p[index+yd], z);
    if (qhat) {
      usubmul(mrb, &x, &y, index, qhat);
      while (x.sn) {
        qhat--;
        uadd(mrb, &x, &x, &y, index);
      }
    }
    q.p[index] = qhat;
  }