index = xd - yd;
  for (; index > 0; index--) {
    mp_limb2 v = x.p[index+yd-1];
    v <<= DIG_SIZE;
    v |= x.p[index+yd-2];
    mp_limb2 q0 = v / z;
    if (q0 >= DIG_BASE) q0 = DIG_BASE - 1;
    mp_limb2 c = q0 * z;
    size_t k;
    for (k=0; k<yd; k++) {
      c += (mp_limb2)y.p[k];
      x.p[index+k-1] -= LOW(c);
      c >>= DIG_SIZE;
    }
    x.p[index-1] -= c;
    q.p[index-1] = q0;
  }
  trim(&x);
  mpz_set(mrb, rr, &x);