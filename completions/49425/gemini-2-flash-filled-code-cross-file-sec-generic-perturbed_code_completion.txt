for (index = xd; index > yd; ) {
    index--;
    mp_limb1 num = x.p[index];
    mp_limb2 nn = ((mp_limb2)num << DIG_SIZE) | x.p[index-1];
    mp_limb1 d = nn / z;
    if (d > ((mp_limb1)MRB_INT_MAX))
      d = ((mp_limb1)MRB_INT_MAX);
    q.p[index-yd] = d;
    submul(mrb, &x, &y, d, index-yd);
    if (ucmp(&x, &y) < 0) {
      q.p[index-yd]--;
      addmul(mrb, &x, &y, 1, index-yd);
    }
  }