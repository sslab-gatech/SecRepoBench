for (index = 0; index < yd; index++) {
  mp_limb2 q = (z.p[xd-1] * z.p[xd-2] + (mp_limb2)x.p[xd+index-1] * z.p[xd-1] + (mp_limb2)x.p[xd+index] * z.p[xd-2] + x.p[xd+index] * y.p[yd-1]) / y.p[yd-1];
  mp_limb2 r = (z.p[xd-1] * z.p[xd-2] + (mp_limb2)x.p[xd+index-1] * z.p[xd-1] + (mp_limb2)x.p[xd+index] * z.p[xd-2] + x.p[xd+index] * y.p[yd-1]) % y.p[yd-1];
  z.p[xd+index] = q;
  z.p[xd-1] = r;
}