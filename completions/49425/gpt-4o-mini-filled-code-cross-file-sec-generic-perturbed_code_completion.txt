// Initialize the quotient and remainder
  mpz_set_int(mrb, &q, 0);
  size_t q_size = 0;

  // Perform long division
  for (size_t i = xd; i-- > 0; ) {
    // Shift left the current quotient
    mpz_lshift(mrb, &q, &q, 1);
    // Set the least significant bit of the quotient
    mpz_set_int(mrb, &x, 0);
    mpz_set_int(mrb, &x, xx->p[i]);
    if (mpz_cmp(mrb, &x, &y) >= 0) {
      mpz_sub(mrb, &x, &x, &y);
      mpz_set_int(mrb, &x, 1);
    } else {
      mpz_set_int(mrb, &x, 0);
    }
    // Update the remainder
    mpz_set(mrb, rr, &x);
  }