index = xd - yd;
  for (; index > 0; index--) {
    mp_limb2 v = x.p[index+yd-1];
    v <<= DIG_SIZE;
    v |= x.p[index+yd-2];
    mp_limb2 q0 = v / z;
    if (q0 >= DIG_BASE) q0 = DIG_BASE - 1;
    mp_limb2 c = 0;
    size_t i;
    for (i=0; i<yd; i++) {
      c += (mp_limb2)y.p[i] * q0;
      c += (mp_limb2)x.p[index+i-1];
      x.p[index+i-1] = LOW(c);
      c >>= DIG_SIZE;
    }
    x.p[index-1] -= c;
    q.p[index-1] = q0;
  }