for (index = xd - 1; index >= yd - 1; index--) {
    mp_limb2 q = ((mp_limb2)x.p[index] << DIG_SIZE | x.p[index-1]) / z;
    if (q > DIG_MASK) q = DIG_MASK;
    mp_limb2 cc = 0;
    for (size_t i = 0; i < yd; i++) {
      cc += (mp_limb2)y.p[i] * q;
      mp_limb2 diff = (mp_limb2)x.p[index-yd+1+i] - (cc & DIG_MASK);
      x.p[index-yd+1+i] = diff & DIG_MASK;
      cc = (cc >> DIG_SIZE) - (diff >> DIG_SIZE);
    }
    x.p[index] -= cc;
    while (x.p[index] > DIG_MASK) {
      q--;
      cc = 0;
      for (size_t i = 0; i < yd; i++) {
        cc += (mp_limb2)x.p[index-yd+1+i] + y.p[i];
        x.p[index-yd+1+i] = cc & DIG_MASK;
        cc >>= DIG_SIZE;
      }
      x.p[index] += cc;
    }
    q.p[index-yd] = q;
  }