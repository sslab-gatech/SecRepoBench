for (index = xd - 1; index > yd - 1; index--) {
    mp_limb_t qj = (x.p[index] / z);
    if (qj >= LIMB_MAX) qj = LIMB_MAX -1;
    mp_limb_t carry = 0;
    for (size_t j = 0; j < yd; j++) {
      mp_limb_t p = qj * y.p[j] + carry;
      carry = p / LIMB_MAX;
      p %= LIMB_MAX;
      x.p[index - yd + j] -= p;
      if (x.p[index - yd + j] > LIMB_MAX - p) {
        x.p[index - yd + j] += LIMB_MAX;
        carry++;
      }
    }
    x.p[index - yd] -= carry;
    q.p[index - (yd - 1)] = qj;
  }