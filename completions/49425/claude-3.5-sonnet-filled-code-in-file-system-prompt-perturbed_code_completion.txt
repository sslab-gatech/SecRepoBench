for (index = xd - 1; index >= yd - 1; index--) {
    mp_limb2 q = ((mp_limb2)x.p[index] << DIG_SIZE | x.p[index-1]) / z;
    if (q > DIG_MASK) q = DIG_MASK;
    mp_limb2 cc = 0;
    for (size_t i = 0; i < yd; i++) {
      cc += (mp_limb2)y.p[i] * q;
      mp_limb hi = HIGH(cc);
      mp_limb lo = LOW(cc);
      if (x.p[index-yd+1+i] < lo)
        hi++;
      x.p[index-yd+1+i] -= lo;
      cc = hi;
    }
    if (x.p[index+1] < cc)
      q--;
    q.p[index-yd+1] = q;
  }