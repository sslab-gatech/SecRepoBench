for (index = xd - yd; index >= 0; index--) {
  mp_limb2 q = (x.p[index + yd] * RADIX + x.p[index + yd - 1]) / z;
  mp_limb2 r = (x.p[index + yd] * RADIX + x.p[index + yd - 1]) - q * y.p[yd - 1];
  while (r < RADIX && q > 0) {
    q--;
    r += y.p[yd - 1];
  }
  x.p[index + yd] = 0;
  for (size_t j = 0; j < yd; j++) {
    mp_limb2 p = q * y.p[j];
    mp_limb2 t = x.p[index + j] - p;
    x.p[index + j] = t;
    if (t > x.p[index + j])
      x.p[index + j + 1]--;
  }
  q.p[index] = q;
}