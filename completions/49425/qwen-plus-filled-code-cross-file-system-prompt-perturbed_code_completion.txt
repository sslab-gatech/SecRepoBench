{
  mp_limb2 cy;
  size_t j;
  index = xd - yd;

  q.p[index] = divlimb(z, x.p[xd-1]);
  x.p[xd-1] = remlimb(z);
  for(j=xd-2; j >=yd; j--){
    cy = mulsub1(x.p+j, y.p, yd, q.p[index]);
    x.p[j] = cy;
    q.p[--index] = divlimb(z, x.p[j]);
    x.p[j] = remlimb(z);
  }
  if(yd > 1){
    mulsub1(x.p, y.p, yd-1, q.p[index]);
  }
  x.p[0] = sub_n(x.p, x.p, y.p+yd-1, 1);
}