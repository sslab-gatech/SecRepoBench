// Perform long division of the unsigned integers represented by `xx` and `yy`.
for (index = xd - yd; index + 1 > 0; index--) {
  mp_limb_t q = (x.p[index + yd] * RADIX + x.p[index + yd - 1]) / z;
  mp_limb_t r = (x.p[index + yd] * RADIX + x.p[index + yd - 1]) - q * y.p[yd - 1];
  mp_limb_t carry = 0;

  for (size_t j = 0; j < yd - 1; j++) {
    mp_limb_t p = y.p[j] * q + carry;
    carry = p >> DIG_SIZE;
    x.p[index + j] -= p & MASK;
  }

  x.p[index + yd - 1] -= carry;
  if (x.p[index + yd - 1] > x.p[index + yd])
    q--;

  q.p[index] = q;
}