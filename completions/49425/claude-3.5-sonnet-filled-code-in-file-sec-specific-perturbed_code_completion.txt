for (size_t i = xd - 1; i >= yd - 1; i--) {
    mp_limb2 q = ((mp_limb2)x.p[i] << DIG_SIZE | x.p[i-1]) / z;
    if (q > DIG_MASK) q = DIG_MASK;
    mp_limb2 cc = 0;
    for (size_t j = 0; j < yd; j++) {
      cc += (mp_limb2)y.p[j] * q;
      mp_limb2 diff = (mp_limb2)x.p[i-yd+1+j] - (cc & DIG_MASK);
      x.p[i-yd+1+j] = diff & DIG_MASK;
      cc = (cc >> DIG_SIZE) - (diff >> DIG_SIZE);
    }
    while (cc > 0) {
      mp_limb2 diff = (mp_limb2)x.p[i+1] - cc;
      x.p[i+1] = diff & DIG_MASK;
      cc = -(diff >> DIG_SIZE);
      i++;
    }
    q.p[i-yd] = q;
  }