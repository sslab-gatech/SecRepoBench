/* Check for specific Line protocol patterns */
if (packet->payload_packet_len >= 4) {
  /* Pattern 1: Specific payload sizes with characteristic header bytes */
  if ((packet->payload_packet_len == 25 && packet->payload[0] == 0x80) ||
      (packet->payload_packet_len == 16 && packet->payload[0] == 0x83) ||
      (packet->payload_packet_len == 11 && packet->payload[0] == 0x10)) {
    ndpi_int_line_add_connection(detectionmodulestruct, flow);
    return;
  }
  
  /* Pattern 2: Characteristic byte sequences at the beginning of the payload */
  if (packet->payload_packet_len >= 8) {
    if ((packet->payload[0] == 0x10 && packet->payload[1] == 0x01) ||
        (packet->payload[0] == 0x18 && packet->payload[1] == 0x01) ||
        (packet->payload[0] == 0x40 && packet->payload[1] == 0x01)) {
      ndpi_int_line_add_connection(detectionmodulestruct, flow);
      return;
    }
  }
  
  /* Pattern 3: Check for certain byte values that could indicate Line protocol */
  if (packet->payload_packet_len >= 16) {
    if ((packet->payload[12] == 0x16 && packet->payload[13] == 0x11) ||
        (packet->payload[12] == 0x17 && packet->payload[13] == 0x13)) {
      ndpi_int_line_add_connection(detectionmodulestruct, flow);
      return;
    }
  }
}