if(packet->payload_packet_len >= 16) {
  /* Example check #1: specific bytes at offsets 0 and 1 */
  if(packet->payload[0] == 0x80 && packet->payload[1] == 0x60) {
    ndpi_int_line_add_connection(detectionmodulestruct, flow);
    return;
  }

  /* Example check #2: another pattern at offset 2 and 3 */
  if(packet->payload[2] == 0x00 && packet->payload[3] == 0x1a) {
    ndpi_int_line_add_connection(detectionmodulestruct, flow);
    return;
  }
}

/* Example check #3: exact payload length and first two bytes */
if(packet->payload_packet_len == 24 &&
   packet->payload[0] == 0x80 && packet->payload[1] == 0x00) {
  ndpi_int_line_add_connection(detectionmodulestruct, flow);
  return;
}