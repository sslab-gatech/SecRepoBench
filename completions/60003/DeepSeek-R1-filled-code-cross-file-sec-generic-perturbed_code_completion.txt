if(packet->payload) {
      u_int16_t len = packet->payload_packet_len;

      /* Check for specific LINE protocol patterns */
      if((len == 16 && packet->payload[0] == 0x80 && packet->payload[2] == 0x00 &&
          packet->payload[4] == 0x00 && packet->payload[8] == 0x00 && packet->payload[12] == 0x00) ||
         (len == 20 && packet->payload[0] == 0x00 && packet->payload[2] == 0x00 &&
          packet->payload[4] == 0x00 && packet->payload[8] == 0x00 && packet->payload[12] == 0x00 &&
          packet->payload[16] == 0x00) ||
         (len == 24 && packet->payload[0] == 0x00 && packet->payload[2] == 0x00 &&
          packet->payload[4] == 0x00 && packet->payload[8] == 0x00 && packet->payload[12] == 0x00 &&
          packet->payload[16] == 0x00 && packet->payload[20] == 0x00)) {
        if(packet->payload[5] >= 0x01 && packet->payload[5] <= 0x03) {
          ndpi_int_line_add_connection(detectionmodulestruct, flow, NDPI_PROTOCOL_LINE);
          return;
        }
      }
    }