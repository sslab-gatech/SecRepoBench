if(packet->payload_packet_len > 10) {
  if(packet->payload_packet_len > 3) { // Ensure payload is long enough to access the 4th byte
    if(flow->l4.udp.line_pkts[packet->packet_direction] == 0) {
      flow->l4.udp.line_base_cnt[packet->packet_direction] = packet->payload[3];
      flow->l4.udp.line_pkts[packet->packet_direction] += 1;
      return;
    }
    // ... rest of the code ...
  }
}