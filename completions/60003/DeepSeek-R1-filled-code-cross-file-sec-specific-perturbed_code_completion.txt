if(packet->payload_packet_len >= 4) {
    if((packet->payload[0] == 0x02 || packet->payload[0] == 0x03) && packet->payload[3] == 0x00) {
        if(packet->payload_packet_len >= 20 && packet->payload_packet_len <= 256 && 
           (packet->payload_packet_len % 4) == 0) {
            ndpi_int_line_add_connection(detectionmodulestruct, flow);
            return;
        }
    }
    else if(packet->payload_packet_len == 16 && packet->payload[0] == 0x01 && 
            packet->payload[3] == 0x00 && ntohl(*((u_int32_t*)&packet->payload[4])) == 0x00000000) {
        ndpi_int_line_add_connection(detectionmodulestruct, flow);
        return;
    }
}