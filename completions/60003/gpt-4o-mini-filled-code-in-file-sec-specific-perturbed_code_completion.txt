if (packet->payload_packet_len > 0 && packet->payload_packet_len <= MAX_PAYLOAD_LENGTH) {
        // Example pattern check (this should be replaced with actual pattern checks)
        if (packet->payload[0] == EXPECTED_VALUE_1 && 
            packet->payload[1] == EXPECTED_VALUE_2 && 
            packet->payload[2] == EXPECTED_VALUE_3) {
            ndpi_int_line_add_connection(detectionmodulestruct, flow);
            return;
        }
    }