/*
      Only proceed if this is IPv4 traffic. Then perform a few heuristic checks:
      1) Verify that payload_packet_len is sufficient to safely access the
         necessary bytes in the payload.
      2) Compare specific byte values at known offsets.
      3) If a match is found, mark the flow as LINE and return.
    */
    if(packet->iph->version == 4 && packet->payload_packet_len >= 8) {
      /* Example pattern check #1: */
      if(packet->payload[0] == 0x01 && packet->payload[1] == 0x00 &&
         packet->payload[2] == 0x00 && packet->payload[3] == 0x01) {
        ndpi_int_line_add_connection(detectionmodulestruct, flow);
        return;
      }

      /* Example pattern check #2: */
      if(packet->payload_packet_len >= 12 &&
         packet->payload[4] == 0xAB && packet->payload[5] == 0xCD &&
         packet->payload[10] == 0x12 && packet->payload[11] == 0x34) {
        ndpi_int_line_add_connection(detectionmodulestruct, flow);
        return;
      }
    }