if(packet->payload_packet_len >= 4 &&
   packet->payload[0] == 'L' &&
   packet->payload[1] == 'I' &&
   packet->payload[2] == 'N' &&
   packet->payload[3] == 'E') {
  ndpi_int_line_add_connection(detectionmodulestruct, flow);
  return;
}

if(packet->payload_packet_len >= 8 &&
   packet->payload[0] == 0x24 && /* '$' */
   packet->payload[1] == 0x53 && /* 'S' */
   packet->payload[2] == 0x4c && /* 'L' */
   packet->payload[3] == 0x50 && /* 'P' */
   packet->payload[4] == 0x01) {
  ndpi_int_line_add_connection(detectionmodulestruct, flow);
  return;
}