if(packet->payload_packet_len > 20) {
      // Check for specific payload patterns
      if(packet->payload[0] == 0x01 && packet->payload[1] == 0x02 &&
         packet->payload[2] == 0x03 && packet->payload[3] == 0x04) {
        // Example heuristic: match specific byte sequence
        ndpi_int_line_add_connection(detectionmodulestruct, flow);
        return;
      }

      // Check for another pattern with length validation
      if(packet->payload_packet_len >= 30 &&
         packet->payload[10] == 0xAA && packet->payload[11] == 0xBB) {
        ndpi_int_line_add_connection(detectionmodulestruct, flow);
        return;
      }

      // Check for a specific string in the payload
      if(packet->payload_packet_len >= 25 &&
         memcmp(&packet->payload[5], "LINEPROTOCOL", 12) == 0) {
        ndpi_int_line_add_connection(detectionmodulestruct, flow);
        return;
      }
    }