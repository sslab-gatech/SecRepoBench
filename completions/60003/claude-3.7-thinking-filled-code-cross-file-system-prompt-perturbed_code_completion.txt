if(packet->payload_packet_len == 101) {
  if(packet->payload[0] == 0x80 && (packet->payload[1] == 0x01 || packet->payload[1] == 0x02)) {
    NDPI_LOG_DBG(detectionmodulestruct, "Found LINE by signature 1\n");
    ndpi_int_line_add_connection(detectionmodulestruct, flow);
    return;
  }
}

if(packet->payload_packet_len == 157) {
  if(packet->payload[0] == 0x80 && (packet->payload[1] == 0x01 || packet->payload[1] == 0x02)) {
    NDPI_LOG_DBG(detectionmodulestruct, "Found LINE by signature 2\n");
    ndpi_int_line_add_connection(detectionmodulestruct, flow);
    return;
  }
}

if(packet->payload_packet_len == 133) {
  if(packet->payload[0] == 0x80 && packet->payload[1] == 0x01) {
    NDPI_LOG_DBG(detectionmodulestruct, "Found LINE by signature 3\n");
    ndpi_int_line_add_connection(detectionmodulestruct, flow);
    return;
  }
}

if(packet->payload_packet_len == 117) {
  if(packet->payload[0] == 0x80 && packet->payload[1] == 0x01) {
    NDPI_LOG_DBG(detectionmodulestruct, "Found LINE by signature 4\n");
    ndpi_int_line_add_connection(detectionmodulestruct, flow);
    return;
  }
}

/* Check for LINE chat message patterns */
if(packet->payload_packet_len == 69) {
  if(packet->payload[0] == 0x91 && packet->payload[1] == 0x40) {
    NDPI_LOG_DBG(detectionmodulestruct, "Found LINE by signature 5\n");
    ndpi_int_line_add_connection(detectionmodulestruct, flow);
    return;
  }
}

/* Check for LINE voice/video call patterns */
if(packet->payload_packet_len > 4) {
  if((packet->payload[0] == 0x80 && packet->payload[1] == 0x02) ||
     (packet->payload[0] == 0x82 && packet->payload[1] == 0x02) ||
     (packet->payload[0] == 0x83 && packet->payload[1] == 0x82) ||
     (packet->payload[0] == 0x81 && packet->payload[1] == 0x42)) {
    NDPI_LOG_DBG(detectionmodulestruct, "Found LINE by signature 6\n");
    ndpi_int_line_add_connection(detectionmodulestruct, flow);
    return;
  }
}

/* Check for additional LINE packet signatures */
if(packet->payload_packet_len > 32) {
  if(packet->payload[0] == 0x83 && packet->payload[1] == 0x42 &&
     packet->payload[2] == 0x21 && packet->payload[3] == 0x43) {
    NDPI_LOG_DBG(detectionmodulestruct, "Found LINE by signature 7\n");
    ndpi_int_line_add_connection(detectionmodulestruct, flow);
    return;
  }
}