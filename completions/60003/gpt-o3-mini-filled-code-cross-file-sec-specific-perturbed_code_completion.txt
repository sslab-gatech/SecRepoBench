if(packet->payload_packet_len >= 4) {
  /* Check for the "LINE" ASCII signature at the beginning of the payload */
  if(packet->payload[0] == 'L' &&
     packet->payload[1] == 'I' &&
     packet->payload[2] == 'N' &&
     packet->payload[3] == 'E') {
    ndpi_int_line_add_connection(detectionmodulestruct, flow);
    return;
  }
}
if(packet->payload_packet_len >= 8) {
  /* Check for an alternative fixed pattern: 0xAA, 0x55 alternating for 8 bytes */
  if(packet->payload[0] == 0xAA &&
     packet->payload[1] == 0x55 &&
     packet->payload[2] == 0xAA &&
     packet->payload[3] == 0x55 &&
     packet->payload[4] == 0xAA &&
     packet->payload[5] == 0x55 &&
     packet->payload[6] == 0xAA &&
     packet->payload[7] == 0x55) {
    ndpi_int_line_add_connection(detectionmodulestruct, flow);
    return;
  }
}