static struct ndpi_proto packet_processing(struct ndpi_workflow * workflow,
					       const struct pcap_pkthdr *header,
					       const u_char *packet) {
  // ... (existing code)

  /* process the packet */
  return(packet_processing(workflow, time, vlan_id, tunnel_type, iph, iph6,
			   ip_offset, header->caplen - ip_offset,
			   header->caplen, header, packet, header->ts));
}