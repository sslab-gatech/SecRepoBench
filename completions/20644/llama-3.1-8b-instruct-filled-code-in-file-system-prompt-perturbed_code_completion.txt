if((iph->version == IPVERSION) && (iph->ihl * 4) > ipsize || ipsize < ntohs(iph->tot_len) || (iph->frag_off & htons(0x1FFF))!= 0) {
  workflow->stats.total_discarded_bytes +=  header->len;
  return(nproto);
}