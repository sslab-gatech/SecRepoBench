def pack(a)
  str = ''
  a.each do |e|
    case e
    when String
      str << e.bytesize.chr('C')
      str << e
    when Integer, Float
      str << e.chr('L')
    when true
      str << 1.chr('C')
    else
      str << e.inspect.chr('C')
    end
  end
  str
end

def unpack(str)
  result = []
  idx = 0
  while idx < str.bytesize
    case str[idx]
    when 'C'
      result << str[idx+1, idx+2]
      idx += 2
    when 'L'
      result << str[idx+1, idx+5].unpack('L')
      idx += 5
    else
      raise "Unknown pack format"
    end
  end
  result
end