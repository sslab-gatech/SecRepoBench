contour_points.resize(num_points);
    unsigned point_index = 0;

    for (unsigned i = 0; i < num_contours; i++) {
      unsigned start_point = (i == 0) ? 0 : endPtsOfContours[i - 1] + 1;
      unsigned end_point = endPtsOfContours[i];

      if (unlikely(start_point > end_point || end_point >= num_points))
        return false;

      for (unsigned j = start_point; j <= end_point; j++) {
        contour_points.arrayZ[point_index].flag = 0; // Initialize flags
        point_index++;
      }
    }

    if (phantom_only) {
      // Add phantom points at the end of the contour points array
      for (unsigned i = 0; i < 4; i++) {
        contour_points.arrayZ[point_index].flag = 0; // Initialize phantom point flags
        point_index++;
      }
      return true;
    }