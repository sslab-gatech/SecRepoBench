if (phantom_only)
  return true;

unsigned num_points = endPtsOfContours[num_contours];
if (unlikely (num_points > 0xFFFF)) return false;

contour_points.resize (num_points + 4); // +4 for phantom points

unsigned start_point = 0;
for (unsigned i = 0; i < num_contours; i++)
{
  unsigned end_point = endPtsOfContours[i];
  if (unlikely (end_point >= num_points || end_point < start_point))
    return false;
  contour_points[end_point].is_end_point = true;
  start_point = end_point + 1;
}

if (unlikely (num_points < 2)) return true;