// Validate the number of contours and initialize the contour points vector
    if (num_contours < 0 || num_contours > MAX_CONTOURS) return false;

    contour_points.length = num_contours + 1;
    if (!contour_points.allocate()) return false;

    // Initialize the end points of contours
    for (int i = 0; i <= num_contours; i++) {
        contour_points.arrayZ[i].flag = 0;
        contour_points.arrayZ[i].x = 0;
        contour_points.arrayZ[i].y = 0;
    }

    // If phantom_only is true, skip further processing
    if (phantom_only) return true;