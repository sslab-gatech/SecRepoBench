if (unlikely (num_contours == 0))
    {
      contour_points.resize (0);
      return true;
    }

    unsigned int num_points = endPtsOfContours[num_contours - 1] + 1;
    unsigned int num_phantoms = phantom_only ? 0 : 4;
    contour_points.resize (num_points + num_phantoms);

    for (unsigned int i = 0; i < num_contours; i++)
    {
      unsigned int end = endPtsOfContours[i];
      if (unlikely (end >= num_points)) return false;
      if (i > 0)
      {
	unsigned int start = endPtsOfContours[i - 1] + 1;
	for (unsigned int j = start; j <= end; j++)
	  contour_points[j].is_end_point = false;
      }
      contour_points[end].is_end_point = true;
    }

    if (phantom_only)
      return true;