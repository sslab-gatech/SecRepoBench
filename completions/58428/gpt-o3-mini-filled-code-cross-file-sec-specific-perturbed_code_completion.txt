unsigned num_real_points = endPtsOfContours[num_contours];
unsigned total_points = num_real_points + 4;  // allocate extra space for phantom points
if (!contour_points.resize(total_points))
  return false;
contour_points.length = num_real_points;
// Mark the end point of each contour.
for (unsigned i = 0; i < num_contours; ++i)
{
  unsigned contour_end = endPtsOfContours[i + 1];
  if (contour_end == 0 || contour_end > num_real_points)
    return false;
  // Set a flag on the last point of each contour.
  contour_points.arrayZ[contour_end - 1].flag |= 0x80;
}
if (phantom_only)
  return true;