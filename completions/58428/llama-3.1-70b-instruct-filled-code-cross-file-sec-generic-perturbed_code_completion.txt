// Initialize the contour points based on the end points of the contours.
contour_points.resize(num_contours + 1);
for (unsigned i = 0; i <= num_contours; i++)
{
  contour_points[i].x = 0;
  contour_points[i].y = 0;
  contour_points[i].flag = 0;
}

// Retrieve the end points of the contours from the header and validate the range.
if (unlikely (num_contours > endPtsOfContours.length / 2)) return false;

// Allocate memory for the contour points, including space for phantom points.
if (phantom_only)
{
  contour_points.resize(contour_points.length * 2);
  for (unsigned i = num_contours; i < contour_points.length; i++)
  {
    contour_points[i].x = 0;
    contour_points[i].y = 0;
    contour_points[i].flag = 0;
  }
}

// Set the end points of each contour in the points array.
for (unsigned i = 0; i <= num_contours; i++)
{
  contour_points[i].x = endPtsOfContours[i * 2];
  contour_points[i].y = endPtsOfContours[i * 2 + 1];
}