unsigned int num_contours = header.numberOfContours;
    if (unlikely (num_contours == 0)) return true;

    const HBUINT16 *endPtsOfContours = (const HBUINT16 *) (bytes.arrayZ + GlyphHeader::static_size);
    if (unlikely ((const char *) endPtsOfContours + 2 * (num_contours + 1) > bytes.arrayZ + bytes.length))
      return false;

    contour_points.alloc (endPtsOfContours[num_contours] + 1 + (phantom_only ? 0 : 0));
    if (unlikely (!contour_points.allocated)) return false;

    for (unsigned int i = 0; i < num_contours; i++)
    {
      contour_points.arrayZ[endPtsOfContours[i]].on_curve = true;
      contour_points.arrayZ[endPtsOfContours[i + 1]].on_curve = true;
    }

    if (phantom_only) return true;