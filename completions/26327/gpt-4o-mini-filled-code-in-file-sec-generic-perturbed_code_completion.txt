if (!timeparser->time_with_year) {
        time_now = now;
        gmtime_r(&time_now, &tmy);
        snprintf(tmp, sizeof(tmp), "%d %s", tmy.tm_year + 1900, time_str);
        fmt = timeparser->time_fmt_year;
    } else {
        snprintf(tmp, sizeof(tmp), "%s", time_str);
        fmt = timeparser->time_fmt_full;
    }

    p = flb_strptime(tmp, fmt, tm);