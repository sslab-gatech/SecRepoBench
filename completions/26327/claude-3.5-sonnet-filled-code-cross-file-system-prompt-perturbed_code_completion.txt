if (!strstr(time_str, "/") && !strstr(time_str, "-")) {
    time_now = now;
    gmtime_r(&time_now, &tmy);
    
    fmt = timeparser->time_fmt_year;
    if (fmt == NULL) {
        flb_error("[parser] time format (with year) not set");
        return -1;
    }
    
    snprintf(tmp, sizeof(tmp) - 1, "%d %.*s", tmy.tm_year + 1900, (int)tsize, time_str);
    tmp[sizeof(tmp) - 1] = '\0';
    time_ptr = tmp;
    time_len = strlen(tmp);
} else {
    memcpy(tmp, time_str, tsize);
    tmp[tsize] = '\0';
}

fmt = timeparser->time_fmt;
p = flb_strptime(time_ptr, fmt, tm);