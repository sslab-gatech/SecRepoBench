if (timeparser->time_with_year == FLB_TRUE) {
    /* The time string does not include the year, so use the current date to fill in the missing year. */
    time_now = time(NULL);
    gmtime_r(&time_now, &tmy);
    snprintf(tmp, sizeof(tmp), "%04d-%02d-%02d %s", tmy.tm_year + 1900, tmy.tm_mon + 1, tmy.tm_mday, time_str);
    p = flb_strptime(tmp, timeparser->time_fmt_year, tm);
} else {
    /* The time string includes the year, so copy it to a temporary buffer ensuring it is null-terminated. */
    memcpy(tmp, time_str, tsize);
    tmp[tsize] = '\0';
    p = flb_strptime(tmp, timeparser->time_fmt, tm);
}