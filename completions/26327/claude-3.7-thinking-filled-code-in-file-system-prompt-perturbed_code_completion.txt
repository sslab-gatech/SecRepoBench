if (timeparser->time_with_year == FLB_FALSE) {
    /* There is no year in the format, we need to pre-pend the year */
    if (now <= 0) {
        time_now = time(NULL);
    }
    else {
        time_now = now;
    }

    gmtime_r(&time_now, &tmy);
    int len = snprintf(tmp, sizeof(tmp) - 1, "%d %.*s",
                      tmy.tm_year + 1900, time_len, time_str);
    
    if (len == -1) {
        flb_error("[parser] error composing temporary time string");
        return -1;
    }

    fmt = timeparser->time_fmt_year;
    p = flb_strptime(tmp, fmt, tm);
}
else {
    /* The time format already includes the year */
    memcpy(tmp, time_str, time_len);
    tmp[time_len] = '\0';

    fmt = timeparser->time_fmt;
    p = flb_strptime(tmp, fmt, tm);
}