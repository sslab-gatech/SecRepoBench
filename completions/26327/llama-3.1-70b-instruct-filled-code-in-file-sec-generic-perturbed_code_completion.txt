if (timeparser->time_with_year == FLB_FALSE) {
    time_t time_now = now;
    struct tm tmy;
    char *p;

    /* Get the current date */
    gmtime_r(&time_now, &tmy);

    /* Create a temporary buffer to hold the modified time string with the year */
    memcpy(tmp, &tmy.tm_year + '0', 4);
    tmp[4] ='';
    memcpy(tmp + 5, time_str, tsize);
    tmp[tsize + 5] = '\0';

    /* Parse the modified time string with the year */
    p = flb_strptime(tmp, timeparser->time_fmt_year, tm);
    if (p == NULL) {
        flb_error("[parser] cannot parse '%.*s'", tsize, time_str);
        return -1;
    }
}
else {
    /* Copy the time string to a temporary buffer ensuring it is null-terminated */
    memcpy(tmp, time_str, tsize);
    tmp[tsize] = '\0';

    /* Parse the time string */
    p = flb_strptime(tmp, timeparser->time_fmt, tm);
    if (p == NULL) {
        flb_error("[parser] cannot parse '%.*s'", tsize, time_str);
        return -1;
    }
}