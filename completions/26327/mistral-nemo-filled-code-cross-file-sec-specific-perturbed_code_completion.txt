if (tsize > sizeof(tmp) - 1) {
        flb_error("[parser] time string length is too long");
        return -1;
    }

    if (strptime(time_str, "%Y-%m-%dT%H:%M:%S", &tmy) == NULL) {
        if (strptime(time_str, "%Y-%m-%d %H:%M:%S", &tmy) == NULL) {
            flb_error("[parser] cannot parse '%.*s'", tsize, time_str);
            return -1;
        }
    }

    if (tmy.tm_year < 70) {
        tmy.tm_year += 100;
    }

    snprintf(tmp, sizeof(tmp), "%d-%02d-%02dT%02d:%02d:%02d",
             tmy.tm_year, tmy.tm_mon + 1, tmy.tm_mday,
             tmy.tm_hour, tmy.tm_min, tmy.tm_sec);
    time_str = tmp;

    ret = flb_strptime(time_str, timeparser->time_fmt, tm);
    if (ret == NULL) {
        flb_error("[parser] cannot parse '%.*s'", tsize, time_str);
        return -1;
    }