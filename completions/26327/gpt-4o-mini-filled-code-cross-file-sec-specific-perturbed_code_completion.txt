if (time_len < 4) {
        // Year is missing, use current date to fill in the year
        time_now = time(NULL);
        gmtime_r(&time_now, &tmy);
        snprintf(tmp, sizeof(tmp), "%04d %s", tmy.tm_year + 1900, time_str);
        fmt = timeparser->time_fmt_year ? timeparser->time_fmt_year : timeparser->time_fmt;
        p = flb_strptime(tmp, fmt, tm);
    } else {
        // Year is included, copy to temporary buffer
        memcpy(tmp, time_str, time_len);
        tmp[time_len] = '\0'; // Ensure null-termination
        fmt = timeparser->time_fmt;
        p = flb_strptime(tmp, fmt, tm);
    }