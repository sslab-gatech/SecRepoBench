if (timeparser->time_fmt_year) {
    struct tm current;
    /* Get current date in UTC */
    if (gmtime_r(&now, &current) == NULL) {
        flb_error("[parser] failed to obtain current time");
        return -1;
    }
    /* Build a new time string: prepend current year and a space */
    snprintf(tmp, sizeof(tmp), "%04d %s", current.tm_year + 1900, time_str);
    time_len = strnlen(tmp, sizeof(tmp));
    time_ptr = tmp;
    /* Parse the modified time string that now includes the year */
    p = flb_strptime(time_ptr, timeparser->time_fmt_year, tm);
}
else {
    /* Ensure the input time string is null-terminated */
    memcpy(tmp, time_str, tsize);
    tmp[tsize] = '\0';
    time_ptr = tmp;
    /* Parse the time string using the expected format */
    p = flb_strptime(time_ptr, timeparser->time_fmt, tm);
}