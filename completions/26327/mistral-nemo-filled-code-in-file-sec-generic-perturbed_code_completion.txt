if (timeparser->time_with_year == FLB_TRUE) {
    /* The time string includes the year, so copy it to a temporary buffer ensuring it is null-terminated. */
    memcpy(tmp, time_str, tsize);
    tmp[tsize] = '\0';
    p = flb_strptime(tmp, timeparser->time_fmt, &tmy);
} else {
    /* The time string does not include the year, so use the current date to fill in the missing year. */
    time_now = time(NULL);
    gmtime_r(&time_now, &tmy);
    tmy.tm_year = now.tm_year;
    p = flb_strptime(time_str, timeparser->time_fmt_year, &tmy);
}