/* Get the current time */
    time_now = now;
    gmtime_r(&time_now, &tmy);

    /* Check if the time string includes the year */
    if (strchr(time_str, '-') == NULL) {
        /* Year is missing, prepend the current year */
        snprintf(tmp, sizeof(tmp), "%04d %.*s", tmy.tm_year + 1900, (int)tsize, time_str);
        time_ptr = tmp;
        time_len = strlen(tmp);
    } else {
        /* Copy the time string to a temporary buffer */
        memcpy(tmp, time_str, tsize);
        tmp[tsize] = '\0';
        time_ptr = tmp;
        time_len = tsize;
    }

    /* Parse the time string */
    fmt = timeparser->time_fmt_full;
    p = flb_strptime(time_ptr, fmt, tm);