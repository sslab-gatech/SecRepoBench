// Check if the time string does not include the year.
    if (timeparser->time_fmt_year) {
        // Get the current time
        time_now = now;
        gmtime_r(&time_now, &tmy);

        // Create a temporary buffer to hold the modified time string with the year.
        // Concatenate the current year to the beginning of the time string.
        snprintf(tmp, sizeof(tmp) - 1, "%04d %.*s", tmy.tm_year + 1900, (int)tsize, time_str);
        tmp[sizeof(tmp) - 1] = '\0';

        // Parse the modified time string with the year using `flb_strptime` and store results in `tm`.
        p = flb_strptime(tmp, timeparser->time_fmt_year, tm);
    }
    else {
        // If the time string includes the year, copy it to a temporary buffer ensuring it is null-terminated.
        memcpy(tmp, time_str, tsize);
        tmp[tsize] = '\0';

        // Parse the time string using `flb_strptime` with the expected format and store results in `tm`.
        p = flb_strptime(tmp, timeparser->time_fmt, tm);
    }