if (timeparser->time_with_year == FLB_FALSE) {
        /* Get the current time */
        time_now = now;
        gmtime_r(&time_now, &tmy);

        /* Concatenate the current year to the time string */
        snprintf(tmp, sizeof(tmp) - 1, "%d %.*s",
                 (tmy.tm_year + 1900), (int) tsize, time_str);
        tmp[sizeof(tmp) - 1] = '\0';

        /* Use the modified time string with the year */
        time_ptr = tmp;
        time_len = strlen(tmp);
    }

    /* Parse the time string */
    fmt = timeparser->time_with_year ? timeparser->time_fmt : timeparser->time_fmt_year;
    p = flb_strptime(time_ptr, fmt, tm);