// Check if the time string does not include the year.
if (time_len < 10) {
    // If the year is missing, use the current date to fill in the missing year.
    time_t time_now = now;
    struct tm tmy;
    gmtime_r(&time_now, &tmy);

    // Create a temporary buffer to hold the modified time string with the year.
    char tmp[64];
    snprintf(tmp, sizeof(tmp), "%04d-%02d-%02d %s", tmy.tm_year + 1900, tmy.tm_mon + 1, tmy.tm_mday, time_str);

    // Parse the modified time string with the year using `flb_strptime` and store results in `tm`.
    p = flb_strptime(tmp, timeparser->time_fmt, tm);
}
else {
    // If the time string includes the year, copy it to a temporary buffer ensuring it is null-terminated.
    strncpy(tmp, time_str, time_len);
    tmp[time_len] = '\0';

    // Parse the time string using `flb_strptime` with the expected format and store results in `tm`.
    p = flb_strptime(tmp, timeparser->time_fmt, tm);
}