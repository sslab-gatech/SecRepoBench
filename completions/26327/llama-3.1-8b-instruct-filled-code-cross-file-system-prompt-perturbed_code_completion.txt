// Check if the time string does not include the year.
    // If the year is missing, use the current date to fill in the missing year.
    // Create a temporary buffer to hold the modified time string with the year.
    // Concatenate the current year to the beginning of the time string.
    // Use `gmtime_r` to get the current date and fill the missing month and day.
    // Parse the modified time string with the year using `flb_strptime` and store results in `tm`.
    // If the time string includes the year, copy it to a temporary buffer ensuring it is null-terminated.
    // Parse the time string using `flb_strptime` with the expected format and store results in `tm`.
    if (timeparser->time_fmt_year) {
        // If the time string includes the year, copy it to a temporary buffer ensuring it is null-terminated.
        char tmp[64];
        if (time_len > sizeof(tmp) - 1) {
            flb_error("[parser] time string length is too long");
            return -1;
        }
        memcpy(tmp, time_ptr, time_len);
        tmp[time_len] = '\0';
        time_ptr = tmp;
        time_len = strlen(time_ptr);
    }

    // Parse the time string using `flb_strptime` with the expected format and store results in `tm`.
    p = flb_strptime(time_ptr, timeparser->time_fmt_year, tm);
    if (p == NULL) {
        flb_error("[parser] cannot parse '%.*s'", tsize, time_str);
        return -1;
    }

    // If the time string does not include the year, use the current date to fill in the missing year.
    if (p == time_ptr) {
        // Get the current date and fill the missing month and day.
        struct tm tmy;
        time_t time_now;
        time_now = time(NULL);
        gmtime_r(&time_now, &tmy);
        // Concatenate the current year to the beginning of the time string.
        char tmp[64];
        if (time_len > sizeof(tmp) - 1) {
            flb_error("[parser] time string length is too long");
            return -1;
        }
        sprintf(tmp, "%04d-%02d-%02d %02d:%02d:%02d", tmy.tm_year + 1900, tmy.tm_mon + 1, tmy.tm_mday, tmy.tm_hour, tmy.tm_min, tmy.tm_sec);
        time_ptr = tmp;
        time_len = strlen(time_ptr);
        // Parse the modified time string with the year using `flb_strptime` and store results in `tm`.
        p = flb_strptime(time_ptr, timeparser->time_fmt_year, tm);
        if (p == NULL) {
            flb_error("[parser] cannot parse '%.*s'", tsize, time_str);
            return -1;
        }
    }