if (tsize > sizeof(tmp) - 1) {
        flb_error("[parser] time string length is too long");
        return -1;
    }

    /*
     * Some records coming from old Syslog messages do not contain the
     * year, so it's required to ingest this information in the value
     * to be parsed.
     */
    // Check if the time string does not include the year.
    if (strchr(time_str, '-') == NULL || strchr(time_str, ' ') == NULL) {
        // If the year is missing, use the current date to fill in the missing year.
        time_t now = time(NULL);
        struct tm *tm = gmtime_r(&now, &tmy);
        snprintf(tmp, sizeof(tmp), "%d-%02d-%02d %s", tm->tm_year + 1900, tm->tm_mon + 1, tm->tm_mday, time_str);

        // Parse the modified time string with the year using `flb_strptime` and store results in `tm`.
        p = flb_strptime(tmp, "%Y-%m-%d %H:%M:%S", tm);
    } else {
        // If the time string includes the year, copy it to a temporary buffer ensuring it is null-terminated.
        strncpy(tmp, time_str, sizeof(tmp) - 1);
        tmp[sizeof(tmp) - 1] = '\0';

        // Parse the time string using `flb_strptime` with the expected format and store results in `tm`.
        p = flb_strptime(tmp, "%Y-%m-%d %H:%M:%S", tm);
    }

    if (p == NULL) {
        flb_error("[parser] cannot parse '%.*s'", tsize, time_str);
        return -1;
    }