if (timeparser->time_fmt_year) {
        if (strstr(timeparser->time_fmt_full, "%Y") == NULL &&
            strstr(timeparser->time_fmt_full, "%y") == NULL) {
            time(&time_now);
            gmtime_r(&time_now, &tmy);
            ret = snprintf(tmp, sizeof(tmp) - 1, "%d %.*s",
                           tmy.tm_year + 1900, (int) tsize, time_str);
            if (ret < 0 || ret >= sizeof(tmp) - 1) {
                flb_error("[parser] cannot format time string with year");
                return -1;
            }
            tmp[sizeof(tmp) - 1] = '\0';
            fmt = timeparser->time_fmt_year;
            p = flb_strptime(tmp, fmt, tm);
        }
        else {
            memcpy(tmp, time_str, tsize);
            tmp[tsize] = '\0';
            fmt = timeparser->time_fmt_full;
            p = flb_strptime(tmp, fmt, tm);
        }
    }
    else {
        memcpy(tmp, time_str, tsize);
        tmp[tsize] = '\0';
        fmt = timeparser->time_fmt_full;
        p = flb_strptime(tmp, fmt, tm);
    }