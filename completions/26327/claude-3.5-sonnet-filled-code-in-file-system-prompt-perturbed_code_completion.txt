if (timeparser->time_with_year == FLB_FALSE) {
    /* Given time string doesn't contain a year */
    if (now <= 0) {
        time_now = time(NULL);
    }
    else {
        time_now = now;
    }

    gmtime_r(&time_now, &tmy);
    uint64_t t = tmy.tm_year + 1900;

    fmt = timeparser->time_fmt_year;
    ret = snprintf(tmp, sizeof(tmp) - 1, "%lu %.*s", t, (int) tsize, time_str);
    if (ret == -1) {
        flb_error("[parser] snprintf failed");
        return -1;
    }
    time_len = ret;
    time_ptr = tmp;
}
else {
    memcpy(tmp, time_str, tsize);
    tmp[tsize] = '\0';
    time_ptr = tmp;
    fmt = timeparser->time_fmt;
}

p = flb_strptime(time_ptr, fmt, tm);