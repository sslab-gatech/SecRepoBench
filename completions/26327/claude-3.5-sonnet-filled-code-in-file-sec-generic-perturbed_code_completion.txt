if (timeparser->time_with_year == FLB_FALSE) {
        time_now = now;
        gmtime_r(&time_now, &tmy);
        uint64_t t = tmy.tm_year + 1900;

        fmt = timeparser->time_fmt_year;
        len = snprintf(tmp, sizeof(tmp) - 1, "%d %.*s", t, (int)tsize, time_str);
        if (len == -1) {
            flb_error("[parser] snprintf failed");
            return -1;
        }

        time_ptr = tmp;
        time_len = len;
    }
    else {
        fmt = timeparser->time_fmt;
        memcpy(tmp, time_str, tsize);
        tmp[tsize] = '\0';
        time_ptr = tmp;
        time_len = tsize;
    }

    p = flb_strptime(time_ptr, fmt, tm);