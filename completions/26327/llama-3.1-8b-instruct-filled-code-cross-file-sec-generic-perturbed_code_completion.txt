// Check if the time string does not include the year.
// If the year is missing, use the current date to fill in the missing year.
// Create a temporary buffer to hold the modified time string with the year.
// Concatenate the current year to the beginning of the time string.
// Use `gmtime_r` to get the current date and fill the missing month and day.
// Parse the modified time string with the year using `flb_strptime` and store results in `tm`.
// If the time string includes the year, copy it to a temporary buffer ensuring it is null-terminated.
// Parse the time string using `flb_strptime` with the expected format and store results in `tm`.
if (timeparser->time_fmt_year) {
    // If the time string includes the year, copy it to a temporary buffer ensuring it is null-terminated.
    char tmp[64];
    if (snprintf(tmp, sizeof(tmp), "%s", time_str) >= (int)sizeof(tmp)) {
        flb_error("[parser] time string length is too long");
        return -1;
    }
    tmp[sizeof(tmp) - 1] = '\0';
    time_str = tmp;
}

// Parse the time string using `flb_strptime` with the expected format and store results in `tm`.
p = flb_strptime(time_str, timeparser->time_fmt_year, tm);
if (p == NULL) {
    flb_error("[parser] cannot parse '%s'", time_str);
    return -1;
}