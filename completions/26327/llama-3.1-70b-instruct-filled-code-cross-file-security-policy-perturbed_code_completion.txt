// Check if the time string does not include the year.
if (timeparser->time_fmt_year) {
    // If the year is missing, use the current date to fill in the missing year.
    time_t time_now = time(NULL);
    struct tm tmy;
    gmtime_r(&time_now, &tmy);

    // Create a temporary buffer to hold the modified time string with the year.
    char year[16];
    strftime(year, sizeof(year), "%Y", &tmy);

    // Concatenate the current year to the beginning of the time string.
    size_t year_len = strlen(year);
    size_t time_str_len = tsize;
    if (year_len + time_str_len >= sizeof(tmp)) {
        flb_error("[parser] time string length is too long");
        return -1;
    }
    memcpy(tmp, year, year_len);
    memcpy(tmp + year_len, time_str, time_str_len);
    tmp[year_len + time_str_len] = '\0';

    // Parse the modified time string with the year using `flb_strptime` and store results in `tm`.
    p = flb_strptime(tmp, timeparser->time_fmt_year, tm);
} else {
    // If the time string includes the year, copy it to a temporary buffer ensuring it is null-terminated.
    if (tsize >= sizeof(tmp)) {
        flb_error("[parser] time string length is too long");
        return -1;
    }
    memcpy(tmp, time_str, tsize);
    tmp[tsize] = '\0';

    // Parse the time string using `flb_strptime` with the expected format and store results in `tm`.
    p = flb_strptime(tmp, timeparser->time_fmt_full, tm);
}