if (!memcmp(data + index, "esds", 4)) {
			GF_BitStream *tmp_bs;
			GF_Box *new_box = NULL;

			/* Ensure we have at least 4 bytes before 'esds' to account for the box size field */
			if (index < 4) {
				continue;
			}

			tmp_bs = gf_bs_new((unsigned char *)(data + index - 4), size - (index - 4), GF_FALSE);
			if (!tmp_bs) {
				continue;
			}
			gf_bs_set_cookie(tmp_bs, GF_ISOM_BS_COOKIE_NO_LOG);

			/* If an ESDS box already exists, remove and delete it */
			if (ptr->esds) {
				gf_isom_box_array_remove(s->child_boxes, (GF_Box *)ptr->esds);
				gf_isom_box_del((GF_Box *)ptr->esds);
				ptr->esds = NULL;
			}

			/* Parse a new box from the temporary bitstream */
			if (gf_isom_box_parse(&new_box, tmp_bs) == GF_OK) {
				/* If the box type is ESDS, update references and add it to the child boxes */
				if (new_box && new_box->type == GF_ISOM_BOX_TYPE_ESDS) {
					ptr->esds = (GF_ESDBox *) new_box;
					new_box->parent = (GF_Box *) s;
					gf_list_add(s->child_boxes, new_box);
				} else {
					gf_isom_box_del(new_box);
				}
			}
			gf_bs_del(tmp_bs);

			/* Advance index to skip past 'esds' */
			index += 3;
		}