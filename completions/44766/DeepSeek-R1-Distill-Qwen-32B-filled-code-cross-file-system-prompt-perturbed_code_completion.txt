if (data[index] == 'E' && data[index+1] == 'S' && data[index+2] == 'D' && data[index+3] == 'S') {
    GF_BitStream *new_bs = gf_bs_new(data + index, size - index, GF_BITSTREAM_READ);
    if (!new_bs) {
        gf_free(data);
        return GF_OUT_OF_MEM;
    }
    gf_bs_set_cookie(new_bs, GF_ISOM_BS_COOKIE_SUPPRESS_LOGS);
    
    GF_Box *existing_esds = gf_isom_box_find_child(s->child_boxes, GF_ISOM_BOX_TYPE_ESDS);
    if (existing_esds) {
        gf_isom_box_remove_child(s, existing_esds);
        gf_isom_box_del(existing_esds);
    }
    
    GF_Err parse_err = gf_isom_box_parse(&ptr->esds, new_bs);
    if (parse_err) {
        gf_bs_delete(new_bs);
        continue;
    }
    
    if (ptr->esds && ptr->esds->type == GF_ISOM_BOX_TYPE_ESDS) {
        gf_isom_box_add_child(s, ptr->esds);
    }
    
    gf_bs_delete(new_bs);
}