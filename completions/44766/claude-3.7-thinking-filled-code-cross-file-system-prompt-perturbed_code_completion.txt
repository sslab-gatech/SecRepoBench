if ((data[index]=='e') && (data[index+1]=='s') && (data[index+2]=='d') && (data[index+3]=='s')) {
    GF_BitStream *esds_bs;
    GF_Box *a;
    u64 bs_cookie;
    
    esds_bs = gf_bs_new(data + index - 4, size - index + 4, GF_BITSTREAM_READ);
    if (!esds_bs) continue;
    
    bs_cookie = gf_bs_get_cookie(bs);
    gf_bs_set_cookie(esds_bs, bs_cookie | GF_ISOM_BS_COOKIE_NO_LOGS);
    
    if (ptr->esd) {
        if (s->child_boxes) {
            gf_list_del_item(s->child_boxes, ptr->esd);
        }
        gf_isom_box_del((GF_Box *)ptr->esd);
        ptr->esd = NULL;
    }
    
    e = gf_isom_box_parse(&a, esds_bs);
    if (!e && (a->type == GF_ISOM_BOX_TYPE_ESDS)) {
        ptr->esd = (GF_ESDBox *)a;
        if (!s->child_boxes) s->child_boxes = gf_list_new();
        gf_list_add(s->child_boxes, a);
    } else if (a) {
        gf_isom_box_del(a);
    }
    
    gf_bs_del(esds_bs);
    break;
}