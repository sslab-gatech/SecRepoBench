// <MASK>
u32 esds_box_type = GF_ISOM_BOX_TYPE_ESDS;
GF_BitStream *esds_bs = gf_bs_new(data + index, size - index, GF_BITSTREAM_READ);
gf_bs_set_cookie(esds_bs, GF_ISOM_BS_COOKIE_SILENCE_LOGS);

GF_Box *esds_box = NULL;
GF_Err esds_err = gf_isom_box_parse(&esds_box, esds_bs);
if (esds_err == GF_OK && esds_box->type == esds_box_type) {
    GF_ProtectionSchemeInfoBox *sinf = (GF_ProtectionSchemeInfoBox *)gf_isom_box_find_child(s->child_boxes, GF_ISOM_BOX_TYPE_SINF);
    if (sinf && sinf->original_format) {
        gf_isom_box_del_parent(&s->child_boxes, esds_box);
        gf_isom_box_del(esds_box);
    }
    gf_list_add(s->child_boxes, esds_box);
}

gf_bs_del(esds_bs);
// </MASK>