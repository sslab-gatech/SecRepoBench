for (i=0; i<size-8; i++) {
    if ((data[i] == 'e') && (data[i+1] == 's') && (data[i+2] == 'd') && (data[i+3] == 's')) {
        GF_BitStream *esds_bs = gf_bs_new(data+i, size-i, GF_BITSTREAM_READ);
        GF_Box *esds = gf_isom_box_new(GF_ISOM_BOX_TYPE_ESDS);
        if (!esds) {
            gf_bs_del(esds_bs);
            return GF_OUT_OF_MEM;
        }
        gf_bs_set_cookie(esds_bs, GF_ISOM_BS_COOKIE_NO_LOGS);
        e = gf_isom_box_read(esds, esds_bs);
        gf_bs_del(esds_bs);
        if (e) {
            gf_isom_box_del(esds);
            return e;
        }
        if (ptr->esd) gf_isom_box_del((GF_Box *)ptr->esd);
        ptr->esd = (GF_ESDBox *)esds;
        gf_list_add(ptr->child_boxes, esds);
        break;
    }
}