if (data[index] == 'e' && data[index+1] == 's' && data[index+2] == 'd' && data[index+3] == 's') {
    GF_BitStream *new_bs = gf_bs_new(data + index, size - index, GF_BITSTREAM_READ);
    if (new_bs) {
        gf_bs_set_cookie(new_bs, GF_BITSTREAM_COOKIE_NO_LOG);
        GF_Box *esds_box = NULL;
        GF_Err err = gf_isom_box_parse(&esds_box, new_bs);
        if (!err && esds_box && esds_box->type == GF_ISOM_BOX_TYPE_ESDS) {
            GF_Box *existing_esds = gf_isom_box_find_child(ptr->child_boxes, GF_ISOM_BOX_TYPE_ESDS);
            if (existing_esds) {
                gf_list_del_item(ptr->child_boxes, existing_esds);
                gf_isom_box_del(existing_esds);
            }
            gf_list_add(ptr->child_boxes, esds_box);
        }
        gf_bs_del(new_bs);
    }
}