if ((data[index]=='e') && (data[index+1]=='s') && (data[index+2]=='d') && (data[index+3]=='s')) {
    GF_BitStream *esds_bs = gf_bs_new(data + index, size - index, GF_BITSTREAM_READ);
    if (!esds_bs) {
        gf_free(data);
        return GF_OUT_OF_MEM;
    }
    gf_bs_set_cookie(esds_bs, gf_bs_get_cookie(bs) | GF_ISOM_BS_COOKIE_NO_LOGS);

    GF_Box *esds = NULL;
    if (ptr->esd) {
        gf_isom_box_del_parent(&ptr->child_boxes, ptr->esd);
        ptr->esd = NULL;
    }

    GF_Err err = gf_isom_box_parse(&esds, esds_bs);
    if (!err && esds && (esds->type == GF_ISOM_BOX_TYPE_ESDS)) {
        ptr->esd = (GF_ESDBox *)esds;
        gf_list_add(ptr->child_boxes, esds);
    } else if (esds) {
        gf_isom_box_del(esds);
    }

    gf_bs_del(esds_bs);
    break;
}