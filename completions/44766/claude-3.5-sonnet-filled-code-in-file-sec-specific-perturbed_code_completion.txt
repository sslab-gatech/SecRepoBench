// <MASK>
if (ptr->size < 16) {
    GF_LOG(GF_LOG_ERROR, GF_LOG_CONTAINER, ("[iso file] Invalid size %llu in fpar box\n", ptr->size));
    return GF_ISOM_INVALID_FILE;
}

ptr->item_ID = gf_bs_read_u16(bs);
ptr->FEC_encoding_ID = gf_bs_read_u16(bs);
ptr->FEC_instance_ID = gf_bs_read_u16(bs);
ptr->max_source_block_length = gf_bs_read_u16(bs);
ptr->encoding_symbol_length = gf_bs_read_u16(bs);
ptr->max_number_of_encoding_symbols = gf_bs_read_u16(bs);

ISOM_DECREASE_SIZE(ptr, 12);

ptr->block_count = gf_bs_read_u16(bs);
ISOM_DECREASE_SIZE(ptr, 2);

if (ptr->size < 2 * ptr->block_count) {
    GF_LOG(GF_LOG_ERROR, GF_LOG_CONTAINER, ("[iso file] Invalid number of blocks %d in fpar box\n", ptr->block_count));
    return GF_ISOM_INVALID_FILE;
}

ptr->block_sizes = gf_malloc(sizeof(u32) * ptr->block_count);
if (!ptr->block_sizes) return GF_OUT_OF_MEM;

for (i=0; i<ptr->block_count; i++) {
    ptr->block_sizes[i] = gf_bs_read_u16(bs);
    ISOM_DECREASE_SIZE(ptr, 2);
}