if (!strncmp(data+index, "esds", 4)) {
			GF_BitStream *esds_bs;
			GF_ESDSBox *esds;
			u64 rem, pos2;

			esds_bs = gf_bs_new(data+index, size-index, GF_BITSTREAM_READ);
			if (!esds_bs) {
				gf_free(data);
				return GF_OUT_OF_MEM;
			}
			gf_bs_set_cookie(esds_bs, GF_ISOM_BS_COOKIE_NO_LOG);
			pos2 = gf_bs_get_position(bs);
			if (ptr->esds) gf_isom_box_del((GF_Box *)ptr->esds);
			esds = NULL;
			gf_isom_box_parse((GF_Box **)&esds, esds_bs);
			rem = gf_bs_available(esds_bs);
			gf_bs_del(esds_bs);

			if (esds) {
				if (esds->type == GF_ISOM_BOX_TYPE_ESDS) {
					ptr->esds = esds;
					gf_bs_seek(bs, pos2);
					if (rem) gf_bs_skip_bytes(bs, (u32)rem);
					gf_free(data);
					return GF_OK;
				} else {
					gf_isom_box_del((GF_Box *)esds);
				}
			} else {
				gf_bs_seek(bs, pos2);
			}
			break;
		}