if (!memcmp(&data[index + 4], "esds", 4)) {
	u32 box_size = (u32)((data[index] << 24) | (data[index + 1] << 16) | (data[index + 2] << 8) | data[index + 3]);
	if (box_size >= 8 && box_size <= (size - index)) {
		GF_BitStream *tmp_bs = gf_bs_new((unsigned char*)&data[index], box_size, GF_BITSTREAM_READ);
		if (tmp_bs) {
			/* suppress logging on this temporary bitstream */
			gf_bs_set_cookie(tmp_bs, GF_LOG_SILENT);

			/* remove any existing ESDS box */
			{
				GF_Box *existing_esds = gf_isom_box_find_child(s->child_boxes, GF_ISOM_BOX_TYPE_ESDS);
				if (existing_esds) {
					gf_list_rem(s->child_boxes, existing_esds);
					gf_isom_box_del(existing_esds);
				}
			}

			/* parse the new ESDS box */
			{
				GF_Box *esds_box = NULL;
				GF_Err tmp_e = gf_isom_box_read(&esds_box, tmp_bs);
				if (!tmp_e && esds_box && (esds_box->type == GF_ISOM_BOX_TYPE_ESDS)) {
					gf_isom_box_add_child(s, esds_box);
				} else if (esds_box) {
					gf_isom_box_del(esds_box);
				}
			}

			gf_bs_del(tmp_bs);
		}
	}
}