if ((data[index+4] == 'e') && (data[index+5] == 's') &&
    (data[index+6] == 'd') && (data[index+7] == 's'))
{
	u32 box_size = GF_ReadBig32((unsigned char*)(data + index));
	if ((box_size >= 8) && ((index + box_size) <= size)) {
		GF_BitStream *tmp_bs = gf_bs_new((unsigned char *)(data + index), box_size, 0);
		GF_Box *child_box = NULL;
		if (!tmp_bs) {
			e = GF_OUT_OF_MEM;
			break;
		}
		gf_bs_set_cookie(tmp_bs, GF_ISOM_BS_COOKIE_NO_LOG);

		if (ptr->esds) {
			gf_isom_box_remove_child(s->child_boxes, (GF_Box *)ptr->esds);
			gf_isom_box_del((GF_Box *)ptr->esds);
			ptr->esds = NULL;
		}

		e = gf_isom_box_parse(&child_box, tmp_bs);
		if (!e && child_box && (child_box->type == GF_ISOM_BOX_TYPE_ESDS)) {
			gf_isom_box_add_child(s, child_box);
			ptr->esds = (GF_ESDBox*)child_box;
		} else if (child_box) {
			gf_isom_box_del(child_box);
		}

		gf_bs_del(tmp_bs);
		/* we've handled the esds box, exit this loop */
		break;
	}
}