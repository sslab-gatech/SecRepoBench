for (index = 0; index < size - 8; index++) {
	if ((data[index] == 'e') && (data[index + 1] == 's') &&
	    (data[index + 2] == 'd') && (data[index + 3] == 's'))
	{
		GF_Box *tmp_esds = NULL;
		GF_BitStream *new_bs = gf_bs_new((unsigned char *)&data[index], (u32)(size - index), GF_BITSTREAM_READ);
		if (!new_bs) {
			e = GF_OUT_OF_MEM;
			break;
		}
		gf_bs_set_cookie(new_bs, GF_ISOM_BS_SUPPRESS_PRINT);

		/* If there's an existing ESDS box, remove it before parsing the new one */
		{
			GF_Box *old_esds = gf_isom_box_find_child(s->child_boxes, GF_ISOM_BOX_TYPE_ESDS);
			if (old_esds) {
				gf_list_rem(s->child_boxes, old_esds);
				gf_isom_box_del(old_esds);
			}
		}

		e = gf_isom_box_parse(&tmp_esds, new_bs);
		if (!e && tmp_esds && (tmp_esds->type == GF_ISOM_BOX_TYPE_ESDS)) {
			gf_list_add(s->child_boxes, tmp_esds);
		} else {
			if (tmp_esds) gf_isom_box_del(tmp_esds);
		}

		gf_bs_del(new_bs);
		if (!e) e = GF_OK;
		break;
	}
}