j=1;
  for (n=0; dash_offset > 0.0; j=0)
  {
    if (draw_info->dash_pattern[n] <= 0.0)
      break;
    length=scale*(draw_info->dash_pattern[n]+(n == 0 ? -0.5 : 0.5));
    if (dash_offset > length)
      {
        dash_offset-=length;
        n++;
        if (fabs(draw_info->dash_pattern[n]) < DrawEpsilon)
          n=0;
        length=scale*(draw_info->dash_pattern[n]+(n == 0 ? -0.5 : 0.5));
        continue;
      }
    if (dash_offset < length)
      {
        length-=dash_offset;
        dash_offset=0.0;
        break;
      }
    dash_offset=0.0;
    n++;
    if (fabs(draw_info->dash_pattern[n]) < DrawEpsilon)
      n=0;
  }