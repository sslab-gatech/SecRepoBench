u_int realm_offset = name_offset + cname_len + 2;

// Check if the cname string ends with a '$' to determine if it's a hostname
if(cname_str[cname_len - 1] == '$') {
    cname_str[cname_len - 1] = '\0'; // Strip the trailing '$'
    strncpy(flow->protos.kerberos.hostname, cname_str, sizeof(flow->protos.kerberos.hostname) - 1);
    flow->protos.kerberos.hostname[sizeof(flow->protos.kerberos.hostname) - 1] = '\0';
#ifdef KERBEROS_DEBUG
    printf("[AS-REQ][Kerberos Hostname][len: %u][%s]\n", cname_len - 1, flow->protos.kerberos.hostname);
#endif
} else {
    strncpy(flow->protos.kerberos.username, cname_str, sizeof(flow->protos.kerberos.username) - 1);
    flow->protos.kerberos.username[sizeof(flow->protos.kerberos.username) - 1] = '\0';
#ifdef KERBEROS_DEBUG
    printf("[AS-REQ][Kerberos Username][len: %u][%s]\n", cname_len, flow->protos.kerberos.username);
#endif
}

// Increment the realm offset by scanning through the flow packet payload until a specific ASN.1 identifier is found
for(i = 0; i < 10 && realm_offset < flow_packet->payload_packet_len; i++) {
    if(flow_packet->payload[realm_offset] == 0x1b) {
        break;
    }
    realm_offset++;
}