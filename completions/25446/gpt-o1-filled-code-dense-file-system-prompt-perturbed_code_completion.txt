realm_offset = name_offset + 1 + cname_len;

		    /* If the cname ends with '$', treat it as a hostname, otherwise treat it as a username */
		    if(cname_len && cname_str[cname_len - 1] == '$') {
		      cname_str[cname_len - 1] = '\0';
		      snprintf(flow->protos.kerberos.hostname, sizeof(flow->protos.kerberos.hostname), "%s", cname_str);
		    } else {
		      snprintf(flow->protos.kerberos.username, sizeof(flow->protos.kerberos.username), "%s", cname_str);
		    }

		    /* Advance realm_offset until we find ASN.1 identifier 0x1b or we've reached our max tries */
		    for(i = 0; i < 10 && realm_offset < flow_packet->payload_packet_len; i++) {
		      if(flow_packet->payload[realm_offset] == 0x1b)
			break;
		      realm_offset++;
		    }