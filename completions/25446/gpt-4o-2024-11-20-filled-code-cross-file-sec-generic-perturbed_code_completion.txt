// Calculate the offset for the Kerberos realm data within the flow packet payload.
		    realm_offset = name_offset + cname_len + 1;

		    // Determine if the cname string represents a hostname or a username.
		    if (cname_len > 0 && cname_str[cname_len - 1] == '$') {
		      // If it ends with a '$', treat it as a hostname and strip the '$'.
		      cname_str[cname_len - 1] = '\0';
		      snprintf(flow->protos.kerberos.hostname, sizeof(flow->protos.kerberos.hostname), "%s", cname_str);
		    } else {
		      // Otherwise, treat it as a username.
		      snprintf(flow->protos.kerberos.username, sizeof(flow->protos.kerberos.username), "%s", cname_str);
		    }

		    // Increment the realm offset by scanning through the payload for the ASN.1 identifier (0x1b).
		    for (i = 0; i < 20 && realm_offset < flow_packet->payload_packet_len; i++) {
		      if (flow_packet->payload[realm_offset] == 0x1b) {
		        break;
		      }
		      realm_offset++;
		    }