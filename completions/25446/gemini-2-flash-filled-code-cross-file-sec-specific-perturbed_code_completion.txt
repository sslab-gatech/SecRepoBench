u_int16_t realm_offset = name_offset + 1 + cname_len;
		    char *cname_ptr = cname_str;

		    if(cname_len > 0 && cname_str[cname_len-1] == '$') {
		      cname_str[cname_len-1] = '\0';
		      snprintf(flow->protos.kerberos.hostname, sizeof(flow->protos.kerberos.hostname), "%s", cname_str);
		    } else {
		      snprintf(flow->protos.kerberos.username, sizeof(flow->protos.kerberos.username), "%s", cname_str);
		    }

		    for(i=0; (i<20) && (realm_offset < flow_packet->payload_packet_len); i++) {
		      if(flow_packet->payload[realm_offset] != 0x1b)
			realm_offset++; /* ASN.1 */
		      else
			break;
		    }
		  }
		}
	      }
	    } else if(msg_type == 0x0E) /* KRB-ERROR */ {
#ifdef KERBEROS_DEBUG
            printf("[Kerberos] Processing KRB-ERROR\n");
#endif
            /* No specific processing for KRB-ERROR, just detect the protocol */
            ndpi_int_kerberos_add_connection(ndpi_struct, flow);
            return;
        }