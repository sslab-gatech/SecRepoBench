int32_t coffsets_cbytes;
  int64_t* offsets = get_coffsets(frame, headerlength, cbytes, &coffsets_cbytes);
  if (offsets == NULL) {
    BLOSC_TRACE_ERROR("Cannot get the offsets for the frame.");
    return BLOSC2_ERROR_DATA;
  }

  if (coffsets_cbytes == 0) {
    *offset = cbytes;
  } else {
    *offset = offsets[nchunk];
  }

  return 0;