int32_t coffsets_cbytes;
  uint8_t *coffsets = get_coffsets(frame, header_len, cbytes, &coffsets_cbytes);
  if (coffsets == NULL) {
    BLOSC_TRACE_ERROR("Unable to get offsets for frame.");
    return BLOSC2_ERROR_DATA;
  }

  // Decompress offsets
  blosc2_dparams off_dparams = BLOSC2_DPARAMS_DEFAULTS;
  blosc2_context *dctx = blosc2_create_dctx(off_dparams);
  int32_t off_nbytes = (nchunk + 1) * sizeof(int64_t);
  int64_t *offsets = malloc((size_t)off_nbytes);
  int32_t nbytes = blosc2_decompress_ctx(dctx, coffsets, coffsets_cbytes, offsets, off_nbytes);
  blosc2_free_ctx(dctx);
  if (nbytes < 0) {
    free(offsets);
    BLOSC_TRACE_ERROR("Unable to decompress offsets.");
    return nbytes;
  }

  *offset = offsets[nchunk];
  free(offsets);
  return 0;