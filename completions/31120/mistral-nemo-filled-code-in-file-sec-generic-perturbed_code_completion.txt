/* Create a new (empty) frame */
blosc2_frame_s* frame_new(const char* urlpath) {
  blosc2_frame_s* new_frame = (blosc2_frame_s*)calloc(1, sizeof(blosc2_frame_s));
  if (urlpath != NULL) {
    char* new_urlpath = (char*)malloc(strlen(urlpath) + 1);  // + 1 for the trailing NULL
    strcpy(new_urlpath, urlpath);
    new_frame->urlpath = new_urlpath;
  }
  return new_frame;
}

/* Free memory from a frame. */
int frame_free(blosc2_frame_s* frame) {
  if (frame->cframe != NULL) {
    free(frame->cframe);
  }

  if (frame->urlpath != NULL) {
    free(frame->urlpath);
  }

  free(frame);

  return 0;
}