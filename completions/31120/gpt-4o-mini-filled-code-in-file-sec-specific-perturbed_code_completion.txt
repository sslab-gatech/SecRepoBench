// Retrieve the offsets for all chunks in the frame using helper function.
  int ret = get_coffsets(frame, headerlength, cbytes, &offset);
  if (ret < 0) {
    BLOSC_TRACE_ERROR("Cannot get the offsets for the frame.");
    return ret;
  }

  // Obtain the offset for the specified chunk index within the offsets data.
  if (nchunk < 0 || nchunk >= (headerlength / sizeof(int64_t))) {
    BLOSC_TRACE_ERROR("Chunk index out of bounds.");
    return BLOSC2_ERROR_INVALID_PARAM;
  }

  *offset = *(int64_t *)(frame->coffsets + nchunk * sizeof(int64_t));
  return 0;