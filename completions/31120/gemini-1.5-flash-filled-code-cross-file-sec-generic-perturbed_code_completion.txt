int64_t* offsets = NULL;
  int rcode = get_offsets(frame, headerlength, cbytes, &offsets);
  if (rcode < 0) {
    BLOSC_TRACE_ERROR("Could not retrieve chunk offsets.");
    return rcode;
  }
  if (nchunk < 0 || nchunk >= frame->nchunks) {
    BLOSC_TRACE_ERROR("Invalid chunk index: %d", nchunk);
    free(offsets);
    return BLOSC2_ERROR_INVALID_PARAM;
  }
  *offset = offsets[nchunk];
  free(offsets);
  return 0;