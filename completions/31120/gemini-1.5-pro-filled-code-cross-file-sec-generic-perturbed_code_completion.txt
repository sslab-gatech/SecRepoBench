int32_t off_nbytes;
  int ret = get_nchunks(frame, headerlength, cbytes, &nchunk, &off_nbytes);
  if (ret < 0) {
    BLOSC_TRACE_ERROR("Problem getting the offsets chunk.");
    return ret;
  }

  if (nchunk < 0) {
    *offset = nchunk;
    return 0;        // Special value
  }

  uint8_t* offsets = get_coffsets(frame, headerlength, cbytes, &off_nbytes);

  if (offsets == NULL) {
    BLOSC_TRACE_ERROR("Problem getting the offsets chunk.");
    return BLOSC2_ERROR_FAILURE;
  }

  // offsets has the absolute position
  int64_t offset_;
  memcpy(&offset_, offsets + nchunk * sizeof(int64_t), sizeof(int64_t));
  *offset = offset_;

  return 0;