int64_t* coffsets = NULL;
  size_t coffsets_size = 0;
  int rcode = blosc2_get_chunk_offsets(frame, &coffsets, &coffsets_size);
  if (rcode < 0) {
    BLOSC_TRACE_ERROR("Could not retrieve chunk offsets.");
    return rcode;
  }
  if (nchunk >= coffsets_size / sizeof(int64_t)) {
    BLOSC_TRACE_ERROR("nchunk exceeds the number of chunks in the frame.");
    free(coffsets);
    return BLOSC2_ERROR_INVALID_PARAM;
  }
  *offset = coffsets[nchunk];
  free(coffsets);
  return 0;