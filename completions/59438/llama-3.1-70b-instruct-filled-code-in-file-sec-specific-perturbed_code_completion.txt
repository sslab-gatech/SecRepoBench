const unsigned char *uc_start = uc;
uint32_t rec_count = 0, tapemark_count = 0;
while (uc < end_pointer) {
    uint32_t len = getlen(&uc);
    if (len == 0xffffffff) {
        // End of Medium (EOM) marker found, stop parsing
        break;
    }
    if (len == 0) {
        // Tapemark found, increment count
        tapemark_count++;
        if (tapemark_count >= SIMH_TAPEMARKS) {
            // Stop processing if tapemark limit is reached
            break;
        }
    } else {
        // Data record found, increment count
        rec_count++;
        // Check if data record length matches its complementary length
        if (uc + len > end_pointer || getlen(&uc)!= len) {
            // Invalid data, return 0
            return 0;
        }
    }
}
// Check if any records or tapemarks were found
if (rec_count == 0 && tapemark_count == 0) {
    // No valid SIMH data found, return 0
    return 0;
}
// Valid SIMH data found, return 1
return 1;