int records = 0, tapemarks = 0;
const unsigned char *p = uc;

while (p < end_pointer) {
    uint32_t len = getlen(p);
    p += sizeof(uint32_t);

    if (len == 0xFFFFFFFF) 
        break;

    if (p + len > end_pointer) 
        return 0;

    if (len == 0) {
        tapemarks++;
        if (tapemarks == SIMH_TAPEMARKS)
            break;
    } else {
        if (getlen(p + len) != len) 
            return 0;
        records++;
        p += len;
    }
}

return (records || tapemarks) ? 1 : 0;