{
    uint32_t tapemarks = 0, recs = 0;

    while (uc + 4 <= end_pointer) {
        uint32_t l = getlen(&uc);

        /* End of Medium marker */
        if (l == 0xffffffff)
            break;

        /* Check if there's enough data for this record */
        if (uc + l > end_pointer)
            return 0;
        /* Skip the record data */
        uc += l;

        /* Check if there's enough data for the complementary length */
        if (uc + 4 > end_pointer)
            return 0;
        /* Get the complementary length and compare */
        if (l != getlen(&uc))
            return 0;

        /* Tapemark check */
        if (l == 0) {
            tapemarks++;
            if (tapemarks >= SIMH_TAPEMARKS)
                break;
        } else {
            recs++;
        }
    }

    /* Return 1 if we found any records or tapemarks, otherwise 0 */
    return (recs || tapemarks) ? 1 : 0;
}