size_t records = 0, tapemarks = 0;
    while (uc < end_pointer) {
        uint32_t len1, len2;

        // Check if we have enough bytes for a full length field
        if (end_pointer - uc < 4)
            return 0;

        // Read the first length field
        len1 = getlen(uc);
        uc += 4;

        // Check for End of Medium (EOM) marker
        if (len1 == 0xFFFFFFFF)
            return 1;

        // Check if we have enough bytes for the data and second length field
        if (end_pointer - uc < len1 + 4)
            return 0;

        // Skip the data
        uc += len1;

        // Read the second length field
        len2 = getlen(uc);
        uc += 4;

        // Validate the length fields
        if (len1 != len2)
            return 0;

        // Check for tapemark (length 0)
        if (len1 == 0) {
            tapemarks++;
            if (tapemarks >= SIMH_TAPEMARKS)
                break;
        } else {
            records++;
        }
    }

    return records > 0;