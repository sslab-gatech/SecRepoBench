{
    unsigned int len, len_trail;
    size_t tapemark_count = 0;

    while ((size_t)(end_pointer - uc) >= sizeof(unsigned int)) {
        len = getlen(uc, end_pointer);
        if (len == 0xFFFFFFFF)
            return 1;
        uc += sizeof(unsigned int);
        if ((size_t)(end_pointer - uc) < len + sizeof(unsigned int))
            return 0;
        if (len == 0) {
            tapemark_count++;
            uc += sizeof(unsigned int);
            if (tapemark_count >= SIMH_TAPEMARKS)
                break;
            continue;
        }
        len_trail = getlen(uc + len, end_pointer);
        if (len != len_trail)
            return 0;
        uc += len + sizeof(unsigned int);
    }
    return 1;
}