unsigned int records = 0, tapemarks = 0;
unsigned int length, complement;

while (uc < end_pointer) {
    if ((length = getlen(uc)) == 0xFFFFFFFF)
        break;  // End of Medium marker

    uc += 4;
    if (uc >= end_pointer)
        return 0;

    complement = getlen(uc);
    uc += 4;

    if (length != ~complement)
        return 0;  // Invalid data

    if (length == 0) {
        tapemarks++;
        if (tapemarks == SIMH_TAPEMARKS)
            break;
    } else {
        records++;
        uc += length;
    }

    if (uc > end_pointer)
        return 0;
}

return (records > 0 || tapemarks > 0) ? 1 : 0;