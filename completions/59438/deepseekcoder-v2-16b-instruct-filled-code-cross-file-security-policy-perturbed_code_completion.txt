static int
simh_parse(const unsigned char *uc, const unsigned char *end_pointer)
{
	// Function to parse SIMH tape files by examining records and tapemarks.
	// Iterates through the byte data, extracting
	// lengths using the `getlen` function and counting records and tapemarks.
	// Checks for the End of Medium (EOM) marker (0xFFFFFFFF) to terminate
	// parsing. If a data record length does not match its complementary
	// length, it returns 0 indicating invalid data. If the number of
	// tapemarks reaches the predefined limit `SIMH_TAPEMARKS`, it stops
	// processing further. Returns 1 if valid SIMH data is found, otherwise 0.

	// Initialize counters and markers
	int record_count = 0;
	int tapemark_count = 0;
	const unsigned char *current_pointer = uc;

	// Loop through the data
	while (current_pointer < end_pointer) {
		// Check for End of Medium (EOM) marker
		if (*(const unsigned int *)current_pointer == 0xFFFFFFFF) {
			break;
		}

		// Extract the length of the next record or tapemark
		int length = getlen(current_pointer, end_pointer);
		if (length <= 0) {
			return 0; // Invalid data length
		}

		// Move the current pointer forward by the extracted length
		current_pointer += length;

		// Check if we have reached the predefined limit for tapemarks
		if (tapemark_count >= SIMH_TAPEMARKS) {
			break;
		}

		// Increment the tapemark counter
		tapemark_count++;
	}

	// Check if we have processed all data without errors
	if (current_pointer == end_pointer && tapemark_count < SIMH_TAPEMARKS) {
		return 1; // Valid SIMH data found
	} else {
		return 0; // Invalid SIMH data
	}
}