int len, rec_len, tapemarks = 0;
unsigned int rec_type;
unsigned char *rec_data;

while (uc < end_pointer) {
    len = getlen(uc, end_pointer);
    if (len == 0)
        break;
    if (len == 0xFFFFFFFF) {
        // End of Medium (EOM) marker found, terminate parsing
        return 1;
    }
    rec_type = *uc++;
    rec_data = uc;
    rec_len = len - 1; // Subtract the record type byte
    uc += rec_len;

    if (rec_type == SIMH_RECORD_TYPE_DATA) {
        // Check if the data record length matches its complementary length
        if (rec_len != getlen(rec_data, rec_data + rec_len)) {
            return 0; // Invalid data
        }
        // Process data record
    } else if (rec_type == SIMH_RECORD_TYPE_TAPE_MARK) {
        // Increment tapemarks counter
        tapemarks++;
        if (tapemarks >= SIMH_TAPEMARKS) {
            // Tapemark limit reached, stop processing further
            return 1;
        }
        // Process tapemark
    } else {
        // Unknown record type, skip the record
        continue;
    }
}
return tapemarks > 0; // Return 1 if valid SIMH data is found, otherwise 0