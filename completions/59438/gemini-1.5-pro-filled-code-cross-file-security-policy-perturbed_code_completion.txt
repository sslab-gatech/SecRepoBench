uint32_t len, len2;
	int nrec = 0, ntmk = 0;

	while (uc < end_pointer) {
		if (end_pointer - uc < sizeof(uint32_t))
			return 0;
		len = getlen(uc);
		uc += sizeof(uint32_t);
		if (len == 0xFFFFFFFF)		/* EOM */
			break;

		if (len == 0) {			/* tapemark */
			ntmk++;
			if (ntmk > SIMH_TAPEMARKS)
				break;
			continue;
		}

		if (end_pointer - uc < len + sizeof(uint32_t))
			return 0;
		len2 = getlen(uc + len);

		if (len != len2)
			return 0;		/* invalid data */

		uc += len + sizeof(uint32_t);
		nrec++;
	}
	return nrec > 0 ? 1 : 0;