const unsigned char *current = uc;
	size_t record_count = 0, tapemark_count = 0;

	while (current < end_pointer) {
		uint32_t length = getlen(&current, end_pointer);
		if (length == 0 || current + length > end_pointer) {
			return 0; // Invalid length or out of bounds
		}

		if (length == 0xFFFFFFFF) { // End of Medium marker
			break;
		}

		record_count++;

		// Check for tapemark
		if (is_tapemark(current, length)) {
			tapemark_count++;
			if (tapemark_count >= SIMH_TAPEMARKS) {
				break; // Reached predefined limit
			}
		}

		current += length; // Move to the next record
	}

	return (record_count > 0) ? 1 : 0; // Return 1 if valid data found