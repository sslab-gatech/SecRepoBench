static int
simh_parse(const unsigned char *uc, const unsigned char *end_pointer)
{
	int records = 0, tapemarks = 0;
	while (uc < end_pointer) {
		uint32_t len = getlen(&uc);
		if (len == 0xffffffff)	/* check for End of Medium */
			break;
		len &= 0x00ffffff;	/* keep only the record len */
		if (len & 1)
			len++;
		if (len!= swap4(len))	/* check for valid data */
			return 0;
		records++;
		if (records > SIMH_TAPEMARKS)
			break;
		if (*uc == 0x00)	/* check for tapemark */
			tapemarks++;
		uc += len;
	}
	return 1;
}