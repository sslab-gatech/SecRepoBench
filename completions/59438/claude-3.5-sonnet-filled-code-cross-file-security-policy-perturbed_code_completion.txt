unsigned int length, complement;
int records = 0, tapemarks = 0;

while (uc < end_pointer) {
    if (end_pointer - uc < 4) {
        return 0;  // Not enough data for a complete record
    }
    
    length = getlen(uc);
    uc += 4;
    
    if (length == 0xFFFFFFFF) {
        // End of Medium marker
        return 1;
    }
    
    if (length == 0) {
        // Tapemark
        tapemarks++;
        if (tapemarks == SIMH_TAPEMARKS) {
            return 1;
        }
        continue;
    }
    
    if (end_pointer - uc < 4 + length) {
        return 0;  // Not enough data for the record and its complement
    }
    
    uc += length;
    complement = getlen(uc);
    uc += 4;
    
    if (length != ~complement) {
        return 0;  // Invalid data: length doesn't match its complement
    }
    
    records++;
}

return (records > 0 || tapemarks > 0);