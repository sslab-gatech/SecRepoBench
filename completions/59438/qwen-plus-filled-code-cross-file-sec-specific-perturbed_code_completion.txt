size_t record_count = 0, tapemark_count = 0;
unsigned int len1, len2;
const unsigned char *ptr = uc;

while (ptr < end_pointer) {
    len1 = getlen(&ptr, end_pointer);
    if (len1 == 0xFFFFFFFF) { // EOM marker
        break;
    }
    if (len1 == 0xFFFFFFFE) { // Tapemark
        tapemark_count++;
        if (tapemark_count >= SIMH_TAPEMARKS) {
            return 1; // Stop processing after reaching the limit
        }
        continue;
    }
    len2 = getlen(&ptr, end_pointer);
    if (len1 != len2) {
        return 0; // Invalid data: lengths do not match
    }
    ptr += len1; // Skip the data record
    getlen(&ptr, end_pointer); // Read the complementary length again to ensure alignment
    record_count++;
}
return record_count > 0 ? 1 : 0;