const unsigned char *uc_start = uc;
int records = 0, tapemarks = 0;
while (uc < end_pointer) {
    uint32_t len = getlen(&uc);
    if (len == 0xffffffff) {
        // End of Medium marker found, stop parsing
        break;
    }
    if (len == 0) {
        // Tapemark found
        tapemarks++;
        if (tapemarks >= SIMH_TAPEMARKS) {
            // Reached the predefined limit of tapemarks, stop processing
            break;
        }
    } else {
        // Data record found
        records++;
        // Check if the data record length matches its complementary length
        if (uc + len > end_pointer || getlen(&uc)!= len) {
            // Invalid data, return 0
            return 0;
        }
    }
}
// If we have reached this point, valid SIMH data is found, return 1
return 1;