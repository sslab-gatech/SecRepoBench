if (uc + 4 <= end_pointer) { // <MASK>
		uint32_t len = getlen(uc);
		if (len == 0) {
			DPRINTF("Zero length record\n");
			return 0;
		}
		if (uc + len > end_pointer) {
			DPRINTF("Record too long\n");
			return 0;
		}
		records++;
		uc += len;
	} else {
		DPRINTF("Insufficient memory for record\n");
		return 0;
	}