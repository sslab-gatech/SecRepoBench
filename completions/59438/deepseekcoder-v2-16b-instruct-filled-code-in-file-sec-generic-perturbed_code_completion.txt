static int
simh_parse(const unsigned char *uc, const unsigned char *end_pointer)
{
	int tapemark_count = 0;

	while (uc < end_pointer) {
		uint32_t len = getlen(&uc);
		if (len == 0xffffffff) {
			return 1; // End of Medium marker
		}
		if (len & 1) {
			return 0; // Invalid data length
		}
		uc += len;
		if (tapemark_count >= SIMH_TAPEMARKS) {
			return 1; // Reached the tapemark limit
		}
		if (uc >= end_pointer) {
			break; // Reached the end of the buffer
		}
		if (memcmp(uc, "\x00\x00\x00\x00", 4) == 0) {
			tapemark_count++;
		}
	}
	return 0; // No valid SIMH data found
}