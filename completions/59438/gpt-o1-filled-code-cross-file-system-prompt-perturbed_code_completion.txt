{
    unsigned int len;
    int tapemarks = 0, records = 0;

    while (uc + 4 <= end_pointer) {
        /* read the 4-byte length */
        len = (unsigned int)((uc[0]) | (uc[1] << 8) | (uc[2] << 16) | (uc[3] << 24));
        uc += 4;

        /* check for end-of-medium marker */
        if (len == 0xffffffff) {
            break;
        }

        /* tapemark? */
        if (len == 0) {
            tapemarks++;
            if (tapemarks >= SIMH_TAPEMARKS)
                break;
            continue;
        }

        /* validate data range */
        if (uc + len + 4 > end_pointer)
            return 0;

        /* skip data field */
        uc += len;

        /* trailing length must match */
        if (((uc[0]) | (uc[1] << 8) | (uc[2] << 16) | (uc[3] << 24)) != len)
            return 0;

        /* skip the trailing length */
        uc += 4;
        records++;
    }

    return (records > 0) ? 1 : 0;
}