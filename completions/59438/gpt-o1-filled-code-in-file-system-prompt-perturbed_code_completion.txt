int tapemarks = 0;
int found_data = 0;

while (uc + sizeof(uint32_t) <= end_pointer) {
    uint32_t len1 = getlen(&uc);

    if (len1 == 0xffffffff) {
        tapemarks++;
        if (tapemarks == SIMH_TAPEMARKS)
            break;
        continue;
    }

    if (uc + len1 + sizeof(uint32_t) > end_pointer)
        return 0;

    uc += len1;

    uint32_t len2 = getlen(&uc);
    if (len1 != len2)
        return 0;

    found_data = 1;
}

if (!found_data && tapemarks == 0)
    return 0;

return 1;