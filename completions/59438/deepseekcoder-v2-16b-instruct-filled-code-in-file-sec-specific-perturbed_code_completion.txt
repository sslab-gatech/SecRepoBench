int
simh_parse(const unsigned char *uc, const unsigned char *end_pointer)
{
	int tapemark_count = 0;

	while (uc < end_pointer) {
		uint32_t len = getlen(&uc);
		if (len == 0xffffffff) {
			return 1; // End of Medium marker
		}
		if (len & 1) {
			return 0; // Invalid data length
		}
		uc += len;
		if (tapemark_count >= SIMH_TAPEMARKS) {
			break; // Stop processing if tapemark limit reached
		}
		if (uc >= end_pointer) {
			break; // Stop processing if end of buffer reached
		}
		if (memcmp(uc, "\0\0\0\0", 4) == 0) {
			tapemark_count++;
		}
	}

	return 1; // Valid SIMH data
}