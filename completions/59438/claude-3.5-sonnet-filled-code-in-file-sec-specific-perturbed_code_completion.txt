uint32_t records = 0, tapemarks = 0;

while (uc < end_pointer) {
    uint32_t len = getlen(&uc);
    if (len == 0xffffffff) // End of Medium
        return 1;

    if (uc + len > end_pointer)
        return 0;

    if (len == 0) {
        tapemarks++;
        if (SIMH_TAPEMARKS && tapemarks >= SIMH_TAPEMARKS)
            return 1;
    } else {
        records++;
        uc += len;
        if (uc >= end_pointer)
            return 0;
        uint32_t clen = getlen(&uc);
        if (clen != len)
            return 0;
    }
}

return (records > 0 || tapemarks > 0);