size_t nf = 0, tf = 0, nl = 0;
uint32_t len;

while (uc < end_pointer) {
    len = getlen(&uc);
    if (len == 0xffffffff)  // End of Medium
        break;
    if (len & 0x80000000) {  // Tapemark
        nl++;
        if (nl >= SIMH_TAPEMARKS)
            break;
    } else {
        if (getlen(&uc)!= len)  // Check for length mismatch
            return 0;
        nf++;
    }
}
return nl > 0 && nf > 0;