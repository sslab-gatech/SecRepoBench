uint32_t len, len_comp;
	int records = 0;
	int tapemarks = 0;
	const unsigned char *p = uc;

	while (p < end_pointer) {
		len = getlen(&p, end_pointer);

		if (len == 0xFFFFFFFF) {
			/* End of Medium */
			return 1;
		}

		if (p + len > end_pointer) {
			/* Invalid data record */
			return 0;
		}

		len_comp = getlen(&p, end_pointer);

		if (len != (~len_comp & 0xFFFFFFFF)) {
			/* Invalid complementary length */
			return 0;
		}

		if (len == 0) {
			/* Tapemark */
			tapemarks++;
			if (tapemarks > SIMH_TAPEMARKS)
				return 1; /* Stop after too many tapemarks */
		} else {
			/* Data record */
			records++;
			p += len;
		}
	}

	return records > 0 || tapemarks > 0;