int records = 0;
	int tapemarks = 0;
	
	while (uc < end_pointer) {
		uint32_t len = getlen(&uc);
		
		// Check for End of Medium
		if (len == 0xffffffff)
			break;
		
		// Ensure there's enough data for the record and its complement
		if (uc + len + sizeof(uint32_t) > end_pointer)
			return 0;
		
		// Skip the record data
		uc += len;
		
		// Get the complement length
		uint32_t comp_len = getlen(&uc);
		
		// Check for End of Medium
		if (comp_len == 0xffffffff)
			break;
		
		// If length is 0, it's a tapemark
		if (len == 0) {
			tapemarks++;
			if (tapemarks >= SIMH_TAPEMARKS)
				break;
		} else {
			records++;
			
			// Validate that the complement length matches
			if (len != comp_len)
				return 0;
		}
	}
	
	// Return 1 if we found some valid data
	return (records > 0 || tapemarks > 0);