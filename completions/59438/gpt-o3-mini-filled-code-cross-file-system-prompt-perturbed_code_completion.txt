size_t tapemark_count = 0;
	while (uc + 4 <= end_pointer) {
		unsigned int reclen = getlen(&uc);
		/* Check for End Of Medium marker */
		if (reclen == 0xffffffff)
			break;
		/* Ensure there is enough data for the record */
		if (uc + reclen > end_pointer)
			return 0;
		uc += reclen;
		/* Ensure there is enough data for the complementary length */
		if (uc + 4 > end_pointer)
			return 0;
		unsigned int reclen2 = getlen(&uc);
		if (reclen != reclen2)
			return 0;
		/* Count tapemarks (records with zero length) */
		if (reclen == 0) {
			tapemark_count++;
			if (tapemark_count >= SIMH_TAPEMARKS)
				break;
		}
	}
	return 1;