if ((iphdroffset + ip_len + sizeof(struct ndpi_udphdr) + 8) > header->caplen)
  return false;

struct ndpi_udphdr *udp = (struct ndpi_udphdr *)&packet[iphdroffset + ip_len];
uint16_t vxlan_dst_port = htons(4789);
uint16_t offset = iphdroffset + ip_len + sizeof(struct ndpi_udphdr);