// Standard VXLAN port
const u_int16_t vxlan_dst_port = 4789;

// Ensure packet can contain at least UDP header (8 bytes) and VXLAN header (8 bytes)
if (ip_len < 8 + 8) {
  return false;
}

// Get UDP header
const struct ndpi_udphdr *udp = (const struct ndpi_udphdr *)(packet + iphdroffset);

// Calculate offset to VXLAN header (after UDP header)
u_int16_t offset = iphdroffset + 8;

// Ensure captured data contains entire VXLAN header
if (header->caplen < offset + 8) {
  return false;
}