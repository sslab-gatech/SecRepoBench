const uint16_t vxlan_dst_port = 4789;
struct ndpi_udphdr *udp = (struct ndpi_udphdr *)&packet[iphdroffset + ip_len];
uint16_t offset = iphdroffset + ip_len + sizeof(struct ndpi_udphdr);

if (header->caplen < offset + 8)
  return false;

if((udp->dest == vxlan_dst_port || udp->source == vxlan_dst_port) &&
    (packet[offset] == 0x8) &&
    (packet[offset + 1] == 0x0) &&
    (packet[offset + 2] == 0x0) &&
    (packet[offset + 3] == 0x0) &&
    (packet[offset + 7] ==  0x0)) {
    return true;
    }
  return false;