const struct udphdr *udp = (const struct udphdr *)(packet + iphdroffset);
u_int16_t offset = iphdroffset + 8;

if (header->len < iphdroffset + 8 + 8) {
    return false;
}