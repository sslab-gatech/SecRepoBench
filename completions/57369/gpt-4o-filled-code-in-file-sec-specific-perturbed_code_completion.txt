if (header->caplen < iphdroffset + ip_len + sizeof(struct ndpi_udphdr) + sizeof(struct ndpi_vxlanhdr)) {
    return false; // Packet too short to contain VXLAN header
  }

  const u_int16_t vxlan_dst_port = htons(4789); // VXLAN default UDP port
  const struct ndpi_udphdr *udp = (const struct ndpi_udphdr *)&packet[iphdroffset + ip_len];
  u_int offset = iphdroffset + ip_len + sizeof(struct ndpi_udphdr);

  if ((udp->dest == vxlan_dst_port || udp->source == vxlan_dst_port) &&
      (packet[offset] == 0x8) &&
      (packet[offset + 1] == 0x0) &&
      (packet[offset + 2] == 0x0) &&
      (packet[offset + 3] == 0x0) &&
      (packet[offset + 7] == 0x0)) {
    return true;
  }
  return false;