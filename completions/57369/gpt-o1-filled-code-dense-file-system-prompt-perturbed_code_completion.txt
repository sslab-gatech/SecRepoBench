struct iphdr *iph = (struct iphdr *)(packet + iphdroffset);
if(!iph || ip_len < (iph->ihl * 4 + sizeof(struct udphdr) + 8))
  return false;

struct udphdr *udp = (struct udphdr *)(packet + iphdroffset + (iph->ihl * 4));
u_int16_t vxlan_dst_port = ntohs(4789);
u_int16_t offset = iphdroffset + (iph->ihl * 4) + sizeof(struct udphdr);