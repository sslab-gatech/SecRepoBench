const u_int16_t vxlan_dst_port = htons(4789);
const struct udphdr *udp = (const struct udphdr *)(packet + iphdroffset);
u_int16_t udp_len = ntohs(udp->len);
u_int16_t offset = iphdroffset + sizeof(struct udphdr);

if(header->caplen < offset + 8) // VXLAN header is 8 bytes
  return false;