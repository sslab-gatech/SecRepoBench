const u_int16_t vxlan_dst_port = 4789;
const u_int16_t udp_header_size = 8;
const u_int16_t vxlan_header_size = 8;

if (ip_len < (iphdroffset + udp_header_size + vxlan_header_size)) {
  return false;
}

struct ndpi_udphdr *udp = (struct ndpi_udphdr *)(packet + iphdroffset);
u_int16_t offset = iphdroffset + udp_header_size;