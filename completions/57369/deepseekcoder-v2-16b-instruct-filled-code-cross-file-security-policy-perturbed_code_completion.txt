// Get the UDP header and header offset.
  struct udphdr *udp = (struct udphdr *)(packet->payload + iphdroffset);
  u_int16_t udp_header_size = 8; // UDP header size is always 8 bytes
  u_int16_t offset = iphdroffset + udp_header_size;

  // Validate the packet size.
  if (offset + udp_header_size > header->caplen) {
    return false;
  }

  // Check for VXLAN packet.
  if ((udp->dest == vxlan_dst_port || udp->source == vxlan_dst_port) &&
      (packet[offset] == 0x8) &&
      (packet[offset + 1] == 0x0) &&
      (packet[offset + 2] == 0x0) &&
      (packet[offset + 3] == 0x0) &&
      (packet[offset + 7] == 0x0)) {
    return true;
  }
  return false;