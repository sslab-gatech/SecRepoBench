struct ndpi_udphdr *udp = (struct ndpi_udphdr *)&packet[ip_offset + ip_len];
if (header->caplen < ip_offset + ip_len + sizeof(struct ndpi_udphdr)) {
    return false; // Too short for UDP header
}
if ((udp->dest == vxlan_dst_port || udp->source == vxlan_dst_port) &&
    (packet[ip_offset + ip_len + sizeof(struct ndpi_udphdr)] == 0x8) &&
    (packet[ip_offset + ip_len + sizeof(struct ndpi_udphdr) + 1] == 0x0) &&
    (packet[ip_offset + ip_len + sizeof(struct ndpi_udphdr) + 2] == 0x0) &&
    (packet[ip_offset + ip_len + sizeof(struct ndpi_udphdr) + 3] == 0x0) &&
    (packet[ip_offset + ip_len + sizeof(struct ndpi_udphdr) + 7] == 0x0)) {
    return true;
}