if(header->caplen < iphdroffset + ip_len + sizeof(struct ndpi_udphdr))
    return false; /* Too short for UDP header*/

  const struct ndpi_udphdr *udp = (const struct ndpi_udphdr *)&packet[iphdroffset + ip_len];
  u_int16_t vxlan_dst_port = htons(4789);
  u_int16_t offset = iphdroffset + ip_len + sizeof(struct ndpi_udphdr);

  if(offset + sizeof(struct ndpi_vxlanhdr) > header->caplen)
    return false; /* Too short for VXLAN header */