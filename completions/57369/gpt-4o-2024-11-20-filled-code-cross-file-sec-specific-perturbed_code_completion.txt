// Define the expected VXLAN UDP port (4789).
u_int16_t vxlan_dst_port = htons(4789);

// Ensure the packet is large enough to contain the UDP header.
if(header->caplen < iphdroffset + sizeof(struct udphdr)) {
  return false;
}

// Get the UDP header.
const struct udphdr *udp = (const struct udphdr *)(packet + iphdroffset);

// Calculate the offset for the VXLAN header.
u_int16_t offset = iphdroffset + sizeof(struct udphdr);

// Ensure the packet is large enough to contain the VXLAN header.
if(header->caplen < offset + 8) {
  return false;
}