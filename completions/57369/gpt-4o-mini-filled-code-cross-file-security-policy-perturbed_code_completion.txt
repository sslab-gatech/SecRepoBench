u_int16_t udp_header_length = sizeof(struct udphdr);
u_int16_t vxlan_header_length = 8; // VXLAN header is 8 bytes
u_int16_t total_header_length = udp_header_length + vxlan_header_length;

if (header->len < (iphdroffset + total_header_length)) {
    return false; // Not enough data for UDP and VXLAN headers
}