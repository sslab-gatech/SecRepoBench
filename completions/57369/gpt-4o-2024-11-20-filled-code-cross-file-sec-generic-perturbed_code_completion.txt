// Define the expected VXLAN UDP port (4789).
  const u_int16_t vxlan_dst_port = htons(4789);

  // Ensure the packet is large enough to contain the UDP header and VXLAN header.
  if(ip_len < (iphdroffset + sizeof(struct udphdr) + 8)) {
    return false;
  }

  // Get the UDP header.
  const struct udphdr *udp = (const struct udphdr *)(packet + iphdroffset);

  // Calculate the offset to the VXLAN header.
  u_int16_t offset = iphdroffset + sizeof(struct udphdr);