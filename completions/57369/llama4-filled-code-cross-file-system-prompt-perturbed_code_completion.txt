// Define the expected VXLAN UDP port (4789).
const u_int16_t vxlan_dst_port = htons(4789);

// Get the UDP header and header offset.
const u_char *udp_ptr = packet + iphdroffset + 8; // 8 is the size of the IP header
const struct udphdr *udp = (const struct udphdr *)udp_ptr;
u_int16_t offset = iphdroffset + 8 + 8; // 8 is the size of the IP header, 8 is the size of the UDP header