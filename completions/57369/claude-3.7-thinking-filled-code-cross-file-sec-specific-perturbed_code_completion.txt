// Validate the packet size.
u_int16_t udp_offset = iphdroffset + ip_len;
u_int16_t offset = udp_offset + 8; // 8 bytes for UDP header

if(header->caplen < offset + 8) {
  return false; // Packet too small to be a valid VXLAN packet
}

// Define the expected VXLAN UDP port (4789)
const u_int16_t vxlan_dst_port = htons(4789);

// Get the UDP header and header offset.
struct ndpi_udphdr *udp = (struct ndpi_udphdr *)(packet + udp_offset);