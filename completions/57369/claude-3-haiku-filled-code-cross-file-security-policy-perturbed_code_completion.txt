// Validate the packet size.
if (ip_len < sizeof(struct udphdr) + 8) {
    return false;
}

// Define the expected VXLAN UDP port (4789).
const u_int16_t vxlan_dst_port = 4789;

// Get the UDP header and header offset.
const struct udphdr *udp = (const struct udphdr *)(packet + iphdroffset);
u_int16_t offset = iphdroffset + sizeof(struct udphdr);

// Check if the packet is a valid VXLAN packet.
if((udp->dest == vxlan_dst_port || udp->source == vxlan_dst_port) &&
   (packet[offset] == 0x8) &&
   (packet[offset + 1] == 0x0) &&
   (packet[offset + 2] == 0x0) &&
   (packet[offset + 3] == 0x0) &&
   (packet[offset + 7] ==  0x0)) {
    return true;
}