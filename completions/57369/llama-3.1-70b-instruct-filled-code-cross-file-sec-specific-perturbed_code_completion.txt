// Define the expected VXLAN UDP port (4789).
const u_int16_t vxlan_dst_port = 4789;

// Get the UDP header and header offset.
struct udpheader {
  u_int16_t source;
  u_int16_t dest;
  u_int16_t len;
  u_int16_t check;
} *udp = (struct udpheader *)(packet + iphdroffset + 8);

u_int16_t offset = iphdroffset + 8 + sizeof(struct udpheader);