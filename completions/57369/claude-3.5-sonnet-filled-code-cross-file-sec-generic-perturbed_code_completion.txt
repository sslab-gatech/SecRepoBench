if (header->caplen < iphdroffset + ip_len + sizeof(struct ndpi_udphdr) + 8)
    return false;

const u_int16_t vxlan_dst_port = 4789;
const struct ndpi_udphdr *udp = (struct ndpi_udphdr *)(packet + iphdroffset + ip_len);
u_int16_t offset = iphdroffset + ip_len + sizeof(struct ndpi_udphdr);

if (offset + 8 > header->caplen)
    return false;