const u_int16_t vxlan_dst_port = 4789;
u_int16_t offset = iphdroffset + sizeof(struct ip);

if (ip_len < sizeof(struct ip) + sizeof(struct udphdr)) {
    return false;
}

const struct udphdr *udp = (struct udphdr *)(packet + offset);
offset += sizeof(struct udphdr);

if (header->caplen < offset + 8) {
  return false;
}