if(header->caplen < iphdroffset + sizeof(struct ndpi_iphdr))
    return false;
struct ndpi_iphdr *ip = (struct ndpi_iphdr *)(packet + iphdroffset);
u_int16_t ip_header_len = ip->ihl * 4;
if(ip_header_len < sizeof(struct ndpi_iphdr) || ip_len < ip_header_len + sizeof(struct ndpi_udphdr) + 8)
    return false;
u_int16_t udp_offset = iphdroffset + ip_header_len;
if(header->caplen < udp_offset + sizeof(struct ndpi_udphdr))
    return false;
struct ndpi_udphdr *udp = (struct ndpi_udphdr *)(packet + udp_offset);
u_int16_t vxlan_dst_port = htons(4789);
if(ntohs(udp->len) < sizeof(struct ndpi_udphdr) + 8)
    return false;
u_int16_t offset = udp_offset + sizeof(struct ndpi_udphdr);
if(header->caplen < offset + 8)
    return false;