_snprintf(flow->ssh_tls.server_names,
                  sizeof(flow->ssh_tls.server_names),
                  "%s", flow->ndpi_flow->protos.ssh.server_names);
    ndpi_snprintf(flow->ssh_tls.advertised_alpns,
                  sizeof(flow->ssh_tls.advertised_alpns),
                  "%s", flow->ndpi_flow->protos.ssh.advertised_alpns);
    ndpi_snprintf(flow->ssh_tls.negotiated_alpn,
                  sizeof(flow->ssh_tls.negotiated_alpn),
                  "%s", flow->ndpi_flow->protos.ssh.negotiated_alpn);
    ndpi_snprintf(flow->ssh_tls.tls_supported_versions,
                  sizeof(flow->ssh_tls.tls_supported_versions),
                  "%s", flow->ndpi_flow->protos.ssh.tls_supported_versions);
    ndpi_snprintf(flow->ssh_tls.tls_issuerDN,
                  sizeof(flow->ssh_tls.tls_issuerDN),
                  "%s", flow->ndpi_flow->protos.ssh.tls_issuerDN);
    ndpi_snprintf(flow->ssh_tls.tls_subjectDN,
                  sizeof(flow->ssh_tls.tls_subjectDN),
                  "%s", flow->ndpi_flow->protos.ssh.tls_subjectDN);
    if(flow->ndpi_flow->protos.ssh.encrypted_sni.esni != NULL)
      flow->ssh_tls.encrypted_sni.esni = ndpi_strdup(flow->ndpi_flow->protos.ssh.encrypted_sni.esni);
  } else if(is_ndpi_proto(flow, NDPI_PROTOCOL_TLS)) {
    flow->info_type = INFO_TLS;
    ndpi_snprintf(flow->tls.issuerDN,
                  sizeof(flow->tls.issuerDN),
                  "%s", flow->ndpi_flow->protos.tls.issuerDN);
    ndpi_snprintf(flow->tls.subjectDN,
                  sizeof(flow->tls.subjectDN),
                  "%s", flow->ndpi_flow->protos.tls.subjectDN);
    ndpi_snprintf(flow->tls.cipher_suite,
                  sizeof(flow->tls.cipher_suite),
                  "%s", flow->ndpi_flow->protos.tls.cipher_suite);
    ndpi_snprintf(flow->tls.version,
                  sizeof(flow->tls.version),
                  "%s", flow->ndpi_flow->protos.tls.version);
    ndpi_snprintf(flow->tls.alpn,
                  sizeof(flow->tls.alpn),
                  "%s", flow->ndpi_flow->protos.tls.alpn);
    ndpi_snprintf(flow->tls.sni,
                  sizeof(flow->tls.sni),
                  "%s", flow->ndpi_flow->protos.tls.sni);
    ndpi_snprintf(flow->tls.cert_chain_sha256,
                  sizeof(flow->tls.cert_chain_sha256),
                  "%s", flow->ndpi_flow->protos.tls.cert_chain_sha256);
    ndpi_snprintf(flow->tls.cert_chain_sha1,
                  sizeof(flow->tls.cert_chain_sha1),
                  "%s", flow->ndpi_flow->protos.tls.cert_chain_sha1);
    ndpi_snprintf(flow->tls.cert_chain_md5,
                  sizeof(flow->tls.cert_chain_md5),
                  "%s", flow->ndpi_flow->protos.tls.cert_chain_md5);
    ndpi_snprintf(flow->tls.cert_chain_fingerprint,
                  sizeof(flow->tls.cert_chain_fingerprint),
                  "%s", flow->ndpi_flow->protos.tls.cert_chain_fingerprint);
    ndpi_snprintf(flow->tls.cert_chain_serial,
                  sizeof(flow->tls.cert_chain_serial),
                  "%s", flow->ndpi_flow->protos.tls.cert_chain_serial);
  } else if(is_ndpi_proto(flow, NDPI_PROTOCOL_DTLS)) {
    flow->info_type = INFO_DTLS;
    ndpi_snprintf(flow->dtls.cipher_suite,
                  sizeof(flow->dtls.cipher_suite),
                  "%s", flow->ndpi_flow->protos.dtls.cipher_suite);
    ndpi_snprintf(flow->dtls.version,
                  sizeof(flow->dtls.version),
                  "%s", flow->ndpi_flow->protos.dtls.version);
    ndpi_snprintf(flow->dtls.alpn,
                  sizeof(flow->dtls.alpn),
                  "%s", flow->ndpi_flow->protos.dtls.alpn);
    ndpi_snprintf(flow->dtls.sni,
                  sizeof(flow->dtls.sni),
                  "%s", flow->ndpi_flow->protos.dtls.sni);
    ndpi_snprintf(flow->dtls.cert_chain_sha256,
                  sizeof(flow->dtls.cert_chain_sha256),
                  "%s", flow->ndpi_flow->protos.dtls.cert_chain_sha256);
    ndpi_snprintf(flow->dtls.cert_chain_sha1,
                  sizeof(flow->dtls.cert_chain_sha1),
                  "%s", flow->ndpi_flow->protos.dtls.cert_chain_sha1);
    ndpi_snprintf(flow->dtls.cert_chain_md5,
                  sizeof(flow->dtls.cert_chain_md5),
                  "%s", flow->ndpi_flow->protos.dtls.cert_chain_md5);
    ndpi_snprintf(flow->dtls.cert_chain_fingerprint,
                  sizeof(flow->dtls.cert_chain_fingerprint),
                  "%s", flow->ndpi_flow->protos.dtls.cert_chain_fingerprint);
    ndpi_snprintf(flow->dtls.cert_chain_serial,
                  sizeof(flow->dtls.cert_chain_serial),
                  "%s", flow->ndpi_flow->protos.dtls.cert_chain_serial);
  } else if(is_ndpi_proto(flow, NDPI_PROTOCOL_QUIC)) {
    flow->info_type = INFO_QUIC;
    is_quic = 1;
    ndpi_snprintf(flow->quic.scid,
                  sizeof(flow->quic.scid),
                  "%s", flow->ndpi_flow->protos.quic.scid);
    ndpi_snprintf(flow->quic.dcid,
                  sizeof(flow->quic.dcid),
                  "%s", flow->ndpi_flow->protos.quic.dcid);
    ndpi_snprintf(flow->quic.token,
                  sizeof(flow->quic.token),
                  "%s", flow->ndpi_flow->protos.quic.token);
    ndpi_snprintf(flow->quic.version,
                  sizeof(flow->quic.version),
                  "%s", flow->ndpi_flow->protos.quic.version);
    ndpi_snprintf(flow->quic.alpn,
                  sizeof(flow->quic.alpn),
                  "%s", flow->ndpi_flow->protos.quic.alpn);
    ndpi_snprintf(flow->quic.cipher_suite,
                  sizeof(flow->quic.cipher_suite),
                  "%s", flow->ndpi_flow->protos.quic.cipher_suite);
    ndpi_snprintf(flow->quic.remote_ip,
                  sizeof(flow->quic.remote_ip),
                  "%s", flow->ndpi_flow->protos.quic.remote_ip);
    ndpi_snprintf(flow->quic.remote_port,
                  sizeof(flow->quic.remote_port),
                  "%s", flow->ndpi_flow->protos.quic.remote_port);
  } else if(is_ndpi_proto(flow, NDPI_PROTOCOL_DNS_OVER_HTTPS)) {
    flow->info_type = INFO_DNS_OVER_HTTPS;
    ndpi_snprintf(flow->dns_over_https.url,
                  sizeof(flow->dns_over_https.url),
                  "%s", flow->ndpi_flow->protos.dns_over_https.url);
  } else if(is_ndpi_proto(flow, NDPI_PROTOCOL_DNS_OVER_TLS)) {
    flow->info_type = INFO_DNS_OVER_TLS;
    ndpi_snprintf(flow->dns_over_tls.hostname,
                  sizeof(flow->dns_over_tls.hostname),
                  "%s", flow->ndpi_flow->protos.dns_over_tls.hostname);
  } else if(is_ndpi_proto(flow, NDPI_PROTOCOL_NTP)) {
    flow->info_type = INFO_NTP;
    ndpi_snprintf(flow->ntp.reference_id,
                  sizeof(flow->ntp.reference_id),
                  "%s", flow->ndpi_flow->protos.ntp.reference_id);
    ndpi_snprintf(flow->ntp.reference_timestamp,
                  sizeof(flow->ntp.reference_timestamp),
                  "%s", flow->ndpi_flow->protos.ntp.reference_timestamp);
  } else if(is_ndpi_proto(flow, NDPI_PROTOCOL_SNMP)) {
    flow->info_type = INFO_SNMP;
    ndpi_snprintf(flow->snmp.community,
                  sizeof(flow->snmp.community),
                  "%s", flow->ndpi_flow->protos.snmp.community);
  } else if(is_ndpi_proto(flow, NDPI_PROTOCOL_RADIUS)) {
    flow->info_type = INFO_RADIUS;
    ndpi_snprintf(flow->radius.identifier,
                  sizeof(flow->radius.identifier),
                  "%s", flow->ndpi_flow->protos.radius.identifier);
    ndpi_snprintf(flow->radius.secret,
                  sizeof(flow->radius.secret),
                  "%s", flow->ndpi_flow->protos.radius.secret);
  } else if(is_ndpi_proto(flow, NDPI_PROTOCOL_CAPWAP)) {
    flow->info_type = INFO_CAPWAP;
    ndpi_snprintf(flow->capwap.client_ip,
                  sizeof(flow->capwap.client_ip),
                  "%s", flow->ndpi_flow->protos.capwap.client_ip);
    ndpi_snprintf(flow->capwap.server_ip,
                  sizeof(flow->capwap.server_ip),
                  "%s", flow->ndpi_flow->protos.capwap.server_ip);
  } else if(is_ndpi_proto(flow, NDPI_PROTOCOL_DHCP)) {
    flow->info_type = INFO_DHCP;
    ndpi_snprintf(flow->dhcp.client_ip,
                  sizeof(flow->dhcp.client_ip),
                  "%s", flow->ndpi_flow->protos.dhcp.client_ip);
    ndpi_snprintf(flow->dhcp.server_ip,
                  sizeof(flow->dhcp.server_ip),
                  "%s", flow->ndpi_flow->protos.dhcp.server_ip);
    ndpi_snprintf(flow->dhcp.client_mac,
                  sizeof(flow->dhcp.client_mac),
                  "%s", flow->ndpi_flow->protos.dhcp.client_mac);
    ndpi_snprintf(flow->dhcp.server_mac,
                  sizeof(flow->dhcp.server_mac),
                  "%s", flow->ndpi_flow->protos.dhcp.server_mac);
    ndpi_snprintf(flow->dhcp.lease_time,
                  sizeof(flow->dhcp.lease_time),
                  "%s", flow->ndpi_flow->protos.dhcp.lease_time);
    ndpi_snprintf(flow->dhcp.message_type,
                  sizeof(flow->dhcp.message_type),
                  "%s", flow->ndpi_flow->protos.dhcp.message_type);
  } else if(is_ndpi_proto(flow, NDPI_PROTOCOL_DNS)) {
    flow->info_type = INFO_DNS;
    ndpi_snprintf(flow->dns.query,
                  sizeof(flow->dns.query