// Define the expected VXLAN UDP port (4789).
  const u_int16_t vxlan_dst_port = htons(4789);

  // Calculate the offset for the UDP header.
  u_int16_t offset = iphdroffset + (ip_len * 4);

  // Ensure the packet is large enough to contain both UDP and VXLAN headers.
  // UDP header is 8 bytes, VXLAN header is 8 bytes.
  if(header->caplen < offset + 8 + 8) {
    return false;
  }

  // Get the UDP header.
  struct udphdr *udp = (struct udphdr *)(packet + offset);
  offset += sizeof(struct udphdr);