// Validate the packet size.
if (header->caplen < (iphdroffset + ip_len + sizeof(struct ndpi_udphdr) + 8)) {
  return false;
}

// Define the expected VXLAN UDP port (4789).
const u_int16_t vxlan_dst_port = 4789;

// Get the UDP header and header offset.
struct ndpi_udphdr *udp = (struct ndpi_udphdr *)(packet + iphdroffset + ip_len);
u_int16_t offset = iphdroffset + ip_len + sizeof(struct ndpi_udphdr);