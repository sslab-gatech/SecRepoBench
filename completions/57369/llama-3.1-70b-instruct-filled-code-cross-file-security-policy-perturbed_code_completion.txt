// Define the expected VXLAN UDP port (4789).
const u_int16_t vxlan_dst_port = 4789;

// Get the UDP header and header offset.
struct udpheader *udp = (struct udpheader *)(packet + iphdroffset + 8);
u_int16_t offset = iphdroffset + 8 + 8; // 8 bytes for UDP header and 8 bytes for VXLAN header

// Validate the packet size.
if (ip_len < (offset + 8)) { // 8 bytes for VXLAN header
  return false;
}