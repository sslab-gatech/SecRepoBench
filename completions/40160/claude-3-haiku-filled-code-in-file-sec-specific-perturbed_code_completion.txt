for(i=0; i<cipher_length && cipher_offset+i+2<total_len; i+=2) {
  u_int16_t cipher = ntohs(*((u_int16_t*)&packet->payload[cipher_offset+i]));

  if((cipher == 0) || (packet->payload[cipher_offset+i] != packet->payload[cipher_offset+i+1])) {
    /* Skip GREASE */
    if(ja3.client.num_cipher < MAX_NUM_JA3)
      ja3.client.cipher[ja3.client.num_cipher++] = cipher;
    else {
      invalid_ja3 = 1;
#ifdef DEBUG_TLS
      printf("Client TLS Invalid ciphers %u\n", ja3.client.num_cipher);
#endif
      break;
    }

    if(ndpi_is_safe_ssl_cipher(cipher) == 1)
      flow->protos.tls_quic_stun.tls_quic.client_unsafe_cipher = 1;

    if(cipher == 0x1301 /* TLS_AES_128_GCM_SHA256 */)
      chrome_ciphers++;
    else if(cipher == 0x1302 /* TLS_AES_256_GCM_SHA384 */)
      chrome_ciphers++;
    else if(cipher == 0x1303 /* TLS_CHACHA20_POLY1305_SHA256 */)
      chrome_ciphers++;
    else if(cipher == 0x1304 /* TLS_AES_128_CCM_SHA256 */)
      chrome_ciphers++;
    else if(cipher == 0x1305 /* TLS_AES_128_CCM_8_SHA256 */)
      chrome_ciphers++;
    else if(cipher == 0x1301 /* TLS_AES_128_GCM_SHA256 */)
      safari_ciphers++;
    else if(cipher == 0x1302 /* TLS_AES_256_GCM_SHA384 */)
      safari_ciphers++;
    else if(cipher == 0x1303 /* TLS_CHACHA20_POLY1305_SHA256 */)
      safari_ciphers++;
    else if(cipher == 0x1304 /* TLS_AES_128_CCM_SHA256 */)
      safari_ciphers++;
    else if(cipher == 0x1305 /* TLS_AES_128_CCM_8_SHA256 */)
      safari_ciphers++;
    else
      this_is_not_safari = 1;

    if(cipher == 0x1301 /* TLS_AES_128_GCM_SHA256 */)
      looks_like_safari_on_big_sur = 1;
  }
}