u_int16_t cipher = ntohs(*((u_int16_t*)&packet->payload[cipher_offset + i]));
if (cipher != 0x0000 && (cipher < 0x0100 || cipher > 0xFFFF)) {
    continue; // Skip GREASE ciphers
}
if (ja3.client.num_cipher < MAX_NUM_JA3) {
    ja3.client.cipher[ja3.client.num_cipher++] = cipher;
}
if (cipher == 0x0035 || cipher == 0x003C) { // Example: specific ciphers for Safari
    safari_ciphers++;
} else if (cipher == 0xC02F || cipher == 0xC030) { // Example: specific ciphers for Chrome
    chrome_ciphers++;
} else {
    this_is_not_safari = 1; // If we encounter a cipher not in Safari's list
}