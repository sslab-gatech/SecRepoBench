for(i=0; i<cipher_length; i++) {
	  u_int16_t cipher_suite = ntohs(*((u_int16_t*)&packet->payload[cipher_offset+i*2]));

	  if((cipher_suite == 0x0000) || (packet->payload[cipher_offset+i*2] != packet->payload[cipher_offset+i*2+1])) {
	    /* Skip GREASE */
	    continue;
	  }

	  if(ja3.client.num_cipher < MAX_NUM_JA3)
	    ja3.client.cipher[ja3.client.num_cipher++] = cipher_suite;
	  else {
	    invalid_ja3 = 1;
#ifdef DEBUG_TLS
	    printf("Client TLS Invalid num ciphers %u\n", ja3.client.num_cipher);
#endif
	    break;
	  }

	  if(cipher_suite == 0xc02b /* TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 */ ||
	     cipher_suite == 0xc02f /* TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 */ ||
	     cipher_suite == 0xc030 /* TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 */ ||
	     cipher_suite == 0xc031 /* TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 */)
	    chrome_ciphers++;
	  else if(cipher_suite == 0x009c /* TLS_RSA_WITH_AES_128_CBC_SHA */ ||
		  cipher_suite == 0x009d /* TLS_RSA_WITH_AES_256_CBC_SHA */)
	    safari_ciphers++;
	  else if(cipher_suite == 0x00a0 /* TLS_RSA_WITH_AES_128_CBC_SHA256 */ ||
		  cipher_suite == 0x00a1 /* TLS_RSA_WITH_AES_256_CBC_SHA256 */ ||
		  cipher_suite == 0x00a2 /* TLS_RSA_WITH_AES_128_GCM_SHA256 */ ||
		  cipher_suite == 0x00a3 /* TLS_RSA_WITH_AES_256_GCM_SHA384 */)
	    looks_like_safari_on_big_sur = 1;
	  else if(cipher_suite == 0x00a8 /* TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 */ ||
		  cipher_suite == 0x00a9 /* TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256 */)
	    this_is_not_safari = 1;
	}