// Iterate through the list of cipher suites in the client's TLS handshake message.
// For each cipher suite, convert it from network byte order to host byte order.
// Skip cipher suites that match the GREASE pattern.
// For each non-GREASE cipher suite, add the cipher ID to the client's JA3 cipher list.
// Count the number of Safari and Chrome specific cipher suites to perform heuristic checks.
// Identify if the cipher suite looks like Safari on Big Sur for further browser heuristics.
for (i = 0; i < cipher_length; i += 2) {
  u_int16_t cipher_suite = ntohs(*((u_int16_t*)&packet->payload[cipher_offset + i]));

  if (is_grease_cipher_suite(cipher_suite)) {
    continue;
  }

  if (ja3.client.num_cipher < MAX_NUM_JA3) {
    ja3.client.cipher[ja3.client.num_cipher++] = cipher_suite;
  } else {
    invalid_ja3 = 1;
    break;
  }

  // Check for Safari and Chrome specific cipher suites
  if (is_safari_cipher_suite(cipher_suite)) {
    safari_ciphers++;
  } else if (is_chrome_cipher_suite(cipher_suite)) {
    chrome_ciphers++;
  }

  // Identify if the cipher suite looks like Safari on Big Sur
  if (looks_like_safari_on_big_sur(cipher_suite)) {
    looks_like_safari_on_big_sur = 1;
  }
}