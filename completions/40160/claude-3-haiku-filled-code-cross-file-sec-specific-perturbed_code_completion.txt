// Iterate through the list of cipher suites in the client's TLS handshake message.
// For each cipher suite, convert it from network byte order to host byte order.
// Skip cipher suites that match the GREASE pattern.
// For each non-GREASE cipher suite, add the cipher ID to the client's JA3 cipher list.
// Count the number of Safari and Chrome specific cipher suites to perform heuristic checks.
// Identify if the cipher suite looks like Safari on Big Sur for further browser heuristics.
for(i=0; i<cipher_length; i+=2) {
    u_int16_t cipher = ntohs(*((u_int16_t*)&packet->payload[cipher_offset+i]));

    // Skip GREASE cipher suites
    if((cipher & 0x0F0F) == 0x0A0A) {
        continue;
    }

    if(ja3.client.num_cipher < MAX_NUM_JA3) {
        ja3.client.cipher[ja3.client.num_cipher++] = cipher;
    } else {
        invalid_ja3 = 1;
        break;
    }

    // Heuristic checks for Safari and Chrome
    switch(cipher) {
        case 0xC02B: // TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
        case 0xC02F: // TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
        case 0xCCA8: // TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256
        case 0xCCA9: // TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
        case 0xCCAA: // TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
        case 0xCCAB: // TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256
        case 0xCCAC: // TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
        case 0xCCAD: // TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
        case 0xCCAF: // TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA
        case 0xCCB0: // TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA
        case 0xCCB3: // TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA
        case 0xCCB4: // TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA
            safari_ciphers++;
            break;
        case 0xC030: // TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
        case 0xC02C: // TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
            chrome_ciphers++;
            break;
        default:
            this_is_not_safari = 1;
            if(cipher == 0x1301) // TLS_AES_128_GCM_SHA256
                looks_like_safari_on_big_sur = 1;
            break;
    }
}