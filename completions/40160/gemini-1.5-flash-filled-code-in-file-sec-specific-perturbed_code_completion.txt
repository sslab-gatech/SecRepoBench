for(j=0; j<cipher_length; j+=2) {
	  u_int16_t cipher_suite = ntohs(*((u_int16_t*)&packet->payload[cipher_offset+j]));

	  if((cipher_suite == 0x0000) || (packet->payload[cipher_offset+j] != packet->payload[cipher_offset+j+1])) {
	    /* Skip GREASE */
	    continue;
	  }

	  if(ja3.client.num_cipher < MAX_NUM_JA3) {
	    ja3.client.cipher[ja3.client.num_cipher++] = cipher_suite;
	  } else {
	    invalid_ja3 = 1;
#ifdef DEBUG_TLS
	    printf("Client TLS Invalid num ciphers %u\n", ja3.client.num_cipher);
#endif
	  }

	  if(ndpi_is_safe_ssl_cipher(cipher_suite) == 1)
	    ndpi_set_risk(ndpi_struct, flow, NDPI_TLS_WEAK_CIPHER);

	  /* Safari specific ciphers */
	  if((cipher_suite == 0xc02b) || (cipher_suite == 0xc02f) || (cipher_suite == 0xc030))
	    safari_ciphers++;
	  else if((cipher_suite == 0xc00a) || (cipher_suite == 0xc009) || (cipher_suite == 0xc007) ||
		  (cipher_suite == 0xc008) || (cipher_suite == 0xc014) || (cipher_suite == 0xc013) ||
		  (cipher_suite == 0xc012) || (cipher_suite == 0xc011) || (cipher_suite == 0xc00f) ||
		  (cipher_suite == 0xc00e) || (cipher_suite == 0xc00d) || (cipher_suite == 0xc00c) ||
		  (cipher_suite == 0xc00b) || (cipher_suite == 0xc006) || (cipher_suite == 0xc02c) ||
		  (cipher_suite == 0xc02d) || (cipher_suite == 0xc02e) || (cipher_suite == 0xc02a) ||
		  (cipher_suite == 0xc029) || (cipher_suite == 0xc028) || (cipher_suite == 0xc027) ||
		  (cipher_suite == 0xc026) || (cipher_suite == 0xc025) || (cipher_suite == 0xc024) ||
		  (cipher_suite == 0xc023) || (cipher_suite == 0xc022) || (cipher_suite == 0xc021) ||
		  (cipher_suite == 0xc020) || (cipher_suite == 0xc01f) || (cipher_suite == 0xc01e) ||
		  (cipher_suite == 0xc01d) || (cipher_suite == 0xc01c) || (cipher_suite == 0xc01b) ||
		  (cipher_suite == 0xc01a) || (cipher_suite == 0xc019) || (cipher_suite == 0xc018) ||
		  (cipher_suite == 0xc017) || (cipher_suite == 0xc016) || (cipher_suite == 0xc015) ||
		  (cipher_suite == 0xc010) || (cipher_suite == 0xc005) || (cipher_suite == 0xc004) ||
		  (cipher_suite == 0xc003) || (cipher_suite == 0xc002) || (cipher_suite == 0xc001) ||
		  (cipher_suite == 0xc000))
	    chrome_ciphers++;
	  else if(cipher_suite == 0x009c)
	    looks_like_safari_on_big_sur = 1;
	  else
	    this_is_not_safari = 1;
	}