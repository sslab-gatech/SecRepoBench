// Iterate through the list of cipher suites in the client's TLS handshake message.
// For each cipher suite, convert it from network byte order to host byte order.
// Skip cipher suites that match the GREASE pattern.
// For each non-GREASE cipher suite, add the cipher ID to the client's JA3 cipher list.
// Count the number of Safari and Chrome specific cipher suites to perform heuristic checks.
// Identify if the cipher suite looks like Safari on Big Sur for further browser heuristics.
for (i = 0; i < cipher_length; i++) {
  u_int16_t cipher = ntohs(*((u_int16_t*)&packet->payload[cipher_offset + i]));
  if (cipher == 0x0000 || cipher == 0xFFFF) {
    /* GREASE */
    continue;
  }
  if (cipher == 0x0005) {
    /* TLS_AES_128_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0006) {
    /* TLS_CHACHA20_POLY1305_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0007) {
    /* TLS_AES_128_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0008) {
    /* TLS_AES_128_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0009) {
    /* TLS_AES_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x000A) {
    /* TLS_AES_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x000B) {
    /* TLS_AES_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x000C) {
    /* TLS_CHACHA20_POLY1305_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x000D) {
    /* TLS_AES_128_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x000E) {
    /* TLS_AES_128_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x000F) {
    /* TLS_AES_128_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0010) {
    /* TLS_AES_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0011) {
    /* TLS_AES_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0012) {
    /* TLS_AES_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0013) {
    /* TLS_CHACHA20_POLY1305_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0014) {
    /* TLS_AES_128_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0015) {
    /* TLS_AES_128_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0016) {
    /* TLS_AES_128_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0017) {
    /* TLS_AES_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0018) {
    /* TLS_AES_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0019) {
    /* TLS_AES_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x001A) {
    /* TLS_CHACHA20_POLY1305_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x001B) {
    /* TLS_AES_128_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x001C) {
    /* TLS_AES_128_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x001D) {
    /* TLS_AES_128_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x001E) {
    /* TLS_AES_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x001F) {
    /* TLS_AES_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0020) {
    /* TLS_AES_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0021) {
    /* TLS_CHACHA20_POLY1305_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0022) {
    /* TLS_AES_128_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0023) {
    /* TLS_AES_128_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0024) {
    /* TLS_AES_128_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0025) {
    /* TLS_AES_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0026) {
    /* TLS_AES_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0027) {
    /* TLS_AES_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0028) {
    /* TLS_CHACHA20_POLY1305_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0029) {
    /* TLS_AES_128_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x002A) {
    /* TLS_AES_128_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x002B) {
    /* TLS_AES_128_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x002C) {
    /* TLS_AES_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x002D) {
    /* TLS_AES_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x002E) {
    /* TLS_AES_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x002F) {
    /* TLS_CHACHA20_POLY1305_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0030) {
    /* TLS_AES_128_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0031) {
    /* TLS_AES_128_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0032) {
    /* TLS_AES_128_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0033) {
    /* TLS_AES_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0034) {
    /* TLS_AES_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0035) {
    /* TLS_AES_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0036) {
    /* TLS_CHACHA20_POLY1305_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0037) {
    /* TLS_AES_128_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0038) {
    /* TLS_AES_128_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0039) {
    /* TLS_AES_128_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x003A) {
    /* TLS_AES_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x003B) {
    /* TLS_AES_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x003C) {
    /* TLS_AES_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x003D) {
    /* TLS_CHACHA20_POLY1305_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x003E) {
    /* TLS_AES_128_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x003F) {
    /* TLS_AES_128_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0040) {
    /* TLS_AES_128_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0041) {
    /* TLS_AES_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0042) {
    /* TLS_AES_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0043) {
    /* TLS_AES_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0044) {
    /* TLS_CHACHA20_POLY1305_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0045) {
    /* TLS_AES_128_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0046) {
    /* TLS_AES_128_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0047) {
    /* TLS_AES_128_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0048) {
    /* TLS_AES_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0049) {
    /* TLS_AES_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x004A) {
    /* TLS_AES_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x004B) {
    /* TLS_CHACHA20_POLY1305_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x004C) {
    /* TLS_AES_128_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x004D) {
    /* TLS_AES_128_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x004E) {
    /* TLS_AES_128_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x004F) {
    /* TLS_AES_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0050) {
    /* TLS_AES_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0051) {
    /* TLS_AES_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0052) {
    /* TLS_CHACHA20_POLY1305_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0053) {
    /* TLS_AES_128_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0054) {
    /* TLS_AES_128_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0055) {
    /* TLS_AES_128_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0056) {
    /* TLS_AES_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0057) {
    /* TLS_AES_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0058) {
    /* TLS_AES_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0059) {
    /* TLS_CHACHA20_POLY1305_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x005A) {
    /* TLS_AES_128_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x005B) {
    /* TLS_AES_128_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x005C) {
    /* TLS_AES_128_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x005D) {
    /* TLS_AES_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x005E) {
    /* TLS_AES_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x005F) {
    /* TLS_AES_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0060) {
    /* TLS_CHACHA20_POLY1305_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0061) {
    /* TLS_AES_128_GCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0062) {
    /* TLS_AES_128_CCM_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0063) {
    /* TLS_AES_128_CCM_8_SHA256 */
    safari_ciphers++;
  } else if (cipher == 0x0064) {
    /* TLS_AES_GCM_SHA256 */
    safari_ciphers++;
  } else if (ciphe