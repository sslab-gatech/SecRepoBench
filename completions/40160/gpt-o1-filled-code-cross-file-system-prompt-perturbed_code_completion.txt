for(i = 0; i + 1 < cipher_length; i += 2) {
  u_int16_t c_id = ntohs(*((u_int16_t*)&packet->payload[cipher_offset + i]));

  /* Skip GREASE ciphers (where upper byte == lower byte) */
  if(((c_id >> 8) & 0xFF) == (c_id & 0xFF)) {
    continue;
  }

  /* Store cipher in JA3 list */
  if(ja3.client.num_cipher < MAX_NUM_JA3) {
    ja3.client.cipher[ja3.client.num_cipher++] = c_id;
  } else {
    invalid_ja3 = 1;
#ifdef DEBUG_TLS
    printf("Client TLS Invalid num ciphers %u\n", ja3.client.num_cipher);
#endif
  }

  /* Heuristic checks for Safari and Chrome */
  switch(c_id) {
    /* Common AES-GCM and CHACHA20 ciphers for modern Safari/Chrome */
    case 0x1301: /* TLS_AES_128_GCM_SHA256 */
    case 0x1302: /* TLS_AES_256_GCM_SHA384 */
    case 0x1303: /* TLS_CHACHA20_POLY1305_SHA256 */
    case 0xC02B: /* TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 */
    case 0xC02C: /* TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 */
    case 0xC02F: /* TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 */
    case 0xC030: /* TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 */
    case 0x009C: /* TLS_RSA_WITH_AES_128_GCM_SHA256 */
    case 0x009D: /* TLS_RSA_WITH_AES_256_GCM_SHA384 */
    case 0xCCA8: /* TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256 */
    case 0xCCA9: /* TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 */
      safari_ciphers++;
      chrome_ciphers++;
      break;

    default:
      this_is_not_safari = 1;
      break;
  }

  /* Heuristic check for Safari Big Sur or later */
  if(c_id == 0x1301) /* TLS_AES_128_GCM_SHA256 */
    looks_like_safari_on_big_sur = 1;
}