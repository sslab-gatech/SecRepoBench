for(i=0; i<cipher_length; i+=2) {
	  u_int16_t cipher = ntohs(*((u_int16_t*)&packet->payload[cipher_offset+i]));

	  if((cipher == 0) || (packet->payload[cipher_offset+i] != packet->payload[cipher_offset+i+1])) {
	    /* Skip GREASE */
	    continue;
	  }

	  if(ja3.client.num_cipher < MAX_NUM_JA3)
	    ja3.client.cipher[ja3.client.num_cipher++] = cipher;
	  else {
	    invalid_ja3 = 1;
#ifdef DEBUG_TLS
	    printf("Client TLS Invalid num cipher %u\n", ja3.client.num_cipher);
#endif
	  }

	  if(flow->protos.tls_quic_stun.tls_quic.client_unsafe_cipher == 0)
	    if((flow->protos.tls_quic_stun.tls_quic.client_unsafe_cipher = ndpi_is_safe_ssl_cipher(cipher)) == 1)
	      ndpi_set_risk(ndpi_struct, flow, NDPI_TLS_WEAK_CIPHER);

#ifdef DEBUG_HEURISTIC
	  printf("[CIPHERS] %04X\n", cipher);
#endif

	  switch(cipher) {
	  case TLS_RSA_WITH_AES_128_GCM_SHA256:
	  case TLS_RSA_WITH_AES_256_GCM_SHA384:
	  case TLS_RSA_WITH_AES_128_CBC_SHA256:
	  case TLS_RSA_WITH_AES_256_CBC_SHA384:
	  case TLS_RSA_WITH_AES_128_CBC_SHA:
	  case TLS_RSA_WITH_AES_256_CBC_SHA:
	  case TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256:
	  case TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384:
	  case TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256:
	  case TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384:
	  case TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256:
	  case TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384:
	  case TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256:
	  case TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384:
	  case TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA:
	  case TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA:
	  case TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA:
	  case TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA:
	    chrome_ciphers++, safari_ciphers++;
	    break;

	  case TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256:
	  case TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256:
	  case TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256:
	    chrome_ciphers++;
	    this_is_not_safari = 1;
	    break;

	  case TLS_AES_128_GCM_SHA256:
	  case TLS_AES_256_GCM_SHA384:
	  case TLS_CHACHA20_POLY1305_SHA256:
	    looks_like_safari_on_big_sur = this_is_not_safari = 1;
	    break;

	  default:
	    this_is_not_safari = 1;
	    break;
	  }
	}