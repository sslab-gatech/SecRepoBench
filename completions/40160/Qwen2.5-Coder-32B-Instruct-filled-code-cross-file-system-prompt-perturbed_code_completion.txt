for(i=0; i<cipher_length; i+=2) {
  u_int16_t cipher = ntohs(*((u_int16_t*)&packet->payload[cipher_offset+i]));

  if(cipher == 0 || (packet->payload[cipher_offset+i] == packet->payload[cipher_offset+i+1])) {
    /* Skip GREASE */
    continue;
  }

  if(ja3.client.num_cipher < MAX_NUM_JA3)
    ja3.client.cipher[ja3.client.num_cipher++] = cipher;
  else {
    invalid_ja3 = 1;
#ifdef DEBUG_TLS
    printf("Client TLS Invalid num cipher %u\n", ja3.client.num_cipher);
#endif
    break;
  }

  if(cipher == 0xC02B) safari_ciphers++; /* Safari specific cipher */
  if(cipher == 0xCCA9) chrome_ciphers++; /* Chrome specific cipher */
  if(cipher == 0x1301) this_is_not_safari = 1; /* TLS_AES_128_GCM_SHA256 */
  if(cipher == 0x1302) this_is_not_safari = 1; /* TLS_AES_256_GCM_SHA384 */
  if(cipher == 0x1303) this_is_not_safari = 1; /* TLS_CHACHA20_POLY1305_SHA256 */
  if(cipher == 0x1302 && chrome_ciphers == 12) looks_like_safari_on_big_sur = 1; /* TLS_CHACHA20_POLY1305_SHA256 */
}