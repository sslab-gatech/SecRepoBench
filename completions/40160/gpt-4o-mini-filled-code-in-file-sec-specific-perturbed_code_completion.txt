for (i = 0; i < cipher_length; i += 2) {
    u_int16_t cipher_suite = ntohs(*((u_int16_t*)&packet->payload[cipher_offset + i]));

    if (cipher_suite == 0x00FF) { // GREASE cipher
        continue;
    }

    if (ja3.client.num_cipher < MAX_NUM_JA3) {
        ja3.client.cipher[ja3.client.num_cipher++] = cipher_suite;
    } else {
        invalid_ja3 = 1; // Too many ciphers
    }

    // Check for specific browser heuristics
    if (cipher_suite == 0xC02F || cipher_suite == 0xC02B) { // Example cipher suites
        chrome_ciphers++;
    } else if (cipher_suite == 0xC02C) { // Another example
        safari_ciphers++;
    } else {
        this_is_not_safari = 1; // If we encounter a cipher not in Safari's list
    }
}