for(i=0; i<(cipher_length/2) && (cipher_offset+i*2+1) < packet->payload_packet_len; i++) {
  u_int16_t cipher_id = ntohs(*((u_int16_t*)&packet->payload[cipher_offset+i*2]));
  
  /* Check for GREASE pattern - values like 0x0A0A, 0x1A1A, etc. */
  /* GREASE values have the same value for both bytes and end with 0xA */
  if(((cipher_id & 0x00FF) == ((cipher_id & 0xFF00) >> 8)) && 
     ((cipher_id & 0x00FF) % 16 == 10))
    continue;  /* Skip GREASE */
  
  if(ja3.client.num_cipher < MAX_NUM_JA3)
    ja3.client.cipher[ja3.client.num_cipher++] = cipher_id;
  else {
    invalid_ja3 = 1;
#ifdef DEBUG_TLS
    printf("Client TLS Invalid num cipher %u\n", ja3.client.num_cipher);
#endif
    break;  /* No need to continue if we've exceeded MAX_NUM_JA3 */
  }
  
  /* Safari on MacOS specific ciphers */
  if(cipher_id == 0x1302 || cipher_id == 0x1303 || cipher_id == 0x1301 || cipher_id == 0xc02c ||
     cipher_id == 0xc02b || cipher_id == 0xcca9 || cipher_id == 0xcca8 || cipher_id == 0x009d ||
     cipher_id == 0x009c || cipher_id == 0x003d || cipher_id == 0x003c || cipher_id == 0x0035)
    safari_ciphers++;
    
  /* Chrome specific ciphers */
  if(cipher_id == 0x1303 || cipher_id == 0x1302 || cipher_id == 0x1301 || cipher_id == 0xc02c ||
     cipher_id == 0xc02b || cipher_id == 0xcca9 || cipher_id == 0xcca8 || cipher_id == 0xc00a ||
     cipher_id == 0xc009 || cipher_id == 0xc014 || cipher_id == 0xc013 || cipher_id == 0x009d ||
     cipher_id == 0x009c)
    chrome_ciphers++;
    
  /* Non-Safari browsers */
  if(cipher_id == 0xc011 || cipher_id == 0xc007 || cipher_id == 0x0005 || cipher_id == 0xc00c ||
     cipher_id == 0xc002)
    this_is_not_safari = 1;
    
  /* Safari on Big Sur has a specific cipher pattern */
  if(cipher_id == 0x1301 || cipher_id == 0x1302 || cipher_id == 0x1303)
    looks_like_safari_on_big_sur = 1;
}