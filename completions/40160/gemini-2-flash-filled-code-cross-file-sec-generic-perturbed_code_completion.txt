for(i=0; i<cipher_length; i+=2) {
	  u_int16_t cipher_id;

	  if((cipher_offset+i+1) >= total_len)
	    break;

	  cipher_id = ntohs(*((u_int16_t*)&packet->payload[cipher_offset+i]));

	  if((cipher_id != 0x0A0A) && (packet->payload[cipher_offset+i] == packet->payload[cipher_offset+i+1])) {
	    /* Skip GREASE */
#ifdef DEBUG_TLS
	    printf("[CIPHERS] [TLS Cipher Suite] Skipping GREASE 0x%04X\n", cipher_id);
#endif
	  } else {
	    if(ja3.client.num_cipher < MAX_NUM_JA3)
	      ja3.client.cipher[ja3.client.num_cipher++] = cipher_id;
	    else {
	      invalid_ja3 = 1;
#ifdef DEBUG_TLS
	      printf("Client TLS Invalid ciphers %u\n", ja3.client.num_cipher);
#endif
	    }

	    if(cipher_id == TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 ||
	       cipher_id == TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 ||
	       cipher_id == TLS_RSA_WITH_AES_128_GCM_SHA256 ||
	       cipher_id == TLS_RSA_WITH_AES_256_GCM_SHA384)
	      safari_ciphers++;
	    else
	      this_is_not_safari = 1;

	    if(cipher_id == TLS_CHACHA20_POLY1305_SHA256 ||
	       cipher_id == TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 ||
	       cipher_id == TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 ||
	       cipher_id == TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 ||
	       cipher_id == TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 ||
	       cipher_id == TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA ||
	       cipher_id == TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA ||
	       cipher_id == TLS_RSA_WITH_AES_128_GCM_SHA256 ||
	       cipher_id == TLS_RSA_WITH_AES_256_GCM_SHA384 ||
	       cipher_id == TLS_RSA_WITH_AES_128_CBC_SHA ||
	       cipher_id == TLS_RSA_WITH_AES_256_CBC_SHA ||
	       cipher_id == TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 ||
	       cipher_id == TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256)
	      chrome_ciphers++;

	    if(cipher_id == TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 ||
	       cipher_id == TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 ||
	       cipher_id == TLS_RSA_WITH_AES_128_GCM_SHA256 ||
	       cipher_id == TLS_RSA_WITH_AES_256_GCM_SHA384)
	      looks_like_safari_on_big_sur = 1;

#ifdef DEBUG_TLS
	    printf("[CIPHERS] [TLS Cipher Suite] 0x%04X\n", cipher_id);
#endif
	  }
	}