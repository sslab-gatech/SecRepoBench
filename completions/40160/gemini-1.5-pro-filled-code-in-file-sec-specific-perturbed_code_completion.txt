for(i=0; i<cipher_length; i+=2) {
          u_int16_t cipher_suite = ntohs(*((u_int16_t*)&packet->payload[cipher_offset+i]));

#ifdef DEBUG_TLS
          printf("Client TLS [cipher: %04X]\n", cipher_suite);
#endif

          if((cipher_suite == 0) || (packet->payload[cipher_offset+i] != packet->payload[cipher_offset+i+1])) {
            /* Skip GREASE */
            continue;
          }

          if(ja3.client.num_cipher < MAX_NUM_JA3)
            ja3.client.cipher[ja3.client.num_cipher++] = cipher_suite;
          else {
            invalid_ja3 = 1;
#ifdef DEBUG_TLS
            printf("Client TLS Invalid num cipher %u\n", ja3.client.num_cipher);
#endif
          }

          if(flow->protos.tls_quic_stun.tls_quic.client_unsafe_cipher == 0)
            if((flow->protos.tls_quic_stun.tls_quic.client_unsafe_cipher = ndpi_is_safe_ssl_cipher(cipher_suite)) == 1)
              ndpi_set_risk(ndpi_struct, flow, NDPI_TLS_WEAK_CIPHER);

#ifdef DEBUG_HEURISTIC
          printf("[CIPHERS] [TLS Cipher Suite] 0x%04X\n", cipher_suite);
#endif
          switch(cipher_suite) {
          case TLS_RSA_WITH_AES_128_GCM_SHA256:
          case TLS_RSA_WITH_AES_256_GCM_SHA384:
          case TLS_RSA_WITH_AES_128_CBC_SHA256:
          case TLS_RSA_WITH_AES_256_CBC_SHA384:
          case TLS_RSA_WITH_AES_128_CBC_SHA:
          case TLS_RSA_WITH_AES_256_CBC_SHA:
          case TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256:
          case TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384:
          case TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256:
          case TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384:
          case TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256:
          case TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384:
            chrome_ciphers++, safari_ciphers++;
#ifdef DEBUG_HEURISTIC
            printf("[CIPHERS] [Chrome/Safari] Found 0x%04X [chrome: %u][safari: %u]\n",
                   cipher_suite, chrome_ciphers, safari_ciphers);
#endif

            break;

          case TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA:
          case TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA:
          case TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA:
          case TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA:
            safari_ciphers++;
#ifdef DEBUG_HEURISTIC
            printf("[CIPHERS] [Safari] Found 0x%04X [safari: %u]\n", cipher_suite, safari_ciphers);
#endif

            break;

          case TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256:
          case TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256:
            chrome_ciphers++;
#ifdef DEBUG_HEURISTIC
            printf("[CIPHERS] [Chrome] Found 0x%04X [chrome: %u]\n", cipher_suite, chrome_ciphers);
#endif

            break;

          case TLS_AES_128_GCM_SHA256:
          case TLS_AES_256_GCM_SHA384:
          case TLS_CHACHA20_POLY1305_SHA256:
            this_is_not_safari = 1;
#ifdef DEBUG_HEURISTIC
            printf("[CIPHERS] [Not Safari] Found 0x%04X\n", cipher_suite);
#endif

            break;

          case TLS_AES_128_CCM_SHA256:
          case TLS_AES_128_CCM_8_SHA256:
            looks_like_safari_on_big_sur = 1;
#ifdef DEBUG_HEURISTIC
            printf("[CIPHERS] [Looks like Safari on Big Sur] Found 0x%04X\n", cipher_suite);
#endif

            break;

          default:
            this_is_not_safari = 1;
#ifdef DEBUG_HEURISTIC
            printf("[CIPHERS] [Not Safari] Found 0x%04X\n", cipher_suite);
#endif
            break;
          }
        }