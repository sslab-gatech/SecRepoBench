for(j=0; j<cipher_length; j+=2) {
	  u_int16_t cipher_suite = ntohs(*((u_int16_t*)&packet->payload[cipher_offset+j]));

	  if((cipher_suite == 0x0000) || (packet->payload[cipher_offset+j] != packet->payload[cipher_offset+j+1])) {
	    /* Skip GREASE */
	    if(ja3.client.num_cipher < MAX_NUM_JA3)
	      ja3.client.cipher[ja3.client.num_cipher++] = cipher_suite;
	    else {
	      invalid_ja3 = 1;
#ifdef DEBUG_TLS
	      printf("Client TLS Invalid num ciphers %u\n", ja3.client.num_cipher);
#endif
	    }
	  } else {
	    /* Check for Safari and Chrome specific cipher suites */
	    if(cipher_suite == 0xc02b || cipher_suite == 0xc02f || cipher_suite == 0xc030 ||
	       cipher_suite == 0xc031 || cipher_suite == 0xc032 || cipher_suite == 0xc033 ||
	       cipher_suite == 0xc034 || cipher_suite == 0xc035 || cipher_suite == 0xc036 ||
	       cipher_suite == 0xc037 || cipher_suite == 0xc038 || cipher_suite == 0xc039 ||
	       cipher_suite == 0xc03a || cipher_suite == 0xc03b || cipher_suite == 0xc03c ||
	       cipher_suite == 0xc03d || cipher_suite == 0xc03e || cipher_suite == 0xc03f ||
	       cipher_suite == 0xc040 || cipher_suite == 0xc041 || cipher_suite == 0xc042 ||
	       cipher_suite == 0xc043 || cipher_suite == 0xc044 || cipher_suite == 0xc045 ||
	       cipher_suite == 0xc046 || cipher_suite == 0xc047 || cipher_suite == 0xc048 ||
	       cipher_suite == 0xc049 || cipher_suite == 0xc04a || cipher_suite == 0xc04b ||
	       cipher_suite == 0xc04c || cipher_suite == 0xc04d || cipher_suite == 0xc04e ||
	       cipher_suite == 0xc04f || cipher_suite == 0xc050 || cipher_suite == 0xc051 ||
	       cipher_suite == 0xc052 || cipher_suite == 0xc053 || cipher_suite == 0xc054 ||
	       cipher_suite == 0xc055 || cipher_suite == 0xc056 || cipher_suite == 0xc057 ||
	       cipher_suite == 0xc058 || cipher_suite == 0xc059 || cipher_suite == 0xc05a ||
	       cipher_suite == 0xc05b || cipher_suite == 0xc05c || cipher_suite == 0xc05d ||
	       cipher_suite == 0xc05e || cipher_suite == 0xc05f || cipher_suite == 0xc060 ||
	       cipher_suite == 0xc061 || cipher_suite == 0xc062 || cipher_suite == 0xc063 ||
	       cipher_suite == 0xc064 || cipher_suite == 0xc065 || cipher_suite == 0xc066 ||
	       cipher_suite == 0xc067 || cipher_suite == 0xc068 || cipher_suite == 0xc069 ||
	       cipher_suite == 0xc06a || cipher_suite == 0xc06b || cipher_suite == 0xc06c ||
	       cipher_suite == 0xc06d || cipher_suite == 0xc06e || cipher_suite == 0xc06f ||
	       cipher_suite == 0xc070 || cipher_suite == 0xc071 || cipher_suite == 0xc072 ||
	       cipher_suite == 0xc073 || cipher_suite == 0xc074 || cipher_suite == 0xc075 ||
	       cipher_suite == 0xc076 || cipher_suite == 0xc077 || cipher_suite == 0xc078 ||
	       cipher_suite == 0xc079 || cipher_suite == 0xc07a || cipher_suite == 0xc07b ||
	       cipher_suite == 0xc07c || cipher_suite == 0xc07d || cipher_suite == 0xc07e ||
	       cipher_suite == 0xc07f || cipher_suite == 0xc080 || cipher_suite == 0xc081 ||
	       cipher_suite == 0xc082 || cipher_suite == 0xc083 || cipher_suite == 0xc084 ||
	       cipher_suite == 0xc085 || cipher_suite == 0xc086 || cipher_suite == 0xc087 ||
	       cipher_suite == 0xc088 || cipher_suite == 0xc089 || cipher_suite == 0xc08a ||
	       cipher_suite == 0xc08b || cipher_suite == 0xc08c || cipher_suite == 0xc08d ||
	       cipher_suite == 0xc08e || cipher_suite == 0xc08f || cipher_suite == 0xc090 ||
	       cipher_suite == 0xc091 || cipher_suite == 0xc092 || cipher_suite == 0xc093 ||
	       cipher_suite == 0xc094 || cipher_suite == 0xc095 || cipher_suite == 0xc096 ||
	       cipher_suite == 0xc097 || cipher_suite == 0xc098 || cipher_suite == 0xc099 ||
	       cipher_suite == 0xc09a || cipher_suite == 0xc09b || cipher_suite == 0xc09c ||
	       cipher_suite == 0xc09d || cipher_suite == 0xc09e || cipher_suite == 0xc09f ||
	       cipher_suite == 0xca98 || cipher_suite == 0xca99 || cipher_suite == 0xca9a ||
	       cipher_suite == 0xca9b || cipher_suite == 0xca9c || cipher_suite == 0xca9d ||
	       cipher_suite == 0xca9e || cipher_suite == 0xca9f || cipher_suite == 0xc00a ||
	       cipher_suite == 0xc00b || cipher_suite == 0xc00c || cipher_suite == 0xc00d ||
	       cipher_suite == 0xc00e || cipher_suite == 0xc00f || cipher_suite == 0xc010 ||
	       cipher_suite == 0xc011 || cipher_suite == 0xc012 || cipher_suite == 0xc013 ||
	       cipher_suite == 0xc014 || cipher_suite == 0xc015 || cipher_suite == 0xc016 ||
	       cipher_suite == 0xc017 || cipher_suite == 0xc018 || cipher_suite == 0xc019 ||
	       cipher_suite == 0xc01a || cipher_suite == 0xc01b || cipher_suite == 0xc01c ||
	       cipher_suite == 0xc01d || cipher_suite == 0xc01e || cipher_suite == 0xc01f ||
	       cipher_suite == 0xc020 || cipher_suite == 0xc021 || cipher_suite == 0xc022 ||
	       cipher_suite == 0xc023 || cipher_suite == 0xc024 || cipher_suite == 0xc025 ||
	       cipher_suite == 0xc026 || cipher_suite == 0xc027 || cipher_suite == 0xc028 ||
	       cipher_suite == 0xc029 || cipher_suite == 0xc02a) {
	      safari_ciphers++;
	      this_is_not_safari = 0;
	    } else if(cipher_suite == 0x009c || cipher_suite == 0x009d || cipher_suite == 0x009e ||
		      cipher_suite == 0x009f || cipher_suite == 0x00a0 || cipher_suite == 0x00a1 ||
		      cipher_suite == 0x00a2 || cipher_suite == 0x00a3 || cipher_suite == 0x00a4 ||
		      cipher_suite == 0x00a5 || cipher_suite == 0x00a6 || cipher_suite == 0x00a7 ||
		      cipher_suite == 0x00a8 || cipher_suite == 0x00a9 || cipher_suite == 0x00aa ||
		      cipher_suite == 0x00ab || cipher_suite == 0x00ac || cipher_suite == 0x00ad ||
		      cipher_suite == 0x00ae || cipher_suite == 0x00af || cipher_suite == 0x00b0 ||
		      cipher_suite == 0x00b1 || cipher_suite == 0x00b2 || cipher_suite == 0x00b3 ||
		      cipher_suite == 0x00b4 || cipher_suite == 0x00b5 || cipher_suite == 0x00b6 ||
		      cipher_suite == 0x00b7 || cipher_suite == 0x00b8 || cipher_suite == 0x00b9 ||
		      cipher_suite == 0x00ba || cipher_suite == 0x00bb || cipher_suite == 0x00bc ||
		      cipher_suite == 0x00bd || cipher_suite == 0x00be || cipher_suite == 0x00bf ||
		      cipher_suite == 0x00c0 || cipher_suite == 0x00c1 || cipher_suite == 0x00c2 ||
		      cipher_suite == 0x00c3 || cipher_suite == 0x00c4 || cipher_suite == 0x00c5 ||
		      cipher_suite == 0x00c6 || cipher_suite == 0x00c7 || cipher_suite == 0x00c8 ||
		      cipher_suite == 0x00c9 || cipher_suite == 0x00ca || cipher_suite == 0x00cb ||
		      cipher_suite == 0x00cc || cipher_suite == 0x00cd || cipher_suite == 0x00ce ||
		      cipher_suite == 0x00cf || cipher_suite == 0x00d0 || cipher_suite == 0x00d1 ||
		      cipher_suite == 0x00d2 || cipher_suite == 0x00d3 || cipher_suite == 0x00d4 ||
		      cipher_suite == 0x00d5 || cipher_suite == 0x00d6 || cipher_suite == 0x00d7 ||
		      cipher_suite == 0x00d8 || cipher_suite == 0x00d9 || cipher_suite == 0x00da ||
		      cipher_suite == 0x00db || cipher_suite == 0x00dc || cipher_suite == 0x00dd ||
		      cipher_suite == 0x00de || cipher_suite == 0x00df || cipher_suite == 0x00e0 ||
		      cipher_suite == 0x00e1 || cipher_suite == 0x00e2 || cipher_suite == 0x00e3 ||
		      cipher_suite == 0x00e4 || cipher_suite == 0x00e5 || cipher_suite == 0x00e6 ||
		      cipher_suite == 0x00