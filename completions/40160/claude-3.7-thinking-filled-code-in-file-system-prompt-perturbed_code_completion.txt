for(i = 0; i < (cipher_length/2); i++) {
  u_int16_t cipher = ntohs(*((u_int16_t*)&packet->payload[cipher_offset]));
  
  cipher_offset += 2;
  
  /* Skip GREASE */
  if(((cipher & 0x0A0A) == 0x0A0A) && ((cipher & 0x0F0F) == 0x0A0A)) {
    continue;
  }
  
  if(ja3.client.num_cipher < MAX_NUM_JA3) {
    ja3.client.cipher[ja3.client.num_cipher++] = cipher;
  } else {
    invalid_ja3 = 1;
    break;
  }
  
  /* Safari pattern */
  if(cipher == 0x1303 || cipher == 0x1301 || cipher == 0xc02b || cipher == 0xc02f ||
     cipher == 0xc02c || cipher == 0xc030 || cipher == 0xcca9 || cipher == 0xcca8 ||
     cipher == 0x009c || cipher == 0x009d || cipher == 0x002f || cipher == 0x0035) {
    safari_ciphers++;
  } else if(cipher == 0x0033 || cipher == 0x0039 || cipher == 0x009e || cipher == 0x009f ||
            cipher == 0xc00a || cipher == 0xc009 || cipher == 0xc013 || cipher == 0xc014 ||
            cipher == 0xc007 || cipher == 0xc011) {
    this_is_not_safari = 1;
  }
  
  /* Chrome pattern */
  if(cipher == 0x1303 || cipher == 0x1302 || cipher == 0x1301 || cipher == 0xc02b ||
     cipher == 0xc02f || cipher == 0xc02c || cipher == 0xc030 || cipher == 0xcca9 ||
     cipher == 0xcca8 || cipher == 0x009c || cipher == 0x009d || cipher == 0x002f ||
     cipher == 0x0035) {
    chrome_ciphers++;
  }
  
  /* For Big Sur check */
  if(cipher == 0x1303)
    looks_like_safari_on_big_sur = 1;
}