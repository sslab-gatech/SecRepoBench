for (i = 0; i < cipher_length; i += 2) {
        u_int16_t cipher_suite = ntohs(*((u_int16_t*)&packet->payload[cipher_offset + i]));

        // Skip GREASE cipher suites
        if ((cipher_suite & 0xFF00) == 0x00FF) {
          continue;
        }

        if (ja3.client.num_cipher < MAX_NUM_JA3) {
          ja3.client.cipher[ja3.client.num_cipher++] = cipher_suite;
        }

        // Count Safari and Chrome specific ciphers
        if (is_safari_cipher(cipher_suite)) {
          safari_ciphers++;
        } else if (is_chrome_cipher(cipher_suite)) {
          chrome_ciphers++;
        }
      }