for(i = 0; i < cipher_length; i += 2) {
	  u_int16_t cipher_id = ntohs(*((u_int16_t*)&packet->payload[cipher_offset + i]));

	  if((cipher_id & 0x0F0F) == 0x0A0A) /* Skip GREASE */
	    continue;

	  if(ja3.client.num_cipher < MAX_NUM_JA3)
	    ja3.client.cipher[ja3.client.num_cipher++] = cipher_id;
	  else {
	    invalid_ja3 = 1;
#ifdef DEBUG_TLS
	    printf("Client TLS Invalid ciphers %u\n", ja3.client.num_cipher);
#endif
	  }

	  switch(cipher_id) {
	  case 0x1301: /* TLS_AES_128_GCM_SHA256 */
	  case 0x1302: /* TLS_AES_256_GCM_SHA384 */
	  case 0x1303: /* TLS_CHACHA20_POLY1305_SHA256 */
	  case 0x1304: /* TLS_AES_128_CCM_SHA256 */
	  case 0x1305: /* TLS_AES_128_CCM_8_SHA256 */
	    safari_ciphers++;
	    break;

	  case 0x1301: /* TLS_AES_128_GCM_SHA256 */
	  case 0x1302: /* TLS_AES_256_GCM_SHA384 */
	  case 0x1303: /* TLS_CHACHA20_POLY1305_SHA256 */
	  case 0x1304: /* TLS_AES_128_CCM_SHA256 */
	  case 0x1305: /* TLS_AES_128_CCM_8_SHA256 */
	  case 0xC02B: /* TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 */
	  case 0xC02F: /* TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 */
	  case 0xC02C: /* TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 */
	  case 0xC030: /* TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 */
	  case 0xC009: /* TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA */
	  case 0xC013: /* TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA */
	  case 0xC00A: /* TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA */
	  case 0xC014: /* TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA */
	    chrome_ciphers++;
	    break;

	  case 0xC02B: /* TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 */
	  case 0xC02F: /* TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 */
	  case 0xC02C: /* TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 */
	  case 0xC030: /* TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 */
	  case 0xC009: /* TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA */
	  case 0xC013: /* TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA */
	  case 0xC00A: /* TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA */
	  case 0xC014: /* TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA */
	    looks_like_safari_on_big_sur++;
	    break;

	  default:
	    this_is_not_safari = 1;
	    break;
	  }
	}