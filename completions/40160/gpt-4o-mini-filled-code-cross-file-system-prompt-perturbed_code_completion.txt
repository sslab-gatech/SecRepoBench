for (i = 0; i < cipher_length; i += 2) {
    u_int16_t cipher_suite = ntohs(*((u_int16_t*)&packet->payload[cipher_offset + i]));

    // Skip GREASE cipher suites
    if ((cipher_suite & 0xFF00) == 0x00FF || (cipher_suite & 0x00FF) == 0xFF00) {
        continue;
    }

    if (ja3.client.num_cipher < MAX_NUM_JA3) {
        ja3.client.cipher[ja3.client.num_cipher++] = cipher_suite;
    }

    // Heuristic checks for Safari and Chrome specific ciphers
    if (cipher_suite == 0xC02B || cipher_suite == 0xC02F) { // Example Safari ciphers
        safari_ciphers++;
    } else if (cipher_suite == 0xC02C || cipher_suite == 0xC030) { // Example Chrome ciphers
        chrome_ciphers++;
    } else {
        this_is_not_safari = 1; // If we find a non-Safari cipher, mark it
    }

    // Check for Safari on Big Sur heuristics
    if (cipher_suite == 0xC02B) { // Example cipher that indicates Safari on Big Sur
        looks_like_safari_on_big_sur = 1;
    }
}