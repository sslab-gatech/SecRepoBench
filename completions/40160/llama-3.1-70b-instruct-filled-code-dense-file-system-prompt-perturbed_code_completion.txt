_smtp.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_MAIL_SMTP:
    ndpi_serialize_start_of_block(serializer, "smtp");
    ndpi_serialize_string_string(serializer,  "user", flow->protos.ftp_imap_pop_smtp.username);
    ndpi_serialize_string_string(serializer,  "password", flow->protos.ftp_imap_pop_smtp.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_FTP:
    ndpi_serialize_start_of_block(serializer, "ftp");
    ndpi_serialize_string_string(serializer,  "user", flow->protos.ftp_imap_pop_smtp.username);
    ndpi_serialize_string_string(serializer,  "password", flow->protos.ftp_imap_pop_smtp.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SSH:
    ndpi_serialize_start_of_block(serializer, "ssh");
    ndpi_serialize_string_string(serializer,  "username", flow->protos.ssh.username);
    ndpi_serialize_string_string(serializer,  "password", flow->protos.ssh.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_TLS:
    ndpi_serialize_start_of_block(serializer, "tls");
    if(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[0]!= '\0')
      ndpi_serialize_string_string(serializer, "client_requested_server_name",
                                   flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
    if(flow->protos.tls_quic_stun.tls_quic.ssl_version) {
      u_int8_t unknown_tls_version;
      char *version = ndpi_ssl_version2str(flow, flow->protos.tls_quic_stun.tls_quic.ssl_version, &unknown_tls_version);

      if(!unknown_tls_version)
	ndpi_serialize_string_string(serializer, "version", version);
      if(flow->protos.tls_quic_stun.tls_quic.alpn)
        ndpi_serialize_string_string(serializer, "alpn", flow->protos.tls_quic_stun.tls_quic.alpn);
      ndpi_serialize_string_string(serializer, "ja3", flow->protos.tls_quic_stun.tls_quic.ja3_client);
      if(flow->protos.tls_quic_stun.tls_quic.tls_supported_versions)
        ndpi_serialize_string_string(serializer, "tls_supported_versions", flow->protos.tls_quic_stun.tls_quic.tls_supported_versions);
    }
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_STUN:
    ndpi_serialize_start_of_block(serializer, "stun");
    ndpi_serialize_string_string(serializer, "username", flow->protos.stun.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.stun.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_RTP:
    ndpi_serialize_start_of_block(serializer, "rtp");
    ndpi_serialize_string_uint32(serializer, "ssrc", flow->protos.rtp.ssrc);
    ndpi_serialize_string_uint32(serializer, "seq", flow->protos.rtp.seq);
    ndpi_serialize_string_uint32(serializer, "timestamp", flow->protos.rtp.timestamp);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_RTCP:
    ndpi_serialize_start_of_block(serializer, "rtcp");
    ndpi_serialize_string_uint32(serializer, "ssrc", flow->protos.rtcp.ssrc);
    ndpi_serialize_string_uint32(serializer, "ntp", flow->protos.rtcp.ntp);
    ndpi_serialize_string_uint32(serializer, "timestamp", flow->protos.rtcp.timestamp);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SIP:
    ndpi_serialize_start_of_block(serializer, "sip");
    ndpi_serialize_string_string(serializer, "method", flow->protos.sip.method);
    ndpi_serialize_string_string(serializer, "uri", flow->protos.sip.uri);
    ndpi_serialize_string_string(serializer, "to", flow->protos.sip.to);
    ndpi_serialize_string_string(serializer, "from", flow->protos.sip.from);
    ndpi_serialize_string_string(serializer, "user_agent", flow->protos.sip.user_agent);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_H323:
    ndpi_serialize_start_of_block(serializer, "h323");
    ndpi_serialize_string_string(serializer, "gk_ip", flow->protos.h323.gk_ip);
    ndpi_serialize_string_string(serializer, "gk_port", flow->protos.h323.gk_port);
    ndpi_serialize_string_string(serializer, "cseq", flow->protos.h323.cseq);
    ndpi_serialize_string_string(serializer, "call_id", flow->protos.h323.call_id);
    ndpi_serialize_string_string(serializer, "h225_ip", flow->protos.h323.h225_ip);
    ndpi_serialize_string_string(serializer, "h225_port", flow->protos.h323.h225_port);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_MGCP:
    ndpi_serialize_start_of_block(serializer, "mgcp");
    ndpi_serialize_string_string(serializer, "transaction_id", flow->protos.mgcp.transaction_id);
    ndpi_serialize_string_string(serializer, "call_id", flow->protos.mgcp.call_id);
    ndpi_serialize_string_string(serializer, "mgw_ip", flow->protos.mgcp.mgw_ip);
    ndpi_serialize_string_string(serializer, "mgw_port", flow->protos.mgcp.mgw_port);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_MSN:
    ndpi_serialize_start_of_block(serializer, "msn");
    ndpi_serialize_string_string(serializer, "username", flow->protos.msn.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.msn.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_XBOX:
    ndpi_serialize_start_of_block(serializer, "xbox");
    ndpi_serialize_string_string(serializer, "username", flow->protos.xbox.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.xbox.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_AOL:
    ndpi_serialize_start_of_block(serializer, "aol");
    ndpi_serialize_string_string(serializer, "username", flow->protos.aol.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.aol.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_IRC:
    ndpi_serialize_start_of_block(serializer, "irc");
    ndpi_serialize_string_string(serializer, "username", flow->protos.irc.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.irc.password);
    ndpi_serialize_string_string(serializer, "nick", flow->protos.irc.nick);
    ndpi_serialize_string_string(serializer, "realname", flow->protos.irc.realname);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SKYPE:
    ndpi_serialize_start_of_block(serializer, "skype");
    ndpi_serialize_string_string(serializer, "username", flow->protos.skype.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.skype.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_TOR:
    ndpi_serialize_start_of_block(serializer, "tor");
    ndpi_serialize_string_string(serializer, "username", flow->protos.tor.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.tor.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_DCERPC:
    ndpi_serialize_start_of_block(serializer, "dcerpc");
    ndpi_serialize_string_string(serializer, "username", flow->protos.dcerpc.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.dcerpc.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_ORACLE:
    ndpi_serialize_start_of_block(serializer, "oracle");
    ndpi_serialize_string_string(serializer, "username", flow->protos.oracle.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.oracle.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SYMPA:
    ndpi_serialize_start_of_block(serializer, "sympa");
    ndpi_serialize_string_string(serializer, "username", flow->protos.sympa.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.sympa.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_LDAP:
    ndpi_serialize_start_of_block(serializer, "ldap");
    ndpi_serialize_string_string(serializer, "username", flow->protos.ldap.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.ldap.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_MYSQL:
    ndpi_serialize_start_of_block(serializer, "mysql");
    ndpi_serialize_string_string(serializer, "username", flow->protos.mysql.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.mysql.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_POSTGRES:
    ndpi_serialize_start_of_block(serializer, "postgres");
    ndpi_serialize_string_string(serializer, "username", flow->protos.postgres.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.postgres.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_REDIS:
    ndpi_serialize_start_of_block(serializer, "redis");
    ndpi_serialize_string_string(serializer, "username", flow->protos.redis.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.redis.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_MONGODB:
    ndpi_serialize_start_of_block(serializer, "mongodb");
    ndpi_serialize_string_string(serializer, "username", flow->protos.mongodb.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.mongodb.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_CASSANDRA:
    ndpi_serialize_start_of_block(serializer, "cassandra");
    ndpi_serialize_string_string(serializer, "username", flow->protos.cassandra.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.cassandra.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_RTP:
    ndpi_serialize_start_of_block(serializer, "rtp");
    ndpi_serialize_string_uint32(serializer, "ssrc", flow->protos.rtp.ssrc);
    ndpi_serialize_string_uint32(serializer, "seq", flow->protos.rtp.seq);
    ndpi_serialize_string_uint32(serializer, "timestamp", flow->protos.rtp.timestamp);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_RTCP:
    ndpi_serialize_start_of_block(serializer, "rtcp");
    ndpi_serialize_string_uint32(serializer, "ssrc", flow->protos.rtcp.ssrc);
    ndpi_serialize_string_uint32(serializer, "ntp", flow->protos.rtcp.ntp);
    ndpi_serialize_string_uint32(serializer, "timestamp", flow->protos.rtcp.timestamp);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SIP:
    ndpi_serialize_start_of_block(serializer, "sip");
    ndpi_serialize_string_string(serializer, "method", flow->protos.sip.method);
    ndpi_serialize_string_string(serializer, "uri", flow->protos.sip.uri);
    ndpi_serialize_string_string(serializer, "to", flow->protos.sip.to);
    ndpi_serialize_string_string(serializer, "from", flow->protos.sip.from);
    ndpi_serialize_string_string(serializer, "user_agent", flow->protos.sip.user_agent);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_H323:
    ndpi_serialize_start_of_block(serializer, "h323");
    ndpi_serialize_string_string(serializer, "gk_ip", flow->protos.h323.gk_ip);
    ndpi_serialize_string_string(serializer, "gk_port", flow->protos.h323.gk_port);
    ndpi_serialize_string_string(serializer, "cseq", flow->protos.h323.cseq);
    ndpi_serialize_string_string(serializer, "call_id", flow->protos.h323.call_id);
    ndpi_serialize_string_string(serializer, "h225_ip", flow->protos.h323.h225_ip);
    ndpi_serialize_string_string(serializer, "h225_port", flow->protos.h323.h225_port);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_MGCP:
    ndpi_serialize_start_of_block(serializer, "mgcp");
    ndpi_serialize_string_string(serializer, "transaction_id", flow->protos.mgcp.transaction_id);
    ndpi_serialize_string_string(serializer, "call_id", flow->protos.mgcp.call_id);
    ndpi_serialize_string_string(serializer, "mgw_ip", flow->protos.mgcp.mgw_ip);
    ndpi_serialize_string_string(serializer, "mgw_port", flow->protos.mgcp.mgw_port);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_MSN:
    ndpi_serialize_start_of_block(serializer, "msn");
    ndpi_serialize_string_string(serializer, "username", flow->protos.msn.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.msn.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_XBOX:
    ndpi_serialize_start_of_block(serializer, "xbox");
    ndpi_serialize_string_string(serializer, "username", flow->protos.xbox.username);
    nd