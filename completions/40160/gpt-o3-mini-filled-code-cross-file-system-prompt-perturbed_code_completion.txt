for (u_int16_t j = 0; j < cipher_length; j += 2) {
    if (cipher_offset + j + 1 >= total_len)
        break;
    u_int16_t cipher = ntohs(*((u_int16_t *)&packet->payload[cipher_offset + j]));

    // Skip GREASE values: GREASE cipher suites typically have identical high and low bytes
    // and their lower nibble equals 0x0a. This check approximates that behavior.
    if (((cipher & 0xff) == ((cipher >> 8) & 0xff)) && (((cipher & 0xff) & 0x0f) == 0x0a))
        continue;

    if (ja3.client.num_cipher < MAX_NUM_JA3)
        ja3.client.cipher[ja3.client.num_cipher++] = cipher;

    // Heuristics to count Safari and Chrome specific cipher suites.
    // These conditions are example checks. Adjust the cipher values as necessary.
    if (cipher == 0x1301 || cipher == 0x1302 || cipher == 0x1303)
        chrome_ciphers++;
    else if (cipher == 0xc02b || cipher == 0xc02f || cipher == 0xc030)
        safari_ciphers++;
    else
        this_is_not_safari = 1;

    // Identify a cipher that might indicate Safari on Big Sur.
    if (cipher == 0xcca9)
        looks_like_safari_on_big_sur = 1;
}