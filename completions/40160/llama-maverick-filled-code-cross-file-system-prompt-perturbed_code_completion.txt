for(i = 0, j = cipher_offset; i < cipher_length; i += 2, j += 2) {
  u_int16_t cipher_id = ntohs(*((u_int16_t*)&packet->payload[j]));

  if(ja3.client.num_cipher < MAX_NUM_JA3)
    ja3.client.cipher[ja3.client.num_cipher++] = cipher_id;
  else {
    invalid_ja3 = 1;
#ifdef DEBUG_TLS
    printf("Client TLS Invalid cipher %u\n", ja3.client.num_cipher);
#endif
  }

  if((i == 0) && (cipher_id == 0x1301))  this_is_not_safari = 1;

  if(cipher_id == 0xCCA8 || cipher_id == 0xCCA9)
    chrome_ciphers++, safari_ciphers++;
  else if(cipher_id == 0x1301 || cipher_id == 0x1302 || cipher_id == 0x1303)
    chrome_ciphers++;
  else if(cipher_id == 0xC02B || cipher_id == 0xC02C || cipher_id == 0xC02F || cipher_id == 0xC030 ||
	  cipher_id == 0xCCA9 /* older macOS */)
    safari_ciphers++;

  if(cipher_id != 0x0A0A /* GREASE */)
    looks_like_safari_on_big_sur = 1;
  else
    this_is_not_safari = 1;
}