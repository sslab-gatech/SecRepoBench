for(i=0; i<(cipher_length/2); i++) {
  u_int16_t cipher = ntohs(*((u_int16_t*)&packet->payload[cipher_offset+i*2]));
  
  /* Skip GREASE cipher suites (where the two bytes are equal) */
  if((cipher != 0) && ((packet->payload[cipher_offset+i*2] != packet->payload[cipher_offset+i*2+1]))) {
    /* Add cipher to JA3 fingerprint */
    if(ja3.client.num_cipher < MAX_NUM_JA3)
      ja3.client.cipher[ja3.client.num_cipher++] = cipher;
    else {
      invalid_ja3 = 1;
#ifdef DEBUG_TLS
      printf("Client TLS Invalid num ciphers %u\n", ja3.client.num_cipher);
#endif
    }
    
    /* Browser detection heuristics based on cipher suites */
    switch(cipher) {
      /* Safari cipher detection */
      case 0xC02B: /* TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 */
      case 0xC02C: /* TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 */
      case 0xC02F: /* TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 */
      case 0xC030: /* TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 */
      case 0xCCA9: /* TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 */
      case 0xCCA8: /* TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256 */
        safari_ciphers++;
        break;
        
      /* Chrome cipher detection */
      case 0x1301: /* TLS_AES_128_GCM_SHA256 */
      case 0x1302: /* TLS_AES_256_GCM_SHA384 */
      case 0x1303: /* TLS_CHACHA20_POLY1305_SHA256 */
        chrome_ciphers++;
        break;
        
      /* Non-Safari indicator */
      case 0x1305: /* TLS_CHACHA20_POLY1305_SHA256 specific implementation */
        this_is_not_safari = 1;
        looks_like_safari_on_big_sur = 1;
        break;
    }
  }
}