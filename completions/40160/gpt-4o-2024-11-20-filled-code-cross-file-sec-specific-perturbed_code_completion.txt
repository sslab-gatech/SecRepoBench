for (i = 0; i < cipher_length; i += 2) {
		u_int16_t cipher_id = ntohs(*((u_int16_t *)&packet->payload[cipher_offset + i]));

		// Skip GREASE values (RFC 8701)
		if ((cipher_id & 0x0F0F) == 0x0A0A) {
			continue;
		}

		// Add cipher to the JA3 client cipher list
		if (ja3.client.num_cipher < MAX_NUM_JA3) {
			ja3.client.cipher[ja3.client.num_cipher++] = cipher_id;
		} else {
			invalid_ja3 = 1;
#ifdef DEBUG_TLS
			printf("Client TLS Invalid num cipher %u\n", ja3.client.num_cipher);
#endif
			break;
		}

		// Heuristic checks for Safari and Chrome ciphers
		switch (cipher_id) {
			case 0xC02C: // TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
			case 0xC030: // TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
			case 0x009D: // TLS_RSA_WITH_AES_256_GCM_SHA384
			case 0xC02B: // TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
			case 0xC02F: // TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
			case 0x009C: // TLS_RSA_WITH_AES_128_GCM_SHA256
			case 0xC024: // TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384
			case 0xC028: // TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384
			case 0x006B: // TLS_DHE_RSA_WITH_AES_256_CBC_SHA256
			case 0xC023: // TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256
			case 0xC027: // TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256
			case 0x0067: // TLS_DHE_RSA_WITH_AES_128_CBC_SHA256
				safari_ciphers++;
				break;

			case 0x1301: // TLS_AES_128_GCM_SHA256
			case 0x1302: // TLS_AES_256_GCM_SHA384
			case 0x1303: // TLS_CHACHA20_POLY1305_SHA256
			case 0xC02B: // TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
			case 0xC02F: // TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
			case 0x009C: // TLS_RSA_WITH_AES_128_GCM_SHA256
			case 0xC02C: // TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
			case 0xC030: // TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
			case 0x009D: // TLS_RSA_WITH_AES_256_GCM_SHA384
			case 0xC013: // TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA
			case 0xC014: // TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA
			case 0x003C: // TLS_RSA_WITH_AES_128_CBC_SHA256
			case 0x003D: // TLS_RSA_WITH_AES_256_CBC_SHA256
				chrome_ciphers++;
				break;

			default:
				this_is_not_safari = 1;
				break;
		}

		// Check for Safari on Big Sur heuristic
		if (cipher_id == 0x1301 || cipher_id == 0x1302 || cipher_id == 0x1303) {
			looks_like_safari_on_big_sur = 1;
		}
	}