for(i=0; i<cipher_length && cipher_offset+i+1 < packet->payload_packet_len; i+=2) {
  u_int16_t cipher_id = ntohs(*((u_int16_t*)&packet->payload[cipher_offset+i]));

  if((cipher_id != 0) && (packet->payload[cipher_offset+i] != packet->payload[cipher_offset+i+1])) {
    /* Skip GREASE */
    if(ja3.client.num_cipher < MAX_NUM_JA3) {
      ja3.client.cipher[ja3.client.num_cipher++] = cipher_id;
    } else {
      invalid_ja3 = 1;
      break;
    }

    if(cipher_id == 0x1303) safari_ciphers++;
    else if(cipher_id == 0xc02b) chrome_ciphers++;
    else if(cipher_id == 0x1301 || cipher_id == 0x1302) {
      safari_ciphers++;
      looks_like_safari_on_big_sur = 1;
    } else if(cipher_id == 0xc02c || cipher_id == 0xcca9 || cipher_id == 0x1304) {
      chrome_ciphers++;
    } else {
      this_is_not_safari = 1;
    }
  }
}