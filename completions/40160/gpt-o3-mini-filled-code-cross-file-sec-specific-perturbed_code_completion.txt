for (u_int16_t i = 0; i < cipher_length; i += 2) {
    /* Ensure we don't read beyond the buffer */
    if ((cipher_offset + i + 1) >= packet->payload_packet_len)
        break;
    u_int16_t cipher_suite = ntohs(*(u_int16_t *)&packet->payload[cipher_offset + i]);
    /* Skip GREASE values: GREASE cipher suites typically have identical high and low bytes */
    if ((cipher_suite & 0xff) == (cipher_suite >> 8))
        continue;
    /* Add the cipher suite to the client's JA3 list, if space permits */
    if (ja3.client.num_cipher < MAX_NUM_JA3)
        ja3.client.cipher[ja3.client.num_cipher++] = cipher_suite;
    else
        invalid_ja3 = 1;
    /* Heuristic counts:
       For example, assume that Safari typically uses cipher suites 0xc02b and 0xc02f,
       while Chrome might use 0xcca8 or 0xcca9.
       Also, mark if a cipher does not match the expected Safari suites.
       (These constants are illustrative; adjust them as needed.) */
    if (cipher_suite == 0xc02b || cipher_suite == 0xc02f) {
        safari_ciphers++;
    } else {
        this_is_not_safari = 1;
    }
    if (cipher_suite == 0xcca8 || cipher_suite == 0xcca9) {
        chrome_ciphers++;
    }
    /* Example: flag a cipher that might indicate Safari on Big Sur */
    if (cipher_suite == 0xc0a8) {
        looks_like_safari_on_big_sur = 1;
    }
}