for (i = 0; i < cipher_length; i += 2) {
    u_int16_t cipher_suite = ntohs(*((u_int16_t*)&packet->payload[cipher_offset + i]));

    // Skip GREASE cipher suites
    if ((cipher_suite & 0xFF00) == 0x00FF || (cipher_suite & 0x00FF) == 0xFF00) {
        continue;
    }

    if (ja3.client.num_cipher < MAX_NUM_JA3) {
        ja3.client.cipher[ja3.client.num_cipher++] = cipher_suite;
    }

    // Count Safari specific ciphers
    if (is_safari_cipher(cipher_suite)) {
        safari_ciphers++;
    } else {
        this_is_not_safari = 1; // Found a non-Safari cipher
    }

    // Count Chrome specific ciphers
    if (is_chrome_cipher(cipher_suite)) {
        chrome_ciphers++;
    }

    // Check for Safari on Big Sur heuristics
    if (is_safari_on_big_sur(cipher_suite)) {
        looks_like_safari_on_big_sur = 1;
    }
}