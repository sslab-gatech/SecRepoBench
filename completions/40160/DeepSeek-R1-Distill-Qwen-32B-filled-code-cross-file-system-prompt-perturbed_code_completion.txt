for(i=0; i < cipher_length; i += 2) {
  u_int16_t cipher = ntohs(*((u_int16_t*)&packet->payload[cipher_offset + i]));

  /* Skip GREASE */
  if((cipher & 0xFF) == (cipher >> 8)) {
    continue;
  }

  if(ja3.client.num_cipher < MAX_NUM_JA3)
    ja3.client.cipher[ja3.client.num_cipher++] = cipher;
  else {
    invalid_ja3 = 1;
#ifdef DEBUG_TLS
    printf("Client TLS Invalid num cipher %u\n", ja3.client.num_cipher);
#endif
  }

  /* Safari cipher check */
  if(cipher == 0x003C) {
    looks_like_safari_on_big_sur = 1;
  }

  if(cipher == 0x0033) {
    this_is_not_safari = 1;
  }

  if(cipher == 0x003C || cipher == 0x003D || cipher == 0x003E || cipher == 0x003F ||
     cipher == 0x0040 || cipher == 0x0041 || cipher == 0x0042 || cipher == 0x0043 ||
     cipher == 0x0044 || cipher == 0x0045 || cipher == 0x0046 || cipher == 0x0047) {
    safari_ciphers++;
  } else {
    this_is_not_safari = 1;
  }

  if(cipher == 0x0033 || cipher == 0x0034 || cipher == 0x0035 || cipher == 0x0036 ||
     cipher == 0x0037 || cipher == 0x0038 || cipher == 0x0039 || cipher == 0x003A ||
     cipher == 0x003B || cipher == 0x003C || cipher == 0x003D || cipher == 0x003E ||
     cipher == 0x003F) {
    chrome_ciphers++;
  }
}