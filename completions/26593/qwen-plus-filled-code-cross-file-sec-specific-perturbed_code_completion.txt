int val = 0;
if (timestr == NULL) {
    return val;
}

size_t len = strlen(timestr);
if (len == 0) {
    return val;
}

char *endptr;
long num = strtol(timestr, &endptr, 10);
if (endptr == timestr || *endptr == '\0') {
    return val;
}

char unit = toupper(*endptr);
switch(unit) {
    case 'D':
        val = num * 24 * 60 * 60;
        break;
    case 'H':
        val = num * 60 * 60;
        break;
    case 'M':
        val = num * 60;
        break;
    default:
        val = 0;
}