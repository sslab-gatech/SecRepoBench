int val = 0;
    size_t len;
    int factor = 1;

    if (!timestr) {
        return 0;
    }

    /* Safely check length and handle empty strings */
    len = strnlen(timestr, 256);
    if (len == 0 || len == 256) {
        return 0;
    }

    /* Determine if there's a unit suffix (day/hour/minute) */
    char unit = timestr[len - 1];
    if (unit == 'd' || unit == 'D' ||
        unit == 'h' || unit == 'H' ||
        unit == 'm' || unit == 'M') {

        /* Copy the numeric part safely */
        char buf[256];
        if (len - 1 >= sizeof(buf)) {
            return 0;
        }
        memcpy(buf, timestr, len - 1);
        buf[len - 1] = '\0';

        /* Determine multiplication factor */
        if (unit == 'd' || unit == 'D') {
            factor = 86400;
        }
        else if (unit == 'h' || unit == 'H') {
            factor = 3600;
        }
        else if (unit == 'm' || unit == 'M') {
            factor = 60;
        }

        val = atoi(buf) * factor;
    }
    else {
        /* Default to seconds if no recognized suffix is found */
        val = atoi(timestr);
    }