int val = 0;
    long multiplier = 1;
    char *p;
    size_t len = strlen(timestr);

    if (!timestr) {
        return -1;
    }

    p = (char *) timestr + len - 1;
    if (*p == 'd' || *p == 'D') {
        multiplier = 86400;
        *p = '\0';
    }
    else if (*p == 'h' || *p == 'H') {
        multiplier = 3600;
        *p = '\0';
    }
    else if (*p == 'm' || *p == 'M') {
        multiplier = 60;
        *p = '\0';
    }

    errno = 0;
    val = strtol(timestr, NULL, 10);
    if (errno == ERANGE) {
        return -1;
    }
    val *= multiplier;