int val = 0;
if (!timestr) {
    return 0;
}

size_t len = strlen(timestr);
if (len == 0) {
    return 0;
}

char *endptr = NULL;
long num = strtol(timestr, &endptr, 10);
if (endptr == timestr) {
    /* No valid conversion */
    return 0;
}

int multiplier = 1;
if (endptr < timestr + len) {
    /* Expecting a unit specifier as the last character */
    if (endptr != timestr + len - 1) {
        /* Extra invalid characters found */
        return 0;
    }
    char unit = *endptr;
    switch(tolower((unsigned char) unit)) {
        case 'd':
            multiplier = 86400; /* 24 * 3600 */
            break;
        case 'h':
            multiplier = 3600;
            break;
        case 'm':
            multiplier = 60;
            break;
        default:
            /* Unrecognized unit, return 0 */
            return 0;
    }
}

/* Check for potential overflow */
if (num < 0 || num > INT_MAX / multiplier) {
    return 0;
}

val = (int)(num * multiplier);