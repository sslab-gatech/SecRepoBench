int val;
    int len;
    char unit;
    char tmp[64];

    if (!timestr) {
        return -1;
    }

    len = strlen(timestr);
    if (len == 0) {
        return -1;
    }

    unit = timestr[len - 1];

    /* copy timestr to a buffer so we can remove any suffix if needed */
    if (len >= sizeof(tmp)) {
        return -1;
    }
    strcpy(tmp, timestr);

    if (unit == 'd' || unit == 'D' ||
        unit == 'h' || unit == 'H' ||
        unit == 'm' || unit == 'M') {
        tmp[len - 1] = '\0';  /* remove suffix */
        val = atoi(tmp);

        switch (unit) {
        case 'm':
        case 'M':
            val *= 60;
            break;
        case 'h':
        case 'H':
            val *= 3600;
            break;
        case 'd':
        case 'D':
            val *= 86400;
            break;
        }
    }
    else {
        val = atoi(timestr);
    }