int val = 0;
    int len;
    int i;
    char last;
    char *p;
    char tmp[64];

    if (!timestr) {
        return 0;
    }

    len = strlen(timestr);
    if (len == 0) {
        return 0;
    }

    /* Check last character */
    last = timestr[len - 1];

    if (!isdigit(last)) {
        /* Copy the string (without the last char) to a temporal buffer */
        if (len - 1 > sizeof(tmp) - 1) {
            return -1;
        }
        strncpy(tmp, timestr, len - 1);
        tmp[len - 1] = '\0';

        /* Convert to integer */
        val = atoi(tmp);

        /* Validate the value */
        if (val <= 0) {
            return 0;
        }

        /* Resolve the value based on the suffix */
        if (last == 's' || last == 'S') {
            /* seconds, do nothing */
        }
        else if (last == 'm' || last == 'M') {
            val *= 60;
        }
        else if (last == 'h' || last == 'H') {
            val *= (60 * 60);
        }
        else if (last == 'd' || last == 'D') {
            val *= (60 * 60 * 24);
        }
    }
    else {
        val = atoi(timestr);
    }