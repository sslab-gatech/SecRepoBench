int val;
    int len;
    char unit;
    char tmp[64];

    if (!timestr) {
        return -1;
    }

    len = strlen(timestr);
    if (len == 0) {
        return -1;
    }

    /* Check if the last character is a unit specifier */
    unit = timestr[len - 1];
    if (isalpha(unit)) {
        /* If there's only one character and it's alpha, no numeric part */
        if (len == 1) {
            return -1;
        }
        /* Copy everything except the last character */
        memcpy(tmp, timestr, len - 1);
        tmp[len - 1] = '\0';
    }
    else {
        /* No explicit unit, assume seconds */
        memcpy(tmp, timestr, len);
        tmp[len] = '\0';
        unit = 's';
    }

    val = atoi(tmp);
    if (val < 0) {
        return -1;
    }

    /* Multiply by the corresponding factor based on unit */
    switch (toupper(unit)) {
    case 'D':  /* days */
        val *= 86400;
        break;
    case 'H':  /* hours */
        val *= 3600;
        break;
    case 'M':  /* minutes */
        val *= 60;
        break;
    case 'S':  /* seconds (or no unit) */
        break;
    default:
        /* Unrecognized unit */
        return -1;
    }