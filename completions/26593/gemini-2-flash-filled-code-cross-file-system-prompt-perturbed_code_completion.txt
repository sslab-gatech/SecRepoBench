int val = 0;
    int len;
    int i;
    int digit;

    if (!timestr) {
        return 0;
    }

    len = strlen(timestr);

    for (i = 0; i < len; i++) {
        if (isdigit(timestr[i])) {
            digit = timestr[i] - '0';
            val = val * 10 + digit;
        }
        else {
            break;
        }
    }

    if (i < len) {
        switch (timestr[i]) {
        case 'D':
        case 'd':
            val *= 86400;
            break;
        case 'H':
        case 'h':
            val *= 3600;
            break;
        case 'M':
        case 'm':
            val *= 60;
            break;
        default:
            break;
        }
    }