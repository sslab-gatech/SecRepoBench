int val = 0;
    int len = strlen(timestr);

    if (len == 0) {
        return -1;
    }

    char unit = timestr[len - 1];
    if (isdigit(unit)) {
        val = atoi(timestr);
    }
    else {
        char *endptr;
        val = strtol(timestr, &endptr, 10);
        if (endptr == timestr || *endptr == '\0') {
            return -1;
        }

        switch (toupper(unit)) {
        case 'D':
            val *= 86400; // 24 * 60 * 60
            break;
        case 'H':
            val *= 3600; // 60 * 60
            break;
        case 'M':
            val *= 60;
            break;
        default:
            return -1;
        }
    }