int64_t val;
    char *p;
    char *end;
    char unit;

    val = strtol(timestr, &end, 10);
    if ((errno == ERANGE && (val == LONG_MAX || val == LONG_MIN)) ||
        (errno != 0 && val == 0)) {
        flb_errno();
        return -1;
    }
    if (end == timestr) {
        return -1;
    }

    if (*end != '\0') {
        unit = toupper(*end);
        if (unit == 'D') {
            val *= 86400;
        }
        else if (unit == 'H') {
            val *= 3600;
        }
        else if (unit == 'M') {
            val *= 60;
        }
        else {
            return -1;
        }
    }