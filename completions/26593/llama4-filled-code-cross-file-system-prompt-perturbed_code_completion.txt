int val = 0;
    char *str = (char *) timestr;
    char unit = '\0';

    /* Get number */
    while (*str && isdigit(*str)) {
        val = val * 10 + (*str - '0');
        str++;
    }

    /* Get unit */
    if (*str) {
        unit = *str;
    }

    switch (unit) {
    case 'D':
    case 'd':
        val *= 24 * 60 * 60;
        break;
    case 'H':
    case 'h':
        val *= 60 * 60;
        break;
    case 'M':
    case 'm':
        val *= 60;
        break;
    }

    return val;