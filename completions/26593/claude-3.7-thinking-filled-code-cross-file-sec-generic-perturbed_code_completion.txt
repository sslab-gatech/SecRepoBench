int val = 0;
char *endptr;

if (!timestr) {
    return 0;
}

/* Convert string to integer */
errno = 0;
long long num = strtoll(timestr, &endptr, 10);

/* Check for conversion errors */
if (errno == ERANGE || endptr == timestr) {
    return 0;
}

/* Check if there's a time unit suffix */
if (*endptr) {
    if (*endptr == 'D' || *endptr == 'd') {
        /* Check for overflow when converting days to seconds */
        if (num > INT_MAX / 86400) {
            return INT_MAX;
        }
        num *= 86400;  /* days to seconds: 60 * 60 * 24 */
    }
    else if (*endptr == 'H' || *endptr == 'h') {
        /* Check for overflow when converting hours to seconds */
        if (num > INT_MAX / 3600) {
            return INT_MAX;
        }
        num *= 3600;   /* hours to seconds: 60 * 60 */
    }
    else if (*endptr == 'M' || *endptr == 'm') {
        /* Check for overflow when converting minutes to seconds */
        if (num > INT_MAX / 60) {
            return INT_MAX;
        }
        num *= 60;     /* minutes to seconds: 60 */
    }
}

/* Final check for overflow before returning */
if (num > INT_MAX) {
    return INT_MAX;
}

val = (int)num;