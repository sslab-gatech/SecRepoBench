int val = 0;
    int len = strlen(timestr);
    char unit;

    if (len == 0) {
        return -1;
    }

    unit = timestr[len - 1];

    if (isdigit(unit)) {
        val = atoi(timestr);
    }
    else {
        val = atoi(timestr);
        switch (unit) {
            case 'D':
            case 'd':
                val *= 86400;
                break;
            case 'H':
            case 'h':
                val *= 3600;
                break;
            case 'M':
            case 'm':
                val *= 60;
                break;
            default:
                return -1;
        }
    }

    if (val < 0) {
        return -1;
    }