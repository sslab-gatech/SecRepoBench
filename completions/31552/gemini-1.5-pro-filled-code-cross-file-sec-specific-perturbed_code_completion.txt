ctbytes += 1;
if (token == BLOSC_RUN_NONZERO_TOKEN) {
  if (srcsize < (signed)sizeof(uint8_t)) {
    // Not enough input to read run length */
    return BLOSC2_ERROR_READ_BUFFER;
  }
  srcsize -= sizeof(uint8_t);
  uint8_t run_length = src[0];
  src += 1;
  ctbytes += 1;
  if (run_length > neblock) {
    return BLOSC2_ERROR_DATA;
  }
  if (srcsize < (signed)sizeof(uint8_t)) {
    // Not enough input to read run value */
    return BLOSC2_ERROR_READ_BUFFER;
  }
  srcsize -= sizeof(uint8_t);
  uint8_t run_value = src[0];
  src += 1;
  ctbytes += 1;
  memset(comp_buffer, run_value, run_length);
  nbytes = neblock;
  cbytes = 0;
}