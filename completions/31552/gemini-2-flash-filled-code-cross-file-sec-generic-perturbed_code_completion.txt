if (token == BLOSC_NONZERORUN) {
        // Check if the run length exceeds the maximum allowed value
        if (srcsize < (signed)sizeof(uint8_t)) {
          /* Not enough input to read run length */
          return BLOSC2_ERROR_READ_BUFFER;
        }
        srcsize -= sizeof(uint8_t);
        uint8_t run_length = src[0];
        src += 1;
        if (run_length > neblock) {
          // Run length exceeds block size, which is an error
          return BLOSC2_ERROR_DATA;
        }
        if (srcsize < (signed)sizeof(uint8_t)) {
          /* Not enough input to read byte value */
          return BLOSC2_ERROR_READ_BUFFER;
        }
        srcsize -= sizeof(uint8_t);
        uint8_t byte_value = src[0];
        src += 1;
        memset(comp_buffer, byte_value, run_length);
        nbytes = (int32_t)neblock;
        cbytes = 0;
        src -= 1;
        src -= 1;
        srcsize += sizeof(uint8_t);
        srcsize += sizeof(uint8_t);
      }
      else {
        // Unknown token
        return BLOSC2_ERROR_DATA;
      }
      break;