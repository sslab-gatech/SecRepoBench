if (token & 0x80u) {
        // Run of non-zero bytes
        int32_t runlen = (token & 0x7Fu) + 1;
        if (runlen > neblock) {
          return BLOSC2_ERROR_DATA;
        }
        uint8_t val = src[0];
        src += 1;
        memset(comp_buffer, val, (unsigned int)runlen);
        nbytes = runlen;
        ctbytes -= 1; // Correct the compressed bytes count
      } else {
        // Run of zero bytes
        int32_t runlen = (token & 0x7Fu) + 1;
        if (runlen > neblock) {
          return BLOSC2_ERROR_DATA;
        }
        memset(comp_buffer, 0, (unsigned int)runlen);
        nbytes = runlen;
        ctbytes -= 1; // Correct the compressed bytes count
      }
      cbytes = 0; // Ensure cbytes is zeroed