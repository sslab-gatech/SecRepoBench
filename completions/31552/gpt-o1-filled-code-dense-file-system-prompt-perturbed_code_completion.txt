ctbytes += 1;  /* We used 1 extra byte to store the token */
      /* The run byte is the absolute value of cbytes */
      uint8_t run_byte = (uint8_t)(-cbytes);

      /* In this implementation, the only valid token for non-zero runs is 0x1 */
      if (token != 0x1) {
        return BLOSC2_ERROR_DATA;
      }

      /* Fill the destination buffer with the repeated byte */
      memset(comp_buffer, run_byte, (unsigned int)neblock);

      /* The uncompressed size for this stream is the entire block */
      nbytes = neblock;

      /* This stream is fully described by the token; no more compressed bytes */
      cbytes = 0;