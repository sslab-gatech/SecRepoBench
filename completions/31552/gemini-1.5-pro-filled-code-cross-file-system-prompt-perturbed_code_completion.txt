ctbytes += (signed)sizeof(uint8_t);
if (token == BLOSC_RUN_NONZERO_TOKEN) {
  if (srcsize < (signed)sizeof(uint8_t)) {
    // Not enough input to read run length */
    return BLOSC2_ERROR_READ_BUFFER;
  }
  srcsize -= sizeof(uint8_t);
  uint8_t run_len = src[0];
  src += 1;
  ctbytes += (signed)sizeof(uint8_t);
  if (run_len > neblock) {
    return BLOSC2_ERROR_DATA;
  }
  if (srcsize < (signed)sizeof(uint8_t)) {
    // Not enough input to read run value */
    return BLOSC2_ERROR_READ_BUFFER;
  }
  srcsize -= sizeof(uint8_t);
  uint8_t run_val = src[0];
  src += 1;
  ctbytes += (signed)sizeof(uint8_t);
  memset(comp_buffer, run_val, run_len);
  nbytes = neblock;
  cbytes = 0;
}