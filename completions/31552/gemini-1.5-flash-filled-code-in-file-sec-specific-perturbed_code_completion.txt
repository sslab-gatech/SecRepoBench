int32_t value = -sw32_(src);  // read the value in two's complement
      int32_t runlen = token & 0x7f; // get the run length from the token
      if (runlen > neblock) {
        return BLOSC2_ERROR_DATA; // Run length exceeds block size
      }
      for (int k = 0; k < runlen; k++) {
        memcpy(comp_buffer + k * typesize, &value, typesize);
      }
      nbytes = runlen * typesize;
      cbytes = 0; // compressed bytes for this stream is zeroed