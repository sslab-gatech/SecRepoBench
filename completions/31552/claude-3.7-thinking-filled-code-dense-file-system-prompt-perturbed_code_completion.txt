ctbytes += sizeof(uint8_t);  // Increment the total compressed bytes counter by 1 for the token
if (token == 0x1) {
  // A run of non-zero bytes (run-length encoding)
  // The value is stored in the two's complement of cbytes
  uint8_t value = (uint8_t)(-cbytes);
  // Fill the destination buffer with the value
  memset(comp_buffer, value, (unsigned int)neblock);
  nbytes = neblock;
} else {
  BLOSC_TRACE_ERROR("Unsupported token %d.", token);
  return BLOSC2_ERROR_DATA;
}
cbytes = 0;  // This encoding takes no additional bytes