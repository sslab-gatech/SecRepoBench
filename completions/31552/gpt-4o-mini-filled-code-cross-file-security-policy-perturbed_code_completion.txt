if (token >= 0 && token <= MAX_RUN_LENGTH) {
        uint8_t value = src[0]; // The value to fill
        src += 1; // Move past the value
        srcsize -= 1; // Decrease the available size
        nbytes = token; // Set the number of decompressed bytes to the run length
        if (nbytes > neblock) {
          // Ensure we do not write past the buffer
          nbytes = neblock;
        }
        memset(comp_buffer, value, (unsigned int)nbytes); // Fill the buffer with the value
      } else {
        // Invalid token value
        return BLOSC2_ERROR_DATA;
      }