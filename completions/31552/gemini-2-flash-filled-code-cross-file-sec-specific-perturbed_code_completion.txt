if (token == BLOSC_NONZERORUN) {
        // The token indicates a run of non-zero bytes
        if (srcsize < (signed)sizeof(uint8_t)) {
          // Not enough input to read the byte value for the run
          return BLOSC2_ERROR_READ_BUFFER;
        }
        srcsize -= sizeof(uint8_t);
        uint8_t byte_value = src[0];
        src += 1;
        // Increment the total compressed bytes counter by 1 for the byte value
        ctbytes += 1;

        // Fill the destination buffer with the byte value
        memset(comp_buffer, byte_value, (unsigned int)neblock);
        nbytes = neblock;
      }
      else {
        // Unknown token
        return BLOSC2_ERROR_INVALID_PARAM;
      }
      // Ensure the compressed bytes for this stream is zeroed, as it is fully encoded in the token
      cbytes = 0;