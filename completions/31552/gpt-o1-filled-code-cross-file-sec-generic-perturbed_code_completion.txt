{
  // We read one extra byte as the token, so account for that
  ctbytes += 1;

  // Check if the run length is within safe limits (neblock must not overflow)
  // If this needs additional checks, add them here
  memset(comp_buffer, token, (size_t)neblock);

  // We have decompressed the entire block using the token as the repeat value
  nbytes = neblock;

  // Fully encoded by the token; no more compressed bytes to consume in this stream
  cbytes = 0;
}