if (token == 0) {
        // Run of 0's
        memset(comp_buffer, 0, (unsigned int)neblock);
        nbytes = neblock;
        ctbytes = 0;
      } else if (token <= 127) {
        // Run of non-zero bytes
        uint8_t value = src[0];
        src += 1;
        srcsize -= 1;
        ctbytes += 1;
        if (token > neblock) {
          return BLOSC2_ERROR_DATA;
        }
        memset(comp_buffer, value, (unsigned int)token);
        nbytes = token;
        ctbytes = 0;
      } else {
        // Some other encoding
        return BLOSC2_ERROR_DATA;
      }