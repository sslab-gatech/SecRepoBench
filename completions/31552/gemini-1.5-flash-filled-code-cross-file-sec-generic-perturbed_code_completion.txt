if (token == 0) {
        // A run of 0's
        memset(comp_buffer, 0, (unsigned int)neblock);
        nbytes = neblock;
      } else if (token <= 127) {
        // A run of non-zero bytes
        uint8_t value = src[0];
        src += 1;
        ctbytes += 1;
        if (token > neblock) {
          return BLOSC2_ERROR_DATA;
        }
        memset(comp_buffer, value, (unsigned int)token);
        nbytes = token;
      } else {
        // A run of non-zero bytes
        uint16_t value = sw16_(src);
        src += 2;
        ctbytes += 2;
        uint16_t len = (uint16_t)(token - 128);
        if (len > neblock) {
          return BLOSC2_ERROR_DATA;
        }
        memset(comp_buffer, value, (unsigned int)len);
        nbytes = len;
      }
      cbytes = 0;