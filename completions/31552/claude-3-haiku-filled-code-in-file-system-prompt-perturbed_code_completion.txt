if (cbytes == -1) {
  // A run of non-zero bytes
  int32_t runlen = abs(cbytes);
  if (runlen > BLOSC2_MAX_RUNLEN) {
    BLOSC_TRACE_ERROR("Run length (%d) exceeds maximum allowed (%d).",
                      runlen, BLOSC2_MAX_RUNLEN);
    return BLOSC2_ERROR_DATA;
  }
  uint8_t token = src[0];
  src += 1;
  if (token & 0x80) {
    // Run of non-zero bytes
    memset(dest, token & 0x7F, neblock);
  }
  else {
    // Run of zero bytes
    memset(dest, 0, neblock);
  }
  nbytes = neblock;
}
else {
  // Not a run
  nbytes = neblock;
}