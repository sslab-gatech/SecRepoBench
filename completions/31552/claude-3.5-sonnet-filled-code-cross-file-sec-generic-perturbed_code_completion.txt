ctbytes += 1;
if (cbytes == -1) {
  // Run of non-zero bytes
  if (srcsize < (signed)sizeof(uint8_t)) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  srcsize -= sizeof(uint8_t);
  uint8_t value = src[0];
  src += 1;
  ctbytes += 1;
  if (neblock > INT32_MAX) {
    return BLOSC2_ERROR_WRITE_BUFFER;
  }
  memset(comp_buffer, value, (unsigned int)neblock);
  nbytes = neblock;
} else {
  // Invalid compressed bytes value
  return BLOSC2_ERROR_DATA;
}
cbytes = 0;