if (token == 0) {
        // A run of 0's (already handled by cbytes == 0 case)
        return BLOSC2_ERROR_DATA;
      }
      else if (token == 0xff) {
        // A run of 0xff's
        memset(comp_buffer, 0xff, (unsigned int)neblock);
        nbytes = neblock;
      }
      else {
        // A run of a single byte value
        memset(comp_buffer, token, (unsigned int)neblock);
        nbytes = neblock;
      }
      cbytes = 0;