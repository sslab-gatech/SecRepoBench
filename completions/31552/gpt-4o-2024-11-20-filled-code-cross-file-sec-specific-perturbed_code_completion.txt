// Validate the token and determine the run length
      int run_length = token & 0x7F; // Extract the lower 7 bits for the run length
      if (run_length == 0 || run_length > neblock) {
        // Invalid run length
        return BLOSC2_ERROR_DATA;
      }

      // Determine the byte value for the run
      uint8_t run_value = (token & 0x80) ? 0xFF : 0x00; // MSB indicates the run value

      // Fill the destination buffer with the run value
      memset(comp_buffer, run_value, (unsigned int)run_length);

      // Set decompressed bytes to the run length
      nbytes = run_length;

      // Ensure the compressed bytes for this stream is zeroed, as it is fully encoded in the token
      cbytes = 0;