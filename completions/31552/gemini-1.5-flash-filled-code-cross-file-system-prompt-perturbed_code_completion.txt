int runlen = token & 0x7f;
      uint8_t val = (token >> 7) & 0x01;
      if (runlen > neblock) {
        BLOSC_TRACE_ERROR("Run length exceeds block size.");
        return BLOSC2_ERROR_DATA;
      }
      memset(comp_buffer, val, (unsigned int)runlen);
      nbytes = runlen;
      cbytes = 0;