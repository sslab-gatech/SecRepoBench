if (token & 0x1) {
  // Run-length encoding of non-zero bytes
  int32_t run_len = ((token >> 1) & 0x7F) + 4;  // Length of the run (at least 4)
  int32_t value = -cbytes;                      // The repeated byte value

  if (run_len > neblock) {
    // Run length exceeds block size
    return BLOSC2_ERROR_DATA;
  }

  memset(comp_buffer, value, (unsigned int)run_len);
  nbytes = run_len;
  cbytes = 0;  // Compressed size is zero for runs
} else {
  // Other special encoding (not yet implemented)
  return BLOSC2_ERROR_DATA;
}