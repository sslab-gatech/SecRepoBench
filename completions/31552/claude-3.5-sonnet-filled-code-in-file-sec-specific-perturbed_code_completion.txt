token = src[0];
src += 1;
ctbytes += 1;
if (token == 0) {
  // A run of zeros
  memset(comp_buffer, 0, (unsigned int)neblock);
  nbytes = neblock;
} else {
  // A run of non-zero bytes
  if (token > neblock) {
    // Run length exceeds block size
    return BLOSC2_ERROR_DATA;
  }
  uint8_t value = src[0];
  src += 1;
  ctbytes += 1;
  memset(comp_buffer, value, token);
  nbytes = token;
}