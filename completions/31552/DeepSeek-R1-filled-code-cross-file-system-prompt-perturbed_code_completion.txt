if (token == 0) {
    BLOSC_TRACE_ERROR("Invalid zero token for non-zero run encoding");
    return BLOSC2_ERROR_DATA;
}
if (neblock > BLOSC_MAX_RUNLEN) {
    BLOSC_TRACE_ERROR("Run length %d exceeds maximum allowed %d", neblock, BLOSC_MAX_RUNLEN);
    return BLOSC2_ERROR_RUN_LENGTH;
}
memset(comp_buffer, token, neblock);
nbytes = neblock;
cbytes = 0;  // Actual compressed data is represented by the token alone