if ((token & 0x80) == 0x80) {
        // Run of non-zero bytes
        int32_t run_length = (int32_t)(token & 0x7F);
        if (run_length > neblock) {
          return BLOSC2_ERROR_DATA;
        }
        memset(comp_buffer, token, (unsigned int)run_length);
        nbytes = run_length;
      } else {
        // Invalid token
        return BLOSC2_ERROR_DATA;
      }
      ctbytes = 0;
      cbytes = 0;
    }