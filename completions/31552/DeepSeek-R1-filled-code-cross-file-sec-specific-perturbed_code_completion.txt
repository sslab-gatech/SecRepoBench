if (token == 0) {
        BLOSC_TRACE_ERROR("Invalid token value for non-zero run.");
        return BLOSC2_ERROR_DATA;
      }
      if (neblock > (bsize - ntbytes)) {
        return BLOSC2_ERROR_WRITE_BUFFER;
      }
      memset(comp_buffer, token, neblock);
      nbytes = neblock;
      cbytes = 0;