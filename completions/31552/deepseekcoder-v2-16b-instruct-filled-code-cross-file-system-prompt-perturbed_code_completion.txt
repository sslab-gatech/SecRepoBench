// If the token indicates a run of non-zero bytes
    if (token == 0xFF) {
      // A run of 0xFF's
      memset(comp_buffer, 0, (unsigned int)neblock);
      nbytes = neblock;
    } else {
      // A run of non-zero bytes
      uint8_t byte_value = token;
      int run_length = 1;

      // Check if the run length does not exceed a specific limit
      while (run_length < neblock && src[run_length] == token) {
        run_length++;
      }

      // Fill the destination buffer with the byte value for the run
      memset(comp_buffer, byte_value, (unsigned int)run_length);
      nbytes = run_length;
    }
    // Ensure the compressed bytes for this stream is zeroed, as it is fully encoded in the token
    cbytes = 0;