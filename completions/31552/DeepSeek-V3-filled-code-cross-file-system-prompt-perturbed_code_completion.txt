if (token == 0) {
        // A run of 0's (already handled above)
        memset(comp_buffer, 0, (unsigned int)neblock);
        nbytes = neblock;
      }
      else {
        // A run of non-zero bytes
        if (token > neblock) {
          // Token value exceeds block size
          return BLOSC2_ERROR_DATA;
        }
        memset(comp_buffer, token, (unsigned int)neblock);
        nbytes = neblock;
      }
      cbytes = 0;