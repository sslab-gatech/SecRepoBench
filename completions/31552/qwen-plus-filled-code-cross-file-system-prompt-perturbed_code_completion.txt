if (token >= BLOSC_MIN_RUN_LENGTH && token <= BLOSC_MAX_RUN_LENGTH) {
    int run_length = token;
    uint8_t byte_value = src[0];
    if (srcsize < (signed)sizeof(uint8_t)) {
        return BLOSC2_ERROR_READ_BUFFER;
    }
    src += sizeof(uint8_t);
    srcsize -= sizeof(uint8_t);
    ctbytes += sizeof(uint8_t);

    if (run_length > neblock) {
        return BLOSC2_ERROR_DATA;
    }
    memset(comp_buffer, byte_value, run_length);
    nbytes = run_length;
} else {
    // Invalid token encountered
    return BLOSC2_ERROR_DATA;
}
cbytes = 0; // Fully encoded in the token