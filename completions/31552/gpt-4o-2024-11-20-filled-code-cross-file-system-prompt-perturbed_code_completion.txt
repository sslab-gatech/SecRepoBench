if (token & 0x80) {
        // Token indicates a run of non-zero bytes
        int run_length = token & 0x7F; // Extract the run length from the token
        if (run_length > neblock) {
          // Run length exceeds the block size, invalid data
          return BLOSC2_ERROR_DATA;
        }
        uint8_t run_value = src[0]; // The next byte indicates the value for the run
        src += 1;
        srcsize -= 1;
        memset(comp_buffer, run_value, run_length);
        nbytes = run_length;
      } else {
        // Token indicates a run of zero bytes
        int run_length = token; // Token directly represents the run length
        if (run_length > neblock) {
          // Run length exceeds the block size, invalid data
          return BLOSC2_ERROR_DATA;
        }
        memset(comp_buffer, 0, run_length);
        nbytes = run_length;
      }
      cbytes = 0; // Fully encoded in the token, no additional compressed bytes