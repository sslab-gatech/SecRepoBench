// Token encoding: high 7 bits = run length, low 1 bit = value (0 or 1)
      int run_length = token >> 1;
      uint8_t value = token & 0x1;
      if (run_length > neblock) {
        // Run length exceeds block size
        return BLOSC2_ERROR_DATA;
      }
      memset(comp_buffer, value ? 0xFF : 0x00, (unsigned int)run_length);
      nbytes = run_length;
      cbytes = 0;  // fully encoded in token