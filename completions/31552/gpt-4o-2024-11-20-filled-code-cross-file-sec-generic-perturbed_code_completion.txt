// Validate the token and determine the run length
      int run_length = token & 0x7F; // Extract the lower 7 bits for the run length
      if (run_length > neblock) {
        // Run length exceeds the block size, invalid data
        return BLOSC2_ERROR_DATA;
      }

      // Determine the byte value for the run
      uint8_t run_value = (token & 0x80) ? 0xFF : 0x00; // MSB indicates the value (0xFF or 0x00)

      // Fill the destination buffer with the run value
      memset(comp_buffer, run_value, (unsigned int)run_length);

      // Set decompressed bytes to the run length
      nbytes = run_length;

      // Ensure the compressed bytes for this stream is zeroed
      cbytes = 0;