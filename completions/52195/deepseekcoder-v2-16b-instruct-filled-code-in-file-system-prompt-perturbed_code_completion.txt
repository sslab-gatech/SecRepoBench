if (cpdwordmax > 0 && wordnum >= cpdwordmax)
    return NULL;

  if (numsyllable > cpdmaxsyllable)
    return NULL;

  if (compound_words) {
    oldnumsyllable = numsyllable;
    oldwordnum = wordnum;
    oldcmin = cmin;
    oldcmax = cmax;
    oldlen = len;
    soldi = 0;
  }

  if (compound_words && (compound_words[wordnum])) {
    rv_first = compound_words[wordnum];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum + 1])) {
    rv_first = compound_words[wordnum + 1];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum - 1])) {
    rv_first = compound_words[wordnum - 1];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum - 2])) {
    rv_first = compound_words[wordnum - 2];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum + 2])) {
    rv_first = compound_words[wordnum + 2];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum - 3])) {
    rv_first = compound_words[wordnum - 3];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum + 3])) {
    rv_first = compound_words[wordnum + 3];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum - 4])) {
    rv_first = compound_words[wordnum - 4];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum + 4])) {
    rv_first = compound_words[wordnum + 4];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum - 5])) {
    rv_first = compound_words[wordnum - 5];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum + 5])) {
    rv_first = compound_words[wordnum + 5];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum - 6])) {
    rv_first = compound_words[wordnum - 6];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum + 6])) {
    rv_first = compound_words[wordnum + 6];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum - 7])) {
    rv_first = compound_words[wordnum - 7];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum + 7])) {
    rv_first = compound_words[wordnum + 7];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum - 8])) {
    rv_first = compound_words[wordnum - 8];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum + 8])) {
    rv_first = compound_words[wordnum + 8];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum - 9])) {
    rv_first = compound_words[wordnum - 9];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum + 9])) {
    rv_first = compound_words[wordnum + 9];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum - 10])) {
    rv_first = compound_words[wordnum - 10];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum + 10])) {
    rv_first = compound_words[wordnum + 10];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum - 11])) {
    rv_first = compound_words[wordnum - 11];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum + 11])) {
    rv_first = compound_words[wordnum + 11];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum - 12])) {
    rv_first = compound_words[wordnum - 12];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum + 12])) {
    rv_first = compound_words[wordnum + 12];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum - 13])) {
    rv_first = compound_words[wordnum - 13];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum + 13])) {
    rv_first = compound_words[wordnum + 13];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum - 14])) {
    rv_first = compound_words[wordnum - 14];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum + 14])) {
    rv_first = compound_words[wordnum + 14];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum - 15])) {
    rv_first = compound_words[wordnum - 15];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_first = NULL;
  }

  if (compound_words && (compound_words[wordnum + 15])) {
    rv_first = compound_words[wordnum + 15];
    if (rv_first->astr) {
      if (TESTAFF(rv_first->astr, forbiddenword, rv_first->alen))
        return NULL;
    }
  } else {
    rv_