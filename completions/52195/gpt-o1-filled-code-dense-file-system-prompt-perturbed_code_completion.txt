if (checkcompoundtriple && i > 1 &&
    st[i] == st[i - 1] &&
    st[i - 1] == st[i - 2]) {
  // Found a triple-letter pattern, so remove the middle letter
  st.erase(i - 1, 1);
  --len;
  --i;

  // Re-check the shortened substring
  rv = lookup(st.c_str(), i);
  while (rv) {
    // Iterate over homonyms to find one with valid compound flags
    while (rv && (
             (needaffix && TESTAFF(rv->astr, needaffix, rv->alen)) ||
             !((compoundflag && !compound_words &&
                 TESTAFF(rv->astr, compoundflag, rv->alen)) ||
               (compoundend && !compound_words &&
                 TESTAFF(rv->astr, compoundend, rv->alen)))))
    {
      rv = rv->next_homonym;
    }
    if (rv) {
      // Found an acceptable homonym
      break;
    }
  }

  // Mark that we've resolved the triple-letter pattern this pass
  checkedstriple = 1;
  break;
}