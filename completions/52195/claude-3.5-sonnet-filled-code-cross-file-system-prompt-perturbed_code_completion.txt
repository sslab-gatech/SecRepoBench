if (striple && !checkedstriple && i > 2 && 
    (word[i-1] == word[i-2] || word[i-1] == word[i])) {
  checkedstriple = 1;
  i--;
}

rv = lookup(st.c_str() + i, st.size() - i);

while (rv) {
  if (((compoundflag && TESTAFF(rv->astr, compoundflag, rv->alen)) ||
       (compoundend && TESTAFF(rv->astr, compoundend, rv->alen))) &&
      (!onlycpdrule || (compoundflag && !compound_words &&
                        TESTAFF(rv->astr, compoundflag, rv->alen))) &&
      ((!checkcompounddup || (rv != rv_first)))) {
    break;
  }
  rv = rv->next_homonym;
}