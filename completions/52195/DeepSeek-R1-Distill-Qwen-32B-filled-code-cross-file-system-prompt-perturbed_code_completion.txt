rv = lookup(st.c_str() + i, st.size() - i);
while (rv) {
    if ((rv->astr) &&
        ((compoundflag && TESTAFF(rv->astr, compoundflag, rv->alen)) ||
         (compoundbegin && TESTAFF(rv->astr, compoundbegin, rv->alen)) ||
         (compoundmiddle && TESTAFF(rv->astr, compoundmiddle, rv->alen)) ||
         ((langnum == LANG_hu) && hu_mov_rule &&
          (TESTAFF(rv->astr, 'F', rv->alen) ||
           TESTAFF(rv->astr, 'G', rv->alen) ||
           TESTAFF(rv->astr, 'H', rv->alen)))) &&
        (!compoundforbidflag || hu_mov_rule || 
         !TESTAFF(rv->astr, compoundforbidflag, rv->alen))) {
        break;
    }
    rv = rv->next_homonym;
}