if (!word || word[index] == '\0' || word[index+1] == '\0') {
    return 0;
  }

  // Check if either character is a hyphen
  if (word[index] == '-' || word[index+1] == '-') {
    return 0;
  }

  if (utf8) {
    // UTF-8 mode
    w_char u[MAXWORDLEN];
    int len = u8_u16(u, MAXWORDLEN, word + index);
    if (len <= 0) return 0;
    
    // First character is uppercase?
    if (u[0].l == toupper_utf(u[0].l))
      return 1;
    
    // Get the second character
    const char* p = word + index;
    int i = 0;
    while (i < len && *p) {
      p++;
      i++;
    }
    
    len = u8_u16(u, MAXWORDLEN, p);
    if (len <= 0) return 0;
    
    // Second character is uppercase?
    if (u[0].l == toupper_utf(u[0].l))
      return 1;
  } else {
    // ASCII mode
    if (toupper((unsigned char)word[index]) == (unsigned char)word[index] ||
        toupper((unsigned char)word[index+1]) == (unsigned char)word[index+1])
      return 1;
  }