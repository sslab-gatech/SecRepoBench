const char* p = word;
const char* q = word + index;
int len = 0;
while (*p) {
  if ((*p & 0xC0) == 0xC0) {
    len = ((*p & 0x1F) == 0x1F)? 6 : ((*p & 0x0F) == 0x0F)? 5 : ((*p & 0x07) == 0x07)? 4 : ((*p & 0x03) == 0x03)? 3 : 2;
  } else {
    len = 1;
  }
  if (p + len > q) {
    break;
  }
  p += len;
}
if (p == q) {
  w_char w1 = u8_u16(p - len);
  w_char w2 = u8_u16(q);
  if (w1!= towupper(w1) && w2!= towupper(w2) && w1!= '-' && w2!= '-') {
    return 1;
  }
}
return 0;