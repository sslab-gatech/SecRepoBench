const char* p = word + index;
const char* p2 = p + 1;

if (!*p || !*p2)
    return 0;

if (*p == '-' || *p2 == '-')
    return 0;

unsigned short c1 = (unsigned char)*p;
unsigned short c2 = (unsigned char)*p2;

if (utf8) {
    if (c1 >= 0x80 && c2 >= 0x80) {
        w_char u1[1], u2[1];
        u8_u16(u1, 1, p);
        u8_u16(u2, 1, p2);
        c1 = u1[0].h << 8 | u1[0].l;
        c2 = u2[0].h << 8 | u2[0].l;
    }
}

if ((c1 == csconv[c1].cupper) || (c2 == csconv[c2].cupper))
    return 1;