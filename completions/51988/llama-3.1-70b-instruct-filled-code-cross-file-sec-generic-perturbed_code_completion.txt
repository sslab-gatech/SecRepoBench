// Convert the word to a Unicode representation if it's in UTF-8 format
std::wstring word_unicode;
if (is_utf8) {
  utf8_to_unicode(word, word_unicode);
}

// Get the two characters at the specified positions
wchar_t char1, char2;
if (is_utf8) {
  char1 = word_unicode[index];
  char2 = word_unicode[index + 1];
} else {
  char1 = word[index];
  char2 = word[index + 1];
}

// Check if either character is a hyphen
if (char1 == L'-' || char2 == L'-') {
  return 0;
}

// Check if either character remains unchanged when converted to uppercase
if (towlower(char1) == char1 || towlower(char2) == char2) {
  return 0;
}

// If all conditions are met, return 1 to indicate a match is found
return 1;