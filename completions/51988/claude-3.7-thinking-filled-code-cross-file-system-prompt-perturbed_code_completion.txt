if (index < 1 || !word[index-1] || !word[index])
    return 0;
  
  if (utf8) {
    w_char u[2];
    int nc = u8_u16(u, 2, word + index - 1, 2);
    if (nc < 2)
      return 0;
    
    // Check if either character is already uppercase
    w_char u1_upper = u[0];
    w_char u2_upper = u[1];
    uppercase_utf(u1_upper, 1);
    uppercase_utf(u2_upper, 1);
    
    bool is_upper1 = (u[0].h == u1_upper.h && u[0].l == u1_upper.l);
    bool is_upper2 = (u[1].h == u2_upper.h && u[1].l == u2_upper.l);
    
    // Ensure neither character is a hyphen
    if ((is_upper1 || is_upper2) && 
        (u[0].h != (unsigned short)'-') && (u[1].h != (unsigned short)'-'))
      return 1;
  } else {
    unsigned char c1 = (unsigned char)word[index - 1];
    unsigned char c2 = (unsigned char)word[index];
    
    // Check if either character is already uppercase
    // and ensure neither is a hyphen
    if ((c1 == toupper(c1) || c2 == toupper(c2)) && 
        (c1 != '-') && (c2 != '-'))
      return 1;
  }