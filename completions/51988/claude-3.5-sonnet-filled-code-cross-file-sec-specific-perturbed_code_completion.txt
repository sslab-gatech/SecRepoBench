if (index < 0 || static_cast<size_t>(index + 1) >= strlen(word)) {
    return 0;
  }

  unsigned char c1 = word[index];
  unsigned char c2 = word[index + 1];

  if (c1 == '-' || c2 == '-') {
    return 0;
  }

  if (utf8) {
    w_char u1, u2;
    u8_u16(&u1, 1, word + index);
    u8_u16(&u2, 1, word + index + 1);

    if (u1.l == u_toupper(u1.l) || u2.l == u_toupper(u2.l)) {
      return 1;
    }
  } else {
    if (csconv[c1].cupper == c1 || csconv[c2].cupper == c2) {
      return 1;
    }
  }