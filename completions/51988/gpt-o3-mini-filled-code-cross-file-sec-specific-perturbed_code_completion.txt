{
  if (!word)
    return 0;
  if (utf8) {
    // Convert first multibyte character to wide character
    wchar_t wc1, wc2;
    int len1 = mbtowc(&wc1, word + index, MB_CUR_MAX);
    if (len1 <= 0)
      return 0;
    // Convert second multibyte character to wide character
    int len2 = mbtowc(&wc2, word + index + len1, MB_CUR_MAX);
    if (len2 <= 0)
      return 0;
    // Ensure neither character is a hyphen
    if (wc1 == L'-' || wc2 == L'-')
      return 0;
    // Check if either character is already uppercase
    if (wc1 == towupper(wc1) || wc2 == towupper(wc2))
      return 1;
  }
  else {
    // Non-UTF8: treat the characters as single-byte
    char c1 = word[index];
    char c2 = word[index + 1];
    if (c1 == '-' || c2 == '-')
      return 0;
    if (c1 == toupper(static_cast<unsigned char>(c1)) ||
        c2 == toupper(static_cast<unsigned char>(c2)))
      return 1;
  }
}