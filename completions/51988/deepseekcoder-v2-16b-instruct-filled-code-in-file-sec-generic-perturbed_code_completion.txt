if (onlycpdrule) {
        oldcmin = cmin;
        oldcmax = cmax;
        oldlen = len;
        oldwords = words;
      }

      if (onlycpdrule && (words[wordnum]->astr)) {
        if (TESTAFF(words[wordnum]->astr, compoundbegin, words[wordnum]->alen)) {
          if (compoundbegin != FLAG_NULL) {
            if (!TESTAFF(words[wordnum]->astr, compoundbegin, words[wordnum]->alen))
              continue;
          }
          if (compoundbegin == FLAG_ALL) {
            if (TESTAFF(words[wordnum]->astr, compoundbegin, words[wordnum]->alen))
              continue;
          }
        }
      }

      if (onlycpdrule && (words[wordnum]->astr)) {
        if (TESTAFF(words[wordnum]->astr, compoundmiddle, words[wordnum]->alen)) {
          if (compoundmiddle != FLAG_NULL) {
            if (!TESTAFF(words[wordnum]->astr, compoundmiddle, words[wordnum]->alen))
              continue;
          }
          if (compoundmiddle == FLAG_ALL) {
            if (TESTAFF(words[wordnum]->astr, compoundmiddle, words[wordnum]->alen))
              continue;
          }
        }
      }

      if (onlycpdrule && (words[wordnum]->astr)) {
        if (TESTAFF(words[wordnum]->astr, compoundend, words[wordnum]->alen)) {
          if (compoundend != FLAG_NULL) {
            if (!TESTAFF(words[wordnum]->astr, compoundend, words[wordnum]->alen))
              continue;
          }
          if (compoundend == FLAG_ALL) {
            if (TESTAFF(words[wordnum]->astr, compoundend, words[wordnum]->alen))
              continue;
          }
        }
      }

      if (onlycpdrule && (words[wordnum]->astr)) {
        if (TESTAFF(words[wordnum]->astr, compoundroot, words[wordnum]->alen)) {
          if (compoundroot != FLAG_NULL) {
            if (!TESTAFF(words[wordnum]->astr, compoundroot, words[wordnum]->alen))
              continue;
          }
          if (compoundroot == FLAG_ALL) {
            if (TESTAFF(words[wordnum]->astr, compoundroot, words[wordnum]->alen))
              continue;
          }
        }
      }

      if (onlycpdrule && (words[wordnum]->astr)) {
        if (TESTAFF(words[wordnum]->astr, compoundpermitflag, words[wordnum]->alen)) {
          if (compoundpermitflag != FLAG_NULL) {
            if (!TESTAFF(words[wordnum]->astr, compoundpermitflag, words[wordnum]->alen))
              continue;
          }
          if (compoundpermitflag == FLAG_ALL) {
            if (TESTAFF(words[wordnum]->astr, compoundpermitflag, words[wordnum]->alen))
              continue;
          }
        }
      }

      if (onlycpdrule && (words[wordnum]->astr)) {
        if (TESTAFF(words[wordnum]->astr, compoundforbidflag, words[wordnum]->alen)) {
          if (compoundforbidflag != FLAG_NULL) {
            if (!TESTAFF(words[wordnum]->astr, compoundforbidflag, words[wordnum]->alen))
              continue;
          }
          if (compoundforbidflag == FLAG_ALL) {
            if (TESTAFF(words[wordnum]->astr, compoundforbidflag, words[wordnum]->alen))
              continue;
          }
        }
      }

      if (onlycpdrule && (words[wordnum]->astr)) {
        if (TESTAFF(words[wordnum]->astr, forbiddenword, words[wordnum]->alen)) {
          if (forbiddenword != FLAG_NULL) {
            if (!TESTAFF(words[wordnum]->astr, forbiddenword, words[wordnum]->alen))
              continue;
          }
          if (forbiddenword == FLAG_ALL) {
            if (TESTAFF(words[wordnum]->astr, forbiddenword, words[wordnum]->alen))
              continue;
          }
        }
      }

      if (onlycpdrule && (words[wordnum]->astr)) {
        if (TESTAFF(words[wordnum]->astr, nosuggest, words[wordnum]->alen)) {
          if (nosuggest != FLAG_NULL) {
            if (!TESTAFF(words[wordnum]->astr, nosuggest, words[wordnum]->alen))
              continue;
          }
          if (nosuggest == FLAG_ALL) {
            if (TESTAFF(words[wordnum]->astr, nosuggest, words[wordnum]->alen))
              continue;
          }
        }
      }

      if (onlycpdrule && (words[wordnum]->astr)) {
        if (TESTAFF(words[wordnum]->astr, nongramsuggest, words[wordnum]->alen)) {
          if (nongramsuggest != FLAG_NULL) {
            if (!TESTAFF(words[wordnum]->astr, nongramsuggest, words[wordnum]->alen))
              continue;
          }
          if (nongramsuggest == FLAG_ALL) {
            if (TESTAFF(words[wordnum]->astr, nongramsuggest, words[wordnum]->alen))
              continue;
          }
        }
      }

      if (onlycpdrule && (words[wordnum]->astr)) {
        if (TESTAFF(words[wordnum]->astr, needaffix, words[wordnum]->alen)) {
          if (needaffix != FLAG_NULL) {
            if (!TESTAFF(words[wordnum]->astr, needaffix, words[wordnum]->alen))
              continue;
          }
          if (needaffix == FLAG_ALL) {
            if (TESTAFF(words[wordnum]->astr, needaffix, words[wordnum]->alen))
              continue;
          }
        }
      }

      if (onlycpdrule && (words[wordnum]->astr)) {
        if (TESTAFF(words[wordnum]->astr, onlyincompound, words[wordnum]->alen)) {
          if (onlyincompound != FLAG_NULL) {
            if (!TESTAFF(words[wordnum]->astr, onlyincompound, words[wordnum]->alen))
              continue;
          }
          if (onlyincompound == FLAG_ALL) {
            if (TESTAFF(words[wordnum]->astr, onlyincompound, words[wordnum]->alen))
              continue;
          }
        }
      }

      if (onlycpdrule && (words[wordnum]->astr)) {
        if (TESTAFF(words[wordnum]->astr, lemma_present, words[wordnum]->alen)) {
          if (lemma_present != FLAG_NULL) {
            if (!TESTAFF(words[wordnum]->astr, lemma_present, words[wordnum]->alen))
              continue;
          }
          if (lemma_present == FLAG_ALL) {
            if (TESTAFF(words[wordnum]->astr, lemma_present, words[wordnum]->alen))
              continue;
          }
        }
      }

      if (onlycpdrule && (words[wordnum]->astr)) {
        if (TESTAFF(words[wordnum]->astr, circumfix, words[wordnum]->alen)) {
          if (circumfix != FLAG_NULL) {
            if (!TESTAFF(words[wordnum]->astr, circumfix, words[wordnum]->alen))
              continue;
          }
          if (circumfix == FLAG_ALL) {
            if (TESTAFF(words[wordnum]->astr, circumfix, words[wordnum]->alen))
              continue;
          }
        }
      }

      if (onlycpdrule && (words[wordnum]->astr)) {
        if (TESTAFF(words[wordnum]->astr, substandard, words[wordnum]->alen)) {
          if (substandard != FLAG_NULL) {
            if (!TESTAFF(words[wordnum]->astr, substandard, words[wordnum]->alen))
              continue;
          }
          if (substandard == FLAG_ALL) {
            if (TESTAFF(words[wordnum]->astr, substandard, words[wordnum]->alen))
              continue;
          }
        }
      }

      if (onlycpdrule && (words[wordnum]->astr)) {
        if (TESTAFF(words[wordnum]->astr, keepcase, words[wordnum]->alen)) {
          if (keepcase != FLAG_NULL) {
            if (!TESTAFF(words[wordnum]->astr, keepcase, words[wordnum]->alen))
              continue;
          }
          if (keepcase == FLAG_ALL) {
            if (TESTAFF(words[wordnum]->astr, keepcase, words[wordnum]->alen))
              continue;
          }
        }
      }

      if (onlycpdrule && (words[wordnum]->astr)) {
        if (TESTAFF(words[wordnum]->astr, forceucase, words[wordnum]->alen)) {
          if (forceucase != FLAG_NULL) {
            if (!TESTAFF(words[wordnum]->astr, forceucase, words[wordnum]->alen))
              continue;
          }
          if (forceucase == FLAG_ALL) {
            if (TESTAFF(words[wordnum]->astr, forceucase, words[wordnum]->alen))
              continue;
          }
        }
      }

      if (onlycpdrule && (words[wordnum]->astr)) {
        if (TESTAFF(words[wordnum]->astr, warn, words[wordnum]->alen)) {
          if (warn != FLAG_NULL) {
            if (!TESTAFF(words[wordnum]->astr, warn, words[wordnum]->alen))
              continue;
          }
          if (warn == FLAG_ALL) {
            if (TESTAFF(words[wordnum]->astr, warn, words[wordnum]->alen))
              continue;
          }
        }
      }

      if (onlycpdrule && (words[wordnum]->astr)) {
        if (TESTAFF(words[wordnum]->astr, forbidwarn, words[wordnum]->alen)) {
          if (forbidwarn != FLAG_NULL) {
            if (!TESTAFF(words[wordnum]->astr, forbidwarn, words[wordnum]->alen))
              continue;
          }
          if (forbidwarn == FLAG_ALL) {
            if (TESTAFF(words[wordnum]->astr, forbidwarn, words[wordnum]->alen))
              continue;
          }
        }
      }

      if (onlycpdrule && (words[wordnum]->astr)) {
        if (TESTAFF(words[wordnum]->astr, checksharps, words[wordnum]->alen)) {
          if (checksharps != FLAG_NULL) {
            if (!TESTAFF(words[wordnum]->astr, checksharps, words[wordnum]->alen))
              continue;
          }
          if (checksharps == FLAG_ALL) {
            if (TESTAFF(words[wordnum]->astr, checksharps, words[wordnum]->alen))
              continue;
          }
        }
      }

      if (onlycpdrule && (words[wordnum]->astr)) {
        if (TESTAFF(words[wordnum]->astr, substandard, words[wordnum]->alen)) {
          if (substandard != FLAG_NULL) {
            if (!TESTAFF(words[wordnum]->astr, substandard, words[wordnum]->alen))
              continue;
          }
          if (substandard == FLAG_ALL) {
            if (TESTAFF(words[wordnum]->astr, substandard, words[wordnum]->alen))
              continue;
          }
        }
      }

      if (onlycpdrule && (words[wordnum]->astr)) {
        if (TESTAFF(words[wordnum]->astr, fullstrip, words[wordnum]->alen)) {
          if (fullstrip != FLAG_NULL) {
            if (!TESTAFF(words[wordnum]->astr, fullstrip, words[wordnum]->alen))
              continue;
          }
          if (fullstrip == FLAG_ALL) {
            if (TESTAFF(words[wordnum]->astr, fullstrip, words[wordnum]->alen))
              continue;
          }
        }
      }

      if (onlycpdrule && (words[word