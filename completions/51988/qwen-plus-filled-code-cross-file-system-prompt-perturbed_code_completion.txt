if (word[index] != '-' && word[index + 1] != '-') {
    unsigned char c1 = static_cast<unsigned char>(word[index]);
    unsigned char c2 = static_cast<unsigned char>(word[index + 1]);
    if ((utf8 && toupper_utf8(&c1) == c1) || (!utf8 && toupper(c1) == c1)) {
        if ((utf8 && toupper_utf8(&c2) == c2) || (!utf8 && toupper(c2) == c2)) {
            return 1;
        }
    }
}