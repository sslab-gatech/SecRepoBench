if (word[index] == '-' || word[index + 1] == '-')
    return 0;

if (utf8) {
    std::vector<w_char> w;
    u8_u16(w, word);
    if (index + 1 >= w.size())
        return 0;
    w_char c1 = w[index];
    w_char c2 = w[index + 1];
    if (c1 == c2)
        return 0;
    w_char u1 = upper(c1);
    w_char u2 = upper(c2);
    if (u1 != c1 || u2 != c2)
        return 1;
} else {
    if (toupper(word[index]) == word[index] || toupper(word[index + 1]) == word[index + 1])
        return 1;
}