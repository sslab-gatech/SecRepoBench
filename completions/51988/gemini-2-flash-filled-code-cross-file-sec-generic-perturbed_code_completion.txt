if (!word || index < 0) {
    return 0;
  }

  size_t len = strlen(word);
  if (index >= (int)len - 1) {
    return 0;
  }

  char char1 = word[index];
  char char2 = word[index + 1];

  if (char1 == '-' || char2 == '-') {
    return 0;
  }

  unsigned char uchar1 = static_cast<unsigned char>(char1);
  unsigned char uchar2 = static_cast<unsigned char>(char2);

  if (affix_utf8) {
    std::vector<unsigned int> ucs4_word;
    if (!u8_to_ucs4(ucs4_word, word)) {
      return 0; // Invalid UTF-8
    }
    if (index >= (int)ucs4_word.size() - 1) {
      return 0;
    }
    if (ucs4_word[index] > 0xFFFF || ucs4_word[index + 1] > 0xFFFF) {
      return 0;
    }
    char1 = (char)ucs4_word[index];
    char2 = (char)ucs4_word[index + 1];
  }

  char upper_char1 = toupper(char1);
  char upper_char2 = toupper(char2);

  if (char1 == upper_char1 || char2 == upper_char2) {
    return 0;
  }

  return 1;