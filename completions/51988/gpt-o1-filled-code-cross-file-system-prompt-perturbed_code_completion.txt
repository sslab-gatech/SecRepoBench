int len = (int)strlen(word);
if (index < 0 || index + 1 >= len) return 0;
if (word[index] == '-' || word[index + 1] == '-') return 0;

if (utf8) {
    std::string s1(1, word[index]);
    std::string s2(1, word[index + 1]);
    std::vector<w_char> w1, w2;
    std::vector<w_char> w1u, w2u;

    u8_u16(w1, s1);
    u8_u16(w2, s2);
    w1u = w1;
    w2u = w2;

    to_upper_case(w1u);
    to_upper_case(w2u);

    if (w1 == w1u || w2 == w2u) return 1;
} else {
    unsigned char c1 = (unsigned char)word[index];
    unsigned char c2 = (unsigned char)word[index + 1];
    if (c1 == (unsigned char)toupper(c1) || c2 == (unsigned char)toupper(c2)) {
        return 1;
    }
}