if (!word || index < 0) {
    return 0;
  }

  size_t len = strlen(word);
  if (index >= (int)len - 1) {
    return 0;
  }

  char char1 = word[index];
  char char2 = word[index + 1];

  if (char1 == '-' || char2 == '-') {
    return 0;
  }

  if (utf8) {
    // UTF-8 processing
    std::vector<w_char> word_utf;
    u8_u16(word_utf, word);

    if (index >= (int)word_utf.size() - 1) {
      return 0;
    }

    w_char w_char1 = word_utf[index];
    w_char w_char2 = word_utf[index + 1];

    w_char upper_char1 = towupper(w_char1);
    w_char upper_char2 = towupper(w_char2);

    if (upper_char1 == w_char1 || upper_char2 == w_char2) {
      return 0;
    }

    if (w_char1 != '-' && w_char2 != '-') {
      return 1;
    }
  } else {
    // Non-UTF-8 processing
    if (isupper(char1) || isupper(char2)) {
      return 0;
    }

    if (toupper(char1) == char1 || toupper(char2) == char2) {
      return 0;
    }

    return 1;
  }