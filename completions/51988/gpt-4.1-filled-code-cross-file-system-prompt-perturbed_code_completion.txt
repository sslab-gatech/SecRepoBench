if (!word || index < 1) return 0;

if (utf8) {
    std::vector<w_char> wchars;
    u8_u16(wchars, word);
    if ((size_t)index >= wchars.size()) return 0;
    w_char c1 = wchars[index - 1];
    w_char c2 = wchars[index];
    if (c1 == '-' || c2 == '-') return 0;
    w_char up1 = towupper(c1);
    w_char up2 = towupper(c2);
    if (c1 == up1 || c2 == up2) return 1;
} else {
    char c1 = word[index - 1];
    char c2 = word[index];
    if (c1 == '-' || c2 == '-') return 0;
    if (c1 == toupper((unsigned char)c1) || c2 == toupper((unsigned char)c2)) return 1;
}