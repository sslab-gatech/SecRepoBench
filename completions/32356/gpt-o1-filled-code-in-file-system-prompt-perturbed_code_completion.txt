/* Ensure the parsed box is not NULL */
		if (!a) {
			return GF_OK;
		}

		/* Check if the parsed box fits in the container size */
		if (container->size < a->size) {
			if (!skip_logs) {
				GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER,
					("[iso file] Sub-box (type %s) size %"LLU" exceeds remaining container size %"LLU"\n",
					gf_4cc_to_str(a->type), a->size, container->size));
			}
			/* Reset container size so we don't continue reading */
			container->size = 0;
		}
		else {
			/* Adjust the container's remaining size */
			container->size -= a->size;
		}

		/* Validate that this box type is allowed in the parent container */
		if (!gf_box_valid_in_parent(a, gf_4cc_to_str(container->type))) {
			if (!skip_logs) {
				GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER,
					("[iso file] Box type %s is not valid inside container type %s\n",
					gf_4cc_to_str(a->type), gf_4cc_to_str(container->type)));
			}
			/* Discard the invalid box and move on */
			gf_isom_box_del(a);
			a = NULL;
			continue;
		}