// <MASK>
if (!a) {
	// no more boxes to process
	return GF_OK;
}

/* check if the parent box size is smaller than the newly parsed box */
if (container->size < a->size) {
	if (!skip_logs) {
		gf_isom_log(GF_LOG_WARNING, "Parsed box (type 0x%08x) size (%u) exceeds container space (%u).",
		            a->type, (u32)a->size, (u32)container->size);
	}
	container->size = 0;
} else {
	container->size -= a->size;
}

/* validate if box is allowed in this parent container */
if (container->registry && container->registry->validate_box_type) {
	GF_Err val_err = container->registry->validate_box_type(container->type, a->type);
	if ((val_err != GF_OK) && !skip_logs) {
		gf_isom_log(GF_LOG_WARNING, "Box type 0x%08x is invalid in container type 0x%08x.",
		            a->type, container->type);
	}
}
// </MASK>