if (!a) return GF_OK;

if (container->size < a->size) {
    if (!skip_logs) {
        GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER, ("[isom] not enough bytes in box %s: %d left, reading %d\n", gf_4cc_to_str(container->type), container->size, a->size));
    }
    container->size = 0;
} else {
    container->size -= a->size;
}

// Validate if the container box type is compatible with the parsed box
if (parent_type && container->registry && container->registry->valid_in) {
    Bool valid = GF_FALSE;
    u32 i = 0;
    while (container->registry->valid_in[i]) {
        if (container->registry->valid_in[i] == a->type) {
            valid = GF_TRUE;
            break;
        }
        i++;
    }
    if (!valid && !skip_logs) {
        GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER, ("[isom] Box \"%s\" is invalid in container \"%s\"\n", gf_4cc_to_str(a->type), gf_4cc_to_str(container->type)));
    }
}