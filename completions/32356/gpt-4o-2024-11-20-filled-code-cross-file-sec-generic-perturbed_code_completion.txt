if (!a) {
            return GF_OK;
        }

        if (container->size < a->size) {
            if (!skip_logs) {
                gf_log(GF_LOG_WARNING, GF_LOG_CONTAINER, 
                       "Parsed box size exceeds parent box size. Parent type: 0x%08x, Parsed box type: 0x%08x\n", 
                       parent_type, a->type);
            }
            container->size = 0; // Reset parent box size to prevent further parsing
            gf_isom_box_del(a);
            return GF_OK;
        }

        container->size -= a->size;

        if (!gf_isom_is_box_valid_in_container(parent_type, a->type)) {
            if (!skip_logs) {
                gf_log(GF_LOG_WARNING, GF_LOG_CONTAINER, 
                       "Invalid box type 0x%08x in container type 0x%08x\n", 
                       a->type, parent_type);
            }
            gf_isom_box_del(a);
            return GF_OK;
        }