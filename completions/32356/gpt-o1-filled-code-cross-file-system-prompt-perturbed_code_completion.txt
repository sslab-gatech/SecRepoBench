if (!a) {
    return GF_OK;
}

if (container->size < a->size) {
    if (!skip_logs) {
        gf_log(GF_LOG_WARNING, "Parsed box is larger than the remaining container size\n");
    }
    container->size = 0;
} else {
    container->size -= a->size;
}

if (container->registry && container->registry->is_box_compatible && 
    !container->registry->is_box_compatible(parent_type, a->type)) {
    if (!skip_logs) {
        gf_log(GF_LOG_WARNING, "Box type 0x%08x is invalid in container type 0x%08x\n",
               a->type, parent_type);
    }
}