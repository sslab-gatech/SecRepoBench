if (!a) return GF_OK;

// Check if parsed box size exceeds remaining container size
if (a->size > container->size) {
    if (!skip_logs) {
        GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER, 
               ("[iso file] Box \"%s\" larger than container box (size %u vs %u)\n", 
                gf_4cc_to_str(a->type), a->size, container->size));
    }
    // Reset container size as it's been exceeded
    container->size = 0;
} else {
    // Adjust container size
    container->size -= a->size;
}

// Validate if the container box type is compatible with the parsed box
Bool box_valid = GF_TRUE;
if (container->registry && container->registry->child_boxes) {
    box_valid = GF_FALSE;
    u32 i = 0;
    while (container->registry->child_boxes[i].box_type) {
        if (container->registry->child_boxes[i].box_type == a->type) {
            box_valid = GF_TRUE;
            break;
        }
        i++;
    }
}

// Log a warning if the parsed box is invalid in the current container
if (!box_valid && !skip_logs) {
    GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER, 
           ("[iso file] Box \"%s\" not a valid box in container \"%s\"\n", 
            gf_4cc_to_str(a->type), gf_4cc_to_str(container->type)));
}