char *current,
    *next;

current=p;
next=p;
while (*next == ' ')
  next++;
for ( ; *next != '\0'; next++)
{
  *current++=*next;
  if (*next == ' ')
    while (*(next+1) == ' ')
      next++;
}
if ((current > p) && (*(current-1) == ' '))
  current--;
*current='\0';