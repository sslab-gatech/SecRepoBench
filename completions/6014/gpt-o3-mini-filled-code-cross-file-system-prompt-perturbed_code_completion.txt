{
  char *read = p, *write = p;
  while (*read)
  {
    /* Skip any leading spaces for each word */
    while (*read && isspace((unsigned char)*read))
      read++;
    /* Copy the word */
    while (*read && !isspace((unsigned char)*read))
      *write++ = *read++;
    /* Insert a single space if there are more words */
    if (*read)
      *write++ = ' ';
  }
  /* Remove trailing space if it exists */
  if (write > p && *(write - 1) == ' ')
    write--;
  *write = '\0';
}