{
  char *src = p, *dst = p;
  /* Skip any initial spaces */
  while (*src && isspace((unsigned char)*src))
    src++;
  while (*src)
  {
    if (isspace((unsigned char)*src))
    {
      *dst++ = ' ';
      while (*src && isspace((unsigned char)*src))
        src++;
    }
    else
      *dst++ = *src++;
  }
  /* Remove trailing space if present */
  if (dst > p && *(dst - 1) == ' ')
    dst--;
  *dst = '\0';
}