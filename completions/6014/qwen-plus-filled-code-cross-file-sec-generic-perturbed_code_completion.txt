{
  register char
    *r,
    *s;

  r = xml;
  s = xml;

  while (*r != '\0')
  {
    if (!isspace((int) ((unsigned char) *r)))
    {
      if (r != s)
        *s = *r;
      s++;
    }
    else if (s > xml && !(isspace((int) ((unsigned char) *(s - 1)))))
    {
      *s = ' ';
      s++;
    }
    r++;
  }

  if (s > xml && isspace((int) ((unsigned char) *(s - 1))))
    *(s - 1) = '\0';
  else
    *s = '\0';
}