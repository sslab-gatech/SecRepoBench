char *src = p;
      char *dst = p;
      while (*src != '\0') {
        // Skip leading spaces
        while (*src == ' ') {
          src++;
        }
        // Copy non-space characters
        while (*src != '\0' && *src != ' ') {
          *dst++ = *src++;
        }
        // If we encounter a space, add a single space
        if (*src == ' ') {
          *dst++ = ' ';
          src++;
        }
      }
      // Remove trailing space if present
      if (dst > p && *(dst - 1) == ' ') {
        dst--;
      }
      *dst = '\0';