char
  *r;

register ssize_t
  x;

r=p;
for (x=0; *r != '\0'; r++)
{
  if (isspace((int) ((unsigned char) *r)) == 0)
    p[x++]=(*r);
  else
    {
      while (isspace((int) ((unsigned char) *(r+1))) != 0)
        r++;
      if (p[x-1] != ' ')
        p[x++]=' ';
    }
}
if ((x > 0) && (p[x-1] == ' '))
  x--;
p[x]='\0';