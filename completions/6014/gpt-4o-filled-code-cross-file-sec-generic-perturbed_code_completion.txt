char *start = p;
      char *end = p;
      int in_word = 0;

      while (*start != '\0') {
        if (!isspace((unsigned char)*start)) {
          if (in_word) {
            *end++ = *start;
          } else {
            if (end != p) {
              *end++ = ' ';
            }
            *end++ = *start;
            in_word = 1;
          }
        } else {
          in_word = 0;
        }
        start++;
      }
      *end = '\0';