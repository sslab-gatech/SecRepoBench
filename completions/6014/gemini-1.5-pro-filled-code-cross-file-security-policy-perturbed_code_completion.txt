p = xml;
      while (*p != '\0')
      {
        while (isspace((int) ((unsigned char) *p)) != 0)
          p++;
        q = p;
        while ((*p != '\0') && (isspace((int) ((unsigned char) *p)) == 0))
          p++;
        if (p != q)
        {
          (void) CopyMagickMemory(xml, q, p - q);
          xml += (p - q);
          if (*p != '\0')
            *xml++ = ' ';
        }
        if (*p == '\0')
          break; // Check for null terminator after inner while loop
        p++;
      }
      if ((xml > p) && (isspace((int) ((unsigned char) *(xml - 1))) != 0))
        xml--;
      *xml = '\0';