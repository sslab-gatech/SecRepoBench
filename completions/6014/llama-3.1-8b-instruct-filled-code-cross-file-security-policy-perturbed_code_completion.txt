if (state == '*')
  {
    /*
      Normalize spaces for non-CDATA attributes.
    */
    // Iterate over the normalized string to remove leading spaces from each word.
    // Use a character pointer to traverse through the string.
    // Use a loop to skip over and remove consecutive spaces.
    // Compact the string by shifting non-space characters to the left.
    // Continue this until the end of the string is reached.
    // If the last character is a space, terminate the string before the space.
    p=p+strspn(p,XMLWhitespace);
    while (*p!= '\0')
    {
      if (*p =='')
      {
        // Skip over consecutive spaces
        p++;
        while (*p =='')
          p++;
      }
      else
      {
        // Shift non-space characters to the left
        q=p;
        while (*q!= '\0')
        {
          *(q-1)=*q;
          q++;
        }
        // Terminate the string before the space
        if (*p =='')
          *(p-1)='\0';
        p++;
      }
    }
  }