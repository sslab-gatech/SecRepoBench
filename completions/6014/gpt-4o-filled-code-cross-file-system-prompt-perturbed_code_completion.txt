char *start = p;
      char *end = p;
      int in_space = 0;

      while (*start != '\0') {
        if (isspace((int) ((unsigned char) *start))) {
          if (!in_space) {
            *end++ = ' ';
            in_space = 1;
          }
        } else {
          *end++ = *start;
          in_space = 0;
        }
        start++;
      }
      if (end > p && isspace((int) ((unsigned char) *(end - 1))))
        end--;
      *end = '\0';