if (*expression == '(')
{
  const char
    *start;

  size_t
    paren_count;

  (*recursion_depth)++;
  if (*recursion_depth > FxMaxParenthesisDepth)
    {
      (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
        "UnableToParseExpression","`%s'",expression);
      FxResult(0.0);
    }
  expression++;
  start=expression;
  paren_count=1;
  while ((*expression != '\0') && (paren_count > 0))
  {
    if (*expression == '(')
      paren_count++;
    else if (*expression == ')')
      paren_count--;
    expression++;
  }
  if (paren_count != 0)
    {
      (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
        "UnableToParseExpression","`%s'",start);
      FxResult(0.0);
    }
  {
    size_t
      length = (size_t) (expression - 1 - start);

    if (length >= MagickPathExtent)
      length = MagickPathExtent - 1;
    (void) CopyMagickString(subexpression,start,length+1);
    alpha = FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,
      recursion_depth,beta,exception);
  }
  (*recursion_depth)--;
  FxResult(alpha);
}