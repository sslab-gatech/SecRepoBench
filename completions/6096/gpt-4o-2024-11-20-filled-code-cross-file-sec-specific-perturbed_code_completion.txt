if (*expression == '(')
  {
    const char *sub_start, *sub_end;
    size_t sub_length;

    (*recursion_depth)++;
    if (*recursion_depth > FxMaxParenthesisDepth)
    {
      (void) ThrowMagickException(exception, GetMagickModule(), OptionError,
        "ParenthesisDepthExceeded", "`%s'", expression);
      FxResult(0.0);
    }

    sub_start = expression + 1; // Skip the opening parenthesis
    sub_end = FxSubexpression(sub_start, exception); // Find the matching closing parenthesis
    if (sub_end == (const char *) NULL || *sub_end != ')')
    {
      (void) ThrowMagickException(exception, GetMagickModule(), OptionError,
        "UnbalancedParenthesis", "`%s'", expression);
      FxResult(0.0);
    }

    sub_length = (size_t)(sub_end - sub_start);
    (void) CopyMagickString(subexpression, sub_start, sub_length + 1); // Copy the subexpression
    alpha = FxEvaluateSubexpression(fx_info, channel, x, y, subexpression, recursion_depth, beta, exception);
    (*recursion_depth)--;

    FxResult(alpha);
  }