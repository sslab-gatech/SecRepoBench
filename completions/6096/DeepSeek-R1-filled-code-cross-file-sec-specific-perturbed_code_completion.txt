if (*expression == '(')
    {
      const char
        *end;

      size_t
        length;

      (*recursion_depth)++;
      if (*recursion_depth > FxMaxParenthesisDepth)
        {
          (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
            "ParenthesisDepthExceeded","`%s'",expression);
          FxResult(0.0);
        }
      end=expression+1;
      for (length=1; *end != '\0'; end++)
      {
        if (*end == '(')
          length++;
        else if (*end == ')')
          length--;
        if (length == 0)
          break;
      }
      if (length != 0)
        {
          (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
            "UnmatchedParenthesis","`%s'",expression);
          FxResult(0.0);
        }
      length=(size_t) (end-expression-1);
      subexpression=DestroyString(subexpression);
      subexpression=AcquireString((const char *) NULL);
      if (length >= (MagickPathExtent-1))
        {
          (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
            "ExpressionTooLong","`%s'",expression);
          FxResult(0.0);
        }
      (void) CopyMagickString(subexpression,expression+1,length+1);
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,
        recursion_depth,beta,exception);
      (*recursion_depth)--;
      FxResult(alpha);
    }