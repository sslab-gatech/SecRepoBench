if (*expression == '(')
  {
    size_t
      depth;

    depth = 1;
    p = expression + 1;
    while (depth > 0)
    {
      if (*p == '(')
        depth++;
      else if (*p == ')')
        depth--;
      p++;
    }
    if (depth == 0)
    {
      (void) CopyMagickString(subexpression, expression + 1, (size_t) (p - expression - 2));
      (*recursion_depth)++;
      *beta = FxEvaluateSubexpression(fx_info, channel, x, y, subexpression, recursion_depth, beta, exception);
      (*recursion_depth)--;
      expression = p;
    }
  }