if (*expression == '(')
{
  (*recursion_depth)++;
  if (*recursion_depth > FxMaxParenthesisDepth)
  {
    (void) ThrowMagickException(exception, GetMagickModule(), OptionError,
      "ParenthesisDepthExceeded", "`%s'", expression);
    FxResult(0.0);
  }
  p = expression + 1;
  while ((*p != '\0') && (*p != ')'))
    p++;
  if (*p == '\0')
  {
    (void) ThrowMagickException(exception, GetMagickModule(), OptionError,
      "UnbalancedParenthesis", "`%s'", expression);
    FxResult(0.0);
  }
  (void) CopyMagickString(subexpression, expression + 1, (size_t)(p - expression));
  subexpression[p - expression - 1] = '\0';
  alpha = FxEvaluateSubexpression(fx_info, channel, x, y, subexpression, recursion_depth, beta, exception);
  (*recursion_depth)--;
  FxResult(alpha);
}