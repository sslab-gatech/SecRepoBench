if (*expression == '(')
{
  (*recursion_depth)++;
  if (*recursion_depth > FxMaxParenthesisDepth)
  {
    (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
      "ParenthesisNestedTooDeeply","`%s'",expression);
    FxResult(0.0);
  }
  subexpression=AcquireString(expression+1);
  for (q=subexpression; *q != '\0'; q++)
  {
    if (*q == '(')
      {
        (*recursion_depth)++;
        if (*recursion_depth > FxMaxParenthesisDepth)
          {
            (void) ThrowMagickException(exception,GetMagickModule(),
              OptionError,"ParenthesisNestedTooDeeply","`%s'",expression);
            FxResult(0.0);
          }
      }
    if (*q == ')')
      {
        (*recursion_depth)--;
        if (*recursion_depth == 0)
          break;
      }
  }
  if (*q != ')')
    {
      (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
        "UnbalancedParenthesis","`%s'",expression);
      FxResult(0.0);
    }
  *q='\0';
  alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,
    recursion_depth,beta,exception);
  subexpression=DestroyString(subexpression);
  (*recursion_depth)--;
  FxResult(alpha);
}