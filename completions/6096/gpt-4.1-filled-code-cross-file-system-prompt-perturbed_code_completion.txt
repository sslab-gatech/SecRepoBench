if ((*expression == '(') || (*expression == '['))
  {
    size_t
      depth = 1,
      i = 1,
      length = strlen(expression);

    if (++(*recursion_depth) > FxMaxParenthesisDepth)
      {
        (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
          "ParenthesisDepthExceeded","`%s'",expression);
        FxResult(0.0);
      }
    while ((i < length) && (depth != 0))
      {
        if (expression[i] == *expression)
          depth++;
        else if (((*expression == '(') && (expression[i] == ')')) ||
                 ((*expression == '[') && (expression[i] == ']')))
          depth--;
        i++;
      }
    if (depth != 0)
      {
        (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
          "UnbalancedParenthesis","`%s'",expression);
        FxResult(0.0);
      }
    (void) CopyMagickString(subexpression,expression+1,i-2);
    alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,recursion_depth,
      beta,exception);
    (*recursion_depth)--;
    FxResult(alpha);
  }