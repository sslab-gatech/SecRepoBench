if (*expression == '(')
{
  *recursion_depth++;
  if (*recursion_depth > FxMaxParenthesisDepth)
  {
    (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
      "ParenthesisRecursionDepthExceeded","`%s'",expression);
    FxResult(0.0);
  }
  expression++;
  while (isspace((int) ((unsigned char) *expression)) != 0)
    expression++;
  (void) CopyMagickString(subexpression,expression,MagickPathExtent);
  q=subexpression;
  while (*q != '\0')
    if (*q == ')' && *(q-1) != '\\')
      break;
    else
      q++;
  if (*q != '\0')
  {
    *q='\0';
    alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,recursion_depth,
      beta,exception);
    expression=q+1;
    while (isspace((int) ((unsigned char) *expression)) != 0)
      expression++;
    if (*expression != ')')
    {
      (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
        "MissingParenthesis","`%s'",expression);
      FxResult(0.0);
    }
    expression++;
    *recursion_depth--;
    FxResult(alpha);
  }
}