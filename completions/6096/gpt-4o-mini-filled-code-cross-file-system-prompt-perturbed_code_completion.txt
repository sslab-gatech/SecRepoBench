if (*expression == '(')
  {
    (*recursion_depth)++;
    const char *start = expression;
    expression++;
    while (*expression != '\0' && *expression != ')')
      expression++;
    if (*expression == '\0')
      {
        (void) ThrowMagickException(exception,GetMagickModule(),
          OptionError,"UnmatchedParenthesis","`%s'",start);
        FxResult(0.0);
      }
    char *inner_expression = AcquireString(start + 1);
    strncpy(inner_expression, start + 1, expression - start - 1);
    inner_expression[expression - start - 1] = '\0';
    double result = FxEvaluateSubexpression(fx_info, channel, x, y, inner_expression, recursion_depth, beta, exception);
    (*recursion_depth)--;
    DestroyString(inner_expression);
    FxResult(result);
  }