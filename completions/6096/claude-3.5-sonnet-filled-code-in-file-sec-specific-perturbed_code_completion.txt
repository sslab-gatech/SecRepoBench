if (*expression == '(')
{
  (*recursion_depth)++;
  if (*recursion_depth > FxMaxParenthesisDepth)
  {
    (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
      "ParenthesisNestedTooDeeply","`%s'",expression);
    FxResult(0.0);
  }
  q=subexpression;
  for (p=expression+1; *p != '\0'; p++)
  {
    if (*p == '(')
      (*recursion_depth)++;
    else
      if (*p == ')')
        {
          (*recursion_depth)--;
          if (*recursion_depth == 0)
            break;
        }
    *q++=(*p);
  }
  *q='\0';
  if (*p == '\0')
    {
      (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
        "UnbalancedParenthesis","`%s'",expression);
      FxResult(0.0);
    }
  alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,
    recursion_depth,beta,exception);
  (*recursion_depth)--;
  FxResult(alpha);
}