if (*expression == '(')
{
  (*recursion_depth)++;
  if (*recursion_depth > FxMaxParenthesisDepth)
  {
    (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
      "ParenthesisNestingOverflow","`%s'",expression);
    (*recursion_depth)--;
    FxResult(0.0);
  }
  {
    size_t length = strlen(expression);
    if (length < 2 || expression[length-1] != ')')
    {
      (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
        "UnbalancedParentheses","`%s'",expression);
      (*recursion_depth)--;
      FxResult(0.0);
    }
    /* Copy the inner expression (without the outer parentheses) */
    size_t n = (length - 1);
    if (n > MagickPathExtent)
      n = MagickPathExtent;
    (void) CopyMagickString(subexpression, expression + 1, n);
    /* Remove the trailing ')' by terminating one character earlier */
    subexpression[strlen(subexpression) - 1] = '\0';
    {
      double result = FxEvaluateSubexpression(fx_info, channel, x, y, subexpression,
                                                recursion_depth, beta, exception);
      (*recursion_depth)--;
      FxResult(result);
    }
  }
}