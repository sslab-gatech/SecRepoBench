if (*expression == '(')
{
  (*recursion_depth)++;
  if (*recursion_depth > FxMaxParenthesisDepth)
  {
    (void) ThrowMagickException(exception, GetMagickModule(), OptionError,
      "ParenthesisDepthExceedsLimit", "`%s'", expression);
    FxResult(0.0);
  }
  {
    const char *ptr = expression;
    int parentheses = 0;
    while (*ptr != '\0')
    {
      if (*ptr == '(')
        parentheses++;
      else if (*ptr == ')')
      {
        parentheses--;
        if (parentheses == 0)
          break;
      }
      ptr++;
    }
    if (parentheses != 0)
    {
      (void) ThrowMagickException(exception, GetMagickModule(), OptionError,
        "UnbalancedParentheses", "`%s'", expression);
      FxResult(0.0);
    }
    /* Copy the inner expression without the outer parentheses */
    size_t length = ptr - expression - 1;
    subexpression[0] = '\0';
    (void) CopyMagickString(subexpression, expression + 1, length + 1);
    alpha = FxEvaluateSubexpression(fx_info, channel, x, y, subexpression,
      recursion_depth, beta, exception);
  }
  (*recursion_depth)--;
  FxResult(alpha);
}