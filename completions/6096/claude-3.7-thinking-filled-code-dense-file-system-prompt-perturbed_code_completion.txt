if (*expression == '(')
{
  (*recursion_depth)++;
  if (*recursion_depth > FxMaxParenthesisDepth)
    {
      (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
        "ParenthesisNestedTooDeeply","`%s'",expression);
      FxResult(0.0);
    }
  
  // Extract the subexpression inside the parentheses
  p=expression+1;
  level=1;
  q=subexpression;
  while ((*p != '\0') && (level > 0))
  {
    if (*p == '(')
      level++;
    else if (*p == ')')
      level--;
    if (level > 0)
      *q++=(*p);
    p++;
  }
  *q='\0';
  
  if (level != 0)  // If no matching closing parenthesis
    {
      (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
        "UnableToParseExpression","`%s'",expression);
      FxResult(0.0);
    }
  
  gamma=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,recursion_depth,
    beta,exception);
  (*recursion_depth)--;
  
  // If there's more to the expression after the closing parenthesis
  if (*p != '\0')
    {
      alpha=gamma;
      FxResult(alpha*FxEvaluateSubexpression(fx_info,channel,x,y,p,recursion_depth,
        beta,exception));
    }
  
  FxResult(gamma);
}