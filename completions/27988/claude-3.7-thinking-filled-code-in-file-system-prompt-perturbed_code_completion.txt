if(networkflow) {
  // Free HTTP related fields
  if(networkflow->http.url)
    ndpi_free(networkflow->http.url);
  
  if(networkflow->http.content_type)
    ndpi_free(networkflow->http.content_type);
  
  if(networkflow->http.user_agent)
    ndpi_free(networkflow->http.user_agent);
  
  // Free Kerberos related fields
  if(networkflow->kerberos_buf.pktbuf)
    ndpi_free(networkflow->kerberos_buf.pktbuf);
  
  // Free TLS/SSL related fields if this is a TCP protocol
  if(networkflow->l4_proto == IPPROTO_TCP) {
    if(networkflow->l4.tcp.tls.message.buffer)
      ndpi_free(networkflow->l4.tcp.tls.message.buffer);
  }
  
  ndpi_free(networkflow);
}