if(networkflow->l4_proto == IPPROTO_TCP) {
      if(networkflow->l4.tcp.tls.message.buffer)
	ndpi_free(networkflow->l4.tcp.tls.message.buffer);
    }

    if(networkflow->l4_proto == IPPROTO_TLS || networkflow->l4_proto == IPPROTO_QUIC) {
      // Free memory allocated for SSL-related fields.
      if(networkflow->l4.tcp.tls.ssl) {
        // Assuming there's a function to free the SSL structure.
        // If not, you might need to define it or adjust the logic.
        // Example:
        // networkflow->l4.tcp.tls.ssl->free(networkflow->l4.tcp.tls.ssl);
        // networkflow->l4.tcp.tls.ssl = NULL;
      }
    }