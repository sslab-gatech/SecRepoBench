if (networkflow->http) {
        if (networkflow->http->request.uri) {
            ndpi_free(networkflow->http->request.uri);
        }
        if (networkflow->http->request.method) {
            ndpi_free(networkflow->http->request.method);
        }
        if (networkflow->http->response.body) {
            ndpi_free(networkflow->http->response.body);
        }
        ndpi_free(networkflow->http);
    }

    if (networkflow->l4_proto == IPPROTO_TLS || networkflow->l4_proto == IPPROTO_QUIC) {
        if (networkflow->l4.tcp.tls.message.buffer) {
            ndpi_free(networkflow->l4.tcp.tls.message.buffer);
        }
        if (networkflow->l4.tcp.tls.num_tls_blocks) {
            ndpi_free(networkflow->l4.tcp.tls.tls_application_blocks_len);
        }
    }