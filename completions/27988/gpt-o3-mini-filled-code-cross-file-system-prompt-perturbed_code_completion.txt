if(networkflow->http_request.uri) {
  ndpi_free(networkflow->http_request.uri);
  networkflow->http_request.uri = NULL;
}
if(networkflow->http_request.host) {
  ndpi_free(networkflow->http_request.host);
  networkflow->http_request.host = NULL;
}

/* Free TLS/QUIC (i.e. SSLâ€related) dynamically allocated fields */
if(networkflow->l4_proto == IPPROTO_TCP) {
  if(networkflow->l4.tcp.tls.server_name) {
    ndpi_free(networkflow->l4.tcp.tls.server_name);
    networkflow->l4.tcp.tls.server_name = NULL;
  }
  if(networkflow->l4.tcp.tls.session_id) {
    ndpi_free(networkflow->l4.tcp.tls.session_id);
    networkflow->l4.tcp.tls.session_id = NULL;
  }
} else if(networkflow->l4_proto == IPPROTO_UDP) { // assuming QUIC runs over UDP
  if(networkflow->l7.quic.tls_data) {
    ndpi_free(networkflow->l7.quic.tls_data);
    networkflow->l7.quic.tls_data = NULL;
  }
}