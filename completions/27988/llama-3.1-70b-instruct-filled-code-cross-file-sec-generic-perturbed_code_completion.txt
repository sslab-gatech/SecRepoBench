if(networkflow->http_stage == HTTP_STAGE_FIRST_REQUEST) {
  if(networkflow->http_url)
    ndpi_free(networkflow->http_url);
  if(networkflow->http_host)
    ndpi_free(networkflow->http_host);
  if(networkflow->http_user_agent)
    ndpi_free(networkflow->http_user_agent);
  if(networkflow->http_accept)
    ndpi_free(networkflow->http_accept);
  if(networkflow->http_accept_language)
    ndpi_free(networkflow->http_accept_language);
  if(networkflow->http_accept_encoding)
    ndpi_free(networkflow->http_accept_encoding);
  if(networkflow->http_cookie)
    ndpi_free(networkflow->http_cookie);
  if(networkflow->http_content_type)
    ndpi_free(networkflow->http_content_type);
  if(networkflow->http_transfer_encoding)
    ndpi_free(networkflow->http_transfer_encoding);
  if(networkflow->http_x_requested_with)
    ndpi_free(networkflow->http_x_requested_with);
  if(networkflow->http_x_file_offset)
    ndpi_free(networkflow->http_x_file_offset);
  if(networkflow->http_x_file_size)
    ndpi_free(networkflow->http_x_file_size);
  if(networkflow->http_x_file_name)
    ndpi_free(networkflow->http_x_file_name);
  if(networkflow->http_range)
    ndpi_free(networkflow->http_range);
  if(networkflow->http_if_none_match)
    ndpi_free(networkflow->http_if_none_match);
  if(networkflow->http_if_modified_since)
    ndpi_free(networkflow->http_if_modified_since);
  if(networkflow->http_server)
    ndpi_free(networkflow->http_server);
  if(networkflow->http_via)
    ndpi_free(networkflow->http_via);
  if(networkflow->http_x_cache)
    ndpi_free(networkflow->http_x_cache);
  if(networkflow->http_x_cache_lookup)
    ndpi_free(networkflow->http_x_cache_lookup);
  if(networkflow->http_x_forwarded_for)
    ndpi_free(networkflow->http_x_forwarded_for);
  if(networkflow->http_x_real_ip)
    ndpi_free(networkflow->http_x_real_ip);
  if(networkflow->http_x_client_ip)
    ndpi_free(networkflow->http_x_client_ip);
  if(networkflow->http_x_client_port)
    ndpi_free(networkflow->http_x_client_port);
  if(networkflow->http_x_proxy_id)
    ndpi_free(networkflow->http_x_proxy_id);
  if(networkflow->http_x_proxy_server)
    ndpi_free(networkflow->http_x_proxy_server);
  if(networkflow->http_x_proxy_port)
    ndpi_free(networkflow->http_x_proxy_port);
  if(networkflow->http_x_proxy_protocol)
    ndpi_free(networkflow->http_x_proxy_protocol);
  if(networkflow->http_x_proxy_protocol_version)
    ndpi_free(networkflow->http_x_proxy_protocol_version);
  if(networkflow->http_x_proxy_protocol_client_ip)
    ndpi_free(networkflow->http_x_proxy_protocol_client_ip);
  if(networkflow->http_x_proxy_protocol_client_port)
    ndpi_free(networkflow->http_x_proxy_protocol_client_port);
  if(networkflow->http_x_proxy_protocol_server_ip)
    ndpi_free(networkflow->http_x_proxy_protocol_server_ip);
  if(networkflow->http_x_proxy_protocol_server_port)
    ndpi_free(networkflow->http_x_proxy_protocol_server_port);
  if(networkflow->http_x_proxy_protocol_proxy_ip)
    ndpi_free(networkflow->http_x_proxy_protocol_proxy_ip);
  if(networkflow->http_x_proxy_protocol_proxy_port)
    ndpi_free(networkflow->http_x_proxy_protocol_proxy_port);
  if(networkflow->http_x_proxy_protocol_proxy_protocol)
    ndpi_free(networkflow->http_x_proxy_protocol_proxy_protocol);
  if(networkflow->http_x_proxy_protocol_proxy_protocol_version)
    ndpi_free(networkflow->http_x_proxy_protocol_proxy_protocol_version);
  if(networkflow->http_x_forwarded_proto)
    ndpi_free(networkflow->http_x_forwarded_proto);
  if(networkflow->http_x_forwarded_host)
    ndpi_free(networkflow->http_x_forwarded_host);
  if(networkflow->http_x_forwarded_port)
    ndpi_free(networkflow->http_x_forwarded_port);
  if(networkflow->http_x_forwarded_server)
    ndpi_free(networkflow->http_x_forwarded_server);
  if(networkflow->http_x_forwarded_for)
    ndpi_free(networkflow->http_x_forwarded_for);
  if(networkflow->http_x_forwarded_proto_verb)
    ndpi_free(networkflow->http_x_forwarded_proto_verb);
  if(networkflow->http_x_forwarded_status)
    ndpi_free(networkflow->http_x_forwarded_status);
  if(networkflow->http_x_forwarded_by)
    ndpi_free(networkflow->http_x_forwarded_by);
  if(networkflow->http_x_forwarded_for_1)
    ndpi_free(networkflow->http_x_forwarded_for_1);
  if(networkflow->http_x_forwarded_host_1)
    ndpi_free(networkflow->http_x_forwarded_host_1);
  if(networkflow->http_x_forwarded_server_1)
    ndpi_free(networkflow->http_x_forwarded_server_1);
  if(networkflow->http_x_forwarded_for_2)
    ndpi_free(networkflow->http_x_forwarded_for_2);
  if(networkflow->http_x_forwarded_host_2)
    ndpi_free(networkflow->http_x_forwarded_host_2);
  if(networkflow->http_x_forwarded_server_2)
    ndpi_free(networkflow->http_x_forwarded_server_2);
  if(networkflow->http_x_forwarded_for_3)
    ndpi_free(networkflow->http_x_forwarded_for_3);
  if(networkflow->http_x_forwarded_host_3)
    ndpi_free(networkflow->http_x_forwarded_host_3);
  if(networkflow->http_x_forwarded_server_3)
    ndpi_free(networkflow->http_x_forwarded_server_3);
  if(networkflow->http_x_forwarded_for_4)
    ndpi_free(networkflow->http_x_forwarded_for_4);
  if(networkflow->http_x_forwarded_host_4)
    ndpi_free(networkflow->http_x_forwarded_host_4);
  if(networkflow->http_x_forwarded_server_4)
    ndpi_free(networkflow->http_x_forwarded_server_4);
  if(networkflow->http_x_forwarded_for_5)
    ndpi_free(networkflow->http_x_forwarded_for_5);
  if(networkflow->http_x_forwarded_host_5)
    ndpi_free(networkflow->http_x_forwarded_host_5);
  if(networkflow->http_x_forwarded_server_5)
    ndpi_free(networkflow->http_x_forwarded_server_5);
  if(networkflow->http_x_forwarded_for_6)
    ndpi_free(networkflow->http_x_forwarded_for_6);
  if(networkflow->http_x_forwarded_host_6)
    ndpi_free(networkflow->http_x_forwarded_host_6);
  if(networkflow->http_x_forwarded_server_6)
    ndpi_free(networkflow->http_x_forwarded_server_6);
  if(networkflow->http_x_forwarded_for_7)
    ndpi_free(networkflow->http_x_forwarded_for_7);
  if(networkflow->http_x_forwarded_host_7)
    ndpi_free(networkflow->http_x_forwarded_host_7);
  if(networkflow->http_x_forwarded_server_7)
    ndpi_free(networkflow->http_x_forwarded_server_7);
  if(networkflow->http_x_forwarded_for_8)
    ndpi_free(networkflow->http_x_forwarded_for_8);
  if(networkflow->http_x_forwarded_host_8)
    ndpi_free(networkflow->http_x_forwarded_host_8);
  if(networkflow->http_x_forwarded_server_8)
    ndpi_free(networkflow->http_x_forwarded_server_8);
  if(networkflow->http_x_forwarded_for_9)
    ndpi_free(networkflow->http_x_forwarded_for_9);
  if(networkflow->http_x_forwarded_host_9)
    ndpi_free(networkflow->http_x_forwarded_host_9);
  if(networkflow->http_x_forwarded_server_9)
    ndpi_free(networkflow->http_x_forwarded_server_9);
  if(networkflow->http_x_forwarded_for_10)
    ndpi_free(networkflow->http_x_forwarded_for_10);
  if(networkflow->http_x_forwarded_host_10)
    ndpi_free(networkflow->http_x_forwarded_host_10);
  if(networkflow->http_x_forwarded_server_10)
    ndpi_free(networkflow->http_x_forwarded_server_10);
  if(networkflow->http_x_forwarded_for_11)
    ndpi_free(networkflow->http_x_forwarded_for_11);
  if(networkflow->http_x_forwarded_host_11)
    ndpi_free(networkflow->http_x_forwarded_host_11);
  if(networkflow->http_x_forwarded_server_11)
    ndpi_free(networkflow->http_x_forwarded_server_11);
  if(networkflow->http_x_forwarded_for_12)
    ndpi_free(networkflow->http_x_forwarded_for_12);
  if(networkflow->http_x_forwarded_host_12)
    ndpi_free(networkflow->http_x_forwarded_host_12);
  if(networkflow->http_x_forwarded_server_12)
    ndpi_free(networkflow->http_x_forwarded_server_12);
  if(networkflow->http_x_forwarded_for_13)
    ndpi_free(networkflow->http_x_forwarded_for_13);
  if(networkflow->http_x_forwarded_host_13)
    ndpi_free(networkflow->http_x_forwarded_host_13);
  if(networkflow->http_x_forwarded_server_13)
    ndpi_free(networkflow->http_x_forwarded_server_13);
  if(networkflow->http_x_forwarded_for_14)
    ndpi_free(networkflow->http_x_forwarded_for_14);
  if(networkflow->http_x_forwarded_host_14)
    ndpi_free(networkflow->http_x_forwarded_host_14);
  if(networkflow->http_x_forwarded_server_14)
    ndpi_free(networkflow->http_x_forwarded_server_14);
  if(networkflow->http_x_forwarded_for_15)
    ndpi_free(networkflow->http_x_forwarded_for_15);
  if(networkflow->http_x_forwarded_host_15)
    ndpi_free(networkflow->http_x_forwarded_host_15);
  if(networkflow->http_x_forwarded_server_15)
    ndpi_free(networkflow->http_x_forwarded_server_15);
  if(networkflow->http_x_forwarded_for_16)
    ndpi_free(networkflow->http_x_forwarded_for_16);
  if(networkflow->http_x_forwarded_host_16)
    ndpi_free(networkflow->http_x_forwarded_host_16);
  if(networkflow->http_x_forwarded_server_16)
    ndpi_free(networkflow->http_x_forwarded_server_16);
  if(networkflow->http_x_forwarded_for_17)
    ndpi_free(networkflow->http_x_forwarded_for_17);
  if(networkflow->http_x_forwarded_host_17)
    ndpi_free(networkflow->http_x_forwarded_host_17);
  if(networkflow->http_x_forwarded_server_17)
    ndpi_free(networkflow->http_x_forwarded_server_17);
  if(networkflow->http_x_forwarded_for_18)
    ndpi_free(networkflow->http_x_forwarded_for_18);
  if(networkflow->http_x_forwarded_host_18)
    ndpi_free(networkflow->http_x_forwarded_host_18);
  if(networkflow->http_x_forwarded_server_18)
    ndpi_free(networkflow->http_x_forwarded_server_18);
  if(networkflow->http_x_forwarded_for_19)
    ndpi_free(networkflow->http_x_forwarded_for_19);
  if(networkflow->http_x_forwarded_host_19)
    ndpi_free(networkflow->http_x_forwarded_host_19);
  if(networkflow->http_x_forwarded_server_19)
    ndpi_free(networkflow->http_x_forwarded_server_19);
  if(networkflow->http_x_forwarded_for_20)
    ndpi_free(networkflow->http_x_forwarded_for_20);
  if(networkflow->http_x_forwarded_host_20)
    ndpi_free(networkflow->http_x_forwarded_host_20);
  if(networkflow->http_x_forwarded_server_20)
    ndpi_free(networkflow->http_x_forwarded_server_20);
  if(networkflow->http_x_forwarded_for_21)
    ndpi_free(networkflow->http_x_forwarded_for_21);
  if(networkflow->http_x_forwarded_host_21)
    ndpi_free(networkflow->http_x_forwarded_host_21);
  if(networkflow->http_x_forwarded_server_21)
    ndpi_free(networkflow->http_x_forwarded_server_21);
  if(networkflow->http_x_forwarded_for_22)
    ndpi_free(networkflow->http_x_forwarded_for_22);
  if(networkflow->http_x_forwarded_host_22)
    ndpi_free(networkflow->http_x_forwarded_host_22);
  if(networkflow->http_x_forwarded_server_22)
    ndpi_free(networkflow->http_x_forwarded_server_22);
  if(networkflow->http_x_forwarded_for_23)
    ndpi_free(networkflow->http_x_forwarded_for_23);
  if(networkflow->http_x_forwarded_host_23)
    ndpi_free(networkflow->http_x_forwarded_host_23);
  if(networkflow->http_x_forwarded_server_23)
    ndpi_free(networkflow->http_x_forwarded_server_23);
  if(networkflow->http_x_forwarded_for_24)
    ndpi_free(networkflow->http_x_forwarded_for_24);
  if(networkflow->http_x_forwarded_host_24)
    ndpi_free(networkflow->http_x_forwarded_host_24);
  if(networkflow->http_x_forwarded_server_24)
    ndpi_free(networkflow->http_x_forwarded_server_24);
  if(networkflow->http_x_forwarded_for_25)
    ndpi_free(networkflow->http_x_forwarded_for_25);
  if(networ