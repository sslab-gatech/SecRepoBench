/* Free HTTP related fields if allocated */
  if (networkflow->http_request_uri) {
      ndpi_free(networkflow->http_request_uri);
      networkflow->http_request_uri = NULL;
  }
  if (networkflow->http_host) {
      ndpi_free(networkflow->http_host);
      networkflow->http_host = NULL;
  }
  if (networkflow->http_user_agent) {
      ndpi_free(networkflow->http_user_agent);
      networkflow->http_user_agent = NULL;
  }

  /* Free SSL/TLS related fields if the protocol is TLS or QUIC */
  if ((networkflow->l4_proto == NDPI_PROTOCOL_TLS) ||
      (networkflow->l4_proto == NDPI_PROTOCOL_QUIC)) {
      if (networkflow->ssl_server_name) {
          ndpi_free(networkflow->ssl_server_name);
          networkflow->ssl_server_name = NULL;
      }
      if (networkflow->ssl_session_id) {
          ndpi_free(networkflow->ssl_session_id);
          networkflow->ssl_session_id = NULL;
      }
  }