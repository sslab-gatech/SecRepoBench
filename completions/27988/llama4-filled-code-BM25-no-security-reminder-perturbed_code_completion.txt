// Free memory allocated for HTTP related fields in the flow structure.
if (networkflow->http) {
  if (networkflow->http->client_headers) ndpi_free(networkflow->http->client_headers);
  if (networkflow->http->server_headers) ndpi_free(networkflow->http->server_headers);
  if (networkflow->http->url) ndpi_free(networkflow->http->url);
  if (networkflow->http->user_agent) ndpi_free(networkflow->http->user_agent);
  if (networkflow->http->content_type) ndpi_free(networkflow->http->content_type);
  ndpi_free(networkflow->http);
  networkflow->http = NULL;
}

// If the protocol is TLS or QUIC, free memory allocated for SSL-related fields.
if(networkflow->l4_proto == IPPROTO_TCP && networkflow->l4.tcp.tls.message.buffer) {
  ndpi_free(networkflow->l4.tcp.tls.message.buffer);
  networkflow->l4.tcp.tls.message.buffer = NULL;
  networkflow->l4.tcp.tls.message.buffer_used = 0;
}

// Ensure that all dynamically allocated fields in the flow are properly deallocated
// before freeing the flow structure itself.
// Additional deallocations for other protocols or fields can be added here as needed.