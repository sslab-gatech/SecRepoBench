/* Free any HTTP-related fields if they were dynamically allocated */
if(networkflow->protos.http.http_url != NULL) {
  ndpi_free(networkflow->protos.http.http_url);
  networkflow->protos.http.http_url = NULL;
}
if(networkflow->protos.http.host_server_name != NULL) {
  ndpi_free(networkflow->protos.http.host_server_name);
  networkflow->protos.http.host_server_name = NULL;
}

/* If this flow is TLS or QUIC, free any SSL-related fields */
if(networkflow->detected_protocol_stack[0] == NDPI_PROTOCOL_TLS ||
   networkflow->detected_protocol_stack[0] == NDPI_PROTOCOL_QUIC) {
  /* Example: free a dynamically allocated server name (if present) */
  if(networkflow->protos.stun_ssl.ssl.server_name != NULL) {
    ndpi_free(networkflow->protos.stun_ssl.ssl.server_name);
    networkflow->protos.stun_ssl.ssl.server_name = NULL;
  }
}