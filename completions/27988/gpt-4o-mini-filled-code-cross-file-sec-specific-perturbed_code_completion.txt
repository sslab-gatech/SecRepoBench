if (networkflow->l4_proto == IPPROTO_HTTP) {
        // Free memory allocated for HTTP related fields
        if (networkflow->l4.tcp.http.message.buffer) {
            ndpi_free(networkflow->l4.tcp.http.message.buffer);
        }
    } else if (networkflow->l4_proto == IPPROTO_TLS || networkflow->l4_proto == IPPROTO_QUIC) {
        // Free memory allocated for SSL-related fields
        if (networkflow->l4.tcp.tls.message.buffer) {
            ndpi_free(networkflow->l4.tcp.tls.message.buffer);
        }
    }