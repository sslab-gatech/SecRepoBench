// Free HTTP related fields
if(networkflow->host_server_name)
  ndpi_free(networkflow->host_server_name);

// Free TLS/SSL related fields for UDP
if(networkflow->l4_proto == IPPROTO_UDP) {
  if(networkflow->l4.udp.tls.message.buffer)
    ndpi_free(networkflow->l4.udp.tls.message.buffer);
}

// Free SSL/TLS specific fields
if(networkflow->protos.stun_ssl.ssl.server_names)
  ndpi_free(networkflow->protos.stun_ssl.ssl.server_names);

if(networkflow->protos.stun_ssl.ssl.alpn)
  ndpi_free(networkflow->protos.stun_ssl.ssl.alpn);

if(networkflow->protos.stun_ssl.ssl.issuerDN)
  ndpi_free(networkflow->protos.stun_ssl.ssl.issuerDN);

if(networkflow->protos.stun_ssl.ssl.subjectDN)
  ndpi_free(networkflow->protos.stun_ssl.ssl.subjectDN);

if(networkflow->protos.stun_ssl.ssl.ja3_client)
  ndpi_free(networkflow->protos.stun_ssl.ssl.ja3_client);

if(networkflow->protos.stun_ssl.ssl.ja3_server)
  ndpi_free(networkflow->protos.stun_ssl.ssl.ja3_server);