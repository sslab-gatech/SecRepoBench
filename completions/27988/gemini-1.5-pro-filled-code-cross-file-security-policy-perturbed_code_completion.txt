bool is_quic = networkflow->l4_proto == IPPROTO_UDP && networkflow->detected_protocol == NDPI_PROTOCOL_QUIC;
    if (networkflow->l4_proto == IPPROTO_TCP || is_quic) {
      if (networkflow->l4.tcp.tls.sni.buffer) {
        ndpi_free(networkflow->l4.tcp.tls.sni.buffer);
      }
      if (networkflow->l4.tcp.tls.ja3_hash.buffer)
        ndpi_free(networkflow->l4.tcp.tls.ja3_hash.buffer);
      if (is_quic && networkflow->l4.udp.quic.tls.sni.buffer) {
        ndpi_free(networkflow->l4.udp.quic.tls.sni.buffer);
      }
      if (networkflow->l4.tcp.tls.message.buffer)
        ndpi_free(networkflow->l4.tcp.tls.message.buffer);

    }
    if (networkflow->src_ip_str)
      ndpi_free(networkflow->src_ip_str);
    if (networkflow->dst_ip_str)
      ndpi_free(networkflow->dst_ip_str);