/* Free HTTP-related fields */
    if (networkflow->http.user_agent) {
        ndpi_free(networkflow->http.user_agent);
        networkflow->http.user_agent = NULL;
    }
    if (networkflow->http.host) {
        ndpi_free(networkflow->http.host);
        networkflow->http.host = NULL;
    }
    if (networkflow->http.uri) {
        ndpi_free(networkflow->http.uri);
        networkflow->http.uri = NULL;
    }

    /* Free TLS/QUIC-related fields */
    if (networkflow->l4_proto == IPPROTO_TCP) {
        if (networkflow->l4.tcp.tls.server_name) {
            ndpi_free(networkflow->l4.tcp.tls.server_name);
            networkflow->l4.tcp.tls.server_name = NULL;
        }
        if (networkflow->l4.tcp.tls.session_id) {
            ndpi_free(networkflow->l4.tcp.tls.session_id);
            networkflow->l4.tcp.tls.session_id = NULL;
        }
    }
#ifdef NDPI_PROTOCOL_QUIC
    else if (networkflow->l4_proto == NDPI_PROTOCOL_QUIC) {
        if (networkflow->l7.quic.ssl_info.server_name) {
            ndpi_free(networkflow->l7.quic.ssl_info.server_name);
            networkflow->l7.quic.ssl_info.server_name = NULL;
        }
    }
#endif