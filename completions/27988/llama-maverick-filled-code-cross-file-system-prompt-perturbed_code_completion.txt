if((networkflow->l4_proto == IPPROTO_TCP) && (networkflow->protos.stun_ssl.ssl.certificate != NULL)) {
  ndpi_free(networkflow->protos.stun_ssl.ssl.certificate);
  networkflow->protos.stun_ssl.ssl.certificate = NULL;

  if(networkflow->protos.stun_ssl.ssl.server_names) {
    ndpi_free(networkflow->protos.stun_ssl.ssl.server_names);
    networkflow->protos.stun_ssl.ssl.server_names = NULL;
  }

  if(networkflow->protos.stun_ssl.ssl.alpn) {
    ndpi_free(networkflow->protos.stun_ssl.ssl.alpn);
    networkflow->protos.stun_ssl.ssl.alpn = NULL;
  }

  if(networkflow->protos.stun_ssl.ssl.tls_supported_versions) {
    ndpi_free(networkflow->protos.stun_ssl.ssl.tls_supported_versions);
    networkflow->protos.stun_ssl.ssl.tls_supported_versions = NULL;
  }

  if(networkflow->protos.stun_ssl.ssl.ja3_client) {
    ndpi_free(networkflow->protos.stun_ssl.ssl.ja3_client);
    networkflow->protos.stun_ssl.ssl.ja3_client = NULL;
  }

  if(networkflow->protos.stun_ssl.ssl.ja3_server) {
    ndpi_free(networkflow->protos.stun_ssl.ssl.ja3_server);
    networkflow->protos.stun_ssl.ssl.ja3_server = NULL;
  }
}