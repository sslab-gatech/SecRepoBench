if(networkflow->l4_proto == IPPROTO_TCP) {
      if(networkflow->l4.tcp.tls.message.buffer) {
	ndpi_free(networkflow->l4.tcp.tls.message.buffer);
	networkflow->l4.tcp.tls.message.buffer = NULL;
      }
      if(networkflow->l4.tcp.tls.sni) {
	ndpi_free(networkflow->l4.tcp.tls.sni);
	networkflow->l4.tcp.tls.sni = NULL;
      }
      if(networkflow->l4.tcp.tls.alpn) {
	ndpi_free(networkflow->l4.tcp.tls.alpn);
	networkflow->l4.tcp.tls.alpn = NULL;
      }
    }
    if(networkflow->l4_proto == IPPROTO_UDP && networkflow->l4.udp.quic.server_name) {
      ndpi_free(networkflow->l4.udp.quic.server_name);
      networkflow->l4.udp.quic.server_name = NULL;
    }

    if(networkflow->http_header_buffer) {
      ndpi_free(networkflow->http_header_buffer);
      networkflow->http_header_buffer = NULL;
    }
    if(networkflow->http_body_buffer) {
      ndpi_free(networkflow->http_body_buffer);
      networkflow->http_body_buffer = NULL;
    }
    if(networkflow->http_url) {
      ndpi_free(networkflow->http_url);
      networkflow->http_url = NULL;
    }
    if(networkflow->http_method) {
      ndpi_free(networkflow->http_method);
      networkflow->http_method = NULL;
    }
    if(networkflow->http_path) {
      ndpi_free(networkflow->http_path);
      networkflow->http_path = NULL;
    }
    if(networkflow->http_version) {
      ndpi_free(networkflow->http_version);
      networkflow->http_version = NULL;
    }
    if(networkflow->http_headers) {
      ndpi_free(networkflow->http_headers);
      networkflow->http_headers = NULL;
    }