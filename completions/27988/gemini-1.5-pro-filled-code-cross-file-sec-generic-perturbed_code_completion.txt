if (networkflow->l4_proto == IPPROTO_UDP) {
      if (networkflow->l4.udp.tls.message.buffer)
        ndpi_free(networkflow->l4.udp.tls.message.buffer);
    } else if (networkflow->l4_proto == IPPROTO_TCP) {
      if (networkflow->l4.tcp.tls.sni.name)
        ndpi_free(networkflow->l4.tcp.tls.sni.name);
      if (networkflow->l4.tcp.tls.ja3_hash)
        ndpi_free(networkflow->l4.tcp.tls.ja3_hash);
      if (networkflow->l4.tcp.tls.http_url)
        ndpi_free(networkflow->l4.tcp.tls.http_url);

      if (networkflow->l4.tcp.quic.tls.sni.name)
        ndpi_free(networkflow->l4.tcp.quic.tls.sni.name);
      if (networkflow->l4.tcp.quic.tls.ja3_hash)
        ndpi_free(networkflow->l4.tcp.quic.tls.ja3_hash);
      if (networkflow->l4.tcp.quic.tls.http_url)
        ndpi_free(networkflow->l4.tcp.quic.tls.http_url);
    }

    if (networkflow->http_referer)
      ndpi_free(networkflow->http_referer);
    if (networkflow->http_user_agent)
      ndpi_free(networkflow->http_user_agent);
    if (networkflow->http_content_type)
      ndpi_free(networkflow->http_content_type);
    if (networkflow->socks_username)
      ndpi_free(networkflow->socks_username);
    if (networkflow->socks_password)
      ndpi_free(networkflow->socks_password);
    if (networkflow->smtp_mail_from)
      ndpi_free(networkflow->smtp_mail_from);
    if (networkflow->smtp_rcpt_to)
      ndpi_free(networkflow->smtp_rcpt_to);
    if (networkflow->imap_username)
      ndpi_free(networkflow->imap_username);
    if (networkflow->imap_password)
      ndpi_free(networkflow->imap_password);
    if (networkflow->pop_username)
      ndpi_free(networkflow->pop_username);
    if (networkflow->pop_password)
      ndpi_free(networkflow->pop_password);
    if (networkflow->rtsp_url)
      ndpi_free(networkflow->rtsp_url);
    if (networkflow->skype_skype_name)
      ndpi_free(networkflow->skype_skype_name);
    if (networkflow->irc_server)
      ndpi_free(networkflow->irc_server);
    if (networkflow->irc_channel)
      ndpi_free(networkflow->irc_channel);
    if (networkflow->irc_nickname)
      ndpi_free(networkflow->irc_nickname);
    if (networkflow->mysql_username)
      ndpi_free(networkflow->mysql_username);
    if (networkflow->mysql_password)
      ndpi_free(networkflow->mysql_password);
    if (networkflow->pgsql_username)
      ndpi_free(networkflow->pgsql_username);
    if (networkflow->pgsql_password)
      ndpi_free(networkflow->pgsql_password);
    if (networkflow->redis_password)
      ndpi_free(networkflow->redis_password);
    if (networkflow->mongodb_username)
      ndpi_free(networkflow->mongodb_username);
    if (networkflow->mongodb_password)
      ndpi_free(networkflow->mongodb_password);
    if (networkflow->mqtt_clientid)
      ndpi_free(networkflow->mqtt_clientid);
    if (networkflow->mqtt_username)
      ndpi_free(networkflow->mqtt_username);
    if (networkflow->mqtt_password)
      ndpi_free(networkflow->mqtt_password);
    if (networkflow->tls_fingerprint)
      ndpi_free(networkflow->tls_fingerprint);
    if (networkflow->ssh_client_banner.buffer)
      ndpi_free(networkflow->ssh_client_banner.buffer);
    if (networkflow->ssh_server_banner.buffer)
      ndpi_free(networkflow->ssh_server_banner.buffer);
    if (networkflow->dns_query)
      ndpi_free(networkflow->dns_query);