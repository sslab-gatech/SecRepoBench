// Free HTTP related fields
if(networkflow->http.url) ndpi_free(networkflow->http.url);
if(networkflow->http.content_type) ndpi_free(networkflow->http.content_type);
if(networkflow->http.user_agent) ndpi_free(networkflow->http.user_agent);

// Free SSL/TLS related fields
if(networkflow->protos.stun_ssl.ssl.server_names) 
  ndpi_free(networkflow->protos.stun_ssl.ssl.server_names);
if(networkflow->protos.stun_ssl.ssl.client_certificate)
  ndpi_free(networkflow->protos.stun_ssl.ssl.client_certificate);
if(networkflow->protos.stun_ssl.ssl.server_certificate)
  ndpi_free(networkflow->protos.stun_ssl.ssl.server_certificate);

// For UDP protocols (QUIC/DTLS)
if(networkflow->l4_proto == IPPROTO_UDP) {
  if(networkflow->l4.udp.tls.message.buffer)
    ndpi_free(networkflow->l4.udp.tls.message.buffer);
}