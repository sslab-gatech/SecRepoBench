if(networkflow->http_state) {
  if(networkflow->http_state->host)
    ndpi_free(networkflow->http_state->host);
  if(networkflow->http_state->url)
    ndpi_free(networkflow->http_state->url);
  if(networkflow->http_state->user_agent)
    ndpi_free(networkflow->http_state->user_agent);
  if(networkflow->http_state->accept)
    ndpi_free(networkflow->http_state->accept);
  if(networkflow->http_state->accept_language)
    ndpi_free(networkflow->http_state->accept_language);
  if(networkflow->http_state->accept_encoding)
    ndpi_free(networkflow->http_state->accept_encoding);
  if(networkflow->http_state->referer)
    ndpi_free(networkflow->http_state->referer);
  if(networkflow->http_state->x_forwarded_for)
    ndpi_free(networkflow->http_state->x_forwarded_for);
  if(networkflow->http_state->content_type)
    ndpi_free(networkflow->http_state->content_type);
  if(networkflow->http_state->cookie)
    ndpi_free(networkflow->http_state->cookie);
  if(networkflow->http_state->set_cookie)
    ndpi_free(networkflow->http_state->set_cookie);
  if(networkflow->http_state->range)
    ndpi_free(networkflow->http_state->range);
  if(networkflow->http_state->if_none_match)
    ndpi_free(networkflow->http_state->if_none_match);
  if(networkflow->http_state->if_modified_since)
    ndpi_free(networkflow->http_state->if_modified_since);
  if(networkflow->http_state->if_range)
    ndpi_free(networkflow->http_state->if_range);
  if(networkflow->http_state->last_modified)
    ndpi_free(networkflow->http_state->last_modified);
  if(networkflow->http_state->etag)
    ndpi_free(networkflow->http_state->etag);
  if(networkflow->http_state->server)
    ndpi_free(networkflow->http_state->server);
  if(networkflow->http_state->x_content_type_options)
    ndpi_free(networkflow->http_state->x_content_type_options);
  if(networkflow->http_state->transfer_encoding)
    ndpi_free(networkflow->http_state->transfer_encoding);
  if(networkflow->http_state->content_length)
    ndpi_free(networkflow->http_state->content_length);
  if(networkflow->http_state->upgrade)
    ndpi_free(networkflow->http_state->upgrade);
  if(networkflow->http_state->connection)
    ndpi_free(networkflow->http_state->connection);
  if(networkflow->http_state->proxy_connection)
    ndpi_free(networkflow->http_state->proxy_connection);
  if(networkflow->http_state->cache_control)
    ndpi_free(networkflow->http_state->cache_control);
  if(networkflow->http_state->pragma)
    ndpi_free(networkflow->http_state->pragma);
  if(networkflow->http_state->via)
    ndpi_free(networkflow->http_state->via);
  if(networkflow->http_state->warning)
    ndpi_free(networkflow->http_state->warning);
  if(networkflow->http_state->proxy_authorization)
    ndpi_free(networkflow->http_state->proxy_authorization);
  if(networkflow->http_state->proxy_authenticate)
    ndpi_free(networkflow->http_state->proxy_authenticate);
  if(networkflow->http_state->sec_websocket_key)
    ndpi_free(networkflow->http_state->sec_websocket_key);
  if(networkflow->http_state->sec_websocket_accept)
    ndpi_free(networkflow->http_state->sec_websocket_accept);
  if(networkflow->http_state->sec_websocket_protocol)
    ndpi_free(networkflow->http_state->sec_websocket_protocol);
  if(networkflow->http_state->sec_websocket_extensions)
    ndpi_free(networkflow->http_state->sec_websocket_extensions);
  if(networkflow->http_state->sec_websocket_version)
    ndpi_free(networkflow->http_state->sec_websocket_version);
  if(networkflow->http_state->sec_websocket_origin)
    ndpi_free(networkflow->http_state->sec_websocket_origin);
  if(networkflow->http_state->sec_websocket_location)
    ndpi_free(networkflow->http_state->sec_websocket_location);
  if(networkflow->http_state->sec_websocket_extensions_list)
    ndpi_free(networkflow->http_state->sec_websocket_extensions_list);
  if(networkflow->http_state->sec_websocket_protocol_list)
    ndpi_free(networkflow->http_state->sec_websocket_protocol_list);
  if(networkflow->http_state->sec_websocket_key_list)
    ndpi_free(networkflow->http_state->sec_websocket_key_list);
  if(networkflow->http_state->sec_websocket_accept_list)
    ndpi_free(networkflow->http_state->sec_websocket_accept_list);
  if(networkflow->http_state->sec_websocket_origin_list)
    ndpi_free(networkflow->http_state->sec_websocket_origin_list);
  if(networkflow->http_state->sec_websocket_location_list)
    ndpi_free(networkflow->http_state->sec_websocket_location_list);
  if(networkflow->http_state->sec_websocket_extensions_list_list)
    ndpi_free(networkflow->http_state->sec_websocket_extensions_list_list);
  if(networkflow->http_state->sec_websocket_protocol_list_list)
    ndpi_free(networkflow->http_state->sec_websocket_protocol_list_list);
  if(networkflow->http_state->sec_websocket_key_list_list)
    ndpi_free(networkflow->http_state->sec_websocket_key_list_list);
  if(networkflow->http_state->sec_websocket_accept_list_list)
    ndpi_free(networkflow->http_state->sec_websocket_accept_list_list);
  if(networkflow->http_state->sec_websocket_origin_list_list)
    ndpi_free(networkflow->http_state->sec_websocket_origin_list_list);
  if(networkflow->http_state->sec_websocket_location_list_list)
    ndpi_free(networkflow->http_state->sec_websocket_location_list_list);
  if(networkflow->http_state->x_frame_options)
    ndpi_free(networkflow->http_state->x_frame_options);
  if(networkflow->http_state->x_xss_protection)
    ndpi_free(networkflow->http_state->x_xss_protection);
  if(networkflow->http_state->x_content_security_policy)
    ndpi_free(networkflow->http_state->x_content_security_policy);
  if(networkflow->http_state->x_webkit_csp)
    ndpi_free(networkflow->http_state->x_webkit_csp);
  if(networkflow->http_state->x_download_options)
    ndpi_free(networkflow->http_state->x_download_options);
  if(networkflow->http_state->x_perm_frame_options)
    ndpi_free(networkflow->http_state->x_perm_frame_options);
  if(networkflow->http_state->x_content_type_options)
    ndpi_free(networkflow->http_state->x_content_type_options);
  if(networkflow->http_state->x_powered_by)
    ndpi_free(networkflow->http_state->x_powered_by);
  if(networkflow->http_state->x_generator)
    ndpi_free(networkflow->http_state->x_generator);
  if(networkflow->http_state->x_drupal_cache)
    ndpi_free(networkflow->http_state->x_drupal_cache);
  if(networkflow->http_state->x_varnish)
    ndpi_free(networkflow->http_state->x_varnish);
  if(networkflow->http_state->x_cache)
    ndpi_free(networkflow->http_state->x_cache);
  if(networkflow->http_state->x_cache_hit)
    ndpi_free(networkflow->http_state->x_cache_hit);
  if(networkflow->http_state->x_cache_miss)
    ndpi_free(networkflow->http_state->x_cache_miss);
  if(networkflow->http_state->x_cache_group)
    ndpi_free(networkflow->http_state->x_cache_group);
  if(networkflow->http_state->x_cache_key)
    ndpi_free(networkflow->http_state->x_cache_key);
  if(networkflow->http_state->x_cache_tag)
    ndpi_free(networkflow->http_state->x_cache_tag);
  if(networkflow->http_state->x_cache_hash)
    ndpi_free(networkflow->http_state->x_cache_hash);
  if(networkflow->http_state->x_cache_backend)
    ndpi_free(networkflow->http_state->x_cache_backend);
  if(networkflow->http_state->x_cache_invalidate)
    ndpi_free(networkflow->http_state->x_cache_invalidate);
  if(networkflow->http_state->x_cache_invalidate_key)
    ndpi_free(networkflow->http_state->x_cache_invalidate_key);
  if(networkflow->http_state->x_cache_invalidate_tag)
    ndpi_free(networkflow->http_state->x_cache_invalidate_tag);
  if(networkflow->http_state->x_cache_invalidate_hash)
    ndpi_free(networkflow->http_state->x_cache_invalidate_hash);
  if(networkflow->http_state->x_cache_invalidate_backend)
    ndpi_free(networkflow->http_state->x_cache_invalidate_backend);
  if(networkflow->http_state->x_cache_invalidate_url)
    ndpi_free(networkflow->http_state->x_cache_invalidate_url);
  if(networkflow->http_state->x_cache_invalidate_urls)
    ndpi_free(networkflow->http_state->x_cache_invalidate_urls);
  if(networkflow->http_state->x_cache_invalidate_regex)
    ndpi_free(networkflow->http_state->x_cache_invalidate_regex);
  if(networkflow->http_state->x_cache_invalidate_regexes)
    ndpi_free(networkflow->http_state->x_cache_invalidate_regexes);
  if(networkflow->http_state->x_cache_invalidate_wildcard)
    ndpi_free(networkflow->http_state->x_cache_invalidate_wildcard);
  if(networkflow->http_state->x_cache_invalidate_wildcards)
    ndpi_free(networkflow->http_state->x_cache_invalidate_wildcards);
  if(networkflow->http_state->x_cache_invalidate_method)
    ndpi_free(networkflow->http_state->x_cache_invalidate_method);
  if(networkflow->http_state->x_cache_invalidate_methods)
    ndpi_free(networkflow->http_state->x_cache_invalidate_methods);
  if(networkflow->http_state->x_cache_invalidate_status)
    ndpi_free(networkflow->http_state->x_cache_invalidate_status);
  if(networkflow->http_state->x_cache_invalidate_statuses)
    ndpi_free(networkflow->http_state->x_cache_invalidate_statuses);
  if(networkflow->http_state->x_cache_invalidate_header)
    ndpi_free(networkflow->http_state->x_cache_invalidate_header);
  if(networkflow->http_state->x_cache_invalidate_headers)
    ndpi_free(networkflow->http_state->x_cache_invalidate_headers);
  if(networkflow->http_state->x_cache_invalidate_query)
    ndpi_free(networkflow->http_state->x_cache_invalidate_query);
  if(networkflow->http_state->x_cache_invalidate_queries)
    ndpi_free(networkflow->http_state->x_cache_invalidate_queries);
  if(networkflow->http_state->x_cache_invalidate_fragment)
    ndpi_free(networkflow->http_state->x_cache_invalidate_fragment);
  if(networkflow->http_state->x_cache_invalidate_fragments)
    ndpi_free(networkflow->http_state->x_cache_invalidate_fragments);
  if(networkflow->http_state->x_cache_invalidate_scheme)
    ndpi_free(networkflow->http_state->x_cache_invalidate_scheme);
  if(networkflow->http_state->x_cache_invalidate_schemes)
    ndpi_free(networkflow->http_state->x_cache_invalidate_schemes);
  if(networkflow->http_state->x_cache_invalidate_host)
    ndpi_free(networkflow->http_state->x_cache_invalidate_host);
  if(networkflow->http_state->x_cache_invalidate_hosts)
    ndpi_free(networkflow->http_state->x_cache_invalidate_hosts);
  if(networkflow->http_state->x_cache_invalidate_port)
    ndpi_free(networkflow->http_state->x_cache_invalidate_port);
  if(networkflow->http_state->x_cache_invalidate_ports)
    ndpi_free(networkflow->http_state->x_cache_invalidate_ports);
  if(networkflow->http_state->x_cache_invalidate_path)
    ndpi_free(networkflow->http_state->x_cache_invalidate_path);
  if(networkflow->http_state->x_cache_invalidate_paths)
    ndpi_free(networkflow->http_state->x_cache_invalidate_paths);
  if(networkflow->http_state->x_cache_invalidate_extension)
    ndpi_free(networkflow->http_state->x_cache_invalidate_extension);
  if(networkflow->http_state->x_cache_invalidate_extensions)
    ndpi_free(networkflow->http_state->x_cache_invalidate_extensions);
  if(networkflow->http_state->x_cache_invalidate_device)
    ndpi_free(networkflow->http_state->x_cache_invalidate_device);
  if(networkflow->http_state->x_cache_invalidate_devices)
    ndpi_free(networkflow->http_state->x_cache_invalidate_devices);
  if(networkflow->http_state->x_cache_invalidate_user_agent)
    ndpi_free(networkflow->http_state->x_cache_invalidate_user_agent);
  if(networkflow->http_state->x_cache_invalidate_user_agents)
    ndpi_free(networkflow->http_state->x_cache_invalidate_user_agents);
  if(networkflow->http_state->x_cache_invalidate_referer)
    ndpi_free(networkflow->http_state->x_cache_invalidate_referer);
  if(networkflow->http_state->x_cache_invalidate_referrers)
    ndpi_free(networkflow->http_state->x_cache_invalidate_referrers);
  if(networkflow->http_state->x_cache_invalidate_accept)
    ndpi_free(networkflow->http_state->x_cache_invalidate_accept);
  if(networkflow->http_state->x_cache_invalidate_accepts)
    ndpi_free(networkflow->http_state->x_cache_invalidate_accepts);
  if(networkflow->http_state->x_cache_invalidate_accept_language)
    ndpi_free(networkflow->http_state->x_cache_invalidate_accept_language);
  if(networkflow->http_state->x_cache_invalidate_accept_languages)
    ndpi_free(networkflow->http_state->x_cache_invalidate_accept_languages);
  if(networkflow->http_state->x_cache_invalidate_accept_encoding)
    n