if (networkflow->l4_proto == IPPROTO_TCP) {
      if (networkflow->l4.tcp.tls.message.buffer) {
        ndpi_free(networkflow->l4.tcp.tls.message.buffer);
        networkflow->l4.tcp.tls.message.buffer = NULL;
      }
      if (networkflow->l4.tcp.tls.sni) {
        ndpi_free(networkflow->l4.tcp.tls.sni);
        networkflow->l4.tcp.tls.sni = NULL;
      }
      if (networkflow->l4.tcp.tls.alpn) {
        ndpi_free(networkflow->l4.tcp.tls.alpn);
        networkflow->l4.tcp.tls.alpn = NULL;
      }
      if (networkflow->l4.tcp.tls.ja3) {
        ndpi_free(networkflow->l4.tcp.tls.ja3);
        networkflow->l4.tcp.tls.ja3 = NULL;
      }
    } else if (networkflow->l4_proto == IPPROTO_UDP) {
      if (networkflow->l4.udp.quic.server_name) {
        ndpi_free(networkflow->l4.udp.quic.server_name);
        networkflow->l4.udp.quic.server_name = NULL;
      }
    }