if(networkflow->http_state) {
  if(networkflow->http_state->host_server_name)
    ndpi_free(networkflow->http_state->host_server_name);
  if(networkflow->http_state->host_server_name_len)
    ndpi_free(networkflow->http_state->host_server_name_len);
  if(networkflow->http_state->host_server_ip)
    ndpi_free(networkflow->http_state->host_server_ip);
  if(networkflow->http_state->host_server_ip_len)
    ndpi_free(networkflow->http_state->host_server_ip_len);
  if(networkflow->http_state->request_url)
    ndpi_free(networkflow->http_state->request_url);
  if(networkflow->http_state->request_url_len)
    ndpi_free(networkflow->http_state->request_url_len);
  if(networkflow->http_state->request_method)
    ndpi_free(networkflow->http_state->request_method);
  if(networkflow->http_state->request_method_len)
    ndpi_free(networkflow->http_state->request_method_len);
  if(networkflow->http_state->request_http_version)
    ndpi_free(networkflow->http_state->request_http_version);
  if(networkflow->http_state->request_http_version_len)
    ndpi_free(networkflow->http_state->request_http_version_len);
  if(networkflow->http_state->request_cookie)
    ndpi_free(networkflow->http_state->request_cookie);
  if(networkflow->http_state->request_cookie_len)
    ndpi_free(networkflow->http_state->request_cookie_len);
  if(networkflow->http_state->request_user_agent)
    ndpi_free(networkflow->http_state->request_user_agent);
  if(networkflow->http_state->request_user_agent_len)
    ndpi_free(networkflow->http_state->request_user_agent_len);
  if(networkflow->http_state->request_accept)
    ndpi_free(networkflow->http_state->request_accept);
  if(networkflow->http_state->request_accept_len)
    ndpi_free(networkflow->http_state->request_accept_len);
  if(networkflow->http_state->request_accept_language)
    ndpi_free(networkflow->http_state->request_accept_language);
  if(networkflow->http_state->request_accept_language_len)
    ndpi_free(networkflow->http_state->request_accept_language_len);
  if(networkflow->http_state->request_accept_encoding)
    ndpi_free(networkflow->http_state->request_accept_encoding);
  if(networkflow->http_state->request_accept_encoding_len)
    ndpi_free(networkflow->http_state->request_accept_encoding_len);
  if(networkflow->http_state->request_connection)
    ndpi_free(networkflow->http_state->request_connection);
  if(networkflow->http_state->request_connection_len)
    ndpi_free(networkflow->http_state->request_connection_len);
  if(networkflow->http_state->request_referer)
    ndpi_free(networkflow->http_state->request_referer);
  if(networkflow->http_state->request_referer_len)
    ndpi_free(networkflow->http_state->request_referer_len);
  if(networkflow->http_state->request_x_forwarded_for)
    ndpi_free(networkflow->http_state->request_x_forwarded_for);
  if(networkflow->http_state->request_x_forwarded_for_len)
    ndpi_free(networkflow->http_state->request_x_forwarded_for_len);
  if(networkflow->http_state->response_status_code)
    ndpi_free(networkflow->http_state->response_status_code);
  if(networkflow->http_state->response_status_code_len)
    ndpi_free(networkflow->http_state->response_status_code_len);
  if(networkflow->http_state->response_status_line)
    ndpi_free(networkflow->http_state->response_status_line);
  if(networkflow->http_state->response_status_line_len)
    ndpi_free(networkflow->http_state->response_status_line_len);
  if(networkflow->http_state->response_server)
    ndpi_free(networkflow->http_state->response_server);
  if(networkflow->http_state->response_server_len)
    ndpi_free(networkflow->http_state->response_server_len);
  if(networkflow->http_state->response_content_type)
    ndpi_free(networkflow->http_state->response_content_type);
  if(networkflow->http_state->response_content_type_len)
    ndpi_free(networkflow->http_state->response_content_type_len);
  if(networkflow->http_state->response_transfer_encoding)
    ndpi_free(networkflow->http_state->response_transfer_encoding);
  if(networkflow->http_state->response_transfer_encoding_len)
    ndpi_free(networkflow->http_state->response_transfer_encoding_len);
  if(networkflow->http_state->response_content_length)
    ndpi_free(networkflow->http_state->response_content_length);
  if(networkflow->http_state->response_content_length_len)
    ndpi_free(networkflow->http_state->response_content_length_len);
  if(networkflow->http_state->response_location)
    ndpi_free(networkflow->http_state->response_location);
  if(networkflow->http_state->response_location_len)
    ndpi_free(networkflow->http_state->response_location_len);
  if(networkflow->http_state->response_set_cookie)
    ndpi_free(networkflow->http_state->response_set_cookie);
  if(networkflow->http_state->response_set_cookie_len)
    ndpi_free(networkflow->http_state->response_set_cookie_len);
  if(networkflow->http_state->response_x_frame_options)
    ndpi_free(networkflow->http_state->response_x_frame_options);
  if(networkflow->http_state->response_x_frame_options_len)
    ndpi_free(networkflow->http_state->response_x_frame_options_len);
  if(networkflow->http_state->response_x_content_type_options)
    ndpi_free(networkflow->http_state->response_x_content_type_options);
  if(networkflow->http_state->response_x_content_type_options_len)
    ndpi_free(networkflow->http_state->response_x_content_type_options_len);
  if(networkflow->http_state->response_x_xss_protection)
    ndpi_free(networkflow->http_state->response_x_xss_protection);
  if(networkflow->http_state->response_x_xss_protection_len)
    ndpi_free(networkflow->http_state->response_x_xss_protection_len);
  if(networkflow->http_state->response_x_powered_by)
    ndpi_free(networkflow->http_state->response_x_powered_by);
  if(networkflow->http_state->response_x_powered_by_len)
    ndpi_free(networkflow->http_state->response_x_powered_by_len);
  if(networkflow->http_state->response_x_ua_compatible)
    ndpi_free(networkflow->http_state->response_x_ua_compatible);
  if(networkflow->http_state->response_x_ua_compatible_len)
    ndpi_free(networkflow->http_state->response_x_ua_compatible_len);
  if(networkflow->http_state->response_x_download_options)
    ndpi_free(networkflow->http_state->response_x_download_options);
  if(networkflow->http_state->response_x_download_options_len)
    ndpi_free(networkflow->http_state->response_x_download_options_len);
  if(networkflow->http_state->response_x_content_security_policy)
    ndpi_free(networkflow->http_state->response_x_content_security_policy);
  if(networkflow->http_state->response_x_content_security_policy_len)
    ndpi_free(networkflow->http_state->response_x_content_security_policy_len);
  if(networkflow->http_state->response_x_webkit_csp)
    ndpi_free(networkflow->http_state->response_x_webkit_csp);
  if(networkflow->http_state->response_x_webkit_csp_len)
    ndpi_free(networkflow->http_state->response_x_webkit_csp_len);
  if(networkflow->http_state->response_x_frame_options_csp)
    ndpi_free(networkflow->http_state->response_x_frame_options_csp);
  if(networkflow->http_state->response_x_frame_options_csp_len)
    ndpi_free(networkflow->http_state->response_x_frame_options_csp_len);
  if(networkflow->http_state->response_x_xss_protection_csp)
    ndpi_free(networkflow->http_state->response_x_xss_protection_csp);
  if(networkflow->http_state->response_x_xss_protection_csp_len)
    ndpi_free(networkflow->http_state->response_x_xss_protection_csp_len);
  if(networkflow->http_state->response_x_content_security_policy_report_only)
    ndpi_free(networkflow->http_state->response_x_content_security_policy_report_only);
  if(networkflow->http_state->response_x_content_security_policy_report_only_len)
    ndpi_free(networkflow->http_state->response_x_content_security_policy_report_only_len);
  if(networkflow->http_state->response_x_webkit_csp_report_only)
    ndpi_free(networkflow->http_state->response_x_webkit_csp_report_only);
  if(networkflow->http_state->response_x_webkit_csp_report_only_len)
    ndpi_free(networkflow->http_state->response_x_webkit_csp_report_only_len);
  if(networkflow->http_state->response_x_frame_options_report_only)
    ndpi_free(networkflow->http_state->response_x_frame_options_report_only);
  if(networkflow->http_state->response_x_frame_options_report_only_len)
    ndpi_free(networkflow->http_state->response_x_frame_options_report_only_len);
  if(networkflow->http_state->response_x_xss_protection_report_only)
    ndpi_free(networkflow->http_state->response_x_xss_protection_report_only);
  if(networkflow->http_state->response_x_xss_protection_report_only_len)
    ndpi_free(networkflow->http_state->response_x_xss_protection_report_only_len);
  if(networkflow->http_state->response_x_download_options_report_only)
    ndpi_free(networkflow->http_state->response_x_download_options_report_only);
  if(networkflow->http_state->response_x_download_options_report_only_len)
    ndpi_free(networkflow->http_state->response_x_download_options_report_only_len);
  if(networkflow->http_state->response_x_content_security_policy_report_only_len)
    ndpi_free(networkflow->http_state->response_x_content_security_policy_report_only_len);
  if(networkflow->http_state->response_x_webkit_csp_report_only_len)
    ndpi_free(networkflow->http_state->response_x_webkit_csp_report_only_len);
  if(networkflow->http_state->response_x_frame_options_report_only_len)
    ndpi_free(networkflow->http_state->response_x_frame_options_report_only_len);
  if(networkflow->http_state->response_x_xss_protection_report_only_len)
    ndpi_free(networkflow->http_state->response_x_xss_protection_report_only_len);
  if(networkflow->http_state->response_x_download_options_report_only_len)
    ndpi_free(networkflow->http_state->response_x_download_options_report_only_len);
  if(networkflow->http_state->response_x_content_security_policy_report_only_len)
    ndpi_free(networkflow->http_state->response_x_content_security_policy_report_only_len);
  if(networkflow->http_state->response_x_webkit_csp_report_only_len)
    ndpi_free(networkflow->http_state->response_x_webkit_csp_report_only_len);
  if(networkflow->http_state->response_x_frame_options_report_only_len)
    ndpi_free(networkflow->http_state->response_x_frame_options_report_only_len);
  if(networkflow->http_state->response_x_xss_protection_report_only_len)
    ndpi_free(networkflow->http_state->response_x_xss_protection_report_only_len);
  if(networkflow->http_state->response_x_download_options_report_only_len)
    ndpi_free(networkflow->http_state->response_x_download_options_report_only_len);
  if(networkflow->http_state->response_x_content_security_policy_report_only_len)
    ndpi_free(networkflow->http_state->response_x_content_security_policy_report_only_len);
  if(networkflow->http_state->response_x_webkit_csp_report_only_len)
    ndpi_free(networkflow->http_state->response_x_webkit_csp_report_only_len);
  if(networkflow->http_state->response_x_frame_options_report_only_len)
    ndpi_free(networkflow->http_state->response_x_frame_options_report_only_len);
  if(networkflow->http_state->response_x_xss_protection_report_only_len)
    ndpi_free(networkflow->http_state->response_x_xss_protection_report_only_len);
  if(networkflow->http_state->response_x_download_options_report_only_len)
    ndpi_free(networkflow->http_state->response_x_download_options_report_only_len);
  if(networkflow->http_state->response_x_content_security_policy_report_only_len)
    ndpi_free(networkflow->http_state->response_x_content_security_policy_report_only_len);
  if(networkflow->http_state->response_x_webkit_csp_report_only_len)
    ndpi_free(networkflow->http_state->response_x_webkit_csp_report_only_len);
  if(networkflow->http_state->response_x_frame_options_report_only_len)
    ndpi_free(networkflow->http_state->response_x_frame_options_report_only_len);
  if(networkflow->http_state->response_x_xss_protection_report_only_len)
    ndpi_free(networkflow->http_state->response_x_xss_protection_report_only_len);
  if(networkflow->http_state->response_x_download_options_report_only_len)
    ndpi_free(networkflow->http_state->response_x_download_options_report_only_len);
  if(networkflow->http_state->response_x_content_security_policy_report_only_len)
    ndpi_free(networkflow->http_state->response_x_content_security_policy_report_only_len);
  if(networkflow->http_state->response_x_webkit_csp_report_only_len)
    ndpi_free(networkflow->http_state->response_x_webkit_csp_report_only_len);
  if(networkflow->http_state->response_x_frame_options_report_only_len)
    ndpi_free(networkflow->http_state->response_x_frame_options_report_only_len);
  if(networkflow->http_state->response_x_xss_protection_report_only_len)
    ndpi_free(networkflow->http_state->response_x_xss_protection_report_only_len);
  if(networkflow->http_state->response_x_download_options_report_only_len)
    ndpi_free(networkflow->http_state->response_x_download_options_report_only_len);
  if(networkflow->http_state->response_x_content_security_policy_report_only_len)
    ndpi_free(networkflow->http_state->response_x_content_security_policy_report_only_len);
  if(networkflow->http_state->response_x_webkit_csp_report_only_len)
    ndp