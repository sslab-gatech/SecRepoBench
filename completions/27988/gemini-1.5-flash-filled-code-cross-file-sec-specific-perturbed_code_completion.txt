if(networkflow->l4_proto == IPPROTO_TCP) {
      if(networkflow->l4.tcp.tls.message.buffer)
	ndpi_free(networkflow->l4.tcp.tls.message.buffer);
      if(networkflow->l4.tcp.tls.server_name)
	ndpi_free(networkflow->l4.tcp.tls.server_name);
      if(networkflow->l4.tcp.tls.sni)
	ndpi_free(networkflow->l4.tcp.tls.sni);
      if(networkflow->l4.tcp.tls.session_id)
	ndpi_free(networkflow->l4.tcp.tls.session_id);
      if(networkflow->l4.tcp.tls.ja3_hash)
        ndpi_free(networkflow->l4.tcp.tls.ja3_hash);
      if(networkflow->l4.tcp.tls.ja3_hash_str)
        ndpi_free(networkflow->l4.tcp.tls.ja3_hash_str);
      if(networkflow->l4.tcp.quic.tls.message.buffer)
	ndpi_free(networkflow->l4.tcp.quic.tls.message.buffer);
      if(networkflow->l4.tcp.quic.tls.server_name)
	ndpi_free(networkflow->l4.tcp.quic.tls.server_name);
      if(networkflow->l4.tcp.quic.tls.sni)
	ndpi_free(networkflow->l4.tcp.quic.tls.sni);
      if(networkflow->l4.tcp.quic.tls.session_id)
	ndpi_free(networkflow->l4.tcp.quic.tls.session_id);
      if(networkflow->l4.tcp.quic.tls.ja3_hash)
        ndpi_free(networkflow->l4.tcp.quic.tls.ja3_hash);
      if(networkflow->l4.tcp.quic.tls.ja3_hash_str)
        ndpi_free(networkflow->l4.tcp.quic.tls.ja3_hash_str);

    }
    if(networkflow->l4_proto == IPPROTO_UDP && networkflow->l4.udp.dtls.message.buffer)
      ndpi_free(networkflow->l4.udp.dtls.message.buffer);