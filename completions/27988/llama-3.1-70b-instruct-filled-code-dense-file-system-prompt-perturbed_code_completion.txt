if(networkflow->protocol == NDPI_PROTOCOL_HTTP) {
  if(networkflow->http.host)
    ndpi_free(networkflow->http.host);
  if(networkflow->http.url)
    ndpi_free(networkflow->http.url);
  if(networkflow->http.user_agent)
    ndpi_free(networkflow->http.user_agent);
  if(networkflow->http.xff)
    ndpi_free(networkflow->http.xff);
  if(networkflow->http.referer)
    ndpi_free(networkflow->http.referer);
  if(networkflow->http.method)
    ndpi_free(networkflow->http.method);
}

if(networkflow->protocol == NDPI_PROTOCOL_TLS || networkflow->protocol == NDPI_PROTOCOL_QUIC) {
  if(networkflow->l4.tcp.tls.server_name)
    ndpi_free(networkflow->l4.tcp.tls.server_name);
  if(networkflow->l4.tcp.tls.alpn)
    ndpi_free(networkflow->l4.tcp.tls.alpn);
  if(networkflow->l4.tcp.tls.issuerDN)
    ndpi_free(networkflow->l4.tcp.tls.issuerDN);
  if(networkflow->l4.tcp.tls.subjectDN)
    ndpi_free(networkflow->l4.tcp.tls.subjectDN);
  if(networkflow->l4.tcp.tls.supported_versions)
    ndpi_free(networkflow->l4.tcp.tls.supported_versions);
  if(networkflow->l4.tcp.tls.encrypted_sni.esni)
    ndpi_free(networkflow->l4.tcp.tls.encrypted_sni.esni);
}