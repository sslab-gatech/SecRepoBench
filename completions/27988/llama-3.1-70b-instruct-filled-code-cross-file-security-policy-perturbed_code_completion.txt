if(networkflow->detected_protocol == NDPI_PROTOCOL_TLS) {
  if(networkflow->l4_proto == IPPROTO_TCP) {
    if(networkflow->l4.tcp.tls.message.buffer)
      ndpi_free(networkflow->l4.tcp.tls.message.buffer);
  } else if(networkflow->l4_proto == IPPROTO_UDP) {
    if(networkflow->l4.udp.tls.message.buffer)
      ndpi_free(networkflow->l4.udp.tls.message.buffer);
  }
} else if(networkflow->detected_protocol == NDPI_PROTOCOL_QUIC) {
  if(networkflow->l4_proto == IPPROTO_UDP) {
    if(networkflow->l4.udp.quic.message.buffer)
      ndpi_free(networkflow->l4.udp.quic.message.buffer);
  }
}