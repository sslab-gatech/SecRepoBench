if (networkflow->proto == NDPI_PROTOCOL_TLS || networkflow->proto == NDPI_PROTOCOL_QUIC) {
      int is_quic = (networkflow->proto == NDPI_PROTOCOL_QUIC);
      if (is_quic) {
        // Free QUIC-specific memory if necessary
        if (networkflow->l4.quic.data) {
          ndpi_free(networkflow->l4.quic.data);
          networkflow->l4.quic.data = NULL;
        }
      } else {
        // Free TLS-specific memory if necessary
        if (networkflow->l4.tcp.tls.message.buffer) {
          ndpi_free(networkflow->l4.tcp.tls.message.buffer);
          networkflow->l4.tcp.tls.message.buffer = NULL;
        }
        if (networkflow->l4.tcp.tls.sni) {
          ndpi_free(networkflow->l4.tcp.tls.sni);
          networkflow->l4.tcp.tls.sni = NULL;
        }
        if (networkflow->l4.tcp.tls.session_id) {
          ndpi_free(networkflow->l4.tcp.tls.session_id);
          networkflow->l4.tcp.tls.session_id = NULL;
        }
      }
    }

    if (networkflow->http_data) {
      ndpi_free(networkflow->http_data);
      networkflow->http_data = NULL;
    }
    if (networkflow->http_header) {
      ndpi_free(networkflow->http_header);
      networkflow->http_header = NULL;
    }
    if (networkflow->http_body) {
      ndpi_free(networkflow->http_body);
      networkflow->http_body = NULL;
    }
    if (networkflow->dns_data) {
      ndpi_free(networkflow->dns_data);
      networkflow->dns_data = NULL;
    }
    if (networkflow->smtp_data) {
      ndpi_free(networkflow->smtp_data);
      networkflow->smtp_data = NULL;
    }
    if (networkflow->ftp_data) {
      ndpi_free(networkflow->ftp_data);
      networkflow->ftp_data = NULL;
    }
    if (networkflow->sip_data) {
      ndpi_free(networkflow->sip_data);
      networkflow->sip_data = NULL;
    }
    if (networkflow->mqtt_data) {
      ndpi_free(networkflow->mqtt_data);
      networkflow->mqtt_data = NULL;
    }
    if (networkflow->mysql_data) {
      ndpi_free(networkflow->mysql_data);
      networkflow->mysql_data = NULL;
    }
    if (networkflow->redis_data) {
      ndpi_free(networkflow->redis_data);
      networkflow->redis_data = NULL;
    }
    if (networkflow->memcached_data) {
      ndpi_free(networkflow->memcached_data);
      networkflow->memcached_data = NULL;
    }
    if (networkflow->kafka_data) {
      ndpi_free(networkflow->kafka_data);
      networkflow->kafka_data = NULL;
    }
    if (networkflow->amqp_data) {
      ndpi_free(networkflow->amqp_data);
      networkflow->amqp_data = NULL;
    }
    if (networkflow->smb_data) {
      ndpi_free(networkflow->smb_data);
      networkflow->smb_data = NULL;
    }
    if (networkflow->mssql_data) {
      ndpi_free(networkflow->mssql_data);
      networkflow->mssql_data = NULL;
    }
    if (networkflow->postgresql_data) {
      ndpi_free(networkflow->postgresql_data);
      networkflow->postgresql_data = NULL;
    }
    if (networkflow->oracle_data) {
      ndpi_free(networkflow->oracle_data);
      networkflow->oracle_data = NULL;
    }
    if (networkflow->mongodb_data) {
      ndpi_free(networkflow->mongodb_data);
      networkflow->mongodb_data = NULL;
    }
    if (networkflow->cassandra_data) {
      ndpi_free(networkflow->cassandra_data);
      networkflow->cassandra_data = NULL;
    }
    if (networkflow->zookeeper_data) {
      ndpi_free(networkflow->zookeeper_data);
      networkflow->zookeeper_data = NULL;
    }
    if (networkflow->kafka_data) {
      ndpi_free(networkflow->kafka_data);
      networkflow->kafka_data = NULL;
    }
    if (networkflow->grpc_data) {
      ndpi_free(networkflow->grpc_data);
      networkflow->grpc_data = NULL;
    }