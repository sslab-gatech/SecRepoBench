if(networkflow->http.url) ndpi_free(networkflow->http.url);
if(networkflow->http.content_type) ndpi_free(networkflow->http.content_type);
if(networkflow->http.user_agent) ndpi_free(networkflow->http.user_agent);

int is_quic = (networkflow->detected_protocol_stack[0] == NDPI_PROTOCOL_QUIC);
int is_tls = (networkflow->detected_protocol_stack[0] == NDPI_PROTOCOL_TLS);

if(is_tls || is_quic) {
  if(networkflow->protos.stun_ssl.ssl.client_certificate) 
    ndpi_free(networkflow->protos.stun_ssl.ssl.client_certificate);
  if(networkflow->protos.stun_ssl.ssl.server_certificate) 
    ndpi_free(networkflow->protos.stun_ssl.ssl.server_certificate);
  if(networkflow->protos.stun_ssl.ssl.server_organization) 
    ndpi_free(networkflow->protos.stun_ssl.ssl.server_organization);
  if(networkflow->protos.stun_ssl.ssl.ja3_client) 
    ndpi_free(networkflow->protos.stun_ssl.ssl.ja3_client);
  if(networkflow->protos.stun_ssl.ssl.ja3_server) 
    ndpi_free(networkflow->protos.stun_ssl.ssl.ja3_server);
}

if(is_quic) {
  if(networkflow->protos.stun_ssl.ssl.quic_reasm_buf) 
    ndpi_free(networkflow->protos.stun_ssl.ssl.quic_reasm_buf);
}