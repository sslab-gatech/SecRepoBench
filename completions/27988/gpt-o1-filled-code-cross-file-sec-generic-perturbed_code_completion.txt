if(networkflow->detected_protocol == NDPI_PROTOCOL_HTTP) {
  if(networkflow->protos.http.host) {
    ndpi_free(networkflow->protos.http.host);
    networkflow->protos.http.host = NULL;
  }
  if(networkflow->protos.http.url) {
    ndpi_free(networkflow->protos.http.url);
    networkflow->protos.http.url = NULL;
  }
  if(networkflow->protos.http.user_agent) {
    ndpi_free(networkflow->protos.http.user_agent);
    networkflow->protos.http.user_agent = NULL;
  }
}

if(networkflow->detected_protocol == NDPI_PROTOCOL_TLS ||
   networkflow->detected_protocol == NDPI_PROTOCOL_QUIC) {
  /*
    Free any additional SSL/TLS-related fields here if they were dynamically
    allocated above and have not yet been deallocated.
  */
}