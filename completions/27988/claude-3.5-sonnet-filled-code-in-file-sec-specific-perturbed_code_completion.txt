if(networkflow->http.url) {
  ndpi_free(networkflow->http.url);
  networkflow->http.url = NULL;
}

if(networkflow->http.content_type) {
  ndpi_free(networkflow->http.content_type);
  networkflow->http.content_type = NULL;
}

if(networkflow->http.user_agent) {
  ndpi_free(networkflow->http.user_agent);
  networkflow->http.user_agent = NULL;
}

if(networkflow->kerberos_buf.pktbuf) {
  ndpi_free(networkflow->kerberos_buf.pktbuf);
  networkflow->kerberos_buf.pktbuf = NULL;
}

if(networkflow->l4_proto == IPPROTO_TCP || networkflow->l4_proto == IPPROTO_UDP) {
  if(networkflow->protos.stun_ssl.ssl.client_certificate) {
    ndpi_free(networkflow->protos.stun_ssl.ssl.client_certificate);
    networkflow->protos.stun_ssl.ssl.client_certificate = NULL;
  }
  
  if(networkflow->protos.stun_ssl.ssl.server_certificate) {
    ndpi_free(networkflow->protos.stun_ssl.ssl.server_certificate);
    networkflow->protos.stun_ssl.ssl.server_certificate = NULL;
  }
}

if(networkflow->packet.custom_fields) {
  ndpi_free(networkflow->packet.custom_fields);
  networkflow->packet.custom_fields = NULL;
}