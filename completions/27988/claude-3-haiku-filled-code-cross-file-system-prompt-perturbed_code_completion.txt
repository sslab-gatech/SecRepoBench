// Free memory allocated for HTTP related fields in the flow structure.
if(networkflow->http.url)
    ndpi_free(networkflow->http.url);
if(networkflow->http.content_type)
    ndpi_free(networkflow->http.content_type);
if(networkflow->http.server)
    ndpi_free(networkflow->http.server);
if(networkflow->http.user_agent)
    ndpi_free(networkflow->http.user_agent);
if(networkflow->http.referer)
    ndpi_free(networkflow->http.referer);

// If the protocol is TLS or QUIC, free memory allocated for SSL-related fields.
if(networkflow->l4_proto == IPPROTO_TCP && networkflow->detected_protocol_stack[0] == NDPI_PROTOCOL_TLS) {
    if(networkflow->protos.stun_ssl.ssl.client_certificate)
        ndpi_free(networkflow->protos.stun_ssl.ssl.client_certificate);
    if(networkflow->protos.stun_ssl.ssl.server_certificate)
        ndpi_free(networkflow->protos.stun_ssl.ssl.server_certificate);
    if(networkflow->protos.stun_ssl.ssl.alpn)
        ndpi_free(networkflow->protos.stun_ssl.ssl.alpn);
    if(networkflow->protos.stun_ssl.ssl.server_names)
        ndpi_free(networkflow->protos.stun_ssl.ssl.server_names);
}

// Ensure that all dynamically allocated fields in the flow are properly deallocated
// before freeing the flow structure itself.
ndpi_free(networkflow);