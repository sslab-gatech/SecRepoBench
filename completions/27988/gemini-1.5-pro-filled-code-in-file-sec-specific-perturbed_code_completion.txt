if(networkflow->http.url) {
      ndpi_free(networkflow->http.url);
      networkflow->http.url = NULL;
    }
    if(networkflow->http.content_type) {
      ndpi_free(networkflow->http.content_type);
      networkflow->http.content_type = NULL;
    }
    if(networkflow->http.user_agent) {
      ndpi_free(networkflow->http.user_agent);
      networkflow->http.user_agent = NULL;
    }
    if(networkflow->kerberos_buf.pktbuf) {
      ndpi_free(networkflow->kerberos_buf.pktbuf);
      networkflow->kerberos_buf.pktbuf = NULL;
    }

    if(flow_is_proto(networkflow, NDPI_PROTOCOL_TLS) || flow_is_proto(networkflow, NDPI_PROTOCOL_QUIC)) {
      if(networkflow->l4.tcp.tls.sni.cache_key_size > 0) {
	ndpi_free(networkflow->l4.tcp.tls.sni.cache_key);
	networkflow->l4.tcp.tls.sni.cache_key = NULL;
	networkflow->l4.tcp.tls.sni.cache_key_size = 0;
      }
      if(networkflow->l4.tcp.tls.ja3_str.cache_key_size > 0) {
	ndpi_free(networkflow->l4.tcp.tls.ja3_str.cache_key);
	networkflow->l4.tcp.tls.ja3_str.cache_key = NULL;
	networkflow->l4.tcp.tls.ja3_str.cache_key_size = 0;
      }
      if(networkflow->l4.tcp.tls.ja3_fp) {
	ndpi_free(networkflow->l4.tcp.tls.ja3_fp);
	networkflow->l4.tcp.tls.ja3_fp = NULL;
      }
      if(networkflow->l4.tcp.tls.alpn_str) {
	ndpi_free(networkflow->l4.tcp.tls.alpn_str);
	networkflow->l4.tcp.tls.alpn_str = NULL;
      }
    }