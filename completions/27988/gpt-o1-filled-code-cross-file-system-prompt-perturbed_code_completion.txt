/* Free memory allocated for HTTP-related fields (if any) */
if(networkflow->protos.http.url) {
  ndpi_free(networkflow->protos.http.url);
  networkflow->protos.http.url = NULL;
}
if(networkflow->protos.http.host_server_name) {
  ndpi_free(networkflow->protos.http.host_server_name);
  networkflow->protos.http.host_server_name = NULL;
}
if(networkflow->protos.http.user_agent) {
  ndpi_free(networkflow->protos.http.user_agent);
  networkflow->protos.http.user_agent = NULL;
}
if(networkflow->protos.http.referer) {
  ndpi_free(networkflow->protos.http.referer);
  networkflow->protos.http.referer = NULL;
}

/* If the protocol is TLS or QUIC over UDP (DTLS/QUIC), free SSL-related fields */
if(networkflow->l4_proto == IPPROTO_UDP) {
  /* Adjust the structure access below if QUIC/DTLS is stored differently in your code */
  if(networkflow->l4.udp.tls.message.buffer) {
    ndpi_free(networkflow->l4.udp.tls.message.buffer);
    networkflow->l4.udp.tls.message.buffer = NULL;
  }
}