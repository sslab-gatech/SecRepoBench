// Free memory allocated for HTTP-related fields
    if (networkflow->http.url) {
      ndpi_free(networkflow->http.url);
      networkflow->http.url = NULL;
    }
    if (networkflow->http.content_type) {
      ndpi_free(networkflow->http.content_type);
      networkflow->http.content_type = NULL;
    }
    if (networkflow->http.user_agent) {
      ndpi_free(networkflow->http.user_agent);
      networkflow->http.user_agent = NULL;
    }

    // Free memory allocated for SSL-related fields if protocol is TLS or QUIC
    if (networkflow->l4_proto == IPPROTO_TCP || networkflow->l4_proto == IPPROTO_UDP) {
      if (networkflow->l4.tcp.tls.message.buffer) {
        ndpi_free(networkflow->l4.tcp.tls.message.buffer);
        networkflow->l4.tcp.tls.message.buffer = NULL;
      }
    }