ETH_P_MPLS_MULTI:
  network_flow->stats.mpls_count++;
  type = ETH_P_IP;
  
  // Start iterating through MPLS labels
  u_int32_t label;
  u_int8_t bos; // Bottom of Stack bit
  do {
    if((ip_offset + 4) > header->caplen)
      return(nproto); // Ensure we have enough data
      
    // Extract MPLS header to the union
    mpls.u32 = ntohl(*((u_int32_t *) &packet[ip_offset]));
    
    // Update IP offset to move past this label
    ip_offset += 4;
    
    // Get the Bottom of Stack bit (bit 8 from the right, after 20-bit label and 3-bit TC)
    bos = (mpls.mpls.s == 1);
    
    // Get the label value for debugging or logging if needed
    label = mpls.mpls.label;
  } while(!bos); // Continue until we reach the bottom of the stack
  
  recheck_type = 1;
  break;