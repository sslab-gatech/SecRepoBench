case ETH_P_MPLS_UNI:
case ETH_P_MPLS_MULTI:
  // Handle MPLS (Multiprotocol Label Switching) packets with multiple labels.
  // - Extract and convert MPLS labels from network to host byte order.
  // - Update the MPLS packet count in the workflow statistics.
  // - Set the packet type to IP and adjust the IP offset past the MPLS header.
  // - Iterate through MPLS labels, adjusting the IP offset until the last label is found.
  // - Set a flag to indicate that the packet type should be rechecked.
  mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(mpls.mpls.label_present) {
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset]));
  }
  if(