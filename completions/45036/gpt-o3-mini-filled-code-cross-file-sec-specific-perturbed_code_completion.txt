if(header->caplen < ip_offset + sizeof(uint32_t))
      return(nproto);

    /* Update MPLS packet counter */
    network_flow->stats.mpls_count++;

    /* Process all MPLS labels until the Bottom Of Stack (BoS) bit is set */
    do {
      if(header->caplen < ip_offset + sizeof(uint32_t))
        return(nproto);
      memcpy(&mpls.u32, &packet[ip_offset], sizeof(uint32_t));
      mpls.u32 = ntohl(mpls.u32);
      ip_offset += sizeof(uint32_t);
    } while (((mpls.u32 >> 8) & 0x1) == 0);

    /* After MPLS header(s) assume that the next header is an IP header */
    type = ETH_P_IP;
    recheck_type = 1;
    break;