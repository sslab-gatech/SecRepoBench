ETH_P_MPLS_MC:
    mpls.u32 = ntohl(*((uint32_t *)&packet[ip_offset]));
    network_flow->stats.mpls_count++;
    type = ETH_P_IP;
    ip_offset += 4;
    // Iterate through MPLS labels until the last label with S=1 is found.
    while (!(mpls.mpls.s)) {
      if (header->caplen < ip_offset + 4) {
        return nproto;
      }
      mpls.u32 = ntohl(*((uint32_t *)&packet[ip_offset]));
      ip_offset += 4;
    }
    recheck_type = 1;
    break;