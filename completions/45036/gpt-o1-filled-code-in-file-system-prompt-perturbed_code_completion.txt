case ETH_P_MPLS_UNI:
case 0x8848: /* ETH_P_MPLS_MC */
{
  network_flow->stats.mpls_count++;

  do {
    if ((ip_offset + 4) > header->caplen)
      return(nproto);

    mpls.u32 = ntohl(*((uint32_t *)&packet[ip_offset]));
    ip_offset += 4;
  } while (!mpls.mpls.bottom_of_label_stack);

  /* After processing all MPLS labels, treat this as an IP packet */
  type = ETH_P_IP;
  recheck_type = 1;
  break;
}