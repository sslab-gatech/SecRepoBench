case ETH_P_MPLS_UNI:
    network_flow->stats.mpls_count++;
    do {
        if(ip_offset + sizeof(mpls) > header->caplen) break;
        mpls.u32 = ntohl(*((uint32_t*)&packet[ip_offset]));
        ip_offset += sizeof(struct ndpi_mpls_header);
        type = ETH_P_IP;
    } while(!mpls.mpls.bottom_of_stack);
    recheck_type = 1;
    break;