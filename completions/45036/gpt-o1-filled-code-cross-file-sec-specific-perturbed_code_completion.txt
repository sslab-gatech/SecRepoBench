case ETH_P_MPLS_MC: /* MPLS Multicast */
  /* Update MPLS packet count */
  network_flow->stats.mpls_count++;

  /* Extract MPLS labels until bottom-of-stack bit is reached */
  while(1) {
    if((ip_offset + 4) > header->caplen)
      return(nproto);

    mpls.u32 = *((uint32_t*)&packet[ip_offset]);
    mpls.u32 = ntohl(mpls.u32);
    ip_offset += 4;

    /* Check for bottom-of-stack */
    if(mpls.u32 & 0x100)
      break;
  }

  /* Next protocol is IP, we need to re-check the type */
  type = ETH_P_IP;
  recheck_type = 1;
  break;