case ETH_P_MPLS_UNI:
case ETH_P_MPLS_MULTI:
  mpls.u32 = *((uint32_t *) &packet[ip_offset]);
  mpls.u32 = ntohl(mpls.u32);
  network_flow->stats.mpls_count++;
  type = ETH_P_IP;
  ip_offset += 4;

  while(!mpls.mpls.s) {
    ip_offset += 4;
    if(ip_offset >= header->caplen) return(nproto); /* Invalid packet */
    mpls.u32 = *((uint32_t *) &packet[ip_offset]);
    mpls.u32 = ntohl(mpls.u32);
  }
  
  recheck_type = 1;
  break;