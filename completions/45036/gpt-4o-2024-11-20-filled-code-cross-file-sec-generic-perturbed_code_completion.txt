case ETH_P_MPLS_UNI:
  case ETH_P_MPLS_MULTI:
    network_flow->stats.mpls_count++;
    type = ETH_P_IP;
    do {
      if(ip_offset + sizeof(mpls) > header->caplen)
        return(nproto); /* Too short for MPLS header */

      mpls.u32 = ntohl(*((uint32_t*)&packet[ip_offset]));
      ip_offset += sizeof(mpls);

      /* Check if this is the last MPLS label */
    } while((mpls.u32 & 0x100) == 0);

    recheck_type = 1;
    break;