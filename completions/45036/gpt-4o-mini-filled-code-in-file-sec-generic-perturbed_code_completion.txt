case ETH_P_MPLS_UNI:
  case ETH_P_MPLS_MULTI:
    network_flow->stats.mpls_count++;
    while (ip_offset + 4 <= header->caplen) {
      mpls.u32 = ntohl(*(uint32_t *)&packet[ip_offset]);
      ip_offset += 4;
      if ((mpls.mpls.label & 0xFFFFF) == 0) break; // Check for last label
    }
    type = ETH_P_IP; // Set type to IP after processing MPLS
    recheck_type = 1;
    break;