ETH_P_MPLS_MULTI:
  network_flow->stats.mpls_count++;
  type = ETH_P_IP;
  recheck_type = 1;

  do {
    if (ip_offset + 4 > header->caplen)
      return nproto; /* Too short for MPLS header */

    mpls.u32 = ntohl(*((u_int32_t *)&packet[ip_offset]));
    ip_offset += 4;

    if ((mpls.u32 & 0x100) == 0x100) /* Bottom of stack */
      break;
  } while (ip_offset + 4 <= header->caplen);

  break;