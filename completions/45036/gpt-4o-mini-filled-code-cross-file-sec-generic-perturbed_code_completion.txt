case ETH_P_MPLS_UNI:
  case ETH_P_MPLS_MCAST:
    while (ip_offset + sizeof(struct ndpi_mpls_header) <= header->caplen) {
      mpls.u32 = ntohl(*((uint32_t *)&packet[ip_offset]));
      // Update MPLS packet count
      network_flow->stats.mpls_count++;
      // Move the IP offset past the MPLS header
      ip_offset += sizeof(struct ndpi_mpls_header);
      // Check if the last label is reached (bottom of stack)
      if (mpls.mpls.label & MPLS_BOS) {
        break;
      }
    }
    type = ETH_P_IP; // Set the packet type to IP
    recheck_type = 1; // Indicate that the packet type should be rechecked
    break;