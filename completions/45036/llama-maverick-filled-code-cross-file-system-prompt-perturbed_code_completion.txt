case ETH_P_MPLS_MCAST:
  case ETH_P_MPLS_UNI:
    mpls.u32 = *((uint32_t*)&packet[ip_offset]);
    mpls.u32 = ntohl(mpls.u32);
    network_flow->stats.mpls_count++;
    type = ETH_P_IP;
    ip_offset += 4;

    while((!mpls.mpls.s) && (ip_offset < header->caplen)) {
      mpls.u32 = *((uint32_t*)&packet[ip_offset]);
      mpls.u32 = ntohl(mpls.u32);
      ip_offset += 4;
    }

    recheck_type = 1;
    break;