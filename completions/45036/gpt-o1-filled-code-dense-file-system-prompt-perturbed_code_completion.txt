case ETH_P_MPLS_UNI:
case ETH_P_MPLS_MULTI:
  network_flow->stats.mpls_count++;
  /* parse each MPLS label */
  do {
    if(ip_offset + 4 > header->caplen)
      return(nproto); /* too short for next MPLS label */
    mpls.u32 = ntohl(*((u_int32_t *)&packet[ip_offset]));
    ip_offset += 4;
  } while(!mpls.mpls.bottom_of_stack);

  /* after the last label, assume IP */
  type = ETH_P_IP;
  recheck_type = 1;
  break;