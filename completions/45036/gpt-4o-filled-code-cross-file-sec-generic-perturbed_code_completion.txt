case ETH_P_MPLS_UNI:
  case ETH_P_MPLS_MULTI:
    network_flow->stats.mpls_count++;
    ip_offset += 4;
    mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset - 4]));

    while((mpls.mpls.label & 0x100) == 0) {
      if(ip_offset + 4 > header->caplen)
        return(nproto); /* Too short for another MPLS header */
      ip_offset += 4;
      mpls.u32 = ntohl(*((u_int32_t*)&packet[ip_offset - 4]));
    }

    type = ETH_P_IP;
    recheck_type = 1;
    break;