case ETH_P_MPLS_UNI:
  case ETH_P_MPLS_MULTI:
    network_flow->stats.mpls_count++;
    type = ETH_P_IP;
    mpls.u32 = ntohl(*((u_int32_t *) &packet[ip_offset]));
    ip_offset += 4;
    while((mpls.mpls.s == 0) && (ip_offset + 4 < header->caplen)) {
      mpls.u32 = ntohl(*((u_int32_t *) &packet[ip_offset]));
      ip_offset += 4;
    }
    recheck_type = 1;
    break;