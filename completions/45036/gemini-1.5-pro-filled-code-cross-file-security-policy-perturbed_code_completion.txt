ETH_P_MPLS_MC:
    // MPLS-TP (MPLS Transport Profile) uses the same ethertype as MPLS_MC.
    // MPLS-TP is a packet-switched transport technology used in telecommunications networks.
    // It leverages MPLS to provide connection-oriented services.
    // MPLS-TP packets are handled similarly to regular MPLS packets.
    mpls.u32 = ntohl(*((uint32_t *)&packet[ip_offset]));
    network_flow->stats.mpls_count++;
    type = ETH_P_IP;
    ip_offset += 4;

    // Handle multiple MPLS labels
    while ((mpls.mpls.label & MPLS_LS_LABEL_MASK) != MPLS_LS_LABEL_MASK && ((bpf_u_int32)ip_offset + 4) < header->caplen) {
      ip_offset += 4;
      if (ip_offset + 4 > header->caplen) {
        return nproto; // Packet too short
      }
      mpls.u32 = ntohl(*((uint32_t *)&packet[ip_offset - 4]));
    }
    recheck_type = 1;
    break;