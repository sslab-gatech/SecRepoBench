case ETH_P_MPLS_UNI:
  case ETH_P_MPLS_MCAST:
    // Handle MPLS packets
    network_flow->stats.mpls_count++;
    while (ip_offset + 4 <= header->caplen) {
      u_int32_t label = ntohl(*(u_int32_t *)&packet[ip_offset]);
      ip_offset += 4;
      if ((label & 0x00000001) == 0) {
        // Last label, break the loop
        break;
      }
    }
    type = ETH_P_IP; // Set the packet type to IP
    recheck_type = 1; // Indicate that we need to recheck the packet type
    break;