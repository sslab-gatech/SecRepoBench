case ETH_P_MPLS_UNI:
  case ETH_P_MPLS_MULTI:
    // Handle MPLS (Multiprotocol Label Switching) packets with multiple labels.
    // Extract and convert MPLS labels from network to host byte order.
    // Update the MPLS packet count in the workflow statistics.
    // Set the packet type to IP and adjust the IP offset past the MPLS header.
    // Iterate through MPLS labels, adjusting the IP offset until the last label is found.
    // Set a flag to indicate that the packet type should be rechecked.
    while (ip_offset + sizeof(struct ndpi_mpls_header) <= header->caplen) {
      struct ndpi_mpls_header *mpls_hdr = (struct ndpi_mpls_header *)&packet[ip_offset];
      ip_offset += sizeof(struct ndpi_mpls_header);
      // Process the MPLS label (e.g., update statistics, etc.)
      // ...
      // Check if there are more labels
      if (!(ntohl(mpls_hdr->label) & 0x1000000)) {
        break; // Last label
      }
    }
    recheck_type = 1;
    break;