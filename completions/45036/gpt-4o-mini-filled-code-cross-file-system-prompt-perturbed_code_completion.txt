case ETH_P_MPLS_UNI:
    case ETH_P_MPLS_MCAST:
      while (ip_offset + 4 <= header->caplen) {
        mpls.u32 = ntohl(*(uint32_t *)&packet[ip_offset]);
        if ((mpls.mpls.label & 0xFFFFF) == 0) {
          break; // Exit if the label is zero
        }
        network_flow->stats.mpls_count++;
        ip_offset += 4; // Move past the MPLS label
      }
      type = ETH_P_IP; // Set the packet type to IP
      recheck_type = 1; // Indicate that we need to recheck the ether type
      break;