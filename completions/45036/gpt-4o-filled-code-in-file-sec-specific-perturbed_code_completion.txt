case ETH_P_MPLS_UNI:
  case ETH_P_MPLS_MULTI:
    network_flow->stats.mpls_count++;
    type = ETH_P_IP;
    ip_offset += 4;
    do {
      if (ip_offset >= header->caplen) {
        return(nproto); /* Invalid packet */
      }
      mpls.u32 = ntohl(*((uint32_t*)&packet[ip_offset]));
      ip_offset += 4;
    } while (!(mpls.mpls.label_stack & 0x01));
    recheck_type = 1;
    break;