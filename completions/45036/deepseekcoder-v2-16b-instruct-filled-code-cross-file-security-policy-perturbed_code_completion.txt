case ETH_P_MPLS_UNI:
    if (header->caplen < ip_offset + sizeof(struct ndpi_mpls_header))
      return(nproto); /* Too short for MPLS header */

    mpls.u32 = ntohl(*((u_int32_t *)&packet[ip_offset]));
    ip_offset += sizeof(struct ndpi_mpls_header);

    while (mpls.mpls.label != 0) {
      if (header->caplen < ip_offset + sizeof(struct ndpi_mpls_header))
        return(nproto); /* Too short for MPLS header */

      mpls.u32 = ntohl(*((u_int32_t *)&packet[ip_offset]));
      ip_offset += sizeof(struct ndpi_mpls_header);
    }

    recheck_type = 1;
    break;