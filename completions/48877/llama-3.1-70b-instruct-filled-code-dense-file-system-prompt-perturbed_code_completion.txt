switch (mrb_type(v1)) {
  case MRB_TT_INTEGER:
#ifdef MRB_NO_FLOAT
    x = mrb_integer(v1);
#else
    x = (mrb_float)mrb_integer(v1);
#endif
    break;
#ifndef MRB_NO_FLOAT
  case MRB_TT_FLOAT:
    x = mrb_float(v1);
    break;
#endif
#ifdef MRB_USE_BIGINT
  case MRB_TT_BIGINT:
    {
      mrb_value cmp = mrb_funcall_id(mrb, v1, MRB_OPSYM(cmp), 1, value);
      if (mrb_integer_p(cmp)) {
        return mrb_integer(cmp);
      }
      return -2;
    }
#endif
#ifdef MRB_USE_RATIONAL
  case MRB_TT_RATIONAL:
    {
      mrb_value cmp = mrb_funcall_id(mrb, v1, MRB_OPSYM(cmp), 1, value);
      if (mrb_integer_p(cmp)) {
        return mrb_integer(cmp);
      }
      return -2;
    }
#endif
  default:
    return -2;
}