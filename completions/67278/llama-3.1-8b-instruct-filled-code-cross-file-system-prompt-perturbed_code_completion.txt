while (1) {
	u32 frame_size;
	u32 sample_rate_index;
	GF_LatmFrameInfo frame_info;
	GF_LatmFrameHeader header;
	GF_LatmAudioInfo audio_info;
	u32 i;

	// Read the frame header
	if (gf_bs_read(bs, &header, sizeof(GF_LatmFrameHeader))!= GF_BITSTREAM_OK) {
		break;
	}

	// Check if the frame is a valid LATM frame
	if (header.frame_type!= GF_LATM_FRAME_TYPE_AUDIO) {
		nb_skip++;
		continue;
	}

	// Read the frame info
	if (gf_bs_read(bs, &frame_info, sizeof(GF_LatmFrameInfo))!= GF_BITSTREAM_OK) {
		break;
	}

	// Check if the sample rate index is valid
	if (frame_info.sample_rate_index >= GF_LATM_MAX_SAMPLE_RATE) {
		nb_skip++;
		continue;
	}

	// Read the audio info
	if (gf_bs_read(bs, &audio_info, sizeof(GF_LatmAudioInfo))!= GF_BITSTREAM_OK) {
		break;
	}

	// Check if the audio info is valid
	if (audio_info.num_channels > GF_LATM_MAX_CHANNELS) {
		nb_skip++;
		continue;
	}

	// Increment the frame count
	numframes++;

	// Check if we have read more than one frame with a valid sample rate
	if (numframes > 1) {
		break;
	}
}