u32 hdr, size;
u32 pos = (u32) gf_bs_get_position(bs);
if (pos + 3 > gf_bs_get_size(bs)) break;
hdr = gf_bs_read_u24(bs);
if (hdr & 0xFFE00000) {
    gf_bs_seek(bs, pos);
    nb_skip++;
    gf_bs_read_u8(bs);
    continue;
}
size = gf_latm_get_value(bs);
if (!size || (pos + size > gf_bs_get_size(bs))) {
    gf_bs_seek(bs, pos+1);
    nb_skip++;
    continue;
}
if (gf_m4a_get_config(bs, &acfg) != GF_OK) {
    gf_bs_seek(bs, pos+1);
    nb_skip++;
    continue;
}
if (acfg.base_sr_index == 0xF) {
    gf_bs_seek(bs, pos+1);
    nb_skip++;
    continue;
}
numframes++;
if (numframes==2) break;
gf_bs_seek(bs, pos + size);