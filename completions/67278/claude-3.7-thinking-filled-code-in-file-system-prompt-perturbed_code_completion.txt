u32 nb_bytes_skipped = 0;
u32 latm_frame_size = 0;

if (!latm_dmx_sync_frame_bs(bs, &acfg, &latm_frame_size, NULL, &nb_bytes_skipped)) 
    break;

nb_skip += nb_bytes_skipped;

// Check if sample rate index is valid
if (acfg.base_sr_index < GF_ARRAY_LENGTH(GF_M4ASampleRates) && GF_M4ASampleRates[acfg.base_sr_index]) {
    numframes++;
    if (numframes >= 2) break;  // We have enough frames to be confident
}