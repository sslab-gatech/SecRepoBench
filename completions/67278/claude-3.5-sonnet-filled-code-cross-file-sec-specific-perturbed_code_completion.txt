u32 hdr, frame_len;
u8 sr_idx;

hdr = gf_bs_read_u8(bs);
if (hdr != 0x56) {
    nb_skip++;
    gf_bs_seek(bs, nb_skip);
    continue;
}
frame_len = gf_bs_read_u16(bs);
if (frame_len > size - nb_skip - 3) break;

sr_idx = gf_bs_read_int(bs, 5);
if (sr_idx >= 13) break;

gf_bs_skip_bytes(bs, frame_len - 3);
nb_skip += frame_len;
numframes++;

if (numframes == 1) {
    memset(&acfg, 0, sizeof(GF_M4ADecSpecInfo));
    acfg.base_sr_index = sr_idx;
}

if (gf_bs_available(bs) < 3) break;