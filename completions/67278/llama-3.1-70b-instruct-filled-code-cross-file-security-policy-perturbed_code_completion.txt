if (gf_bs_available(bs) < 7) break;
u8 tag = gf_bs_read_u8(bs);
if (tag!= 0x56) {
    gf_bs_seek(bs, -1);
    break;
}
u8 latm_type = gf_bs_read_u8(bs);
if (latm_type!= 0x80) {
    gf_bs_seek(bs, -2);
    break;
}
u32 frame_len = gf_bs_read_u16(bs);
if (gf_bs_available(bs) < frame_len) break;
gf_bs_seek(bs, 2); // skip 2 bytes
u8 sample_rate_idx = gf_bs_read_u8(bs) >> 2;
if (sample_rate_idx < 0 || sample_rate_idx > 12) {
    nb_skip += frame_len;
    gf_bs_seek(bs, frame_len - 3);
} else {
    numframes++;
}