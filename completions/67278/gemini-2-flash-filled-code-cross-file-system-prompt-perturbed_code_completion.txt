u32 frame_len;
		u32 sr_idx;
		nb_skip += gf_bs_skip_bits(bs, gf_bs_available(bs) % 8);
		if (gf_bs_available(bs) < 9) break;

		frame_len = gf_bs_read(bs, 9);
		if (frame_len == 511) break;
		if (frame_len > gf_bs_available(bs) + 9) break;

		if (gf_bs_read(bs, 1) ) {
			gf_bs_skip_bits(bs, 8);
		}
		if (gf_bs_available(bs) < 12) break;

		gf_bs_skip_bits(bs, 4);
		sr_idx = gf_bs_read(bs, 4);
		if (sr_idx > 12) break;

		numframes++;
		gf_bs_skip_bits(bs, frame_len*8 - 13);
		if (gf_bs_available(bs) < 9) break;