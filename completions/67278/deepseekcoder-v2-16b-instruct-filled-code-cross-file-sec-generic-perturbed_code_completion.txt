u8 frame_header[4];
		u32 frame_size;
		u32 sample_rate_index;

		if (gf_bs_getbits(bs, 16) != 0xFFF1) {
			nb_skip += gf_bs_get_pos(bs) - 4;
			continue;
		}

		frame_size = gf_bs_getbits(bs, 13) + 9;
		if (frame_size > size - gf_bs_get_pos(bs)) {
			nb_skip += gf_bs_get_pos(bs) - 4;
			continue;
		}

		if (gf_bs_getbits(bs, 1) != 0) {
			nb_skip += gf_bs_get_pos(bs) - 4;
			continue;
		}

		sample_rate_index = gf_bs_getbits(bs, 4);
		if (sample_rate_index >= 15) {
			nb_skip += gf_bs_get_pos(bs) - 4;
			continue;
		}

		numframes++;
		if (numframes == 1) {
			acfg.sample_rate_index = sample_rate_index;
		}

		if (numframes == 2) {
			*score = nb_skip ? GF_FPROBE_MAYBE_NOT_SUPPORTED : GF_FPROBE_SUPPORTED;
			return "audio/aac+latm";
		}

		nb_skip += frame_size;
		gf_bs_skip(bs, frame_size);