while (1) {
	u32 frame_size;
	u32 sample_rate_index;
	GF_LatmFrameInfo frame_info;
	GF_LatmFrameHeader header;
	GF_AudioSampleRate sample_rate;

	// Read the frame header
	if (gf_bs_read(bs, &header, sizeof(GF_LatmFrameHeader))!= GF_SUCCESS) {
		break;
	}

	// Check if the frame is a valid LATM frame
	if (header.frame_type!= GF_LATM_FRAME_TYPE) {
		nb_skip++;
		continue;
	}

	// Read the frame info
	if (gf_bs_read(bs, &frame_info, sizeof(GF_LatmFrameInfo))!= GF_SUCCESS) {
		break;
	}

	// Check if the sample rate index is valid
	if (frame_info.sample_rate_index >= GF_LATM_MAX_SAMPLE_RATE_INDEX) {
		nb_skip++;
		continue;
	}

	// Read the sample rate
	if (gf_bs_read(bs, &sample_rate, sizeof(GF_AudioSampleRate))!= GF_SUCCESS) {
		break;
	}

	// Check if the sample rate is valid
	if (sample_rate.sample_rate!= GF_LATM_SAMPLE_RATE(sample_rate_index)) {
		nb_skip++;
		continue;
	}

	// Increment the frame count
	numframes++;

	// Check if we have read more than one frame with a valid sample rate
	if (numframes > 1) {
		break;
	}
}