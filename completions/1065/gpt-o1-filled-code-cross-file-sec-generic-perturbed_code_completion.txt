#ifdef USE_C_LOCALE
    locale_t old_lc_ctype = uselocale(regex->c_lc_ctype);
#endif
    int rc = regexec(&regex->rx, str, nmatch, pmatch, eflags);
#ifdef USE_C_LOCALE
    uselocale(old_lc_ctype);
#endif
    return rc;