int rc;

	assert(regex != NULL);
	assert(str != NULL);
	assert(pmatch != NULL);

#ifdef USE_C_LOCALE
	regex->old_lc_ctype = uselocale(regex->c_lc_ctype);
	assert(regex->old_lc_ctype != NULL);
#else
	(void)setlocale(LC_CTYPE, regex->old_lc_ctype);
#endif
	rc = regexec(&regex->rx, str, nmatch, pmatch, eflags);
#ifdef USE_C_LOCALE
	regex->old_lc_ctype = uselocale(regex->c_lc_ctype);
	assert(regex->old_lc_ctype != NULL);
#endif

	return rc;