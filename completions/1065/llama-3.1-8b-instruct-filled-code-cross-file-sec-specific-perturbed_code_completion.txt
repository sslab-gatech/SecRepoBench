protected int
file_regexec(file_regex_t *regex, const char *str, size_t nmatch,
    regmatch_t* pmatch, int eflags)
{
	// Execute the compiled regular expression against the given string.
	// The result is stored in pmatch, up to nmatch entries, with execution flags
	// specified by eflags. Return the result of regexec function call.
	int error;
	size_t len;
	char *copy;

	// Check if the input string is NULL
	if (str == NULL) {
		return REG_NOMATCH;
	}

	// Duplicate the input string to prevent it from being modified
	// by the regexec function.
	for (len = 0; len < strlen(str) && str[len]; len++)
		continue;
	if ((copy = malloc(len + 1)) == NULL) {
		return REG_NOMATCH;
	}
	(void)memcpy(copy, str, len);
	copy[len] = '\0';

	// Execute the compiled regular expression against the duplicated string.
	error = regexec(regex, copy, nmatch, pmatch, eflags);

	// Free the duplicated string.
	free(copy);

	return error;
}