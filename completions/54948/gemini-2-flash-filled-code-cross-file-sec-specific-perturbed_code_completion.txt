size_t slen = 0;
            while (ctx->pos < ctx->end) {
                if (*ctx->pos == '\\') {
                    num_escapes++;
                    ctx->pos++;
                    if (ctx->pos >= ctx->end) {
                        PLIST_OSTEP_ERR("Unexpected end of string after escape character at offset %ld\n", ctx->pos - ctx->start);
                        ctx->err++;
                        goto err_out;
                    }
                    ctx->pos++;
                    slen += 2;
                } else if (*ctx->pos == quote_char) {
                    break;
                } else {
                    ctx->pos++;
                    slen++;
                }
            }
            if (ctx->pos >= ctx->end) {
                PLIST_OSTEP_ERR("Missing terminating quote at offset %ld\n", ctx->pos - ctx->start);
                ctx->err++;
                goto err_out;
            }
            size_t total_len = slen + 1;
            char *strbuf = (char *)malloc(total_len);
            if (strbuf == NULL) {
                PLIST_OSTEP_ERR("Failed to allocate memory for string\n");
                ctx->err++;
                goto err_out;
            }
            ctx->pos++;