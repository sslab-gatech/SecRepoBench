size_t slen = 0;
            int escaped = 0;
            while (ctx->pos + slen < ctx->end) {
                char c = p[slen];
                if (escaped) {
                    escaped = 0;
                    slen++;
                } else if (c == '\\') {
                    num_escapes++;
                    escaped = 1;
                    slen++;
                } else if (c == quote_char) {
                    break;
                } else {
                    slen++;
                }
            }
            if (ctx->pos + slen >= ctx->end || p[slen] != quote_char) {
                PLIST_OSTEP_ERR("Missing closing quote at offset %ld\n", ctx->pos - ctx->start);
                ctx->err++;
                goto err_out;
            }
            char *strbuf = malloc(slen + 1);
            if (!strbuf) {
                PLIST_OSTEP_ERR("Memory allocation failed\n");
                ctx->err++;
                goto err_out;
            }
            ctx->pos += slen + 1;