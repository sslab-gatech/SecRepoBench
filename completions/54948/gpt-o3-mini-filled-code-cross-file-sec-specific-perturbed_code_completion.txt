size_t slen = 0;
const char *q = ctx->pos;
while (q < ctx->end) {
    if (*q == quote_char)
        break;
    if (*q == '\\') {
        num_escapes++;
        q++;
        if (q >= ctx->end) {
            PLIST_OSTEP_ERR("Unexpected end of string literal at offset %ld\n", q - ctx->start);
            ctx->err++;
            break;
        }
    }
    q++;
}
if (q >= ctx->end || *q != quote_char) {
    PLIST_OSTEP_ERR("Missing terminating quote at offset %ld\n", ctx->pos - ctx->start);
    ctx->err++;
    goto err_out;
}
slen = q - p;
char *strbuf = malloc(slen + 1);
if (!strbuf) {
    PLIST_OSTEP_ERR("Memory allocation failure for string at offset %ld\n", ctx->pos - ctx->start);
    ctx->err++;
    goto err_out;
}
ctx->pos = q + 1;