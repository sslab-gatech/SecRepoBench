size_t slen = 0;
            while (ctx->pos < ctx->end) {
                if (*ctx->pos == quote_char) {
                    break;
                }
                if (*ctx->pos == '\\') {
                    num_escapes++;
                    ctx->pos++;
                }
                ctx->pos++;
            }
            if (ctx->pos >= ctx->end) {
                PLIST_OSTEP_ERR("Unexpected end of input while parsing string at offset %ld\n", ctx->pos - ctx->start);
                ctx->err++;
                break;
            }
            slen = ctx->pos - p;
            ctx->pos++; // Skip the closing quote

            // Allocate memory for the string, ensuring it is large enough
            char *strbuf = (char *)malloc(slen + 1);
            if (!strbuf) {
                PLIST_OSTEP_ERR("Memory allocation failed for string buffer\n");
                ctx->err++;
                break;
            }

            // Copy the string data into the buffer
            strncpy(strbuf, p, slen);
            strbuf[slen] = '\0'; // Null-terminate the string

            data->type = PLIST_STRING;
            data->strval = strbuf;
            data->length = slen;