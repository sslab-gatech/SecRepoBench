size_t slen = 0;
            while (ctx->pos < ctx->end) {
                if (*ctx->pos == quote_char) {
                    break;
                }
                if (*ctx->pos == '\\') {
                    num_escapes++;
                    ctx->pos++;
                    if (ctx->pos >= ctx->end) {
                        PLIST_OSTEP_ERR("Unexpected end of input while parsing string at offset %ld\n", ctx->pos - ctx->start);
                        ctx->err++;
                        goto err_out;
                    }
                }
                ctx->pos++;
                slen++;
            }
            if (ctx->pos >= ctx->end || *ctx->pos != quote_char) {
                PLIST_OSTEP_ERR("Missing closing quote for string at offset %ld\n", ctx->pos - ctx->start);
                ctx->err++;
                goto err_out;
            }
            ctx->pos++; // Skip the closing quote

            char *strbuf = (char *)malloc(slen + 1 + num_escapes); // Allocate buffer for the string
            if (!strbuf) {
                PLIST_OSTEP_WRITE_ERR("Memory allocation failed for string buffer\n");
                ctx->err++;
                goto err_out;
            }

            // Reset position to parse the string again
            ctx->pos -= slen + num_escapes + 1; // Move back to the start of the string
            size_t o = 0;
            while (o < slen) {
                if (p[o] == '\\') {
                    o++;
                    switch (p[o]) {
                        case '0': strbuf[o++] = '\0'; break;
                        case 'n': strbuf[o++] = '\n'; break;
                        case 't': strbuf[o++] = '\t'; break;
                        case 'r': strbuf[o++] = '\r'; break;
                        case '"': strbuf[o++] = '"'; break;
                        case '\'': strbuf[o++] = '\''; break;
                        default: strbuf[o++] = p[o]; break; // Handle other escape sequences
                    }
                } else {
                    strbuf[o++] = p[o];
                }
            }
            strbuf[o] = '\0'; // Null-terminate the string
            data->type = PLIST_STRING;
            data->strval = strbuf;
            data->length = o;
            *plist = plist_new_node(data);
            parse_skip_ws(ctx);
            break;