size_t slen = 0;
            char *strbuf = malloc(256); // Allocate initial buffer for the string
            if (!strbuf) {
                PLIST_OSTEP_ERR("Memory allocation failed for string buffer\n");
                ctx->err++;
                break;
            }
            while (ctx->pos < ctx->end) {
                if (*ctx->pos == quote_char) {
                    break;
                }
                if (*ctx->pos == '\\') {
                    num_escapes++;
                    ctx->pos++;
                    if (ctx->pos >= ctx->end) {
                        PLIST_OSTEP_ERR("Unexpected end of input while parsing string at offset %ld\n", ctx->pos - ctx->start);
                        free(strbuf);
                        ctx->err++;
                        break;
                    }
                }
                strbuf[slen++] = *ctx->pos++;
                if (slen >= 256) { // Resize if necessary
                    char *new_buf = realloc(strbuf, slen + 256);
                    if (!new_buf) {
                        PLIST_OSTEP_ERR("Memory reallocation failed for string buffer\n");
                        free(strbuf);
                        ctx->err++;
                        break;
                    }
                    strbuf = new_buf;
                }
            }
            if (ctx->err) {
                free(strbuf);
                break;
            }
            if (*ctx->pos != quote_char) {
                PLIST_OSTEP_ERR("Missing terminating quote at offset %ld\n", ctx->pos - ctx->start);
                free(strbuf);
                ctx->err++;
                break;
            }
            ctx->pos++;
            strbuf[slen] = '\0'; // Null-terminate the string
            data->type = PLIST_STRING;
            data->strval = strbuf;
            data->length = slen;