size_t slen = 0;
char *strbuf = NULL;
const char *start = p;
while (ctx->pos < ctx->end) {
    if (*ctx->pos == quote_char) {
        break;
    }
    if (*ctx->pos == '\\') {
        num_escapes++;
        ctx->pos++;
        if (ctx->pos >= ctx->end) {
            PLIST_OSTEP_ERR("Incomplete escape sequence in string at offset %ld\n", ctx->pos - ctx->start);
            ctx->err++;
            break;
        }
    }
    ctx->pos++;
}
if (ctx->pos >= ctx->end) {
    PLIST_OSTEP_ERR("Missing terminating quote '%c' at offset %ld\n", quote_char, ctx->pos - ctx->start);
    ctx->err++;
    break;
}
slen = ctx->pos - start;
/* skip the closing quote */
ctx->pos++;
strbuf = (char *)malloc(slen + 1);
if (!strbuf) {
    PLIST_OSTEP_ERR("Memory allocation failed for string at offset %ld\n", ctx->pos - ctx->start);
    ctx->err++;
    break;
}