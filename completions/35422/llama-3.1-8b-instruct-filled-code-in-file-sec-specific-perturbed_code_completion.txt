/*
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                             %
%                                                                             %
%                                                                             %
%   C o n c a t e n a t e S t r i n g I n f o                                 %
%                                                                             %
%                                                                             %
%                                                                             %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  ConcatenateStringInfo() concatenates the source string to the destination
%  string.
%
%  The format of the ConcatenateStringInfo method is:
%
%      void ConcatenateStringInfo(StringInfo *string_info,
%        const StringInfo *source)
%
%  A description of each parameter follows:
%
%    o string_info: the string info.
%
%    o source: the source string.
%
*/
MagickExport void ConcatenateStringInfo(StringInfo *infostring,
  const StringInfo *source)
{
  size_t
    length;

  assert(infostring!= (StringInfo *) NULL);
  assert(infostring->signature == MagickCoreSignature);
  assert(source!= (const StringInfo *) NULL);
  length=infostring->length;
  if (~length < source->length)
    ThrowFatalException(ResourceLimitFatalError,"UnableToConcatenateString");
  length+=source->length;
  if (~length < MagickPathExtent)
    ThrowFatalException(ResourceLimitFatalError,"MemoryAllocationFailed");
  // Concatenate the source StringInfo's data to the destination StringInfo's data.
  // If the current destination data is NULL, allocate new memory; otherwise, 
  // resize existing memory. 
  // Copy the source data to the end of the destination's data.
  if (infostring->datum == (unsigned char *) NULL)
    infostring->datum=(unsigned char *) AcquireQuantumMemory(length+
      MagickPathExtent,sizeof(*infostring->datum));
  else
    infostring->datum=(unsigned char *) ResizeQuantumMemory(infostring->datum,
      length+MagickPathExtent,sizeof(*infostring->datum));
  if (infostring->datum == (unsigned char *) NULL)
    ThrowFatalException(ResourceLimitFatalError,"MemoryAllocationFailed");
  if (source->length!= 0)
    (void) memcpy(infostring->datum+infostring->length,source->datum,
      source->length);
  infostring->length=length;
}