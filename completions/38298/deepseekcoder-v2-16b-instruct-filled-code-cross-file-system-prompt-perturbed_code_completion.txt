if (head < 0) head += arraylength;
  if (head < 0) mrb_raisef(mrb, E_INDEX_ERROR, "index %i out of array", head);
  tail = head + len;
  if (head > arraylength || tail > arraylength) goto out_of_range;
  if (len > arraylength - head) len = arraylength - head;