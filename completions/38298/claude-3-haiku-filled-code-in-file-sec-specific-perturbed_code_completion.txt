if (head < 0) {
  head += arraylength;
}
if (head < 0 || head > ARY_MAX_SIZE - argc) {
out_of_range:
  mrb_raisef(mrb, E_INDEX_ERROR, "index %i out of array", head);
}
tail = head + len;
if (tail > arraylength) {
  tail = arraylength;
}