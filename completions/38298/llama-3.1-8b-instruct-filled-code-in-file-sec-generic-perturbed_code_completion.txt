case MRB_RANGE_OK:
  if (len > ARY_MAX_SIZE - argc) {
    head = arraylength + argc - len;
    goto out_of_range;
  }
  newlen = arraylength + argc - len;
  if (newlen > ARY_CAPA(a)) {
    ary_expand_capa(mrb, a, newlen);
  }

  if (len!= argc) {
    mrb_value *ptr = ARY_PTR(a);
    value_move(ptr + head + argc, ptr + tail, arraylength - tail);
    ARY_SET_LEN(a, newlen);
  }
  if (argc > 0) {
    value_move(ARY_PTR(a) + head, argv, argc);
  }
  mrb_write_barrier(mrb, (struct RBasic*)a);
  return ary;