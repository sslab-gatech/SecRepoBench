buf = in->cur;
    len = in->end - in->cur;

    while (len > 0) {
        if (buf[0] == first) {
            if (len > 1 && buf[1] == next) {
                if (len > 2 && third != 0 && buf[2] == third) {
                    return (buf - in->base);
                } else if (third == 0) {
                    return (buf - in->base);
                }
            }
        }
        buf++;
        len--;
    }