{
        int available, i;
        /* Determine the available number of characters */
        if (in->buf != NULL)
            available = (int)(xmlBufUse(in->buf->buffer) - (in->cur - in->base));
        else
            available = in->length - (in->cur - in->base);

        for (i = 0; i < available; i++) {
            /* If ignoring attribute values, skip over quoted string parts */
            if (ignoreAttrValue && (in->cur[i] == '"' || in->cur[i] == '\'')) {
                char quote = in->cur[i];
                i++;
                while (i < available && in->cur[i] != quote)
                    i++;
                continue;
            }
            if (in->cur[i] == first) {
                if (next != 0) {
                    if (i + 1 >= available)
                        break;
                    if (in->cur[i + 1] != next)
                        continue;
                }
                if (third != 0) {
                    if (i + 2 >= available)
                        break;
                    if (in->cur[i + 2] != third)
                        continue;
                }
                /* Found the sequence: update checkIndex and return offset */
                ctxt->checkIndex = base + i;
                return i;
            }
        }
        /* Sequence not found: update checkIndex to the end of scanned region */
        ctxt->checkIndex = base + available;
    }