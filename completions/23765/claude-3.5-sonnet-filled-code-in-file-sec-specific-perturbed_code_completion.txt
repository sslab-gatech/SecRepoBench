int idx;
xmlChar val;

idx = htmlParseLookupSequence(ctxt, first, next, third, iscomment, ignoreAttrValue);
if (idx < 0)
    return (-1);
val = in->cur[idx + 2];
if (val == 0) /* bad cut of input */
    return (-1);

if (iscomment) {
    /* Skip content within comments */
    while (base < len) {
        if ((buf[base] == '-') && (buf[base + 1] == '-') &&
            (buf[base + 2] == '>')) {
            incomment = 0;
            base += 2;
            break;
        }
        base++;
    }
    if (incomment)
        return (-1);
}

if (ignoreAttrValue) {
    /* Skip content within attribute values */
    while (base < len) {
        if (buf[base] == valdellim) {
            invalue = 0;
            base++;
            break;
        }
        base++;
    }
    if (invalue)
        return (-1);
}

/* Check for the sequence */
if (buf[base] == first) {
    if (next == 0)
        return (base - (in->cur - in->base));
    if (buf[base + 1] == next) {
        if (third == 0)
            return (base - (in->cur - in->base));
        if (buf[base + 2] == third)
            return (base - (in->cur - in->base));
    }
}

ctxt->checkIndex = base;