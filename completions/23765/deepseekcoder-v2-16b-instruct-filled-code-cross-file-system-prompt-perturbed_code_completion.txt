buf = in->base + base;
        len = in->end - in->base;
        buf += base;
        len -= base;

        while (len > 0) {
            if (buf[0] == first) {
                if (len > 1 && buf[1] == next) {
                    if (third != 0 && len > 2 && buf[2] == third) {
                        return in->cur - in->base;
                    } else if (third == 0) {
                        return in->cur - in->base;
                    }
                }
            }
            buf++;
            len--;
        }

        ctxt->checkIndex = in->cur - in->base;