const char *mvg_class = GetValueFromSplayTree(macros, token);
            if (mvg_class != (const char *) NULL)
            {
                char *new_elements = AcquireString(mvg_class);
                size_t new_length = strlen(new_elements) + strlen(q) + 1;
                char *updated_primitive = (char *) AcquireQuantumMemory(new_length, sizeof(char));
                if (updated_primitive == (char *) NULL)
                {
                    DestroyString(new_elements);
                    status = MagickFalse;
                    break;
                }
                snprintf(updated_primitive, new_length, "%s%s", new_elements, q);
                DestroyString(primitive);
                primitive = updated_primitive;
                q = primitive; // Update the stream pointer to the new position
                DestroyString(new_elements);
            }