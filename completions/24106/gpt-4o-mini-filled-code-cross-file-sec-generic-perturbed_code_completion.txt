mvg_class=GetValueFromSplayTree(macros,token);
            if (mvg_class != (const char *) NULL)
              {
                char *elements;
                size_t length;

                elements=AcquireString(mvg_class);
                length=strlen(elements);
                (void) ConcatenateString(&elements, q);
                primitive=DestroyString(primitive);
                primitive=AcquireString(elements);
                q=primitive + length; // Adjust the stream pointer
                elements=DestroyString(elements);
              }