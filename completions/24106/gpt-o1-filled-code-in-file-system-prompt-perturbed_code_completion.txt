{
  (void) GetNextToken(q,&q,extent,token);
  if (*token == '\0')
  {
    status=MagickFalse;
    break;
  }
  /* Retrieve the MVG class definition from the macros using the token. */
  {
    const char *mvg_class = (const char *) GetValueFromSplayTree(macros, token);
    if (mvg_class != (const char *) NULL)
    {
      /*
        Inject the MVG class elements into the current MVG stream by
        concatenating them ahead of the remaining content. Then free
        the old primitive string and update 'primitive' to point to
        the new combined string. Adjust 'q' to reflect the pointer's
        new position in 'primitive'.
      */
      size_t length = (size_t)((q - primitive) + strlen(mvg_class) + strlen(q) + 2UL);
      char *elements = (char *) AcquireQuantumMemory(length, sizeof(*elements));
      if (elements == (char *) NULL)
      {
        status=MagickFalse;
        break;
      }
      (void) CopyMagickString(elements, primitive, (size_t)(q - primitive));
      (void) ConcatenateMagickString(elements, mvg_class, length);
      (void) ConcatenateMagickString(elements, q, length);

      primitive = DestroyString(primitive);
      primitive = elements;

      /* Reposition 'q' so that it points into the newly modified 'primitive'. */
      q = primitive + (p - primitive);
    }
  }
  break;
}