if (LocaleCompare(graphic_context[graphiccontextindex]->id,token) == 0)
  break;
mvg_class=(const char *) GetValueFromSplayTree(macros,token);
if (mvg_class != (const char *) NULL)
  {
    char
      *elements;

    size_t
      length;

    length=strlen(primitive)+strlen(mvg_class)+1;
    elements=(char *) AcquireQuantumMemory(length,sizeof(*elements));
    if (elements == (char *) NULL)
      {
        (void) ThrowMagickException(exception,GetMagickModule(),
          ResourceLimitError,"MemoryAllocationFailed","`%s'",
          image->filename);
        break;
      }
    (void) memcpy(elements,mvg_class,strlen(mvg_class));
    (void) memcpy(elements+strlen(mvg_class),q,strlen(q)+1);
    primitive=DestroyString(primitive);
    primitive=elements;
    q=primitive+strlen(mvg_class);
  }