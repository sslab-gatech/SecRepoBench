if (LocaleCompare(token, graphic_context[graphiccontextindex]->id) == 0)
                  break;
                mvg_class = (const char *) GetValueFromSplayTree(macros, token);
                if (mvg_class != (const char *) NULL)
                  {
                    char
                      *elements;

                    size_t
                      length;

                    length = (size_t) (p - primitive) + strlen(mvg_class) + strlen(p) + 1;
                    elements = (char *) AcquireQuantumMemory(length, sizeof(*elements));
                    if (elements == (char *) NULL)
                      {
                        status = MagickFalse;
                        break;
                      }
                    (void) CopyMagickString(elements, primitive, (size_t) (p - primitive + 1));
                    (void) ConcatenateMagickString(elements, mvg_class, length);
                    (void) ConcatenateMagickString(elements, p, length);
                    primitive = DestroyString(primitive);
                    primitive = elements;
                    q = primitive + (p - primitive) + strlen(mvg_class);
                  }