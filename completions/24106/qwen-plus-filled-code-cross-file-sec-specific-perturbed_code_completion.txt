const char
  *mvg_class;

mvg_class = (const char *) GetValueFromSplayTree(macros, token);
if (mvg_class != (const char *) NULL)
{
  if (graphic_context[graphiccontextindex]->id != NULL &&
      strcmp(graphic_context[graphiccontextindex]->id, token) == 0)
  {
    break;
  }

  size_t mvg_class_length = strlen(mvg_class) + strlen(primitive) + 2;
  char *new_primitive = AcquireString((char *)NULL);
  new_primitive = (char *) ResizeQuantumMemory(new_primitive, mvg_class_length, sizeof(*new_primitive));
  if (new_primitive == (char *) NULL)
  {
    ThrowBinaryException(ResourceLimitError, "MemoryAllocationFailed", image->filename);
    break;
  }

  (void) CopyMagickString(new_primitive, mvg_class, mvg_class_length);
  (void) ConcatenateMagickString(new_primitive, primitive, mvg_class_length);

  primitive = DestroyString(primitive);
  primitive = new_primitive;

  q = primitive + (strlen(mvg_class));
}