if (LocaleCompare("class",token) == 0)
            {
              const char *class_definition = GetValueFromSplayTree(macros, token);
              if (class_definition != (const char *) NULL)
              {
                char *new_primitive = (char *) AcquireQuantumMemory(strlen(class_definition) + strlen(q) + 1, sizeof(char));
                if (new_primitive == (char *) NULL)
                  return MagickFalse;
                strcpy(new_primitive, class_definition);
                strcat(new_primitive, q);
                primitive = new_primitive;
                q = primitive; // Update the stream pointer to the new position
              }
              break;
            }