if (LocaleCompare(token, graphic_context[graphiccontextindex]->id) == 0)
  break;
const char *mvg_class = (const char *) GetValueFromSplayTree(macros, token);
if (mvg_class!= (const char *) NULL)
{
  char *elements = AcquireString(primitive);
  size_t length = strlen(elements);
  ConcatenateString(&elements, mvg_class, strlen(mvg_class));
  ConcatenateString(&elements, q, strlen(q));
  primitive = DestroyString(primitive);
  primitive = elements;
  q = primitive + length;
}