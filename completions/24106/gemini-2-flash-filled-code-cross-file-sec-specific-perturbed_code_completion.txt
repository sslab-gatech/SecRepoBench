if (LocaleCompare(token,graphic_context[graphiccontextindex]->id) == 0)
              break;
            mvg_class=(const char *) GetValueFromSplayTree(macros,token);
            if (mvg_class != (const char *) NULL)
              {
                char
                  *elements;

                size_t
                  elements_length,
                  remaining_length;

                /*
                  Inject the class elements into the stream.
                */
                elements_length=strlen(mvg_class);
                remaining_length=strlen(q);
                if ((elements_length+remaining_length) > (extent-1))
                  {
                    extent=elements_length+remaining_length+MagickPathExtent;
                    token=(char *) ResizeQuantumMemory(token,extent,sizeof(*token));
                    if (token == (char *) NULL)
                      {
                        status=MagickFalse;
                        break;
                      }
                  }
                elements=AcquireString(mvg_class);
                if (elements == (char *) NULL)
                  {
                    status=MagickFalse;
                    break;
                  }
                (void) CopyMagickString(token,elements,extent);
                (void) CopyMagickString(token+elements_length,q,
                  extent-elements_length);
                token[elements_length+remaining_length]='\0';
                primitive=DestroyString(primitive);
                primitive=AcquireString(token);
                if (primitive == (char *) NULL)
                  {
                    status=MagickFalse;
                    elements=DestroyString(elements);
                    break;
                  }
                q=primitive;
                elements=DestroyString(elements);
              }