number_pixels=(MagickSizeType) image->columns*(size_t) MagickMax((ssize_t)
  TIFFScanlineSize(tiff)/((ssize_t) image->columns),1);
if (HeapOverflowSanityCheck(image->rows,sizeof(*tiff_pixels)) != MagickFalse)
  ThrowTIFFException(ResourceLimitError,"MemoryAllocationFailed");
tiff_pixels=(unsigned char *) AcquireQuantumMemory(image->columns,
  sizeof(*tiff_pixels)*MagickMax((size_t) TIFFScanlineSize(tiff)/
  ((size_t) image->columns),1));
if (tiff_pixels == (unsigned char *) NULL)
  ThrowTIFFException(ResourceLimitError,"MemoryAllocationFailed");