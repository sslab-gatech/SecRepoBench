size_t scanline_size = TIFFScanlineSize(tiff);
    size_t max_size = MagickMax(scanline_size, rows_per_strip * image->columns * (bits_per_sample / 8));
    tiff_pixels = (unsigned char *) AcquireQuantumMemory(max_size, sizeof(unsigned char));
    if (tiff_pixels == (unsigned char *) NULL)
      ThrowTIFFException(ResourceLimitError, "MemoryAllocationFailed");