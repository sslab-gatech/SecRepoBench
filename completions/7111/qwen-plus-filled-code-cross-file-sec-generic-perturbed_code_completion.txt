number_pixels = (MagickSizeType) image->columns * image->rows;
if (HeapOverflowSanityCheck(image->rows, sizeof(*tiff_pixels)) != MagickFalse)
  ThrowTIFFException(ResourceLimitError, "MemoryAllocationFailed");
tiff_pixels = (unsigned char *) AcquireQuantumMemory((size_t) image->columns,
  (size_t) image->rows * sizeof(*tiff_pixels));
if (tiff_pixels == (unsigned char *) NULL)
  ThrowTIFFException(ResourceLimitError, "MemoryAllocationFailed");