tsize_t
  scanline_size;

scanline_size=TIFFScanlineSize(tiff);
if (scanline_size <= 0)
  ThrowTIFFException(ResourceLimitError,"MemoryAllocationFailed");
if (HeapOverflowSanityCheck((size_t) scanline_size,sizeof(*tiff_pixels)) != MagickFalse)
  ThrowTIFFException(ResourceLimitError,"MemoryAllocationFailed");
tiff_pixels=(unsigned char *) AcquireQuantumMemory((size_t) scanline_size,
  sizeof(*tiff_pixels));
if (tiff_pixels == (unsigned char *) NULL)
  ThrowTIFFException(ResourceLimitError,"MemoryAllocationFailed");