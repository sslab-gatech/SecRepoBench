size_t scanline_size = TIFFScanlineSize(tiff);
    if (scanline_size == 0 || scanline_size > SIZE_MAX / image->rows)
      ThrowTIFFException(ResourceLimitError,"MemoryAllocationFailed");
    tiff_pixels = (unsigned char *) AcquireQuantumMemory(scanline_size, image->rows);
    if (tiff_pixels == (unsigned char *) NULL)
      ThrowTIFFException(ResourceLimitError,"MemoryAllocationFailed");