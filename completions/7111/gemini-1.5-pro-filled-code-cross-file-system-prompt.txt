number_pixels=(MagickSizeType) image->columns*samples_per_pixel*pow(2,ceil(log(
      bits_per_sample)/log(2)))/8;
    if (HeapOverflowSanityCheck(image->rows,sizeof(*tiff_pixels)) != MagickFalse)
      ThrowTIFFException(ResourceLimitError,"MemoryAllocationFailed");
    tiff_pixels=(unsigned char *) AcquireQuantumMemory(MagickMax(TIFFScanlineSize(
      tiff),rows_per_strip),MagickMax((size_t) number_pixels,
      MagickMax(TIFFScanlineSize(tiff),rows_per_strip))*sizeof(*tiff_pixels));
    if (tiff_pixels == (unsigned char *) NULL)
      ThrowTIFFException(ResourceLimitError,"MemoryAllocationFailed");