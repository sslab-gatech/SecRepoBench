image->rows; y++)
        {
          register const Quantum
            *magick_restrict p;

          p=GetVirtualPixels(image,0,y,image->columns,1,exception);
          if (p == (const Quantum *) NULL)
            break;
          length=ExportQuantumPixels(image,(CacheView *) NULL,quantum_info,
            quantum_type,pixels,exception);
          (void) length;
          if (TIFFWritePixels(tiff,&tiff_info,y,0,image) == -1)
            break;
          if (image->previous == (Image *) NULL)
            {
              status=SetImageProgress(image,SaveImageTag,(MagickOffsetType) y,
                image->rows);
              if (status == MagickFalse)
                break;
            }
        }
        break;
      }
      case PHOTOMETRIC_PALETTE:
      {
        /*
          Palette TIFF image.
        */
        if (image->storage_class != PseudoClass)
          (void) SetImageStorageClass(image,PseudoClass,exception);
        if (image->colorspace != GRAYColorspace)
          (void) TransformImageColorspace(image,GRAYColorspace,exception);
        for (y=0; y < (ssize_t) image->rows; y++)
        {
          register const Quantum
            *magick_restrict p;

          p=GetVirtualPixels(image,0,y,image->columns,1,exception);
          if (p == (const Quantum *) NULL)
            break;
          length=ExportQuantumPixels(image,(CacheView *) NULL,quantum_info,
            IndexQuantum,pixels,exception);
          (void) length;
          if (TIFFWritePixels(tiff,&tiff_info,y,0,image) == -1)
            break;
          if (image->previous == (Image *) NULL)
            {
              status=SetImageProgress(image,SaveImageTag,(MagickOffsetType) y,
                image->rows);
              if (status == MagickFalse)
                break;
            }
        }
        break;
      }
      case PHOTOMETRIC_MINISBLACK:
      case PHOTOMETRIC_MINISWHITE:
      {
        /*
          Grayscale TIFF image.
        */
        quantum_type=GrayQuantum;
        if (bits_per_sample == 1)
          quantum_type=BilevelQuantum;
        for (y=0; y < (ssize_t) image->rows; y++)
        {
          register const Quantum
            *magick_restrict p;

          p=GetVirtualPixels(image,0,y,image->columns,1,exception);
          if (p == (const Quantum *) NULL)
            break;
          length=ExportQuantumPixels(image,(CacheView *) NULL,quantum_info,
            quantum_type,pixels,exception);
          (void) length;
          if (TIFFWritePixels(tiff,&tiff_info,y,0,image) == -1)
            break;
          if (image->previous == (Image *) NULL)
            {
              status=SetImageProgress(image,SaveImageTag,(MagickOffsetType) y,
                image->rows);
              if (status == MagickFalse)
                break;
            }
        }
        break;
      }
      default:
        break;
    }
    if (quantum_info != (QuantumInfo *) NULL)
      quantum_info=DestroyQuantumInfo(quantum_info);
    if (photometric == PHOTOMETRIC_CIELAB)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_YCBCR)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_PALETTE)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_MINISBLACK)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_MINISWHITE)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_SEPARATED)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_CIELAB)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_YCBCR)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_PALETTE)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_MINISBLACK)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_MINISWHITE)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_SEPARATED)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_CIELAB)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_YCBCR)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_PALETTE)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_MINISBLACK)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_MINISWHITE)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_SEPARATED)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_CIELAB)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_YCBCR)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_PALETTE)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_MINISBLACK)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_MINISWHITE)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_SEPARATED)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_CIELAB)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_YCBCR)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_PALETTE)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_MINISBLACK)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_MINISWHITE)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_SEPARATED)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_CIELAB)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_YCBCR)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_PALETTE)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_MINISBLACK)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_MINISWHITE)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_SEPARATED)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_CIELAB)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_YCBCR)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_PALETTE)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_MINISBLACK)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_MINISWHITE)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_SEPARATED)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_CIELAB)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_YCBCR)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_PALETTE)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_MINISBLACK)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_MINISWHITE)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_SEPARATED)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMETRIC_CIELAB)
      (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
    if (photometric == PHOTOMET