size_t
      scanline_size;

    scanline_size = TIFFScanlineSize(tiff);
    if (scanline_size == 0)
      ThrowTIFFException(ResourceLimitError,"MemoryAllocationFailed");

    tiff_pixels = (unsigned char *) AcquireQuantumMemory(image->rows, scanline_size);
    if (tiff_pixels == (unsigned char *) NULL)
      ThrowTIFFException(ResourceLimitError,"MemoryAllocationFailed");