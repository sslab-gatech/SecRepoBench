// Allocate memory for tiff_pixels to store the image data from TIFF. 
// If memory allocation fails, an exception is thrown.
tiff_pixels = (unsigned char *) AcquireQuantumMemory(number_pixels, sizeof(*tiff_pixels));
if (tiff_pixels == (unsigned char *) NULL)
  ThrowTIFFException(ResourceLimitError, "MemoryAllocationFailed");