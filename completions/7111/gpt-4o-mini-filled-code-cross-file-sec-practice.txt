// Allocate memory for tiff_pixels to store the image data from TIFF.
    // The allocated size is the maximum of the TIFF scanline size, rows per strip, or the 
    // calculated size based on image columns, samples per pixel, and bits per sample.
    size_t scanline_size = TIFFScanlineSize(tiff);
    size_t calculated_size = (size_t) ((width * samples_per_pixel * (bits_per_sample / 8)) + pad);
    size_t max_size = MagickMax(scanline_size, MagickMax(rows_per_strip, calculated_size));

    // Perform memory allocation with error handling
    tiff_pixels = (unsigned char *) AcquireQuantumMemory(max_size, sizeof(*tiff_pixels));
    if (tiff_pixels == (unsigned char *) NULL)
        ThrowTIFFException(ResourceLimitError, "MemoryAllocationFailed");

    // Initialize the allocated memory to zero to prevent any garbage values
    (void) memset(tiff_pixels, 0, max_size * sizeof(*tiff_pixels));