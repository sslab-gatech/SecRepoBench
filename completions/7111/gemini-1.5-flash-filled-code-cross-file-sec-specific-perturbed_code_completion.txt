number_pixels=(MagickSizeType) image->columns*image->rows*items_in_pix*
      ((bits_per_sample+7) >> 3);
    if (HeapOverflowSanityCheck(number_pixels,sizeof(*tiff_pixels)) !=
        MagickFalse)
      ThrowTIFFException(ResourceLimitError,"MemoryAllocationFailed");
    tiff_pixels=(unsigned char *) AcquireQuantumMemory((size_t) number_pixels,
      sizeof(*tiff_pixels));
    if (tiff_pixels == (unsigned char *) NULL)
      ThrowTIFFException(ResourceLimitError,"MemoryAllocationFailed");