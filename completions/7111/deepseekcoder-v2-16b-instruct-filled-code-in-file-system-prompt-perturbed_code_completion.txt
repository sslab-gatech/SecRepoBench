}
         }
#endif
         break;
      }
      case COMPRESSION_LZW: image->compression=LZWCompression; break;
      case COMPRESSION_OJPEG: image->compression=JPEGCompression; break;
      case COMPRESSION_ADOBE_DEFLATE: image->compression=ZipCompression; break;
      case COMPRESSION_DEFLATE: image->compression=ZipCompression; break;
      case COMPRESSION_PACKBITS: image->compression=RLECompression; break;
      case COMPRESSION_THUNDERSCAN: image->compression=Group3Compression; break;
      case COMPRESSION_IT8CTPAD: image->compression=IT8CTPADCompression; break;
      case COMPRESSION_IT8LW: image->compression=IT8LWCompression; break;
      case COMPRESSION_IT8MP: image->compression=IT8MPCompression; break;
      case COMPRESSION_IT8BL: image->compression=IT8BLCompression; break;
      case COMPRESSION_PIXARFILM: image->compression=PixarFilmCompression; break;
      case COMPRESSION_PIXARLOG: image->compression=PixarLogCompression; break;
      case COMPRESSION_DEFLATE_OLD: image->compression=ZipCompression; break;
      case COMPRESSION_JBIG: image->compression=JBIGCompression; break;
      case COMPRESSION_SGILOG: image->compression=SGILOGCompression; break;
      case COMPRESSION_SGILOG24: image->compression=SGILOG24Compression; break;
      case COMPRESSION_JP2000: image->compression=JPEG2000Compression; break;
      default:
      {
        TIFFClose(tiff);
        ThrowReaderException(CoderError,"UnknownCompression");
      }
    }
    if (image->debug != MagickFalse)
      (void) LogMagickEvent(CoderEvent,GetMagickModule(),"Compression: %s",
        GetCompressionInfo(image->compression,exception));
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PREDICTOR,&value) == 1)
      {
        if (value == PREDICTOR_HORIZONTAL)
          image->properties.insert(StringPair("tiff:predictor","horizontal"));
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_COLORMAP,&min_sample_value,
        &max_sample_value) == 1)
      {
        image->colors=(size_t) (max_sample_value-min_sample_value+1);
        image->storage_class=DirectTrait;
        image->matte=MagickTrue;
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_IMAGEDEPTH,&value) == 1)
      image->depth=(size_t) value;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_TILEWIDTH,&value) == 1)
      image->tile.width=(size_t) value;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_TILELENGTH,&value) == 1)
      image->tile.height=(size_t) value;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_TILEOFFSETS,&value) == 1)
      image->tile.offset=(size_t) value;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_TILEBYTECOUNTS,&value) == 1)
      image->tile.length=(size_t) value;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBFILETYPE,&value) == 1)
      {
        if (value & FILETYPE_REDUCEDIMAGE)
          (void) SetImageProperty(image,"tiff:subfiletype","reduced",
            exception);
        if (value & FILETYPE_PAGE)
          (void) SetImageProperty(image,"tiff:subfiletype","page",exception);
        if (value & FILETYPE_MASK)
          (void) SetImageProperty(image,"tiff:subfiletype","mask",exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PAGENUMBER,&value) == 1)
      {
        image->page.x=(ssize_t) value;
        image->page.y=(ssize_t) value;
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PAGECOUNT,&value) == 1)
      image->page.depth=(ssize_t) value;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBIFD,&value) == 1)
      {
        if (value != 0)
          {
            TIFF *subifd;
            subifd=TIFFClientOpen(image->filename,"rb",(thandle_t) image,
              TIFFReadBlob,TIFFWriteBlob,TIFFSeekBlob,TIFFCloseBlob,
              TIFFGetBlobSize,TIFFMapBlob,TIFFUnmapBlob);
            if (subifd != (TIFF *) NULL)
              {
                (void) TIFFReadDirectory(subifd);
                TIFFClose(subifd);
              }
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_EXIFVERSION,&value) == 1)
      {
        char
          exif_version[MagickPathExtent];

        (void) FormatLocaleString(exif_version,MagickPathExtent,"%02d%02d",
          (value >> 8) & 0xff,value & 0xff);
        (void) SetImageProperty(image,"exif:version",exif_version,exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_FLASHPIXVERSION,&value) == 1)
      {
        char
          flashpix_version[MagickPathExtent];

        (void) FormatLocaleString(flashpix_version,MagickPathExtent,"%d.%d",
          (value >> 8) & 0xff,value & 0xff);
        (void) SetImageProperty(image,"flashpix:version",flashpix_version,
          exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PIXELXDIMENSION,&value) == 1)
      {
        char
          pixel_x_dimension[MagickPathExtent];

        (void) FormatLocaleString(pixel_x_dimension,MagickPathExtent,"%lu",
          value);
        (void) SetImageProperty(image,"tiff:pixel-x-dimension",
          pixel_x_dimension,exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PIXELYDIMENSION,&value) == 1)
      {
        char
          pixel_y_dimension[MagickPathExtent];

        (void) FormatLocaleString(pixel_y_dimension,MagickPathExtent,"%lu",
          value);
        (void) SetImageProperty(image,"tiff:pixel-y-dimension",
          pixel_y_dimension,exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_RELATEDSOUNDFILE,&value) == 1)
      {
        char
          related_sound_file[MagickPathExtent];

        (void) FormatLocaleString(related_sound_file,MagickPathExtent,"%lu",
          value);
        (void) SetImageProperty(image,"tiff:related-sound-file",
          related_sound_file,exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SOUND,&value) == 1)
      {
        char
          sound[MagickPathExtent];

        (void) FormatLocaleString(sound,MagickPathExtent,"%lu",value);
        (void) SetImageProperty(image,"tiff:sound",sound,exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_RICHTIFFIPTC,&value) == 1)
      {
        char
          rich_tiff_iptc[MagickPathExtent];

        (void) FormatLocaleString(rich_tiff_iptc,MagickPathExtent,"%lu",value);
        (void) SetImageProperty(image,"tiff:rich-tiff-iptc",rich_tiff_iptc,
          exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_XMLPACKET,&value) == 1)
      {
        char
          xml_packet[MagickPathExtent];

        (void) FormatLocaleString(xml_packet,MagickPathExtent,"%lu",value);
        (void) SetImageProperty(image,"tiff:xml-packet",xml_packet,exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_YCBCRSUBSAMPLING,&value) == 1)
      {
        char
          ycbcr_subsampling[MagickPathExtent];

        (void) FormatLocaleString(ycbcr_subsampling,MagickPathExtent,"%dx%d",
          value,value);
        (void) SetImageProperty(image,"tiff:ycbcr-subsampling",
          ycbcr_subsampling,exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_YCBCRPOSITIONING,&value) == 1)
      {
        char
          ycbcr_positioning[MagickPathExtent];

        (void) FormatLocaleString(ycbcr_positioning,MagickPathExtent,"%d",value);
        (void) SetImageProperty(image,"tiff:ycbcr-positioning",
          ycbcr_positioning,exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_REFERENCEBLACKWHITE,&chromaticity) == 1)
      {
        if (chromaticity != (float *) NULL)
          {
            image->chromaticity.black_point.x=chromaticity[0];
            image->chromaticity.black_point.y=chromaticity[1];
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_TRANSFERFUNCTION,&chromaticity) == 1)
      {
        if (chromaticity != (float *) NULL)
          {
            image->chromaticity.red_primary.x=chromaticity[0];
            image->chromaticity.red_primary.y=chromaticity[1];
            image->chromaticity.green_primary.x=chromaticity[2];
            image->chromaticity.green_primary.y=chromaticity[3];
            image->chromaticity.blue_primary.x=chromaticity[4];
            image->chromaticity.blue_primary.y=chromaticity[5];
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SOFTWARE,&value) == 1)
      {
        char
          software[MagickPathExtent];

        (void) FormatLocaleString(software,MagickPathExtent,"%lu",value);
        (void) SetImageProperty(image,"tiff:software",software,exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ARTIST,&value) == 1)
      {
        char
          artist[MagickPathExtent];

        (void) FormatLocaleString(artist,MagickPathExtent,"%lu",value);
        (void) SetImageProperty(image,"tiff:artist",artist,exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_COPYRIGHT,&value) == 1)
      {
        char
          copyright[MagickPathExtent];

        (void) FormatLocaleString(copyright,MagickPathExtent,"%lu",value);
        (void) SetImageProperty(image,"tiff:copyright",copyright,exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_DATETIME,&value) == 1)
      {
        char
          timestamp[MagickPathExtent];

        (void) FormatLocaleString(timestamp,MagickPathExtent,"%lu",value);
        (void) SetImageProperty(image,"tiff:timestamp",timestamp,exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_DOCUMENTNAME,&value) == 1)
      {
        char
          document_name[MagickPathExtent];

        (void) FormatLocaleString(document_name,MagickPathExtent,"%lu",value);
        (void) SetImageProperty(image,"tiff:document-name",document_name,
          exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_HOSTCOMPUTER,&value) == 1)
      {
        char
          host_computer[MagickPathExtent];

        (void) FormatLocaleString(host_computer,MagickPathExtent,"%lu",value);
        (void) SetImageProperty(image,"tiff:host-computer",host_computer,
          exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_IMAGEDESCRIPTION,&value) == 1)
      {
        char
          image_description[MagickPathExtent];

        (void) FormatLocaleString(image_description,MagickPathExtent,"%lu",