,stdout,MagickFalse);
    TIFFClose(tiff);
    return(status);
}

// the below code fragment can be found in:
// coders/tiff.c
static void TIFFReadPhotoshopLayers(Image *image, const ImageInfo *image_info,
  ExceptionInfo *exception)
{
  const char
    *option;

  MagickBooleanType
    status;

  register ssize_t
    i;

  TIFF
    *tiff;

  TIFFField
    *field;

  TIFFInfo
    tiff_info;

  uint16
    layers,
    pages;

  unsigned char
    *pixels;

  /*
    Open TIFF file.
  */
  assert(image!= (Image *) NULL);
  assert(image->signature == MagickCoreSignature);
  assert(image_info!= (const ImageInfo *) NULL);
  assert(image_info->signature == MagickCoreSignature);
  if (image->debug!= MagickFalse)
    (void) LogMagickEvent(TraceEvent,GetMagickModule(),"%s",image->filename);
  assert(exception!= (ExceptionInfo *) NULL);
  assert(exception->signature == MagickCoreSignature);
  status=OpenBlob(image_info,image,ReadBinaryBlobMode,exception);
  if (status == MagickFalse)
    return;
  (void) SetMagickThreadValue(tiff_exception,exception);
  tiff=TIFFClientOpen(image->filename,"rb",(thandle_t) image,TIFFReadBlob,
    TIFFWriteBlob,TIFFSeekBlob,TIFFCloseBlob,TIFFGetBlobSize,TIFFMapBlob,
    TIFFUnmapBlob);
  if (tiff == (TIFF *) NULL)
    return;
  status=TIFFReadDirectory(tiff)!= 0? MagickTrue : MagickFalse;
  if (status == MagickFalse)
    {
      TIFFClose(tiff);
      return;
    }
  (void) TIFFGetFieldDefaulted(tiff,TIFFTAG_PAGENUMBER,&layers,&pages);
  if (layers == 0)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-1)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-2)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-3)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-4)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-5)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-6)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-7)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-8)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-9)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-10)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-11)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-12)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-13)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-14)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-15)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-16)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-17)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-18)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-19)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-20)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-21)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-22)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-23)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-24)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-25)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-26)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-27)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-28)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-29)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-30)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-31)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-32)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-33)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-34)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-35)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-36)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-37)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-38)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-39)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-40)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-41)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-42)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-43)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-44)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-45)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-46)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-47)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-48)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-49)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-50)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-51)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-52)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-53)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-54)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-55)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-56)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-57)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-58)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-59)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-60)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-61)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-62)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-63)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-64)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-65)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-66)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-67)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-68)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-69)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-70)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-71)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-72)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-73)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-74)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-75)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-76)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-77)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-78)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-79)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-80)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-81)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-82)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-83)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-84)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-85)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-86)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-87)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-88)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-89)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-90)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-91)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-92)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-93)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-94)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-95)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-96)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-97)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-98)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-99)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-100)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-101)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-102)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-103)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-104)
    {
      TIFFClose(tiff);
      return;
    }
  if (image_info->scene >= layers-105)
    {
      TIFFClose(tiff);
      return;