p == (const Quantum *) NULL)
            break;
          length=ExportQuantumPixels(image,(CacheView *) NULL,quantum_info,
            quantum_type,pixels,exception);
          (void) length;
          if (TIFFWritePixels(tiff,&tiff_info,y,0,image) == -1)
            break;
          if (image->previous == (Image *) NULL)
            {
              status=SetImageProgress(image,SaveImageTag,(MagickOffsetType) y,
                image->rows);
              if (status == MagickFalse)
                break;
            }
        }
        break;
      }
      case PHOTOMETRIC_PALETTE:
      {
        /*
          Palette TIFF image.
        */
        quantum_type=IndexQuantum;
        if (image->alpha_trait != UndefinedPixelTrait)
          quantum_type=IndexAlphaQuantum;
        for (y=0; y < (ssize_t) image->rows; y++)
        {
          register const Quantum
            *magick_restrict p;

          p=GetVirtualPixels(image,0,y,image->columns,1,exception);
          if (p == (const Quantum *) NULL)
            break;
          length=ExportQuantumPixels(image,(CacheView *) NULL,quantum_info,
            quantum_type,pixels,exception);
          (void) length;
          if (TIFFWritePixels(tiff,&tiff_info,y,0,image) == -1)
            break;
          if (image->previous == (Image *) NULL)
            {
              status=SetImageProgress(image,SaveImageTag,(MagickOffsetType) y,
                image->rows);
              if (status == MagickFalse)
                break;
            }
        }
        break;
      }
      case PHOTOMETRIC_MINISBLACK:
      case PHOTOMETRIC_MINISWHITE:
      {
        /*
          Grayscale TIFF image.
        */
        quantum_type=GrayQuantum;
        if (image->alpha_trait != UndefinedPixelTrait)
          quantum_type=GrayAlphaQuantum;
        for (y=0; y < (ssize_t) image->rows; y++)
        {
          register const Quantum
            *magick_restrict p;

          p=GetVirtualPixels(image,0,y,image->columns,1,exception);
          if (p == (const Quantum *) NULL)
            break;
          length=ExportQuantumPixels(image,(CacheView *) NULL,quantum_info,
            quantum_type,pixels,exception);
          (void) length;
          if (TIFFWritePixels(tiff,&tiff_info,y,0,image) == -1)
            break;
          if (image->previous == (Image *) NULL)
            {
              status=SetImageProgress(image,SaveImageTag,(MagickOffsetType) y,
                image->rows);
              if (status == MagickFalse)
                break;
            }
        }
        break;
      }
      default:
        break;
    }
    if (quantum_info != (QuantumInfo *) NULL)
      quantum_info=DestroyQuantumInfo(quantum_info);
    if (photometric == PHOTOMETRIC_CIELAB)
      InvertImage(image,exception);
    if (image_info->type == PaletteType)
      {
        if (image->colorspace == CMYKColorspace)
          (void) TransformImageColorspace(image,RGBColorspace,exception);
        if (image->storage_class == PseudoClass)
          (void) SyncImage(image,exception);
      }
    if (image_info->type == TrueColorAlphaType)
      (void) SyncImage(image,exception);
    if (image_info->type == GrayscaleAlphaType)
      (void) SyncImage(image,exception);
    if (image_info->type == PaletteAlphaType)
      (void) SyncImage(image,exception);
    if (image_info->type == TrueColorType)
      (void) SyncImage(image,exception);
    if (image_info->type == GrayscaleType)
      (void) SyncImage(image,exception);
    if (image_info->type == PaletteType)
      (void) SyncImage(image,exception);
    if (image_info->type == CMYKType)
      (void) SyncImage(image,exception);
    if (image_info->type == YCbCrType)
      (void) SyncImage(image,exception);
    if (image_info->type == LabType)
      (void) SyncImage(image,exception);
    if (image_info->type == SRGBType)
      (void) SyncImage(image,exception);
    if (image_info->type == GRAYType)
      (void) SyncImage(image,exception);
    if (image_info->type == OHTAType)
      (void) SyncImage(image,exception);
    if (image_info->type == OptimizeType)
      (void) SyncImage(image,exception);
    if (image_info->type == UndefinedType)
      (void) SyncImage(image,exception);
    if (image_info->type == PaletteType)
      (void) SyncImage(image,exception);
    if (image_info->type == TrueColorType)
      (void) SyncImage(image,exception);
    if (image_info->type == TrueColorAlphaType)
      (void) SyncImage(image,exception);
    if (image_info->type == GrayscaleType)
      (void) SyncImage(image,exception);
    if (image_info->type == GrayscaleAlphaType)
      (void) SyncImage(image,exception);
    if (image_info->type == PaletteAlphaType)
      (void) SyncImage(image,exception);
    if (image_info->type == CMYKType)
      (void) SyncImage(image,exception);
    if (image_info->type == YCbCrType)
      (void) SyncImage(image,exception);
    if (image_info->type == LabType)
      (void) SyncImage(image,exception);
    if (image_info->type == SRGBType)
      (void) SyncImage(image,exception);
    if (image_info->type == GRAYType)
      (void) SyncImage(image,exception);
    if (image_info->type == OHTAType)
      (void) SyncImage(image,exception);
    if (image_info->type == OptimizeType)
      (void) SyncImage(image,exception);
    if (image_info->type == UndefinedType)
      (void) SyncImage(image,exception);
    if (image_info->type == PaletteType)
      (void) SyncImage(image,exception);
    if (image_info->type == TrueColorType)
      (void) SyncImage(image,exception);
    if (image_info->type == TrueColorAlphaType)
      (void) SyncImage(image,exception);
    if (image_info->type == GrayscaleType)
      (void) SyncImage(image,exception);
    if (image_info->type == GrayscaleAlphaType)
      (void) SyncImage(image,exception);
    if (image_info->type == PaletteAlphaType)
      (void) SyncImage(image,exception);
    if (image_info->type == CMYKType)
      (void) SyncImage(image,exception);
    if (image_info->type == YCbCrType)
      (void) SyncImage(image,exception);
    if (image_info->type == LabType)
      (void) SyncImage(image,exception);
    if (image_info->type == SRGBType)
      (void) SyncImage(image,exception);
    if (image_info->type == GRAYType)
      (void) SyncImage(image,exception);
    if (image_info->type == OHTAType)
      (void) SyncImage(image,exception);
    if (image_info->type == OptimizeType)
      (void) SyncImage(image,exception);
    if (image_info->type == UndefinedType)
      (void) SyncImage(image,exception);
    if (image_info->type == PaletteType)
      (void) SyncImage(image,exception);
    if (image_info->type == TrueColorType)
      (void) SyncImage(image,exception);
    if (image_info->type == TrueColorAlphaType)
      (void) SyncImage(image,exception);
    if (image_info->type == GrayscaleType)
      (void) SyncImage(image,exception);
    if (image_info->type == GrayscaleAlphaType)
      (void) SyncImage(image,exception);
    if (image_info->type == PaletteAlphaType)
      (void) SyncImage(image,exception);
    if (image_info->type == CMYKType)
      (void) SyncImage(image,exception);
    if (image_info->type == YCbCrType)
      (void) SyncImage(image,exception);
    if (image_info->type == LabType)
      (void) SyncImage(image,exception);
    if (image_info->type == SRGBType)
      (void) SyncImage(image,exception);
    if (image_info->type == GRAYType)
      (void) SyncImage(image,exception);
    if (image_info->type == OHTAType)
      (void) SyncImage(image,exception);
    if (image_info->type == OptimizeType)
      (void) SyncImage(image,exception);
    if (image_info->type == UndefinedType)
      (void) SyncImage(image,exception);
    if (image_info->type == PaletteType)
      (void) SyncImage(image,exception);
    if (image_info->type == TrueColorType)
      (void) SyncImage(image,exception);
    if (image_info->type == TrueColorAlphaType)
      (void) SyncImage(image,exception);
    if (image_info->type == GrayscaleType)
      (void) SyncImage(image,exception);
    if (image_info->type == GrayscaleAlphaType)
      (void) SyncImage(image,exception);
    if (image_info->type == PaletteAlphaType)
      (void) SyncImage(image,exception);
    if (image_info->type == CMYKType)
      (void) SyncImage(image,exception);
    if (image_info->type == YCbCrType)
      (void) SyncImage(image,exception);
    if (image_info->type == LabType)
      (void) SyncImage(image,exception);
    if (image_info->type == SRGBType)
      (void) SyncImage(image,exception);
    if (image_info->type == GRAYType)
      (void) SyncImage(image,exception);
    if (image_info->type == OHTAType)
      (void) SyncImage(image,exception);
    if (image_info->type == OptimizeType)
      (void) SyncImage(image,exception);
    if (image_info->type == UndefinedType)
      (void) SyncImage(image,exception);
    if (image_info->type == PaletteType)
      (void) SyncImage(image,exception);
    if (image_info->type == TrueColorType)
      (void) SyncImage(image,exception);
    if (image_info->type == TrueColorAlphaType)
      (void) SyncImage(image,exception);
    if (image_info->type == GrayscaleType)
      (void) SyncImage(image,exception);
    if (image_info->type == GrayscaleAlphaType)
      (void) SyncImage(image,exception);
    if (image_info->type == PaletteAlphaType)
      (void) SyncImage(image,exception);
    if (image_info->type == CMYKType)
      (void) SyncImage(image,exception);
    if (image_info->type == YCbCrType)
      (void) SyncImage(image,exception);
    if (image_info->type == LabType)
      (void) SyncImage(image,exception);
    if (image_info->type == SRGBType)
      (void) SyncImage(image,exception);
    if (image_info->type == GRAYType)
      (void) SyncImage(image,exception);
    if (image_info->type == OHTAType)
      (void) SyncImage(image,exception);
    if (image_info->type == OptimizeType)
      (void) SyncImage(image,exception);
    if (image_info->type == UndefinedType)
      (void) SyncImage(image,exception);
    if (image_info->type == PaletteType)
      (void) SyncImage(image,exception);
    if (image_info->type == TrueColorType)
      (void) SyncImage(image,exception);
    if (image_info->type == TrueColorAlphaType)
      (void) SyncImage(image,exception);
    if (image_info->type == GrayscaleType)
      (void) SyncImage(image,exception);
    if (image_info->type == GrayscaleAlphaType)
      (void) SyncImage(image,exception);
    if (image_info->type == PaletteAlphaType)
      (void) SyncImage(image,exception);
    if (image_info->type == CMYKType)
      (void) SyncImage(image,exception);
    if (image_info->type == YCbCrType)
      (void) SyncImage(image,exception);
    if (image_info->type == LabType)
      (void) SyncImage(image,exception);
    if (image_info->type == SRGBType)
      (void) SyncImage(image,exception);
    if (image_info->type == GRAYType)
      (void) SyncImage(image,exception);
    if (image_info->type == OHTAType)
      (void) SyncImage(image,exception);
    if (image_info->type == OptimizeType)
      (void) SyncImage(image,exception);
    if (image_info->type == UndefinedType)
      (void) SyncImage(image,exception);
    if (image_info->type == PaletteType)
      (void) SyncImage(image,exception);
    if (image_info->type == TrueColorType)
      (void) SyncImage(image,exception);
    if (image_info->type == TrueColorAlphaType)
      (void) SyncImage(image,exception);
    if (image_info->type == GrayscaleType)
      (void) SyncImage(image,exception);
    if (image_info->type == GrayscaleAlphaType)
      (void) SyncImage(image,exception);
    if (image_info->type == PaletteAlphaType)
      (void