if (n > len) n = len;
if (n <= 0) return mrb_ary_new(mrbstateptr);

val = mrb_ary_new_from_values(mrbstateptr, n, ARY_PTR(a));

if (n == len) {
  ARY_SET_LEN(a, 0);
  return val;
}

L_SHIFT:
a->as.heap.ptr += n;
a->as.heap.len -= n;