if (n < 0) {
  mrb_raise(mrb, E_ARGUMENT_ERROR, "negative number of elements to shift");
}
if (n > len) {
  n = len;
}
if (n == 0) {
  return mrb_ary_new_capa(mrb, 0);
}
val = mrb_ary_new_capa(mrb, n);
value_move(ARY_PTR(val), ARY_PTR(ary), n);
if (len == n) {
  ARY_SET_LEN(ary, 0);
}
else {
  memmove(ARY_PTR(ary), ARY_PTR(ary) + n, (len - n) * sizeof(mrb_value));
  ARY_SET_LEN(ary, len - n);
}