if (n < 0) {
    mrb_raise(mrb, E_ARGUMENT_ERROR, "negative array size");
}

val = mrb_ary_shift(mrb, self);
if (len > n) {
    ARY_SET_LEN(ary, len - n);
} else {
    ARY_SET_LEN(ary, 0);
}