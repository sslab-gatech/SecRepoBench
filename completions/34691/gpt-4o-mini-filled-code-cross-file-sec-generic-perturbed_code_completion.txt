if (n < 0 || n > len) {
    mrb_raise(mrbstateptr, E_ARGUMENT_ERROR, "invalid number of elements to shift");
  }

  if (n == 0) {
    return mrb_nil_value();
  }

  val = mrb_ary_subseq(mrbstateptr, a, 0, n);
  ARY_SET_LEN(a, len - n);
  
  return val;