if (n < 0) {
    mrb_raise(mrbstateptr, E_ARGUMENT_ERROR, "negative array size");
  }
  if (len <= n) {
    val = mrb_ary_new(mrbstateptr);
    ARY_SET_LEN(a, 0);
  }
  else {
    val = mrb_ary_new_from_values(mrbstateptr, n, ARY_PTR(a));
    L_SHIFT:
    mrb_int size = len - n;
    mrb_value *ptr = ARY_PTR(a);
    if (size > 0) {
      value_move(ptr, ptr + n, size);
    }
    ARY_SET_LEN(a, size);
  }