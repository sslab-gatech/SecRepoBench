/*
              Named macro (e.g. push graphic-context "wheel").
            */
            GetNextToken(q,&q,length,name);
            start=q;
            for (n=1; *q != '\0'; )
            {
              GetNextToken(q,&q,length,token);
              if (*token == '\0')
                break;
              if (LocaleCompare(token,"push") == 0)
                {
                  n++;
                  continue;
                }
              if (LocaleCompare(token,"pop") == 0)
                {
                  n--;
                  if (n == 0)
                    break;
                }
            }
            end=q-1;
            if (n == 0)
              {
                char
                  *definition;

                definition=AcquireString(start);
                definition[end-start]='\0';
                (void) AddValueToSplayTree(macros,ConstantString(name),
                  definition);
              }
          }
        }
      }
    }
  token=DestroyString(token);
  return(macros);
}