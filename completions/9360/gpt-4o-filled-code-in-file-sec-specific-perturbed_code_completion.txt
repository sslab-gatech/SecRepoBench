/*
              Named macro (e.g. push graphic-context "wheel").
            */
            GetNextToken(q,&q,length,name);
            start=q;
            for (n=1; *q != '\0'; )
            {
              GetNextToken(q,&q,length,token);
              if (*token == '\0')
                break;
              if (LocaleCompare(token,"push") == 0)
                {
                  n++;
                  continue;
                }
              if (LocaleCompare(token,"pop") == 0)
                {
                  n--;
                  if (n == 0)
                    break;
                }
            }
            end=q-1;
            if (n == 0)
              {
                char
                  *macro;

                macro=(char *) AcquireQuantumMemory((size_t) (end-start+1),
                  sizeof(*macro));
                if (macro == (char *) NULL)
                  ThrowFatalException(ResourceLimitFatalError,
                    "MemoryAllocationFailed");
                (void) CopyMagickString(macro,start,(size_t) (end-start+1));
                (void) AddValueToSplayTree(macros,ConstantString(name),macro);
              }
          }