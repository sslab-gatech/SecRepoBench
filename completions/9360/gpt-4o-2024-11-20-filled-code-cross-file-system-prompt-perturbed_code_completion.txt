end=q;
            while (*q != '\0')
            {
              GetNextToken(q,&q,length,token);
              if (LocaleCompare("pop",token) == 0)
                {
                  GetNextToken(q,&q,length,token);
                  if (LocaleCompare("graphic-context",token) == 0)
                    break;
                }
            }
            end=q-1;
            n=(ssize_t) (end-start);
            if (n > 0)
              {
                p=start;
                while ((isspace((int) ((unsigned char) *p)) != 0) && (n > 0))
                {
                  p++;
                  n--;
                }
                while ((n > 0) && (isspace((int) ((unsigned char) *(p+n-1))) != 0))
                  n--;
                (void) CopyMagickString(name,token,MagickPathExtent);
                (void) AddValueToSplayTree(macros,ConstantString(name),
                  ConstantString(p));
              }