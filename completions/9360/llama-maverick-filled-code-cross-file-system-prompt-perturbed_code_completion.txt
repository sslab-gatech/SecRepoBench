{
  ssize_t
    count,
    n;

  SplayTreeInfo
    *context;

  /*
    Named macro (e.g. push graphic-context "wheel").
  */
  count=0;
  n=0;
  (void) CopyMagickString(name,token,MagickPathExtent);
  context=GetSplayTreeInfo();
  for (p=start; *q != '\0'; )
  {
    GetNextToken(p,&p,length,token);
    if (*token == '\0')
      break;
    if (LocaleCompare("push",token) == 0)
      {
        count++;
        continue;
      }
    if (LocaleCompare("pop",token) == 0)
      {
        count--;
        if (count <= 0)
          break;
        continue;
      }
    if (count <= 0)
      {
        const char
          *key;

        key=ConstantString(name);
        (void) AddValueToSplayTree(context,key,ConstantString(start));
      }
    n++;
  }
  if (n != 0)
    (void) AddValueToSplayTree(macros,name,ConstantString(start));
  context=DestroySplayTree(context);
}