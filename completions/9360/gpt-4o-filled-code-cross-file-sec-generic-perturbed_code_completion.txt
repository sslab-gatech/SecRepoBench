GetNextToken(q,&q,length,token);
            if (LocaleCompare("graphic-context",token) == 0)
              {
                for (p=q; *p != '\0'; )
                {
                  GetNextToken(p,&p,length,token);
                  if (LocaleCompare("pop",token) == 0)
                    {
                      GetNextToken(p,&p,length,token);
                      if (LocaleCompare("graphic-context",token) == 0)
                        break;
                    }
                }
                end=p;
                n=(ssize_t) (end-start);
                if (n > 0)
                  {
                    char
                      *macro;

                    macro=(char *) AcquireQuantumMemory(n+MagickPathExtent,
                      sizeof(*macro));
                    if (macro == (char *) NULL)
                      ThrowMagickFatalException(ResourceLimitFatalError,
                        "MemoryAllocationFailed",primitive);
                    (void) CopyMagickString(macro,"push ",MagickPathExtent);
                    (void) ConcatenateMagickString(macro,start,n+MagickPathExtent);
                    (void) AddValueToSplayTree(macros,ConstantString(name),
                      macro);
                  }
              }