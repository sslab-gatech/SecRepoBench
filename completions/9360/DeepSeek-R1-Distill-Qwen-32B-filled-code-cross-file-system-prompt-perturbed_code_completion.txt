/*
      Extract macro definition.
    */
    n=1;
    while (*q != '\0')
    {
      GetNextToken(q,&q,length,token);
      if (*token == '\0')
        break;
      if (*token == '#')
        {
          while ((*q != '\n') && (*q != '\0'))
            q++;
          continue;
        }
      if (LocaleCompare("push",token) == 0)
        n++;
      if (LocaleCompare("pop",token) == 0)
        {
          n--;
          if (n == 0)
            break;
        }
      (void) ConcatenateMagickString(name,token,MagickPathExtent);
      (void) ConcatenateMagickString(name," ",MagickPathExtent);
    }
    name[strlen(name)-1]='\0';
    (void) AddValueToSplayTree(macros,name,name);