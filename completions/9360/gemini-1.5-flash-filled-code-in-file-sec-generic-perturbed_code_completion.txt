end=q;
            while ((*q != '\n') && (*q != '\0'))
              q++;
            (void) CopyMagickString(name,start,(size_t) (end-start));
            (void) SetValueInSplayTree(macros,name,AcquireString(start));
          }
        else
          {
            /*
              Unnamed macro (e.g. push graphic-context { ... }).
            */
            char
              *name;

            const char
              *p;

            size_t
              length;

            name=AcquireString(token);
            length=strlen(name)+MagickPathExtent;
            p=q;
            while ((*q != '\0') && (LocaleCompare("pop",token) != 0))
            {
              GetNextToken(q,&q,length,token);
              if (*token == '#')
                {
                  /*
                    Skip comment.
                  */
                  while ((*q != '\n') && (*q != '\0'))
                    q++;
                  continue;
                }
              (void) ConcatenateString(&name,token);
              (void) ConcatenateString(&name," ");
            }
            (void) SetValueInSplayTree(macros,"unnamed",AcquireString(name));
            name=DestroyString(name);
          }
        q++;
        continue;
      }
    if (LocaleCompare("pop",token) == 0)
      {
        GetNextToken(q,&q,length,token);
        if (*q == '"')
          {
            /*
              Named macro (e.g. pop graphic-context "wheel").
            */
            const char
              *p;

            GetNextToken(q,&q,length,token);
            p=q;
            while ((*q != '\n') && (*q != '\0'))
              q++;
            (void) SetValueInSplayTree(macros,token,AcquireString(p));
          }
      }