GetNextToken(q,&q,length,token);
            if (*token == '"')
              {
                GetNextToken(q,&q,length,token);
                if (strlen(token) > 0 && length > strlen(token))
                {
                  (void) CopyMagickString(name,token,MagickPathExtent);
                  (void) AddValueToSplayTree(macros,ConstantString(name),ConstantString(token));
                }
              }
            else
              {
                (void) CopyMagickString(name,token,MagickPathExtent);
                GetNextToken(q,&q,length,token);
                if (strlen(token) > 0 && length > strlen(token))
                {
                  (void) AddValueToSplayTree(macros,ConstantString(name),ConstantString(token));
                }
              }