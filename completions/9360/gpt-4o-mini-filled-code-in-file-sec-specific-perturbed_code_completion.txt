ssize_t
              n;

            n=0;
            while (1)
            {
              GetNextToken(q,&q,length,token);
              if (*token == '\0')
                break;
              if (*token == '#')
                {
                  while ((*q != '\n') && (*q != '\0'))
                    q++;
                  continue;
                }
              if (LocaleCompare("pop",token) == 0)
                break;
              (void) CloneString(&macros->key,token);
              GetNextToken(q,&q,length,token);
              if (*token == '\0')
                break;
              if (*token == '#')
                {
                  while ((*q != '\n') && (*q != '\0'))
                    q++;
                  continue;
                }
              (void) CloneString(&macros->value,token);
              InsertSplayTree(macros,macros->key,macros->value);
            }