for (end=q; *end != '\0'; )
            {
              if (*end == '#')
                {
                  /*
                    Skip comment.
                  */
                  while ((*end != '\n') && (*end != '\0'))
                    end++;
                  continue;
                }
              GetNextToken(end,&end,length,token);
              if (LocaleCompare("pop",token) == 0)
                break;
            }
            if ((end == (char *) NULL) || ((end-4) < start))
              {
                status=MagickFalse;
                break;
              }
            (void) CopyMagickString(token,start,(size_t) (end-start-4+1));
            (void) AddValueToSplayTree(macros,AcquireString(name),
              AcquireString(token));
            q=end+4;