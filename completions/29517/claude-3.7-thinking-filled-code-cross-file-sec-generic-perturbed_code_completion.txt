if ( H5Aexists_by_name(dset_id, ".", "MATLAB_fields", H5P_DEFAULT) ) {
    err = Mat_H5ReadFieldNames(matvariable, dset_id, &nfields);
    if ( err ) {
        return err;
    }
} else {
    hsize_t num_links = 0;
    H5G_info_t group_info;
    herr_t herr = H5Gget_info(dset_id, &group_info);
    if ( herr < 0 ) {
        return MATIO_E_GENERIC_READ_ERROR;
    }
    num_links = group_info.nlinks;
    
    if ( num_links > 0 ) {
        struct ReadGroupInfoIterData group_data;
        group_data.nfields = 0;
        group_data.matvar = NULL;
        
        /* First iteration to get number of fields */
        herr = H5Literate(dset_id, H5_INDEX_NAME, H5_ITER_NATIVE, NULL,
                          Mat_H5ReadGroupInfoIterate, (void *)&group_data);
        if ( herr < 0 ) {
            return MATIO_E_GENERIC_READ_ERROR;
        }
        
        nfields = group_data.nfields;
        if ( nfields > 0 ) {
            matvariable->internal->num_fields = nfields;
            matvariable->internal->fieldnames = 
                (char**)calloc(nfields, sizeof(*matvariable->internal->fieldnames));
            if ( NULL != matvariable->internal->fieldnames ) {
                group_data.nfields = 0;
                group_data.matvar = matvariable;
                
                /* Second iteration to get field names */
                herr = H5Literate(dset_id, H5_INDEX_NAME, H5_ITER_NATIVE, NULL,
                                 Mat_H5ReadGroupInfoIterate, (void *)&group_data);
                if ( herr < 0 ) {
                    return MATIO_E_GENERIC_READ_ERROR;
                }
            } else {
                err = MATIO_E_OUT_OF_MEMORY;
                return err;
            }
        }
    }
}