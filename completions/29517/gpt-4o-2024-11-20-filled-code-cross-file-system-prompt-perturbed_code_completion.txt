if ( H5Aexists_by_name(dset_id, ".", "MATLAB_fields", H5P_DEFAULT) ) {
        attr_id = H5Aopen_by_name(dset_id, ".", "MATLAB_fields", H5P_DEFAULT, H5P_DEFAULT);
        if ( attr_id < 0 ) {
            return MATIO_E_GENERIC_READ_ERROR;
        }

        hid_t attr_type = H5Aget_type(attr_id);
        hid_t attr_space = H5Aget_space(attr_id);
        hsize_t attr_size = H5Aget_storage_size(attr_id);

        if ( H5T_STRING == H5Tget_class(attr_type) && H5S_SIMPLE == H5Sget_simple_extent_type(attr_space) ) {
            hsize_t dims;
            H5Sget_simple_extent_dims(attr_space, &dims, NULL);
            nfields = dims;

            matvariable->internal->fieldnames = (char**)calloc((size_t)nfields, sizeof(*matvariable->internal->fieldnames));
            if ( NULL != matvariable->internal->fieldnames ) {
                char *fieldnames = (char*)malloc((size_t)attr_size);
                if ( NULL != fieldnames ) {
                    H5Aread(attr_id, attr_type, fieldnames);
                    for ( hsize_t i = 0; i < nfields; i++ ) {
                        matvariable->internal->fieldnames[i] = strdup(fieldnames + i * H5Tget_size(attr_type));
                    }
                    free(fieldnames);
                } else {
                    H5Aclose(attr_id);
                    H5Tclose(attr_type);
                    H5Sclose(attr_space);
                    return MATIO_E_OUT_OF_MEMORY;
                }
            } else {
                H5Aclose(attr_id);
                H5Tclose(attr_type);
                H5Sclose(attr_space);
                return MATIO_E_OUT_OF_MEMORY;
            }
        }

        H5Aclose(attr_id);
        H5Tclose(attr_type);
        H5Sclose(attr_space);
    } else {
        H5G_info_t group_info;
        if ( H5Gget_info(dset_id, &group_info) < 0 ) {
            return MATIO_E_GENERIC_READ_ERROR;
        }

        nfields = group_info.nlinks;
        matvariable->internal->fieldnames = (char**)calloc((size_t)nfields, sizeof(*matvariable->internal->fieldnames));
        if ( NULL == matvariable->internal->fieldnames ) {
            return MATIO_E_OUT_OF_MEMORY;
        }

        struct ReadGroupInfoIterData group_data = { matvariable, 0 };
        herr_t herr = H5Literate(dset_id, H5_INDEX_NAME, H5_ITER_NATIVE, NULL, Mat_H5ReadGroupInfoIterate, &group_data);
        if ( herr < 0 ) {
            free(matvariable->internal->fieldnames);
            matvariable->internal->fieldnames = NULL;
            return MATIO_E_GENERIC_READ_ERROR;
        }
    }