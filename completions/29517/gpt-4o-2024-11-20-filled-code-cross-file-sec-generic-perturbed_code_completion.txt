if ( H5Aexists_by_name(dset_id, ".", "MATLAB_fields", H5P_DEFAULT) ) {
        /* Read the MATLAB_fields attribute to get the field names */
        attr_id = H5Aopen_by_name(dset_id, ".", "MATLAB_fields", H5P_DEFAULT, H5P_DEFAULT);
        if ( attr_id < 0 ) {
            return MATIO_E_GENERIC_READ_ERROR;
        }

        hid_t attr_type = H5Aget_type(attr_id);
        hid_t attr_space = H5Aget_space(attr_id);
        hsize_t attr_size = H5Sget_simple_extent_npoints(attr_space);

        if ( H5T_STRING == H5Tget_class(attr_type) && attr_size > 0 ) {
            matvariable->internal->fieldnames = (char**)calloc((size_t)attr_size, sizeof(char*));
            if ( NULL == matvariable->internal->fieldnames ) {
                H5Aclose(attr_id);
                H5Tclose(attr_type);
                H5Sclose(attr_space);
                return MATIO_E_OUT_OF_MEMORY;
            }

            char **fieldnames = (char**)calloc((size_t)attr_size, sizeof(char*));
            if ( NULL == fieldnames ) {
                free(matvariable->internal->fieldnames);
                H5Aclose(attr_id);
                H5Tclose(attr_type);
                H5Sclose(attr_space);
                return MATIO_E_OUT_OF_MEMORY;
            }

            herr_t herr = H5Aread(attr_id, attr_type, fieldnames);
            if ( herr < 0 ) {
                free(fieldnames);
                free(matvariable->internal->fieldnames);
                H5Aclose(attr_id);
                H5Tclose(attr_type);
                H5Sclose(attr_space);
                return MATIO_E_GENERIC_READ_ERROR;
            }

            for ( hsize_t i = 0; i < attr_size; i++ ) {
                matvariable->internal->fieldnames[i] = strdup(fieldnames[i]);
                if ( NULL == matvariable->internal->fieldnames[i] ) {
                    for ( hsize_t j = 0; j < i; j++ ) {
                        free(matvariable->internal->fieldnames[j]);
                    }
                    free(fieldnames);
                    free(matvariable->internal->fieldnames);
                    H5Aclose(attr_id);
                    H5Tclose(attr_type);
                    H5Sclose(attr_space);
                    return MATIO_E_OUT_OF_MEMORY;
                }
            }

            free(fieldnames);
            nfields = attr_size;
        }

        H5Aclose(attr_id);
        H5Tclose(attr_type);
        H5Sclose(attr_space);
    } else {
        /* If MATLAB_fields attribute does not exist, count the number of links in the group */
        H5G_info_t group_info;
        herr_t herr = H5Gget_info(dset_id, &group_info);
        if ( herr < 0 ) {
            return MATIO_E_GENERIC_READ_ERROR;
        }

        nfields = group_info.nlinks;
        if ( nfields > 0 ) {
            matvariable->internal->fieldnames = (char**)calloc((size_t)nfields, sizeof(char*));
            if ( NULL == matvariable->internal->fieldnames ) {
                return MATIO_E_OUT_OF_MEMORY;
            }

            struct ReadGroupInfoIterData group_data = { matvariable, 0 };
            herr = H5Literate(dset_id, H5_INDEX_NAME, H5_ITER_NATIVE, NULL,
                              Mat_H5ReadGroupInfoIterate, &group_data);
            if ( herr < 0 ) {
                for ( hsize_t i = 0; i < nfields; i++ ) {
                    free(matvariable->internal->fieldnames[i]);
                }
                free(matvariable->internal->fieldnames);
                return MATIO_E_GENERIC_READ_ERROR;
            }
        }
    }