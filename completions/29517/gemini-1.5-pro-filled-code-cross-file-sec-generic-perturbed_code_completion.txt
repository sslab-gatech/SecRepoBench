if ( H5Aexists_by_name(dset_id,".","MATLAB_fields",H5P_DEFAULT) ) {
        err = Mat_H5ReadFieldNames(matvariable,dset_id,&nfields);
        if ( err ) {
            return err;
        }
    } else {
        H5G_info_t group_info;
        herr_t herr = H5Gget_info(dset_id, &group_info);
        if ( herr < 0 ) {
            return MATIO_E_GENERIC_READ_ERROR;
        }
        nfields = group_info.nlinks;
        if ( nfields > 0 ) {
            struct ReadGroupInfoIterData group_data = {matvariable, 0};
            herr = H5Literate_by_name(dset_id, ".", H5_INDEX_NAME, H5_ITER_INC, 0,
                           Mat_H5ReadGroupInfoIterate, &group_data, H5P_DEFAULT);
            if ( herr < 0 ) {
                return MATIO_E_GENERIC_READ_ERROR;
            }
            nfields = group_data.nfields;
            matvariable->internal->num_fields = nfields;
        }
    }
    matvariable->class_type = MAT_C_STRUCT;