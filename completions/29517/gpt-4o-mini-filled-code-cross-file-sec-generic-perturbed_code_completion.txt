if ( H5Aexists_by_name(dset_id,".","MATLAB_fields",H5P_DEFAULT) ) {
        hsize_t nfields;
        err = Mat_H5ReadFieldNames(matvariable, dset_id, &nfields);
        if ( err < 0 ) {
            return err;
        }
        fields = (matvar_t**)calloc(nfields, sizeof(matvar_t*));
        if ( fields == NULL ) {
            return MATIO_E_OUT_OF_MEMORY;
        }
        matvariable->internal->fieldnames = (char**)calloc(nfields, sizeof(char*));
        if ( matvariable->internal->fieldnames == NULL ) {
            free(fields);
            return MATIO_E_OUT_OF_MEMORY;
        }
        nfields = nfields; // Update the number of fields
    } else {
        // Retrieve the number of links in the dataset group
        struct ReadGroupInfoIterData group_data;
        group_data.matvar = matvariable;
        group_data.nfields = 0;

        H5Literate(dset_id, H5_INDEX_NAME, H5_ITER_NATIVE, NULL, Mat_H5ReadGroupInfoIterate, &group_data);
        nfields = group_data.nfields;

        if ( nfields > 0 ) {
            fields = (matvar_t**)calloc(nfields, sizeof(matvar_t*));
            if ( fields == NULL ) {
                return MATIO_E_OUT_OF_MEMORY;
            }
            matvariable->internal->fieldnames = (char**)calloc(nfields, sizeof(char*));
            if ( matvariable->internal->fieldnames == NULL ) {
                free(fields);
                return MATIO_E_OUT_OF_MEMORY;
            }
            for ( size_t i = 0; i < nfields; i++ ) {
                matvariable->internal->fieldnames[i] = strdup(group_data.matvar->internal->fieldnames[i]);
            }
        }
    }