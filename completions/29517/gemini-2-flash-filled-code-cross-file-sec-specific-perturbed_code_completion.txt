if ( H5Aexists_by_name(dset_id,".","MATLAB_fields",H5P_DEFAULT) ) {
        err = Mat_H5ReadFieldNames(matvariable, dset_id, &nfields);
        if ( err ) {
            return err;
        }
    } else {
        H5G_info_t group_info;
#if H5_VERSION_GE(1,14,0)
        err = H5Gget_info(dset_id,&group_info);
#else
        err = H5Gget_info(dset_id,&group_info.nlinks);
#endif
        if ( err < 0 ) {
            return MATIO_E_GENERIC_READ_ERROR;
        }
        if ( group_info.nlinks > 0 ) {
            struct ReadGroupInfoIterData iter_data;

            matvariable->internal->fieldnames = (char**)
                malloc(group_info.nlinks*sizeof(*matvariable->internal->fieldnames));
            if ( NULL == matvariable->internal->fieldnames ) {
                return MATIO_E_OUT_OF_MEMORY;
            }
            iter_data.matvar  = matvariable;
            iter_data.nfields = 0;
            H5Literate(dset_id,H5_INDEX_NAME,H5_ITER_INC,NULL,
                       Mat_H5ReadGroupInfoIterate,&iter_data);
            nfields = iter_data.nfields;
        }
    }
    matvariable->internal->num_fields = nfields;