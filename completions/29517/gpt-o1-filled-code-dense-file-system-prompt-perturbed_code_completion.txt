if ( H5Aexists_by_name(dset_id,".","MATLAB_fields",H5P_DEFAULT) ) {
        hsize_t tmp_nfields;
        err = Mat_H5ReadFieldNames(matvariable, dset_id, &tmp_nfields);
        if ( err ) {
            return err;
        }
        nfields = tmp_nfields;
    } else {
        H5G_info_t ginfo;
        err = H5Gget_info(dset_id, &ginfo);
        if ( err < 0 ) {
            return MATIO_E_GENERIC_READ_ERROR;
        }
        if ( ginfo.nlinks > 0 ) {
            hsize_t i, valid_fields = 0;
            matvariable->internal->fieldnames = (char**)calloc((size_t)ginfo.nlinks, sizeof(*matvariable->internal->fieldnames));
            if ( NULL == matvariable->internal->fieldnames ) {
                return MATIO_E_OUT_OF_MEMORY;
            }
            for ( i = 0; i < ginfo.nlinks; i++ ) {
                char obj_name[256];
                ssize_t len = H5Lget_name_by_idx(dset_id,".",H5_INDEX_NAME,H5_ITER_INC,
                                                 i,obj_name,sizeof(obj_name),H5P_DEFAULT);
                if ( len < 0 ) {
                    continue;
                }
                /* Skip names that start with "MATLAB_" as they are likely attributes */
                if ( !strncmp(obj_name, "MATLAB_", 7) ) {
                    continue;
                }
                matvariable->internal->fieldnames[valid_fields] = strdup(obj_name);
                if ( NULL == matvariable->internal->fieldnames[valid_fields] ) {
                    err = MATIO_E_OUT_OF_MEMORY;
                    break;
                }
                valid_fields++;
            }
            matvariable->internal->num_fields = (unsigned int)valid_fields;
            nfields = valid_fields;
        }
    }