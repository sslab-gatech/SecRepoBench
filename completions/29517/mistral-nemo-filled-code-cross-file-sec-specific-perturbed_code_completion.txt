if ( H5Aexists_by_name(dset_id,".","MATLAB_fields",H5P_DEFAULT) ) {
        hsize_t nfields;
        err = Mat_H5ReadFieldNames(matvar, dset_id, &nfields);
        if ( err < 0 ) {
            return err;
        }

        if ( nfields > 0 ) {
            matvar->internal->fieldnames = (char**)calloc(nfields, sizeof(char*));
            if ( NULL != matvar->internal->fieldnames ) {
                struct ReadGroupInfoIterData group_data;
                group_data.matvar = matvar;
                group_data.nfields = 0;
                err = H5Literate(dset_id, H5_INDEX_NAME, H5_ITERATE_SORTED, NULL, Mat_H5ReadGroupInfoIterate, &group_data);
                if ( err < 0 ) {
                    free(matvar->internal->fieldnames);
                    matvar->internal->fieldnames = NULL;
                }
            } else {
                err = MATIO_E_OUT_OF_MEMORY;
            }
        }
    } else {
        if ( H5Lexists(dset_id,"#refs#",H5P_DEFAULT) ) {
            hid_t refs_id = H5Gopen(dset_id,"#refs#",H5P_DEFAULT);
            if ( refs_id >= 0 ) {
                hsize_t nfields;
                err = Mat_H5ReadRefsInfo(matvar, refs_id, &nfields);
                if ( err < 0 ) {
                    H5Gclose(refs_id);
                    return err;
                }

                if ( nfields > 0 ) {
                    matvar->internal->fieldnames = (char**)calloc(nfields, sizeof(char*));
                    if ( NULL != matvar->internal->fieldnames ) {
                        hsize_t k;
                        for ( k = 0; k < nfields; k++ ) {
                            matvar->internal->fieldnames[k] = strdup(matvar->internal->fieldnames[k]);
                        }
                    } else {
                        err = MATIO_E_OUT_OF_MEMORY;
                    }
                }
                H5Gclose(refs_id);
            } else {
                err = MATIO_E_GENERIC_READ_ERROR;
            }
        } else {
            /* Count the number of links in the dataset group */
            hsize_t nfields = 0;
            H5G_info_t group_info;
            H5Gget_info(dset_id, &group_info, H5P_DEFAULT);
            nfields = group_info.nlinks;

            if ( nfields > 0 ) {
                matvar->internal->fieldnames = (char**)calloc(nfields, sizeof(char*));
                if ( NULL != matvar->internal->fieldnames ) {
                    struct ReadGroupInfoIterData group_data;
                    group_data.matvar = matvar;
                    group_data.nfields = 0;
                    err = H5Literate(dset_id, H5_INDEX_NAME, H5_ITERATE_SORTED, NULL, Mat_H5ReadGroupInfoIterate, &group_data);
                    if ( err < 0 ) {
                        free(matvar->internal->fieldnames);
                        matvar->internal->fieldnames = NULL;
                    }
                } else {
                    err = MATIO_E_OUT_OF_MEMORY;
                }
            }
        }
    }

    if ( err < 0 ) {
        return err;
    }

    matvar->internal->num_fields = nfields;
    return MATIO_E_NO_ERROR;