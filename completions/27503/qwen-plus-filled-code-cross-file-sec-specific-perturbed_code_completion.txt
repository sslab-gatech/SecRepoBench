switch (tag)
{
	case ID_SCE:  // Single Channel Element (Mono)
		// Read element instance tag
		elementInstanceTag = BitBufferReadSmall(bits, 4);

		// Handle mono channel decoding
		status = DecodeMono(p, bits, sampleBuffer + channelIndex, numSamples);
		if (status != ALAC_noErr)
			goto Exit;

		channelIndex++;
		break;

	case ID_CPE:  // Channel Pair Element (Stereo)
		// Read element instance tag
		elementInstanceTag = BitBufferReadSmall(bits, 4);

		// Ensure we don't exceed channel limits
		if ((channelIndex + 1) >= numChannels)
		{
			status = kALAC_ParamError;
			goto Exit;
		}

		// Handle stereo channel pair decoding
		status = DecodeStereo(p, bits, sampleBuffer + channelIndex, numSamples);
		if (status != ALAC_noErr)
			goto Exit;

		channelIndex += 2;
		break;

	case ID_LFE:  // Low Frequency Effects (LFE) Element (Subwoofer)
		// Read element instance tag
		elementInstanceTag = BitBufferReadSmall(bits, 4);

		// Handle LFE channel decoding
		status = DecodeMono(p, bits, sampleBuffer + channelIndex, numSamples);
		if (status != ALAC_noErr)
			goto Exit;

		channelIndex++;
		break;

	default:
		// Unsupported element type
		status = kALAC_UnsupportedOperation;
		goto Exit;
}

// Align bitstream to byte boundaries
BitBufferByteAlign(bits, true);

// Check for partial frame indicator
partialFrame = BitBufferReadSmall(bits, 1);
if (partialFrame)
{
	// Read number of samples in the partial frame
	extraBits = BitBufferReadSmall(bits, 32);
	numSamples = extraBits;
}