switch (tag)
{
	case 0x0:
	case 0x1:
	case 0x2:
	case 0x3:
	case 0x4:
	case 0x5:
	case 0x6:
	case 0x7:
		// read header parameters
		headerByte = BitBufferReadSmall (bits, 8) ;
		partialFrame = headerByte & 0x80 ;
		extraBits = headerByte & 0x7F ;
		if (partialFrame)
		{
			// read partial frame parameters
			unusedHeader = BitBufferReadSmall (bits, 16) ;
			shift = BitBufferReadSmall (bits, 8) ;
			bytesShifted = BitBufferReadSmall (bits, 8) ;
			chanBits = BitBufferReadSmall (bits, 8) ;
			escapeFlag = BitBufferReadOne (bits) ;
			// read and process partial frame data
			for (i = 0 ; i < numSamples ; i++)
			{
				val = BitBufferReadSmall (bits, chanBits) ;
				if (escapeFlag)
					val = (val << 8) | BitBufferReadSmall (bits, 8) ;
				sampleBuffer [channelIndex * numSamples + i] = val ;
			}
		}
		else
		{
			// read and process full frame data
			modeU = headerByte & 0x40 ;
			modeV = headerByte & 0x20 ;
			denShiftU = headerByte & 0x1F ;
			denShiftV = headerByte & 0x1F ;
			pbFactorU = modeU? 1 : 2 ;
			pbFactorV = modeV? 1 : 2 ;
			pb = pbFactorU * pbFactorV * p->mConfig.pb ;
			numU = (pb + 7) / 8 ;
			numV = (pb + 7) / 8 ;
			// read and process predictor coefficients
			for (i = 0 ; i < numU ; i++)
				coefsU [i] = BitBufferReadSmall (bits, 16) ;
			for (i = 0 ; i < numV ; i++)
				coefsV [i] = BitBufferReadSmall (bits, 16) ;
			// read and process mix parameters
			mixBits = BitBufferReadSmall (bits, 4) ;
			mixResiduals = BitBufferReadSmall (bits, 4) ;
			// read and process audio data
			for (i = 0 ; i < numSamples ; i++)
			{
				val = BitBufferReadSmall (bits, mixBits) ;
				sampleBuffer [channelIndex * numSamples + i] = val ;
			}
		}
		break ;
	case 0x8:
		// stereo channel pair
		// read and process left channel
		channelIndex++ ;
		// read and process right channel
		channelIndex++ ;
		break ;
	case 0x9:
		// unsupported element
		status = kALAC_UnsupportedElement ;
		break ;
	case 0xA:
		// fill element
		status = alac_fill_element (bits) ;
		break ;
	case 0xB:
		// data stream element
		status = alac_data_stream_element (bits) ;
		break ;
	default:
		// unknown element
		status = kALAC_UnknownElement ;
		break ;
}

// align bitstream to byte boundaries
BitBufferByteAlign (bits, false) ;

// exit if all channels are processed or frame end is reached
if (channelIndex >= numChannels || status!= ALAC_noErr)
	break ;