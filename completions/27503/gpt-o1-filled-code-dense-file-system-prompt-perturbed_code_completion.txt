switch (tag)
{
	case ID_SCE: // Single Channel Element (mono)
		elementInstanceTag = BitBufferReadSmall(bits, 4);
		RequireAction(channelIndex + 1 <= numChannels, status = kALAC_ParamError; goto Exit;);

		// Process mono channel (including handling compressed/uncompressed frames, partial frames, etc.)
		// Decompress and reconstruct audio samples into the sampleBuffer at the correct channel offset.
		// For example: status = DecodeMonoElement(p, bits, sampleBuffer, channelIndex, numSamples, &agParams);

		channelIndex++;
		p->mActiveElements++;
		break;

	case ID_CPE: // Channel Pair Element (stereo)
		elementInstanceTag = BitBufferReadSmall(bits, 4);
		RequireAction(channelIndex + 2 <= numChannels, status = kALAC_ParamError; goto Exit;);

		// Process stereo channels similarly, reading any needed header parameters,
		// decompressing, and applying prediction to reconstruct both channels.
		// For example: status = DecodeStereoElement(p, bits, sampleBuffer, channelIndex, numSamples, &agParams);

		channelIndex += 2;
		p->mActiveElements++;
		break;

	case ID_LFE: // Low-Frequency Effects (subwoofer) channel
		elementInstanceTag = BitBufferReadSmall(bits, 4);
		RequireAction(channelIndex + 1 <= numChannels, status = kALAC_ParamError; goto Exit;);

		// LFE often handled like a mono channel.
		// For example: status = DecodeMonoElement(p, bits, sampleBuffer, channelIndex, numSamples, &agParams);

		channelIndex++;
		p->mActiveElements++;
		break;

	case ID_DSE: // Data Stream Element
		// This element carries ancillary data; call function to skip or process as needed.
		status = alac_data_stream_element(bits);
		break;

	case ID_FIL: // Fill Element
		// Fill elements are generally optional padding; ignore or skip.
		status = p->FillElement(bits);
		break;

	case ID_END: // End of frame
		goto NoMoreChannels;

	default:
		// Unsupported element type
		status = kALAC_UnimplementedErr;
		break;
}

// Align bitstream to byte boundary. Exit if we've processed all channels or encountered an error.
BitBufferByteAlign(bits, false);
if (channelIndex >= numChannels)
	goto NoMoreChannels;