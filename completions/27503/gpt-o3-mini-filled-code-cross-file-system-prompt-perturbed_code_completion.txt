if (tag == ID_END)
          break;

      // read element instance tag (4 bits)
      elementInstanceTag = BitBufferReadSmall(bits, 4);

      switch (tag)
      {
          case ID_SCE:  // Single Channel Element (mono)
          case ID_LFE:  // Low Frequency Effects channel (mono)
              status = DecodeMono(p, bits, sampleBuffer, numSamples, channelIndex);
              if (status != ALAC_noErr)
                  goto Exit;
              channelIndex++;
              break;

          case ID_CPE:  // Channel Pair Element (stereo)
              if (channelIndex + 1 >= numChannels)
              {
                  status = kALAC_ParamError;
                  goto Exit;
              }
              status = DecodeStereo(p, bits, sampleBuffer, numSamples, channelIndex);
              if (status != ALAC_noErr)
                  goto Exit;
              channelIndex += 2;
              break;

          default:
              // For unsupported or fill elements, mark as unsupported and exit
              status = kALAC_UnsupportedOperation;
              goto Exit;
      }