switch (tag)
{
    case ID_SCE:
    {
        // Mono channel element
        elementInstanceTag = BitBufferReadSmall(bits, 4);
        status = DecodeMono(p, bits, sampleBuffer + channelIndex, numSamples);
        if (status != ALAC_noErr)
            goto Exit;
        p->mActiveElements++;
        channelIndex++;
        break;
    }
    case ID_CPE:
    {
        // Stereo channel pair element
        elementInstanceTag = BitBufferReadSmall(bits, 4);
        if (channelIndex + 1 >= numChannels)
        {
            status = kALAC_ParamError;
            goto Exit;
        }
        status = DecodeStereo(p, bits, sampleBuffer + channelIndex, numSamples);
        if (status != ALAC_noErr)
            goto Exit;
        p->mActiveElements++;
        channelIndex += 2;
        break;
    }
    case ID_LFE:
    {
        // LFE channel element (handled as mono)
        elementInstanceTag = BitBufferReadSmall(bits, 4);
        status = DecodeMono(p, bits, sampleBuffer + channelIndex, numSamples);
        if (status != ALAC_noErr)
            goto Exit;
        p->mActiveElements++;
        channelIndex++;
        break;
    }
    case ID_END:
    {
        // Frame end tag, exit decoding loop
        goto NoMoreChannels;
    }
    default:
    {
        // Unsupported or filler element: skip its instance tag and align to the next byte boundary.
        elementInstanceTag = BitBufferReadSmall(bits, 4);
        BitBufferByteAlign(bits, true);
        break;
    }
}