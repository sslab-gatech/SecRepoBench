switch (tag)
        {
            case ID_SCE: // Single Channel Element (Mono)
                elementInstanceTag = BitBufferReadSmall(bits, 4);
                RequireAction(channelIndex < numChannels, status = kALAC_ParamError; goto Exit;);

                // Decode mono channel
                status = dyn_decomp(&agParams, bits, sampleBuffer + channelIndex, numSamples, numSamples, &extraBits);
                RequireNoErr(status, goto Exit;);

                channelIndex++;
                break;

            case ID_CPE: // Channel Pair Element (Stereo)
                elementInstanceTag = BitBufferReadSmall(bits, 4);
                RequireAction((channelIndex + 1) < numChannels, status = kALAC_ParamError; goto Exit;);

                // Decode stereo channels
                status = dyn_decomp(&agParams, bits, sampleBuffer + channelIndex, numSamples, numSamples, &extraBits);
                RequireNoErr(status, goto Exit;);

                status = dyn_decomp(&agParams, bits, sampleBuffer + channelIndex + 1, numSamples, numSamples, &extraBits);
                RequireNoErr(status, goto Exit;);

                channelIndex += 2;
                break;

            case ID_LFE: // Low-Frequency Effects Channel
                elementInstanceTag = BitBufferReadSmall(bits, 4);
                RequireAction(channelIndex < numChannels, status = kALAC_ParamError; goto Exit;);

                // Decode LFE channel
                status = dyn_decomp(&agParams, bits, sampleBuffer + channelIndex, numSamples, numSamples, &extraBits);
                RequireNoErr(status, goto Exit;);

                channelIndex++;
                break;

            case ID_FIL: // Fill Element
                // Skip fill elements
                escapeFlag = BitBufferReadSmall(bits, 4);
                if (escapeFlag == 0)
                {
                    uint32_t fillBits = BitBufferReadSmall(bits, 8);
                    BitBufferAdvance(bits, fillBits * 8);
                }
                else
                {
                    uint32_t fillBytes = BitBufferReadSmall(bits, 8);
                    BitBufferAdvance(bits, fillBytes * 8);
                }
                break;

            case ID_END: // End of Stream
                goto NoMoreChannels;

            default: // Unsupported Element
                status = kALAC_UnsupportedElement;
                goto Exit;
        }

        // Align bitstream to byte boundary
        BitBufferByteAlign(bits, true);