#define CheckPathExtent(need) \
  do { \
    if (p+need > stroke_limit+MaxStrokePad) { \
      size_t new_limit = stroke_limit + MaxStrokePad + need; \
      PointInfo *new_path_p = (PointInfo *) AcquireQuantumMemory(new_limit, sizeof(*path_p)); \
      if (new_path_p == (PointInfo *) NULL) { \
        path_p = (PointInfo *) RelinquishMagickMemory(path_p); \
        path_q = (PointInfo *) RelinquishMagickMemory(path_q); \
        polygon_primitive = (PrimitiveInfo *) RelinquishMagickMemory(polygon_primitive); \
        return ((PrimitiveInfo *) NULL); \
      } \
      (void) memcpy(new_path_p, path_p, p * sizeof(*path_p)); \
      path_p = (PointInfo *) RelinquishMagickMemory(path_p); \
      path_p = new_path_p; \
      PointInfo *new_path_q = (PointInfo *) AcquireQuantumMemory(new_limit, sizeof(*path_q)); \
      if (new_path_q == (PointInfo *) NULL) { \
        path_p = (PointInfo *) RelinquishMagickMemory(path_p); \
        path_q = (PointInfo *) RelinquishMagickMemory(path_q); \
        polygon_primitive = (PrimitiveInfo *) RelinquishMagickMemory(polygon_primitive); \
        return ((PrimitiveInfo *) NULL); \
      } \
      (void) memcpy(new_path_q, path_q, q * sizeof(*path_q)); \
      path_q = (PointInfo *) RelinquishMagickMemory(path_q); \
      path_q = new_path_q; \
      stroke_limit = new_limit; \
    } \
  } while (0)