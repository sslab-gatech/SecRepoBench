{
  char *new_str = NULL;
  const char *input_str = *(const char **)value;

  /* Free previously allocated memory if any */
  if (*(char **)old)
    free(*(char **)old);

  if (!input_str)
    *(char **)old = NULL;
  else
    {
      size_t alloc_size = f->size;
      new_str = (char *)malloc(alloc_size);
      if (!new_str)
        {
          /* Allocation failed; set pointer to NULL and return */
          *(char **)old = NULL;
          return;
        }
      memset(new_str, 0, alloc_size);
      /* Copy at most alloc_size - 1 characters to ensure null termination */
      strncpy(new_str, input_str, alloc_size - 1);
      new_str[alloc_size - 1] = '\0';
      *(char **)old = new_str;
    }
}