if (f->is_malloc)
  {
    // NULL ptr
    if (!*(char**)value)
      memcpy (old, value, sizeof (char*));
    // fixed length (but not yet TF)
    else if (strEQc (f->type, "TFv"))
      {
        // Allocate memory and copy the string from 'value' to a new memory block,
        // accounting for both fixed-length and dynamically allocated strings.
        // If the string is fixed-length (TFv), allocate memory according to the field's size
        // and copy the string with consideration for null-termination.
        // For ASCII strings with specific DWG versions, allocate memory based on
        // the length of the input string and copy it accordingly.
        // For wide character strings, convert UTF-8 encoded strings to a wide character format
        // if necessary, and allocate memory for the wide string before copying it.
        // If the field type is not TF and DWG version conditions are met, perform these conversions.
        // In all cases, update the pointer in 'old' to the newly allocated string memory,
        // ensuring the previous memory is freed to avoid memory leaks.
        size_t len = strlen ((const char*)value);
        if (len > f->size)
          len = f->size;
        char* new_str = malloc (len + 1);
        if (is_utf8)
          {
            // Convert UTF-8 encoded string to wide character format
            // (assuming wchar_t is 2 bytes for simplicity)
            int wide_len = (len + 1) * 2;
            wchar_t* wide_str = malloc (wide_len * sizeof (wchar_t));
            mbstowcs (wide_str, (const char*)value, len);
            // Allocate memory for the wide string
            new_str = malloc (wide_len);
            wcstombs (new_str, wide_str, wide_len);
            free (wide_str);
          }
        else
          {
            // Allocate memory for the ASCII string
            new_str = malloc (len + 1);
          }
        // Copy the string to the new memory block
        strncpy (new_str, (const char*)value, len);
        new_str[len] = '\0';
        // Update the pointer in 'old' to the newly allocated string memory
        if (*(char**)old)
          free (*(char**)old);
        *(char**)old = new_str;
      }
  }