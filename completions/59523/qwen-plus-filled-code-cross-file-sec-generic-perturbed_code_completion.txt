if (strEQc (f->type, "TFv"))
{
  size_t len = strlen ((const char*)value);
  if (len >= f->size)
    len = f->size - 1; // Ensure null-termination

  void *new_ptr = malloc (f->size);
  if (!new_ptr)
    return; // Handle memory allocation failure

  memset (new_ptr, 0, f->size); // Zero-initialize the memory
  memcpy (new_ptr, value, len);
  *(char**)old = new_ptr;
}
else if (strEQc (f->type, "T") && is_utf8)
{
  size_t len = strlen ((const char*)value) + 1;
  size_t wide_len = len * sizeof (wchar_t);
  wchar_t *wide_str = malloc (wide_len);
  if (!wide_str)
    return; // Handle memory allocation failure

  size_t converted = mbstowcs (wide_str, (const char*)value, len);
  if (converted == (size_t)-1)
  {
    free (wide_str);
    return; // Handle conversion failure
  }

  *(wchar_t**)old = wide_str;
}
else
{
  size_t len = strlen ((const char*)value) + 1;
  void *new_ptr = malloc (len);
  if (!new_ptr)
    return; // Handle memory allocation failure

  strcpy ((char*)new_ptr, (const char*)value);
  *(char**)old = new_ptr;
}