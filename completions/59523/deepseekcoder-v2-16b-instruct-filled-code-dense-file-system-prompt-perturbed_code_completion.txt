if ((char*)old && f->is_malloc)
  free (old);
if ((char*)value) {
  char *new_value = (char*)malloc(strlen((char*)value) + 1);
  if (!new_value)
    return; // Handle memory allocation failure
  strcpy(new_value, (char*)value);
  memcpy(old, &new_value, sizeof(char*));
} else {
  memcpy(old, value, f->size);
}