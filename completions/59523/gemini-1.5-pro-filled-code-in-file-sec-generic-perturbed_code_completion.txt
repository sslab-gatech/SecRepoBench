{
          if (versiontype == DWG_VERSION_AC1015 ||
              versiontype == DWG_VERSION_AC1018 ||
              versiontype == DWG_VERSION_AC1021 ||
              versiontype == DWG_VERSION_AC1024 ||
              versiontype == DWG_VERSION_AC1027)
            {
              size_t len = strlen(*(char**)value);
              char *new_str = (char *)malloc(len + 1);
              if (!new_str) {
                // Handle memory allocation failure
                return;
              }
              strcpy(new_str, *(char**)value);
              *(char**)old = new_str;
            }
          else
            {
              char *new_str = (char *)malloc(f->size);
              if (!new_str) {
                // Handle memory allocation failure
                return;
              }
              strncpy(new_str, *(char**)value, f->size - 1);
              new_str[f->size - 1] = '\0';
              *(char**)old = new_str;
            }

        }
      else if (f->type[0] == 'T' && f->type[1] == 'F')
        {
          if (is_utf8)
            {
              size_t wlen = utf8_to_wcslen (*(char**)value);
              wchar_t *wc = (wchar_t *)malloc ((wlen + 1) * sizeof(wchar_t));
              if (!wc) {
                // Handle memory allocation failure
                return;
              }
              utf8_to_wcs (wc, wlen + 1, *(char**)value);
              *(wchar_t**)old = wc;
            }
          else
            {
              size_t len = strlen(*(char**)value);
              char *new_str = (char *)malloc(len + 1);
              if (!new_str) {
                // Handle memory allocation failure
                return;
              }
              strcpy(new_str, *(char**)value);
              *(char**)old = new_str;
            }
        }
      else if (versiontype == DWG_VERSION_AC1015 ||
               versiontype == DWG_VERSION_AC1018 ||
               versiontype == DWG_VERSION_AC1021 ||
               versiontype == DWG_VERSION_AC1024 ||
               versiontype == DWG_VERSION_AC1027)
        {
          if (is_utf8)
            {
              size_t wlen = utf8_to_wcslen (*(char**)value);
              wchar_t *wc = (wchar_t *)malloc ((wlen + 1) * sizeof(wchar_t));
              if (!wc) {
                // Handle memory allocation failure
                return;
              }
              utf8_to_wcs (wc, wlen + 1, *(char**)value);
              *(wchar_t**)old = wc;
            }
          else
            {
              size_t len = strlen(*(char**)value);
              char *new_str = (char *)malloc(len + 1);
              if (!new_str) {
                // Handle memory allocation failure
                return;
              }
              strcpy(new_str, *(char**)value);
              *(char**)old = new_str;
            }
        }
      else
        {
          char *new_str = (char *)malloc(f->size);
          if (!new_str) {
            // Handle memory allocation failure
            return;
          }
          memcpy(new_str, *(char **)value, f->size);
          *(char **)old = new_str;
        }