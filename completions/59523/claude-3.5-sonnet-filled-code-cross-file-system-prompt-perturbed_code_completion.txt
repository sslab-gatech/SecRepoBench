{
  size_t len = strlen(*(const char**)value);
  if (len >= f->size)
    len = f->size - 1;
  char *new_str = (char*)calloc(f->size, 1);
  if (!new_str)
    return;
  memcpy(new_str, *(const char**)value, len);
  new_str[len] = '\0';
  *(char**)old = new_str;
}
else if (strEQc(f->type, "TF") && versiontype < R_13b1)
{
  size_t len = strlen(*(const char**)value);
  char *new_str = (char*)malloc(len + 1);
  if (!new_str)
    return;
  strcpy(new_str, *(const char**)value);
  *(char**)old = new_str;
}
else if (strEQc(f->type, "TF") && is_utf8)
{
  BITCODE_TU wstr = bit_utf8_to_TU(*(const char**)value);
  if (!wstr)
    return;
  *(BITCODE_TU*)old = wstr;
}
else
{
  size_t len = strlen(*(const char**)value);
  char *new_str = (char*)malloc(len + 1);
  if (!new_str)
    return;
  strcpy(new_str, *(const char**)value);
  *(char**)old = new_str;
}