size_t len = strlen((const char *)value) + 1; // Include null terminator
        if (len > f->size) // Ensure we do not exceed the fixed size
          len = f->size;

        char *new_mem = (char *)malloc(len);
        if (!new_mem) // Check for allocation failure
        {
          LOG_ERROR("Memory allocation failed in dynapi_set_helper");
          return;
        }

        strncpy(new_mem, (const char *)value, len - 1); // Copy string safely
        new_mem[len - 1] = '\0'; // Ensure null termination

        if (*(char **)old) // Free old memory if it exists
          free(*(char **)old);

        *(char **)old = new_mem; // Update the pointer in 'old'