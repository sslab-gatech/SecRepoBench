if (versiontype == DWG_R13 || versiontype == DWG_R14) {
          size_t len = strlen (*(char**)value);
          char *newstr = malloc (len + 1);
          strcpy (newstr, *(char**)value);
          memcpy (old, &newstr, sizeof (char*));
        } else if (is_utf8) {
          size_t len = strlen (*(char**)value);
          wchar_t *newstr = (wchar_t*)malloc ((len + 1) * sizeof (wchar_t));
          mbstowcs (newstr, *(char**)value, len + 1);
          memcpy (old, &newstr, sizeof (wchar_t*));
        } else {
          size_t len = wcslen (*(wchar_t**)value);
          wchar_t *newstr = malloc ((len + 1) * sizeof (wchar_t));
          wcscpy (newstr, *(wchar_t**)value);
          memcpy (old, &newstr, sizeof (wchar_t*));
        }