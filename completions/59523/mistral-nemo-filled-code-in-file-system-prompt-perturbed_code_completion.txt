def fill_masked_region(self, field, value):
    if field.is_malloc:
        if field.is_utf8 and isinstance(value, str):
            value = value.encode('utf-8')
        if field.size == sizeof(char*):
            self.__dict__[field.name] = value
        elif field.size == sizeof(TF):
            self.__dict__[field.name] = TF(value, len(value))
        else:
            self.__dict__[field.name] = bytearray(value, 'utf-8' if field.is_utf8 else 'ascii')
    else:
        self.__dict__[field.name] = value