if (f->is_malloc)
{
  if (!*(char**)value)
    memcpy(old, value, sizeof(char*));
  else if (strEQc(f->type, "TFv"))
  {
    size_t len = strlen((const char*)value) + 1;
    char* new_str = malloc(len);
    memcpy(new_str, value, len);
    *(char**)old = new_str;
  }
  else
  {
    // For ASCII strings with specific DWG versions, allocate memory based on
    // the length of the input string and copy it accordingly.
    // For wide character strings, convert UTF-8 encoded strings to a wide character format
    // if necessary, and allocate memory for the wide string before copying it.
    if (is_utf8)
    {
      // Convert UTF-8 to wide character and allocate memory
      size_t len = MultiByteToWideChar(CP_UTF8, 0, (const char*)value, -1, NULL, 0);
      wchar_t* new_str = malloc(len * sizeof(wchar_t));
      MultiByteToWideChar(CP_UTF8, 0, (const char*)value, -1, new_str, len);
      *(wchar_t**)old = new_str;
    }
    else
    {
      size_t len = strlen((const char*)value) + 1;
      char* new_str = malloc(len);
      memcpy(new_str, value, len);
      *(char**)old = new_str;
    }
  }
}
else
{
  memcpy(old, value, f->size);
}