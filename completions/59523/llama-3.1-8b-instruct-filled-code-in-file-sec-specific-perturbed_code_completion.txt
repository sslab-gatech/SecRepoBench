// <MASK>
static void
dynapi_set_helper (void *restrict old, const Dwg_DYNAPI_field *restrict f,
                   const Dwg_Version_Type versiontype,
                   const void *restrict value, const bool is_utf8)
{
  if (f->is_malloc)
    {
      if (!*(char**)value)
        memcpy (old, value, sizeof (char*));
      else if (strEQc (f->type, "TFv"))
        {
          // Allocate memory and copy the string from 'value' to a new memory block,
          // accounting for both fixed-length and dynamically allocated strings.
          // If the string is fixed-length (TFv), allocate memory according to the field's size
          // and copy the string with consideration for null-termination.
          // For ASCII strings with specific DWG versions, allocate memory based on
          // the length of the input string and copy it accordingly.
          // For wide character strings, convert UTF-8 encoded strings to a wide character format
          // if necessary, and allocate memory for the wide string before copying it.
          // If the field type is not TF and DWG version conditions are met, perform these conversions.
          // In all cases, update the pointer in 'old' to the newly allocated string memory,
          // ensuring the previous memory is freed to avoid memory leaks.
          // Allocate memory for the string, taking into account the field's size and the input string's length.
          char *new_str = malloc (f->size);
          if (is_utf8)
            {
              // Convert the input string to a wide character format if necessary.
              // This is done by using the 'wcscpy' function, which copies the input string
              // to the newly allocated memory block, taking into account the field's size.
              wcscpy (new_str, (wchar_t*)value);
            }
          else
            {
              // Copy the input string to the newly allocated memory block.
              // This is done by using the'strcpy' function, which copies the input string
              // to the newly allocated memory block, taking into account the field's size.
              strcpy (new_str, (char*)value);
            }
          // Update the pointer in 'old' to the newly allocated string memory.
          *(char**)old = new_str;
        }
      else
        {
          // Copy the input string to the newly allocated memory block.
          // This is done by using the'memcpy' function, which copies the input string
          // to the newly allocated memory block, taking into account the field's size.
          memcpy (old, value, f->size);
        }
    }
  else
    memcpy (old, value, f->size);
}