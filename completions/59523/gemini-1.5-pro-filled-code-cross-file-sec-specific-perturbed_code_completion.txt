{
          char *new_str = NULL;
          size_t len = 0;

          if (f->size > 0) {
            len = f->size;
            new_str = (char *)malloc(len);
            if (!new_str) {
              // Handle memory allocation failure
              return; 
            }
            memcpy(new_str, value, len);
          } else if (dwg_version_is_ascii(versiontype)) {
            len = strlen((const char *)value) + 1;
            new_str = (char *)malloc(len);
            if (!new_str) {
              // Handle memory allocation failure
              return;
            }
            strcpy(new_str, (const char *)value);
          } else if (is_utf8) {
            wchar_t *wstr = dwg_utf8_to_wcs((const char *)value);
            if (wstr) {
              len = (wcslen(wstr) + 1) * sizeof(wchar_t);
              new_str = (char *)malloc(len);
              if (!new_str) {
                free(wstr);
                return; // Handle memory allocation failure
              }
              memcpy(new_str, wstr, len);
              free(wstr);
            }
          }

          if (new_str) {
            if (*(char **)old) {
              free(*(char **)old);
            }
            *(char **)old = new_str;
          }
        }