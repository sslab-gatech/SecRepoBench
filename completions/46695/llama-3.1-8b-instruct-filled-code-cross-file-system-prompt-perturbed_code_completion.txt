// <MASK>
  // Select the appropriate character map (encoding) for the font face based on
  // the provided encoding string. If an encoding is specified, determine the
  // corresponding FreeType encoding type using a series of string comparisons.
  // If the encoding type is successfully determined, apply it to the font face.
  // If the encoding type cannot be applied, handle the error by cleaning up
  // resources and throwing an exception.
  // 
  // Set the character size for the font face based on the point size and
  // resolution specified in the DrawInfo structure. Adjust the resolution
  // if a custom density is provided. If setting the character size fails,
  // handle the error by cleaning up resources and throwing an exception.
  // 
  // Initialize the TypeMetric structure with font size metrics such as ascent,
  // descent, width, height, and maximum advance. If necessary, sanitize any
  // incorrect ascender and descender values. Calculate underline position and
  // thickness based on the font's properties.
  // 
  // If there is no text to render, or no glyphs in the font, clean up resources
  // and return a successful status without proceeding further.
  // 
  // Configure rendering options such as anti-aliasing and hinting based on
  // the DrawInfo settings and image properties. Prepare structures for
  // rendering each glyph in the text string, transforming the glyphs according
  // to specified affine transformations.
  // 
  // Loop through each character in the text, rendering glyphs, tracing outlines
  // if necessary, and rasterizing the glyphs onto the image. Adjust the
  // position and metrics of each rendered glyph, and update the bounding box
  // of the text as needed. Manage resources and synchronize image data
  // appropriately during the rendering process.
  // 
  // Finalize the font metrics by normalizing the bounding box coordinates and
  // width. Clean up any remaining resources and return the rendering status.
  // 
  // Determine the encoding type for the font face based on the provided encoding
  // string. If the encoding type is successfully determined, apply it to the
  // font face. If the encoding type cannot be applied, handle the error by
  // cleaning up resources and throwing an exception.
  if (encoding!= (const char *) NULL)
    {
      if (strcmp(encoding,"unicode") == 0)
        encoding_type=FT_ENCODING_UNICODE;
      else if (strcmp(encoding,"ascii") == 0)
        encoding_type=FT_ENCODING_LATIN1;
      else if (strcmp(encoding,"jis") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-1") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-2") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-3") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-4") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-5") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-6") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-7") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-8") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-9") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-10") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-11") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-12") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-13") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-14") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-15") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-16") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-17") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-18") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-19") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-20") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-21") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-22") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-23") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-24") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-25") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-26") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-27") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-28") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-29") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-30") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-31") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-32") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-33") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-34") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-35") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-36") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-37") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-38") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-39") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-40") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-41") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-42") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-43") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-44") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-45") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-46") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-47") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-48") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-49") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-50") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-51") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-52") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-53") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-54") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-55") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-56") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-57") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-58") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-59") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-60") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-61") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-62") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-63") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-64") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-65") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-66") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-67") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-68") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-69") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-70") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-71") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-72") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-73") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-74") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-75") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-76") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-77") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-78") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-79") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-80") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-81") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-82") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-83") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-84") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-85") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-86") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-87") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-88") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-89") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-90") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-91") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-92") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-93") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-94") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-95") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-96") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-97") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-98") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-99") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-100") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-101") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-102") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-103") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-104") == 0)
        encoding_type=FT_ENCODING_JIS;
      else if (strcmp(encoding,"jis-105") ==