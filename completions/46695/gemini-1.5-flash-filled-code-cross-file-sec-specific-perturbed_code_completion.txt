size_t
    extent;

  /*
    Render text.
  */
  if (draw_info->text == (char *) NULL)
    {
      (void) FT_Done_Face(face);
      (void) FT_Done_FreeType(library);
      return(MagickTrue);
    }
  length=strlen(draw_info->text);
  utf8=(unsigned char *) ConvertUTF8(draw_info->text,exception);
  if (utf8 == (unsigned char *) NULL)
    {
      (void) FT_Done_Face(face);
      (void) FT_Done_FreeType(library);
      return(MagickFalse);
    }
  if (length == 0)
    {
      (utf8=DestroyString((char *) utf8));
      (void) FT_Done_Face(face);
      (void) FT_Done_FreeType(library);
      return(MagickTrue);
    }
  grapheme=(GraphemeInfo *) NULL;
  extent=ComplexTextLayout(img,draw_info,(const char *) utf8,length,face,
    FT_LOAD_DEFAULT,&grapheme,exception);
  utf8=DestroyString((char *) utf8);
  if (extent == 0)
    {
      (void) FT_Done_Face(face);
      (void) FT_Done_FreeType(library);
      return(MagickFalse);
    }
  status=RenderGlyphs(img,draw_info,offset,metrics,grapheme,extent,exception);
  grapheme=(GraphemeInfo *) RelinquishMagickMemory(grapheme);
  (void) FT_Done_Face(face);
  (void) FT_Done_FreeType(library);
  return(status);