HEVCFrame *ref = find_ref_idx(s, pictureordercount);
if (!ref) {
    if (ff_hevc_frame_nb_refs(s) >= s->ps.sps->max_num_ref Pictures) {
        return -1;
    }
    for (int i = 0; i < FF_ARRAY_ELEMS(s->DPB); i++) {
        if (!s->DPB[i].frame->buf[0]) {
            ref = &s->DPB[i];
            ref->poc = pictureordercount;
            break;
        }
    }
    if (!ref) {
        return -1;
    }
}
if (ref == s->ref) {
    return -1;
}