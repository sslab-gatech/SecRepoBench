// <MASK>
HEVCFrame *ref = find_ref_idx(s, pictureordercount);
if (!ref) {
    // No reference frame found with the given POC, attempt to generate a missing reference frame
    ref = generate_missing_reference(s, pictureordercount);
    if (!ref) {
        // Failed to generate a missing reference frame
        return AVERROR_INVALIDDATA;
    }
} else if (ref->poc == list->list[list->nb_refs]) {
    // The found reference is the same as the current reference, return an error
    return AVERROR(EINVAL);
}