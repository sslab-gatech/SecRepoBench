ClampToQuantum(((double)
                    QuantumRange*blue_colormap[i])/range);
                }
              }
          }
      }
    if (photometric == PHOTOMETRIC_SEPARATED)
      {
        size_t
          channels;

        channels=samples_per_pixel;
        if (image->storage_class == PseudoClass)
          channels=3;
        if (AcquireImageSeparated(image,channels,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_YCBCR)
      {
        if (AcquireImageYCbCr(image,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_CIELAB)
      {
        if (DecodeLabImage(image,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_LOGL)
      {
        if (DecodeLogLImage(image,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_LOGLUV)
      {
        if (DecodeLogLuvImage(image,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_MINISBLACK)
      quantum_type=QuantumTypeGray;
    else
      if (photometric == PHOTOMETRIC_MINISWHITE)
        quantum_type=QuantumTypeGray;
      else
        if (photometric == PHOTOMETRIC_PALETTE)
          quantum_type=QuantumTypePalette;
        else
          if (photometric == PHOTOMETRIC_RGB)
            quantum_type=QuantumTypeRGB;
          else
            if (photometric == PHOTOMETRIC_SEPARATED)
              quantum_type=QuantumTypeCMYK;
            else
              if (photometric == PHOTOMETRIC_YCBCR)
                quantum_type=QuantumTypeYCbCr;
              else
                if (photometric == PHOTOMETRIC_CIELAB)
                  quantum_type=QuantumTypeLab;
                else
                  if (photometric == PHOTOMETRIC_LOGL)
                    quantum_type=QuantumTypeLog;
                  else
                    if (photometric == PHOTOMETRIC_LOGLUV)
                      quantum_type=QuantumTypeLog;
                    else
                      quantum_type=QuantumTypeUndefined;
    if (sample_format == SAMPLEFORMAT_IEEEFP)
      quantum_type=QuantumTypeFloat;
    if (photometric == PHOTOMETRIC_SEPARATED)
      {
        size_t
          channels;

        channels=samples_per_pixel;
        if (image->storage_class == PseudoClass)
          channels=3;
        if (AcquireImageSeparated(image,channels,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_YCBCR)
      {
        if (AcquireImageYCbCr(image,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_CIELAB)
      {
        if (DecodeLabImage(image,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_LOGL)
      {
        if (DecodeLogLImage(image,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_LOGLUV)
      {
        if (DecodeLogLuvImage(image,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_MINISBLACK)
      quantum_type=QuantumTypeGray;
    else
      if (photometric == PHOTOMETRIC_MINISWHITE)
        quantum_type=QuantumTypeGray;
      else
        if (photometric == PHOTOMETRIC_PALETTE)
          quantum_type=QuantumTypePalette;
        else
          if (photometric == PHOTOMETRIC_RGB)
            quantum_type=QuantumTypeRGB;
          else
            if (photometric == PHOTOMETRIC_SEPARATED)
              quantum_type=QuantumTypeCMYK;
            else
              if (photometric == PHOTOMETRIC_YCBCR)
                quantum_type=QuantumTypeYCbCr;
              else
                if (photometric == PHOTOMETRIC_CIELAB)
                  quantum_type=QuantumTypeLab;
                else
                  if (photometric == PHOTOMETRIC_LOGL)
                    quantum_type=QuantumTypeLog;
                  else
                    if (photometric == PHOTOMETRIC_LOGLUV)
                      quantum_type=QuantumTypeLog;
                    else
                      quantum_type=QuantumTypeUndefined;
    if (sample_format == SAMPLEFORMAT_IEEEFP)
      quantum_type=QuantumTypeFloat;
    if (photometric == PHOTOMETRIC_SEPARATED)
      {
        size_t
          channels;

        channels=samples_per_pixel;
        if (image->storage_class == PseudoClass)
          channels=3;
        if (AcquireImageSeparated(image,channels,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_YCBCR)
      {
        if (AcquireImageYCbCr(image,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_CIELAB)
      {
        if (DecodeLabImage(image,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_LOGL)
      {
        if (DecodeLogLImage(image,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_LOGLUV)
      {
        if (DecodeLogLuvImage(image,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_MINISBLACK)
      quantum_type=QuantumTypeGray;
    else
      if (photometric == PHOTOMETRIC_MINISWHITE)
        quantum_type=QuantumTypeGray;
      else
        if (photometric == PHOTOMETRIC_PALETTE)
          quantum_type=QuantumTypePalette;
        else
          if (photometric == PHOTOMETRIC_RGB)
            quantum_type=QuantumTypeRGB;
          else
            if (photometric == PHOTOMETRIC_SEPARATED)
              quantum_type=QuantumTypeCMYK;
            else
              if (photometric == PHOTOMETRIC_YCBCR)
                quantum_type=QuantumTypeYCbCr;
              else
                if (photometric == PHOTOMETRIC_CIELAB)
                  quantum_type=QuantumTypeLab;
                else
                  if (photometric == PHOTOMETRIC_LOGL)
                    quantum_type=QuantumTypeLog;
                  else
                    if (photometric == PHOTOMETRIC_LOGLUV)
                      quantum_type=QuantumTypeLog;
                    else
                      quantum_type=QuantumTypeUndefined;
    if (sample_format == SAMPLEFORMAT_IEEEFP)
      quantum_type=QuantumTypeFloat;
    if (photometric == PHOTOMETRIC_SEPARATED)
      {
        size_t
          channels;

        channels=samples_per_pixel;
        if (image->storage_class == PseudoClass)
          channels=3;
        if (AcquireImageSeparated(image,channels,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_YCBCR)
      {
        if (AcquireImageYCbCr(image,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_CIELAB)
      {
        if (DecodeLabImage(image,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_LOGL)
      {
        if (DecodeLogLImage(image,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_LOGLUV)
      {
        if (DecodeLogLuvImage(image,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_MINISBLACK)
      quantum_type=QuantumTypeGray;
    else
      if (photometric == PHOTOMETRIC_MINISWHITE)
        quantum_type=QuantumTypeGray;
      else
        if (photometric == PHOTOMETRIC_PALETTE)
          quantum_type=QuantumTypePalette;
        else
          if (photometric == PHOTOMETRIC_RGB)
            quantum_type=QuantumTypeRGB;
          else
            if (photometric == PHOTOMETRIC_SEPARATED)
              quantum_type=QuantumTypeCMYK;
            else
              if (photometric == PHOTOMETRIC_YCBCR)
                quantum_type=QuantumTypeYCbCr;
              else
                if (photometric == PHOTOMETRIC_CIELAB)
                  quantum_type=QuantumTypeLab;
                else
                  if (photometric == PHOTOMETRIC_LOGL)
                    quantum_type=QuantumTypeLog;
                  else
                    if (photometric == PHOTOMETRIC_LOGLUV)
                      quantum_type=QuantumTypeLog;
                    else
                      quantum_type=QuantumTypeUndefined;
    if (sample_format == SAMPLEFORMAT_IEEEFP)
      quantum_type=QuantumTypeFloat;
    if (photometric == PHOTOMETRIC_SEPARATED)
      {
        size_t
          channels;

        channels=samples_per_pixel;
        if (image->storage_class == PseudoClass)
          channels=3;
        if (AcquireImageSeparated(image,channels,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_YCBCR)
      {
        if (AcquireImageYCbCr(image,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_CIELAB)
      {
        if (DecodeLabImage(image,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_LOGL)
      {
        if (DecodeLogLImage(image,exception) == MagickFalse)
          {
            TIFFClose(tiff);
            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
          }
      }
    if (photometric == PHOTOMETRIC_LOGLUV)
      {
        if (DecodeLogLuvImage(image,exception)