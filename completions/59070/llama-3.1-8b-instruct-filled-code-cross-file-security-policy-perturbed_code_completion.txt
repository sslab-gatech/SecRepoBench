// Extract a null-terminated string from the input data into a buffer, checking for maximum length.
// Allocate memory using the provided allocation function to store the string, including its null terminator.
// Copy the string into the newly allocated memory and store the pointer in the output structure.
// Mark the string in the output structure as dynamically allocated.
// <MASK>
{
    size_t str_len = 0;
    while (str_len < 128 && curin[str_len]!= '\0') {
        str_len++;
    }
    if (str_len >= 128) return EXR_ERR_CORRUPT_CHUNK;

    size_t alloc_len = str_len + 1; // +1 for the null terminator
    void* str_ptr = (*alloc_fn)(alloc_len);
    if (str_ptr == NULL) return EXR_ERR_OUT_OF_MEMORY;

    char* str = (char*) str_ptr;
    memcpy(str, curin, str_len);
    str[str_len] = '\0'; // null terminate the string

    out->_suffix = str;
    out->_suffix_is_dynamic = true;
}