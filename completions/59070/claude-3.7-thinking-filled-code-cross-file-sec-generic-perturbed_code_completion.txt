// Extract a null-terminated string from the input data
while (len < 128 && len < *length && curin[len] != 0) len++;

// Ensure we found a null terminator within the buffer
if (len >= 128 || len >= *length || curin[len] != 0)
    return EXR_ERR_CORRUPT_CHUNK;

// Copy the string into our buffer
memcpy(suffix, curin, len);
suffix[len] = 0; // Ensure null termination

// Allocate memory for the string
mem = (char*)alloc_fn(len + 1);
if (!mem)
    return EXR_ERR_OUT_OF_MEMORY;

// Copy the string to the allocated memory
memcpy(mem, suffix, len + 1);

// Store the pointer in the output structure
out->_suffix = mem;
out->_suffixIsAllocated = DWA_CLASSIFIER_TRUE;

// Move the input pointer past the string (including the null terminator)
len++; // Account for the null terminator