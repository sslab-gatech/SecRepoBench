for (len = 0; len < 128 && len < *length; ++len) {
    if (curin[len] == '\0') break;
    suffix[len] = curin[len];
}
if (len == 128 || len == *length) return EXR_ERR_CORRUPT_CHUNK;
suffix[len] = '\0';
++len;

mem = (char*)alloc_fn(len);
if (!mem) return EXR_ERR_OUT_OF_MEMORY;

memcpy(mem, suffix, len);
out->_suffix = mem;
out->_suffixIsAllocated = 1;