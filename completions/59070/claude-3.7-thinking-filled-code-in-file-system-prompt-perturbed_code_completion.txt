// Find the length of the null-terminated string (excluding the null-terminator)
for (len = 0; len < 128 && len < *length; ++len)
{
    if (curin[len] == 0) break;
}

// Check if we ran out of space or didn't find a null-terminator
if (len == 128 || len == *length)
    return EXR_ERR_CORRUPT_CHUNK;

// Copy the string to the temporary buffer (including the null-terminator)
memcpy(suffix, curin, len + 1);

// Allocate memory for the suffix string
mem = (char*) alloc_fn(len + 1);
if (!mem) return EXR_ERR_OUT_OF_MEMORY;

// Copy the suffix string to the allocated memory
memcpy(mem, suffix, len + 1);

// Set the output structure's suffix pointer
out->_suffix = mem;
out->_stringStatic = DWA_CLASSIFIER_FALSE;

len += 1; // Include the null-terminator in the length for the rest of the function