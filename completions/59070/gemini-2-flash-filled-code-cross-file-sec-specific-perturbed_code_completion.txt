len = 0;
        while (len < 128 && len < *length && curin[len] != 0)
        {
            suffix[len] = curin[len];
            len++;
        }

        if (len == 128 && curin[len] != 0)
        {
            // String is too long, or not null terminated
            return EXR_ERR_CORRUPT_CHUNK;
        }

        if (len >= *length)
        {
            // Reached end of buffer without null terminator
            return EXR_ERR_CORRUPT_CHUNK;
        }

        mem = (char*) alloc_fn (len + 1);
        if (mem == NULL) return EXR_ERR_OUT_OF_MEMORY;

        memcpy (mem, suffix, len + 1);

        out->_suffix          = mem;
        out->_ownsSuffixString = DWA_CLASSIFIER_TRUE;