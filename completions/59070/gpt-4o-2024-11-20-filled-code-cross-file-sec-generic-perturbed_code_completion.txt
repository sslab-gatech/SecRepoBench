const char* suffix_start = Classifier_find_suffix((const char*)curin);
        if (!suffix_start) return EXR_ERR_CORRUPT_CHUNK;

        len = strlen(suffix_start);
        if (len > 128) return EXR_ERR_CORRUPT_CHUNK;

        memcpy(suffix, suffix_start, len);
        suffix[len] = '\0';

        mem = (char*)alloc_fn(len + 1);
        if (!mem) return EXR_ERR_OUT_OF_MEMORY;

        memcpy(mem, suffix, len + 1);
        out->_suffix = mem;
        out->_suffix_allocated = 1;