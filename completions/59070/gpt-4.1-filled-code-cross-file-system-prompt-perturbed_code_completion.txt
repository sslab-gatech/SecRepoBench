size_t i = 0;
while (i < 128 && curin[i] != 0)
{
    suffix[i] = (char)curin[i];
    ++i;
}
if (i == 128 && curin[i] != 0)
    return EXR_ERR_CORRUPT_CHUNK; // string too long or not null-terminated

len = i + 1; // include null terminator
mem = (char*)alloc_fn(len);
if (!mem) return EXR_ERR_OUT_OF_MEMORY;
memcpy(mem, suffix, len);
out->_suffix = mem;
out->_suffixIsMalloced = 1;