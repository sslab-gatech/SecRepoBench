// Extract a null-terminated string from the input data into a buffer, checking for maximum length.
// Allocate memory using the provided allocation function to store the string, including its null terminator.
// Copy the string into the newly allocated memory and store the pointer in the output structure.
// Mark the string in the output structure as dynamically allocated.

const char* suffix = Classifier_find_suffix(reinterpret_cast<const char*>(curin));
size_t suffix_len = strlen(suffix) + 1;
if (suffix_len > 128) return EXR_ERR_CORRUPT_CHUNK;

char* mem = static_cast<char*>(alloc_fn(suffix_len));
if (!mem) return EXR_ERR_OUT_OF_MEMORY;

memcpy(mem, suffix, suffix_len);
out->_suffix = mem;
out->_suffix_allocated = true;

len = suffix_len;