const char* suffix_start = Classifier_find_suffix((const char*)curin);
    size_t suffix_len = strlen(suffix_start);

    if (suffix_len > 128) return EXR_ERR_CORRUPT_CHUNK;

    strncpy(suffix, suffix_start, 128);
    suffix[128] = '\0'; // Ensure null termination

    len = (suffix_start - (const char*)curin) + suffix_len + 1;

    mem = (char*)alloc_fn(suffix_len + 1);
    if (!mem) return EXR_ERR_OUT_OF_MEMORY;

    strcpy(mem, suffix);
    out->_suffix = mem;
    out->_suffixAllocated = true;