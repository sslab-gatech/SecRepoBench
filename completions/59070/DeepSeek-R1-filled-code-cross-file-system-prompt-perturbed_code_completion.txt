len = 0;
while (len < 128 && curin[len] != 0)
{
    suffix[len] = (char)curin[len];
    ++len;
}
if (len < 128) suffix[len++] = 0; // Add null terminator
else if (suffix[127] != 0) return EXR_ERR_CORRUPT_CHUNK;

mem = (char*)alloc_fn(len);
if (!mem) return EXR_ERR_OUT_OF_MEMORY;
memcpy(mem, suffix, len);
out->_suffix = mem;
out->_suffix_allocated = 1;