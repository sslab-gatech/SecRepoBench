char value_str[21]; // enough to hold any 64-bit integer in decimal
    int len = snprintf(value_str, sizeof(value_str), "%" PRId64, (int64_t)value);
    if (len < 0 || len >= remainingspace) {
        return -1;
    }
    rc = ndpi_snprintf((char *)&serializer->buffer.data[serializer->status.buffer.size_used], remainingspace, "%s", value_str);
    if (rc < 0 || (u_int)rc >= remainingspace) {
        return -1;
    }
    serializer->status.buffer.size_used += rc;