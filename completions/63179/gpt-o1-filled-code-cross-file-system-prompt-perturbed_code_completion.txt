int rc;

/* Ensure there is enough space for serialization, extending if necessary */
if (remainingspace < 16) {
  if (ndpi_extend_serializer_buffer(&serializer->buffer, 16 - remainingspace) < 0)
    return -1;
  remainingspace = serializer->buffer.size - serializer->status.buffer.size_used;
}

/* Prepend CSV separator if needed */
ndpi_serialize_csv_pre(serializer);

/* Print the integer value into the buffer */
rc = ndpi_snprintf((char *)&serializer->buffer.data[serializer->status.buffer.size_used],
                   remainingspace, "%d", value);