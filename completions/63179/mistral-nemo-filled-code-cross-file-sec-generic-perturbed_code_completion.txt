if (serializer->status.buffer.size_used + sizeof(int32_t) > serializer->buffer.size) {
    if (ndpi_extend_serializer_buffer(&serializer->buffer, sizeof(int32_t)) < 0)
      return (-1);
  }

  ndpi_serialize_csv_pre(serializer);
  u_int32_t buff_diff = serializer->buffer.size - serializer->status.buffer.size_used;
  int rc = ndpi_snprintf((char *)&serializer->buffer.data[serializer->status.buffer.size_used], buff_diff, "%d", value);
  if (rc < 0 || (u_int)rc >= buff_diff)
    return (-1);
  serializer->status.buffer.size_used += rc;