int rc;
char header_str[] = "int32";

if (!(serializer->status.flags & NDPI_SERIALIZER_STATUS_HEADER)) {
    rc = snprintf((char *)&serializer->buffer.data[serializer->status.buffer.size_used],
                  remainingspace, "%s,", header_str);
    if (rc < 0 || (u_int)rc >= remainingspace)
        return(-1);
    serializer->status.buffer.size_used += rc;
    serializer->status.flags |= NDPI_SERIALIZER_STATUS_HEADER;
    remainingspace -= rc;
}

rc = snprintf((char *)&serializer->buffer.data[serializer->status.buffer.size_used],
              remainingspace, "%d,", value);