int rc;
    if (serializer->status.buffer.size_used == 0) {
      // Write header if not already written
      rc = ndpi_serializer_header_string(serializer, key, strlen(key));
      if (rc < 0) return -1;
      serializer->status.buffer.size_used += rc;
      remainingspace = serializer->buffer.size - serializer->status.buffer.size_used;
    }

    // Serialize the integer value into the buffer
    rc = ndpi_snprintf((char *)&serializer->buffer.data[serializer->status.buffer.size_used],
                       remainingspace, "%d", value);