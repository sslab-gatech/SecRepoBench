int rc;
    u_int32_t needed = ndpi_snprintf(NULL, 0, NDPI_I32_FORMAT, value) + 1; /* +1 for comma */
    if(serializer->status.flags & NDPI_SERIALIZER_STATUS_HEADER_WRITTEN)
      needed++; /* +1 for comma */

    if(needed > remainingspace) {
      if(ndpi_extend_serializer_buffer(&serializer->buffer, needed - remainingspace) < 0)
	return(-1);
      remainingspace = serializer->buffer.size - serializer->status.buffer.size_used;
    }

    if(serializer->status.flags & NDPI_SERIALIZER_STATUS_HEADER_WRITTEN) {
      serializer->buffer.data[serializer->status.buffer.size_used++] = ',';
    } else {
      serializer->status.flags |= NDPI_SERIALIZER_STATUS_HEADER_WRITTEN;
    }

    rc = ndpi_snprintf((char *) &serializer->buffer.data[serializer->status.buffer.size_used], remainingspace,
		       NDPI_I32_FORMAT, value);