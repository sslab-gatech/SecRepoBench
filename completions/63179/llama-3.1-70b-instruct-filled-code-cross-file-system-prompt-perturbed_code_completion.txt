int rc;
u_int32_t needed = sizeof(u_int32_t);
if(ndpi_serializer_header_string(serializer, "", 0) < 0) return(-1);
if(remainingspace < needed) {
  if(ndpi_extend_serializer_buffer(&serializer->buffer, needed - remainingspace) < 0)
    return(-1);
  remainingspace = serializer->buffer.size - serializer->status.buffer.size_used;
}
rc = ndpi_snprintf((char *)&serializer->buffer.data[serializer->status.buffer.size_used], remainingspace,
                   "%d", value);