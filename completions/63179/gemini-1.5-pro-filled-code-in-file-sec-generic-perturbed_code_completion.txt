int rc = 0;
    char _value[16];

    if(!(serializer->status.flags & NDPI_SERIALIZER_STATUS_HDR_DONE)) {
      if (ndpi_serializer_header_string(serializer, key, strlen(key)) < 0)
        return (-1);
    }

    ndpi_serialize_csv_pre(serializer);

    remainingspace = serializer->buffer.size - serializer->status.buffer.size_used;
    
    if (remainingspace < 16) {
      if(ndpi_extend_serializer_buffer(&serializer->buffer, 16 - remainingspace) < 0)
        return (-1);

      remainingspace = serializer->buffer.size - serializer->status.buffer.size_used;
    }

    rc = ndpi_snprintf((char *)&serializer->buffer.data[serializer->status.buffer.size_used], remainingspace, "%d", value);