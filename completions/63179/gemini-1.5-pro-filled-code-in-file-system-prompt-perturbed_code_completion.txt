int rc = ndpi_snprintf((char *) &serializer->buffer.data[serializer->status.buffer.size_used], remainingspace,
                       "%d", value);

    if(!(serializer->status.flags & NDPI_SERIALIZER_STATUS_HDR_DONE)) {
      if (ndpi_serializer_header_string(serializer, key, strlen(key)) < 0)
        return(-1);
      ndpi_serialize_csv_pre(serializer);
      remainingspace = serializer->buffer.size - serializer->status.buffer.size_used;
      rc = ndpi_snprintf((char *) &serializer->buffer.data[serializer->status.buffer.size_used], remainingspace,
                         "%d", value);
    } else {
      needed = 16; /* int32 + , */
      if(buff_diff < needed) {
        if(ndpi_extend_serializer_buffer(&serializer->buffer, needed - buff_diff) < 0)
          return(-1);
        remainingspace = serializer->buffer.size - serializer->status.buffer.size_used;
      }
      ndpi_serialize_csv_pre(serializer);
      rc = ndpi_snprintf((char *) &serializer->buffer.data[serializer->status.buffer.size_used], remainingspace,
                         "%d", value);
    }