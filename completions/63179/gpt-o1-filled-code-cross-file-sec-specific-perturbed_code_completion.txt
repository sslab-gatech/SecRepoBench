u_int32_t needed = 12; /* Enough for a 32-bit integer and null terminator */
if (remainingspace < needed) {
  if (ndpi_extend_serializer_buffer(&serializer->buffer, needed - remainingspace) < 0)
    return -1;
  remainingspace = serializer->buffer.size - serializer->status.buffer.size_used;
}

/* Prepend necessary CSV elements if needed (header, separator, etc.) */
ndpi_serialize_csv_pre(serializer);

rc = ndpi_snprintf((char *)&serializer->buffer.data[serializer->status.buffer.size_used],
                   remainingspace, "%d", (int)value);