int rc;
    u_int32_t needed = ndpi_snprintf(NULL, 0, NDPI_I32_FORMAT, value) + 1; // +1 for comma
    if (serializer->status.flags & NDPI_SERIALIZER_STATUS_HEADER_WRITTEN) {
        needed++; // +1 for comma
    }
    if(remainingspace < needed) {
      if(ndpi_extend_serializer_buffer(&serializer->buffer, needed - remainingspace) < 0)
        return(-1);
      remainingspace = serializer->buffer.size - serializer->status.buffer.size_used;
    }

    if (serializer->status.flags & NDPI_SERIALIZER_STATUS_HEADER_WRITTEN) {
        rc = ndpi_snprintf((char *)&serializer->buffer.data[serializer->status.buffer.size_used], remainingspace, ",%s", ndpi_format_int32(value));
    } else {
        rc = ndpi_snprintf((char *)&serializer->buffer.data[serializer->status.buffer.size_used], remainingspace, "%s", ndpi_format_int32(value));
        serializer->status.flags |= NDPI_SERIALIZER_STATUS_HEADER_WRITTEN;
    }