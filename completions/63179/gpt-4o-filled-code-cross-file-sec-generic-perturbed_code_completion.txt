int rc;
    if (serializer->status.flags & NDPI_SERIALIZER_STATUS_HEADER_WRITTEN) {
      rc = ndpi_snprintf((char *)&serializer->buffer.data[serializer->status.buffer.size_used],
                         remainingspace, "%d", value);
    } else {
      rc = ndpi_snprintf((char *)&serializer->buffer.data[serializer->status.buffer.size_used],
                         remainingspace, "%s%d", key, value);
      serializer->status.flags |= NDPI_SERIALIZER_STATUS_HEADER_WRITTEN;
    }