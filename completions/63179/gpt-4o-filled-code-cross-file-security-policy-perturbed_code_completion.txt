if (ndpi_serializer_header_string(serializer, key, strlen(key)) < 0) return(-1);
    ndpi_serialize_csv_pre(serializer);
    remainingspace = serializer->buffer.size - serializer->status.buffer.size_used;
    rc = ndpi_snprintf((char *) &serializer->buffer.data[serializer->status.buffer.size_used], remainingspace,
                       "%d", value);
    if(rc < 0 || (u_int)rc >= remainingspace) {
      if(ndpi_extend_serializer_buffer(&serializer->buffer, rc + 1 - remainingspace) < 0)
        return(-1);
      remainingspace = serializer->buffer.size - serializer->status.buffer.size_used;
      rc = ndpi_snprintf((char *) &serializer->buffer.data[serializer->status.buffer.size_used], remainingspace,
                         "%d", value);
      if(rc < 0 || (u_int)rc >= remainingspace)
        return(-1);
    }