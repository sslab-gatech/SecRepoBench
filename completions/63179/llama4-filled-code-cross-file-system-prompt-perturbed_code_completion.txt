int rc;
u_int32_t header_len;

if (serializer->status.buffer.size_used == 0) {
  if(ndpi_serializer_header_string(serializer, "header", 6) < 0) 
    return(-1);
}

remainingspace = serializer->buffer.size - serializer->status.buffer.size_used;
rc = ndpi_snprintf((char *) &serializer->buffer.data[serializer->status.buffer.size_used], remainingspace,
  "%d", (int)value);
if(rc < 0 || (u_int)rc >= remainingspace)
  return(-1);
serializer->status.buffer.size_used += rc;