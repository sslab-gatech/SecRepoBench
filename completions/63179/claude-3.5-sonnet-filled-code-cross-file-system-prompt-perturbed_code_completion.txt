int rc;
if (serializer->status.flags & NDPI_SERIALIZER_STATUS_HEADER) {
    rc = ndpi_snprintf((char *)&serializer->buffer.data[serializer->status.buffer.size_used],
                       remainingspace, "%d", value);
} else {
    rc = ndpi_snprintf((char *)&serializer->buffer.data[serializer->status.buffer.size_used],
                       remainingspace, "int32\n%d", value);
    serializer->status.flags |= NDPI_SERIALIZER_STATUS_HEADER;
}