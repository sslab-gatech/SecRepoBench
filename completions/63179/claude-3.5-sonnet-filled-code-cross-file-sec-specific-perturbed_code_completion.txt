int rc;
char header[] = "value\n";
if (serializer->status.buffer.size_used == 0) {
    if (remainingspace < sizeof(header)) {
        if (ndpi_extend_serializer_buffer(&serializer->buffer, sizeof(header) - remainingspace) < 0)
            return(-1);
        remainingspace = serializer->buffer.size - serializer->status.buffer.size_used;
    }
    memcpy(&serializer->buffer.data[serializer->status.buffer.size_used], header, sizeof(header) - 1);
    serializer->status.buffer.size_used += sizeof(header) - 1;
    remainingspace -= sizeof(header) - 1;
}

rc = snprintf((char *)&serializer->buffer.data[serializer->status.buffer.size_used], remainingspace, "%d\n", value);