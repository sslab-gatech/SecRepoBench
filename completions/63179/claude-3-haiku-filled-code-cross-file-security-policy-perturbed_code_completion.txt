int rc = ndpi_snprintf((char *)&serializer->buffer.data[serializer->status.buffer.size_used],
                      remainingspace, "%"NDPI_I32_FORMAT, value);
if(rc < 0 || (u_int)rc >= remainingspace)
  return(-1);

if(serializer->status.buffer.size_used == 0) {
  // Prepend the header string
  rc = ndpi_snprintf((char *)serializer->buffer.data, remainingspace, "%s", "value");
  if(rc < 0 || (u_int)rc >= remainingspace)
    return(-1);
  serializer->status.buffer.size_used += rc;
}