if (serializer->status.flags & NDPI_SERIALIZER_STATUS_HEADER_WRITTEN) {
  serializer->buffer.data[serializer->status.buffer.size_used++] = ',';
} else {
  serializer->status.flags |= NDPI_SERIALIZER_STATUS_HEADER_WRITTEN;
}

rc = ndpi_snprintf((char *)&serializer->buffer.data[serializer->status.buffer.size_used], remainingspace, "%d", value);
if(rc < 0 || (u_int)rc >= remainingspace)
  return(-1);

serializer->status.buffer.size_used += rc;