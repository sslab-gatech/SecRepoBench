// Key is ignored, serialize the integer value into a CSV format string and store it in the buffer.
// Ensure that the buffer has sufficient space, extending it if necessary.
// Prepend a header string if the header has not already been written.
// Adjust the buffer usage count to reflect the serialized data.

char _value[16];
int rc = ndpi_snprintf(_value, sizeof(_value), "%d", value);
if(rc < 0 || (u_int)rc >= sizeof(_value))
  return(-1);

if(!(serializer->status.flags & NDPI_SERIALIZER_STATUS_HDR_DONE)) {
  if(ndpi_serializer_header_string(serializer, key, strlen(key)) < 0)
    return(-1);
}

ndpi_serialize_csv_pre(serializer);
memcpy(&serializer->buffer.data[serializer->status.buffer.size_used], _value, rc);
serializer->status.buffer.size_used += rc;