from_big(frame_len, frame_pointer + FRAME_FRAME_LEN, sizeof(*frame_len));
from_big(nbytes, frame_pointer + FRAME_NBYTES, sizeof(*nbytes));
from_big(cbytes, frame_pointer + FRAME_CBYTES, sizeof(*cbytes));
from_big(blocksize, frame_pointer + FRAME_BLOCKSIZE, sizeof(*blocksize));
from_big(chunksize, frame_pointer + FRAME_CHUNKSIZE, sizeof(*chunksize));
if (typesize != NULL) {
  from_big(typesize, frame_pointer + FRAME_TYPESIZE, sizeof(*typesize));
}

/* Validate header fields */
if (*frame_len < FRAME_HEADER_MINLEN ||
    *nbytes < 0 ||
    *cbytes < 0 ||
    *blocksize <= 0 ||
    *chunksize <= 0 ||
    (typesize != NULL && *typesize <= 0)) {
  BLOSC_TRACE_ERROR("Invalid header: one or more fields have an invalid value.");
  return BLOSC2_ERROR_INVALID_HEADER;
}