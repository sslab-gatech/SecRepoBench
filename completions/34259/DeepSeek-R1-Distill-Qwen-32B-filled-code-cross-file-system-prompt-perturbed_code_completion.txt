if (frame_len != NULL) {
  from_big(frame_len, frame_pointer + FRAME_FRAME_LEN, sizeof(*frame_len));
}
if (nbytes != NULL) {
  from_big(nbytes, frame_pointer + FRAME_NBYTES, sizeof(*nbytes));
}
if (cbytes != NULL) {
  from_big(cbytes, frame_pointer + FRAME_CBYTES, sizeof(*cbytes));
}
if (blocksize != NULL) {
  from_big(blocksize, frame_pointer + FRAME_BLOCKSIZE, sizeof(*blocksize));
}
if (chunksize != NULL) {
  from_big(chunksize, frame_pointer + FRAME_CHUNKSIZE, sizeof(*chunksize));
}
if (typesize != NULL) {
  from_big(typesize, frame_pointer + FRAME_TYPESIZE, sizeof(*typesize));
}

if (header_len == NULL || *header_len < FRAME_HEADER_MINLEN ||
    *header_len > FRAME_HEADER_MAXLEN) {
  BLOSC_TRACE_ERROR("Header length is out of bounds.");
  return BLOSC2_ERROR_INVALID_HEADER;
}

if (nbytes != NULL && *nbytes > 0) {
  if (cbytes != NULL && *cbytes <= 0) {
    BLOSC_TRACE_ERROR("Invalid compressed size in frame header.");
    return BLOSC2_ERROR_INVALID_HEADER;
  }
  if (blocksize != NULL && *blocksize <= 0) {
    BLOSC_TRACE_ERROR("Invalid block size in frame header.");
    return BLOSC2_ERROR_INVALID_HEADER;
  }
  if (chunksize != NULL && *chunksize <= 0) {
    BLOSC_TRACE_ERROR("Invalid chunk size in frame header.");
    return BLOSC2_ERROR_INVALID_HEADER;
  }
  if (typesize != NULL && (*typesize < 1 || *typesize > BLOSC_MAX_TYPESIZE)) {
    BLOSC_TRACE_ERROR("Invalid type size in frame header.");
    return BLOSC2_ERROR_INVALID_HEADER;
  }
}