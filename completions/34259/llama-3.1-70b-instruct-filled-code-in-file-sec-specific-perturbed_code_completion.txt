// Fetch some internal lengths
from_big(header_len, frame_pointer + FRAME_HEADER_LEN, sizeof(*header_len));
// Convert several fields from the header data in the frame to native byte order.
// These fields include frame length, uncompressed size, compressed size,
// block size, chunk size, and type size, depending on provided pointers.
// Return an error code if any of the fields are invalid or if the header length is out of bounds.
from_big(frame_len, frame_pointer + FRAME_LEN, sizeof(*frame_len));
if (frame_len < 0 || frame_len > INT64_MAX) {
    return BLOSC2_ERROR_DATA;
}
if (nbytes!= NULL) {
    from_big(nbytes, frame_pointer + FRAME_NBYTES, sizeof(*nbytes));
    if (*nbytes < 0) {
        return BLOSC2_ERROR_DATA;
    }
}
if (cbytes!= NULL) {
    from_big(cbytes, frame_pointer + FRAME_CBYTES, sizeof(*cbytes));
    if (*cbytes < 0) {
        return BLOSC2_ERROR_DATA;
    }
}
if (blocksize!= NULL) {
    from_big(blocksize, frame_pointer + FRAME_BLOCKSIZE, sizeof(*blocksize));
    if (*blocksize < 0) {
        return BLOSC2_ERROR_DATA;
    }
}
if (chunksize!= NULL) {
    from_big(chunksize, frame_pointer + FRAME_CHUNKSIZE, sizeof(*chunksize));
    if (*chunksize < 0) {
        return BLOSC2_ERROR_DATA;
    }
}
if (typesize!= NULL) {
    from_big(typesize, frame_pointer + FRAME_TYPESIZE, sizeof(*typesize));
    if (*typesize < 0) {
        return BLOSC2_ERROR_DATA;
    }
}