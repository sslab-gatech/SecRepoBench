// Check that the header length is valid
if (*header_len < FRAME_HEADER_MINLEN) {
  return BLOSC2_ERROR_INVALID_HEADER;
}

// Extract frame length if pointer provided
if (frame_len != NULL) {
  from_big(frame_len, frame_pointer + FRAME_LEN, sizeof(*frame_len));
  // Validate frame length is positive
  if (*frame_len <= 0) {
    return BLOSC2_ERROR_INVALID_HEADER;
  }
  // Check if we have a cframe and validate frame length doesn't exceed it
  if (frame->cframe != NULL && *frame_len > frame->len) {
    return BLOSC2_ERROR_INVALID_HEADER;
  }
}

// Extract uncompressed size if pointer provided
if (nbytes != NULL) {
  from_big(nbytes, frame_pointer + FRAME_NBYTES, sizeof(*nbytes));
  // Validate nbytes is non-negative
  if (*nbytes < 0) {
    return BLOSC2_ERROR_INVALID_HEADER;
  }
}

// Extract compressed size if pointer provided
if (cbytes != NULL) {
  from_big(cbytes, frame_pointer + FRAME_CBYTES, sizeof(*cbytes));
  // Validate cbytes is non-negative
  if (*cbytes < 0) {
    return BLOSC2_ERROR_INVALID_HEADER;
  }
}

// Extract block size if pointer provided
if (blocksize != NULL) {
  from_big(blocksize, frame_pointer + FRAME_BLOCKSIZE, sizeof(*blocksize));
  // Validate blocksize is positive
  if (*blocksize <= 0) {
    return BLOSC2_ERROR_INVALID_HEADER;
  }
}

// Extract chunk size if pointer provided
if (chunksize != NULL) {
  from_big(chunksize, frame_pointer + FRAME_CHUNKSIZE, sizeof(*chunksize));
  // Validate chunksize is positive
  if (*chunksize <= 0) {
    return BLOSC2_ERROR_INVALID_HEADER;
  }
}

// Extract type size if pointer provided
if (typesize != NULL) {
  from_big(typesize, frame_pointer + FRAME_TYPESIZE, sizeof(*typesize));
  // Validate typesize is positive
  if (*typesize <= 0) {
    return BLOSC2_ERROR_INVALID_HEADER;
  }
}