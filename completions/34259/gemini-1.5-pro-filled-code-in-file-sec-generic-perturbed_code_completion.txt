from_big(&frame_len, frame_pointer + FRAME_LEN, sizeof(*frame_len));
if (frame_len < 0 || (frame->sframe && frame_len > 0) || (!frame->sframe && frame_len <= 0)) {
  return BLOSC2_ERROR_INVALID_HEADER;
}
*frame_len = frame_len;

if (nbytes != NULL) {
  from_big(nbytes, frame_pointer + FRAME_NBYTES, sizeof(*nbytes));
  if (*nbytes < 0) {
    return BLOSC2_ERROR_INVALID_HEADER;
  }
}

if (cbytes != NULL) {
  from_big(cbytes, frame_pointer + FRAME_CBYTES, sizeof(*cbytes));
  if (*cbytes < 0) {
    return BLOSC2_ERROR_INVALID_HEADER;
  }
}

if (typesize != NULL) {
  from_big(typesize, frame_pointer + FRAME_TYPESIZE, sizeof(*typesize));
  if (*typesize <= 0) {
    return BLOSC2_ERROR_INVALID_HEADER;
  }
}

if (blocksize != NULL) {
  from_big(blocksize, frame_pointer + FRAME_BLOCKSIZE, sizeof(*blocksize));
  if (*blocksize <= 0) {
    return BLOSC2_ERROR_INVALID_HEADER;
  }
}

if (chunksize != NULL) {
  from_big(chunksize, frame_pointer + FRAME_CHUNKSIZE, sizeof(*chunksize));
  if (*chunksize <= 0) {
    return BLOSC2_ERROR_INVALID_HEADER;
  }
}

if (*header_len > FRAME_HEADER_LENGTH) {
  BLOSC_TRACE_ERROR("The header length is out of bounds.");
  return BLOSC2_ERROR_INVALID_HEADER;
}