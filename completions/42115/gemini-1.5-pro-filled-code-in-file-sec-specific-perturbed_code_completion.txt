if(general_name_type == 0x87) {
		    /* ipAddress */
		    if(len == 4) {
		      snprintf(dNSName, sizeof(dNSName), "%u.%u.%u.%u",
			       packet->payload[i+2], packet->payload[i+3],
			       packet->payload[i+4], packet->payload[i+5]);
		    } else if(len == 16) {
		      snprintf(dNSName, sizeof(dNSName), "%02X%02X:%02X%02X:%02X%02X:%02X%02X:%02X%02X:%02X%02X:%02X%02X:%02X%02X",
			       packet->payload[i+2], packet->payload[i+3], packet->payload[i+4], packet->payload[i+5],
			       packet->payload[i+6], packet->payload[i+7], packet->payload[i+8], packet->payload[i+9],
			       packet->payload[i+10], packet->payload[i+11], packet->payload[i+12], packet->payload[i+13],
			       packet->payload[i+14], packet->payload[i+15], packet->payload[i+16], packet->payload[i+17]);
		    } else {
		      ndpi_set_risk(ndpi_struct, connection, NDPI_TLS_SUSPICIOUS_EXTENSION);
		      break;
		    }
		  } else {
		    strncpy(dNSName, (const char*)&packet->payload[i+2], len);
		    dNSName[len] = '\0';
		  }

		  cleanupServerName(dNSName, len);

		  if(ndpi_is_printable_string(dNSName, len) == 0)
		    ndpi_set_risk(ndpi_struct, connection, NDPI_INVALID_CHARACTERS);

		  if(strcmp(dNSName, connection->host_server_name) == 0)
		    matched_name = 1;

		  if(connection->server_names) {
		    int new_len = strlen(connection->server_names) + strlen(dNSName) + 2;
		    char *new_buf = (char*)ndpi_realloc(connection->server_names, strlen(connection->server_names)+1, new_len);

		    if(new_buf) {
		      connection->server_names = new_buf;
		      strcat(connection->server_names, ",");
		      strcat(connection->server_names, dNSName);
		    }
		  } else {
		    connection->server_names = ndpi_strdup(dNSName);
		  }

		  if(!is_quic) {
		    if(ndpi_match_hostname_protocol(ndpi_struct, connection, NDPI_PROTOCOL_TLS, dNSName, len))
		      connection->protos.tls_quic.subprotocol_detected = 1;
		  } else {
		    if(ndpi_match_hostname_protocol(ndpi_struct, connection, NDPI_PROTOCOL_QUIC, dNSName, len))
		      connection->protos.tls_quic.subprotocol_detected = 1;
		  }

		  i += 2 + len + 1; /* +1 to skip next general name type */
		}