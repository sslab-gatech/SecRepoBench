memcpy(dNSName, &packet->payload[i + 2], len);
		  dNSName[len] = '\0';

		  ndpi_clean_dns_name(dNSName);

		  if(ndpi_is_printable_string(dNSName, len) == 0) {
		    ndpi_set_risk(ndpi_struct, connection, NDPI_INVALID_CHARACTERS);
		  } else {
		    if(strcasecmp(dNSName, connection->host_server_name) == 0) {
		      matched_name = 1;
		    }

		    if(connection->server_names == NULL) {
		      connection->server_names = ndpi_strdup(dNSName);
		    } else {
		      char *tmp = ndpi_strdup(connection->server_names);
		      char *new_str = ndpi_asprintf("%s,%s", tmp, dNSName);
		      ndpi_free(tmp);
		      ndpi_free(connection->server_names);
		      connection->server_names = new_str;
		    }

		    ndpi_detect_subprotocol_by_dns_name(ndpi_struct, connection, dNSName);
		  }