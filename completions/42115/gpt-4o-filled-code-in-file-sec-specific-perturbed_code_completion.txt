if (alpn_len < sizeof(dNSName)) {
		    memcpy(dNSName, &packet->payload[s_offset + 2], alpn_len);
		    dNSName[alpn_len] = '\0';

		    cleanupServerName(dNSName, alpn_len);

		    if (ndpi_is_printable_string(dNSName, alpn_len) == 0) {
		      ndpi_set_risk(ndpi_struct, connection, NDPI_INVALID_CHARACTERS);
		    }

		    if (strcmp(dNSName, connection->host_server_name) == 0) {
		      matched_name = 1;

		      if (connection->protos.tls_quic.server_names == NULL) {
		        connection->protos.tls_quic.server_names = ndpi_strdup(dNSName);
		      } else {
		        char *new_server_names;
		        size_t new_len = strlen(connection->protos.tls_quic.server_names) + alpn_len + 2;
		        new_server_names = (char *)ndpi_malloc(new_len);
		        if (new_server_names) {
		          snprintf(new_server_names, new_len, "%s,%s", connection->protos.tls_quic.server_names, dNSName);
		          ndpi_free(connection->protos.tls_quic.server_names);
		          connection->protos.tls_quic.server_names = new_server_names;
		        }
		      }

		      ndpi_match_hostname_protocol(ndpi_struct, connection, NDPI_PROTOCOL_TLS, dNSName, alpn_len);
		    }
		  }