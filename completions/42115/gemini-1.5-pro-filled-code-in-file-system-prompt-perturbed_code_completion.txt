#ifdef DEBUG_TLS
		  printf("Client TLS [subjectAltName: type=%u len=%u]\n", general_name_type, len);
		  for(int k=0; k<len; k++) printf("%02X ", packet->payload[i+2+k]);
		  printf("\n");
#endif
		  if(general_name_type == 0x82 /* dNSName */) {
		    strncpy(dNSName, (const char*)&packet->payload[i+2], len);
		    dNSName[len] = '\0';
		    cleanupServerName(dNSName, len);

		    if(ndpi_is_printable_string(dNSName, len) == 0)
		      ndpi_set_risk(ndpi_struct, connection, NDPI_INVALID_CHARACTERS);

#ifdef DEBUG_TLS
		    printf("Client TLS [subjectAltName: %s]\n", dNSName);
#endif

		    if(strcmp(dNSName, connection->host_server_name) == 0)
		      matched_name = 1;

		    if(connection->server_names) {
		      int new_len = strlen(connection->server_names) + strlen(dNSName) + 2;
		      char *new_buf = (char*)ndpi_realloc(connection->server_names,
							 strlen(connection->server_names)+1, new_len);

		      if(new_buf) {
			connection->server_names = new_buf;
			strcat(connection->server_names, ",");
			strcat(connection->server_names, dNSName);
		      }
		    } else {
		      connection->server_names = ndpi_strdup(dNSName);
		    }

		    if(!is_quic) {
		      if(ndpi_match_hostname_protocol(ndpi_struct, connection, NDPI_PROTOCOL_TLS, dNSName, len))
			connection->protos.tls_quic.subprotocol_detected = 1;
		    } else {
		      if(ndpi_match_hostname_protocol(ndpi_struct, connection, NDPI_PROTOCOL_QUIC, dNSName, len))
			connection->protos.tls_quic.subprotocol_detected = 1;
		    }
		  } else if(general_name_type == 0x87 /* ipAddress */) {
		    if(len == 4 || len == 16) {
		      char ip_address[INET6_ADDRSTRLEN];

		      if(inet_ntop(len == 4 ? AF_INET : AF_INET6, (const void*)&packet->payload[i+2], ip_address, sizeof(ip_address))) {
#ifdef DEBUG_TLS
			printf("Client TLS [subjectAltName: %s]\n", ip_address);
#endif
			if(connection->server_names) {
			  int new_len = strlen(connection->server_names) + strlen(ip_address) + 2;
			  char *new_buf = (char*)ndpi_realloc(connection->server_names,
							     strlen(connection->server_names)+1, new_len);

			  if(new_buf) {
			    connection->server_names = new_buf;
			    strcat(connection->server_names, ",");
			    strcat(connection->server_names, ip_address);
			  }
			} else {
			  connection->server_names = ndpi_strdup(ip_address);
			}
		      }
		    }
		  }

		  i += 2 + len;