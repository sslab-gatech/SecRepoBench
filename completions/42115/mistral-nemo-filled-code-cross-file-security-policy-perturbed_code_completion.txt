if((i < (packet->payload_packet_len - 1))
   && ((i + packet->payload[i + 1] + 2) < packet->payload_packet_len)) {
  u_int8_t len = packet->payload[i + 1];
  char dNSName[256];
  memcpy(dNSName, &packet->payload[i + 2], len);
  dNSName[len] = '\0';

  // Clean up the extracted DNS name and ensure it is printable.
  ndpi_cleanup_printable_string(dNSName, len);

  // Check if the extracted DNS name matches the host server name.
  if(strcmp(dNSName, connection->host_server_name) == 0) {
    matched_name = 1;
    ndpi_update_server_names_list(connection, dNSName);
  }

  i += len + 2; // Move to the next general name type.
} else {
#if DEBUG_TLS
  printf("[TLS] Leftover %u bytes", packet->payload_packet_len - i);
#endif
  ndpi_set_risk(ndpi_struct, connection, NDPI_TLS_SUSPICIOUS_EXTENSION);
  break;
}