strncpy(dNSName, (char *)&packet->payload[i + 2], len);
		  dNSName[len] = '\0';
		  cleanupServerName(dNSName, len);
		  if (ndpi_is_printable_string(dNSName, len) == 0) {
		    ndpi_set_risk(ndpi_struct, connection, NDPI_INVALID_CHARACTERS);
		  }
		  if (connection->host_server_name[0] == '\0' ||
		      strcasestr(connection->host_server_name, dNSName) != NULL) {
		    matched_name = 1;
		    if (connection->server_names == NULL) {
		      connection->server_names = ndpi_strdup(dNSName);
		    } else {
		      char *new_server_names = (char *)ndpi_malloc(strlen(connection->server_names) + strlen(dNSName) + 2);
		      if (new_server_names != NULL) {
			sprintf(new_server_names, "%s,%s", connection->server_names, dNSName);
			ndpi_free(connection->server_names);
			connection->server_names = new_server_names;
		      }
		    }
		    if (!is_quic) {
		      if (ndpi_match_hostname_protocol(ndpi_struct, connection, NDPI_PROTOCOL_TLS, dNSName, len))
			connection->protos.tls_quic.subprotocol_detected = 1;
		    } else {
		      if (ndpi_match_hostname_protocol(ndpi_struct, connection, NDPI_PROTOCOL_QUIC, dNSName, len))
			connection->protos.tls_quic.subprotocol_detected = 1;
		    }
		  }
		}