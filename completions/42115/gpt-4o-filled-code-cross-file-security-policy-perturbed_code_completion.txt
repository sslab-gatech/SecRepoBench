// Initialize the dNSName buffer to ensure it starts with a known state
memset(dNSName, 0, sizeof(dNSName));

// Extract the DNS name or IP address from the subjectAltName extension
strncpy(dNSName, (const char*)&packet->payload[i + 2], len);
dNSName[len] = '\0';

// Ensure the extracted DNS name is printable
if(ndpi_is_printable_string(dNSName, len)) {
  // Check if the extracted DNS name matches the host server name
  if(strcasecmp(dNSName, connection->host_server_name) == 0) {
    matched_name = 1;
  }

  // Update the server names list in the flow structure
  if(connection->protos.tls_quic.server_names == NULL) {
    connection->protos.tls_quic.server_names = ndpi_strdup(dNSName);
  } else {
    char *new_server_names = ndpi_strcat(connection->protos.tls_quic.server_names, ",");
    new_server_names = ndpi_strcat(new_server_names, dNSName);
    connection->protos.tls_quic.server_names = new_server_names;
  }

  // Attempt to detect a subprotocol based on the DNS name
  checkTLSSubprotocol(ndpi_struct, connection, 0);
}