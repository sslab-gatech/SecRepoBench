memset(dNSName, 0, sizeof(dNSName));
		  if(general_name_type == 0x87) { /* ipAddress */
		    u_int8_t j;
		    for (j = 0; j < len; j++) {
		      snprintf(&dNSName[strlen(dNSName)], sizeof(dNSName) - strlen(dNSName), "%u%s", packet->payload[i + 2 + j], (j == (len-1)) ? "" : ".");
		    }
		  } else {
		    if(len < (sizeof(dNSName)-1)) {
		      memcpy(dNSName, (const char*)&packet->payload[i+2], len);
		      dNSName[len] = '\0';
		    }

		    ndpi_sanitize_string(dNSName, len);
		  }

		  if(ndpi_is_printable_string(dNSName, len) == 0) {
		    ndpi_set_risk(ndpi_struct, connection, NDPI_INVALID_CHARACTERS);
		  }

#ifdef DEBUG_TLS
		  printf("******* [TLS] subjectAltName [%s]\n", dNSName);
#endif

		  if(strcmp(connection->host_server_name, dNSName) == 0) {
		    matched_name = 1;
		  }

		  if(connection->protos.tls_quic.server_names == NULL) {
		    connection->protos.tls_quic.server_names = ndpi_strdup(dNSName);
		  } else {
		    char *new_server_name;
		    size_t new_len = strlen(connection->protos.tls_quic.server_names) + strlen(dNSName) + 2;
		    new_server_name = realloc(connection->protos.tls_quic.server_names, new_len);
		    if(new_server_name != NULL) {
		      strcat(new_server_name, ",");
		      strcat(new_server_name, dNSName);
		      connection->protos.tls_quic.server_names = new_server_name;
		    }
		  }

		  ndpi_detect_subprotocol_by_hostname(ndpi_struct, connection, dNSName, len);

		  i += 2; /* skip type and len */
		}