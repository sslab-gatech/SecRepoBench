memset(dNSName, 0, sizeof(dNSName));

		  if(general_name_type == 0x87) { /* ipAddress */
		    u_int8_t ip_type = packet->payload[i+2];

		    if(ip_type == 0x04) { /* IPv4 */
		      snprintf(dNSName, sizeof(dNSName), "%u.%u.%u.%u",
			       packet->payload[i+3], packet->payload[i+4],
			       packet->payload[i+5], packet->payload[i+6]);
		      len = 3; /* 3 more bytes */
		    } else if(ip_type == 0x06) { /* IPv6 */
		      snprintf(dNSName, sizeof(dNSName),
			       "%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x",
			       packet->payload[i+3], packet->payload[i+4], packet->payload[i+5], packet->payload[i+6],
			       packet->payload[i+7], packet->payload[i+8], packet->payload[i+9], packet->payload[i+10],
			       packet->payload[i+11], packet->payload[i+12], packet->payload[i+13], packet->payload[i+14],
			       packet->payload[i+15], packet->payload[i+16], packet->payload[i+17], packet->payload[i+18]);
		      len = 15; /* 15 more bytes */
		    }
		  } else {
		    strncpy(dNSName, (const char*)&packet->payload[i+2], len);
		    dNSName[len] = '\0';

		    if(ndpi_is_printable_string(dNSName, len) == 0) {
		      ndpi_set_risk(ndpi_struct, connection, NDPI_INVALID_CHARACTERS);
		    }
		  }

		  if(strcmp(connection->host_server_name, dNSName) == 0) {
		    matched_name = 1;
		  }

		  if(connection->protos.tls_quic.server_names == NULL) {
		    connection->protos.tls_quic.server_names = ndpi_strdup(dNSName);
		  } else {
		    char *new_server_name;
		    size_t new_len = strlen(connection->protos.tls_quic.server_names) + strlen(dNSName) + 2;
		    new_server_name = realloc(connection->protos.tls_quic.server_names, new_len);
		    if(new_server_name != NULL) {
		      strcat(new_server_name, ",");
		      strcat(new_server_name, dNSName);
		      connection->protos.tls_quic.server_names = new_server_name;
		    }
		  }

		  ndpi_search_subprotocol_by_hostname(ndpi_struct, connection, dNSName);

		  i += 2 + len; /* general_name_type + len + name */
		}