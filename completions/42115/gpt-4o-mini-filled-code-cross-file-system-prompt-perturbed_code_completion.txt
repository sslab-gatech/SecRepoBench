strncpy(dNSName, (const char*)&packet->payload[i + 2], len);
		  dNSName[len] = '\0';

		  // Clean up the extracted DNS name
		  if (is_valid_dns_name(dNSName)) {
		    // Check if the extracted DNS name matches the host server name
		    if (strcmp(dNSName, connection->host_server_name) == 0) {
		      matched_name = 1;
		      // Update the server names list in the flow structure
		      if (connection->protos.tls_quic.server_names == NULL) {
			connection->protos.tls_quic.server_names = strdup(dNSName);
		      } else {
			char *new_names = malloc(strlen(connection->protos.tls_quic.server_names) + strlen(dNSName) + 2);
			sprintf(new_names, "%s,%s", connection->protos.tls_quic.server_names, dNSName);
			free(connection->protos.tls_quic.server_names);
			connection->protos.tls_quic.server_names = new_names;
		      }
		      // Attempt to detect a subprotocol based on the DNS name
		      detect_subprotocol(ndpi_struct, connection, dNSName);
		    }
		  }