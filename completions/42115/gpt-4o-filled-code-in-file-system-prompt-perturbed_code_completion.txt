if (general_name_type == 0x82) { /* dNSName */
		    if (len < sizeof(dNSName)) {
		      memcpy(dNSName, &packet->payload[i + 2], len);
		      dNSName[len] = '\0';

		      cleanupServerName(dNSName, len);

		      if (ndpi_is_printable_string(dNSName, len) == 0) {
		        ndpi_set_risk(ndpi_struct, connection, NDPI_INVALID_CHARACTERS);
		      }

		      if (strcmp(dNSName, connection->host_server_name) == 0) {
		        matched_name = 1;
		      }

		      if (connection->protos.tls_quic.server_names == NULL) {
		        connection->protos.tls_quic.server_names = ndpi_strdup(dNSName);
		      } else {
		        char *new_server_names = ndpi_malloc(strlen(connection->protos.tls_quic.server_names) + len + 2);
		        if (new_server_names) {
		          sprintf(new_server_names, "%s,%s", connection->protos.tls_quic.server_names, dNSName);
		          ndpi_free(connection->protos.tls_quic.server_names);
		          connection->protos.tls_quic.server_names = new_server_names;
		        }
		      }

		      if (ndpi_match_hostname_protocol(ndpi_struct, connection, NDPI_PROTOCOL_TLS, dNSName, len)) {
		        connection->protos.tls_quic.subprotocol_detected = 1;
		      }
		    }
		  } else if (general_name_type == 0x87) { /* ipAddress */
		    if (len == 4 || len == 16) {
		      char ip_str[INET6_ADDRSTRLEN];
		      if (inet_ntop((len == 4) ? AF_INET : AF_INET6, &packet->payload[i + 2], ip_str, sizeof(ip_str))) {
		        if (strcmp(ip_str, connection->host_server_name) == 0) {
		          matched_name = 1;
		        }
		      }
		    }
		  }