size_t max_out_size = input_size * 1.1 + 12; // 10% overhead plus 12 bytes for header and CRC
    void *out_buf = flb_malloc(max_out_size);