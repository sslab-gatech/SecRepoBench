size_t out_size = input_size + (input_size >> 4) + 16; // Calculate max output size
    void *out_buf = flb_malloc(out_size); // Allocate output buffer
    uint8_t *pb;
    int status;
    size_t footer_start;
    mz_ulong crc;
    mz_stream strm;