int status;
size_t footer_start;
uint8_t *pb;
size_t out_size;
void *out_buf;
z_stream strm;
mz_ulong crc;

/* Calculate max size needed for compressed data */
size_t max_overhead = (input_size >> 12) + (input_size >> 14) + (input_size >> 25) + 13 + FLB_GZIP_HEADER_OFFSET + 8;
if (SIZE_MAX - input_size < max_overhead) {
    flb_error("[gzip] input size too large, would cause integer overflow");
    return -1;
}
out_size = input_size + max_overhead;
out_buf = flb_malloc(out_size);