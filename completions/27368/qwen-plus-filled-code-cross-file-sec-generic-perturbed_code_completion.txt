int status;
    uint8_t *pb;
    size_t out_size;
    mz_stream strm;
    mz_ulong crc;

    /* Calculate maximum output buffer size */
    out_size = input_size + (input_size >> 12) + 13 + 12; // Worst-case zlib expansion

    /* Allocate memory for output buffer */
    void *out_buf = flb_malloc(out_size);