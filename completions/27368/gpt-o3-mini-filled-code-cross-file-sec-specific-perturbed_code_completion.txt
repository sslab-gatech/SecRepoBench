size_t comp_bound = compressBound(input_size);
if (comp_bound > SIZE_MAX - FLB_GZIP_HEADER_OFFSET - 8) {
    flb_error("[gzip] output size calculation overflow");
    return -1;
}
out_size = FLB_GZIP_HEADER_OFFSET + comp_bound + 8;
out_buf = flb_malloc(out_size);