while (step) {
	// Iterate over directory entries in the buffer while there is data to process.
	// For each directory entry, parse its file information, and handle special cases:
	// - Skip entries for '.' and '..' directories.
	// - Manage multi-extent files by collecting their contents into a list.
	// - For each valid directory entry, add it to the archive structure.
	// - Handle memory allocation and error management for multi-extent file handling.
	// <MASK>

	// Check if the current entry is a '.' or '..' directory.
	if (isodirrec[DR_name_len_offset] == 1 && isodirrec[DR_name_offset] == '.') {
		// Skip '.' directory.
		step -= LOGICAL_BLOCK_SIZE;
		isodirrec += LOGICAL_BLOCK_SIZE;
		continue;
	} else if (isodirrec[DR_name_len_offset] == 2 && isodirrec[DR_name_offset] == '.' &&
		isodirrec[DR_name_offset + 1] == '.') {
		// Skip '..' directory.
		step -= LOGICAL_BLOCK_SIZE;
		isodirrec += LOGICAL_BLOCK_SIZE;
		continue;
	}

	// Parse the file information from the current directory entry.
	file = parse_file_info(a, parent, isodirrec, reclen);
	if (file == NULL) {
		// Error parsing file information.
		archive_set_error(&a->archive, ARCHIVE_ERRNO_MISC,
			"Failed to parse file information");
		return ARCHIVE_FATAL;
	}

	// Add the file to the archive structure.
	if (add_entry(a, iso9660, file)!= ARCHIVE_OK) {
		// Error adding file to archive structure.
		return ARCHIVE_FATAL;
	}

	// Move to the next directory entry.
	isodirrec += reclen;
	step -= reclen;
}