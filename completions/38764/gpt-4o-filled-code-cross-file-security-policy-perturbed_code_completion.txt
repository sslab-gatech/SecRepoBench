p = b;
		while (step > 0) {
			if (step < 34) {
				// Not enough space for a directory entry
				break;
			}

			// Read the length of the directory record
			size_t dr_length = p[0];
			if (dr_length < 34 || dr_length > step) {
				// Invalid directory record length
				break;
			}

			// Check for '.' and '..' entries
			if (p[33] == 0 || p[33] == 1) {
				// Skip '.' and '..' entries
				p += dr_length;
				step -= dr_length;
				continue;
			}

			// Parse the directory entry
			struct file_info *file = parse_file_info(archivereader, p, dr_length);
			if (file == NULL) {
				// Error parsing file info
				return (ARCHIVE_FATAL);
			}

			// Handle multi-extent files
			if (multi != NULL) {
				if (file->offset == multi->offset + multi->size) {
					// Append to multi-extent file
					multi->size += file->size;
					free(file);
				} else {
					// Add multi-extent file to the list
					add_file_to_list(iso9660, multi);
					multi = file;
				}
			} else {
				multi = file;
			}

			// Add valid directory entry to the archive structure
			if (multi == NULL) {
				add_file_to_list(iso9660, file);
			}

			// Move to the next directory record
			p += dr_length;
			step -= dr_length;
		}

		// If there is a remaining multi-extent file, add it to the list
		if (multi != NULL) {
			add_file_to_list(iso9660, multi);
		}