p = b + (b - (unsigned char *)0);
		step -= (size_t)(p - b);
		while (step >= 34 && p[DR_length_offset] <= step) {
			size_t reclen = p[DR_length_offset];
			struct file_info *file;

			file = parse_file_info(archivereader, parent, p, step);
			if (file == NULL)
				return (ARCHIVE_FATAL);
			if (file->multi_extent) {
				struct content *con;

				if (multi == NULL) {
					multi = (struct file_info *)
					    calloc(1, sizeof(*multi));
					if (multi == NULL) {
						archive_set_error(
						    &archivereader->archive,
						    ENOMEM,
						    "No memory for multi-extent file");
						return (ARCHIVE_FATAL);
					}
					multi->contents.first = NULL;
					multi->contents.last =
					    &(multi->contents.first);
				}
				con = (struct content *)calloc(1, sizeof(*con));
				if (con == NULL) {
					archive_set_error(
					    &archivereader->archive,
					    ENOMEM,
					    "No memory for multi-extent file");
					return (ARCHIVE_FATAL);
				}
				con->offset = file->offset;
				con->size = file->size;
				*multi->contents.last = con;
				multi->contents.last = &(con->next);
				free(file);
			} else
				add_entry(archivereader, iso9660, file);
			p += reclen;
			step -= reclen;
			p += (reclen & 1 ? 0 : 1);
			step -= (reclen & 1 ? 0 : 1);
		}