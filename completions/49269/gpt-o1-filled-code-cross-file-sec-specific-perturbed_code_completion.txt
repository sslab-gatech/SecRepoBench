{
  if (!number || !number->p) {
    return 0;
  }
  if (number->sn == 0) {
    return 1;
  }

  size_t i = number->sz;
  while (i > 0 && number->p[i - 1] == 0) {
    i--;
  }
  if (i == 0) {
    return 1;
  }

  mp_limb msd = number->p[i - 1];
  int leading_bits = 0;
  while (msd) {
    msd >>= 1;
    leading_bits++;
  }

  size_t total_bits = (i - 1) * DIGITBITS + leading_bits;
  double estimate = (double)total_bits * 0.30102999566398119521 + 1.0; /* base-10 digits â‰ˆ bits * log10(2) + 1 */
  return (size_t)estimate;
}