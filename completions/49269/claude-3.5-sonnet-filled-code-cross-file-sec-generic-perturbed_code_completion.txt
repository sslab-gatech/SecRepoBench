size_t sz = number->sz;
if (sz == 0) {
    return 1;  // Special case for zero
}

// Find the most significant non-zero digit
while (sz > 0 && number->p[sz - 1] == 0) {
    sz--;
}

if (sz == 0) {
    return 1;  // All digits were zero
}

// Calculate the number of digits in the most significant limb
size_t digit_count = (sz - 1) * DIGITBITS;
mp_limb msb = number->p[sz - 1];
while (msb) {
    digit_count++;
    msb >>= 1;
}

return digit_count;