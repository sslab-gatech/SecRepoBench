if (number->sn == 0) {
    /* if the number is zero, it has exactly 1 digit */
    return 1;
  }

  /* find the highest nonzero limb */
  size_t i = number->sz;
  while (i > 0) {
    i--;
    if (number->p[i] != 0) {
      break;
    }
    if (i == 0) {
      /* all limbs are zero, so it's effectively 0 */
      return 1;
    }
  }

  /* count the bits in the highest nonzero limb */
  mp_limb limb = number->p[i];
  int bits_in_limb = 0;
  while (limb > 0) {
    limb >>= 1;
    bits_in_limb++;
  }

  /* total bits = i*DIGITBITS + bits_in_limb */
  size_t total_bits = (i * DIGITBITS) + bits_in_limb;

  /* approximate the decimal digit count: floor((total_bits - 1)*log10(2)) + 1 */
  const double LOG10_2 = 0.30102999566398119521;
  double approx = ((double)(total_bits - 1) * LOG10_2) + 1.0;

  /* return the integer part */
  return (size_t)floor(approx);