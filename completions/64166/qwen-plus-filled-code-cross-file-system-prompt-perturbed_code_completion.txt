if (DeviceLink == NULL) {
    cmsDeleteTransform(xform);
    return 0;
}

// Force CLUT usage
dwFlags |= cmsFLAGS_FORCE_CLUT;

// Optimize the pipeline for color rendering
cmsOptimizePipeline(DeviceLink, dwFlags | cmsFLAGS_HIGHRESPRECALC);