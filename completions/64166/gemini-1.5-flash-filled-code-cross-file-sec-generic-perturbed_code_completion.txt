if (DeviceLink == NULL) {
        cmsDeleteTransform(xform);
        return 0;
    }

    DeviceLink = cmsPipelineAlloc(m ->ContextID);
    if (DeviceLink == NULL) {
        cmsDeleteTransform(xform);
        return 0;
    }

    cmsPipelineInsertStage(DeviceLink, cmsPipelineGetPtrToFirstStage(v ->Lut));
    cmsPipelineSetSaveAs(DeviceLink, cmsFLAGS_FORCE_CLUT);
    _cmsOptimizePipeline(DeviceLink);