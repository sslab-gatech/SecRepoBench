if (DeviceLink == NULL) {
        cmsDeleteTransform(xform);
        return 0;
    }

    DeviceLink = cmsPipelineAlloc(m ->ContextID);
    cmsPipelineInsertStage(DeviceLink, cmsAT_BEGIN, cmsDupStage(v ->Lut));
    cmsPipelineSetSaveAs8Bits(DeviceLink, TRUE);
    cmsPipelineSetSaveAsFloat(DeviceLink, FALSE);
    cmsPipelineSetForceCLUT(DeviceLink, TRUE);
    _cmsOptimizePipeline(DeviceLink, lDoBPC);