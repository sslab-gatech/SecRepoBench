// Check if the IP and PORT separator was found in the payload.
// If found, extract the IP address string from the packet's payload.
// Copy the extracted IP address into the flow structure, ensuring it fits within the allocated space.
// Null-terminate the copied IP address in the flow structure.
ip_port_separator = ndpi_strnstr((char const *)packet_data->payload + NDPI_STATICSTRING_LEN("IP="),
                                 ",PORT=",
                                 packet_data->payload_packet_len - NDPI_STATICSTRING_LEN("IP="));
if (ip_port_separator!= NULL)
{
  ip_len = ndpi_min(sizeof(flow->protos.softether.ip) - 1,
                    ip_port_separator - (char const *)packet_data->payload - NDPI_STATICSTRING_LEN("IP="));
  strncpy(flow->protos.softether.ip, (char const *)packet_data->payload + NDPI_STATICSTRING_LEN("IP="),
          ip_len);
  flow->protos.softether.ip[ip_len] = '\0';
}