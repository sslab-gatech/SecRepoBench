if (ip_port_separator != NULL) {
  ip_len = ip_port_separator - (char const *)packet_data->payload - NDPI_STATICSTRING_LEN("IP=");
  size_t len = ndpi_min(ip_len, sizeof(flow->protos.softether.ip) - 1);
  strncpy(flow->protos.softether.ip, (char const *)packet_data->payload + NDPI_STATICSTRING_LEN("IP="), len);
  flow->protos.softether.ip[len] = '\0';
}