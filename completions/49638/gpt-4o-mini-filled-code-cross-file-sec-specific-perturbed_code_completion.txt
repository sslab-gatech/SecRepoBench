ip_len = ip_port_separator - (char const *)packet_data->payload - NDPI_STATICSTRING_LEN("IP=");
  if (ip_len >= sizeof(flow->protos.softether.ip)) {
    return 1; // Prevent buffer overflow
  }
  strncpy(flow->protos.softether.ip, (char const *)packet_data->payload + NDPI_STATICSTRING_LEN("IP="), ip_len);
  flow->protos.softether.ip[ip_len] = '\0'; // Null-terminate the copied IP address