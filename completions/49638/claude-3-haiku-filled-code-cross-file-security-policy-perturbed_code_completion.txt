// Check if the IP and PORT separator was found in the payload.
if (ip_port_separator != NULL) {
    // Extract the IP address string from the packet's payload.
    ip_len = ip_port_separator - (char const *)packet_data->payload - NDPI_STATICSTRING_LEN("IP=");
    // Copy the extracted IP address into the flow structure, ensuring it fits within the allocated space.
    strncpy(flow->protos.softether.ip_address, (char const *)packet_data->payload + NDPI_STATICSTRING_LEN("IP="), ndpi_min(sizeof(flow->protos.softether.ip_address) - 1, ip_len));
    // Null-terminate the copied IP address in the flow structure.
    flow->protos.softether.ip_address[ndpi_min(sizeof(flow->protos.softether.ip_address) - 1, ip_len)] = '\0';
} else {
    return 1;
}