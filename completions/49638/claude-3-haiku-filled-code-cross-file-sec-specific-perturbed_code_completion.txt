// Check if the IP and PORT separator was found in the payload.
if (ip_port_separator != NULL) {
    // Extract the IP address string from the packet's payload.
    ip_len = ip_port_separator - (char const *)packet_data->payload - NDPI_STATICSTRING_LEN("IP=");
    if (ip_len < sizeof(flow->protos.softether.ip)) {
        // Copy the extracted IP address into the flow structure, ensuring it fits within the allocated space.
        strncpy(flow->protos.softether.ip, (char const *)packet_data->payload + NDPI_STATICSTRING_LEN("IP="), ip_len);
        // Null-terminate the copied IP address in the flow structure.
        flow->protos.softether.ip[ip_len] = '\0';
    } else {
        // The IP address is too long to fit in the flow structure, handle the error appropriately.
        return 1;
    }
} else {
    // The IP and PORT separator was not found in the payload, handle the error appropriately.
    return 1;
}