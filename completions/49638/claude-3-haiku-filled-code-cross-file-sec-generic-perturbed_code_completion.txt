if (ip_port_separator != NULL) {
    ip_len = ip_port_separator - (char const *)packet_data->payload - NDPI_STATICSTRING_LEN("IP=");
    if (ip_len < sizeof(flow->protos.softether.ip)) {
        strncpy(flow->protos.softether.ip, (char const *)packet_data->payload + NDPI_STATICSTRING_LEN("IP="), ip_len);
        flow->protos.softether.ip[ip_len] = '\0';
    } else {
        // Handle the case where the IP address is too long to fit in the flow structure
        return 1;
    }
} else {
    // The IP and PORT separator was not found in the payload
    return 1;
}