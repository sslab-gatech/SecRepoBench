port_len = ndpi_min(sizeof(flow->protos.softether.port) - 1,
                    ip_port_separator - (char const *)packet_data->payload -
                    NDPI_STATICSTRING_LEN("IP=") - NDPI_STATICSTRING_LEN(",PORT="));
strncpy(flow->protos.softether.port, ip_port_separator + NDPI_STATICSTRING_LEN(",PORT="),
        port_len);
flow->protos.softether.port[port_len] = '\0';