if (ip_port_separator == NULL || ip_port_separator < (char const *)packet_data->payload + NDPI_STATICSTRING_LEN("IP=")) {
    return 1;
  }

  ip_len = ndpi_min(sizeof(flow->protos.softether.ip) - 1,
                    (size_t)(ip_port_separator - (char const *)packet_data->payload - NDPI_STATICSTRING_LEN("IP=")));
  if (ip_len > sizeof(flow->protos.softether.ip) -1) {
      return 1;
  }

  strncpy(flow->protos.softether.ip, (char const *)packet_data->payload + NDPI_STATICSTRING_LEN("IP="), ip_len);
  flow->protos.softether.ip[ip_len] = '\0';