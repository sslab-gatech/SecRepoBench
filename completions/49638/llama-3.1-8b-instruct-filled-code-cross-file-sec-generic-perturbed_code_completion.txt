// <MASK>
if (ip_port_separator!= NULL)
{
  // Extract the IP address string from the packet's payload.
  ip_len = ndpi_min(sizeof(flow->protos.softether.ip) - 1,
                    ip_port_separator - (char const *)packet_data->payload);
  strncpy(flow->protos.softether.ip, ip_port_separator,
          ip_len);
  flow->protos.softether.ip[ip_len] = '\0';
}
else
{
  return 1;
}