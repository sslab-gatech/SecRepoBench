if (get_type () == ExtensionType) {
  const auto& subtables = get_subtables<TSubTable>();
  if (subtables.empty ()) return_trace (false);

  hb_set_t types;
  for (const auto& subtable : subtables) {
    if (!subtable.intersects (glyphs, lookup_context)) continue;
    types.insert (subtable.get_type ());
  }

  if (types.size () != 1) return_trace (false);
}

return_trace (true);