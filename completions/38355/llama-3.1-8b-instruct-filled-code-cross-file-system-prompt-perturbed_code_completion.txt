if (lookupFlag & LookupFlag::UseExtensionSubtables)
{
  const hb_set_t *glyphset = c->plan->glyphset_gsub ();
  unsigned int lookup_type = get_type ();
  + hb_iter (get_subtables <TSubTable> ())
  | hb_filter ([this, glyphset, lookup_type] (const Offset16To<TSubTable> &_) { return (this+_).intersects (glyphset, lookup_type); })
  | hb_map ([this] (const Offset16To<TSubTable> &_) { return _.get_type (); })
  | hb_any
  | hb_filter ([this] (unsigned int type) { return type!= get_type (); })
  | hb_all
  ;
  if (unlikely (!c->check_extension_subtables (get_subtable_count ()))) return_trace (false);
}
if (lookupFlag & LookupFlag::UseExtensionSubtables && get_subtable_count () > 0)
{
  unsigned int extension_type = get_subtables<TSubTable> ().dispatch (c, this, get_type ());
  if (unlikely (!c->check_extension_subtable (extension_type))) return_trace (false);
}
return_trace (true);