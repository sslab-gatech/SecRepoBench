long i;
bitint a, b, c, d;

for (i = 0; i + sizeof(bitint) <= n; i += sizeof(bitint)) {
  a = *(bitint*)(ys + i);
  b = *(bitint*)(needle);
  c = (a ^ b) & MASK2;
  d = (c - MASK1) & MASK3;
  if (MASK4 & (d << ((sizeof(bitint) - m) * 8)))
    return (mrb_int)i;
}