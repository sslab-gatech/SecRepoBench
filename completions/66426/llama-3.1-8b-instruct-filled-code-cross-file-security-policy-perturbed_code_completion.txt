// <MASK>
  {
    const bitint *s0 = (const bitint *)(ys + m);
    const bitint *s1 = s0 + (n - m) / 4;
    const bitint *s2 = s1 + (n - m) / 2;
    const bitint *s3 = s2 + (n - m) / 4;

    for (; s0 <= s3; s0++, s1++, s2++, s3++) {
      bitint a = *s0 & MASK1;
      bitint b = *s1 & MASK2;
      bitint c = *s2 & MASK3;
      bitint d = *s3 & MASK4;

      if ((a & needle[0])!= 0) {
        if (a == (needle[0] << 8)) {
          if (memcmp(s0 + 1, needle + 1, m - 1) == 0) return (mrb_int)(s0 - ys);
        }
        else if (a == (needle[0] << 16)) {
          if (memcmp(s0 + 2, needle + 1, m - 1) == 0) return (mrb_int)(s0 - ys);
        }
        else if (a == (needle[0] << 24)) {
          if (memcmp(s0 + 3, needle + 1, m - 1) == 0) return (mrb_int)(s0 - ys);
        }
      }

      if ((b & needle[0])!= 0) {
        if (b == (needle[0] << 8)) {
          if (memcmp(s1 + 1, needle + 1, m - 1) == 0) return (mrb_int)(s1 - ys);
        }
        else if (b == (needle[0] << 16)) {
          if (memcmp(s1 + 2, needle + 1, m - 1) == 0) return (mrb_int)(s1 - ys);
        }
        else if (b == (needle[0] << 24)) {
          if (memcmp(s1 + 3, needle + 1, m - 1) == 0) return (mrb_int)(s1 - ys);
        }
      }

      if ((c & needle[0])!= 0) {
        if (c == (needle[0] << 8)) {
          if (memcmp(s2 + 1, needle + 1, m - 1) == 0) return (mrb_int)(s2 - ys);
        }
        else if (c == (needle[0] << 16)) {
          if (memcmp(s2 + 2, needle + 1, m - 1) == 0) return (mrb_int)(s2 - ys);
        }
        else if (c == (needle[0] << 24)) {
          if (memcmp(s2 + 3, needle + 1, m - 1) == 0) return (mrb_int)(s2 - ys);
        }
      }

      if ((d & needle[0])!= 0) {
        if (d == (needle[0] << 8)) {
          if (memcmp(s3 + 1, needle + 1, m - 1) == 0) return (mrb_int)(s3 - ys);
        }
        else if (d == (needle[0] << 16)) {
          if (memcmp(s3 + 2, needle + 1, m - 1) == 0) return (mrb_int)(s3 - ys);
        }
        else if (d == (needle[0] << 24)) {
          if (memcmp(s3 + 3, needle + 1, m - 1) == 0) return (mrb_int)(s3 - ys);
        }
      }
    }
  }