bitint x, y, z;
bitint mask1 = MASK1;
bitint mask2 = MASK2;
bitint mask3 = MASK3;
bitint mask4 = MASK4;

x = *(bitint*)(ys);
y = *(bitint*)(needle);

z = (x ^ y) & mask1;
z = (z - mask1) & mask2;
if (z != 0) {
  return -1;
}

x = (x >> 8) & ~mask4;
y = (y >> 8) & ~mask4;

for (i = 1; i < m; i++) {
  if (x != y) {
    return -1;
  }
  x = (x >> 8) & ~mask4;
  y = (y >> 8) & ~mask4;
}

return 0;