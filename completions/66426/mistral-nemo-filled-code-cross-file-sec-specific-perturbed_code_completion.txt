bitint h = 0, g = 0, f = 0;
  for (long i = 0; i < m; i++) {
    h = (h << 8) | (bitint)needle[i];
    g = (g << 8) | (bitint)ys[i];
    f = (f << 8) | (bitint)ys[i + m];
  }
  h &= MASK1;
  g &= MASK2;
  f &= MASK3;
  if ((h ^ g) & MASK4) return -1;
  for (long i = m; i < n; i++) {
    h = ((h << 8) | (bitint)ys[i + m]) & MASK1;
    g = ((g << 8) | (bitint)ys[i]) & MASK2;
    f = ((f << 8) | (bitint)ys[i + m + 1]) & MASK3;
    if ((h ^ g) & MASK4) return -1;
    if (f == 0) return i - m + 1;
  }
  return -1;