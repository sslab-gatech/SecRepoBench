if (avctx->codec_id == AV_CODEC_ID_HYMT) {
    uint32_t info = AV_RL32(buf + buf_size - 4);
    if (info & 1) {
        av_log(avctx, AV_LOG_ERROR, "Invalid/misaligned slice info\n");
        return AVERROR_INVALIDDATA;
    }
    slices_info_offset = AV_RL32(buf + buf_size - 8);
    nb_slices = (info >> 4) + 1;
    if (slices_info_offset < table_size || slices_info_offset >= buf_size - 8 ||
        nb_slices * 8 + (int64_t)slices_info_offset > buf_size) {
        av_log(avctx, AV_LOG_ERROR, "Invalid slice info\n");
        return AVERROR_INVALIDDATA;
    }
    slice_height = height / nb_slices;
    if (height % nb_slices)
        return AVERROR_INVALIDDATA;
} else {
    nb_slices = 1;
    slice_height = height;
    slices_info_offset = 0;
}