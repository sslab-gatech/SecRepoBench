if (avctx->codec_id == AV_CODEC_ID_HYMT) {
    /* Ensure there is enough room for the slice table header (8 bytes) */
    if (table_size > (unsigned)buf_size || buf_size - table_size < 8)
        return AVERROR_INVALIDDATA;

    nb_slices    = AV_RL32(packet->data + table_size);
    slice_height = AV_RL32(packet->data + table_size + 4);
    slices_info_offset = table_size + 8;

    if (nb_slices <= 0 || slice_height <= 0 ||
        (unsigned)height != (unsigned)(nb_slices * slice_height) ||
        slices_info_offset > (unsigned)buf_size ||
        (unsigned)(slices_info_offset + nb_slices * 8) > (unsigned)buf_size)
        return AVERROR_INVALIDDATA;
} else {
    nb_slices = 1;
    slice_height = height;
    slices_info_offset = 0;
}