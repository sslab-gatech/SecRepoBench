if (avctx->codec_id == AV_CODEC_ID_HYMT) {
        if (buf_size < (width * height + 7) / 8 + 8)
            return AVERROR_INVALIDDATA;

        nb_slices = avctx->thread_count;
        slice_height = height / nb_slices;
        slices_info_offset = buf_size - (width * height + 7) / 8;

        if (nb_slices * slice_height != height)
            return AVERROR_INVALIDDATA;

        if (slices_info_offset < 8 || slices_info_offset > buf_size - 8)
            return AVERROR_INVALIDDATA;
    } else {
        nb_slices = 1;
        slice_height = height;
        slices_info_offset = 0;
    }