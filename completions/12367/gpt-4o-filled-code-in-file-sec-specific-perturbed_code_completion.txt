if (avctx->codec_id == AV_CODEC_ID_HYMT) {
        if (buf_size < 8 || AV_RL32(packet->data + buf_size - 8) != 0x484D5954) // "HYMT"
            return AVERROR_INVALIDDATA;

        nb_slices = AV_RL32(packet->data + buf_size - 4);
        if (nb_slices <= 0 || nb_slices > height || buf_size < nb_slices * 8 + 8)
            return AVERROR_INVALIDDATA;

        slice_height = height / nb_slices;
        slices_info_offset = buf_size - nb_slices * 8 - 8;
    } else {
        nb_slices = 1;
        slice_height = height;
        slices_info_offset = 0;
    }