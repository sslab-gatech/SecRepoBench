if (avctx->codec_id == AV_CODEC_ID_HYMT) {
        /* Ensure there's enough room in the buffer for the slice information. */
        if (buf_size - table_size < 12)
            return AVERROR_INVALIDDATA;

        /* Read the slice metadata from the last 12 bytes of the packet. */
        nb_slices         = AV_RL32(buf + buf_size - 12);
        slice_height      = AV_RL32(buf + buf_size - 8);
        slices_info_offset= AV_RL32(buf + buf_size - 4);

        /* Validate the slice parameters. */
        if (nb_slices < 1 || slice_height < 1)
            return AVERROR_INVALIDDATA;
        if ((int64_t)nb_slices * slice_height < height)
            return AVERROR_INVALIDDATA;

        /* Ensure slices_info_offset is valid and sufficient space for all slices. */
        if (slices_info_offset >= buf_size - table_size - 12)
            return AVERROR_INVALIDDATA;
        if (slices_info_offset + (uint64_t)nb_slices * 8ULL > buf_size - table_size - 12)
            return AVERROR_INVALIDDATA;
    } else {
        nb_slices         = 1;
        slice_height      = height;
        slices_info_offset= 0;
    }