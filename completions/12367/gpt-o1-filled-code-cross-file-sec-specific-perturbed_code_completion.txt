if (avctx->codec_id == AV_CODEC_ID_HYMT) {
        /* We need at least 12 bytes to read nb_slices, slice_height, and slices_info_offset */
        if (buf_size - table_size < 12)
            return AVERROR_INVALIDDATA;

        nb_slices       = AV_RL32(buf + buf_size - 12);
        slice_height    = AV_RL32(buf + buf_size - 8);
        slices_info_offset = AV_RL32(buf + buf_size - 4);

        /* Validate the values we just read */
        if (nb_slices < 1 || slice_height < 1)
            return AVERROR_INVALIDDATA;
        if ((int64_t)slice_height * nb_slices != height)
            return AVERROR_INVALIDDATA;

        /* Check that slice info area is within buffer bounds (avoid reading past the buffer) */
        if (slices_info_offset > (unsigned)(buf_size - table_size - 12))
            return AVERROR_INVALIDDATA;
        if ((uint64_t)slices_info_offset + (uint64_t)nb_slices * 8ULL >
            (uint64_t)(buf_size - table_size - 12))
            return AVERROR_INVALIDDATA;
    } else {
        nb_slices         = 1;
        slice_height      = height;
        slices_info_offset = 0;
    }