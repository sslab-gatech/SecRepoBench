if (avctx->codec_id == AV_CODEC_ID_HYMT) {
        if (buf_size < 12)
            return AVERROR_INVALIDDATA;

        nb_slices = AV_RL32(buf + 8);
        if (nb_slices <= 0 || nb_slices > height) {
            av_log(avctx, AV_LOG_ERROR, "Invalid number of slices: %d\n", nb_slices);
            return AVERROR_INVALIDDATA;
        }

        slice_height = height / nb_slices;
        if (height % nb_slices) {
            av_log(avctx, AV_LOG_ERROR, "height %d not divisible by %d slices\n", height, nb_slices);
            return AVERROR_INVALIDDATA;
        }

        slices_info_offset = buf_size - nb_slices * 8;
        if (slices_info_offset < table_size || slices_info_offset > buf_size) {
            av_log(avctx, AV_LOG_ERROR, "Invalid slices_info_offset: %u\n", slices_info_offset);
            return AVERROR_INVALIDDATA;
        }

        // Additional check to prevent potential overflow issues
        if ((unsigned)nb_slices * 8 > buf_size || slices_info_offset + nb_slices * 8 > buf_size) {
            return AVERROR_INVALIDDATA;
        }

    } else {
        nb_slices = 1;
        slice_height = height;
    }