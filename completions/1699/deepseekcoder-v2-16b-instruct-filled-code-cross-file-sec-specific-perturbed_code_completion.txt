// Validate that the number of primitive matrices does not exceed the allowed maximum.
    if (s->num_primitive_matrices > s->max_allowed_primitive_matrices) {
        av_log(m->avctx, AV_LOG_ERROR,
                "Number of primitive matrices exceeds the allowed maximum.\n");
        return AVERROR_INVALIDDATA;
    }