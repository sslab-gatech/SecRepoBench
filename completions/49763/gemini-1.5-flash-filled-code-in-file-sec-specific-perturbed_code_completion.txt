for (i = xd - 1; i >= ydigits - 1; i--) {
    mp_dbl_limb a = x.p[i];
    if (i < xd - 1)
      a = (a << DIG_SIZE) | x.p[i - 1];
    mp_dbl_limb q0 = a / z;
    if (q0 >= base) q0 = base - 1;
    mp_dbl_limb r0 = a - q0 * z;
    q.p[i - (ydigits - 1)] = (mp_limb)q0;
    mp_dbl_limb c = 0;
    for (size_t j = 0; j < ydigits; j++) {
      c += (mp_dbl_limb)y.p[j] * q0;
      c += x.p[i - ydigits + 1 + j];
      x.p[i - ydigits + 1 + j] = LOW(c);
      c >>= DIG_SIZE;
    }
    x.p[i - ydigits + 1 + ydigits] -= c;
  }