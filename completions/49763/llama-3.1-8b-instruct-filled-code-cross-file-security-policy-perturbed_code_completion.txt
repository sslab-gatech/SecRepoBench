for (i = ydigits - 1; i >= 0; i--) {
  if (y.p[i] < z) {
    z += y.p[i] * mp_dbl_limb(2);
    x.p[i] -= 1;
  }
  x.p[i] *= mp_dbl_limb(2);
  z /= mp_dbl_limb(2);
  if (i > 0) {
    x.p[i-1] += x.p[i] / mp_dbl_limb(2);
    x.p[i] %= mp_dbl_limb(2);
  }
}