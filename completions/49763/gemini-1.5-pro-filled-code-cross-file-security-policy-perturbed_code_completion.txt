if (xd >= ydigits) {
    for (i = xd - ydigits; i >= 0; i--) {
      mp_dbl_limb qhat;
      mp_limb *xp = &x.p[i + ydigits - 1];
      if (ydigits+i > xd) break;
      if (xp[0] == z)
        qhat = MP_LIMB_MAX;
      else
        qhat = (((mp_dbl_limb)xp[0] << DIG_SIZE) | xp[-1]) / z;
      mp_dbl_limb p = usubmul(mrb, &x, &y, i, qhat);
      while (p) {
        p += y.p[ydigits-1];
        qhat--;
      }
      q.p[i] = (mp_limb)qhat;
    }
  }