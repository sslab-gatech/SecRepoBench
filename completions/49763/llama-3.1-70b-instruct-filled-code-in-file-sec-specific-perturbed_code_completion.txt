for (i=0; i < x->sz; i++) {
  mp_limb q = (mp_limb)(a / y->p[ydigits-1]);
  a -= q * y->p[ydigits-1];
  for (j=0; j < ydigits; j++) {
    mp_limb b = y->p[j];
    mp_dbl_limb c = (mp_dbl_limb)q * b + (mp_dbl_limb)x->p[i+j];
    x->p[i+j] = LOW(c);
    a += HIGH(c);
  }
  if (a!= 0) {
    x->p[i+ydigits] = (mp_limb)a;
    a = 0;
  }
}