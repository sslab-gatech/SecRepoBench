for (i = xd - 1; i-- > ydigits - 1;) {
    mp_dbl_limb xi = x.p[i + ydigits - 1];
    mp_dbl_limb qi = xi / z;
    q.p[i] = qi;
    mp_dbl_limb ri = xi % z;
    size_t j;
    for (j = 0; j < ydigits; j++) {
      x.p[i + j] -= qi * y.p[j];
    }
    x.p[i + ydigits - 1] += ri;
    while (x.p[i + ydigits - 1] < ri) {
      x.p[i + ydigits - 1] += z;
      q.p[i]--;
    }
  }