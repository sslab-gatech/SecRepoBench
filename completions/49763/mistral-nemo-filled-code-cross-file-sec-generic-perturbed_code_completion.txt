mpz_t t;
  mpz_init(mrb, &t);
  mpz_div_2exp(mrb, &t, &y, ns);
  mpz_tdiv_q(mrb, &q, &x, &t);
  mpz_mul(mrb, &t, &q, &y);
  mpz_sub(mrb, &x, &x, &t);
  mpz_tdiv_qr(mrb, qq, rr, &x, &y);
  mpz_clear(mrb, &t);