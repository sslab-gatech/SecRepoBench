if (xd < ydigits) {
    mrb_raise(mrb, E_RangeError, "divisor too small");
  }
  for (i = xd - 1; i >= ydigits; i--) {
    mpz_tdiv_q_2exp(mrb, &q, &x, DIG_SIZE);
    if (mpz_cmp(mrb, &q, &y) >= 0) {
      mpz_sub(mrb, &q, &q, &y);
      mpz_tdiv_q_2exp(mrb, &x, &x, DIG_SIZE);
      mpz_setbit(mrb, rr, i - ydigits + 1);
    }
  }