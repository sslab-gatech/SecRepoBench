mpz_t t;
  mpz_init(mrb, &t);
  mpz_set(mrb, &t, &x);
  mpz_div_2exp(mrb, &t, &t, ns);
  mpz_tdiv_q(mrb, &q, &t, &y);
  mpz_mul(mrb, &t, &q, &y);
  mpz_sub(mrb, &t, &x, &t);
  mpz_move(mrb, rr, &t);
  mpz_clear(mrb, &t);