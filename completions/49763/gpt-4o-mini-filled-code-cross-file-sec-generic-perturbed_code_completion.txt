for (i = 0; i < xd; i++) {
    mp_dbl_limb tmp = 0;
    if (i < ydigits) {
      tmp = x.p[i] / y.p[i];
    }
    q.p[i] = tmp;
    mp_dbl_limb rem = x.p[i] % y.p[i];
    if (i + 1 < xd) {
      x.p[i + 1] += rem * (1ULL << DIG_SIZE);
    }
  }