for (i = xd - 1; i-- > 0;) {
    mp_dbl_limb xi = x.p[i+1];
    mp_dbl_limb qi = (xi / z);
    q.p[i] = qi;
    mp_dbl_limb ri = xi % z;
    mp_dbl_limb yi = (i > ydigits - 1) ? 0 : y.p[i];
    mp_dbl_limb diff = (ri * z) + yi - (qi * z);
    if (diff > z) {
      qi--;
      q.p[i] = qi;
      diff += z;
    }
    x.p[i+1] = diff;
  }
  x.p[0] = x.p[1];