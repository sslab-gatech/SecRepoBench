mp_dbl_limb z = y.p[ydigits-1];
mp_dbl_limb d = x.p[xd-1];
while (xd > 0) {
  mp_dbl_limb q = d / z;
  if (q > DIG_MASK) q = DIG_MASK;
  mp_dbl_limb r = d - q * z;
  for (size_t j=0; j<ydigits; j++) {
    mp_dbl_limb p = q * y.p[j];
    mp_dbl_limb c = x.p[j+xd-ydigits] - (p & DIG_MASK);
    x.p[j+xd-ydigits] = LOW(c);
    c = (p >> DIG_SIZE) + (c >> DIG_SIZE);
    for (size_t k=j+1; k<xd-ydigits+j+1; k++) {
      c += (mp_dbl_limb)x.p[k];
      x.p[k] = LOW(c);
      c >>= DIG_SIZE;
    }
    x.p[xd-ydigits+j+1] = (mp_limb)c;
  }
  q = LOW(q);
  q.sn = x.sn * y.sn;
  q.p[0] = q;
  xd--;
  d = r;
}