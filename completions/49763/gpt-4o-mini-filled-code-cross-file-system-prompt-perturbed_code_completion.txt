mpz_div_2exp(mrb, &q, &x, ns * DIG_SIZE);
  for (i = 0; i < xd; i++) {
    mp_dbl_limb tmp = x.p[i] / z;
    q.p[i] = tmp;
    x.p[i] -= tmp * z;
  }
  if (x.sz > 0 && uzero(&x)) {
    x.sz--;
  }