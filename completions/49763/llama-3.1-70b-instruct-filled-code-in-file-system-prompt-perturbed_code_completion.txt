for (size_t i=ydigits-1; i>=0; i--) {
  mp_dbl_limb q = 0;
  mp_dbl_limb_signed r = 0;
  mp_limb *xd = x.p + x.sz - 1;
  mp_limb *yd = y.p + i;
  mp_limb *qd = q.p + i;
  mp_limb yd0 = *yd;
  mp_limb yd1 = (i > 0)? yd[-1] : 0;
  mp_limb yd2 = (i > 1)? yd[-2] : 0;
  mp_limb yd3 = (i > 2)? yd[-3] : 0;
  mp_limb yd4 = (i > 3)? yd[-4] : 0;
  mp_limb yd5 = (i > 4)? yd[-5] : 0;
  mp_limb yd6 = (i > 5)? yd[-6] : 0;
  mp_limb yd7 = (i > 6)? yd[-7] : 0;
  mp_limb yd8 = (i > 7)? yd[-8] : 0;
  mp_limb yd9 = (i > 8)? yd[-9] : 0;
  mp_limb yd10 = (i > 9)? yd[-10] : 0;
  mp_limb yd11 = (i > 10)? yd[-11] : 0;
  mp_limb yd12 = (i > 11)? yd[-12] : 0;
  mp_limb yd13 = (i > 12)? yd[-13] : 0;
  mp_limb yd14 = (i > 13)? yd[-14] : 0;
  mp_limb yd15 = (i > 14)? yd[-15] : 0;
  mp_limb yd16 = (i > 15)? yd[-16] : 0;
  mp_limb yd17 = (i > 16)? yd[-17] : 0;
  mp_limb yd18 = (i > 17)? yd[-18] : 0;
  mp_limb yd19 = (i > 18)? yd[-19] : 0;
  mp_limb yd20 = (i > 19)? yd[-20] : 0;
  mp_limb yd21 = (i > 20)? yd[-21] : 0;
  mp_limb yd22 = (i > 21)? yd[-22] : 0;
  mp_limb yd23 = (i > 22)? yd[-23] : 0;
  mp_limb yd24 = (i > 23)? yd[-24] : 0;
  mp_limb yd25 = (i > 24)? yd[-25] : 0;
  mp_limb yd26 = (i > 25)? yd[-26] : 0;
  mp_limb yd27 = (i > 26)? yd[-27] : 0;
  mp_limb yd28 = (i > 27)? yd[-28] : 0;
  mp_limb yd29 = (i > 28)? yd[-29] : 0;
  mp_limb yd30 = (i > 29)? yd[-30] : 0;
  mp_limb yd31 = (i > 30)? yd[-31] : 0;
  mp_limb yd32 = (i > 31)? yd[-32] : 0;
  mp_limb yd33 = (i > 32)? yd[-33] : 0;
  mp_limb yd34 = (i > 33)? yd[-34] : 0;
  mp_limb yd35 = (i > 34)? yd[-35] : 0;
  mp_limb yd36 = (i > 35)? yd[-36] : 0;
  mp_limb yd37 = (i > 36)? yd[-37] : 0;
  mp_limb yd38 = (i > 37)? yd[-38] : 0;
  mp_limb yd39 = (i > 38)? yd[-39] : 0;
  mp_limb yd40 = (i > 39)? yd[-40] : 0;
  mp_limb yd41 = (i > 40)? yd[-41] : 0;
  mp_limb yd42 = (i > 41)? yd[-42] : 0;
  mp_limb yd43 = (i > 42)? yd[-43] : 0;
  mp_limb yd44 = (i > 43)? yd[-44] : 0;
  mp_limb yd45 = (i > 44)? yd[-45] : 0;
  mp_limb yd46 = (i > 45)? yd[-46] : 0;
  mp_limb yd47 = (i > 46)? yd[-47] : 0;
  mp_limb yd48 = (i > 47)? yd[-48] : 0;
  mp_limb yd49 = (i > 48)? yd[-49] : 0;
  mp_limb yd50 = (i > 49)? yd[-50] : 0;
  mp_limb yd51 = (i > 50)? yd[-51] : 0;
  mp_limb yd52 = (i > 51)? yd[-52] : 0;
  mp_limb yd53 = (i > 52)? yd[-53] : 0;
  mp_limb yd54 = (i > 53)? yd[-54] : 0;
  mp_limb yd55 = (i > 54)? yd[-55] : 0;
  mp_limb yd56 = (i > 55)? yd[-56] : 0;
  mp_limb yd57 = (i > 56)? yd[-57] : 0;
  mp_limb yd58 = (i > 57)? yd[-58] : 0;
  mp_limb yd59 = (i > 58)? yd[-59] : 0;
  mp_limb yd60 = (i > 59)? yd[-60] : 0;
  mp_limb yd61 = (i > 60)? yd[-61] : 0;
  mp_limb yd62 = (i > 61)? yd[-62] : 0;
  mp_limb yd63 = (i > 62)? yd[-63] : 0;
  mp_limb yd64 = (i > 63)? yd[-64] : 0;
  mp_limb yd65 = (i > 64)? yd[-65] : 0;
  mp_limb yd66 = (i > 65)? yd[-66] : 0;
  mp_limb yd67 = (i > 66)? yd[-67] : 0;
  mp_limb yd68 = (i > 67)? yd[-68] : 0;
  mp_limb yd69 = (i > 68)? yd[-69] : 0;
  mp_limb yd70 = (i > 69)? yd[-70] : 0;
  mp_limb yd71 = (i > 70)? yd[-71] : 0;
  mp_limb yd72 = (i > 71)? yd[-72] : 0;
  mp_limb yd73 = (i > 72)? yd[-73] : 0;
  mp_limb yd74 = (i > 73)? yd[-74] : 0;
  mp_limb yd75 = (i > 74)? yd[-75] : 0;
  mp_limb yd76 = (i > 75)? yd[-76] : 0;
  mp_limb yd77 = (i > 76)? yd[-77] : 0;
  mp_limb yd78 = (i > 77)? yd[-78] : 0;
  mp_limb yd79 = (i > 78)? yd[-79] : 0;
  mp_limb yd80 = (i > 79)? yd[-80] : 0;
  mp_limb yd81 = (i > 80)? yd[-81] : 0;
  mp_limb yd82 = (i > 81)? yd[-82] : 0;
  mp_limb yd83 = (i > 82)? yd[-83] : 0;
  mp_limb yd84 = (i > 83)? yd[-84] : 0;
  mp_limb yd85 = (i > 84)? yd[-85] : 0;
  mp_limb yd86 = (i > 85)? yd[-86] : 0;
  mp_limb yd87 = (i > 86)? yd[-87] : 0;
  mp_limb yd88 = (i > 87)? yd[-88] : 0;
  mp_limb yd89 = (i > 88)? yd[-89] : 0;
  mp_limb yd90 = (i > 89)? yd[-90] : 0;
  mp_limb yd91 = (i > 90)? yd[-91] : 0;
  mp_limb yd92 = (i > 91)? yd[-92] : 0;
  mp_limb yd93 = (i > 92)? yd[-93] : 0;
  mp_limb yd94 = (i > 93)? yd[-94] : 0;
  mp_limb yd95 = (i > 94)? yd[-95] : 0;
  mp_limb yd96 = (i > 95)? yd[-96] : 0;
  mp_limb yd97 = (i > 96)? yd[-97] : 0;
  mp_limb yd98 = (i > 97)? yd[-98] : 0;
  mp_limb yd99 = (i > 98)? yd[-99] : 0;
  mp_limb yd100 = (i > 99)? yd[-100] : 0;
  mp_limb yd101 = (i > 100)? yd[-101] : 0;
  mp_limb yd102 = (i > 101)? yd[-102] : 0;
  mp_limb yd103 = (i > 102)? yd[-103] : 0;
  mp_limb yd104 = (i > 103)? yd[-104] : 0;
  mp_limb yd105 = (i > 104)? yd[-105] : 0;
  mp_limb yd106 = (i > 105)? yd[-106] : 0;
  mp_limb yd107 = (i > 106)? yd[-107] : 0;
  mp_limb yd108 = (i > 107)? yd[-108] : 0;
  mp_limb yd109 = (i > 108)? yd[-109] : 0;
  mp_limb yd110 = (i > 109)? yd[-110] : 0;
  mp_limb yd111 = (i > 110)? yd[-111] : 0;
  mp_limb yd112 = (i > 111)? yd[-112] : 0;
  mp_limb yd113 = (i > 112)? yd[-113] : 0;
  mp_limb yd114 = (i > 113)? yd[-114] : 0;
  mp_limb yd115 = (i > 114)? yd[-115] : 0;
  mp_limb yd116 = (i > 115)? yd[-116] : 0;
  mp_limb yd117 = (i > 116)? yd[-117] : 0;
  mp_limb yd118 = (i > 117)? yd[-118] : 0;
  mp_limb yd119 = (i > 118)? yd[-119] : 0;
  mp_limb yd120 = (i > 119)? yd[-120] : 0;
  mp_limb yd121 = (i > 120)? yd[-121] : 0;
  mp_limb yd122 = (i > 121)? yd[-122] : 0;
  mp_limb yd123 = (i > 122)? yd[-123] : 0;
  mp_limb yd124 = (i > 123)? yd[-124] : 0;
  m