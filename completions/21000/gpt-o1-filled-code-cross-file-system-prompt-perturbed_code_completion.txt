{
  u_int8_t offset = (flow_packet->payload[0] == 0x1) ? 8 : 4;
  u_int16_t msg_len = ntohs(*(u_int16_t *)&flow_packet->payload[2]);

  if((msg_len + offset) == flow_packet->payload_packet_len) {
    goto capwap_found;
  }
}