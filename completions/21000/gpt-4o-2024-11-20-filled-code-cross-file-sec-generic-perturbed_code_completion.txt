{
  u_int16_t msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[2]);
  u_int16_t additional_len = (flow_packet->payload[0] == 0x0) ? 8 : 16;
  u_int16_t total_len = msg_len + additional_len;

  if(total_len == flow_packet->payload_packet_len) {
    goto capwap_found;
  }
}