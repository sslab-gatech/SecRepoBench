{
  if(flow_packet->payload_packet_len < 4)
    goto ndpi_exclude;
    
  u_int16_t length_field = ntohs(*(u_int16_t *)&flow_packet->payload[2]);
  u_int16_t total_length;
  
  if(flow_packet->payload[0] == 0x0)
    total_length = length_field + 4;
  else
    total_length = length_field + 8;

  if(total_length == flow_packet->payload_packet_len)
    goto capwap_found;
}
ndpi_exclude: