if(((sport == NDPI_CAPWAP_CONTROL_PORT) || (dport == NDPI_CAPWAP_CONTROL_PORT))
   && ((flow_packet->payload[0] == 0x0) || (flow_packet->payload[0] == 0x1))
   ) 
   {
     u_int16_t msg_len = 0;
     if(flow_packet->payload[0] == 0x0) {
       msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[2]);
     } else if(flow_packet->payload[0] == 0x1) {
       msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[3]);
     }
     if((flow_packet->payload_packet_len >= (msg_len + 15)) && (flow_packet->payload[8] == 6 /* Mac len */))
       goto capwap_found;
   }