{
  u_int16_t msg_len;

  /*
    For CAPWAP control, the length can be read starting at payload[2].
    We then add 4 bytes (for the header) and compare with the total payload size.
    Adjust offsets/lengths if needed for different control message formats.
  */
  msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[2]);

  /* If the calculated total matches the actual payload length, mark CAPWAP */
  if((msg_len + 4) == flow_packet->payload_packet_len) {
    goto capwap_found;
  }
}