u_int16_t calculated_len = 0;
  u_int8_t first_byte = flow_packet->payload[0];

  if (first_byte == 0x0) {
    calculated_len = ntohs(*(u_int16_t*)&flow_packet->payload[2]);
  } else if (first_byte == 0x1) {
    calculated_len = ntohs(*(u_int16_t*)&flow_packet->payload[4]);
  }

  if (calculated_len == flow_packet->payload_packet_len) {
    goto capwap_found;
  }