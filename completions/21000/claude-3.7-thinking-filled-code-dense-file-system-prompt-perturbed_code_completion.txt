{
  if(flow_packet->payload_packet_len >= 10) {
    if(flow_packet->payload[0] == 0x0) {
      u_int16_t msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[8]);
      if((msg_len + 10) == flow_packet->payload_packet_len)
        goto capwap_found;
    } else { // payload[0] == 0x1
      if(flow_packet->payload_packet_len >= 12) {
        u_int16_t msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[10]);
        if((msg_len + 12) == flow_packet->payload_packet_len)
          goto capwap_found;
      }
    }
  }
}