{
  u_int16_t msg_len_offset = (flow_packet->payload[0] == 0x0) ? 12 : 14;
  u_int16_t additional_len = (flow_packet->payload[0] == 0x0) ? 0 : 2;
  u_int16_t msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[msg_len_offset]);

  if((msg_len + additional_len) == flow_packet->payload_packet_len)
    goto capwap_found;
}