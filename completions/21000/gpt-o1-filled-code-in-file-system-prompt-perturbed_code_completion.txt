{
  u_int16_t msg_len;

  /* Version 0x0 or 0x1 */
  if (flow_packet->payload[0] == 0x0) {
    /* For version 0, read length from offset 4 */
    msg_len = ntohs(*(u_int16_t *)&flow_packet->payload[4]);
    if ((msg_len + 8) == flow_packet->payload_packet_len)
      goto capwap_found;
  } else {
    /* For version 1, similarly read length from offset 4 */
    msg_len = ntohs(*(u_int16_t *)&flow_packet->payload[4]);
    if ((msg_len + 8) == flow_packet->payload_packet_len)
      goto capwap_found;
  }
}