{
      u_int16_t msg_len;
      u_int16_t offset = 0;

      if(flow_packet->payload[0] == 0x0) {
          offset = 8;
      } else if(flow_packet->payload[0] == 0x1) {
          offset = 12;
      }
      msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[offset-4]);

      if((msg_len + offset) == flow_packet->payload_packet_len)
          goto capwap_found;
  }