u_int16_t msg_len;
    if (flow_packet->payload[0] == 0x0) {
        msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[2]);
        if (msg_len + 16 == flow_packet->payload_packet_len)
            goto capwap_found;
    } else {
        msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[4]);
        if (msg_len + 20 == flow_packet->payload_packet_len)
            goto capwap_found;
    }