u_int16_t msg_len_offset = (flow_packet->payload[0] == 0x0) ? 14 : 15;
u_int16_t additional_length = (flow_packet->payload[0] == 0x0) ? 8 : 12;
u_int16_t total_len = ntohs(*(u_int16_t*)&flow_packet->payload[msg_len_offset]) + additional_length;

if(total_len == flow_packet->payload_packet_len)
  goto capwap_found;