{
  if(flow_packet->payload_packet_len >= 16) {
    u_int16_t msg_len;
    
    if(flow_packet->payload[0] == 0x0) {
      /* For CAPWAP Control Header */
      msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[2]);
      
      if(msg_len == flow_packet->payload_packet_len)
        goto capwap_found;
    } else { /* flow_packet->payload[0] == 0x1 */
      /* For CAPWAP Data Header in control port */
      msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[13]);
      
      if((msg_len + 15) == flow_packet->payload_packet_len)
        goto capwap_found;
    }
  }
}