u_int16_t msg_len = 0;
  u_int16_t total_len = 0;

  if (flow_packet->payload[0] == 0x0) {
    msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[2]);
    total_len = msg_len + 14;
  } else if (flow_packet->payload[0] == 0x1) {
    msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[4]);
    total_len = msg_len + 16;
  }

  if (total_len == flow_packet->payload_packet_len) {
    goto capwap_found;
  }