{
      u_int16_t msg_len;

      if (flow_packet->payload[0] == 0x0) {
        msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[2]);
        if ((msg_len + 4) == flow_packet->payload_packet_len)
          goto capwap_found;
      } else if (flow_packet->payload[0] == 0x1) {
        msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[10]);
        if ((msg_len + 12) == flow_packet->payload_packet_len)
          goto capwap_found;
      }
    }