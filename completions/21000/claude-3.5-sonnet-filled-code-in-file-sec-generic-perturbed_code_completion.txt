{
    u_int16_t msg_len;
    u_int16_t total_len;
    
    if (flow_packet->payload[0] == 0x0) {
        msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[2]);
        total_len = msg_len + 12;
    } else {
        msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[6]);
        total_len = msg_len + 16;
    }
    
    if (total_len == flow_packet->payload_packet_len) {
        goto capwap_found;
    }
}