{
    u_int16_t msg_len = (flow_packet->payload[0] == 0x0) ? 
        ntohs(*(u_int16_t*)&flow_packet->payload[2]) + 4 : 
        ntohs(*(u_int16_t*)&flow_packet->payload[2]) + 6;
    
    if(msg_len == flow_packet->payload_packet_len)
        goto capwap_found;
}