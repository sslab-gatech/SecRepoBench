{
  u_int16_t msg_len;
  u_int16_t length_field;
  if(flow_packet->payload_packet_len < 4) {
    NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
    return;
  }
  memcpy(&length_field, &flow_packet->payload[2], sizeof(length_field));
  msg_len = ntohs(length_field);
  if(flow_packet->payload[0] == 0x0)
    msg_len += 8;
  else
    msg_len += 12;
  if(msg_len == flow_packet->payload_packet_len)
    goto capwap_found;
}