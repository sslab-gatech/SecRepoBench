if(
   (((sport == NDPI_CAPWAP_CONTROL_PORT) || (dport == NDPI_CAPWAP_CONTROL_PORT))
   && ((flow_packet->payload[0] == 0x0) || (flow_packet->payload[0] == 0x1)))
   {
   u_int16_t msg_len = 0;
   if(flow_packet->payload[0] == 0x0)
     msg_len = flow_packet->payload[12] + 13;
   else
     msg_len = flow_packet->payload[11] + 12;

   if(msg_len == flow_packet->payload_packet_len)
     goto capwap_found;
}