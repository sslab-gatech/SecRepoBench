if(((sport == NDPI_CAPWAP_CONTROL_PORT) || (dport == NDPI_CAPWAP_CONTROL_PORT))
   && ((flow_packet->payload[0] == 0x0) || (flow_packet->payload[0] == 0x1))
   ) 
   {
     u_int8_t offset = (flow_packet->payload[0] == 0x0)? 1 : 2;
     u_int16_t msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[offset]);
     if((flow_packet->payload_packet_len >= (offset + 2 + msg_len)) 
        && (flow_packet->payload_packet_len == (offset + 2 + msg_len)))
       goto capwap_found;
   }