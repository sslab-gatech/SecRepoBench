{
  u_int16_t msg_len_offset = (flow_packet->payload[0] == 0x0) ? 12 : 13;
  u_int16_t msg_len = 0;

  if (flow_packet->payload_packet_len >= (msg_len_offset + sizeof(u_int16_t))) {
    msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[msg_len_offset]);
    
    if ((msg_len + msg_len_offset) == flow_packet->payload_packet_len)
      goto capwap_found;
  }
}