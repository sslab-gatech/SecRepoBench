{
  u_int16_t offset = (flow_packet->payload[0] == 0x0) ? 4 : 6;
  if(flow_packet->payload_packet_len >= (offset + 2)) {
    u_int16_t msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[offset]);
    u_int16_t total_len = msg_len + offset + 2;

    if(total_len == flow_packet->payload_packet_len) {
      goto capwap_found;
    }
  }
}