{
    u_int16_t msg_len;
    u_int16_t offset = (flow_packet->payload[0] == 0x0) ? 2 : 3;
    u_int16_t add_len = (flow_packet->payload[0] == 0x0) ? 0 : 1;
    
    msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[offset]) + add_len;
    
    if (msg_len == flow_packet->payload_packet_len)
        goto capwap_found;
}