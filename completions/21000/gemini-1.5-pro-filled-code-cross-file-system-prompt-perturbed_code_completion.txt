{
      u_int16_t msg_len = 0;

      if(flow_packet->payload[0] == 0x0)
	msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[2]);
      else if(flow_packet->payload[0] == 0x1)
	msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[10]) + 8 /* additional header length */;

      if((msg_len + 8 /* CAPWAP Header Length */) == flow_packet->payload_packet_len)
	goto capwap_found;
    }