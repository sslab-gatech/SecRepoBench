{
    if (flow_packet->payload_packet_len >= 16) {
        u_int16_t msg_len, offset, additional_len;
        
        // Set the offset and additional length based on the message type
        if (flow_packet->payload[0] == 0x0) {
            offset = 2;
            additional_len = 8;
        } else { // flow_packet->payload[0] == 0x1
            offset = 2;
            additional_len = 8;
        }
        
        msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[offset]);
        if ((msg_len + additional_len) == flow_packet->payload_packet_len) {
            goto capwap_found;
        }
    }
}