{
  if(flow_packet->payload[0] == 0x0) {
    // For type 0, need at least 4 bytes to read message length
    if(flow_packet->payload_packet_len >= 4) {
      u_int16_t msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[2]);
      if((msg_len + 12) == flow_packet->payload_packet_len)
        goto capwap_found;
    }
  } else { // flow_packet->payload[0] == 0x1
    // For type 1, need at least 8 bytes to read message length
    if(flow_packet->payload_packet_len >= 8) {
      u_int16_t msg_len = ntohs(*(u_int16_t*)&flow_packet->payload[6]);
      if((msg_len + 16) == flow_packet->payload_packet_len)
        goto capwap_found;
    }
  }
}