{
  u_int16_t msg_len;
  if(flow_packet->payload[0] == 0x0) {
    /* For type 0, the 16‐bit message length is at offset 2.
       The full message size is the header (8 bytes) plus the message length. */
    msg_len = ntohs(*(u_int16_t *)&flow_packet->payload[2]);
    if((msg_len + 8) == flow_packet->payload_packet_len)
      goto capwap_found;
  }
  else if(flow_packet->payload[0] == 0x1) {
    /* For type 1, the 16‐bit message length is at offset 3.
       The full message size is the header (9 bytes) plus the message length. */
    msg_len = ntohs(*(u_int16_t *)&flow_packet->payload[3]);
    if((msg_len + 9) == flow_packet->payload_packet_len)
      goto capwap_found;
  }
}