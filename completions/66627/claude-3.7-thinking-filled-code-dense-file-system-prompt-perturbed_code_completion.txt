herr_t herr;
int err = MATIO_E_NO_ERROR;

/* Open the attribute named "MATLAB_fields" */
attr_id = H5Aopen_by_name(dset_id, ".", "MATLAB_fields", H5P_DEFAULT, H5P_DEFAULT);
if (attr_id < 0) {
    return MATIO_E_FAIL_TO_IDENTIFY;
}

/* Get the dataspace of the attribute */
dspace_id = H5Aget_space(attr_id);
if (dspace_id < 0) {
    H5Aclose(attr_id);
    return MATIO_E_FAIL_TO_IDENTIFY;
}

/* Get number of fields which is the dimension of the dataspace */
herr = H5Sget_simple_extent_dims(dspace_id, nfields, NULL);
if (herr < 0) {
    H5Sclose(dspace_id);
    H5Aclose(attr_id);
    return MATIO_E_FAIL_TO_IDENTIFY;
}