#ifdef LARGE_POS
        cp += safe_ltf8_get((char *)cp, (char *)cp_end, &slice_header->ref_seq_id);
        if (slice_header->ref_seq_id < -1 || slice_header->ref_seq_id >= INT32_MAX) {
            hts_log_error("Invalid ref_seq_id: %" PRId64, slice_header->ref_seq_id);
            free(slice_header);
            return NULL;
        }

        cp += safe_ltf8_get((char *)cp, (char *)cp_end, &slice_header->ref_seq_start);
        if (slice_header->ref_seq_start < 0 || slice_header->ref_seq_start >= INT64_MAX) {
            hts_log_error("Invalid ref_seq_start: %" PRId64, slice_header->ref_seq_start);
            free(slice_header);
            return NULL;
        }


        cp += safe_ltf8_get((char *)cp, (char *)cp_end, &slice_header->ref_seq_span);
        if (slice_header->ref_seq_span < 0 || slice_header->ref_seq_span >= INT64_MAX) {
            hts_log_error("Invalid ref_seq_span: %" PRId64, slice_header->ref_seq_span);
            free(slice_header);
            return NULL;
        }

#else
        cp += safe_itf8_get((char *)cp, (char *)cp_end, &slice_header->ref_seq_id);
        if (slice_header->ref_seq_id < -1 || slice_header->ref_seq_id >= INT32_MAX) {
            hts_log_error("Invalid ref_seq_id: %d", slice_header->ref_seq_id);
            free(slice_header);
            return NULL;
        }

        cp += safe_itf8_get((char *)cp, (char *)cp_end, &slice_header->ref_seq_start);
        if (slice_header->ref_seq_start < 0 || slice_header->ref_seq_start >= INT32_MAX) {
            hts_log_error("Invalid ref_seq_start: %d", slice_header->ref_seq_start);
            free(slice_header);
            return NULL;
        }

        cp += safe_itf8_get((char *)cp, (char *)cp_end, &slice_header->ref_seq_span);
        if (slice_header->ref_seq_span < 0 || slice_header->ref_seq_span >= INT32_MAX) {
            hts_log_error("Invalid ref_seq_span: %d", slice_header->ref_seq_span);
            free(slice_header);
            return NULL;
        }
#endif