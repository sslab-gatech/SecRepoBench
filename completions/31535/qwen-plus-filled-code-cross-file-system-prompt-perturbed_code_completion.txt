int64_t offsets_start = off_pos - BLOSC_EXTENDED_HEADER_LENGTH;
if (offsets_start < 0 || header_len + cbytes + BLOSC_EXTENDED_HEADER_LENGTH > frame->len) {
  BLOSC_TRACE_ERROR("Offset position and header length are out of valid boundaries.");
  return NULL;
}

if (compressed_chunk_size != NULL) {
  int32_t coffsets_cbytes;
  uint8_t* coffsets = get_coffsets(frame, header_len, cbytes, &coffsets_cbytes);
  if (coffsets == NULL) {
    return NULL;
  }
  *compressed_chunk_size = coffsets_cbytes;
}

return (uint8_t*)frame->cframe + offsets_start;