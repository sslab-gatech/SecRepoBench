if (off_pos < header_len || off_pos > frame->len) {
        BLOSC_TRACE_ERROR("Computed offset position is out of bounds.");
        return NULL;
    }

    uint8_t* coffsets = malloc((size_t)coffsets_cbytes);
    if (coffsets == NULL) {
        BLOSC_TRACE_ERROR("Memory allocation for coffsets failed.");
        return NULL;
    }

    if (frame->sframe) {
        fp = sframe_open_index(frame->urlpath, "rb");
        fseek(fp, off_pos, SEEK_SET);
    } else {
        fp = fopen(frame->urlpath, "rb");
        fseek(fp, off_pos, SEEK_SET);
    }