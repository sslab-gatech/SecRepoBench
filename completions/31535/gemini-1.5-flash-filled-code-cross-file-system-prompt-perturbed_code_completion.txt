uint8_t *coffsets = malloc((size_t)off_pos);
    if (coffsets == NULL) {
      return NULL;
    }
    FILE *fp = NULL;
    if (frame->sframe) {
      fp = sframe_open_index(frame->urlpath, "rb");
      fseek(fp, header_len, SEEK_SET);
    } else {
      fp = fopen(frame->urlpath, "rb");
      fseek(fp, header_len, SEEK_SET);
    }
    size_t rbytes = fread(coffsets, 1, (size_t)off_pos, fp);
    fclose(fp);
    if (rbytes != (size_t)off_pos) {
      BLOSC_TRACE_ERROR("Cannot read the offsets out of the frame.");
      free(coffsets);
      return NULL;
    }
    frame->coffsets = coffsets;
    if (compressed_chunk_size != NULL) {
      *compressed_chunk_size = (int32_t)off_pos;
    }
    return coffsets;