// Ensure the offset position is within valid boundaries
    if (off_pos < 0 || off_pos > frame->len - BLOSC_EXTENDED_HEADER_LENGTH) {
      BLOSC_TRACE_ERROR("Offset position is out of bounds.");
      return NULL;
    }

    // Allocate memory for the offsets
    int32_t coffsets_cbytes = (int32_t)(frame->len - off_pos);
    uint8_t* coffsets = malloc((size_t)coffsets_cbytes);
    if (coffsets == NULL) {
      BLOSC_TRACE_ERROR("Memory allocation for offsets failed.");
      return NULL;
    }

    // Read the offsets from the frame
    FILE* fp = fopen(frame->urlpath, "rb");
    if (fp == NULL) {
      BLOSC_TRACE_ERROR("Cannot open the frame file.");
      free(coffsets);
      return NULL;
    }
    fseek(fp, off_pos, SEEK_SET);
    size_t rbytes = fread(coffsets, 1, (size_t)coffsets_cbytes, fp);
    fclose(fp);

    if (rbytes != (size_t)coffsets_cbytes) {
      BLOSC_TRACE_ERROR("Cannot read the offsets from the frame.");
      free(coffsets);
      return NULL;
    }

    // If requested, retrieve the compressed chunk size
    if (compressed_chunk_size != NULL) {
      int rc = blosc2_cbuffer_sizes(coffsets, NULL, &chunk_cbytes, NULL);
      if (rc < 0) {
        BLOSC_TRACE_ERROR("Error retrieving compressed chunk size.");
        free(coffsets);
        return NULL;
      }
      *compressed_chunk_size = (int32_t)chunk_cbytes;
    }

    return coffsets;