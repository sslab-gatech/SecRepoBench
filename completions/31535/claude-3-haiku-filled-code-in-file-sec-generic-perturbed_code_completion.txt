// <MASK>
// Check that there is enough room to read Blosc header
if (off_pos + BLOSC_MIN_HEADER_LENGTH > frame->len) {
    BLOSC_TRACE_ERROR("Cannot read the header for chunk in the frame.");
    return NULL;
}

// Calculate the start pointer for the offsets based on the current frame position
uint8_t* coffsets = frame->cframe + off_pos;

// If provided, retrieve the compressed chunk size
if (compressed_chunk_size != NULL) {
    int32_t chunk_cbytes;
    rc = blosc2_cbuffer_sizes(coffsets, NULL, &chunk_cbytes, NULL);
    if (rc < 0) {
        return NULL;
    }
    *compressed_chunk_size = chunk_cbytes;
}

return coffsets;