if (off_pos + BLOSC_MIN_HEADER_LENGTH > frame->len) {
  BLOSC_TRACE_ERROR("Cannot read the offsets chunk from memory (out of bounds).");
  return NULL;
}

int32_t coffsets_cbytes;
int rc = blosc2_cbuffer_sizes(frame->cframe + off_pos, NULL, &coffsets_cbytes, NULL);
if (rc < 0) {
  BLOSC_TRACE_ERROR("Cannot retrieve the cbytes for the offsets chunk in memory.");
  return NULL;
}

if (off_pos + coffsets_cbytes > frame->len) {
  BLOSC_TRACE_ERROR("Offsets chunk in memory would read beyond the frame boundary.");
  return NULL;
}

frame->coffsets = frame->cframe + off_pos;
if (compressed_chunk_size != NULL) {
  *compressed_chunk_size = coffsets_cbytes;
}

return frame->coffsets;