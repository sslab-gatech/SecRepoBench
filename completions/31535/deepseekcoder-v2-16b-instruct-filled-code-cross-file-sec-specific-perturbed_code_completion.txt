// Calculate the start pointer for the offsets based on the current frame position.
  uint8_t* framep = frame->cframe;
  if (frame->cframe == NULL) {
    framep = malloc((size_t)frame->len);
    if (framep == NULL) {
      BLOSC_TRACE_ERROR("Cannot allocate memory for the frame.");
      return NULL;
    }
    FILE* fp = fopen(frame->urlpath, "rb");
    if (fp == NULL) {
      BLOSC_TRACE_ERROR("Cannot open the frame file.");
      free(framep);
      return NULL;
    }
    size_t rbytes = fread(framep, 1, (size_t)frame->len, fp);
    fclose(fp);
    if (rbytes != (size_t)frame->len) {
      BLOSC_TRACE_ERROR("Cannot read the frame file.");
      free(framep);
      return NULL;
    }
  }

  uint8_t* coffsets_start = framep + header_len + cbytes;
  int64_t off_pos = (int64_t)(coffsets_start - framep);

  if (off_pos + header_len > frame->len) {
    BLOSC_TRACE_ERROR("Offset position exceeds frame length.");
    if (frame->cframe == NULL) {
      free(framep);
    }
    return NULL;
  }

  if (compressed_chunk_size != NULL) {
    *compressed_chunk_size = (int32_t)(off_pos - header_len);
  }

  if (frame->cframe == NULL) {
    free(framep);
  }
  return coffsets_start;