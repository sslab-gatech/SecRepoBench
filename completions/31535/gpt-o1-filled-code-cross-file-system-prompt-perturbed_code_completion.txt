if (off_pos < 0 || off_pos >= frame->len) {
      BLOSC_TRACE_ERROR("Cannot read the offsets out of the frame in memory.");
      return NULL;
    }

    /* Check there is enough room to read the Blosc offset chunk header */
    if (off_pos + BLOSC_EXTENDED_HEADER_LENGTH > frame->len) {
      BLOSC_TRACE_ERROR("Not enough space in frame buffer for Blosc offsets header.");
      return NULL;
    }

    uint8_t* coffsets = frame->cframe + off_pos;
    if (compressed_chunk_size != NULL) {
      rc = blosc2_cbuffer_sizes(coffsets, NULL, &chunk_cbytes, NULL);
      if (rc < 0) {
        BLOSC_TRACE_ERROR("Cannot retrieve cbuffer sizes for offsets chunk.");
        return NULL;
      }
      *compressed_chunk_size = chunk_cbytes;
    }

    frame->coffsets = coffsets;
    return coffsets;