if (off_pos + BLOSC_EXTENDED_HEADER_LENGTH > frame->len) {
      BLOSC_TRACE_ERROR("The frame is truncated.");
      return NULL;
    }
    if (compressed_chunk_size != NULL) {
      uint8_t header[BLOSC_EXTENDED_HEADER_LENGTH];
      memcpy(header, frame->cframe + off_pos, BLOSC_EXTENDED_HEADER_LENGTH);
      rc = blosc2_cbuffer_sizes(header, NULL, &chunk_cbytes, NULL);
      if (rc < 0) {
        return NULL;
      }
      *compressed_chunk_size = chunk_cbytes;
    }
    return frame->cframe + off_pos;