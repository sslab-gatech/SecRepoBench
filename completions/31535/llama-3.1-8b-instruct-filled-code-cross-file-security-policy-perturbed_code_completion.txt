if (frame->cframe!= NULL) {
  int64_t off_pos = header_len;
  if (cbytes < INT64_MAX - header_len) {
    off_pos += cbytes;
  }
  if (off_pos + BLOSC_EXTENDED_HEADER_LENGTH > frame->len) {
    BLOSC_TRACE_ERROR("Not enough space to read the Blosc header.");
    return NULL;
  }
  uint8_t* offsets = frame->cframe + off_pos;
  if (compressed_chunk_size!= NULL) {
    int32_t chunk_cbytes;
    int rc = blosc2_cbuffer_sizes(offsets, NULL, &chunk_cbytes, NULL);
    if (rc < 0) {
      return NULL;
    }
    *compressed_chunk_size = (int32_t)chunk_cbytes;
  }
  return offsets;
}