// Interpret the NetBIOS name from the packet payload and store it in the flow's host server name.
  // Determine the offset to start interpreting the name based on the payload's content.
  // Update the detected protocol for the flow based on the sub-protocol value.
  u_int8_t *payload = flow->packet.payload;
  u_int16_t payload_len = flow->packet.payload_packet_len;

  // Example: Assume NetBIOS name is at the beginning of the payload
  if (payload_len >= 2 && payload[0] == 0x00 && payload[1] == 0x00) {
    // NetBIOS name is at the beginning of the payload
    u_int8_t *name_start = payload;
    u_int16_t name_len = payload_len;

    // Store the NetBIOS name in the flow's host server name
    // Assuming flow->host_server_name is a char array large enough to hold the name
    memcpy(flow->host_server_name, name_start, name_len);
    flow->host_server_name_len = name_len;
  } else {
    // Handle error or unknown payload
    NDPI_LOG_WARN(detectionmodulestruct, "Invalid NetBIOS payload\n");
    return;
  }

  // Update the detected protocol for the flow based on the sub-protocol value
  switch (sub_protocol) {
    case 0x01: // Session Service
      ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, NDPI_PROTOCOL_NETBIOS_SSN);
      break;
    case 0x02: // Datagram Service
      ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, NDPI_PROTOCOL_NETBIOS_DGAM);
      break;
    case 0x03: // Reserved for future use
      ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, NDPI_PROTOCOL_NETBIOS_RES);
      break;
    case 0x04: // Reserved for future use
      ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, NDPI_PROTOCOL_NETBIOS_RES);
      break;
    case 0x05: // Reserved for future use
      ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, NDPI_PROTOCOL_NETBIOS_RES);
      break;
    case 0x06: // Reserved for future use
      ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, NDPI_PROTOCOL_NETBIOS_RES);
      break;
    case 0x07: // Reserved for future use
      ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, NDPI_PROTOCOL_NETBIOS_RES);
      break;
    case 0x08: // Reserved for future use
      ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, NDPI_PROTOCOL_NETBIOS_RES);
      break;
    case 0x09: // Reserved for future use
      ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, NDPI_PROTOCOL_NETBIOS_RES);
      break;
    case 0x0A: // Reserved for future use
      ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, NDPI_PROTOCOL_NETBIOS_RES);
      break;
    case 0x0B: // Reserved for future use
      ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, NDPI_PROTOCOL_NETBIOS_RES);
      break;
    case 0x0C: // Reserved for future use
      ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, NDPI_PROTOCOL_NETBIOS_RES);
      break;
    case 0x0D: // Reserved for future use
      ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, NDPI_PROTOCOL_NETBIOS_RES);
      break;
    case 0x0E: // Reserved for future use
      ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, NDPI_PROTOCOL_NETBIOS_RES);
      break;
    case 0x0F: // Reserved for future use
      ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, NDPI_PROTOCOL_NETBIOS_RES);
      break;
    default:
      NDPI_LOG_WARN(detectionmodulestruct, "Unknown NetBIOS sub-protocol: %u\n", sub_protocol);
      return;
  }
}