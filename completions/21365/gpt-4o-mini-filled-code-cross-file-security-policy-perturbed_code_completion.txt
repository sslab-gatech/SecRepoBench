struct ndpi_packet_struct *packet = &flow->packet;
  if (packet == NULL || packet->payload_packet_len == 0) {
    return;
  }

  // Assuming the offset for NetBIOS name starts at a specific position
  size_t offset = 0; // Set the appropriate offset based on your protocol
  size_t name_length = packet->payload_packet_len - offset;

  // Validate the offset and length before accessing the payload
  if (offset < packet->payload_packet_len) {
    // Copy the NetBIOS name from the payload to the flow's host server name
    strncpy(flow->host_server_name, (char *)&packet->payload[offset], name_length);
    flow->host_server_name[name_length] = '\0'; // Null-terminate the string
  }

  // Update the detected protocol for the flow
  ndpi_int_change_packet_protocol(detectionmodulestruct, flow, sub_protocol);