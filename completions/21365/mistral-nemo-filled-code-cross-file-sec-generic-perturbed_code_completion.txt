// Determine the offset to start interpreting the name based on the payload's content.
  u_int16_t offset = /* Determine the offset based on the payload's content */;

  // Interpret the NetBIOS name from the packet payload and store it in the flow's host server name.
  char *name = (char *)&packet->payload[offset];
  strncpy(flow->host_server_name, name, NDPI_MAX_HOST_NAME_LENGTH);

  // Update the detected protocol for the flow based on the sub-protocol value.
  ndpi_int_change_packet_protocol(detectionmodulestruct, flow, sub_protocol, NDPI_PROTOCOL_NETBIOS);