struct ndpi_packet_struct *packet = &flow->packet;
  if(packet == NULL || packet->payload_packet_len < 1) {
    return;
  }

  // Assuming the NetBIOS name starts at a specific offset in the payload
  u_int16_t name_offset = 0; // This should be set according to the NetBIOS protocol specifics
  u_int16_t name_length = 15; // NetBIOS names are typically 15 characters long

  if(packet->payload_packet_len < name_offset + name_length) {
    return; // Ensure we don't read beyond the payload
  }

  // Copy the NetBIOS name to the flow's host_server_name
  memcpy(flow->host_server_name, &packet->payload[name_offset], name_length);
  flow->host_server_name[name_length] = '\0'; // Null-terminate the string

  // Update the detected protocol for the flow
  ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, sub_protocol);