u_int16_t offset = 0;
  if (flow->packet.payload_packet_len > 2) {
    offset = flow->packet.payload[1] + (flow->packet.payload[2] << 8);
    if (offset >= flow->packet.payload_packet_len) {
      offset = 0;
    }
  }
  ndpi_int_copy_hostname(detectionmodulestruct, flow, (char *)&flow->packet.payload[offset], flow->packet.payload_packet_len - offset);
  ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, sub_protocol);