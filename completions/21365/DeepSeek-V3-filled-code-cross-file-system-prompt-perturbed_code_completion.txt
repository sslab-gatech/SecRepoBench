struct ndpi_packet_struct *packet = &flow->packet;
  u_int8_t *payload = packet->payload;
  u_int payload_len = packet->payload_packet_len;
  u_int offset = 0;

  if(payload_len > 0) {
    /* NetBIOS name is typically at offset 12 */
    if(payload_len > 12) {
      offset = 12;
      /* NetBIOS names are 16 bytes long */
      u_int name_len = (payload_len - offset) > 16 ? 16 : (payload_len - offset);
      if(name_len > 0) {
        ndpi_set_hostname(flow, (char*)&payload[offset], name_len);
      }
    }
  }

  ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, sub_protocol);