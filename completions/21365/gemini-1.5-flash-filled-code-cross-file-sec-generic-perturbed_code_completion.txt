u_int8_t *payload = (u_int8_t *)flow->packet.payload;
  size_t payload_len = flow->packet.payload_packet_len;
  size_t offset = 0;

  // Determine the offset based on the NetBIOS packet type.  This is a simplification and may need adjustment
  // based on the specific NetBIOS protocol implementation being used.  More robust handling would involve
  // parsing the NetBIOS header.
  if (payload_len > 0) {
    offset = 0; // Adjust this offset as needed based on NetBIOS packet structure.
  }

  if (offset < payload_len) {
    // Extract the NetBIOS name.  This is a simplification and assumes a simple name format.
    // More robust handling would involve parsing the NetBIOS name according to the specification.
    size_t name_len = strlen((char*)&payload[offset]);
    if (name_len > 0 && name_len <= NDPI_MAX_HOST_SERVER_NAME_LEN) {
      strncpy(flow->host_server_name, (char*)&payload[offset], name_len);
      flow->host_server_name[name_len] = '\0';
    }
  }

  // Update the detected protocol.
  ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, sub_protocol);