char name[256];
  int name_len;

  if (flow->payload_packet_len > 0) {
    // Determine the offset to start interpreting the name based on the payload's content.  This is highly protocol-specific and requires deep knowledge of NetBIOS.  A robust implementation would require a state machine or more sophisticated parsing.  This example makes a simplifying assumption.
    size_t offset = 0; // Replace with actual offset calculation based on NetBIOS packet structure.

    if (flow->payload_packet_len > offset + 1) {
      name_len = ndpi_netbios_name_interpret((char *)flow->payload + offset, flow->payload_packet_len - offset, name, sizeof(name));
      if (name_len > 0) {
        ndpi_set_hostname(detectionmodulestruct, flow, name);
      }
    }
  }

  // Update the detected protocol for the flow based on the sub-protocol value.
  if (sub_protocol != NDPI_PROTOCOL_UNKNOWN) {
    ndpi_set_detected_protocol(detectionmodulestruct, flow, sub_protocol);
  }