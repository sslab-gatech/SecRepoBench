// <MASK>
ndpi_int_netbios_add_connection(ndpi_struct, flow, sub_protocol) {
  // Interpret the NetBIOS name from the packet payload
  char *name = (char *)packet->payload + 12; // Assuming the name starts after the header
  int name_len = ndpi_netbios_name_interpret(name, packet->payload_packet_len - 12, flow->host_server_name, sizeof(flow->host_server_name));

  if (name_len > 0) {
    NDPI_LOG_INFO(ndpi_struct, "Found NetBIOS name: %s\n", flow->host_server_name);
  } else {
    NDPI_LOG_DBG(ndpi_struct, "Failed to interpret NetBIOS name\n");
    return;
  }

  // Update the detected protocol for the flow based on the sub-protocol value
  ndpi_set_detection_bitmask(ndpi_struct, flow, detection_bitmask, sub_protocol);
}
// </MASK>