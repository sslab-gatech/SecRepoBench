u_int8_t name_length = packet->payload[12];
  if (name_length > 0 && name_length <= 15) {
    char name[16]; // Buffer to hold the NetBIOS name
    memcpy(name, &packet->payload[13], name_length);
    name[name_length] = '\0'; // Null-terminate the string

    // Ensure the name is properly formatted and does not exceed the output buffer
    if (strlen(name) < out_len) {
      strncpy(flow->host_server_name, name, out_len);
      flow->host_server_name[out_len - 1] = '\0'; // Ensure null termination
    } else {
      NDPI_LOG_WARN(ndpi_struct, "NetBIOS name exceeds output buffer size\n");
    }
  } else {
    NDPI_LOG_WARN(ndpi_struct, "Invalid NetBIOS name length\n");
  }