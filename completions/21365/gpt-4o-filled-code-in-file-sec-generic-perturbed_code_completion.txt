// Interpret the NetBIOS name from the packet payload and store it in the flow's host server name.
  if (flow->packet.payload_packet_len > sizeof(struct netbios_header)) {
    char netbios_name[256]; // Buffer to store the interpreted NetBIOS name
    int name_offset = sizeof(struct netbios_header); // Offset to start interpreting the name
    int name_length = ndpi_netbios_name_interpret((char *)&flow->packet.payload[name_offset],
                                                  flow->packet.payload_packet_len - name_offset,
                                                  netbios_name, sizeof(netbios_name));
    if (name_length > 0) {
      // Store the interpreted name in the flow's host server name
      strncpy(flow->host_server_name, netbios_name, sizeof(flow->host_server_name) - 1);
      flow->host_server_name[sizeof(flow->host_server_name) - 1] = '\0'; // Ensure null-termination
    }
  }

  // Update the detected protocol for the flow based on the sub-protocol value.
  ndpi_set_detected_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, sub_protocol);