u_int8_t *payload = (u_int8_t *)flow->packet.payload;
  size_t payload_len = flow->packet.payload_packet_len;
  size_t offset = 0;

  // Determine the offset based on the NetBIOS packet type.  This is a simplification and may need adjustment
  // based on the specific NetBIOS protocol implementation.
  if (payload_len > 0) {
    if (payload[0] == 0x00) { // Example: Check for a specific NetBIOS packet type
      offset = 1;
    }
  }

  // Extract the NetBIOS name from the payload.  This is a simplification and may need adjustment
  // based on the specific NetBIOS protocol implementation.  Error handling is omitted for brevity.
  char netbios_name[NDPI_MAX_HOST_SERVER_NAME_LEN];
  strncpy(netbios_name, (char *)&payload[offset], min(payload_len - offset, NDPI_MAX_HOST_SERVER_NAME_LEN - 1));
  netbios_name[min(payload_len - offset, NDPI_MAX_HOST_SERVER_NAME_LEN - 1)] = '\0';
  strncpy(flow->host_server_name, netbios_name, NDPI_MAX_HOST_SERVER_NAME_LEN);

  // Update the detected protocol.
  ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, sub_protocol);