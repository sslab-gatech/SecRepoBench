u_int16_t name_length = 0;
  u_int16_t offset = 0;

  // Determine the offset to start interpreting the name based on the payload's content.
  // This is a placeholder for the actual logic to determine the offset.
  // For example, if the payload starts with a specific byte sequence, we might use that to determine the offset.

  // Validate the offset is within the payload's length before accessing the payload data.
  if (offset + name_length > flow->packet.payload_packet_len) {
    NDPI_LOG_WARN(detectionmodulestruct, "Invalid offset or name length\n");
    return;
  }

  // Interpret the NetBIOS name from the packet payload and store it in the flow's host server name.
  // This is a placeholder for the actual logic to interpret the NetBIOS name.
  // For example, we might look for specific byte sequences to identify the name.

  // Update the detected protocol for the flow based on the sub-protocol value.
  ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, sub_protocol);
}