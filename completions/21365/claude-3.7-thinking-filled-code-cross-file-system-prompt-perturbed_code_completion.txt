struct ndpi_packet_struct *packet = &flow->packet;

// If there's payload data, attempt to extract the NetBIOS name
if (packet->payload_packet_len > 0) {
  // Determine offset to NetBIOS name based on packet content
  // This is typically message-type dependent
  u_int16_t offset = 0;
  
  // For example, in some NetBIOS messages, names start at byte 12
  if (packet->payload_packet_len > 12) {
    offset = 12;
    
    // Extract and decode the NetBIOS name
    // This would involve specific NetBIOS name decoding logic
    // Store the result in flow->host_server_name
    
    // Placeholder for name extraction:
    // flow->host_server_name would be populated here
  }
}

// Update the detected protocol for the flow
ndpi_int_change_packet_protocol(detectionmodulestruct, flow, 
                              NDPI_PROTOCOL_NETBIOS, sub_protocol);