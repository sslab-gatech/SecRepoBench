u_int16_t offset = 0;
u_int8_t name_length;

if (flow->packet.payload_packet_len > 13) {
  offset = 12;
  name_length = flow->packet.payload[offset];

  if (offset + name_length + 1 <= flow->packet.payload_packet_len) {
    memcpy(flow->host_server_name, &flow->packet.payload[offset + 1], name_length);
    flow->host_server_name[name_length] = '\0';
  }
}

ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, sub_protocol);