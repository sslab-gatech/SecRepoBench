// Interpret the NetBIOS name from the packet payload and store it in the flow's host server name.
char netbios_name[256];
int name_len = ndpi_netbios_name_interpret(packet->payload + 12, packet->payload_packet_len - 12, netbios_name, sizeof(netbios_name));
if (name_len > 0) {
    ndpi_hostname_sni_set(flow, netbios_name, name_len);
}

// Determine the offset to start interpreting the name based on the payload's content.
int offset = 12;

// Update the detected protocol for the flow based on the sub-protocol value.
ndpi_set_detected_protocol(ndpi_struct, flow, sub_protocol, NDPI_PROTOCOL_NETBIOS);