// Interpret the NetBIOS name from the packet payload and store it in the flow's host server name.
// Determine the offset to start interpreting the name based on the payload's content.
// Update the detected protocol for the flow based on the sub-protocol value.

// Extract the NetBIOS name from the payload
u_int16_t offset = 0;
if (flow->packet.payload_packet_len > 4 && flow->packet.payload[0] == 0x00 && flow->packet.payload[1] == 0x00 && flow->packet.payload[2] == 0x00 && flow->packet.payload[3] == 0x20) {
    offset = 4;
}
if (flow->packet.payload_packet_len > offset + 32) {
    memcpy(flow->host_server_name, &flow->packet.payload[offset], 32);
    flow->host_server_name[32] = '\0';
}

// Update the detected protocol for the flow based on the sub-protocol value
ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, sub_protocol);