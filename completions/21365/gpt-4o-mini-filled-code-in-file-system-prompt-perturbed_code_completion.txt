// Interpret the NetBIOS name from the packet payload
  char name[NDPI_MAX_NAME_LEN];
  int name_len = ndpi_netbios_name_interpret((char *)packet->payload + 12, packet->payload_packet_len - 12, name, sizeof(name));
  
  if (name_len > 0) {
    // Store the interpreted name in the flow's host server name
    strncpy(flow->host_server_name, name, sizeof(flow->host_server_name) - 1);
    flow->host_server_name[sizeof(flow->host_server_name) - 1] = '\0'; // Ensure null termination
  }

  // Update the detected protocol for the flow based on the sub-protocol value
  flow->detected_protocol = sub_protocol;