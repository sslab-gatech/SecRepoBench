static void ndpi_int_netbios_add_connection(struct ndpi_detection_module_struct *detectionmodulestruct,
					    struct ndpi_flow_struct *flow,
					    u_int16_t sub_protocol) {
  // Interpret the NetBIOS name from the packet payload and store it in the flow's host server name.
  // Determine the offset to start interpreting the name based on the payload's content.
  // Update the detected protocol for the flow based on the sub_protocol value.
  char name[256];
  int name_len = ndpi_netbios_name_interpret(packet->payload + offset, packet->payload_packet_len - offset, name, sizeof(name));
  if (name_len > 0) {
    ndpi_set_detection_result(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, NDPI_PROTOCOL_UNKNOWN, sub_protocol);
    ndpi_set_host_server_name(detectionmodulestruct, flow, name, name_len);
  }
}