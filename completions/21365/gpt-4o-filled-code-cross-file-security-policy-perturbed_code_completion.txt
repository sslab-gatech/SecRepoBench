struct ndpi_packet_struct *packet = &flow->packet;
  u_int16_t offset = 0;

  if(packet->payload_packet_len < 1) {
    return; // No payload to process
  }

  // Determine the offset based on some condition or protocol specifics
  // For example, let's assume the offset is determined by the first byte of the payload
  offset = packet->payload[0];

  // Validate the offset against the payload length
  if(offset >= packet->payload_packet_len) {
    return; // Invalid offset, prevent buffer overflow
  }

  // Interpret the NetBIOS name from the payload starting at the offset
  // This is a placeholder for actual NetBIOS name interpretation logic
  char netbios_name[256]; // Assuming a max length for the NetBIOS name
  snprintf(netbios_name, sizeof(netbios_name), "%s", &packet->payload[offset]);

  // Store the interpreted name in the flow's host server name
  snprintf(flow->host_server_name, sizeof(flow->host_server_name), "%s", netbios_name);

  // Update the detected protocol for the flow
  ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, sub_protocol);