struct ndpi_packet_struct *packet = &flow->packet;

  if (packet->payload_packet_len > 1) {
    // Interpret the NetBIOS name from the payload
    char netbios_name[16] = {0};
    int offset = 1; // Assuming the NetBIOS name starts at offset 1
    int name_len = (packet->payload_packet_len - offset > 15) ? 15 : (packet->payload_packet_len - offset);

    memcpy(netbios_name, &packet->payload[offset], name_len);
    netbios_name[name_len] = '\0';

    // Store the interpreted name in the flow's host server name
    strncpy(flow->host_server_name, netbios_name, sizeof(flow->host_server_name) - 1);
    flow->host_server_name[sizeof(flow->host_server_name) - 1] = '\0';
  }

  // Update the detected protocol for the flow
  ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, sub_protocol);