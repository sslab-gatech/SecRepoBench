// Interpret the NetBIOS name from the packet payload
  u_int8_t name_length = packet->payload[12];
  char netbios_name[17]; // Max length for NetBIOS name is 16 characters + null terminator
  memset(netbios_name, 0, sizeof(netbios_name));

  // Ensure the name length is valid
  if (name_length > 16) {
    NDPI_LOG_WARN(ndpi_struct, "NetBIOS name length exceeds maximum allowed length\n");
    return;
  }

  // Copy the NetBIOS name from the payload
  memcpy(netbios_name, &packet->payload[13], name_length);
  netbios_name[name_length] = '\0'; // Null-terminate the string

  // Store the NetBIOS name in the flow's host server name
  strncpy(flow->host_server_name, netbios_name, sizeof(flow->host_server_name) - 1);
  flow->host_server_name[sizeof(flow->host_server_name) - 1] = '\0'; // Ensure null termination

  // Update the detected protocol for the flow based on the sub-protocol value
  flow->detected_protocol = sub_protocol;