struct ndpi_packet_struct *packet = &flow->packet;
  if(packet == NULL || packet->payload_packet_len < 1) {
    return;
  }

  // Assuming the NetBIOS name starts at a specific offset in the payload
  // This offset should be determined based on the NetBIOS protocol specification
  u_int16_t netbios_name_offset = 0; // This should be set to the correct offset
  char netbios_name[16]; // NetBIOS names are typically 15 characters + null terminator

  if(packet->payload_packet_len > netbios_name_offset + 15) {
    memcpy(netbios_name, &packet->payload[netbios_name_offset], 15);
    netbios_name[15] = '\0'; // Ensure null termination
    strncpy(flow->host_server_name, netbios_name, sizeof(flow->host_server_name) - 1);
    flow->host_server_name[sizeof(flow->host_server_name) - 1] = '\0'; // Ensure null termination
  }

  // Update the detected protocol for the flow
  ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, sub_protocol);