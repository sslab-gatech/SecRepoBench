static void ndpi_int_netbios_add_connection(struct ndpi_detection_module_struct *detectionmodulestruct,
					    struct ndpi_flow_struct *flow,
					    u_int16_t sub_protocol) {
  // Interpret the NetBIOS name from the packet payload and store it in the flow's host server name.
  char *name = (char *)packet->payload + 12; // Assuming the name starts after the header
  int name_length = ndpi_netbios_name_interpret(name, packet->payload_packet_len - 12, flow->host_server_name, sizeof(flow->host_server_name));

  if (name_length > 0) {
    NDPI_LOG_INFO(detectionmodulestruct, "Found NetBIOS name: %s\n", flow->host_server_name);
  } else {
    NDPI_LOG_DBG(detectionmodulestruct, "Failed to interpret NetBIOS name\n");
  }

  // Update the detected protocol for the flow based on the sub_protocol value.
  ndpi_set_detection_protocol(detectionmodulestruct, flow, sub_protocol);
}