// Interpret the NetBIOS name from the packet payload and store it in the flow's host server name.
  // Determine the offset to start interpreting the name based on the payload's content.
  // Update the detected protocol for the flow based on the sub-protocol value.
  u_int8_t *payload = flow->packet.payload;
  u_int16_t payload_len = flow->packet.payload_packet_len;

  // Check if the payload contains a NetBIOS name
  if (payload_len >= 2 && payload[0] == 0x00 && payload[1] == 0x00) {
    // NetBIOS name format: 0x00 0x00 <name_length> <name_data>
    u_int16_t name_length = payload[2];
    if (payload_len >= 3 + name_length) {
      // Copy the NetBIOS name to the flow's host server name
      memcpy(flow->host_server_name, &payload[3], name_length);
      flow->host_server_name_len = name_length;

      // Update the detected protocol for the flow
      ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, 0);
    }
  }