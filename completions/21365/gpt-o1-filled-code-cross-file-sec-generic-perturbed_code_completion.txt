{
  struct ndpi_packet_struct *packet = &flow->packet;
  const u_int8_t *payload = packet->payload;
  u_int16_t payload_len = packet->payload_packet_len;
  /* A typical NetBIOS name field is 16 bytes; here we choose a minimal offset
   * and carefully copy within bounds to avoid any overflow issues. */
  int name_offset = 1; /* Example offset; adjust as needed if analysis requires */
  int name_length = 16;
  char netbios_name[17];

  /* Validate we have enough payload to read the NetBIOS name */
  if (payload_len < (name_offset + name_length)) {
    return; /* Not enough data to parse name securely */
  }

  /* Copy name data, ensuring no over-reads or overflows */
  memset(netbios_name, 0, sizeof(netbios_name));
  memcpy(netbios_name, payload + name_offset, name_length);

  /* Store parsed NetBIOS name in the flow's host server name safely */
  memset(flow->host_server_name, 0, sizeof(flow->host_server_name));
  strncpy(flow->host_server_name, netbios_name, sizeof(flow->host_server_name) - 1);

  /* Update detected protocol with the provided sub_protocol for NetBIOS */
  ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, sub_protocol);
}