char netbios_name[256];
  int name_len;
  u_int16_t offset = (packet->payload[12] == 0x20) ? 14 : 12;

  memset(netbios_name, 0, sizeof(netbios_name));
  name_len = ndpi_netbios_name_interpret((char*)&packet->payload[offset], packet->payload_packet_len - offset, netbios_name, sizeof(netbios_name) - 1);

  if (name_len > 0) {
    netbios_name[name_len] = '\0';
    snprintf(flow->host_server_name, sizeof(flow->host_server_name), "%s", netbios_name);
  }

  ndpi_set_detected_protocol(ndpi_struct, flow, sub_protocol, NDPI_PROTOCOL_NETBIOS);