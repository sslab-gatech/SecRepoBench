char netbios_name[256];

  if (packet->payload_packet_len > 17 && ndpi_netbios_name_interpret((char *)packet->payload + 17, packet->payload_packet_len - 17, netbios_name, sizeof(netbios_name)) > 0) {
    if (flow->host_server_name[0] == '\0') {
      strncpy(flow->host_server_name, netbios_name, sizeof(flow->host_server_name) - 1);
      flow->host_server_name[sizeof(flow->host_server_name) - 1] = '\0';
    }
  } else if (packet->payload_packet_len > 13 && ndpi_netbios_name_interpret((char *)packet->payload + 13, packet->payload_packet_len - 13, netbios_name, sizeof(netbios_name)) > 0) {
    if (flow->host_server_name[0] == '\0') {
      strncpy(flow->host_server_name, netbios_name, sizeof(flow->host_server_name) - 1);
      flow->host_server_name[sizeof(flow->host_server_name) - 1] = '\0';
    }
  }


  NDPI_PROTOCOL_SET_UNKNOWN_PROTOCOL(ndpi_struct, flow, NDPI_PROTOCOL_NETBIOS);
  if (sub_protocol != NDPI_PROTOCOL_UNKNOWN) {
      ndpi_int_add_connection(ndpi_struct, flow, sub_protocol, NDPI_PROTOCOL_NETBIOS);
  }