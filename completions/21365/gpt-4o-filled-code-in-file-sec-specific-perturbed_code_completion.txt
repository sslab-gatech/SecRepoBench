// Ensure the payload is large enough to contain the NetBIOS name
  if (flow->packet.payload_packet_len < 13) {
    return;
  }

  // Calculate the offset for the NetBIOS name
  u_int8_t name_length = flow->packet.payload[12];
  if (name_length + 13 > flow->packet.payload_packet_len) {
    return;
  }

  // Allocate memory for the interpreted name
  char interpreted_name[256];
  if (ndpi_netbios_name_interpret((char *)&flow->packet.payload[13], name_length, interpreted_name, sizeof(interpreted_name)) < 0) {
    return;
  }

  // Store the interpreted name in the flow's host server name
  strncpy(flow->host_server_name, interpreted_name, sizeof(flow->host_server_name) - 1);
  flow->host_server_name[sizeof(flow->host_server_name) - 1] = '\0';

  // Update the detected protocol for the flow
  ndpi_set_detected_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, sub_protocol);