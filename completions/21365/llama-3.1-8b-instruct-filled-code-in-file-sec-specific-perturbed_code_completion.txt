static void ndpi_int_netbios_add_connection(struct ndpi_detection_module_struct *detectionmodulestruct,
					    struct ndpi_flow_struct *flow,
					    u_int16_t sub_protocol) { 
  // Interpret the NetBIOS name from the packet payload and store it in the flow's host server name.
  // Determine the offset to start interpreting the name based on the payload's content.
  // Update the detected protocol for the flow based on the sub-protocol value.
  int name_offset = 12; // Assuming the NetBIOS name starts at offset 12 in the payload
  int name_length = 0;
  char *name = NULL;

  if (flow->packet.payload_packet_len >= 12 + 1 + 1 + 2 + 2) {
    name_length = packet->payload[12];
    name = malloc(name_length + 1);
    if (name!= NULL) {
      memcpy(name, packet->payload + 12 + 1, name_length);
      name[name_length] = '\0';
    }
  }

  if (name!= NULL) {
    // Store the NetBIOS name in the flow's host server name
    flow->host_server_name = strdup(name);
    free(name);
  }

  // Update the detected protocol for the flow based on the sub-protocol value
  if (sub_protocol == NDPI_PROTOCOL_SMBV1) {
    flow->detected_protocol = NDPI_PROTOCOL_SMBV1;
  } else {
    flow->detected_protocol = NDPI_PROTOCOL_UNKNOWN;
  }
}