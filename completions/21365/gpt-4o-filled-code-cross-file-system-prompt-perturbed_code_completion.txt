struct ndpi_packet_struct *packet = &flow->packet;
  u_int8_t *payload = packet->payload;
  u_int16_t payload_len = packet->payload_packet_len;
  char netbios_name[16] = {0}; // NetBIOS names are 15 characters + null terminator
  int offset = 0;

  // Check if the payload is long enough to contain a NetBIOS name
  if (payload_len < 34) {
    return; // Not enough data for a NetBIOS name
  }

  // NetBIOS names start at offset 13 in the payload
  offset = 13;

  // Extract the NetBIOS name
  for (int i = 0; i < 15; i++) {
    netbios_name[i] = payload[offset + i];
  }
  netbios_name[15] = '\0'; // Null-terminate the string

  // Store the NetBIOS name in the flow's host server name
  strncpy(flow->host_server_name, netbios_name, sizeof(flow->host_server_name) - 1);
  flow->host_server_name[sizeof(flow->host_server_name) - 1] = '\0'; // Ensure null-termination

  // Update the detected protocol for the flow
  ndpi_int_change_packet_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, sub_protocol);