struct ndpi_packet_struct *packet = &flow->packet;
  
// Update the detected protocol
ndpi_int_change_packet_protocol(ndpi_struct, flow, sub_protocol, NDPI_PROTOCOL_UNKNOWN);
  
// Set the flow protocol directly as well
flow->detected_protocol_stack[0] = sub_protocol;
flow->detected_protocol_stack[1] = NDPI_PROTOCOL_UNKNOWN;
  
// Extract and interpret the NetBIOS name if possible
if(packet->payload_packet_len >= 12) {
  u_int offset = 12; // Starting position for the name
  
  // Extract and decode the NetBIOS name
  if(offset < packet->payload_packet_len) {
    u_int name_len = packet->payload_packet_len - offset;
    if(name_len > sizeof(flow->host_server_name) - 1)
      name_len = sizeof(flow->host_server_name) - 1;
    
    if(name_len > 0) {
      memcpy(flow->host_server_name, &packet->payload[offset], name_len);
      flow->host_server_name[name_len] = '\0'; // Ensure null-termination
    }
  }
}