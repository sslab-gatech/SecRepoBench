char netbios_name[256];
  int name_len;

  // Assume the NetBIOS name starts at offset 12 in the payload
  name_len = ndpi_netbios_name_interpret((char*)&packet->payload[12], packet->payload_packet_len - 12, netbios_name, sizeof(netbios_name));

  if(name_len > 0) {
    // Store the interpreted NetBIOS name in the flow's host server name
    strncpy(flow->host_server_name, netbios_name, sizeof(flow->host_server_name) - 1);
    flow->host_server_name[sizeof(flow->host_server_name) - 1] = '\0';
  }

  // Update the detected protocol for the flow
  ndpi_set_detected_protocol(detectionmodulestruct, flow, NDPI_PROTOCOL_NETBIOS, sub_protocol);