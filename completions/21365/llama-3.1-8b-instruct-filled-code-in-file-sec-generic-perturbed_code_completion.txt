static void ndpi_int_netbios_add_connection(struct ndpi_detection_module_struct *detectionmodulestruct,
					    struct ndpi_flow_struct *flow,
					    u_int16_t sub_protocol) { 
  // Interpret the NetBIOS name from the packet payload and store it in the flow's host server name.
  // Determine the offset to start interpreting the name based on the payload's content.
  // Update the detected protocol for the flow based on the sub-protocol value.
  char *name = NULL;
  size_t name_len = 0;
  int ret = ndpi_netbios_name_interpret(flow->packet.payload, flow->packet.payload_packet_len, name, name_len);
  if (ret > 0) {
    flow->host_server_name = malloc(ret + 1);
    if (flow->host_server_name!= NULL) {
      memcpy(flow->host_server_name, name, ret);
      flow->host_server_name[ret] = '\0';
    }
  }
  flow->detected_protocol = sub_protocol;
}