// Interpret the NetBIOS name from the packet payload and store it in the flow's host server name.
  // Determine the offset to start interpreting the name based on the payload's content.
  // Update the detected protocol for the flow based on the sub-protocol value.
  u_int8_t *payload = packet->payload;
  u_int8_t *name_start = NULL;
  u_int16_t name_length = 0;

  // Check for NetBIOS name query request
  if (packet->payload_packet_len >= 12 && payload[0] == 0x00 && payload[1] == 0x00) {
    name_start = &payload[12];
    name_length = payload[11];
  }

  // Check for NetBIOS name query response
  if (packet->payload_packet_len >= 12 && payload[0] == 0x80 && payload[1] == 0x00) {
    name_start = &payload[12];
    name_length = payload[11];
  }

  if (name_start && name_length > 0) {
    char name[256];
    int name_len = ndpi_netbios_name_interpret(name_start, name_length, name, sizeof(name));
    if (name_len > 0) {
      ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_NETBIOS, NDPI_PROTOCOL_UNKNOWN);
      flow->host_server_name = strndup(name, name_len);
    }
  }