// Determine the offset to start interpreting the name based on the payload's content.
  u_int16_t offset = 0; // Initialize offset
  if (packet->payload_packet_len > 0) {
    // Check if the payload starts with a specific NetBIOS name prefix
    if (memcmp(packet->payload, "NBNS", 4) == 0) {
      offset = 4; // Skip the prefix
    }
    // Add more conditions for different NetBIOS name formats if needed
  }

  // Validate the offset to prevent reading beyond the buffer's bounds
  if (offset < packet->payload_packet_len) {
    // Interpret the NetBIOS name from the packet payload
    char *netbios_name = (char *)&packet->payload[offset];

    // Store the NetBIOS name in the flow's host server name
    strncpy(flow->host_server_name, netbios_name, sizeof(flow->host_server_name) - 1);
    flow->host_server_name[sizeof(flow->host_server_name) - 1] = '\0';

    // Update the detected protocol for the flow based on the sub-protocol value
    ndpi_int_change_packet_protocol(detectionmodulestruct, flow, sub_protocol, NDPI_PROTOCOL_NETBIOS);
  }