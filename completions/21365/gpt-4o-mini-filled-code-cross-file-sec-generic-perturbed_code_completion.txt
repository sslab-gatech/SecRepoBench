struct ndpi_packet_struct *packet = &flow->packet;

  if (!packet) {
    return;
  }

  // Assuming the payload contains the NetBIOS name starting at a specific offset
  const u_int8_t *payload = packet->payload;
  u_int16_t payload_length = packet->payload_packet_len;

  // Example offset for NetBIOS name (this may vary based on actual protocol)
  u_int16_t offset = 0; // Set this to the correct offset based on your protocol analysis
  u_int16_t name_length = payload_length - offset; // Adjust as necessary

  // Ensure we do not read beyond the payload length
  if (name_length > 0 && name_length <= payload_length - offset) {
    // Copy the NetBIOS name into the flow's host server name
    memcpy(flow->host_server_name, &payload[offset], name_length);
    flow->host_server_name[name_length] = '\0'; // Null-terminate the string

    // Update the detected protocol based on the sub_protocol
    ndpi_int_change_packet_protocol(detectionmodulestruct, flow, sub_protocol);
  }