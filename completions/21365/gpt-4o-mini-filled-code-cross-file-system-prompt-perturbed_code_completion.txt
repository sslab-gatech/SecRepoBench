// Interpret the NetBIOS name from the packet payload
  const u_int8_t *payload = flow->packet.payload;
  u_int16_t payload_len = flow->packet.payload_packet_len;
  u_int16_t name_length = payload_len > 0 ? payload[0] : 0; // Assuming the first byte indicates the length
  if (name_length > 0 && name_length < payload_len) {
    // Copy the NetBIOS name into the flow's host server name
    memcpy(flow->host_server_name, &payload[1], name_length);
    flow->host_server_name[name_length] = '\0'; // Null-terminate the string
  }

  // Update the detected protocol for the flow
  ndpi_int_change_packet_protocol(detectionmodulestruct, flow, sub_protocol);