// Determine the offset to start interpreting the name based on the payload's content.
  u_int16_t offset = 0;
  if (packet->payload[0] == 0x00) {
    offset = 1; // Skip the null byte if present.
  }

  // Interpret the NetBIOS name from the packet payload and store it in the flow's host server name.
  char *name = &packet->payload[offset];
  size_t namelen = packet->payload_packet_len - offset;
  if (namelen > NDPI_MAX_HOST_NAME_LENGTH) {
    namelen = NDPI_MAX_HOST_NAME_LENGTH;
  }
  memcpy(flow->host_server_name, name, namelen);
  flow->host_server_name[namelen] = '\0';

  // Update the detected protocol for the flow based on the sub-protocol value.
  ndpi_int_change_packet_protocol(detectionmodulestruct, flow, sub_protocol, NDPI_PROTOCOL_NETBIOS);