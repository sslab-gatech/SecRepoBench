u_int8_t name_length = packet->payload[12];
char netbios_name[256];

if (packet->payload_packet_len >= 12 + 1 + name_length + 1) {
  if (ndpi_netbios_name_interpret(packet->payload + 13, name_length, netbios_name, sizeof(netbios_name)) > 0) {
    NDPI_LOG_DBG2(ndpi_struct, "found netbios name: %s\n", netbios_name);
    ndpi_add_connection_to_list(ndpi_struct, flow, NDPI_DEFAULT_PROTOCOL_ID, netbios_name);
    flow->detected_protocol_stack[flow->protocol_detection_index++] = sub_protocol;
  }
}