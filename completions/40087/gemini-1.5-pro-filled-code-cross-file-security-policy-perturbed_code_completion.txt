if (quic_ciphers_init(&ciphers, version, client_secret) != 0) {
    NDPI_LOG_DBG(ndpi_struct, "quic_ciphers_init failed\n");
    return NULL;
  }

  pn_offset = quic_get_pn_offset(packet->payload, packet->payload_packet_len);
  if(pn_offset == -1) {
    quic_ciphers_reset(&ciphers);
    return NULL;
  }

  offset = 0;
  token_length = quic_get_token_length(packet->payload, packet->payload_packet_len, &offset);
  pn_offset += token_length;

  payload_length = quic_get_long_header_payload_length(packet->payload, packet->payload_packet_len,
						       &pn_offset);

  NDPI_LOG_DBG2(ndpi_struct, "pn_offset %u, payload_length %"PRIu64"\n",
	       pn_offset, payload_length);