// Prepare the cipher context with the provided client secret and version.
// Calculate the packet number offset.
// Determine the length of the tokens and add it to the offset.
// Retrieve the payload length from the packet, updating the packet number offset.
// Log the calculated offsets and lengths for debugging purposes.
// <MASK>

// Calculate the packet number offset.
pn_offset = 0;
// Determine the length of the tokens and add it to the offset.
token_length = 8; // Assuming 8 bytes for token length
pn_offset += token_length;

// Retrieve the payload length from the packet, updating the packet number offset.
payload_length = packet->payload_packet_len - pn_offset;
// Log the calculated offsets and lengths for debugging purposes.
NDPI_LOG_DBG(ndpi_struct, "pn_offset: %d, payload_length: %d\n", pn_offset, payload_length);