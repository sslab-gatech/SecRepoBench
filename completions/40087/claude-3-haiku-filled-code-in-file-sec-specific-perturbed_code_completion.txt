if(quic_ciphers_prepare(&ciphers, GCRY_MD_SHA256, GCRY_CIPHER_AES128, GCRY_CIPHER_MODE_GCM, client_secret, version)) {
  pn_offset = is_gquic_ver_less_than(version, 43) ? 26 : 6 + dest_conn_id_len;
  if(is_version_with_var_int_transport_params(version)) {
    uint64_t token_length;
    pn_offset += quic_len(&packet->payload[pn_offset], &token_length);
  }
  if(is_version_with_ietf_long_header(version)) {
    pn_offset += 1 + source_conn_id_len;
  }
  payload_length = packet->payload_packet_len - pn_offset - 16; /* 16 bytes for auth tag */
} else {
  NDPI_LOG_DBG(ndpi_struct, "Failed to prepare ciphers\n");
  return NULL;
}