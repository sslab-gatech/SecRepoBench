if(!quic_aead_cipher_init(&ciphers.pp_cipher, GCRY_CIPHER_AES128, GCRY_MD_SHA256,
			     client_secret, version, 1)) {
    NDPI_LOG_DBG(ndpi_struct, "Error quic_aead_cipher_init\n");
    return NULL;
  }

  if(!quic_hp_cipher_init(&ciphers.hp_cipher, GCRY_MD_SHA256, 16,
			   client_secret, version)) {
    NDPI_LOG_DBG(ndpi_struct, "Error quic_hp_cipher_init\n");
    quic_ciphers_reset(&ciphers);
    return NULL;
  }

  pn_offset = 7; /* Skip version negotiation and reserved bits */
  if(packet->payload[0] & 0x40) { /* Long header type */
    token_length = packet->payload[pn_offset];
    pn_offset++;
    pn_offset += token_length;
  }

  payload_length = packet->payload_packet_len - pn_offset;

  NDPI_LOG_DBG2(ndpi_struct, "pn_offset %u payload_length %u\n", pn_offset, payload_length);