if (!quic_hp_cipher_init(&ciphers.hp_cipher, GCRY_MD_SHA256, 16, client_secret, version)) {
    NDPI_LOG_DBG(ndpi_struct, "Error initializing HP cipher\n");
    return NULL;
  }

  pn_offset = 1 + dest_conn_id_len + src_conn_id_len; // 1 byte for the first byte
  token_length = packet->payload[0] & 0x0F; // Assuming the token length is in the first byte
  pn_offset += token_length; // Add token length to the offset

  payload_length = packet->payload_packet_len - pn_offset; // Calculate payload length
  NDPI_LOG_DBG2(ndpi_struct, "pn_offset: %d, payload_length: %d\n", pn_offset, payload_length);