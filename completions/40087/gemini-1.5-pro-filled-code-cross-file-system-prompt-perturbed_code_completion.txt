quic_ciphers_init(&ciphers, version, client_secret);

  pn_offset = quic_get_pn_offset(packet->payload, packet->payload_packet_len);
  NDPI_LOG_DBG2(ndpi_struct, "pn_offset %u\n", pn_offset);
  offset = pn_offset;

  token_length = quic_get_varint(&packet->payload[offset],
				 packet->payload_packet_len - offset, &offset);
  NDPI_LOG_DBG2(ndpi_struct, "token_length %lu\n", token_length);
  offset += token_length;

  payload_length = quic_get_varint(&packet->payload[offset],
				   packet->payload_packet_len - offset, &offset);
  NDPI_LOG_DBG2(ndpi_struct, "payload_length %lu\n", payload_length);
  pn_offset = offset;
  NDPI_LOG_DBG2(ndpi_struct, "pn_offset %u\n", pn_offset);