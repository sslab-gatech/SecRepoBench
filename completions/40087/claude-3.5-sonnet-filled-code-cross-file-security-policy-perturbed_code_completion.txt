if (quic_hp_cipher_init(&ciphers.hp_cipher, GCRY_MD_SHA256, 16, client_secret, version) != 1) {
  NDPI_LOG_DBG(ndpi_struct, "Error initializing header protection cipher\n");
  return NULL;
}

pn_offset = 6 + dest_conn_id_len + src_conn_id_len;
token_length = quic_len(&packet->payload[pn_offset], &offset);
pn_offset += offset;

payload_length = quic_len(&packet->payload[pn_offset], &offset);
pn_offset += offset;

NDPI_LOG_DBG2(ndpi_struct, "PN offset %u Token length %lu Payload length %lu\n",
              pn_offset, token_length, payload_length);