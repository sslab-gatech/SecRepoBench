// <MASK>
if(!quic_ciphers_prepare(&ciphers, GCRY_MD_SHA256, GCRY_CIPHER_AES128, GCRY_CIPHER_MODE_GCM, client_secret, version)) {
  NDPI_LOG_DBG(ndpi_struct, "Error quic_ciphers_prepare\n");
  return NULL;
}

pn_offset = is_version_with_ietf_long_header(version) ? 6 + packet->payload[5] + 1 + packet->payload[6 + packet->payload[5]] : 1;
if(is_version_with_var_int_transport_params(version)) {
  uint64_t token_len;
  pn_offset += quic_len(&packet->payload[pn_offset], &token_len);
}
pn_offset += quic_len(&packet->payload[pn_offset], &payload_length);

NDPI_LOG_DBG2(ndpi_struct, "pn_offset %d payload_length %d\n", pn_offset, payload_length);