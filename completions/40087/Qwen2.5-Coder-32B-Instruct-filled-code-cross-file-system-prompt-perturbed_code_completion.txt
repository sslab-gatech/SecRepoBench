if (quic_setup_initial_ciphers(&ciphers, client_secret, version) != 0) {
    NDPI_LOG_DBG(ndpi_struct, "Error setting up initial ciphers\n");
    return NULL;
  }

  pn_offset = 1 + dest_conn_id_len + src_conn_id_len;
  token_length = quic_parse_token_length(packet->payload, pn_offset);
  pn_offset += token_length;

  payload_length = quic_parse_payload_length(packet->payload, pn_offset);
  pn_offset += 1; /* Skip the payload length field itself */

  NDPI_LOG_DBG2(ndpi_struct, "pn_offset: %u, token_length: %llu, payload_length: %llu\n",
                pn_offset, token_length, payload_length);