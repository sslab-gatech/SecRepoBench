if (!quic_ciphers_prepare(&ciphers, GCRY_MD_SHA256, GCRY_CIPHER_AES128, GCRY_CIPHER_MODE_CTR, client_secret, version)) {
    NDPI_LOG_DBG(ndpi_struct, "Failed to prepare ciphers\n");
    return NULL;
  }

  pn_offset = 6 + dest_conn_id_len + source_conn_id_len; // Calculate packet number offset
  token_length = packet->payload[5 + 1 + dest_conn_id_len + 1 + source_conn_id_len]; // Get token length
  payload_length = packet->payload_packet_len - pn_offset - token_length; // Calculate payload length
  NDPI_LOG_DBG2(ndpi_struct, "pn_offset: %d, token_length: %llu, payload_length: %llu\n", pn_offset, token_length, payload_length);