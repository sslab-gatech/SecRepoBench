pn_offset = sizeof(uint8_t) + dest_conn_id_len + src_conn_id_len; // Initial offset for packet number
  token_length = (uint64_t)(dest_conn_id_len + src_conn_id_len); // Calculate token length
  payload_length = (uint64_t)packet->payload_packet_len - pn_offset; // Calculate payload length

  NDPI_LOG_DBG(ndpi_struct, "Calculated pn_offset: %llu, token_length: %llu, payload_length: %llu\n", 
               (unsigned long long)pn_offset, (unsigned long long)token_length, (unsigned long long)payload_length);