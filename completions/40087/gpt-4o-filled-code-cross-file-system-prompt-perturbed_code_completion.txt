if(!quic_pp_cipher_init(&ciphers.pp_cipher, GCRY_CIPHER_AES128, GCRY_MD_SHA256,
                          client_secret, version)) {
    NDPI_LOG_DBG(ndpi_struct, "Error quic_pp_cipher_init\n");
    return NULL;
  }

  if(!quic_hp_cipher_init(&ciphers.hp_cipher, GCRY_MD_SHA256, 16,
                          client_secret, version)) {
    NDPI_LOG_DBG(ndpi_struct, "Error quic_hp_cipher_init\n");
    quic_ciphers_reset(&ciphers);
    return NULL;
  }

  pn_offset = 5 + dest_conn_id_len + src_conn_id_len;
  token_length = 0;

  if(version == V_Q046) {
    token_length = packet->payload[pn_offset];
    pn_offset += 1 + token_length;
  } else {
    token_length = read_varlen(packet->payload, &pn_offset);
  }

  payload_length = read_varlen(packet->payload, &pn_offset);
  NDPI_LOG_DBG2(ndpi_struct, "pn_offset %u token_length %llu payload_length %llu\n",
                pn_offset, token_length, payload_length);