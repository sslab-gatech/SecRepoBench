if (quic_hp_cipher_init(&ciphers.hp_cipher, GCRY_MD_SHA256, 16, client_secret, version) != 1) {
  NDPI_LOG_DBG(ndpi_struct, "Error initializing header protection cipher\n");
  return NULL;
}

pn_offset = 6 + dest_conn_id_len + src_conn_id_len;

if (quic_len_buffer_to_varint(packet->payload + pn_offset, packet->payload_packet_len - pn_offset, &token_length) == 0) {
  NDPI_LOG_DBG(ndpi_struct, "Error parsing token length\n");
  quic_ciphers_reset(&ciphers);
  return NULL;
}
pn_offset += quic_len_varint(token_length) + token_length;

if (quic_len_buffer_to_varint(packet->payload + pn_offset, packet->payload_packet_len - pn_offset, &payload_length) == 0) {
  NDPI_LOG_DBG(ndpi_struct, "Error parsing payload length\n");
  quic_ciphers_reset(&ciphers);
  return NULL;
}
pn_offset += quic_len_varint(payload_length);

NDPI_LOG_DBG2(ndpi_struct, "pn_offset %u token_length %lu payload_length %lu\n", pn_offset, token_length, payload_length);