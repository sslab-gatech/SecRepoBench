if (!quic_ciphers_prepare(&ciphers, GCRY_MD_SHA256, GCRY_CIPHER_AES128, GCRY_CIPHER_MODE_GCM,
                          client_secret, version)) {
  NDPI_LOG_DBG(ndpi_struct, "Error initializing ciphers\n");
  return NULL;
}

pn_offset = 6 + dest_conn_id_len + src_conn_id_len;

if (quic_len(&packet->payload[pn_offset], &token_length) == 0) {
  quic_ciphers_reset(&ciphers);
  return NULL;
}
pn_offset += token_length + quic_len_buffer_still_required(packet->payload[pn_offset]);

if (quic_len(&packet->payload[pn_offset], &payload_length) == 0) {
  quic_ciphers_reset(&ciphers);
  return NULL;
}
pn_offset += quic_len_buffer_still_required(packet->payload[pn_offset]);

NDPI_LOG_DBG2(ndpi_struct, "PN offset %u Token length %lu Payload length %lu\n",
              pn_offset, (unsigned long)token_length, (unsigned long)payload_length);