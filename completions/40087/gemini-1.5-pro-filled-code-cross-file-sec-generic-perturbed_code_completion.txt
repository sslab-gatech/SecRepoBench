if(!quic_ciphers_init(&ciphers, version, client_secret)) {
    return NULL;
  }

  pn_offset = quic_get_pn_offset(packet->payload, packet->payload_packet_len);
  if (pn_offset == -1) {
    quic_ciphers_reset(&ciphers);
    return NULL;
  }

  offset = 0;
  token_length = quic_get_varint(&packet->payload[offset],
                                 packet->payload_packet_len - offset, &offset);

  pn_offset += token_length;

  payload_length = quic_get_varint(&packet->payload[offset],
                                   packet->payload_packet_len - offset, &offset);
  pn_offset += offset;

  NDPI_LOG_DBG2(ndpi_struct, "pn_offset %u token_length %lu payload_length %lu\n",
               pn_offset, token_length, payload_length);