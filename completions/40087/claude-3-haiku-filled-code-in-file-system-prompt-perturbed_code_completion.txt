// <MASK>
if(!quic_ciphers_prepare(&ciphers, GCRY_MD_SHA256, GCRY_CIPHER_AES128, GCRY_CIPHER_MODE_GCM, client_secret, version)) {
  NDPI_LOG_DBG(ndpi_struct, "Error quic_ciphers_prepare\n");
  return NULL;
}

pn_offset = is_gquic_ver_less_than(version, 43) ? 26 : 6 + dest_conn_id_len;
if(is_version_with_encrypted_header(version)) {
  payload_length = packet->payload_packet_len - pn_offset - 16; /* 16 bytes for auth tag */
} else {
  if(is_gquic_ver_less_than(version, 46)) {
    payload_length = gquic_get_u16(&packet->payload[pn_offset + 4], version);
  } else {
    counter = pn_offset;
    counter += quic_len(&packet->payload[counter], &token_length);
    counter += quic_len(&packet->payload[counter], &payload_length);
  }
}
NDPI_LOG_DBG2(ndpi_struct, "pn_offset %d payload_length %d\n", pn_offset, payload_length);