pn_offset = 0; // Initialize packet number offset
  token_length = 0; // Initialize token length
  payload_length = packet->payload_packet_len; // Get the total payload length

  // Calculate the packet number offset based on the length of the connection IDs
  pn_offset += dest_conn_id_len + src_conn_id_len;

  // Ensure that the calculated offsets do not exceed the payload length
  if (pn_offset > payload_length) {
    NDPI_LOG_DBG(ndpi_struct, "Calculated pn_offset exceeds payload length: %d > %d\n", pn_offset, payload_length);
    return NULL;
  }

  // Log the calculated offsets and lengths for debugging purposes
  NDPI_LOG_DBG(ndpi_struct, "Calculated pn_offset: %d, payload_length: %d\n", pn_offset, payload_length);