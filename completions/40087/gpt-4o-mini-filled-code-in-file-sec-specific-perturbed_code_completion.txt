if (!quic_ciphers_prepare(&ciphers, GCRY_MD_SHA256, GCRY_CIPHER_AES128, GCRY_CIPHER_MODE_ECB, client_secret, version)) {
    NDPI_LOG_DBG(ndpi_struct, "Failed to prepare QUIC ciphers\n");
    return NULL;
  }

  pn_offset = 6 + dest_conn_id_len + source_conn_id_len; // Calculate packet number offset
  token_length = packet->payload[5]; // Assuming token length is stored at this position
  payload_length = packet->payload_packet_len - pn_offset - token_length; // Calculate payload length

  NDPI_LOG_DBG2(ndpi_struct, "Calculated offsets: pn_offset=%d, payload_length=%d\n", pn_offset, payload_length);