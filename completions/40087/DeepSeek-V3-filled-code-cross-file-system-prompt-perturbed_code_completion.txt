if(quic_hp_cipher_init(&ciphers.hp_cipher, GCRY_MD_SHA256, 16, client_secret, version) == 0) {
    NDPI_LOG_DBG(ndpi_struct, "Error quic_hp_cipher_init\n");
    return NULL;
  }

  if(quic_pp_cipher_init(&ciphers.pp_cipher, GCRY_MD_SHA256, 16, client_secret, version) == 0) {
    NDPI_LOG_DBG(ndpi_struct, "Error quic_pp_cipher_init\n");
    quic_ciphers_reset(&ciphers);
    return NULL;
  }

  pn_offset = 1 + dest_conn_id_len + src_conn_id_len + 4 + 1; /* 1 for first byte, 4 for version, 1 for token length */
  token_length = packet->payload[pn_offset - 1];
  pn_offset += token_length;

  payload_length = ndpi_ntohll(*(uint64_t*)&packet->payload[pn_offset]) & 0x3FFFFFFF;
  pn_offset += 2; /* Skip the payload length field */

  NDPI_LOG_DBG2(ndpi_struct, "pn_offset %u payload_length %lu token_length %lu\n",
                pn_offset, payload_length, token_length);