// Prepare the cipher context with the provided client secret and version.
quic_ciphers_init(&ciphers, client_secret, version);

// Calculate the packet number offset.
pn_offset = 1;

// Determine the length of the tokens and add it to the offset.
token_length = dest_conn_id_len + src_conn_id_len;
pn_offset += token_length;

// Retrieve the payload length from the packet, updating the packet number offset.
payload_length = pntoh32(packet->payload + pn_offset);
pn_offset += 4;

// Log the calculated offsets and lengths for debugging purposes.
NDPI_LOG_DBG2(ndpi_struct, "pn_offset %d token_length %d payload_length %d\n",
              pn_offset, token_length, payload_length);