if (version == DW_LINE_VERSION5 ||
    version == EXPERIMENTAL_LINE_TABLES_VERSION) {
    /* DWARF 5.  logicals table. */
    Dwarf_Unsigned logicals_format_count = 0;
    struct Dwarf_Unsigned_Pair_s * format_values = 0;
    Dwarf_Unsigned logicals_count = 0;
    Dwarf_Unsigned i = 0;
    Dwarf_Unsigned j = 0;
    int dres = 0;

    if (line_cursor >= line_ptr_end) {
        _dwarf_error(dbg, err, DW_DLE_LINE_NUMBER_HEADER_ERROR);
        return DW_DLV_ERROR;
    }
    logicals_format_count = *(unsigned char *) line_cursor;
    line_context->lc_logical_entry_format_count =
        logicals_format_count;
    line_cursor = line_cursor + sizeof(Dwarf_Small);
    if (logicals_format_count > 0) {
        format_values = malloc(
            sizeof(struct Dwarf_Unsigned_Pair_s) *
            logicals_format_count);
        if (format_values == NULL) {
            _dwarf_error(dbg, err, DW_DLE_ALLOC_FAIL);
            return DW_DLV_ERROR;
        }
        for (i = 0; i < logicals_format_count; i++) {
            dres = read_uword_de(&line_cursor,
                &format_values[i].up_first,
                dbg, err, line_ptr_end);
            if (dres!= DW_DLV_OK) {
                free(format_values);
                format_values = 0;
                return dres;
            }
            dres = read_uword_de(&line_cursor,
                &format_values[i].up_second,
                dbg, err, line_ptr_end);
            if (dres!= DW_DLV_OK) {
                free(format_values);
                format_values = 0;
                return dres;
            }
            /*  FIXME: what would be appropriate tests
                of this pair of values? */
        }
    }
    dres = read_uword_de(&line_cursor, &logicals_count,
        dbg, err, line_ptr_end);
    if (dres!= DW_DLV_OK) {
        free(format_values);
        format_values = 0;
        return dres;
    }
    if (logicals_count > total_length) {
        dwarfstring m;

        free(format_values);
        format_values = 0;
        dwarfstring_constructor(&m);
        dwarfstring_append_printf_u(&m,
            "DW_DLE_DEBUG_LINE_LENGTH_BAD "
            " the logicals count of "
            " this line table is too large at"
            " %" DW_PR_DUu  " bytes", logicals_count);
        _dwarf_error_string(dbg, err,
            DW_DLE_DEBUG_LINE_LENGTH_BAD,
            dwarfstring_string(&m));
        dwarfstring_destructor(&m);
        return DW_DLV_ERROR;
    }
    line_context->lc_logical_entry_count = logicals_count;
    line_context->lc_logical_entry_format_values = format_values;
    format_values = 0;
    line_context->lc_logical_entry_offset = line_cursor -
        dbg->de_debug_line.dss_data;
    line_cursor += sizeof(Dwarf_Small);
    if (line_cursor > line_ptr_end) {
        _dwarf_error(dbg, err, DW_DLE_LINE_OFFSET_BAD);
        return DW_DLV_ERROR;
    }
    line_context->lc_line_prologue_start = line_cursor;
    line_cursor += line_context->lc_prologue_length;
    if (line_cursor > line_ptr_end) {
        _dwarf_error(dbg, err, DW_DLE_LINE_OFFSET_BAD);
        return DW_DLV_ERROR;
    }
    line_context->lc_line_ptr_start = line_cursor;
    line_context->lc_line_ptr_end = line_ptr_end;
    line_context->lc_linebuf_logicals = malloc(
        sizeof(Dwarf_Line) * logicals_count);
    if (line_context->lc_linebuf_logicals == NULL) {
        _dwarf_error(dbg, err, DW_DLE_ALLOC_FAIL);
        return DW_DLV_ERROR;
    }
    memset(line_context->lc_linebuf_logicals, 0,
        sizeof(Dwarf_Line) * logicals_count);
    for (i = 0; i < logicals_count; i++) {
        line_context->lc_linebuf_logicals[i].li_context =
            line_context;
        line_context->lc_linebuf_logicals[i].li_is_actuals_table =
            FALSE;
    }
    line_context->lc_linecount_logicals = logicals_count;
}