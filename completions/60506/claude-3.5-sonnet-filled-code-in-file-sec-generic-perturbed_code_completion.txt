if (version == EXPERIMENTAL_LINE_TABLES_VERSION) {
    Dwarf_Small *expected_sequence = (Dwarf_Small *)"\0\0\0\0\0\0\0\0";
    if (memcmp(line_ptr, expected_sequence, 8) != 0) {
        _dwarf_error_string(dbg, error, DW_DLE_LINE_TABLE_BAD,
            "DW_DLE_LINE_TABLE_BAD: Invalid sequence for "
            "EXPERIMENTAL_LINE_TABLES_VERSION");
        if (curr_line) {
            dwarf_dealloc(dbg, curr_line, DW_DLA_LINE);
        }
        _dwarf_free_chain_entries(dbg, head_chain, line_count);
        return DW_DLV_ERROR;
    }
    line_ptr += 8;

    Dwarf_Unsigned logicals_table_offset;
    Dwarf_Unsigned actuals_table_offset;
    int res = _dwarf_read_unaligned_ck_wrapper(dbg,
        &logicals_table_offset, line_ptr, sizeof(Dwarf_Unsigned),
        line_ptr_end, error);
    if (res != DW_DLV_OK) {
        if (curr_line) {
            dwarf_dealloc(dbg, curr_line, DW_DLA_LINE);
        }
        _dwarf_free_chain_entries(dbg, head_chain, line_count);
        return res;
    }
    line_ptr += sizeof(Dwarf_Unsigned);

    res = _dwarf_read_unaligned_ck_wrapper(dbg,
        &actuals_table_offset, line_ptr, sizeof(Dwarf_Unsigned),
        line_ptr_end, error);
    if (res != DW_DLV_OK) {
        if (curr_line) {
            dwarf_dealloc(dbg, curr_line, DW_DLA_LINE);
        }
        _dwarf_free_chain_entries(dbg, head_chain, line_count);
        return res;
    }
    line_ptr += sizeof(Dwarf_Unsigned);

    line_context->lc_logicals_table_offset = logicals_table_offset;
    line_context->lc_actuals_table_offset = actuals_table_offset;

    if (line_ptr > line_ptr_end) {
        _dwarf_error_string(dbg, error, DW_DLE_LINE_TABLE_BAD,
            "DW_DLE_LINE_TABLE_BAD: Line pointer went past "
            "end of table in EXPERIMENTAL_LINE_TABLES_VERSION");
        if (curr_line) {
            dwarf_dealloc(dbg, curr_line, DW_DLA_LINE);
        }
        _dwarf_free_chain_entries(dbg, head_chain, line_count);
        return DW_DLV_ERROR;
    }
}