head_chain,
                        line_count);
                    if (curr_line) {
                        dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                        curr_line = 0;
                    }
                    return DW_DLV_ERROR;
                }
                curr_line->ld_line = regs.lr_line;
                curr_line->ld_address = regs.lr_address;
                curr_line->ld_is_stmt = regs.lr_is_stmt;
                curr_line->ld_basic_block = regs.lr_basic_block;
                curr_line->ld_end_sequence = regs.lr_end_sequence;
                curr_line->ld_prologue_end = regs.lr_prologue_end;
                curr_line->ld_epilogue_begin = regs.lr_epilogue_begin;
                curr_line->ld_isa = regs.lr_isa;
                curr_line->ld_discriminator = regs.lr_discriminator;
                curr_line->ld_file = cur_file_entry;
                curr_line->ld_line_context = line_context;
                curr_line->ld_next = NULL;
                if (chain_line) {
                    chain_line->dc_data = curr_line;
                    chain_line = chain_line->dc_next;
                } else {
                    head_chain = chain_line =
                        _dwarf_get_alloc(dbg,DW_DLA_CHAIN,1);
                    chain_line->dc_data = curr_line;
                    chain_line->dc_next = NULL;
                }
                line_count++;
            }
        } else if (type == LOP_ADVANCE_PC) {
            int oc = 0;
            int opcnt = line_context->lc_opcode_length_table[opcode];
            if (opcnt > 0) {
                /*  Read the operand. */
                int ocres = 0;
                Dwarf_Unsigned utmp2 = 0;

                ocres =  read_uword_de( &line_ptr,&utmp2,
                    dbg,error,line_ptr_end);
                if (ocres == DW_DLV_ERROR) {
                    _dwarf_free_chain_entries(dbg,head_chain,
                        line_count);
                    if (curr_line) {
                        dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                        curr_line = 0;
                    }
                    return DW_DLV_ERROR;
                }
                if (line_context->lc_maximum_ops_per_instruction < 2) {
                    regs.lr_address = regs.lr_address +
                        (utmp2 *
                        line_context->lc_minimum_instruction_length);
                } else {
                    regs.lr_address = regs.lr_address +
                        (line_context->lc_minimum_instruction_length *
                        ((regs.lr_op_index + utmp2)/
                        line_context->lc_maximum_ops_per_instruction));
                    regs.lr_op_index =
                        (regs.lr_op_index +utmp2)%
                        line_context->lc_maximum_ops_per_instruction;
                }
#ifdef PRINTING_DETAILS
                {
                dwarfstring m9c;
                dwarfstring_constructor(&m9c);
                dwarfstring_append_printf_u(&m9c,
                    " %" DW_PR_DUu,
                    utmp2);
                dwarfstring_append_printf_u(&m9c,
                    " (0x%" DW_PR_XZEROS DW_PR_DUx ")",
                    utmp2);
                _dwarf_printf(dbg,dwarfstring_string(&m9c));
                dwarfstring_destructor(&m9c);
                }
#endif /* PRINTING_DETAILS */
            }
#ifdef PRINTING_DETAILS
            _dwarf_printf(dbg,"***\n");
#endif /* PRINTING_DETAILS */
        } else if (type == LOP_ADVANCE_LINE) {
            int oc = 0;
            int opcnt = line_context->lc_opcode_length_table[opcode];
            if (opcnt > 0) {
                /*  Read the operand. */
                int ocres = 0;
                Dwarf_Signed stmp2 = 0;

                ocres =  read_sword_de( &line_ptr,&stmp2,
                    dbg,error,line_ptr_end);
                if (ocres == DW_DLV_ERROR) {
                    _dwarf_free_chain_entries(dbg,head_chain,
                        line_count);
                    if (curr_line) {
                        dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                        curr_line = 0;
                    }
                    return DW_DLV_ERROR;
                }
                advance_line = stmp2;
                regs.lr_line = regs.lr_line + advance_line;
#ifdef PRINTING_DETAILS
                {
                dwarfstring m9d;
                dwarfstring_constructor(&m9d);
                dwarfstring_append_printf_i(&m9d,
                    " %" DW_PR_DSd,
                    stmp2);
                _dwarf_printf(dbg,dwarfstring_string(&m9d));
                dwarfstring_destructor(&m9d);
                }
#endif /* PRINTING_DETAILS */
            }
#ifdef PRINTING_DETAILS
            _dwarf_printf(dbg,"***\n");
#endif /* PRINTING_DETAILS */
        } else if (type == LOP_SET_FILE) {
            int oc = 0;
            int opcnt = line_context->lc_opcode_length_table[opcode];
            if (opcnt > 0) {
                /*  Read the operand. */
                int ocres = 0;
                Dwarf_Unsigned utmp2 = 0;

                ocres =  read_uword_de( &line_ptr,&utmp2,
                    dbg,error,line_ptr_end);
                if (ocres == DW_DLV_ERROR) {
                    _dwarf_free_chain_entries(dbg,head_chain,
                        line_count);
                    if (curr_line) {
                        dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                        curr_line = 0;
                    }
                    return DW_DLV_ERROR;
                }
                if (utmp2 >= line_context->lc_file_count) {
                    _dwarf_error(dbg, error, DW_DLE_FILE_INDEX_BAD);
                    _dwarf_free_chain_entries(dbg,head_chain,
                        line_count);
                    if (curr_line) {
                        dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                        curr_line = 0;
                    }
                    return DW_DLV_ERROR;
                }
                cur_file_entry = line_context->lc_file_entries[utmp2];
#ifdef PRINTING_DETAILS
                {
                dwarfstring m9f;
                dwarfstring_constructor(&m9f);
                dwarfstring_append_printf_u(&m9f,
                    " %" DW_PR_DUu,
                    utmp2);
                dwarfstring_append_printf_u(&m9f,
                    " (0x%" DW_PR_XZEROS DW_PR_DUx ")",
                    utmp2);
                _dwarf_printf(dbg,dwarfstring_string(&m9f));
                dwarfstring_destructor(&m9f);
                }
#endif /* PRINTING_DETAILS */
            }
#ifdef PRINTING_DETAILS
            _dwarf_printf(dbg,"***\n");
#endif /* PRINTING_DETAILS */
        } else if (type == LOP_SET_COLUMN) {
            int oc = 0;
            int opcnt = line_context->lc_opcode_length_table[opcode];
            if (opcnt > 0) {
                /*  Read the operand. */
                int ocres = 0;
                Dwarf_Unsigned utmp2 = 0;

                ocres =  read_uword_de( &line_ptr,&utmp2,
                    dbg,error,line_ptr_end);
                if (ocres == DW_DLV_ERROR) {
                    _dwarf_free_chain_entries(dbg,head_chain,
                        line_count);
                    if (curr_line) {
                        dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                        curr_line = 0;
                    }
                    return DW_DLV_ERROR;
                }
                regs.lr_column = utmp2;
#ifdef PRINTING_DETAILS
                {
                dwarfstring m9g;
                dwarfstring_constructor(&m9g);
                dwarfstring_append_printf_u(&m9g,
                    " %" DW_PR_DUu,
                    utmp2);
                dwarfstring_append_printf_u(&m9g,
                    " (0x%" DW_PR_XZEROS DW_PR_DUx ")",
                    utmp2);
                _dwarf_printf(dbg,dwarfstring_string(&m9g));
                dwarfstring_destructor(&m9g);
                }
#endif /* PRINTING_DETAILS */
            }
#ifdef PRINTING_DETAILS
            _dwarf_printf(dbg,"***\n");
#endif /* PRINTING_DETAILS */
        } else if (type == LOP_SET_PROLOGUE_END) {
            regs.lr_prologue_end = TRUE;
#ifdef PRINTING_DETAILS
            _dwarf_printf(dbg,"***\n");
#endif /* PRINTING_DETAILS */
        } else if (type == LOP_SET_EPILOGUE_BEGIN) {
            regs.lr_epilogue_begin = TRUE;
#ifdef PRINTING_DETAILS
            _dwarf_printf(dbg,"***\n");
#endif /* PRINTING_DETAILS */
        } else if (type == LOP_SET_ISA) {
            int oc = 0;
            int opcnt = line_context->lc_opcode_length_table[opcode];
            if (opcnt > 0) {
                /*  Read the operand. */
                int ocres = 0;
                Dwarf_Unsigned utmp2 = 0;

                ocres =  read_uword_de( &line_ptr,&utmp2,
                    dbg,error,line_ptr_end);
                if (ocres == DW_DLV_ERROR) {
                    _dwarf_free_chain_entries(dbg,head_chain,
                        line_count);
                    if (curr_line) {
                        dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                        curr_line = 0;
                    }
                    return DW_DLV_ERROR;
                }
                regs.lr_isa = utmp2;
#ifdef PRINTING_DETAILS
                {
                dwarfstring m9h;
                dwarfstring_constructor(&m9h);
                dwarfstring_append_printf_u(&m9h,
                    " %" DW_PR_DUu,
                    utmp2);
                dwarfstring_append_printf_u(&m9h,
                    " (0x%" DW_PR_XZEROS DW_PR_DUx ")",
                    utmp2);
                _dwarf_printf(dbg,dwarfstring_string(&m9h));
                dwarfstring_destructor(&m9h);
                }
#endif /* PRINTING_DETAILS */
            }
#ifdef PRINTING_DETAILS
            _dwarf_printf(dbg,"***\n");
#endif /* PRINTING_DETAILS */
        } else if (type == LOP_END_SEQUENCE) {
            if (regs.lr_end_sequence) {
                _dwarf_error(dbg, error, DW_DLE_LINE_SEQUENCE_ERROR);
                _dwarf_free_chain_entries(dbg,head_chain,
                    line_count);
                if (curr_line) {
                    dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                    curr_line = 0;
                }
                return DW_DLV_ERROR;
            }
            regs.lr_end_sequence = TRUE;
#ifdef PRINTING_DETAILS
            _dwarf_printf(dbg,"***\n");
#endif /* PRINTING_DETAILS */
        } else if (type == LOP_CONSTANT) {
            int oc = 0;
            int opcnt = line_