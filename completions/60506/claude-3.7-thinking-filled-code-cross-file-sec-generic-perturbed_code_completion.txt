if (version == EXPERIMENTAL_LINE_TABLES_VERSION) {
    int res = 0;
    Dwarf_Unsigned logicals_table_offset = 0;
    Dwarf_Unsigned actuals_table_offset = 0;
    
    /* Check for the expected pattern of bytes */
    if (line_cursor >= line_ptr_end) {
        _dwarf_error(dbg, err, DW_DLE_LINE_NUMBER_HEADER_ERROR);
        return DW_DLV_ERROR;
    }
    
    /* Read the logicals table offset */
    res = _dwarf_read_unaligned_ck_wrapper(dbg, 
        &logicals_table_offset, line_cursor, 
        local_length_size, line_ptr_end, err);
    if (res != DW_DLV_OK) {
        return res;
    }
    
    if (logicals_table_offset > total_length) {
        dwarfstring m;
        dwarfstring_constructor(&m);
        dwarfstring_append_printf_u(&m,
            "DW_DLE_DEBUG_LINE_LENGTH_BAD "
            "the logicals table offset of "
            "this line table is too large at "
            "%" DW_PR_DUu " bytes", logicals_table_offset);
        _dwarf_error_string(dbg, err, DW_DLE_DEBUG_LINE_LENGTH_BAD,
            dwarfstring_string(&m));
        dwarfstring_destructor(&m);
        return DW_DLV_ERROR;
    }
    
    line_cursor += local_length_size;
    
    /* Read the actuals table offset */
    if (line_cursor >= line_ptr_end) {
        _dwarf_error(dbg, err, DW_DLE_LINE_NUMBER_HEADER_ERROR);
        return DW_DLV_ERROR;
    }
    
    res = _dwarf_read_unaligned_ck_wrapper(dbg, 
        &actuals_table_offset, line_cursor, 
        local_length_size, line_ptr_end, err);
    if (res != DW_DLV_OK) {
        return res;
    }
    
    if (actuals_table_offset > total_length) {
        dwarfstring m;
        dwarfstring_constructor(&m);
        dwarfstring_append_printf_u(&m,
            "DW_DLE_DEBUG_LINE_LENGTH_BAD "
            "the actuals table offset of "
            "this line table is too large at "
            "%" DW_PR_DUu " bytes", actuals_table_offset);
        _dwarf_error_string(dbg, err, DW_DLE_DEBUG_LINE_LENGTH_BAD,
            dwarfstring_string(&m));
        dwarfstring_destructor(&m);
        return DW_DLV_ERROR;
    }
    
    line_cursor += local_length_size;
    
    /* Store the offsets in the line context */
    line_context->lc_logicals_table_offset = logicals_table_offset;
    line_context->lc_actuals_table_offset = actuals_table_offset;
    
#ifdef PRINTING_DETAILS
    {
    dwarfstring m;
    dwarfstring_constructor(&m);
    dwarfstring_append_printf_u(&m,
        "  logicals table offset "
        "0x%" DW_PR_XZEROS DW_PR_DUx "\n",
        logicals_table_offset);
    dwarfstring_append_printf_u(&m,
        "  actuals table offset "
        "0x%" DW_PR_XZEROS DW_PR_DUx "\n",
        actuals_table_offset);
    _dwarf_printf(dbg, dwarfstring_string(&m));
    dwarfstring_destructor(&m);
    }
#endif /* PRINTING_DETAILS */
    
    /* Ensure we haven't exceeded the line ptr end */
    if (line_cursor > line_ptr_end) {
        _dwarf_error(dbg, err, DW_DLE_LINE_OFFSET_BAD);
        return DW_DLV_ERROR;
    }
}