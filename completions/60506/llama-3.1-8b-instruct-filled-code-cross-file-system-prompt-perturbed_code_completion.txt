if (version == DW_LINE_VERSION5 ||
    version == EXPERIMENTAL_LINE_TABLES_VERSION) {
    /* DWARF 5.  logicals table. */
    Dwarf_Unsigned logicals_format_count = 0;
    struct Dwarf_Unsigned_Pair_s * format_values = 0;
    Dwarf_Unsigned logicals_count = 0;
    Dwarf_Unsigned i = 0;
    Dwarf_Unsigned j = 0;
    int dres = 0;

    if (line_cursor >= line_ptr_end) {
        _dwarf_error(dbg, err, DW_DLE_LINE_NUMBER_HEADER_ERROR);
        return DW_DLV_ERROR;
    }
    logicals_format_count = *(unsigned char *) line_cursor;
    line_context->lc_logical_entry_format_count =
        logicals_format_count;
    line_cursor = line_cursor + sizeof(Dwarf_Small);
    if (logicals_format_count > 0) {
        format_values = malloc(
            sizeof(struct Dwarf_Unsigned_Pair_s) *
            logicals_format_count);
        if (format_values == NULL) {
            _dwarf_error(dbg, err, DW_DLE_ALLOC_FAIL);
            return DW_DLV_ERROR;
        }
        for (i = 0; i < logicals_format_count; i++) {
            dres = read_uword_de(&line_cursor,
                &format_values[i].up_first,
                dbg, err, line_ptr_end);
            if (dres!= DW_DLV_OK) {
                free(format_values);
                return dres;
            }
            dres = read_uword_de(&line_cursor,
                &format_values[i].up_second,
                dbg, err, line_ptr_end);
            if (dres!= DW_DLV_OK) {
                free(format_values);
                return dres;
            }
            /*  FIXME: what would be appropriate tests
                of this pair of values? */
        }
    }
    dres = read_uword_de(&line_cursor, &logicals_count,
        dbg, err, line_ptr_end);
    if (dres!= DW_DLV_OK) {
        free(format_values);
        return dres;
    }
    if (logicals_count > total_length) {
        dwarfstring m;

        free(format_values);
        format_values = 0;
        dwarfstring_constructor(&m);
        dwarfstring_append_printf_u(&m,
            "DW_DLE_DEBUG_LINE_LENGTH_BAD "
            " the logicals count of "
            " this line table is too large at"
            " %" DW_PR_DUu  " bytes", logicals_count);
        _dwarf_error_string(dbg, err,
            DW_DLE_DEBUG_LINE_LENGTH_BAD,
            dwarfstring_string(&m));
        dwarfstring_destructor(&m);
        return DW_DLV_ERROR;
    }
    line_context->lc_logical_entry_format_values =
        format_values;
    format_values = 0;
    line_context->lc_logical_entry_count = logicals_count;
    for (i = 0; i < logicals_count; i++) {
        Dwarf_File_Entry curline = 0;
        curline = (Dwarf_File_Entry)
            malloc(sizeof(struct Dwarf_File_Entry_s));
        if (curline == NULL) {
            _dwarf_error(dbg, err, DW_DLE_ALLOC_FAIL);
            return DW_DLV_ERROR;
        }
        memset(curline, 0, sizeof(*curline));
        _dwarf_add_to_files_list(line_context, curline);
        for (j = 0; j < logicals_format_count; j++) {
            Dwarf_Unsigned lntype =
                format_values[j].up_first;
            Dwarf_Unsigned lnform =
                format_values[j].up_second;
            switch (lntype) {
            case DW_LNCT_path: {
                res = _dwarf_decode_line_string_form(dbg,
                    lntype, lnform,
                    local_length_size,
                    &line_cursor,
                    line_ptr_end,
                    (char **)&curline->fi_file_name,
                    err);
                if (res!= DW_DLV_OK) {
                    free(format_values);
                    return res;
                }
                }
                break;
            default:
                free(format_values);
                _dwarf_error(dbg, err,
                    DW_DLE_LINE_NUMBER_HEADER_ERROR);
                return DW_DLV_ERROR;
            }
            if (line_cursor > line_ptr_end) {
                free(format_values);
                _dwarf_error(dbg, err,
                    DW_DLE_LINE_NUMBER_HEADER_ERROR);
                return DW_DLV_ERROR;
            }
        }
    }
    line_context->lc_logical_entry_count = logicals_count;
}