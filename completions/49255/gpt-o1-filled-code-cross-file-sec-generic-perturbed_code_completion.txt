if (mpzptr->sn == 0) {
  /* zero */
  i = 0;
}
else if (mpzptr->sz != 1) {
  /* more than one limb in use, cannot fit into mrb_int */
  return FALSE;
}
else {
  mp_limb val = mpzptr->p[0];
  if (mpzptr->sn > 0) {
    /* positive number */
    if (val > (mp_limb)MRB_INT_MAX) {
      return FALSE;
    }
    i = (mrb_int)val;
  }
  else {
    /* negative number */
    if (val > (mp_limb)(-((mrb_int)MRB_INT_MIN + 1)) + 1) {
      return FALSE;
    }
    i = -(mrb_int)val;
  }
}