default:
    if (s->picture_structure == PICT_FRAME) {
        if (s->mv_type == MV_TYPE_FIELD) {
            // Field motion vectors
            for (int i = 0; i < 2; i++) {
                mpeg_motion_lowres(s, dest_y, dest_cb, dest_cr,
                                   i, i, i,
                                   ref_picture, pix_op,
                                   s->mv[dir][i][0], s->mv[dir][i][1],
                                   block_s, macroblocky);
            }
        } else if (s->mv_type == MV_TYPE_16X8) {
            // 16x8 motion vectors
            for (int i = 0; i < 2; i++) {
                mpeg_motion_lowres(s, dest_y + i * s->linesize * block_s,
                                   dest_cb + i * s->uvlinesize * block_s,
                                   dest_cr + i * s->uvlinesize * block_s,
                                   0, i, 0,
                                   ref_picture, pix_op,
                                   s->mv[dir][i][0], s->mv[dir][i][1],
                                   block_s, macroblocky + i);
            }
        } else if (s->mv_type == MV_TYPE_DMV) {
            // Dual-prime motion vectors
            for (int i = 0; i < 2; i++) {
                int dxy, mx, my, src_x, src_y;
                uint8_t *ptr;

                dxy = (s->mv[dir][i][0] & 3) | ((s->mv[dir][i][1] & 3) << 2);
                mx = s->mv[dir][i][0] >> 2;
                my = s->mv[dir][i][1] >> 2;

                src_x = s->mb_x * block_s + (mx >> lowres);
                src_y = (macroblocky + i) * block_s + (my >> lowres);
                ptr = ref_picture[0] + (src_y * s->linesize) + src_x;

                s->vdsp.put_mpeg4_qpel_pixels_tab[1][dxy](dest_y + i * s->linesize * block_s,
                                                          ptr, s->linesize, block_s);

                if (!CONFIG_GRAY || !(s->avctx->flags & AV_CODEC_FLAG_GRAY)) {
                    src_x = s->mb_x * block_s / 2 + (mx >> (lowres + 1));
                    src_y = ((macroblocky + i) * block_s) / 2 + (my >> (lowres + 1));
                    ptr = ref_picture[1] + (src_y * s->uvlinesize) + src_x;
                    s->hdsp.put_pixels_tab[1][dxy](dest_cb + i * s->uvlinesize * block_s,
                                                  ptr, s->uvlinesize, block_s / 2);
                    ptr = ref_picture[2] + (src_y * s->uvlinesize) + src_x;
                    s->hdsp.put_pixels_tab[1][dxy](dest_cr + i * s->uvlinesize * block_s,
                                                  ptr, s->uvlinesize, block_s / 2);
                }
            }
        } else {
            av_assert2(0);
        }
    } else {
        // Field picture
        mpeg_motion_lowres(s, dest_y, dest_cb, dest_cr,
                           s->picture_structure - 1, s->picture_structure - 1, dir,
                           ref_picture, pix_op,
                           s->mv[dir][0][0], s->mv[dir][0][1],
                           block_s, macroblocky);
    }
    break;