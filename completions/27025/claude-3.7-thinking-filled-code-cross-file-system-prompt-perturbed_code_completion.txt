(m->type == FLB_CONFIG_MAP_STR) {
    entry->val.str = flb_sds_create(kv->val);
    if (!entry->val.str) {
        flb_errno();
        flb_free(entry);
        return -1;
    }
}
else if (m->type == FLB_CONFIG_MAP_INT) {
    entry->val.i_num = atoi(kv->val);
}
else if (m->type == FLB_CONFIG_MAP_DOUBLE) {
    entry->val.d_num = atof(kv->val);
}
else if (m->type == FLB_CONFIG_MAP_SIZE) {
    entry->val.s_num = flb_utils_size_to_bytes(kv->val);
}
else if (m->type == FLB_CONFIG_MAP_TIME) {
    entry->val.i_num = flb_utils_time_to_seconds(kv->val);
}
else if (m->type == FLB_CONFIG_MAP_BOOL) {
    ret = flb_utils_bool(kv->val);
    if (ret == -1) {
        flb_error("[config map] invalid value for boolean property '%s=%s'",
                  m->name, kv->val);
        flb_free(entry);
        return -1;
    }
    entry->val.boolean = ret;
}
else if (m->type >= FLB_CONFIG_MAP_CLIST && 
         m->type <= FLB_CONFIG_MAP_SLIST_4) {
    list = parse_string_map_to_list(m, kv->val);
    if (!list) {
        flb_error("[config map] cannot parse list of values '%s'", kv->val);
        flb_free(entry);
        return -1;
    }
    entry->val.list = list;
    
    /* Check list entries */
    if (m->type >= FLB_CONFIG_MAP_CLIST_1 && 
        m->type <= FLB_CONFIG_MAP_CLIST_4) {
        numentries = mk_list_size(list);
        if (m->type == FLB_CONFIG_MAP_CLIST_1 && numentries != 1) {
            flb_error("[config map] %s requires exactly 1 value", m->name);
            destroy_map_val(m->type, &entry->val);
            flb_free(entry);
            return -1;
        }
        else if (m->type == FLB_CONFIG_MAP_CLIST_2 && numentries != 2) {
            flb_error("[config map] %s requires exactly 2 values", m->name);
            destroy_map_val(m->type, &entry->val);
            flb_free(entry);
            return -1;
        }
        else if (m->type == FLB_CONFIG_MAP_CLIST_3 && numentries != 3) {
            flb_error("[config map] %s requires exactly 3 values", m->name);
            destroy_map_val(m->type, &entry->val);
            flb_free(entry);
            return -1;
        }
        else if (m->type == FLB_CONFIG_MAP_CLIST_4 && numentries != 4) {
            flb_error("[config map] %s requires exactly 4 values", m->name);
            destroy_map_val(m->type, &entry->val);
            flb_free(entry);
            return -1;
        }
    }
    else if (m->type >= FLB_CONFIG_MAP_SLIST_1 && 
             m->type <= FLB_CONFIG_MAP_SLIST_4) {
        numentries = mk_list_size(list);
        if (m->type == FLB_CONFIG_MAP_SLIST_1 && numentries != 1) {
            flb_error("[config map] %s requires exactly 1 value", m->name);
            destroy_map_val(m->type, &entry->val);
            flb_free(entry);
            return -1;
        }
        else if (m->type == FLB_CONFIG_MAP_SLIST_2 && numentries != 2) {
            flb_error("[config map] %s requires exactly 2 values", m->name);
            destroy_map_val(m->type, &entry->val);
            flb_free(entry);
            return -1;
        }
        else if (m->type == FLB_CONFIG_MAP_SLIST_3 && numentries != 3) {
            flb_error("[config map] %s requires exactly 3 values", m->name);
            destroy_map_val(m->type, &entry->val);
            flb_free(entry);
            return -1;
        }
        else if (m->type == FLB_CONFIG_MAP_SLIST_4 && numentries != 4) {
            flb_error("[config map] %s requires exactly 4 values", m->name);
            destroy_map_val(m->type, &entry->val);
            flb_free(entry);
            return -1;
        }
    }
}