current_image->columns-1; x >= 0; x--)
                     {
                        SetPixelRed(current_image,ScaleShortToQuantum(
                          GetPixelRed(current_image,q)),q);
                        SetPixelGreen(current_image,ScaleShortToQuantum(
                          GetPixelGreen(current_image,q)),q);
                        SetPixelBlue(current_image,ScaleShortToQuantum(
                          GetPixelBlue(current_image,q)),q);
                        SetPixelAlpha(current_image,ScaleShortToQuantum(
                          GetPixelAlpha(current_image,q)),q);
                        q+=GetPixelChannels(current_image);
                     }

                     if (SyncAuthenticPixels(current_image,exception) == MagickFalse)
                       break;
                   }
                }
#endif
              if (logging != MagickFalse)
                (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                  "  Magnification complete");

              mng_info->magn_methx=0;
              mng_info->magn_methy=0;
              mng_info->magn_mx=0;
              mng_info->magn_my=0;
              mng_info->magn_ml=0;
              mng_info->magn_mr=0;
              mng_info->magn_mt=0;
              mng_info->magn_mb=0;
            }
          }
        }
        if (mng_info->have_global_bkgd)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global background color");

            if (current_image->background_color.red !=
                mng_info->mng_global_bkgd.red)
              current_image->background_color.red=
                mng_info->mng_global_bkgd.red;

            if (current_image->background_color.green !=
                mng_info->mng_global_bkgd.green)
              current_image->background_color.green=
                mng_info->mng_global_bkgd.green;

            if (current_image->background_color.blue !=
                mng_info->mng_global_bkgd.blue)
              current_image->background_color.blue=
                mng_info->mng_global_bkgd.blue;

            if (current_image->background_color.alpha !=
                mng_info->mng_global_bkgd.alpha)
              current_image->background_color.alpha=
                mng_info->mng_global_bkgd.alpha;
          }

        if (mng_info->have_global_gama)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global gamma");

            current_image->gamma=mng_info->global_gamma;
          }

        if (mng_info->have_global_chrm)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global chromaticity");

            current_image->chromaticity=mng_info->global_chrm;
          }

        if (mng_info->have_global_srgb)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global sRGB");

            current_image->rendering_intent=
              Magick_RenderingIntent_from_PNG_RenderingIntent(
                mng_info->global_srgb_intent);
          }

        if (mng_info->have_global_sbit)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global sBIT");

            current_image->significant_bits= mng_info->global_sbit;
          }

        if (mng_info->have_global_phys)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global physical dimensions");

            current_image->x_resolution=mng_info->global_x_pixels_per_unit;
            current_image->y_resolution=mng_info->global_y_pixels_per_unit;
            current_image->units=mng_info->global_phys_unit_type;
          }

        if (logging != MagickFalse)
          (void) LogMagickEvent(CoderEvent,GetMagickModule(),
            "  Have global background color");

        if (mng_info->have_global_bkgd)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global background color");

            current_image->background_color=
              mng_info->mng_global_bkgd;
          }

        if (mng_info->have_global_trns)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global transparency");

            current_image->transparency=mng_info->global_trns;
          }

        if (mng_info->have_global_plte)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global palette");

            current_image->colors=mng_info->global_plte_length;
            current_image->colormap=mng_info->global_plte;
          }

        if (logging != MagickFalse)
          (void) LogMagickEvent(CoderEvent,GetMagickModule(),
            "  Have global background color");

        if (mng_info->have_global_bkgd)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global background color");

            current_image->background_color=
              mng_info->mng_global_bkgd;
          }

        if (mng_info->have_global_trns)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global transparency");

            current_image->transparency=mng_info->global_trns;
          }

        if (mng_info->have_global_plte)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global palette");

            current_image->colors=mng_info->global_plte_length;
            current_image->colormap=mng_info->global_plte;
          }

        if (logging != MagickFalse)
          (void) LogMagickEvent(CoderEvent,GetMagickModule(),
            "  Have global background color");

        if (mng_info->have_global_bkgd)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global background color");

            current_image->background_color=
              mng_info->mng_global_bkgd;
          }

        if (mng_info->have_global_trns)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global transparency");

            current_image->transparency=mng_info->global_trns;
          }

        if (mng_info->have_global_plte)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global palette");

            current_image->colors=mng_info->global_plte_length;
            current_image->colormap=mng_info->global_plte;
          }

        if (logging != MagickFalse)
          (void) LogMagickEvent(CoderEvent,GetMagickModule(),
            "  Have global background color");

        if (mng_info->have_global_bkgd)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global background color");

            current_image->background_color=
              mng_info->mng_global_bkgd;
          }

        if (mng_info->have_global_trns)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global transparency");

            current_image->transparency=mng_info->global_trns;
          }

        if (mng_info->have_global_plte)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global palette");

            current_image->colors=mng_info->global_plte_length;
            current_image->colormap=mng_info->global_plte;
          }

        if (logging != MagickFalse)
          (void) LogMagickEvent(CoderEvent,GetMagickModule(),
            "  Have global background color");

        if (mng_info->have_global_bkgd)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global background color");

            current_image->background_color=
              mng_info->mng_global_bkgd;
          }

        if (mng_info->have_global_trns)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global transparency");

            current_image->transparency=mng_info->global_trns;
          }

        if (mng_info->have_global_plte)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global palette");

            current_image->colors=mng_info->global_plte_length;
            current_image->colormap=mng_info->global_plte;
          }

        if (logging != MagickFalse)
          (void) LogMagickEvent(CoderEvent,GetMagickModule(),
            "  Have global background color");

        if (mng_info->have_global_bkgd)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global background color");

            current_image->background_color=
              mng_info->mng_global_bkgd;
          }

        if (mng_info->have_global_trns)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global transparency");

            current_image->transparency=mng_info->global_trns;
          }

        if (mng_info->have_global_plte)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global palette");

            current_image->colors=mng_info->global_plte_length;
            current_image->colormap=mng_info->global_plte;
          }

        if (logging != MagickFalse)
          (void) LogMagickEvent(CoderEvent,GetMagickModule(),
            "  Have global background color");

        if (mng_info->have_global_bkgd)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global background color");

            current_image->background_color=
              mng_info->mng_global_bkgd;
          }

        if (mng_info->have_global_trns)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global transparency");

            current_image->transparency=mng_info->global_trns;
          }

        if (mng_info->have_global_plte)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global palette");

            current_image->colors=mng_info->global_plte_length;
            current_image->colormap=mng_info->global_plte;
          }

        if (logging != MagickFalse)
          (void) LogMagickEvent(CoderEvent,GetMagickModule(),
            "  Have global background color");

        if (mng_info->have_global_bkgd)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global background color");

            current_image->background_color=
              mng_info->mng_global_bkgd;
          }

        if (mng_info->have_global_trns)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global transparency");

            current_image->transparency=mng_info->global_trns;
          }

        if (mng_info->have_global_plte)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global palette");

            current_image->colors=mng_info->global_plte_length;
            current_image->colormap=mng_info->global_plte;
          }

        if (logging != MagickFalse)
          (void) LogMagickEvent(CoderEvent,GetMagickModule(),
            "  Have global background color");

        if (mng_info->have_global_bkgd)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global background color");

            current_image->background_color=
              mng_info->mng_global_bkgd;
          }

        if (mng_info->have_global_trns)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global transparency");

            current_image->transparency=mng_info->global_trns;
          }

        if (mng_info->have_global_plte)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Have global palette");

            current_image->colors=mng_info->global_plte_length;