if (!k->via.str.ptr) {
    if (mp_buf) {
        flb_free(mp_buf);
    }
    *out_buf = NULL;
    msgpack_unpacked_destroy(&unpacked_data);
    return -1;
}

if (k->via.str.size != (size_t) slen) {
    continue;
}