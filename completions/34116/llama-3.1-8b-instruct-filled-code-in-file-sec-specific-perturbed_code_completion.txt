// Check if the current key's size matches the expected time key size.
// If not, continue to the next key-value pair in the map.
// Ensure the key's pointer is not NULL before accessing it.
// If the pointer is NULL, free allocated resources, set the output buffer to NULL,
// destroy the unpacked message, and return an error.
if (k && strncmp(k->via.str.ptr, time_key, k->via.str.size) == 0) {
    /* We found the key, break the loop and keep the index */
    if (parser->time_keep == FLB_FALSE) {
        skip = i;
        break;
    }
    else {
        skip = -1;
    }
    break;
}
else {
    if (mp_buf!= tmp_out_buf) {
        flb_free(mp_buf);
    }
    *out_buf = NULL;
    msgpack_unpacked_destroy(&unpacked_data);
    return -1;
}