// Check if the key is a string and its size matches the expected time key size
        if (k->type != MSGPACK_OBJECT_STR || k->via.str.size != slen) {
            continue;
        }

        // Ensure the key's pointer is not NULL before accessing it
        if (k->via.str.ptr == NULL) {
            flb_free(mp_buf);
            *out_buf = NULL;
            msgpack_unpacked_destroy(&unpacked_data);
            return -1;
        }