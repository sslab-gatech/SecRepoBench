switch (v->type) {
    case MSGPACK_OBJECT_BOOLEAN:
        str_size = snprintf(str, sizeof(str), "%s", v->via.boolean? "true" : "false");
        break;
    case MSGPACK_OBJECT_POSITIVE_INTEGER:
    case MSGPACK_OBJECT_NEGATIVE_INTEGER:
        str_size = snprintf(str, sizeof(str), "%lld", v->via.i64);
        break;
    case MSGPACK_OBJECT_FLOAT:
        str_size = snprintf(str, sizeof(str), "%f", v->via.f64);
        break;
    case MSGPACK_OBJECT_STR:
        str_size = v->via.str.size;
        memcpy(str, v->via.str.ptr, str_size);
        str[str_size] = '\0';
        break;
    case MSGPACK_OBJECT_NIL:
        str_size = snprintf(str, sizeof(str), "null");
        break;
    default:
        *found = FLB_FALSE;
        return buf;
}

if (str_size >= sizeof(str)) {
    *found = FLB_FALSE;
    return buf;
}

js = flb_sds_cat(buf, str);
if (!js) {
    *found = FLB_FALSE;
    return buf;
}

tmp = js;