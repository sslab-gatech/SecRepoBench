switch (v->type) {
        case MSGPACK_OBJECT_BOOLEAN:
            str_size = snprintf(str, sizeof(str), "%d", v->value.as Boolean);
            break;
        case MSGPACK_OBJECT_POSITIVE_INTEGER:
        case MSGPACK_OBJECT_NEGATIVE_INTEGER:
            str_size = snprintf(str, sizeof(str), "%lld", v->value.as Integer);
            break;
        case MSGPACK_OBJECT_FLOAT:
            str_size = snprintf(str, sizeof(str), "%g", v->value.as Float);
            break;
        case MSGPACK_OBJECT_STR:
            str_size = snprintf(str, sizeof(str), "%s", v->value.as String.ptr);
            break;
        case MSGPACK_OBJECT_ARRAY:
        case MSGPACK_OBJECT_MAP:
            str_size = snprintf(str, sizeof(str), "[%s]", v->value.as Map.ptr);
            break;
        case MSGPACK_OBJECT_NULL:
            str_size = snprintf(str, sizeof(str), "null");
            break;
        default:
            str_size = snprintf(str, sizeof(str), "unknown");
            break;
    }

    if (str_size >= sizeof(str)) {
        tmp = flb_sds_create_size(str_size + 1);
        if (tmp) {
            snprintf(tmp, str_size + 1, "%s", str);
        }
    } else {
        tmp = flb_sds_create(str);
        if (tmp) {
            snprintf(tmp, str_size + 1, "%s", str);
        }
    }

    if (tmp) {
        buf = flb_sds_cat(buf, tmp);
        flb_sds_destroy(tmp);
    }