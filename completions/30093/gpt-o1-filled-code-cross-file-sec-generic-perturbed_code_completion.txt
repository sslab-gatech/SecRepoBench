tmp = buf;

    switch (v->type) {
    case FLB_RA_BOOL:
        if (v->val.boolean) {
            tmp = flb_sds_cat_safe(tmp, "true", 4);
        }
        else {
            tmp = flb_sds_cat_safe(tmp, "false", 5);
        }
        if (!tmp) {
            flb_ra_key_value_destroy(v);
            return NULL;
        }
        break;

    case FLB_RA_INT:
    {
        int len = snprintf(str, sizeof(str), "%" PRId64, v->val.i64);
        if (len < 0) {
            flb_ra_key_value_destroy(v);
            return NULL;
        }
        tmp = flb_sds_cat_safe(tmp, str, len);
        if (!tmp) {
            flb_ra_key_value_destroy(v);
            return NULL;
        }
        break;
    }

    case FLB_RA_FLOAT:
    {
        int len = snprintf(str, sizeof(str), "%g", v->val.f64);
        if (len < 0) {
            flb_ra_key_value_destroy(v);
            return NULL;
        }
        tmp = flb_sds_cat_safe(tmp, str, len);
        if (!tmp) {
            flb_ra_key_value_destroy(v);
            return NULL;
        }
        break;
    }

    case FLB_RA_STRING:
        tmp = flb_sds_cat_safe(tmp, v->val.sds, flb_sds_len(v->val.sds));
        if (!tmp) {
            flb_ra_key_value_destroy(v);
            return NULL;
        }
        break;

    case FLB_RA_NULL:
        tmp = flb_sds_cat_safe(tmp, "null", 4);
        if (!tmp) {
            flb_ra_key_value_destroy(v);
            return NULL;
        }
        break;

    default:
        /* fallback for any unrecognized type */
        tmp = flb_sds_cat_safe(tmp, "null", 4);
        if (!tmp) {
            flb_ra_key_value_destroy(v);
            return NULL;
        }
        break;
    }