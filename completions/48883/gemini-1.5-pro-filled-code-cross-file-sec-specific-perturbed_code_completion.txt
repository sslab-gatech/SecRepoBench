size_t filename_len = 2;
          while (filename_len < tftp_packet->payload_packet_len && tftp_packet->payload[filename_len] != 0x00)
          {
            filename_len++;
          }

          if (filename_len < 2 || filename_len >= tftp_packet->payload_packet_len || !ndpi_is_string_printable(tftp_packet->payload + 2, filename_len - 2))
          {
            NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
            return;
          }


          if (filename_len > 0) {
            flow->l4.udp.tftp_filename = (char *)ndpi_malloc(filename_len);
            if (flow->l4.udp.tftp_filename != NULL)
            {
              memcpy(flow->l4.udp.tftp_filename, tftp_packet->payload + 2, filename_len - 2);
              flow->l4.udp.tftp_filename[filename_len - 2] = '\0'; // Null-terminate

              NDPI_LOG_INFO(ndpi_struct, "found TFTP RRQ/WRQ, filename: %s\n", flow->l4.udp.tftp_filename);
              ndpi_int_tftp_add_connection(ndpi_struct, flow);
            } else {
              NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
              return;
            }
          } else {
            NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
            return;
          }