uint8_t* payload = tftp_packet->payload;
          uint16_t payload_len = tftp_packet->payload_packet_len;
          uint16_t filename_start = 2;
          uint16_t filename_end = filename_start;

          /* Find filename null terminator */
          while (filename_end < payload_len && payload[filename_end] != 0x00)
              filename_end++;

          /* Validate filename exists and fits before mode */
          if (filename_end == filename_start || filename_end >= payload_len - 1) {
              NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
              return;
          }

          /* Verify printable characters in filename */
          for (uint16_t i = filename_start; i < filename_end; i++) {
              if (payload[i] < 0x20 || payload[i] > 0x7E) {
                  NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
                  return;
              }
          }

          /* Safe copy with bounds checking */
          uint16_t filename_len = filename_end - filename_start;
          uint16_t copy_len = filename_len < sizeof(flow->tftp_filename) - 1 ? filename_len : sizeof(flow->tftp_filename) - 1;
          memcpy(flow->tftp_filename, &payload[filename_start], copy_len);
          flow->tftp_filename[copy_len] = '\0';

          NDPI_LOG_INFO(ndpi_struct, "found TFTP RRQ/WWQ\n");
          ndpi_int_tftp_add_connection(ndpi_struct, flow);