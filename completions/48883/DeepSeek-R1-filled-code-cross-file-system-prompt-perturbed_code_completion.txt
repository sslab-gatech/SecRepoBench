// Extract the filename from the TFTP RRQ/WWQ packet.
          const uint8_t *filename_start = &tftp_packet->payload[2];
          const uint8_t *filename_end = memchr(filename_start, 0, tftp_packet->payload_packet_len - 2);
          
          if(!filename_end || filename_end == filename_start) {
              NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
              return;
          }
          
          uint16_t filename_len = filename_end - filename_start;
          
          // Verify printable characters
          for(uint16_t i=0; i<filename_len; i++) {
              if(!isprint(filename_start[i])) {
                  NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
                  return;
              }
          }
          
          // Copy filename with null termination
          size_t max_len = sizeof(flow->tftp_filename) - 1;
          filename_len = filename_len > max_len ? max_len : filename_len;
          memcpy(flow->tftp_filename, filename_start, filename_len);
          flow->tftp_filename[filename_len] = '\0';
          
          NDPI_LOG_INFO(ndpi_struct, "found TFTP RRQ/WWQ\n");
          ndpi_int_tftp_add_connection(ndpi_struct, flow);