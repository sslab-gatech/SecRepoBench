uint16_t filename_len = 0;
          uint16_t i = 2;

          while (i < tftp_packet->payload_packet_len && tftp_packet->payload[i] != 0x00)
          {
            filename_len++;
            i++;
          }

          if (i == tftp_packet->payload_packet_len || filename_len == 0)
          {
            NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
            return;
          }

          for (i = 2; i < 2 + filename_len; i++)
          {
            if (!isprint(tftp_packet->payload[i]))
            {
              NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
              return;
            }
          }

          if (filename_len < sizeof(flow->l4.udp.tftp_filename))
          {
            memcpy(flow->l4.udp.tftp_filename, &tftp_packet->payload[2], filename_len);
            flow->l4.udp.tftp_filename[filename_len] = '\0';

            NDPI_LOG_DBG(ndpi_struct, "TFTP filename: %s\n", flow->l4.udp.tftp_filename);
          } else {
            NDPI_LOG_DBG(ndpi_struct, "TFTP filename too long, not saving\n");
          }

          NDPI_LOG_INFO(ndpi_struct, "found tftp rrq/wrq\n");
          ndpi_int_tftp_add_connection(ndpi_struct, flow);