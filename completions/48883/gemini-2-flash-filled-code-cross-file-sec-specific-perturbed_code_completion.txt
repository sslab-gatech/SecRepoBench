uint16_t filename_len = 0;
          uint16_t i;

          for (i = 2; i < tftp_packet->payload_packet_len; i++)
          {
            if (tftp_packet->payload[i] == 0x00)
            {
              filename_len = i - 2;
              break;
            }
          }

          if (filename_len == 0)
          {
            NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
            return;
          }

          for (i = 2; i < 2 + filename_len; i++)
          {
            if (!isprint(tftp_packet->payload[i]))
            {
              NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
              return;
            }
          }

          if (filename_len >= NDPI_TFTP_FILENAME_LEN)
            filename_len = NDPI_TFTP_FILENAME_LEN - 1;

          strncpy((char *)flow->l4.udp.tftp_filename,
                  (char const *)&tftp_packet->payload[2], filename_len);
          flow->l4.udp.tftp_filename[filename_len] = '\0';

          NDPI_LOG_INFO(ndpi_struct, "found tftp rrq/wrq\n");
          ndpi_int_tftp_add_connection(ndpi_struct, flow);