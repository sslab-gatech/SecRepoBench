// Extract filename length and contents
  uint16_t filename_len = 0;
  while (filename_len < tftp_packet->payload_packet_len - 1 && tftp_packet->payload[2 + filename_len] != 0x00) {
    filename_len++;
  }

  if (filename_len == 0 || filename_len >= sizeof(flow->l4.udp.tftp_filename)) {
    NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
    return;
  }

  // Copy filename ensuring null termination
  memcpy(flow->l4.udp.tftp_filename, &tftp_packet->payload[2], filename_len);
  flow->l4.udp.tftp_filename[filename_len] = 0x00;

  NDPI_LOG_INFO(ndpi_struct, "found TFTP RRQ/WRQ packet with filename: %s\n", flow->l4.udp.tftp_filename);
  ndpi_int_tftp_add_connection(ndpi_struct, flow);