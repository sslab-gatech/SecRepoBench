{
  // Extract the filename from the TFTP RRQ/WWQ packet.
  // Determine the length of the filename.
  // Verify the filename is present and consists of printable characters.
  // If valid, copy the filename into the flow structure's TFTP filename field, ensuring null-termination.
  // Log the detection of a TFTP RRQ/WWQ packet and add the connection to the flow.
  char *filename = (char *)&tftp_packet->payload[tftp_packet->payload_packet_len - 1 - strlen((char const *)&tftp_packet->payload[tftp_packet->payload_packet_len - 1])];
  size_t filename_len = strlen(filename);
  if (filename_len > 0 && filename_len <= tftp_packet->payload_packet_len - 1 - strlen((char const *)&tftp_packet->payload[tftp_packet->payload_packet_len - 1]) &&
      isprint(filename[0]) && isprint(filename[filename_len - 1]))
  {
    flow->tftp_filename = (char *)malloc(filename_len + 1);
    if (flow->tftp_filename!= NULL)
    {
      strncpy(flow->tftp_filename, filename, filename_len);
      flow->tftp_filename[filename_len] = '\0';
      NDPI_LOG_INFO(ndpi_struct, "detected TFTP RRQ/WWQ packet with filename: %s\n", flow->tftp_filename);
      ndpi_int_tftp_add_connection(ndpi_struct, flow);
    }
  }
  else
  {
    NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
  }
}