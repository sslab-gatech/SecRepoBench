// Extract the filename from the TFTP RRQ/WWQ packet.
  // Determine the length of the filename.
  // Verify the filename is present and consists of printable characters.
  // If valid, copy the filename into the flow structure's TFTP filename field, ensuring null-termination.
  // Log the detection of a TFTP RRQ/WWQ packet and add the connection to the flow.

  // Determine the length of the filename.
  size_t filename_len = tftp_packet->payload_packet_len - 1 - mode_len;

  // Verify the filename is present and consists of printable characters.
  if (filename_len == 0 || tftp_packet->payload_packet_len < filename_len + 1)
  {
    NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
    return;
  }

  // Check if the filename consists of printable characters.
  for (size_t i = 0; i < filename_len; ++i)
  {
    if (!isprint(tftp_packet->payload[tftp_packet->payload_packet_len - 1 - mode_len + i]))
    {
      NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
      return;
    }
  }

  // Copy the filename into the flow structure's TFTP filename field, ensuring null-termination.
  memset(flow->l4.udp.tftp_filename, 0, sizeof(flow->l4.udp.tftp_filename));
  memcpy(flow->l4.udp.tftp_filename, &tftp_packet->payload[tftp_packet->payload_packet_len - 1 - mode_len], filename_len);

  // Log the detection of a TFTP RRQ/WWQ packet and add the connection to the flow.
  NDPI_LOG_INFO(ndpi_struct, "found tftp\n");
  ndpi_int_tftp_add_connection(ndpi_struct, flow);