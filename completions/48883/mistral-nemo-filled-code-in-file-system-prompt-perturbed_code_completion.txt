// Extract the filename from the TFTP RRQ/WWQ packet.
  char *filename = (char *)&tftp_packet->payload[4];
  size_t filename_len = strlen(filename);

  if (filename_len == 0 || filename_len > NDPI_MAX_TFTP_FILENAME_LEN)
  {
    NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
    return;
  }

  // Verify the filename consists of printable characters.
  for (size_t i = 0; i < filename_len; ++i)
  {
    if (!isprint((unsigned char)filename[i]))
    {
      NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
      return;
    }
  }

  // Copy the filename into the flow structure's TFTP filename field, ensuring null-termination.
  strncpy(flow->l4.udp.tftp_filename, filename, filename_len + 1);

  // Log the detection of a TFTP RRQ/WWQ packet and add the connection to the flow.
  NDPI_LOG_INFO(ndpi_struct, "found TFTP RRQ/WWQ packet with filename: %s\n", flow->l4.udp.tftp_filename);
  ndpi_int_tftp_add_connection(ndpi_struct, flow);