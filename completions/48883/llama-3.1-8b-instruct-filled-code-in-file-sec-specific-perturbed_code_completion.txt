{
  // Extract the filename from the TFTP RRQ/WWQ packet.
  // Determine the length of the filename.
  // Verify the filename is present and consists of printable characters.
  // If valid, copy the filename into the flow structure's TFTP filename field, ensuring null-termination.
  // Log the detection of a TFTP RRQ/WWQ packet and add the connection to the flow.
  size_t filename_len = strlen((char const *)&tftp_packet->payload[tftp_packet->payload_packet_len - 1 - strlen("netascii")]);
  if (filename_len > 0 && tftp_packet->payload_packet_len >= filename_len + 1) {
    char const * const filename = (char const *)&tftp_packet->payload[tftp_packet->payload_packet_len - 1 - filename_len];
    if (isprint(filename[0]) && isprint(filename[filename_len - 1])) {
      strncpy(flow->tftp_filename, filename, NDPI_TFTP_FILENAME_MAXLEN);
      flow->tftp_filename[NDPI_TFTP_FILENAME_MAXLEN - 1] = '\0';
      NDPI_LOG_INFO(ndpi_struct, "detected TFTP RRQ/WWQ packet with filename: %s\n", flow->tftp_filename);
      ndpi_int_tftp_add_connection(ndpi_struct, flow);
    } else {
      NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
    }
  } else {
    NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
  }
}