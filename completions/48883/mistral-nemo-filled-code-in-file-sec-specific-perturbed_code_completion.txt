// Extract the filename from the TFTP RRQ/WWQ packet.
  size_t filename_len = 0;
  while (tftp_packet->payload[tftp_packet->payload_packet_len - 1 - filename_len] != 0x00)
  {
    filename_len++;
  }

  if (filename_len == 0 || filename_len > 255)
  {
    NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
    return;
  }

  char *filename = (char *)ndpi_malloc(filename_len + 1);
  if (filename == NULL)
  {
    NDPI_LOG_ERR(ndpi_struct, "malloc failed\n");
    return;
  }

  memcpy(filename, (char const *)&tftp_packet->payload[tftp_packet->payload_packet_len - 1 - filename_len], filename_len);
  filename[filename_len] = '\0';

  flow->l4.udp.tftp_filename = filename;

  // Log the detection of a TFTP RRQ/WWQ packet and add the connection to the flow.
  NDPI_LOG_INFO(ndpi_struct, "found tftp RRQ/WWQ with filename: %s\n", filename);
  ndpi_int_tftp_add_connection(ndpi_struct, flow);