size_t filename_len = 0;
          while (filename_len < tftp_packet->payload_packet_len - 1 - mode_len &&
                 tftp_packet->payload[tftp_packet->payload_packet_len - 2 - mode_len - filename_len] != 0x00 &&
                 isprint(tftp_packet->payload[tftp_packet->payload_packet_len - 2 - mode_len - filename_len]))
          {
            filename_len++;
          }

          if (filename_len == 0)
          {
            NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
            return;
          }

          if (filename_len > NDPI_MAX_FILENAME_LENGTH)
          {
            NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
            return;
          }

          memcpy(flow->l4.udp.tftp_filename, &tftp_packet->payload[tftp_packet->payload_packet_len - 1 - mode_len - filename_len], filename_len);
          flow->l4.udp.tftp_filename[filename_len] = '\0';

          NDPI_LOG_DBG(ndpi_struct, "found tftp RRQ/WWQ filename: %s\n", flow->l4.udp.tftp_filename);
          ndpi_int_tftp_add_connection(ndpi_struct, flow);