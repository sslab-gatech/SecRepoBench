// Extract the filename from the TFTP RRQ/WWQ packet.
          const char *filename_start = (char *)&tftp_packet->payload[2];
          const char *filename_end = (char *)memchr(filename_start, 0x00, tftp_packet->payload_packet_len - 2);

          if (filename_end == NULL || filename_end == filename_start) {
            NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
            return;
          }

          size_t filename_len = filename_end - filename_start;

          // Verify the filename consists of printable characters.
          for (size_t i = 0; i < filename_len; ++i) {
            if (!isprint((unsigned char)filename_start[i])) {
              NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
              return;
            }
          }

          // Copy the filename into the flow structure's TFTP filename field, ensuring null-termination.
          if (filename_len < sizeof(flow->l4.udp.tftp_filename)) {
            memcpy(flow->l4.udp.tftp_filename, filename_start, filename_len);
            flow->l4.udp.tftp_filename[filename_len] = '\0';
          } else {
            NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
            return;
          }

          // Log the detection of a TFTP RRQ/WWQ packet and add the connection to the flow.
          NDPI_LOG_INFO(ndpi_struct, "found tftp RRQ/WWQ with filename: %s\n", flow->l4.udp.tftp_filename);
          ndpi_int_tftp_add_connection(ndpi_struct, flow);