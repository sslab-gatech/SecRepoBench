uint16_t filename_len = 0;
          const uint8_t* filename_ptr = &tftp_packet->payload[2];

          while ((filename_len + 2) < tftp_packet->payload_packet_len)
          {
            if (filename_ptr[filename_len] == 0x00)
              break;

            if (!isprint(filename_ptr[filename_len]))
            {
              NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
              return;
            }

            filename_len++;
          }

          if (filename_len == 0 || (filename_len + 2) >= tftp_packet->payload_packet_len)
          {
            NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
            return;
          }

          if (filename_len >= NDPI_TFTP_FILENAME_LEN)
            filename_len = NDPI_TFTP_FILENAME_LEN - 1;

          memcpy(flow->l4.udp.tftp_filename, filename_ptr, filename_len);
          flow->l4.udp.tftp_filename[filename_len] = '\0';

          NDPI_LOG_DBG(ndpi_struct, "Found TFTP RRQ/WRQ packet\n");
          ndpi_int_tftp_add_connection(ndpi_struct, flow);