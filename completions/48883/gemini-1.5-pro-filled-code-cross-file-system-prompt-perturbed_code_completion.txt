uint8_t fn_len = 2; // opcode + filename
          while (tftp_packet->payload[fn_len] != 0x00 && fn_len < tftp_packet->payload_packet_len) {
            if (!isprint(tftp_packet->payload[fn_len]))
            {
              NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
              return;
            }
            fn_len++;
          }

          if (tftp_packet->payload[fn_len] != 0x00 || fn_len <= 2) {
            NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
            return;
          }

          fn_len -= 2; // subtract opcode and null terminator

          if (fn_len >= sizeof(flow->l4.udp.tftp_filename)) {
            fn_len = sizeof(flow->l4.udp.tftp_filename) - 1;
          }

          memcpy(flow->l4.udp.tftp_filename, tftp_packet->payload + 2, fn_len);
          flow->l4.udp.tftp_filename[fn_len] = '\0';

          NDPI_LOG_INFO(ndpi_struct, "found TFTP RRQ/WRQ, filename: %s\n", flow->l4.udp.tftp_filename);
          ndpi_int_tftp_add_connection(ndpi_struct, flow);