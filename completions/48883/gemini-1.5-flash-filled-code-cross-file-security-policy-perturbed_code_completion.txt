size_t filename_len = 0;
          for (size_t i = 2; i < tftp_packet->payload_packet_len - 1 - mode_len; ++i) {
            if (tftp_packet->payload[i] == 0x00) {
              break;
            }
            if (!isprint(tftp_packet->payload[i])) {
              NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
              return;
            }
            filename_len++;
          }

          if (filename_len == 0) {
            NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
            return;
          }

          size_t filename_copy_len = ndpi_min(filename_len + 1, sizeof(flow->l4.udp.tftp_filename));

          memcpy(flow->l4.udp.tftp_filename, &tftp_packet->payload[2], filename_copy_len);
          flow->l4.udp.tftp_filename[filename_copy_len -1] = '\0';

          NDPI_LOG_DBG2(ndpi_struct, "found tftp RRQ/WWQ filename: %s\n", flow->l4.udp.tftp_filename);
          ndpi_int_tftp_add_connection(ndpi_struct, flow);