xmlIDPtr existing = xmlHashLookup(table, value);
if (existing != NULL) {
    /* Associate the attribute with the existing ID. */
    attribute->atype = XML_ATTRIBUTE_ID;
    if (!streaming) {
        attribute->id = existing;
        existing->attr = attribute;
    }
    if (id != NULL) {
        *id = existing;
    }
    return 0;
}