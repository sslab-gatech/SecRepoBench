if (ctx->bytes_in_header) {
		u32 i;
		memcpy(ctx->hdr_store + ctx->bytes_in_header, start, 4);
		for (i = 0; i < ctx->bytes_in_header + 4 - 3; i++) {
			if (!ctx->hdr_store[i] && !ctx->hdr_store[i + 1] && (ctx->hdr_store[i + 2] == 1)) {
				current = i;
				sc_type_forced = GF_TRUE;
				forced_sc_type = ctx->hdr_store[i + 3];
				break;
			}
		}
		if (current == -1) {
			dst_pck = gf_filter_pck_new_alloc(ctx->opid, ctx->bytes_in_header, &packet_data);
			if (!dst_pck) return GF_OUT_OF_MEM;

			if (ctx->src_pck) gf_filter_pck_merge_properties(ctx->src_pck, dst_pck);
			memcpy(packet_data, ctx->hdr_store, ctx->bytes_in_header);
			gf_filter_pck_set_framing(dst_pck, GF_FALSE, GF_FALSE);
			gf_filter_pck_set_cts(dst_pck, GF_FILTER_NO_TS);
			gf_filter_pck_set_dts(dst_pck, GF_FILTER_NO_TS);

			if (byte_offset != GF_FILTER_NO_BO) {
				gf_filter_pck_set_byte_offset(dst_pck, byte_offset - ctx->bytes_in_header);
			}

			mpgviddmx_enqueue_or_dispatch(ctx, dst_pck, GF_FALSE, GF_FALSE);
			ctx->bytes_in_header = 0;
		} else {
			bytes_from_store = current;
			hdr_offset = 4;
		}
	}