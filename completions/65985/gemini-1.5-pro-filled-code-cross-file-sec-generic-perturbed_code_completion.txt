if (ctx->bytes_in_header) {
			u32 to_copy = remain;
			if (ctx->bytes_in_header + remain < 5) {
				memcpy(ctx->hdr_store + ctx->bytes_in_header, start, remain);
				ctx->bytes_in_header += remain;
				break;
			}
			if (to_copy > 5 - ctx->bytes_in_header) to_copy = 5 - ctx->bytes_in_header;

			memcpy(ctx->hdr_store + ctx->bytes_in_header, start, to_copy);
			current = mpgviddmx_next_start_code(ctx->hdr_store, ctx->bytes_in_header + to_copy);

			if (current<0) {
				bytes_from_store = ctx->bytes_in_header;
				ctx->bytes_in_header = 0;
				current = 0;
				if (byte_offset != GF_FILTER_NO_BO) {
					byte_offset -= bytes_from_store;
				}
			} else {
				if (current > ctx->bytes_in_header) {
					hdr_offset = current - ctx->bytes_in_header;
					current = 0;
					bytes_from_store = ctx->bytes_in_header;
					ctx->bytes_in_header = 0;
					if (byte_offset != GF_FILTER_NO_BO) {
						byte_offset -= bytes_from_store;
					}
				} else {
					//start code entirely in store
					if (byte_offset != GF_FILTER_NO_BO) {
						byte_offset -= current;
					}
					bytes_from_store = current;
					ctx->bytes_in_header = 0;
					current = 0;
				}
			}
		}