// <MASK>
if (current == -1) {
	//locate next start code
	current = mpgviddmx_next_start_code(start, remain);
	//no start code, dispatch the block
	if (current<0) {
		// ... (rest of the code)
	}
} else {
	//we're align to startcode, stop trashing packets
	ctx->trash_trailer = GF_FALSE;

	//not enough bytes to parse start code
	if (remain<5) {
		memcpy(ctx->hdr_store, start, remain);
		ctx->bytes_in_header = remain;
		break;
	}

	//parse headers
	// ... (rest of the code)
}