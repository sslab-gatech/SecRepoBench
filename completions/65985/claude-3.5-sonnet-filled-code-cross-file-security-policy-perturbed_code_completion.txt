if (ctx->bytes_in_header) {
    u32 copy_size = (remain < 5 - ctx->bytes_in_header) ? remain : (5 - ctx->bytes_in_header);
    memcpy(ctx->hdr_store + ctx->bytes_in_header, start, copy_size);
    ctx->bytes_in_header += copy_size;
    
    if (ctx->bytes_in_header == 5) {
        u32 sc = GF_4CC(ctx->hdr_store[0], ctx->hdr_store[1], ctx->hdr_store[2], ctx->hdr_store[3]);
        if (sc == 0x000001) {
            sc_type = ctx->hdr_store[4];
            current = 0;
            forced_sc_type = sc_type;
            sc_type_forced = GF_TRUE;
            hdr_offset = 5;
        } else {
            current = mpgviddmx_next_start_code(ctx->hdr_store, 5);
            if (current >= 0) {
                sc_type = ctx->hdr_store[current + 3];
                forced_sc_type = sc_type;
                sc_type_forced = GF_TRUE;
                hdr_offset = current + 4;
            }
        }
        bytes_from_store = ctx->bytes_in_header;
        ctx->bytes_in_header = 0;
    } else {
        break;
    }
} else {
    current = -1;
}