if (ctx->bytes_in_header) {
			u32 check_size = remain;
			if (check_size + ctx->bytes_in_header > ctx->hdr_store_alloc) {
				ctx->hdr_store_alloc = check_size + ctx->bytes_in_header;
				ctx->hdr_store = gf_realloc(ctx->hdr_store, sizeof(char) * ctx->hdr_store_alloc);
			}
			memcpy(ctx->hdr_store + ctx->bytes_in_header, start, check_size);

			current = mpgviddmx_next_start_code((u8 *) ctx->hdr_store, ctx->bytes_in_header + check_size);

			if (current >= 0) {
				bytes_from_store = ctx->bytes_in_header;
				hdr_offset = ctx->bytes_in_header;

				if (current > ctx->bytes_in_header) {
					current -= ctx->bytes_in_header;
				}
				//start code was in our store
				else {
					start = (u8 *)ctx->hdr_store + current;
					remain = ctx->bytes_in_header + check_size - current;
					current = 0;
					//force start code type to avoid re-reading it
					if (ctx->is_mpg12) {
						if (start[3]==M2V_SEQ_START_CODE) forced_sc_type = M2V_SEQ_START_CODE;
						else if (start[3]==M2V_EXT_START_CODE) forced_sc_type = M2V_EXT_START_CODE;
						else if (start[3]==M2V_PIC_START_CODE) forced_sc_type = M2V_PIC_START_CODE;
					} else {
						if (start[3]==M4V_VOS_START_CODE) forced_sc_type = M4V_VOS_START_CODE;
						else if (start[3]==M4V_VOL_START_CODE) forced_sc_type = M4V_VOL_START_CODE;
						else if (start[3]==M4V_VOP_START_CODE) forced_sc_type = M4V_VOP_START_CODE;
						else if (start[3]==M4V_GOV_START_CODE) forced_sc_type = M4V_GOV_START_CODE;
						else if (start[3]==M4V_VO_START_CODE) forced_sc_type = M4V_VO_START_CODE;
						else if (start[3]==M4V_VISOBJ_START_CODE) forced_sc_type = M4V_VISOBJ_START_CODE;
					}
					if (forced_sc_type) sc_type_forced = GF_TRUE;
				}
			}
			//no start code found, dispatch the stored bytes
			else {
				dst_pck = gf_filter_pck_new_alloc(ctx->opid, ctx->bytes_in_header, &packet_data);
				if (!dst_pck) return GF_OUT_OF_MEM;

				if (ctx->src_pck) gf_filter_pck_merge_properties(ctx->src_pck, dst_pck);
				memcpy(packet_data, ctx->hdr_store, ctx->bytes_in_header);
				gf_filter_pck_set_framing(dst_pck, GF_FALSE, GF_FALSE);
				gf_filter_pck_set_cts(dst_pck, GF_FILTER_NO_TS);
				gf_filter_pck_set_dts(dst_pck, GF_FILTER_NO_TS);

				if (byte_offset != GF_FILTER_NO_BO) {
					gf_filter_pck_set_byte_offset(dst_pck, byte_offset);
				}

				mpgviddmx_enqueue_or_dispatch(ctx, dst_pck, GF_FALSE, GF_FALSE);
				ctx->bytes_in_header = 0;
			}
		}