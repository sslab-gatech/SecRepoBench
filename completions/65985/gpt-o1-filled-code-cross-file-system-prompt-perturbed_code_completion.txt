if (ctx->bytes_in_header) {
	s32 sc_pos = mpgviddmx_next_start_code(ctx->hdr_store, ctx->bytes_in_header);
	if (sc_pos >= 0) {
		/* Found a start code in the header buffer */
		current = sc_pos;
		bytes_from_store = sc_pos;
	} else {
		/* No start code: treat stored bytes as continuation or discard if frame not started */
		if (ctx->frame_started) {
			dst_pck = gf_filter_pck_new_alloc(ctx->opid, ctx->bytes_in_header, &packet_data);
			if (!dst_pck) return GF_OUT_OF_MEM;
			if (ctx->src_pck) gf_filter_pck_merge_properties(ctx->src_pck, dst_pck);
			memcpy(packet_data, ctx->hdr_store, ctx->bytes_in_header);
			gf_filter_pck_set_framing(dst_pck, GF_FALSE, GF_FALSE);
			gf_filter_pck_set_cts(dst_pck, GF_FILTER_NO_TS);
			gf_filter_pck_set_dts(dst_pck, GF_FILTER_NO_TS);
			mpgviddmx_enqueue_or_dispatch(ctx, dst_pck, GF_FALSE, GF_FALSE);
		} else {
			GF_LOG(GF_LOG_DEBUG, GF_LOG_MEDIA, ("[MPGVid] partial data in store, discarding\n"));
		}
		ctx->bytes_in_header = 0;
		current = -1;
	}
}