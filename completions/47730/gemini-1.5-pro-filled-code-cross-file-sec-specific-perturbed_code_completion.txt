while ((comma_or_nul = strchr(alpn_start, ',')) != NULL) {
      size_t alpn_len = comma_or_nul - alpn_start;
      if (alpn_len > 0 && alpn_len < 256 && !ndpi_is_common_alpn(ndpi_struct, alpn_start, alpn_len)) {
        char alpn_str[256];
        snprintf(alpn_str, sizeof(alpn_str), "Uncommon ALPN: %.*s", (int)alpn_len, alpn_start);

        NDPI_LOG_DBG(ndpi_struct, "%s", alpn_str);
        ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, alpn_str);
        break; // Stop checking after the first uncommon ALPN is found
      }
    }
    if (*comma_or_nul == '\0') {
      size_t alpn_len = strlen(alpn_start);
      if (alpn_len > 0 && alpn_len < 256 && !ndpi_is_common_alpn(ndpi_struct, alpn_start, alpn_len)) {
        char alpn_str[256];
        snprintf(alpn_str, sizeof(alpn_str), "Uncommon ALPN: %.*s", (int)alpn_len, alpn_start);

        NDPI_LOG_DBG(ndpi_struct, "%s", alpn_str);
        ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, alpn_str);
      }
    }