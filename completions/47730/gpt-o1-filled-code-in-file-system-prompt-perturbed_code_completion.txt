while (*comma_or_nul != ',' && *comma_or_nul != '\0') {
  comma_or_nul++;
}

/* Temporarily terminate this ALPN token at the comma or null */
char saved_char = *comma_or_nul;
*comma_or_nul = '\0';

/* Use a helper function (e.g., isCommonAlpnIdentifier) to check if ALPN is uncommon */
if (!isCommonAlpnIdentifier(alpn_start)) {
#ifdef DEBUG_TLS
  printf("[TLS] Uncommon ALPN detected: %s\n", alpn_start);
#endif
  ndpi_set_risk(ndpi_struct, connectionflow, NDPI_TLS_UNCOMMON_ALPN, alpn_start);
}

/* Restore the character so we can continue parsing */
*comma_or_nul = saved_char;