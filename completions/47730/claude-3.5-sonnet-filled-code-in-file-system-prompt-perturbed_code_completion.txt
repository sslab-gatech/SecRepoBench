char * comma_or_nul = strchr(alpn_start, ',');
    if(comma_or_nul == NULL)
      comma_or_nul = alpn_start + strlen(alpn_start);

    size_t alpn_len = comma_or_nul - alpn_start;
    if(alpn_len > 0 && alpn_len < sizeof(buf_ver_tmp)) {
      memcpy(buf_ver_tmp, alpn_start, alpn_len);
      buf_ver_tmp[alpn_len] = '\0';

      if(ndpi_is_alpn_protocol_supported(buf_ver_tmp) == 0) {
        char risk_str[256];
        snprintf(risk_str, sizeof(risk_str), "Uncommon ALPN: %s", buf_ver_tmp);
#ifdef DEBUG_TLS
        printf("[TLS] %s\n", risk_str);
#endif
        ndpi_set_risk(ndpi_struct, connectionflow, NDPI_TLS_UNCOMMON_ALPN, risk_str);
      }
    }