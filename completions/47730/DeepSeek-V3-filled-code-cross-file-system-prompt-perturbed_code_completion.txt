while(*comma_or_nul != ',' && *comma_or_nul != '\0') {
      comma_or_nul++;
    }
    char saved_char = *comma_or_nul;
    *comma_or_nul = '\0';
    
    if(!ndpi_is_common_alpn(alpn_start)) {
      char alpn_str[256];
      snprintf(alpn_str, sizeof(alpn_str), "Uncommon ALPN: %s", alpn_start);
      
      NDPI_LOG_DBG(ndpi_struct, "%s\n", alpn_str);
      ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, alpn_str);
    }
    
    *comma_or_nul = saved_char;