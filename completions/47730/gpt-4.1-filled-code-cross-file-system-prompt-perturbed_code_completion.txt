while(*comma_or_nul != ',' && *comma_or_nul != '\0') comma_or_nul++;
if(alpn_start != comma_or_nul) {
  char alpn[64];
  size_t len = (size_t)(comma_or_nul - alpn_start);
  if(len >= sizeof(alpn)) len = sizeof(alpn) - 1;
  memcpy(alpn, alpn_start, len);
  alpn[len] = '\0';

  if(!ndpi_is_common_alpn(alpn, len)) {
#ifdef NDPI_DEBUG
    NDPI_LOG_DBG(ndpi_struct, "Uncommon ALPN detected: [%s]\n", alpn);
#endif
    char risk_str[80];
    snprintf(risk_str, sizeof(risk_str), "Uncommon ALPN: %s", alpn);
    ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, risk_str);
  }
}