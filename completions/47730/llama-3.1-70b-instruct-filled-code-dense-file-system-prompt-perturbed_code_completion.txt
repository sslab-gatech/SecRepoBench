char * alpn_id = alpn_start;
comma_or_nul = strchr(alpn_start, ',');
if(comma_or_nul == NULL) {
  comma_or_nul = strchr(alpn_start, '\0');
}
if(ac_automata_match(ndpi_struct->common_alpns_automa.ac_automa, alpn_start, comma_or_nul - alpn_start) == 0) {
  char alpn_str[256];
  strncpy(alpn_str, alpn_start, comma_or_nul - alpn_start);
  alpn_str[comma_or_nul - alpn_start] = '\0';
  NDPI_LOG_DBG(ndpi_struct, "Found uncommon ALPN: [%s]\n", alpn_str);
  ndpi_int_add_connection(ndpi_struct, flow, NDPI_PROTOCOL_UNKNOWN, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI);
}