char * alpn_start = connectionflow->protos.tls_quic.alpn;
char * comma_or_nul = alpn_start;
do {
    // Find the next comma or end of string
    while (*comma_or_nul != ',' && *comma_or_nul != '\0') {
        comma_or_nul++;
    }

    // Temporarily replace the comma with a null terminator
    char temp = *comma_or_nul;
    *comma_or_nul = '\0';

    // Check if the ALPN is uncommon
    if (ndpi_is_alpn_uncommon(ndpi_struct, alpn_start)) {
        char risk_str[256];
        snprintf(risk_str, sizeof(risk_str), "Uncommon ALPN: %s", alpn_start);
        
#ifdef DEBUG_TLS
        printf("[TLS] %s\n", risk_str);
#endif

        ndpi_set_risk(ndpi_struct, connectionflow, NDPI_TLS_UNCOMMON_ALPN, risk_str);
    }

    // Restore the original character
    *comma_or_nul = temp;

    alpn_start = comma_or_nul + 1;
} while (*(comma_or_nul++) != '\0');