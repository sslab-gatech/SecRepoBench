comma_or_nul = strchr(alpn_start, ',');
    if (comma_or_nul == NULL) {
      comma_or_nul = alpn_start + strlen(alpn_start);
    }

    size_t alpn_len = comma_or_nul - alpn_start;
    if (alpn_len > 0 && !ndpi_is_common_alpn(ndpi_struct, alpn_start, alpn_len)) {
      char alpn_str[256];
      snprintf(alpn_str, sizeof(alpn_str), "%.*s", (int)alpn_len, alpn_start);

      NDPI_LOG_DBG2(ndpi_struct, "Uncommon ALPN: [%s]\n", alpn_str);
      ndpi_set_risk(ndpi_struct, connectionflow, NDPI_TLS_UNCOMMON_ALPN, alpn_str);
    }