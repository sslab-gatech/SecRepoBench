if (*comma_or_nul == ',' || *comma_or_nul == '\0') {
      size_t alpn_len = comma_or_nul - alpn_start;
      if (alpn_len > 0) {
        char alpn[256]; // Assuming a reasonable maximum ALPN length
        strncpy(alpn, alpn_start, alpn_len);
        alpn[alpn_len] = '\0';

        if (ndpi_check_alpn_is_not_common(alpn)) {
          char alpn_string[256];
          snprintf(alpn_string, sizeof(alpn_string), "Uncommon ALPN: %s", alpn);

          NDPI_LOG_DBG(ndpi_struct, alpn_string);
          ndpi_set_risk(ndpi_struct, connectionflow, NDPI_RISK_UNCOMMON_ALPN, alpn_string);
        }
      }
    }