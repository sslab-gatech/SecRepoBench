// <MASK>
  // Iterate through the ALPN string, delimited by commas, to extract each ALPN identifier.
  // For each ALPN identifier, check if it is not common using a helper function.
  // If an uncommon ALPN is found, prepare a string representation of the ALPN,
  // log a debug message if debugging is enabled, and set a risk using the detection module.
  while (comma_or_nul!= NULL) {
    char *alpn_identifier = comma_or_nul;
    comma_or_nul = strchr(comma_or_nul, ',');
    if (comma_or_nul!= NULL) {
      *comma_or_nul = '\0';
    } else {
      comma_or_nul = NULL;
    }
    if (alpn_identifier!= NULL) {
      // Check if the ALPN identifier is not common
      if (!ndpi_is_common_alpn(ndpi_struct, alpn_identifier)) {
        // Prepare a string representation of the ALPN
        char *alpn_string = malloc(strlen(alpn_identifier) + 1);
        strcpy(alpn_string, alpn_identifier);
        // Log a debug message if debugging is enabled
        if (ndpi_struct->debug_level >= NDPI_LOG_DEBUG) {
          NDPI_LOG_DBG(ndpi_struct, "Uncommon ALPN: %s", alpn_string);
        }
        // Set a risk using the detection module
        ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, alpn_string);
        free(alpn_string);
      }
    }
  }
  // <MASK>