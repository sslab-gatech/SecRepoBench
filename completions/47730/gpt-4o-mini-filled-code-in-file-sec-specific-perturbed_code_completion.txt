while (*alpn_start != '\0') {
        comma_or_nul = strchr(alpn_start, ',');
        if (comma_or_nul == NULL) {
            comma_or_nul = alpn_start + strlen(alpn_start);
        }

        // Check if the ALPN identifier is uncommon
        if (is_uncommon_alpn(alpn_start, comma_or_nul - alpn_start)) {
            char uncommon_alpn[256];
            snprintf(uncommon_alpn, sizeof(uncommon_alpn), "Uncommon ALPN: %.*s", (int)(comma_or_nul - alpn_start), alpn_start);
            ndpi_set_risk(ndpi_struct, connectionflow, NDPI_TLS_UNCOMMON_ALPN, uncommon_alpn);
        }

        alpn_start = comma_or_nul + 1;
    }