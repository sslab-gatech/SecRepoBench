// Find the next comma or end of string
    while (*comma_or_nul != ',' && *comma_or_nul != '\0') {
      comma_or_nul++;
    }

    // Temporarily terminate the current ALPN identifier
    char saved_char = *comma_or_nul;
    *comma_or_nul = '\0';

    // Check if the ALPN is uncommon
    if (!is_common_alpn(alpn_start)) {
      char alpn_str[256];
      snprintf(alpn_str, sizeof(alpn_str), "Uncommon ALPN: %s", alpn_start);

      // Log the uncommon ALPN if debugging is enabled
      NDPI_LOG_DBG(ndpi_struct, "%s\n", alpn_str);

      // Set a risk for the uncommon ALPN
      ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, alpn_str);
    }

    // Restore the character at the end of the current ALPN identifier
    *comma_or_nul = saved_char;