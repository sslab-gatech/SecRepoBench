while (*comma_or_nul != ',' && *comma_or_nul != '\0') comma_or_nul++;
    size_t len = comma_or_nul - alpn_start;
    
    if (len > 0) {
        if (!ndpi_is_common_alpn(alpn_start, len)) {
            char alpn_buf[64];
            size_t copy_len = len < sizeof(alpn_buf)-1 ? len : sizeof(alpn_buf)-1;
            memcpy(alpn_buf, alpn_start, copy_len);
            alpn_buf[copy_len] = '\0';
            
            NDPI_LOG_DBG(ndpi_struct, "Uncommon ALPN: %s\n", alpn_buf);
            ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, alpn_buf);
        }
    }