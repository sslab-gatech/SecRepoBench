char * alpn_end = strchr(comma_or_nul, ',');
    if (alpn_end == NULL) {
      alpn_end = comma_or_nul + strlen(comma_or_nul);
    }
    size_t alpn_len = alpn_end - comma_or_nul;
    if (alpn_len > 0) {
      char alpn[alpn_len + 1];
      strncpy(alpn, comma_or_nul, alpn_len);
      alpn[alpn_len] = '\0';
      if (ndpi_is_uncommon_alpn(alpn)) {
	char alpn_str[256];
	snprintf(alpn_str, sizeof(alpn_str), "Uncommon ALPN: %s", alpn);
	NDPI_LOG_DBG(ndpi_struct, alpn_str);
	ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, alpn_str);
      }
    }
    comma_or_nul = alpn_end;