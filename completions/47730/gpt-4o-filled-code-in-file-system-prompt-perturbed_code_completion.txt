// Iterate through the ALPN string, delimited by commas, to extract each ALPN identifier.
    while (*comma_or_nul != ',' && *comma_or_nul != '\0') {
      comma_or_nul++;
    }

    // For each ALPN identifier, check if it is not common using a helper function.
    if (ndpi_is_uncommon_alpn(alpn_start, comma_or_nul - alpn_start)) {
      char alpn_str[256];
      snprintf(alpn_str, sizeof(alpn_str), "%.*s", (int)(comma_or_nul - alpn_start), alpn_start);

      // Log a debug message if debugging is enabled.
#ifdef DEBUG_TLS
      printf("[TLS] Uncommon ALPN: %s\n", alpn_str);
#endif

      // Set a risk using the detection module.
      ndpi_set_risk(ndpi_struct, connectionflow, NDPI_TLS_UNCOMMON_ALPN, alpn_str);
    }