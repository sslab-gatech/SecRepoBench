// Find the end of the current ALPN identifier (comma or null terminator)
    while (*comma_or_nul != ',' && *comma_or_nul != '\0') {
      comma_or_nul++;
    }

    // Check if this ALPN identifier is uncommon
    if (isALPNUncommon(alpn_start, (uint16_t)(comma_or_nul - alpn_start))) {
      char alpn_str[256*2 + 1]; // Buffer for hex representation of ALPN
      snprintf(alpn_str, sizeof(alpn_str), "%.*s", 
               (int)(comma_or_nul - alpn_start), alpn_start);
      
      // Log debug message
      NDPI_LOG_DBG(ndpi_struct, "Uncommon ALPN found: %s\n", alpn_str);
      
      // Set risk for uncommon ALPN
      ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, alpn_str);
    }