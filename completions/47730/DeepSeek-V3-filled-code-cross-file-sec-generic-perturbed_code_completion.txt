while(*comma_or_nul != ',' && *comma_or_nul != '\0') {
      comma_or_nul++;
    }
    size_t alpn_len = comma_or_nul - alpn_start;
    if(alpn_len > 0) {
      if(!ndpi_is_common_alpn(alpn_start, alpn_len)) {
        char alpn_str[256];
        size_t copy_len = alpn_len < sizeof(alpn_str) ? alpn_len : sizeof(alpn_str) - 1;
        strncpy(alpn_str, alpn_start, copy_len);
        alpn_str[copy_len] = '\0';
        
        NDPI_LOG_DBG(ndpi_struct, "Uncommon ALPN: %s\n", alpn_str);
        ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, alpn_str);
      }
    }