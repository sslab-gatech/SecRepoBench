// Iterate through the ALPN string, delimited by commas, to extract each ALPN identifier.
// For each ALPN identifier, check if it is not common using a helper function.
// If an uncommon ALPN is found, prepare a string representation of the ALPN,
// log a debug message if debugging is enabled, and set a risk using the detection module.
size_t alpn_len = comma_or_nul - alpn_start;
size_t copy_len = (alpn_len < sizeof(connectionflow->alpn_str) - 1)? alpn_len : sizeof(connectionflow->alpn_str) - 1;
memcpy(connectionflow->alpn_str, alpn_start, copy_len);
connectionflow->alpn_str[copy_len] = '\0';

if (!is_common_alpn(connectionflow->alpn_str)) {
  NDPI_LOG_DBG(ndpi_struct, "Uncommon ALPN: [%s]", connectionflow->alpn_str);
  ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, connectionflow->alpn_str);
}