{
    size_t alpn_len = comma_or_nul - alpn_start;
    if(alpn_len > 0 && !is_common_alpn(alpn_start, alpn_len)) {
        char alpn_buf[64];
        snprintf(alpn_buf, sizeof(alpn_buf), "%.*s", (int)alpn_len, alpn_start);
        NDPI_LOG_DBG(ndpi_struct, "Detected uncommon ALPN: %s", alpn_buf);
        ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, alpn_buf);
    }
}