comma_or_nul = strchr(alpn_start, ',');
  if (comma_or_nul) {
    *comma_or_nul = '\0'; // Temporarily terminate the string for the current ALPN
  }

  if (is_uncommon_alpn(alpn_start)) { // Assuming is_uncommon_alpn is a helper function
    char alpn_str[128];
    snprintf(alpn_str, sizeof(alpn_str), "Uncommon ALPN: %s", alpn_start);
    
    if (ndpi_struct->debug) {
      NDPI_LOG_DBG(ndpi_struct, "%s\n", alpn_str);
    }
    
    ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, alpn_str);
  }

  if (comma_or_nul) {
    *comma_or_nul = ','; // Restore the comma for the next iteration
  }