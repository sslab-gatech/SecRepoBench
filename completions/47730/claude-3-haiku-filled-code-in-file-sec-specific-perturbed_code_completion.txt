static void tlsCheckUncommonALPN(struct ndpi_detection_module_struct *ndpi_struct,
                                 struct ndpi_flow_struct *connectionflow) {
    char * alpn_start = connectionflow->protos.tls_quic.alpn;
    char * comma_or_nul = alpn_start;
    do {
        // Iterate through the ALPN string, delimited by commas, to extract each ALPN identifier.
        char * next_comma = strchr(alpn_start, ',');
        size_t alpn_len = next_comma ? (size_t)(next_comma - alpn_start) : strlen(alpn_start);
        
        // For each ALPN identifier, check if it is not common using a helper function.
        if (!ndpi_is_common_alpn(alpn_start, alpn_len)) {
            char alpn_str[256];
            ndpi_snprintf(alpn_str, sizeof(alpn_str), "Uncommon ALPN: %.*s", (int)alpn_len, alpn_start);
            
            // Log a debug message if debugging is enabled
            #ifdef DEBUG_TLS
            printf("[TLS] %s\n", alpn_str);
            #endif
            
            // Set a risk using the detection module
            ndpi_set_risk(ndpi_struct, connectionflow, NDPI_TLS_UNCOMMON_ALPN, alpn_str);
        }
        
        alpn_start = next_comma ? (next_comma + 1) : comma_or_nul;
    } while (*(comma_or_nul++));
}