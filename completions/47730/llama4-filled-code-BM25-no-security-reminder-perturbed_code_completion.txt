char alpn[256];
char *alpn_id = alpn_start;

while (*alpn_start != '\0' && *alpn_start != ',') {
  alpn_start++;
}

if (alpn_start - alpn_id > 0) {
  strncpy(alpn, alpn_id, alpn_start - alpn_id);
  alpn[alpn_start - alpn_id] = '\0';

  if (!ndpi_is_common_alpn(ndpi_struct, alpn)) {
    NDPI_LOG_DBG(ndpi_struct, "Found uncommon ALPN: %s\n", alpn);
    ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, alpn);
  }
}