// Extract the next ALPN identifier by finding the next comma or null terminator
    while (*comma_or_nul != ',' && *comma_or_nul != '\0') {
      comma_or_nul++;
    }

    // Temporarily replace the delimiter with a null terminator to isolate the ALPN identifier
    char original_char = *comma_or_nul;
    *comma_or_nul = '\0';

    // Check if the ALPN identifier is uncommon
    if (!is_common_alpn(alpn_start)) {
      char uncommon_alpn[128];

      // Prepare a string representation of the uncommon ALPN
      snprintf(uncommon_alpn, sizeof(uncommon_alpn), "Uncommon ALPN: %s", alpn_start);

#ifdef DEBUG_TLS
      // Log a debug message if debugging is enabled
      NDPI_LOG_DBG(ndpi_struct, "%s\n", uncommon_alpn);
#endif

      // Set a risk for the uncommon ALPN
      ndpi_set_risk(ndpi_struct, connectionflow, NDPI_TLS_UNCOMMON_ALPN, uncommon_alpn);
    }

    // Restore the original character at the delimiter position
    *comma_or_nul = original_char;