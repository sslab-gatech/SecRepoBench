char alpn[256];
    size_t alpn_len;

    comma_or_nul = strchr(alpn_start, ',');
    if (comma_or_nul == NULL)
      comma_or_nul = strchr(alpn_start, '\0');

    alpn_len = (size_t)(comma_or_nul - alpn_start);
    if (alpn_len < sizeof(alpn)) {
      strncpy(alpn, alpn_start, alpn_len);
      alpn[alpn_len] = '\0';

      if (!ndpi_is_common_alpn(alpn, alpn_len)) {
        char alpn_str[512];

        ndpi_snprintf(alpn_str, sizeof(alpn_str), "ALPN: %s", alpn);
#ifdef DEBUG_TLS
        printf("[TLS] Uncommon %s\n", alpn_str);
#endif
        ndpi_set_risk(ndpi_struct, connectionflow, NDPI_TLS_UNCOMMON_ALPN, alpn_str);
      }
    }