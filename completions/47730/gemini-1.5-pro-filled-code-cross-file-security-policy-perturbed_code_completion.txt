while ((comma_or_nul = strchr(alpn_start, ',')) != NULL) {
      size_t alpn_len = comma_or_nul - alpn_start;
      if (!ndpi_is_common_alpn(ndpi_struct, alpn_start, alpn_len)) {
        char alpn_str[256];
        size_t copy_len = alpn_len < sizeof(alpn_str) - 1 ? alpn_len : sizeof(alpn_str) - 1;
        memcpy(alpn_str, alpn_start, copy_len);
        alpn_str[copy_len] = '\0';

        NDPI_LOG_DBG(ndpi_struct, "Uncommon ALPN: %s\n", alpn_str);
        ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, alpn_str);
      }
    }
    if (*alpn_start != '\0') {
      size_t alpn_len = strlen(alpn_start);
      if (!ndpi_is_common_alpn(ndpi_struct, alpn_start, alpn_len)) {
        char alpn_str[256];
        size_t copy_len = alpn_len < sizeof(alpn_str) -1 ? alpn_len : sizeof(alpn_str) - 1;
        memcpy(alpn_str, alpn_start, copy_len);
        alpn_str[copy_len] = '\0';
        
        NDPI_LOG_DBG(ndpi_struct, "Uncommon ALPN: %s\n", alpn_str);
        ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, alpn_str);
      }
    }