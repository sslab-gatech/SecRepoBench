{
    char *limit = comma_or_nul;
    /* Find the next comma or string terminator */
    while (*limit != ',' && *limit != '\0') {
        limit++;
    }

    /* Temporarily terminate the current ALPN token */
    char saved_char = *limit;
    *limit = '\0';

    /* Check if this ALPN token is uncommon */
    if (!ndpi_is_common_alpn(alpn_start)) {
        NDPI_LOG_DBG2(ndpi_struct, "Uncommon ALPN found: [%s]\n", alpn_start);
        ndpi_set_risk(ndpi_struct, connectionflow, NDPI_POSSIBLE_EXPLOIT, alpn_start);
    }

    /* Restore the original character and update comma_or_nul */
    *limit = saved_char;
    comma_or_nul = limit;
}