char alpn_identifier[64];
    int alpn_len = 0;

    // Extract each ALPN identifier
    while (*alpn_start != '\0') {
        if (*alpn_start == ',') {
            alpn_identifier[alpn_len] = '\0'; // Null-terminate the current identifier
            if (is_uncommon_alpn(alpn_identifier)) {
                // Log the uncommon ALPN
                ndpi_set_risk(ndpi_struct, connectionflow, NDPI_TLS_UNCOMMON_ALPN, alpn_identifier);
            }
            alpn_len = 0; // Reset for the next identifier
        } else {
            alpn_identifier[alpn_len++] = *alpn_start; // Add character to the identifier
        }
        alpn_start++;
    }
    // Handle the last identifier if there is no trailing comma
    if (alpn_len > 0) {
        alpn_identifier[alpn_len] = '\0';
        if (is_uncommon_alpn(alpn_identifier)) {
            ndpi_set_risk(ndpi_struct, connectionflow, NDPI_TLS_UNCOMMON_ALPN, alpn_identifier);
        }
    }