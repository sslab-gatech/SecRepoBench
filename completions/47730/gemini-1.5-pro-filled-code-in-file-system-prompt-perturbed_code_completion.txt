comma_or_nul = strchr(alpn_start, ',');
    if (comma_or_nul == NULL)
      comma_or_nul = strchr(alpn_start, '\0');

    size_t const alpn_len = comma_or_nul - alpn_start;
    if (alpn_len > 0) {
      if (!ndpi_is_common_alpn(alpn_start, alpn_len)) {
	char alpn_str[256];
	ndpi_snprintf(alpn_str, sizeof(alpn_str), "%.*s", (int)alpn_len, alpn_start);
#ifdef DEBUG_TLS
	NDPI_LOG(ndpi_struct, NDPI_LOG_DEBUG, "TLS uncommon ALPN: %s.\n", alpn_str);
#endif
	ndpi_set_risk(ndpi_struct, connectionflow, NDPI_TLS_UNCOMMON_ALPN, alpn_str);
      }
    }