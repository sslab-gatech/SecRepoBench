char * alpn_start = connectionflow->protos.tls_quic.alpn;
char * comma_or_nul = alpn_start;
do {
    // Iterate through the ALPN string, delimited by commas, to extract each ALPN identifier.
    // For each ALPN identifier, check if it is not common using a helper function.
    // If an uncommon ALPN is found, prepare a string representation of the ALPN,
    // log a debug message if debugging is enabled, and set a risk using the detection module.
    char * alpn_end = strchr(comma_or_nul, ',');
    if (alpn_end == NULL) {
        alpn_end = strchr(comma_or_nul, '\0');
    }
    size_t alpn_len = alpn_end - comma_or_nul;
    char alpn_str[alpn_len + 1];
    strncpy(alpn_str, comma_or_nul, alpn_len);
    alpn_str[alpn_len] = '\0';

    if (ndpi_is_uncommon_alpn(ndpi_struct, alpn_str)) {
        char alpn_repr[alpn_len * 2 + 1];
        for (size_t i = 0; i < alpn_len; ++i) {
            alpn_repr[i * 2] = '\\';
            alpn_repr[i * 2 + 1] = alpn_str[i];
        }
        alpn_repr[alpn_len * 2] = '\0';

#ifdef DEBUG_TLS
        printf("[TLS] Uncommon ALPN: %s\n", alpn_repr);
#endif

        ndpi_set_risk(ndpi_struct, connectionflow, NDPI_TLS_UNCOMMON_ALPN, alpn_repr);
    }

    alpn_start = comma_or_nul + 1;
} while (*(comma_or_nul++)!= '\0');