static void tlsCheckUncommonALPN(struct ndpi_detection_module_struct *ndpi_struct,
				 struct ndpi_flow_struct *connectionflow) {
  char * alpn_start = connectionflow->protos.tls_quic.alpn;
  char * comma_or_nul = alpn_start;
  do {
    // Iterate through the ALPN string, delimited by commas, to extract each ALPN identifier.
    // For each ALPN identifier, check if it is not common using a helper function.
    // If an uncommon ALPN is found, prepare a string representation of the ALPN,
    // log a debug message if debugging is enabled, and set a risk using the detection module.
    // <MASK>

    alpn_start = comma_or_nul + 1;
  } while (*(comma_or_nul++)!= '\0');

  // Check if the ALPN string is not empty
  if (alpn_start[0]!= '\0') {
    // Iterate through the ALPN string, delimited by commas, to extract each ALPN identifier.
    while (alpn_start[0]!= '\0') {
      // Find the next comma or null character
      char * next_comma_or_nul = strchr(alpn_start, ',');
      if (next_comma_or_nul == NULL) {
        next_comma_or_nul = strchr(alpn_start, '\0');
      }

      // Extract the ALPN identifier
      char alpn_identifier[256];
      strncpy(alpn_identifier, alpn_start, next_comma_or_nul - alpn_start);
      alpn_identifier[next_comma_or_nul - alpn_start] = '\0';

      // Check if the ALPN identifier is not common
      if (!ndpi_is_common_alpn(ndpi_struct, alpn_identifier)) {
        // Prepare a string representation of the ALPN
        char alpn_str[256];
        snprintf(alpn_str, sizeof(alpn_str), "ALPN: %s", alpn_identifier);

        // Log a debug message if debugging is enabled
#ifdef DEBUG_TLS
        printf("[TLS] Uncommon ALPN: %s\n", alpn_str);
#endif

        // Set a risk using the detection module
        ndpi_set_risk(ndpi_struct, connectionflow, NDPI_TLS_UNCOMMON_ALPN, alpn_str);
      }

      // Move to the next ALPN identifier
      alpn_start = next_comma_or_nul + 1;
    }
  }
}