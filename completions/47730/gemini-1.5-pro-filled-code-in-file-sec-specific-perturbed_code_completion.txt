comma_or_nul = strchr(alpn_start, ',');
    if (comma_or_nul == NULL)
      comma_or_nul = strchr(alpn_start, '\0');
    if (comma_or_nul != NULL) {
      size_t const alpn_len = comma_or_nul - alpn_start;
      if (alpn_len < 256) {
        char alpn[256];
        strncpy(alpn, alpn_start, alpn_len);
        alpn[alpn_len] = '\0';

        if (!ndpi_is_common_alpn(alpn, alpn_len)) {
          char alpn_str[256];
          ndpi_snprintf(alpn_str, sizeof(alpn_str), "ALPN: %s", alpn);
#ifdef DEBUG_TLS
          printf("[TLS] Uncommon ALPN: %s\n", alpn_str);
#endif
          ndpi_set_risk(ndpi_struct, connectionflow, NDPI_TLS_UNCOMMON_ALPN, alpn_str);
        }
      }
    }