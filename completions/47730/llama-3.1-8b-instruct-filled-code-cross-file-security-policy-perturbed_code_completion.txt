static void tlsCheckUncommonALPN(struct ndpi_detection_module_struct *ndpi_struct,
				 struct ndpi_flow_struct *connectionflow) {
  char * alpn_start = connectionflow->protos.tls_quic.alpn;
  char * comma_or_nul = alpn_start;
  do {
    // Iterate through the ALPN string, delimited by commas, to extract each ALPN identifier.
    // For each ALPN identifier, check if it is not common using a helper function.
    // If an uncommon ALPN is found, prepare a string representation of the ALPN,
    // log a debug message if debugging is enabled, and set a risk using the detection module.
    char alpn_id[128];
    size_t alpn_id_len = 0;
    while (*comma_or_nul!= '\0' && *comma_or_nul!= ',') {
      alpn_id[alpn_id_len++] = *comma_or_nul;
      comma_or_nul++;
    }
    alpn_id[alpn_id_len] = '\0';
    if (ndpi_is_uncommon_alpn(ndpi_struct, alpn_id, alpn_id_len)) {
      char alpn_str[128];
      snprintf(alpn_str, sizeof(alpn_str), "ALPN: %s", alpn_id);
      if (ndpi_struct->debug_level >= NDPI_LOG_DEBUG) {
        NDPI_LOG_DBG(ndpi_struct, "%s", alpn_str);
      }
      ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, alpn_str);
    }
    alpn_start = comma_or_nul + 1;
  } while (*(comma_or_nul++)!= '\0');
}