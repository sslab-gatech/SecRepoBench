// Iterate through the ALPN string, delimited by commas, to extract each ALPN identifier.
    while (*comma_or_nul != ',' && *comma_or_nul != '\0') {
      comma_or_nul++;
    }
    // For each ALPN identifier, check if it is not common using a helper function.
    if (ndpi_is_uncommon_alpn(alpn_start, comma_or_nul - alpn_start)) {
      // If an uncommon ALPN is found, prepare a string representation of the ALPN,
      char uncommon_alpn[256];
      snprintf(uncommon_alpn, sizeof(uncommon_alpn), "%.*s", (int)(comma_or_nul - alpn_start), alpn_start);
      // log a debug message if debugging is enabled, and set a risk using the detection module.
#ifdef DEBUG_TLS
      printf("[TLS] Uncommon ALPN found: %s\n", uncommon_alpn);
#endif
      ndpi_set_risk(ndpi_struct, connectionflow, NDPI_TLS_UNCOMMON_ALPN, uncommon_alpn);
    }