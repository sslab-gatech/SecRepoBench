comma_or_nul = strchr(alpn_start, ',');
    if (!comma_or_nul) {
      comma_or_nul = alpn_start + strlen(alpn_start);
    }
    size_t alpn_len = comma_or_nul - alpn_start;
    char alpn_identifier[256];
    strncpy(alpn_identifier, alpn_start, alpn_len);
    alpn_identifier[alpn_len] = '\0';

    if (!is_common_alpn(alpn_identifier)) {
      char log_message[512];
      snprintf(log_message, sizeof(log_message), "Uncommon ALPN identifier found: %s", alpn_identifier);
      NDPI_LOG_DBG(ndpi_struct, "%s\n", log_message);
      ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, log_message);
    }