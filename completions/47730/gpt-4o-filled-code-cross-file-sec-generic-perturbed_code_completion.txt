// Find the next comma or null terminator
    while (*comma_or_nul != ',' && *comma_or_nul != '\0') {
      comma_or_nul++;
    }

    // Calculate the length of the current ALPN identifier
    size_t alpn_length = comma_or_nul - alpn_start;

    // Check if the ALPN is uncommon
    if (is_uncommon_alpn(alpn_start, alpn_length)) {
      char alpn_str[256];

      // Ensure the ALPN string fits in the buffer
      if (alpn_length < sizeof(alpn_str)) {
        // Copy the ALPN identifier to a null-terminated string
        strncpy(alpn_str, alpn_start, alpn_length);
        alpn_str[alpn_length] = '\0';

        // Log the uncommon ALPN if debugging is enabled
        NDPI_LOG_DBG(ndpi_struct, "Uncommon ALPN: %s\n", alpn_str);

        // Set a risk for the uncommon ALPN
        ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, alpn_str);
      }
    }