comma_or_nul = strchr(alpn_start, ',');
    if (comma_or_nul == NULL) {
        comma_or_nul = alpn_start + strlen(alpn_start); // Point to the end if no comma found
    }
    
    size_t alpn_length = comma_or_nul - alpn_start;
    char alpn_identifier[128]; // Assuming a maximum length of 127 for ALPN identifiers
    strncpy(alpn_identifier, alpn_start, sizeof(alpn_identifier) - 1);
    alpn_identifier[sizeof(alpn_identifier) - 1] = '\0'; // Null-terminate

    if (is_uncommon_alpn(alpn_identifier)) {
        NDPI_LOG_DBG(ndpi_struct, "Uncommon ALPN: [%s]\n", alpn_identifier);
        ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, alpn_identifier);
    }