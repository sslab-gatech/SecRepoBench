{
  size_t alpn_len = strcspn(alpn_start, ",");
  if (!ndpi_is_common_alpn(alpn_start, alpn_len)) {
    char alpn_identifier[128];
    snprintf(alpn_identifier, sizeof(alpn_identifier), "%.*s", (int)alpn_len, alpn_start);
    NDPI_LOG_DBG2(ndpi_struct, "Uncommon ALPN detected: [%s]\n", alpn_identifier);
    ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, alpn_identifier);
  }
}