size_t len = comma_or_nul - alpn_start;
    char alpn[256]; // Define a buffer to hold the ALPN string.  The size should be sufficient to hold the longest possible ALPN value.
    if (len > 0) {
      if (len >= sizeof(alpn)) {
        len = sizeof(alpn) - 1; // Truncate if the ALPN is too long to prevent buffer overflow.
      }
      strncpy(alpn, alpn_start, len); // Copy the ALPN identifier into the buffer.
      alpn[len] = '\0'; // Null-terminate the string.

      if (ndpi_check_alpn_is_uncommon(alpn)) {
        char alpn_string[512]; // Buffer to hold the complete ALPN string.
        snprintf(alpn_string, sizeof(alpn_string), "Uncommon ALPN: %s", alpn);

        NDPI_LOG_DBG(ndpi_struct, alpn_string);
        ndpi_set_risk(ndpi_struct, connectionflow, NDPI_RISK_UNCOMMON_ALPN, alpn_string);
      }
    }