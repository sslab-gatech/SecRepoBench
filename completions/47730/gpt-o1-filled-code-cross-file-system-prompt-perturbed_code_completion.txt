while (*comma_or_nul != ',' && *comma_or_nul != '\0') {
  comma_or_nul++;
}
int alpn_len = comma_or_nul - alpn_start;
if (alpn_len > 0) {
  char tmp_alpn[128];
  if (alpn_len < (int)sizeof(tmp_alpn)) {
    memcpy(tmp_alpn, alpn_start, alpn_len);
    tmp_alpn[alpn_len] = '\0';

    // Example check if ALPN is uncommon
    if (!isCommonALPN(tmp_alpn)) {
      NDPI_LOG_DBG2(ndpi_struct, "Uncommon ALPN detected: %s\n", tmp_alpn);
      ndpi_set_risk(ndpi_struct, connectionflow, NDPI_TLS_UNCOMMON_ALPN, tmp_alpn);
    }
  }
}
if (*comma_or_nul == ',') {
  *comma_or_nul = '\0';
}