comma_or_nul = strchr(alpn_start, ',');
    if (comma_or_nul == NULL) {
        comma_or_nul = alpn_start + strlen(alpn_start); // Point to the end if no comma found
    }
    
    size_t alpn_length = comma_or_nul - alpn_start;
    if (alpn_length > 0) {
        char alpn_identifier[128]; // Ensure this buffer is large enough for expected ALPN identifiers
        if (alpn_length < sizeof(alpn_identifier)) {
            strncpy(alpn_identifier, alpn_start, alpn_length);
            alpn_identifier[alpn_length] = '\0'; // Null-terminate the string

            if (is_uncommon_alpn(alpn_identifier)) { // Assuming this function checks for uncommon ALPNs
                NDPI_LOG_DBG(ndpi_struct, "Uncommon ALPN found: %s", alpn_identifier);
                ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, alpn_identifier);
            }
        } else {
            NDPI_LOG_DBG(ndpi_struct, "ALPN identifier too long: %zu", alpn_length);
        }
    }