comma_or_nul = strchr(alpn_start, ',');
    if (comma_or_nul == NULL) {
        comma_or_nul = alpn_start + strlen(alpn_start); // Set to end of string if no comma found
    }
    
    size_t alpn_length = comma_or_nul - alpn_start;
    char alpn_identifier[alpn_length + 1];
    strncpy(alpn_identifier, alpn_start, alpn_length);
    alpn_identifier[alpn_length] = '\0'; // Null-terminate the string

    if (is_uncommon_alpn(alpn_identifier)) { // Assuming is_uncommon_alpn is a defined function
        NDPI_LOG_DBG(ndpi_struct, "Uncommon ALPN: [%s]", alpn_identifier);
        ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, alpn_identifier);
    }