char alpn_str[256];
size_t alpn_len = comma_or_nul - alpn_start;
if (alpn_len > 0 && alpn_len < sizeof(alpn_str)) {
  strncpy(alpn_str, alpn_start, alpn_len);
  alpn_str[alpn_len] = '\0';
  if (!is_common_alpn(ndpi_struct, alpn_str)) {
    NDPI_LOG_DBG(ndpi_struct, "Uncommon ALPN: %s", alpn_str);
    char risk_str[256];
    snprintf(risk_str, sizeof(risk_str), "Uncommon ALPN: %s", alpn_str);
    ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, risk_str);
  }
}