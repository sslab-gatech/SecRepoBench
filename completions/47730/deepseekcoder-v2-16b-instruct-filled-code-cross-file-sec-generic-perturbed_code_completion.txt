static void tlsCheckUncommonALPN(struct ndpi_detection_module_struct *ndpi_struct,
				 struct ndpi_flow_struct *connectionflow) {
  char * alpn_start = connectionflow->protos.tls_quic.alpn;
  char * comma_or_nul = alpn_start;
  do {
    // Iterate through the ALPN string, delimited by commas, to extract each ALPN identifier.
    // For each ALPN identifier, check if it is not common using a helper function.
    // If an uncommon ALPN is found, prepare a string representation of the ALPN,
    // log a debug message if debugging is enabled, and set a risk using the detection module.
    comma_or_nul = strchr(alpn_start, ',');
    if (comma_or_nul == NULL) {
      comma_or_nul = alpn_start + strlen(alpn_start);
    }

    char alpn_identifier[comma_or_nul - alpn_start + 1];
    strncpy(alpn_identifier, alpn_start, comma_or_nul - alpn_start);
    alpn_identifier[comma_or_nul - alpn_start] = '\0';

    if (!isCommonALPN(alpn_identifier)) {
      char alpn_log_message[256];
      snprintf(alpn_log_message, sizeof(alpn_log_message), "Uncommon ALPN found: %s", alpn_identifier);
      NDPI_LOG_DBG(ndpi_struct, "%s", alpn_log_message);

      ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, alpn_log_message);
    }

    alpn_start = comma_or_nul + 1;
  } while (*comma_or_nul != '\0');
}