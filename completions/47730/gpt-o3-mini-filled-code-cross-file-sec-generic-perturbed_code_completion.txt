comma_or_nul = strchr(alpn_start, ',');
if(comma_or_nul == NULL)
  comma_or_nul = alpn_start + strlen(alpn_start);

size_t token_len = comma_or_nul - alpn_start;
if(token_len > 0 && !ndpi_is_common_alpn(alpn_start, token_len)) {
  #define ALPN_TOKEN_MAX 64
  char alpn_token[ALPN_TOKEN_MAX];
  size_t copy_len = (token_len < (ALPN_TOKEN_MAX - 1)) ? token_len : (ALPN_TOKEN_MAX - 1);
  memcpy(alpn_token, alpn_start, copy_len);
  alpn_token[copy_len] = '\0';
  NDPI_LOG_DBG(ndpi_struct, "Uncommon ALPN detected: [%s]\n", alpn_token);
  ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, alpn_token);
}