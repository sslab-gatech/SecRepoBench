char * alpn_end = strchr(comma_or_nul, ',');
    if (alpn_end == NULL) {
      alpn_end = comma_or_nul + strlen(comma_or_nul);
    }
    size_t alpn_len = alpn_end - comma_or_nul;
    if (alpn_len > 0 && !ndpi_is_common_alpn(comma_or_nul, alpn_len)) {
      char alpn_str[alpn_len + 1];
      memcpy(alpn_str, comma_or_nul, alpn_len);
      alpn_str[alpn_len] = '\0';
      NDPI_LOG_DBG(ndpi_struct, "Uncommon ALPN found: %s", alpn_str);
      ndpi_set_risk(ndpi_struct, connectionflow, NDPI_UNCOMMON_ALPN, alpn_str);
    }
    comma_or_nul = alpn_end;