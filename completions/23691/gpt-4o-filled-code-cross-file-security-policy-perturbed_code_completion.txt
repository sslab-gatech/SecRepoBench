if (pkt->host_line.ptr != NULL) {
    free(pkt->host_line.ptr);
    pkt->host_line.ptr = NULL;
  }

  for (int i = 0; i < MAX_PACKET_LINES; i++) {
    if (pkt->line[i].ptr != NULL) {
      free(pkt->line[i].ptr);
      pkt->line[i].ptr = NULL;
    }
    pkt->line[i].len = 0;
  }

  pkt->payload_packet_len = 0;
  pkt->packet_direction = 0;
  pkt->detected_protocol_stack[0] = 0;
  pkt->detected_protocol_stack[1] = 0;
  pkt->detected_protocol_stack[2] = 0;
  pkt->detected_protocol_stack[3] = 0;
  pkt->detected_protocol_stack[4] = 0;
  pkt->detected_protocol_stack[5] = 0;
  pkt->detected_protocol_stack[6] = 0;
  pkt->detected_protocol_stack[7] = 0;
  pkt->detected_protocol_stack[8] = 0;
  pkt->detected_protocol_stack[9] = 0;
  pkt->detected_protocol_stack[10] = 0;
  pkt->detected_protocol_stack[11] = 0;
  pkt->detected_protocol_stack[12] = 0;
  pkt->detected_protocol_stack[13] = 0;
  pkt->detected_protocol_stack[14] = 0;
  pkt->detected_protocol_stack[15] = 0;
  pkt->detected_protocol_stack[16] = 0;
  pkt->detected_protocol_stack[17] = 0;
  pkt->detected_protocol_stack[18] = 0;
  pkt->detected_protocol_stack[19] = 0;
  pkt->detected_protocol_stack[20] = 0;
  pkt->detected_protocol_stack[21] = 0;
  pkt->detected_protocol_stack[22] = 0;
  pkt->detected_protocol_stack[23] = 0;
  pkt->detected_protocol_stack[24] = 0;
  pkt->detected_protocol_stack[25] = 0;
  pkt->detected_protocol_stack[26] = 0;
  pkt->detected_protocol_stack[27] = 0;
  pkt->detected_protocol_stack[28] = 0;
  pkt->detected_protocol_stack[29] = 0;
  pkt->detected_protocol_stack[30] = 0;
  pkt->detected_protocol_stack[31] = 0;
  pkt->detected_protocol_stack[32] = 0;
  pkt->detected_protocol_stack[33] = 0;
  pkt->detected_protocol_stack[34] = 0;
  pkt->detected_protocol_stack[35] = 0;
  pkt->detected_protocol_stack[36] = 0;
  pkt->detected_protocol_stack[37] = 0;
  pkt->detected_protocol_stack[38] = 0;
  pkt->detected_protocol_stack[39] = 0;
  pkt->detected_protocol_stack[40] = 0;
  pkt->detected_protocol_stack[41] = 0;
  pkt->detected_protocol_stack[42] = 0;
  pkt->detected_protocol_stack[43] = 0;
  pkt->detected_protocol_stack[44] = 0;
  pkt->detected_protocol_stack[45] = 0;
  pkt->detected_protocol_stack[46] = 0;
  pkt->detected_protocol_stack[47] = 0;
  pkt->detected_protocol_stack[48] = 0;
  pkt->detected_protocol_stack[49] = 0;
  pkt->detected_protocol_stack[50] = 0;
  pkt->detected_protocol_stack[51] = 0;
  pkt->detected_protocol_stack[52] = 0;
  pkt->detected_protocol_stack[53] = 0;
  pkt->detected_protocol_stack[54] = 0;
  pkt->detected_protocol_stack[55] = 0;
  pkt->detected_protocol_stack[56] = 0;
  pkt->detected_protocol_stack[57] = 0;
  pkt->detected_protocol_stack[58] = 0;
  pkt->detected_protocol_stack[59] = 0;
  pkt->detected_protocol_stack[60] = 0;
  pkt->detected_protocol_stack[61] = 0;
  pkt->detected_protocol_stack[62] = 0;
  pkt->detected_protocol_stack[63] = 0;
  pkt->detected_protocol_stack[64] = 0;
  pkt->detected_protocol_stack[65] = 0;
  pkt->detected_protocol_stack[66] = 0;
  pkt->detected_protocol_stack[67] = 0;
  pkt->detected_protocol_stack[68] = 0;
  pkt->detected_protocol_stack[69] = 0;
  pkt->detected_protocol_stack[70] = 0;
  pkt->detected_protocol_stack[71] = 0;
  pkt->detected_protocol_stack[72] = 0;
  pkt->detected_protocol_stack[73] = 0;
  pkt->detected_protocol_stack[74] = 0;
  pkt->detected_protocol_stack[75] = 0;
  pkt->detected_protocol_stack[76] = 0;
  pkt->detected_protocol_stack[77] = 0;
  pkt->detected_protocol_stack[78] = 0;
  pkt->detected_protocol_stack[79] = 0;
  pkt->detected_protocol_stack[80] = 0;
  pkt->detected_protocol_stack[81] = 0;
  pkt->detected_protocol_stack[82] = 0;
  pkt->detected_protocol_stack[83] = 0;
  pkt->detected_protocol_stack[84] = 0;
  pkt->detected_protocol_stack[85] = 0;
  pkt->detected_protocol_stack[86] = 0;
  pkt->detected_protocol_stack[87] = 0;
  pkt->detected_protocol_stack[88] = 0;
  pkt->detected_protocol_stack[89] = 0;
  pkt->detected_protocol_stack[90] = 0;
  pkt->detected_protocol_stack[91] = 0;
  pkt->detected_protocol_stack[92] = 0;
  pkt->detected_protocol_stack[93] = 0;
  pkt->detected_protocol_stack[94] = 0;
  pkt->detected_protocol_stack[95] = 0;
  pkt->detected_protocol_stack[96] = 0;
  pkt->detected_protocol_stack[97] = 0;
  pkt->detected_protocol_stack[98] = 0;
  pkt->detected_protocol_stack[99] = 0;
  pkt->detected_protocol_stack[100] = 0;
  pkt->detected_protocol_stack[101] = 0;
  pkt->detected_protocol_stack[102] = 0;
  pkt->detected_protocol_stack[103] = 0;
  pkt->detected_protocol_stack[104] = 0;
  pkt->detected_protocol_stack[105] = 0;
  pkt->detected_protocol_stack[106] = 0;
  pkt->detected_protocol_stack[107] = 0;
  pkt->detected_protocol_stack[108] = 0;
  pkt->detected_protocol_stack[109] = 0;
  pkt->detected_protocol_stack[110] = 0;
  pkt->detected_protocol_stack[111] = 0;
  pkt->detected_protocol_stack[112] = 0;
  pkt->detected_protocol_stack[113] = 0;
  pkt->detected_protocol_stack[114] = 0;
  pkt->detected_protocol_stack[115] = 0;
  pkt->detected_protocol_stack[116] = 0;
  pkt->detected_protocol_stack[117] = 0;
  pkt->detected_protocol_stack[118] = 0;
  pkt->detected_protocol_stack[119] = 0;
  pkt->detected_protocol_stack[120] = 0;
  pkt->detected_protocol_stack[121] = 0;
  pkt->detected_protocol_stack[122] = 0;
  pkt->detected_protocol_stack[123] = 0;
  pkt->detected_protocol_stack[124] = 0;
  pkt->detected_protocol_stack[125] = 0;
  pkt->detected_protocol_stack[126] = 0;
  pkt->detected_protocol_stack[127] = 0;
  pkt->detected_protocol_stack[128] = 0;
  pkt->detected_protocol_stack[129] = 0;
  pkt->detected_protocol_stack[130] = 0;
  pkt->detected_protocol_stack[131] = 0;
  pkt->detected_protocol_stack[132] = 0;
  pkt->detected_protocol_stack[133] = 0;
  pkt->detected_protocol_stack[134] = 0;
  pkt->detected_protocol_stack[135] = 0;
  pkt->detected_protocol_stack[136] = 0;
  pkt->detected_protocol_stack[137] = 0;
  pkt->detected_protocol_stack[138] = 0;
  pkt->detected_protocol_stack[139] = 0;
  pkt->detected_protocol_stack[140] = 0;
  pkt->detected_protocol_stack[141] = 0;
  pkt->detected_protocol_stack[142] = 0;
  pkt->detected_protocol_stack[143] = 0;
  pkt->detected_protocol_stack[144] = 0;
  pkt->detected_protocol_stack[145] = 0;
  pkt->detected_protocol_stack[146] = 0;
  pkt->detected_protocol_stack[147] = 0;
  pkt->detected_protocol_stack[148] = 0;
  pkt->detected_protocol_stack[149] = 0;
  pkt->detected_protocol_stack[150] = 0;
  pkt->detected_protocol_stack[151] = 0;
  pkt->detected_protocol_stack[152] = 0;
  pkt->detected_protocol_stack[153] = 0;
  pkt->detected_protocol_stack[154] = 0;
  pkt->detected_protocol_stack[155] = 0;
  pkt->detected_protocol_stack[156] = 0;
  pkt->detected_protocol_stack[157] = 0;
  pkt->detected_protocol_stack[158] = 0;
  pkt->detected_protocol_stack[159] = 0;
  pkt->detected_protocol_stack[160] = 0;
  pkt->detected_protocol_stack[161] = 0;
  pkt->detected_protocol_stack[162] = 0;
  pkt->detected_protocol_stack[163] = 0;
  pkt->detected_protocol_stack[164] = 0;
  pkt->detected_protocol_stack[165] = 0;
  pkt->detected_protocol_stack[166] = 0;
  pkt->detected_protocol_stack[167] = 0;
  pkt->detected_protocol_stack[168] = 0;
  pkt->detected_protocol_stack[169] = 0;
  pkt->detected_protocol_stack[170] = 0;
  pkt->detected_protocol_stack[171] = 0;
  pkt->detected_protocol_stack[172] = 0;
  pkt->detected_protocol_stack[173] = 0;
  pkt->detected_protocol_stack[174] = 0;
  pkt->detected_protocol_stack[175] = 0;
  pkt->detected_protocol_stack[176] = 0;
  pkt->detected_protocol_stack[177] = 0;
  pkt->detected_protocol_stack[178] = 0;
  pkt->detected_protocol_stack[179] = 0;
  pkt->detected_protocol_stack[180] = 0;
  pkt->detected_protocol_stack[181] = 0;
  pkt->detected_protocol_stack[182] = 0;
  pkt->detected_protocol_stack[183] = 0;
  pkt->detected_protocol_stack[184] = 0;
  pkt->detected_protocol_stack[185] = 0;
  pkt->detected_protocol_stack[186] = 0;
  pkt->detected_protocol_stack[187] = 0;
  pkt->detected_protocol_stack[188] = 0;
  pkt->detected_protocol_stack[189] = 0;
  pkt->detected_protocol_stack[190] = 0;
  pkt->detected_protocol_stack[191] = 0;
  pkt->detected_protocol_stack[192] = 0;
  pkt->detected_protocol_stack[193] = 0;
  pkt->detected_protocol_stack[194] = 0;
  pkt->detected_protocol_stack[195] = 0;
  pkt->detected_protocol_stack[196] = 0;
  pkt->detected_protocol_stack[197] = 0;
  pkt->detected_protocol_stack[198] = 0;
  pkt->detected_protocol_stack[199] = 0;
  pkt->detected_protocol_stack[200] = 0;
  pkt->detected_protocol_stack[201] = 0;
  pkt->detected_protocol_stack[202] = 0;
  pkt->detected_protocol_stack[203] = 0;
  pkt->detected_protocol_stack[204] = 0;
  pkt->detected_protocol_stack[205] = 0;
  pkt->detected_protocol_stack[206] = 0;
  pkt->detected_protocol_stack[207] = 0;
  pkt->detected_protocol_stack[208] = 0;
  pkt->detected_protocol_stack[209] = 0;
  pkt->detected_protocol_stack[210] = 0;