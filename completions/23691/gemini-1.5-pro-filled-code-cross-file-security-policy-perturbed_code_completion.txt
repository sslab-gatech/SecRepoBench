if (pkt->host_line.ptr != NULL) {
    free(pkt->host_line.ptr);
    pkt->host_line.ptr = NULL;
    pkt->host_line.len = 0;
  }

  for (int i = 0; i < pkt->num_lines; i++) {
    if (pkt->line[i].ptr != NULL) {
      free(pkt->line[i].ptr);
      pkt->line[i].ptr = NULL;
      pkt->line[i].len = 0;
    }
  }
  pkt->num_lines = 0;

  pkt->detection_completed = 0;
  pkt->decoded_protocol = NDPI_PROTOCOL_UNKNOWN;
  pkt->payload_packet_len = 0;
  pkt->l7_protocol_info = NULL;

  pkt->tcp_retransmission = 0;
  pkt->udp_retransmission = 0;


  pkt->packet_direction = 0; // Assuming bi-directional communication by default.