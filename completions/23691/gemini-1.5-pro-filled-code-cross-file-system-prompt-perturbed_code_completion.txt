memset(&pkt->http_line, 0, sizeof(pkt->http_line));
  pkt->host_line.ptr = NULL;
  pkt->host_line.len = 0;
  pkt->user_agent_line.ptr = NULL;
  pkt->user_agent_line.len = 0;
  pkt->referer_line.ptr = NULL;
  pkt->referer_line.len = 0;
  pkt->content_type_line.ptr = NULL;
  pkt->content_type_line.len = 0;
  pkt->server_line.ptr = NULL;
  pkt->server_line.len = 0;
  pkt->transfer_encoding_line.ptr = NULL;
  pkt->transfer_encoding_line.len = 0;
  pkt->upgrade_line.ptr = NULL;
  pkt->upgrade_line.len = 0;
  pkt->connection_line.ptr = NULL;
  pkt->connection_line.len = 0;
  pkt->location_line.ptr = NULL;
  pkt->location_line.len = 0;
  pkt->x_cdn_cache_line.ptr = NULL;
  pkt->x_cdn_cache_line.len = 0;

  int i;
  for (i = 0; i < pkt->num_lines; i++) {
    pkt->line[i].ptr = NULL;
    pkt->line[i].len = 0;
  }
  pkt->num_lines = 0;