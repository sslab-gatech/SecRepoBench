memset(pkt, 0, sizeof(struct ndpi_packet_struct));
  pkt->payload = NULL;
  pkt->payload_packet_len = 0;
  pkt->l4_packet_len = 0;
  pkt->l3_packet_len = 0;
  pkt->parsed_lines = 0;
  pkt->http_num_headers = 0;
  pkt->empty_line_position = 0;
  pkt->empty_line_position_set = 0;
  pkt->tcp_retransmission = 0;
  pkt->packet_direction = 0;
  pkt->packet_lines_parsed_complete = 0;
  pkt->num_retried_bytes = 0;
  pkt->actual_payload_len = 0;
  pkt->iph = NULL;
  pkt->tcp = NULL;
  pkt->udp = NULL;
  pkt->generic_l4_ptr = NULL;
#ifdef NDPI_DETECTION_SUPPORT_IPV6
  pkt->iphv6 = NULL;
#endif /* NDPI_DETECTION_SUPPORT_IPV6 */
  memset(&pkt->http_response, 0, sizeof(pkt->http_response));
  memset(&pkt->server_line, 0, sizeof(pkt->server_line));
  memset(&pkt->host_line, 0, sizeof(pkt->host_line));
  memset(&pkt->forwarded_line, 0, sizeof(pkt->forwarded_line));
  memset(&pkt->content_line, 0, sizeof(pkt->content_line));
  memset(&pkt->http_encoding, 0, sizeof(pkt->http_encoding));
  memset(&pkt->http_transfer_encoding, 0, sizeof(pkt->http_transfer_encoding));
  memset(&pkt->http_contentlen, 0, sizeof(pkt->http_contentlen));
  memset(&pkt->content_disposition_line, 0, sizeof(pkt->content_disposition_line));
  memset(&pkt->http_cookie, 0, sizeof(pkt->http_cookie));
  memset(&pkt->http_origin, 0, sizeof(pkt->http_origin));
  memset(&pkt->http_x_session_type, 0, sizeof(pkt->http_x_session_type));
  memset(&pkt->accept_line, 0, sizeof(pkt->accept_line));
  memset(&pkt->referer_line, 0, sizeof(pkt->referer_line));
  memset(&pkt->user_agent_line, 0, sizeof(pkt->user_agent_line));