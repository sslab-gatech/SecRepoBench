if (pkt->host_line.ptr != NULL) {
    free(pkt->host_line.ptr);
    pkt->host_line.ptr = NULL;
    pkt->host_line.len = 0;
  }

  if (pkt->http_url.ptr != NULL) {
    free(pkt->http_url.ptr);
    pkt->http_url.ptr = NULL;
    pkt->http_url.len = 0;
  }

  for (int i = 0; i < pkt->num_lines; i++) {
    free(pkt->line[i].ptr);
    pkt->line[i].ptr = NULL;
    pkt->line[i].len = 0;
  }
  pkt->num_lines = 0;