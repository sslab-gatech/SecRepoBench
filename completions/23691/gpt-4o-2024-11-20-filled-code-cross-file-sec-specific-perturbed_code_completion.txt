if (pkt == NULL) {
    return;
  }

  // Reset pointers to NULL
  pkt->payload = NULL;
  pkt->host_line.ptr = NULL;
  for (int i = 0; i < MAX_LINES; i++) {
    pkt->line[i].ptr = NULL;
  }

  // Reset integers and lengths to 0
  pkt->payload_packet_len = 0;
  pkt->host_line.len = 0;
  for (int i = 0; i < MAX_LINES; i++) {
    pkt->line[i].len = 0;
  }

  // Reset other fields as necessary
  pkt->packet_direction = 0;
  pkt->detected_protocol_stack[0] = 0;
  pkt->detected_protocol_stack[1] = 0;
  pkt->num_detected_protocols = 0;