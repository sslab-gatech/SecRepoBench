ref = xmlXIncludeNewRef(include_context, cur);
            if (ref == NULL) {
                xmlXIncludeErr(include_context, cur, XML_XINCLUDE_NO_MEMORY,
                               "failed to create XInclude reference\n", NULL);
                return -1;
            }
            if (xmlXIncludeLoadNode(include_context, ref) < 0) {
                xmlXIncludeErr(include_context, cur, XML_XINCLUDE_RECURSION,
                               "failed to load XInclude node\n", NULL);
                return -1;
            }
            include_context->incTotal++;
            if (include_context->incTotal > XML_XINCLUDE_MAX_DEPTH) {
                xmlXIncludeErr(include_context, cur, XML_XINCLUDE_RECURSION,
                               "XInclude processing exceeded maximum depth\n", NULL);
                return -1;
            }
            ref->inc = xmlXIncludeCopyRange(include_context, ref->fragment);
            if (ref->inc == NULL) {
                xmlXIncludeErr(include_context, cur, XML_XINCLUDE_NO_MEMORY,
                               "failed to copy XInclude range\n", NULL);
                return -1;
            }
            ref->replace = 1;