{
#ifdef FUZZING_MODE
    /* In fuzzing mode, prevent excessive inclusions */
    if (include_context->incCount >= MAX_DIRECT_INCLUDES) {
        xmlXIncludeWarn(include_context, cur,
            XML_XINCLUDE_LIMIT_EXCEEDED,
            "Fuzzing mode: reached maximum number of direct inclusions, skipping expansion\n");
        /* Skip expansion for this node */
        goto next_node;
    }
#endif

    {
        xmlXIncludeRefPtr newRef = (xmlXIncludeRefPtr) xmlMalloc(sizeof(*newRef));
        if (newRef == NULL) {
            xmlXIncludeErr(include_context, cur, XML_XINCLUDE_MEMORY_ERROR,
                           "Memory allocation failed for include reference\n");
        } else {
            memset(newRef, 0, sizeof(*newRef));
            newRef->elem = cur;
            newRef->replace = 1; /* mark this node to be replaced in second phase */
            /* Attempt to expand the include */
            if (xmlXIncludeLoadNode(include_context, newRef) == 0) {
                newRef->direct = 1; /* mark as direct include */
                include_context->incTab[include_context->incNr++] = newRef;
#ifdef FUZZING_MODE
                include_context->incCount++;
#endif
            } else {
                /* Safe free: free and set pointer to NULL to avoid reuse-after-free */
                xmlFree(newRef);
                newRef = NULL;
            }
        }
    }
next_node:
    /* Continue processing the document tree */
}