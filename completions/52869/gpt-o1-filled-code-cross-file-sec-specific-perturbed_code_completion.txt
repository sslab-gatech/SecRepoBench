xmlXIncludeRefPtr ref;

ref = xmlXIncludeNewRef(include_context, cur);
if (ref != NULL) {
    /* Attempt to load the referenced content */
    if (xmlXIncludeLoadNode(include_context, ref) >= 0) {
        /* Mark this XInclude node for replacement in the second phase */
        ref->replace = 1;
    }

    /* If in fuzzing mode, limit the number of expansions to prevent excessive growth */
    if ((include_context->fuzz != 0) && (include_context->incNr > 1000)) {
        xmlXIncludeErr(include_context, cur, XML_XINCLUDE_RECURSION,
                       "Fuzzing limit exceeded\n", NULL);
        return(-1);
    }
}