ref = xmlXIncludeAddRef(include_context, cur, NULL);
if (ref!= NULL) {
    include_context->incNr++;
    if (include_context->incNr > include_context->incMax) {
        include_context->incMax *= 2;
        include_context->incTab = (xmlXIncludeRefPtr *)
            xmlRealloc(include_context->incTab,
                       include_context->incMax *
                       sizeof(xmlXIncludeRefPtr));
    }
    include_context->incTab[include_context->incNr - 1] = ref;
    if (xmlXIncludeIncludeNode(include_context, ref) == 0) {
        cur->flags |= XML_XINCLUDE_START_0;
    } else {
        include_context->incNr--;
        xmlXIncludeFreeRef(include_context, ref);
    }
    if ((include_context->flags & XML_XINCLUDE_PARSE_FUZZING) &&
        (include_context->incNr >= XML_XINCLUDE_MAX_INCLUSIONS)) {
        xmlXIncludeErr(include_context, cur, XML_XINCLUDE_RECURSION,
                       "XInclude recursion limit exceeded\n", NULL);
        return(-1);
    }
}