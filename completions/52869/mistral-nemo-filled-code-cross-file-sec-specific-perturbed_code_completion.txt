if (xmlXIncludeTestNode(include_context, cur) == 1) {
    xmlNodePtr newNode = xmlXIncludeCopyRange(include_context, cur);
    if (newNode != NULL) {
        xmlAddChild(tree, newNode);
        include_context->incNr++;
        include_context->incTab = (xmlXIncludeRefPtr *) xmlRealloc(include_context->incTab, sizeof(xmlXIncludeRefPtr) * (include_context->incNr + 1));
        include_context->incTab[include_context->incNr - 1] = xmlXIncludeNewRef(include_context, newNode);
    }
} else if ((cur->children != NULL) &&
           ((cur->type == XML_DOCUMENT_NODE) ||
            (cur->type == XML_ELEMENT_NODE))) {
    cur = cur->children;
    continue;
}