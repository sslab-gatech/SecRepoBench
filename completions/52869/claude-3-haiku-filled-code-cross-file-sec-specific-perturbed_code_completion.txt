// Expand the current node and increment the total inclusion count.
// Mark the node as a direct include if the expansion is successful.
// If in fuzzing mode, limit the total number of expansions to prevent excessive growth.
if (xmlXIncludeTestNode(include_context, cur) == 1) {
    if (include_context->incNr < include_context->incMax) {
        include_context->incTab[include_context->incNr] = xmlXIncludeAddNode(include_context, cur);
        if (include_context->incTab[include_context->incNr] != NULL) {
            include_context->incTab[include_context->incNr]->direct = 1;
            include_context->incNr++;
        }
    } else {
        xmlXIncludeErr(include_context, cur, XML_XINCLUDE_MAX_FALLBACK_DEPTH,
                       "Maximum number of expansions reached, skipping %s\n",
                       cur->name);
    }
}