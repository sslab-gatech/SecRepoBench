ref = xmlXIncludeNewRef(include_context, cur);
            if (ref != NULL) {
                if (xmlXIncludeLoadNode(include_context, ref) == 0) {
                    ref->replace = 1;
                    include_context->incTab[include_context->incNr++] = ref;
#ifdef LIBXML_XINCLUDE_FUZZING
                    if (include_context->incNr > 10000) {
                        xmlXIncludeErr(include_context, cur, XML_XINCLUDE_TOO_MANY_INCLUDES,
                                       "Too many includes, possible entity expansion attack\n", NULL);
                        return(-1);
                    }
#endif
                } else {
                    xmlXIncludeFreeRef(ref);
                }
            }