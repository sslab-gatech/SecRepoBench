ref = xmlXIncludeNewRef(include_context, cur);
            if (ref == NULL)
                return (-1);

            if (include_context->options & XML_XINCLUDE_RECURSION) {
                /* no-op */
            } else if (xmlHashLookup(include_context->cache,
                                       cur->doc->URL) != NULL) {
                xmlXIncludeErr(include_context, cur,
                               XML_XINCLUDE_RECURSION,
                               "recursion detected on %s\n", cur->doc->URL);
                ref->replace = 0;
                continue;
            }

            if (xmlXIncludeLoadNode(include_context, ref) >= 0) {
                ref->incNr = include_context->incNr;
                ref->replace = 1;
                if (include_context->incTab == NULL) {
                    include_context->incMax = 16;
                    include_context->incTab = (xmlXIncludeRefPtr *)
                        xmlMalloc(include_context->incMax *
                                  sizeof(xmlXIncludeRefPtr));
                    if (include_context->incTab == NULL) {
                        xmlXIncludeFreeRef(ref);
                        return (-1);
                    }
                }
                if (include_context->incNr >= include_context->incMax) {
                    include_context->incMax *= 2;
                    include_context->incTab = (xmlXIncludeRefPtr *)
                        xmlRealloc(include_context->incTab,
                                   include_context->incMax *
                                   sizeof(xmlXIncludeRefPtr));
                    if (include_context->incTab == NULL) {
                        xmlXIncludeFreeRef(ref);
                        return (-1);
                    }
                }
                include_context->incTab[include_context->incNr++] = ref;
                if (include_context->options & XML_XINCLUDE_DIRECT_INCLUDE)
                    ref->direct = 1;
                if (include_context->fuzzing) {
                    include_context->nb_process++;
                    if (include_context->nb_process > 200)
                        return (1);
                }
            } else {
                xmlXIncludeFreeRef(ref);
            }