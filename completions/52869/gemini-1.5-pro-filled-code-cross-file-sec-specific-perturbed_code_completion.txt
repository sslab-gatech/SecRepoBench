ref = xmlXIncludeNewRef(include_context, cur);
            if (ref != NULL) {
                if (xmlXIncludeLoadNode(include_context, ref) >= 0) {
                    include_context->incNr++;
                    if (include_context->incNr >= include_context->incMax) {
                        xmlXIncludeRefPtr *tmp;
                        int len = include_context->incMax * 2;

                        tmp = (xmlXIncludeRefPtr *)
                            xmlRealloc(include_context->incTab,
                                       len * sizeof(xmlXIncludeRefPtr));
                        if (tmp == NULL) {
                            xmlXIncludeErrMemory(include_context, "processing\n");
                            xmlFree(ref);
                            return (-1);
                        }
                        include_context->incTab = tmp;
                        include_context->incMax = len;
                    }
                    include_context->incTab[include_context->incNr - 1] = ref;
                    if (include_context->fuzz != 0) {
                        if (include_context->incNr >=
                            XML_XINCLUDE_FUZZ_MAX_INCLUSIONS) {
                            xmlXIncludeErr(include_context, cur,
                                           XML_XINCLUDE_TOO_MANY_INCLUSIONS,
                                           "Too many nested includes, fuzzing limit reached\n",
                                           NULL);
                            return (-1);
                        }
                    }
                } else {
                    xmlFree(ref);
                }
            }