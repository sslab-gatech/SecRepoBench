// Expand the current node and increment the total inclusion count.
// Mark the node as a direct include if the expansion is successful.
// If in fuzzing mode, limit the total number of expansions to prevent excessive growth.
if (xmlXIncludeTestNode(include_context, cur) == 1) {
    if (include_context->incNr < include_context->incMax) {
        xmlXIncludeRefPtr ref = &include_context->incTab[include_context->incNr++];
        ref->elem = cur;
        ref->replace = 1;
        if (xmlXIncludeLoadNode(include_context, ref) == 0) {
            ref->direct = 1;
        }
        if (include_context->fuzzy && (include_context->incNr >= include_context->incMax)) {
            return include_context->incNr;
        }
    }
}