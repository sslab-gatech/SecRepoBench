// Expand the current node and increment the total inclusion count.
// Mark the node as a direct include if the expansion is successful.
// If in fuzzing mode, limit the total number of expansions to prevent excessive growth.
if (xmlXIncludeTestNode(include_context, cur) == 1) {
    if (include_context->incNr < include_context->incMax) {
        if (xmlXIncludeIncludeNode(include_context, cur) == 0) {
            include_context->incTab[include_context->incNr++]->direct = 1;
        }
        if (include_context->fuzzing && (include_context->incNr >= include_context->incMax)) {
            break;
        }
    } else {
        xmlXIncludeErr(include_context, cur, XML_XINCLUDE_MAX_INCLUDED,
                       "Maximum number of included nodes reached\n", NULL);
        break;
    }
}