// <MASK>
if (xmlXIncludeTestNode(include_context, cur) == 1) {
    // Expand the current node and increment the total inclusion count.
    // Mark the node as a direct include if the expansion is successful.
    // If in fuzzing mode, limit the total number of expansions to prevent excessive growth.
    if (xmlXIncludeLoadNode(include_context, ref) < 0) {
        xmlXIncludeErr(include_context, cur, XML_XINCLUDE_LOAD_ERROR,
                       "Failed to load %s\n", ref->elem->name);
        return(-1);
    }
    if (include_context->incNr >= include_context->incMax) {
        include_context->incMax *= 2;
        include_context->incTab = (xmlXIncludeRefPtr *)
            xmlRealloc(include_context->incTab,
                       include_context->incMax * sizeof(xmlXIncludeRefPtr));
        if (include_context->incTab == NULL) {
            xmlXIncludeErr(include_context, cur, XML_XINCLUDE_MEMORY_ERROR,
                           "Failed to allocate memory for include\n");
            return(-1);
        }
    }
    include_context->incTab[include_context->incNr] = ref;
    include_context->incNr++;
    if (include_context->incNr >= include_context->incMax) {
        xmlXIncludeErr(include_context, cur, XML_XINCLUDE_TOO_MANY_INCLUDES,
                       "Too many includes\n");
        return(-1);
    }
    if (include_context->fuzzing) {
        if (include_context->incNr >= include_context->fuzzingLimit) {
            xmlXIncludeErr(include_context, cur, XML_XINCLUDE_FUZZING_LIMIT,
                           "Fuzzing limit reached\n");
            return(-1);
        }
    }
    if (include_context->incTab[include_context->incNr - 1]->replace!= 0) {
        xmlXIncludeIncludeNode(include_context, include_context->incTab[include_context->incNr - 1]);
        include_context->incTab[include_context->incNr - 1]->replace = 0;
    }
    ret++;
}