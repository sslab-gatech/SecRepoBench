xmlXIncludeRefPtr ref = xmlXIncludeNewRef(include_context, cur);
            if (ref == NULL) continue;
            if (include_context->incNr >= include_context->incMax) {
                int newMax = (include_context->incMax ? include_context->incMax * 2 : 4);
                xmlXIncludeRefPtr* newTab = (xmlXIncludeRefPtr*)xmlRealloc(
                    include_context->incTab, newMax * sizeof(xmlXIncludeRefPtr));
                if (!newTab) {
                    xmlFree(ref);
                    continue;
                }
                include_context->incTab = newTab;
                include_context->incMax = newMax;
            }
            include_context->incTab[include_context->incNr++] = ref;
            ref->replace = 1;
            ret++;
            if ((include_context->options & XML_XINCLUDE_FUZZING) && 
                (include_context->incNr >= XML_XINCLUDE_MAX_EXPANSIONS)) {
                break;
            }