xmlXIncludeRefPtr ref = xmlXIncludeNewRef(include_context, cur);
        if (ref) {
            /* Mark this inclusion as direct */
            ref->replace = 1;

            /* If fuzzing mode is enabled, limit the total number of expansions */
#ifdef XML_FUZZ_ENABLED
            if (include_context->incNr >= 1024) {
                xmlXIncludeErr(include_context, cur, XML_XINCLUDE_EXPANSION_TOO_LARGE,
                               "Too many expansions in fuzzing mode\n", NULL);
                continue;
            }
#endif

            /* Increase the size of incTab if necessary */
            if (include_context->incNr >= include_context->incMax) {
                xmlXIncludeReallocRefTab(include_context, include_context->incMax * 2);
            }

            /* Add the reference to the context and increment the total inclusion count */
            include_context->incTab[include_context->incNr++] = ref;
        }