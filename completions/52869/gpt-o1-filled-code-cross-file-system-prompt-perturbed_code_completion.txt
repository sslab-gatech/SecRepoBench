ref = xmlXIncludeNewRef(include_context, cur);
if (ref != NULL) {
    /*
     * Attempt to load/expand the node.
     */
    xmlXIncludeLoadNode(include_context, ref);
    /*
     * If the expansion was successful (either some content was loaded
     * or the fallback is empty), mark this as a direct include.
     */
    if ((ref->inc != NULL) || (ref->emptyFb != 0)) {
        ref->replace = 1;
        ret++;
        /*
         * If fuzzing is enabled, limit how many expansions we perform
         * to avoid excessive growth.
         */
        if (include_context->fuzz && (ret > 1024)) {
            xmlXIncludeErr(include_context, cur, XML_XINCLUDE_RECURSION,
                           "Fuzzing limit reached, aborting expansion\n",
                           NULL);
            break;
        }
    }
}