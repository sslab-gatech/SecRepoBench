parsed_object = result.data;
    if (parsed_object.type != MSGPACK_OBJECT_ARRAY || parsed_object.via.array.size != 2) {
        continue;
    }

    /* Unpack timestamp */
    if (flb_mp_unpack_time(&parsed_object.via.array.ptr[0], &tms) != 0) {
        continue;
    }

    /* Get the record map */
    map = parsed_object.via.array.ptr[1];
    if (map.type != MSGPACK_OBJECT_MAP) {
        continue;
    }

    map_size = map.via.map.size;
    if (date_key != NULL) {
        map_size++;
    }