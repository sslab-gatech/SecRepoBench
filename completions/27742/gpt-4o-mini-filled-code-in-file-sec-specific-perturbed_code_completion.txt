if (map_size == 2) {
            /* Ensure the root object is an array with two elements */
            if (root->type != MSGPACK_OBJECT_ARRAY || root->via.array.size != 2) {
                msgpack_unpacked_destroy(&result);
                return NULL;
            }

            /* Unpack the timestamp */
            if (root->via.array.ptr[0].type != MSGPACK_OBJECT_POSITIVE_INTEGER &&
                root->via.array.ptr[0].type != MSGPACK_OBJECT_FLOAT) {
                msgpack_unpacked_destroy(&result);
                return NULL;
            }
            flb_time_pop_from_msgpack(&tms, &result, &obj);

            /* Assign the second element of the array to a map object */
            map = root->via.array.ptr[1];
            if (map.type != MSGPACK_OBJECT_MAP) {
                msgpack_unpacked_destroy(&result);
                return NULL;
            }
            map_size = map.via.map.size;
        } else {
            msgpack_unpacked_destroy(&result);
            return NULL;
        }