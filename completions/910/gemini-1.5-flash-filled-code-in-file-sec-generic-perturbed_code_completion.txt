if (io == NULL) {
        _cmsUnlockMutex(Icc->ContextID, Icc ->UsrMutex);
        return NULL;
    }

    TagDescriptor = _cmsGetTagDescriptor(Icc->ContextID, tagSignature);
    if (TagDescriptor == NULL) goto Error;

    BaseType = TagDescriptor ->SupportedTypes[0];
    if (!IsTypeSupported(TagDescriptor, BaseType)) goto Error;

    // Check if the tag size is valid.
    if (TagSize == 0) goto Error;

    // Seek to the tag's location in the IO handler.
    if (!io ->Seek(io, Offset)) goto Error;

    // Read the tag's base type.