if (!io->Seek(io, Offset)) goto Error;

    // Read the type signature (4 bytes)
    {
        cmsUInt32Number tmp;
        if (!io->Read(io, &tmp, sizeof(tmp), 1)) goto Error;
        BaseType = _cmsAdjustEndianess32(tmp);
    }

    // Skip reserved (another 4 bytes)
    if (!io->Seek(io, io->Tell(io) + 4)) goto Error;

    // Check if the type is supported
    TagDescriptor = _cmsGetTagDescriptor(Icc->ContextID, tagSignature);
    if (TagDescriptor == NULL) goto Error;
    if (!IsTypeSupported(TagDescriptor, BaseType)) goto Error;

    // Adjust TagSize to account for the 8-byte base type header
    TagSize -= 8;