if (!io->Seek(io, Offset)) goto Error; // Seek to the tag's location
    if (!io->Read(io, &BaseType, sizeof(cmsTagTypeSignature), 1)) goto Error; // Read the base type

    BaseType = _cmsAdjustEndianess32(BaseType); // Adjust endianness
    if (BaseType == 0) goto Error; // Check for valid type

    // Ensure the tag size is valid
    if (TagSize < sizeof(cmsTagTypeSignature)) {
        cmsSignalError(Icc->ContextID, cmsERROR_CORRUPTION_DETECTED, "Invalid tag size for '%s'", tagSignature);
        goto Error;
    }