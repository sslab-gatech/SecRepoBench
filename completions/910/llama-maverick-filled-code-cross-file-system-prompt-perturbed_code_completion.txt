if (!io ->Seek(io, Offset)) goto Error;
if (!io ->Read(io, &BaseType, sizeof(cmsTagTypeSignature), 1)) goto Error;

TagSize -= sizeof(cmsTagTypeSignature);
if (TagSize <= 0) goto Error;

TagDescriptor = _cmsGetTagDescriptor(Icc->ContextID, tagSignature);
if (TagDescriptor == NULL) goto Error;

if (!IsTypeSupported(TagDescriptor, BaseType)) goto Error;