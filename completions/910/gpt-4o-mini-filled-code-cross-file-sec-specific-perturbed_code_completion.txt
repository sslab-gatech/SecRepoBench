if (!Icc->IOhandler->Seek(io, Offset)) goto Error;
if (!Icc->IOhandler->Read(io, NULL, 1, TagSize)) goto Error;

// Ensure that the TagSize is valid and does not exceed the maximum allowed size
if (TagSize > MAX_TAG_SIZE) {
    cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Tag size exceeds maximum allowed size");
    goto Error;
}