// Seek to the tag's location in the IO handler
if (!io->Seek(io, Offset)) goto Error;

// Check if the tag is supported by reading the base type signature from the file
if (!io->Read(io, &BaseType, sizeof(cmsTagTypeSignature), 1)) goto Error;

// Adjust the size to account for the tag's base type header (4 bytes)
TagSize -= sizeof(cmsTagTypeSignature);

// Ensure the size does not become negative after adjustment
if (TagSize < 0) goto Error;

// Validate the base type against the tag descriptor
TagDescriptor = _cmsGetTagDescriptor(Icc->ContextID, tagSignature);
if (TagDescriptor == NULL) goto Error;

if (!IsTypeSupported(TagDescriptor, BaseType)) goto Error;