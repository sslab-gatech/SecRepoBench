if (!io->Seek(io, Offset)) {
    cmsSignalError(Icc->ContextID, cmsERROR_FILE, "Seek error; probably corrupted file");
    goto Error;
}

TagDescriptor = _cmsGetTagDescriptor(Icc->ContextID, tagSignature);
if (TagDescriptor == NULL) {
    cmsSignalError(Icc->ContextID, cmsERROR_UNKNOWN_EXTENSION, "Unsupported tag '%x'", tagSignature);
    goto Error;
}

if (!_cmsReadTypeBase(io, &BaseType)) {
    cmsSignalError(Icc->ContextID, cmsERROR_FILE, "Error reading type signature");
    goto Error;
}

if (!IsTypeSupported(TagDescriptor, BaseType)) {
    char TypeString[5], SigString[5];
    _cmsTagSignature2String(TypeString, (cmsTagSignature) BaseType);
    _cmsTagSignature2String(SigString, tagSignature);
    cmsSignalError(Icc->ContextID, cmsERROR_UNKNOWN_EXTENSION, "Unsupported type '%s' for tag '%s'", TypeString, SigString);
    goto Error;
}

TagSize -= 8; // Subtract the tag's base type header size