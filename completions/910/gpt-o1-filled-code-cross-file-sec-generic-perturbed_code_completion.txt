// Seek to the tag's location in the IO handler.
    if (!io->Seek(io, Offset)) goto Error;

    // Check we have enough bytes for at least the base type header (signature + reserved)
    if (TagSize < 8) goto Error;

    // Read the base type signature
    {
        cmsUInt32Number rawSig;
        cmsUInt32Number rawReserved;

        if (!io->Read(io, &rawSig, sizeof(rawSig), 1)) goto Error;
        BaseType = (cmsTagTypeSignature)_cmsAdjustEndianess32(rawSig);

        // Read and discard the reserved portion
        if (!io->Read(io, &rawReserved, sizeof(rawReserved), 1)) goto Error;

        // Adjust TagSize after reading the base type header
        TagSize -= 8;
    }

    // Check if this base type is supported by the tag descriptor
    TagDescriptor = _cmsGetTagDescriptor(Icc->ContextID, tagSignature);
    if (TagDescriptor == NULL) goto Error;
    if (!IsTypeSupported(TagDescriptor, BaseType)) goto Error;