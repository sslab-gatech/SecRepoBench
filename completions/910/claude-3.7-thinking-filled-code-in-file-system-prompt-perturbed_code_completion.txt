// Seek to begin of tag
if (!io -> Seek(io, Offset)) goto Error;

// Base type is always positioned in the first 4 bytes
if (!_cmsReadUInt32Number(io, &BaseType)) goto Error;

// Get the tag descriptor for this tag
TagDescriptor = _cmsGetTagDescriptor(Icc-> ContextID, tagSignature);
if (TagDescriptor == NULL) goto Error;

// Check that the type is supported by the tag descriptor
if (!IsTypeSupported(TagDescriptor, BaseType)) {
    char TypeString[5], TagString[5];

    _cmsTagSignature2String(TypeString, (cmsTagSignature) BaseType);
    _cmsTagSignature2String(TagString, tagSignature);

    cmsSignalError(Icc ->ContextID, cmsERROR_UNKNOWN_EXTENSION, "Unsupported type '%s' for tag '%s'", TypeString, TagString);
    goto Error;
}

// Adjust the size to the remaining portion after the type
TagSize -= sizeof(cmsUInt32Number);