// Seek to the tag's location in the IO handler.
if (!io->Seek(io, Offset)) goto Error;

// Check if the tag is supported.
BaseType = _cmsReadTypeBase(io);
if (BaseType == 0) goto Error;

// Change the tag size to account for the tag's base type header.
TagSize -= sizeof(cmsTagTypeSignature);

// Ensure that the remaining TagSize is not negative after adjustment
if (TagSize < 0) goto Error;

// Ensure TagSize does not exceed a predefined maximum to prevent heap overflow
if (TagSize > MAX_ALLOWED_TAG_SIZE) goto Error;