TagDescriptor = _cmsGetTagDescriptor(Icc->ContextID, tagSignature);
    if (TagDescriptor == NULL) goto Error;

    // Check if the tag is supported. If not, exit.
    BaseType = TagDescriptor->SupportedTypes[0];
    if (!IsTypeSupported(TagDescriptor, BaseType)) goto Error;

    // Change the tag size to account for the tag's base type header.
    if (!_cmsReadTypeBase(io, &BaseType, &TagSize)) goto Error;

    if (TagSize > TagSize) {
        cmsSignalError(Icc ->ContextID, cmsERROR_CORRUPTION_DETECTED, "Corrupted tag '%x'", tagSignature);
        goto Error;
    }