if (!io->Seek(io, Offset)) goto Error;

// Read base type signature
if (!io->Read(io, &BaseType, sizeof(cmsTagTypeSignature), 1)) goto Error;

// ICC tags are big-endian, so swap if needed
BaseType = _cmsAdjustEndianess32(BaseType);

// Get tag descriptor
TagDescriptor = _cmsGetTagDescriptor(Icc->ContextID, tagSignature);
if (TagDescriptor == NULL) goto Error;

// Check if type is supported
if (!IsTypeSupported(TagDescriptor, BaseType)) goto Error;

// Adjust TagSize to exclude the 4-byte type signature
if (TagSize < sizeof(cmsTagTypeSignature)) goto Error;
TagSize -= sizeof(cmsTagTypeSignature);