if (!io ->Seek(io, Offset)) goto Error;

    // Get tag descriptor
    TagDescriptor = _cmsGetTagDescriptor(Icc->ContextID, tagSignature);
    if (TagDescriptor == NULL) goto Error;

    // Read base tag type, usually is the tag type
    if (!_cmsReadTypeBase(io, &BaseType)) goto Error;

    // Check if the type is supported. If the type is not supported, just
    // read the tag as raw data.
    if (!IsTypeSupported(TagDescriptor, BaseType)) {

        void* rawdata;

        if (TagSize > UINT_MAX - sizeof(cmsTagBase)) goto Error;
        rawdata = _cmsMalloc(Icc ->ContextID, TagSize + sizeof(cmsTagBase));
        if (rawdata == NULL) goto Error;

        if (!io ->Seek(io, Offset)) goto Error;
        if (!io ->Read(io, rawdata, 1, TagSize)) goto Error;

        Icc -> TagPtrs[n] = rawdata;
        Icc -> TagTypeHandlers[n] = NULL;
        Icc ->TagSaveAsRaw[n] = TRUE;
        _cmsUnlockMutex(Icc->ContextID, Icc ->UsrMutex);
        return Icc -> TagPtrs[n];
    }

    // Adjust tag size to account for the tag's base type header.
    TagSize -= sizeof(cmsTagBase);
    if (TagSize < 0) goto Error;