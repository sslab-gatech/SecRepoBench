// Seek to the tag's location in the IO handler
if (!io->Seek(io, Offset)) goto Error;

// Read the base type signature
if (!_cmsReadUInt32Number(io, &BaseType)) goto Error;

// Get the tag descriptor
TagDescriptor = _cmsGetTagDescriptor(Icc->ContextID, tagSignature);
if (TagDescriptor == NULL) goto Error;

// Check if the type is supported
if (!IsTypeSupported(TagDescriptor, BaseType)) goto Error;

// Adjust tag size to account for the tag's base type header
if (TagSize < sizeof(cmsTagTypeSignature)) goto Error;
TagSize -= sizeof(cmsTagTypeSignature);