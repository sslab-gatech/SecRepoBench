if (!io->Seek(io, Offset))
    goto Error;

// Read base type signature (4 bytes)
if (io->Read(io, &BaseType, sizeof(cmsTagTypeSignature), 1) != 1)
    goto Error;

// Skip the reserved 4 bytes in the tag header
{
    cmsUInt32Number reserved;
    if (io->Read(io, &reserved, 4, 1) != 1)
        goto Error;
}

if (!IsTypeSupported(TagDescriptor, BaseType))
    goto Error;

// Adjust TagSize to remove the base type header (8 bytes)
if (TagSize < 8)
    goto Error;
TagSize -= 8;