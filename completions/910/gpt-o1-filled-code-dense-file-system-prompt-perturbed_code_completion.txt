if (!io->Seek(io, Offset)) goto Error;

// Read base type from the tag
BaseType = _cmsReadTypeBase(io);
if (BaseType == 0) goto Error;

// Check if it is supported
TagDescriptor = _cmsGetTagDescriptor(Icc->ContextID, tagSignature);
if (TagDescriptor == NULL) goto Error;

if (!IsTypeSupported(TagDescriptor, BaseType)) goto Error;

// Adjust size to account for base header
TagSize -= 8;