if (TagSize < 8) goto Error;
if (!io->Seek(io, Offset)) goto Error;

{
    cmsTagTypeSignature readType;
    if (!io->Read(io, &readType, sizeof(readType), 1)) goto Error;

    // Check if the read type is supported
    TagDescriptor = _cmsGetTagDescriptor(Icc->ContextID, tagSignature);
    if (TagDescriptor == NULL) goto Error;
    if (!IsTypeSupported(TagDescriptor, readType)) goto Error;

    // Update the tag size to account for the base type header (signature + reserved)
    TagSize -= 8;
    BaseType = readType;

    // Skip the reserved field
    if (!io->Seek(io, io->Tell(io) + 4)) goto Error;
}