// Seek to the tag's location in the IO handler.
    if (!io ->Seek(io, Offset)) goto Error;

    // Check if the tag is supported.
    if (!io ->Seek(io, Offset)) goto Error;
    if (!io ->Read(io, &BaseType, sizeof(cmsTagTypeSignature), 1)) goto Error;

    // If the type is unsupported, exit. 
    TypeHandler = _cmsGetTagTypeHandler(Icc ->ContextID, BaseType);
    if (TypeHandler == NULL) goto Error;

    // Change the tag size to account for the tag's base type header.
    if (!io ->Seek(io, Offset)) goto Error;
    if (!io ->Read(io, &TagSize, sizeof(cmsUInt32Number), 1)) goto Error;
    TagSize -= sizeof(cmsTagTypeSignature); // Subtract the header size