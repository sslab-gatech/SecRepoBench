if (r <= 0) {
    PLIST_JSON_ERR("%s: No tokens found in JSON string\n", __func__);
    free(tokens);
    return PLIST_ERR_PARSE;
}

// Create a structure to hold token information
jsmntok_info_t token_info;
token_info.tokens = tokens;
token_info.count = r;

// Parse based on the type of the first token
switch (tokens[startindex].type) {
    case JSMN_OBJECT:
        *plist = parse_object(jsonstr, &token_info, &startindex);
        break;
    case JSMN_ARRAY:
        *plist = parse_array(jsonstr, &token_info, &startindex);
        break;
    case JSMN_STRING:
        *plist = parse_string(jsonstr, &token_info, &startindex);
        break;
    case JSMN_PRIMITIVE:
        *plist = parse_primitive(jsonstr, &token_info, &startindex);
        break;
    default:
        PLIST_JSON_ERR("%s: Invalid token type %d\n", __func__, tokens[startindex].type);
        free(tokens);
        return PLIST_ERR_PARSE;
}

// Check if the parsing was successful
if (*plist == NULL) {
    PLIST_JSON_ERR("%s: Failed to parse JSON string\n", __func__);
    free(tokens);
    return PLIST_ERR_PARSE;
}