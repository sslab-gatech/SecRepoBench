plist_t val = NULL;
switch (ti->tokens[startindex].type) {
    case JSMN_OBJECT:
        val = parse_object(js, ti, &startindex);
        break;
    case JSMN_ARRAY:
        val = parse_array(js, ti, &startindex);
        break;
    case JSMN_STRING:
        val = parse_string(js, ti, &startindex);
        break;
    case JSMN_PRIMITIVE:
        val = parse_primitive(js, ti, &startindex);
        break;
    default:
        PLIST_JSON_ERR("%s: unexpected token type %d\n", __func__, ti->tokens[startindex].type);
        free(tokens);
        return PLIST_ERR_PARSE;
}
if (val) {
    *plist = val;
} else {
    free(tokens);
    return PLIST_ERR_PARSE;
}