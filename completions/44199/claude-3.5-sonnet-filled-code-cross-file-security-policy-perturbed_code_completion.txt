struct token_info {
    jsmntok_t* tokens;
    int count;
};

struct token_info ti = {tokens, r};

if (tokens[startindex].type == JSMN_OBJECT) {
    *plist = parse_object(jsonstr, &ti, &startindex);
} else if (tokens[startindex].type == JSMN_ARRAY) {
    *plist = parse_array(jsonstr, &ti, &startindex);
} else if (tokens[startindex].type == JSMN_STRING) {
    *plist = parse_string(jsonstr, &ti, &startindex);
} else if (tokens[startindex].type == JSMN_PRIMITIVE) {
    *plist = parse_primitive(jsonstr, &ti, &startindex);
} else {
    PLIST_JSON_ERR("%s: Unexpected token type\n", __func__);
    return PLIST_ERR_PARSE;
}

if (*plist == NULL) {
    return PLIST_ERR_PARSE;
}