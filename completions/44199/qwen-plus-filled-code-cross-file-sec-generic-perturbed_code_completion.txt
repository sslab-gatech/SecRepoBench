if (r > 0 && r <= curtoks) {
    jsmntok_info_t tok_info = {tokens, r};
    int idx = 0;

    switch(tokens[idx].type) {
        case JSMN_OBJECT:
            *plist = parse_object(jsonstr, &tok_info, &idx);
            break;
        case JSMN_ARRAY:
            *plist = parse_array(jsonstr, &tok_info, &idx);
            break;
        case JSMN_STRING:
            *plist = parse_string(jsonstr, &tok_info, &idx);
            break;
        case JSMN_PRIMITIVE:
            *plist = parse_primitive(jsonstr, &tok_info, &idx);
            break;
        default:
            PLIST_JSON_ERR("%s: Invalid root token type\n", __func__);
            free(tokens);
            return PLIST_ERR_PARSE;
    }

    if (!*plist) {
        PLIST_JSON_ERR("%s: Failed to parse JSON into plist\n", __func__);
        free(tokens);
        return PLIST_ERR_PARSE;
    }
} else {
    PLIST_JSON_ERR("%s: Invalid number of tokens returned by parser\n", __func__);
    free(tokens);
    return PLIST_ERR_PARSE;
}