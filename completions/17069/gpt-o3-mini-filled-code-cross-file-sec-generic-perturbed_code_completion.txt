do {
	/* ensure there are bits to process */
	if(ucbits == 0)
		break;

	/* read the unary MSBs and the stop bit from the tail word */
	msbs = 0;
	{
		int found_stop = 0;
		uint32_t i;
		for(i = 0; i < ucbits; i++) {
			if(b & (1u << (FLAC__BITS_PER_WORD - 1))) {
				found_stop = 1;
				break;
			}
			msbs++;
			b <<= 1;
		}
		if(!found_stop)
			goto incomplete_msbs; /* not enough bits to find the stop bit */
		/* consume the stop bit */
		b <<= 1;
		ucbits -= (msbs + 1);
	}

	/* read the binary LSBs (parameter bits) from the tail */
	if(parameter > ucbits)
		goto incomplete_lsbs;
	lsbs = (b >> (FLAC__BITS_PER_WORD - parameter)) & ((1u << parameter) - 1);
	b <<= parameter;
	ucbits -= parameter;

	/* compose the value, then decode the signed Rice value */
	x = (msbs << parameter) | lsbs;
	*val++ = (int)(x >> 1) ^ -(int)(x & 1);
} while(cwords >= wordcount && val < end);