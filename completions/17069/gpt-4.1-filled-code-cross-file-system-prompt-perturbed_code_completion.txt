uint32_t msbs, lsbs;
while(val < end) {
	/* read unary MSBs and end bit from the tail (slow path) */
	msbs = 0;
	while(1) {
		if(cwords >= wordcount) {
			/* not enough data */
			return false;
		}
		b = br->buffer[cwords];
		y = COUNT_ZERO_MSBS2(b);
		msbs += y;
		if(y < FLAC__BITS_PER_WORD) {
			b <<= y;
			b <<= 1; /* skip stop bit */
			ucbits = FLAC__BITS_PER_WORD - (y + 1);
			break;
		}
		cwords++;
	}
	/* read the binary LSBs */
	if(parameter <= ucbits) {
		lsbs = (uint32_t)(b >> (FLAC__BITS_PER_WORD - parameter));
		ucbits -= parameter;
		b <<= parameter;
	} else {
		lsbs = (uint32_t)(b >> (FLAC__BITS_PER_WORD - ucbits));
		uint32_t bits_needed = parameter - ucbits;
		cwords++;
		if(cwords >= wordcount) {
			/* not enough data */
			return false;
		}
		b = br->buffer[cwords];
		lsbs = (lsbs << bits_needed) | (uint32_t)(b >> (FLAC__BITS_PER_WORD - bits_needed));
		ucbits = FLAC__BITS_PER_WORD - bits_needed;
		b <<= bits_needed;
	}
	x = (msbs << parameter) | lsbs;
	*val++ = (int)(x >> 1) ^ -(int)(x & 1);
}
break;