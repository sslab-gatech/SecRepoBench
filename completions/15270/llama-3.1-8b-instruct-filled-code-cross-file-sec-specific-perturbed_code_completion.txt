if (av_codec_is_decoder(codeccontext->codec)) {
    if (codeccontext->codec->priv_data_size > 0 && codeccontext->priv_data) {
        if (codeccontext->codec->priv_class && (ret = av_opt_set_dict(codeccontext->priv_data, &tmp)) < 0)
            goto free_and_end;
    }
    if (codeccontext->codec->check_sample_fmt(codeccontext->sample_fmt) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified sample format %s is not supported\n",
               (char *)av_x_if_null(av_get_sample_fmt_name(codeccontext->sample_fmt), "unknown"));
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_sample_rate(codeccontext->sample_rate) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified sample rate %d is not supported\n",
               codeccontext->sample_rate);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_channel_layout(codeccontext->channel_layout) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified channel layout '%s' is not supported\n",
               (char *)av_get_channel_layout_name(codeccontext->channel_layout));
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_bit_rate(codeccontext->bit_rate) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified bitrate %d is not supported\n",
               codeccontext->bit_rate);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_max_b_frames(codeccontext->max_b_frames) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified max_b_frames %d is not supported\n",
               codeccontext->max_b_frames);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_gop_size(codeccontext->gop_size) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified gop_size %d is not supported\n",
               codeccontext->gop_size);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_qscale(codeccontext->qscale) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified qscale %d is not supported\n",
               codeccontext->qscale);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_threads(codeccontext->thread_count) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified thread count %d is not supported\n",
               codeccontext->thread_count);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_lowres(codeccontext->lowres) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified lowres %d is not supported\n",
               codeccontext->lowres);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_flags(codeccontext->flags) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified flags %d are not supported\n",
               codeccontext->flags);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_profile(codeccontext->profile) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified profile %d is not supported\n",
               codeccontext->profile);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_level(codeccontext->level) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified level %d is not supported\n",
               codeccontext->level);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_time_base(codeccontext->time_base) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified time base %d/%d is not supported\n",
               codeccontext->time_base.num, codeccontext->time_base.den);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_sample_aspect_ratio(codeccontext->sample_aspect_ratio) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified sample aspect ratio %d/%d is not supported\n",
               codeccontext->sample_aspect_ratio.num, codeccontext->sample_aspect_ratio.den);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_color_primaries(codeccontext->color_primaries) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified color primaries %d is not supported\n",
               codeccontext->color_primaries);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_color_trc(codeccontext->color_trc) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified color transfer characteristic %d is not supported\n",
               codeccontext->color_trc);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_color_space(codeccontext->color_space) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified color space %d is not supported\n",
               codeccontext->color_space);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_chroma_location(codeccontext->chroma_location) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified chroma location %d is not supported\n",
               codeccontext->chroma_location);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_bits_per_raw_sample(codeccontext->bits_per_raw_sample) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified bits per raw sample %d is not supported\n",
               codeccontext->bits_per_raw_sample);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_profile2(codeccontext->profile2) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified profile2 %d is not supported\n",
               codeccontext->profile2);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_level2(codeccontext->level2) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified level2 %d is not supported\n",
               codeccontext->level2);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_profile3(codeccontext->profile3) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified profile3 %d is not supported\n",
               codeccontext->profile3);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_level3(codeccontext->level3) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified level3 %d is not supported\n",
               codeccontext->level3);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_profile4(codeccontext->profile4) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified profile4 %d is not supported\n",
               codeccontext->profile4);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_level4(codeccontext->level4) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified level4 %d is not supported\n",
               codeccontext->level4);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_profile5(codeccontext->profile5) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified profile5 %d is not supported\n",
               codeccontext->profile5);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_level5(codeccontext->level5) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified level5 %d is not supported\n",
               codeccontext->level5);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_profile6(codeccontext->profile6) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified profile6 %d is not supported\n",
               codeccontext->profile6);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_level6(codeccontext->level6) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified level6 %d is not supported\n",
               codeccontext->level6);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_profile7(codeccontext->profile7) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified profile7 %d is not supported\n",
               codeccontext->profile7);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_level7(codeccontext->level7) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified level7 %d is not supported\n",
               codeccontext->level7);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_profile8(codeccontext->profile8) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified profile8 %d is not supported\n",
               codeccontext->profile8);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_level8(codeccontext->level8) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified level8 %d is not supported\n",
               codeccontext->level8);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_profile9(codeccontext->profile9) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified profile9 %d is not supported\n",
               codeccontext->profile9);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_level9(codeccontext->level9) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified level9 %d is not supported\n",
               codeccontext->level9);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_profile10(codeccontext->profile10) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified profile10 %d is not supported\n",
               codeccontext->profile10);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_level10(codeccontext->level10) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified level10 %d is not supported\n",
               codeccontext->level10);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_profile11(codeccontext->profile11) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified profile11 %d is not supported\n",
               codeccontext->profile11);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_level11(codeccontext->level11) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified level11 %d is not supported\n",
               codeccontext->level11);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_profile12(codeccontext->profile12) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified profile12 %d is not supported\n",
               codeccontext->profile12);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_level12(codeccontext->level12) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified level12 %d is not supported\n",
               codeccontext->level12);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_profile13(codeccontext->profile13) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified profile13 %d is not supported\n",
               codeccontext->profile13);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_level13(codeccontext->level13) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified level13 %d is not supported\n",
               codeccontext->level13);
        ret = AVERROR(EINVAL);
        goto free_and_end;
    }
    if (codeccontext->codec->check_profile14(codeccontext->profile14) < 0) {
        av_log(codeccontext, AV_LOG_ERROR, "Specified profile14 %d is not supported\n",
               codeccontext->profile14);
        re