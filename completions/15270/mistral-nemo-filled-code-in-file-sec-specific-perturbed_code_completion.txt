int avcodec_default_execute2(AVCodecContext *c, int (*func)(AVCodecContext *c2, void *arg2, int jobnr, int threadnr), void *arg, int *ret, int count)
{
    int i;

    for (i = 0; i < count; i++) {
        int r = func(c, (char *)arg + i * size, i, 0);
        if (ret)
            ret[i] = r;
    }
    emms_c();
    return 0;
}