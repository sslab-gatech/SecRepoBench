if (codeccontext->subtitle_header) {
            av_freep(&codeccontext->subtitle_header);
        }
        if (codeccontext->subtitle_header_size > 0) {
            codeccontext->subtitle_header = av_mallocz(codeccontext->subtitle_header_size);
            if (!codeccontext->subtitle_header) {
                return AVERROR(ENOMEM);
            }
            if (codeccontext->subtitle_header_encoding) {
                // Handle character encoding for subtitles
                // Assuming iconv is available and used for conversion
                #if CONFIG_ICONV
                iconv_t cd = iconv_open(codeccontext->subtitle_header_encoding, "UTF-8");
                if (cd == (iconv_t)-1) {
                    av_log(codeccontext, AV_LOG_ERROR, "Failed to open iconv for encoding: %s\n", codeccontext->subtitle_header_encoding);
                    return AVERROR(EINVAL);
                }
                // Perform conversion here (omitted for brevity)
                iconv_close(cd);
                #endif
            }
        }