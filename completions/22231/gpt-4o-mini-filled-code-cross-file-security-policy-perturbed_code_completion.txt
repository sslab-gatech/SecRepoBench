if (b->uncomp_size < slice->hdr->ref_seq_span) {
                hts_log_error("Embedded reference is too small for the requested span at #%d:%"PRId64"-%"PRId64,
                              ref_id, slice->hdr->ref_seq_start,
                              slice->hdr->ref_seq_start + slice->hdr->ref_seq_span-1);
                return -1;
            }
            if (slice->hdr->ref_seq_span > b->uncomp_size) {
                hts_log_error("Requested reference span exceeds available size at #%d:%"PRId64"-%"PRId64,
                              ref_id, slice->hdr->ref_seq_start,
                              slice->hdr->ref_seq_start + slice->hdr->ref_seq_span-1);
                return -1;
            }
            slice->ref = b->data;