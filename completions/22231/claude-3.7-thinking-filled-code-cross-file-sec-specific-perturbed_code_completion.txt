slice->ref = b->data;
slice->ref_start = slice->hdr->ref_seq_start;
slice->ref_end = slice->hdr->ref_seq_start + slice->hdr->ref_seq_span - 1;

// Check if the embedded reference is large enough
if (b->uncomp_size < slice->hdr->ref_seq_span) {
    hts_log_error("Embedded reference is too small: %d vs %d",
                  b->uncomp_size, slice->hdr->ref_seq_span);
    return -1;
}