refs = calloc(1, sizeof(char *));
            if (!refs)
                return -1;
            refs[0] = slice->ref = b->data;
            slice->ref_start = slice->hdr->ref_seq_start;
            slice->ref_end = slice->hdr->ref_seq_start + slice->hdr->ref_seq_span - 1;

            if (b->uncomp_size < slice->hdr->ref_seq_span) {
                hts_log_error("Embedded reference is too small");
                return -1;
            }