{
        /* Set the slice->ref pointer to the uncompressed reference data. */
        slice->ref = (char *)b->data;
        slice->ref_start = slice->hdr->ref_seq_start;
        slice->ref_end   = slice->hdr->ref_seq_start + slice->hdr->ref_seq_span - 1;

        /* Check if the embedded reference is long enough. */
        if (b->uncomp_size < slice->hdr->ref_seq_span) {
            hts_log_error("Embedded reference block is too small (%d < %"PRId64") "
                          "for slice #%d:%"PRId64"-%"PRId64,
                          b->uncomp_size, (int64_t)slice->hdr->ref_seq_span,
                          ref_id, slice->hdr->ref_seq_start,
                          slice->hdr->ref_seq_start + slice->hdr->ref_seq_span - 1);
            return -1;
        }
    }