if (b->uncomp_size < slice->hdr->ref_seq_span) {
    hts_log_error("Embedded reference is too small: "
                  "Expected %d, got %d", slice->hdr->ref_seq_span, b->uncomp_size);
    return -1;
}
slice->ref = b->data + (slice->hdr->ref_seq_start - slice->ref_start);
slice->ref_start = slice->hdr->ref_seq_start;
slice->ref_end = slice->hdr->ref_seq_start + slice->hdr->ref_seq_span - 1;