if (slice->hdr->ref_base_id >= 0) {
    cram_block *b = cram_get_block_by_id(slice, slice->hdr->ref_base_id);
    if (b) {
        if (cram_uncompress_block(b) != 0)
            return -1;
        slice->ref = (char *)b->data;
        slice->ref_start = slice->hdr->ref_seq_start;
        slice->ref_end = slice->hdr->ref_seq_start + slice->hdr->ref_seq_span - 1;
    } else {
        hts_log_error("Unable to fetch embedded reference block");
        return -1;
    }
} else {
    hts_log_error("No reference specified and no embedded reference is available"
                  " at #%d:%"PRId64"-%"PRId64, ref_id, slice->hdr->ref_seq_start,
                  slice->hdr->ref_seq_start + slice->hdr->ref_seq_span-1);
    return -1;
}