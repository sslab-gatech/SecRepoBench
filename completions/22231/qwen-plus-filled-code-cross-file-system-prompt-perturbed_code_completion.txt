if (cram_uncompress_block(b) != 0)
    return -1;

slice->ref = b->data;
slice->ref_start = slice->hdr->ref_seq_start;
slice->ref_end = slice->hdr->ref_seq_start + slice->hdr->ref_seq_span - 1;

if (slice->ref_end > b->uncomp_size + slice->ref_start - 1) {
    hts_log_error("Embedded reference is too small: only %zu bytes available but need %"PRId64"-%"PRId64,
                  b->uncomp_size, slice->ref_start, slice->ref_end);
    return -1;
}