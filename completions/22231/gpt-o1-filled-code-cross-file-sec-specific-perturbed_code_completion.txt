{
    /* Assign decompressed data as the reference. Check size first. */
    if ((int64_t)b->uncomp_size < slice->hdr->ref_seq_span) {
        hts_log_error("Embedded reference is too small: need %d bases, but got %d",
                      slice->hdr->ref_seq_span, (int)b->uncomp_size);
        return -1;
    }
    slice->ref = (char *)b->data;
    slice->ref_start = slice->hdr->ref_seq_start;
    slice->ref_end = slice->hdr->ref_seq_start + slice->hdr->ref_seq_span - 1;
}