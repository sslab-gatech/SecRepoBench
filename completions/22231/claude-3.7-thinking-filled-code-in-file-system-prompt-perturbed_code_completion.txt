slice->ref = BLOCK_DATA(b);
slice->ref_start = slice->hdr->ref_seq_start;
slice->ref_end = slice->hdr->ref_seq_start + slice->hdr->ref_seq_span - 1;

/* Sanity check */
if (slice->ref_start < 0) {
    hts_log_warning("Slice starts before base 1"
                    " at #%d:%"PRId64"-%"PRId64, ref_id, slice->hdr->ref_seq_start,
                    slice->hdr->ref_seq_start + slice->hdr->ref_seq_span-1);
    slice->ref_start = 0;
}

if (BLOCK_SIZE(b) < slice->hdr->ref_seq_span) {
    hts_log_error("Embedded reference is too small: %d vs %d",
                  BLOCK_SIZE(b), slice->hdr->ref_seq_span);
    return -1;
}