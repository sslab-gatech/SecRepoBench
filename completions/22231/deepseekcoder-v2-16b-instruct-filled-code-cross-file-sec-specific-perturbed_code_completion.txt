if (blk->content_type != CORE)
    return -1;

if (slice->ref == NULL && slice->hdr->ref_base_id >= 0) {
    cram_block *b = cram_get_block_by_id(slice, slice->hdr->ref_base_id);
    if (b) {
        if (!(md5 = hts_md5_init()))
            return -1;
        hts_md5_update(md5, b->data, b->uncomp_size);
        hts_md5_final(digest, md5);
        hts_md5_destroy(md5);
    }
}