size_t ref_len = b->uncomp_size;
            if (slice->hdr->ref_seq_start + slice->hdr->ref_seq_span -1 > ref_len) {
                hts_log_error("Embedded reference is too small at #%d:%"PRId64"-%"PRId64,
                              ref_id, slice->hdr->ref_seq_start,
                              slice->hdr->ref_seq_start + slice->hdr->ref_seq_span -1);
                return -1;
            }
            slice->ref = b->data + slice->hdr->ref_seq_start -1;
            slice->ref_start = slice->hdr->ref_seq_start;
            slice->ref_end   = slice->hdr->ref_seq_start + slice->hdr->ref_seq_span -1;