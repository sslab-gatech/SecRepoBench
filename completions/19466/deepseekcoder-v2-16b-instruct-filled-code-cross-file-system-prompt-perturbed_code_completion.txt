// Extract the server name from the TLS certificate payload.
      // Check if the extracted server name appears to be a valid host name or IP address.
      // If valid, store the server name in the flow's `server_certificate` field.
      // Optionally, attempt to match the extracted server name to a known protocol.
      // If a subprotocol is detected, set the flow's detected protocol accordingly.
      // If a valid server name is extracted and optionally matched, return indicating success.
      char server_name[64];
      int server_name_len = extractServerName(packet->payload, packet->payload_packet_len, server_name, sizeof(server_name));
      if (server_name_len > 0) {
        flow->protos.stun_ssl.ssl.server_certificate[0] = '\0';
        strncpy(flow->protos.stun_ssl.ssl.server_certificate, server_name, sizeof(flow->protos.stun_ssl.ssl.server_certificate) - 1);
        flow->protos.stun_ssl.ssl.server_certificate[sizeof(flow->protos.stun_ssl.ssl.server_certificate) - 1] = '\0';

        // Attempt to match the extracted server name to a known protocol.
        if (matchServerNameToProtocol(server_name, flow) == NDPI_PROTOCOL_STUN) {
          flow->guessed_protocol_id = NDPI_PROTOCOL_STUN;
          return 2; // Client Certificate
        }
      }