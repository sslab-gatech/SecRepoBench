u_int8_t server_name_len = packet->payload[i+3];
            if(i + 3 + server_name_len < packet->payload_packet_len) {
              char *server_name = (char*)&packet->payload[i+4];
              u_int len = (u_int)ndpi_min(server_name_len, buffer_len-1);
              strncpy(buffer, server_name, len);
              buffer[len] = '\0';

              // Check if the server name is a valid hostname or IP address
              if(ndpi_is_valid_hostname(buffer) || ndpi_is_valid_ip(buffer)) {
                snprintf(flow->protos.stun_ssl.ssl.server_certificate,
                         sizeof(flow->protos.stun_ssl.ssl.server_certificate), "%s", buffer);

                // Optionally match the server name to a known protocol
                if(ndpi_match_known_protocol(ndpi_struct, flow, buffer)) {
                  return 1; // Success
                }
              }
            }