char server_name[256];
            strncpy(server_name, (char*)&packet->payload[i+3], packet->payload[i+2]);
            server_name[packet->payload[i+2]] = '\0'; // Null-terminate the string

            // Validate the server name
            if (is_valid_hostname(server_name) || is_valid_ip_address(server_name)) {
                strncpy(flow->protos.stun_ssl.ssl.server_certificate, server_name, sizeof(flow->protos.stun_ssl.ssl.server_certificate) - 1);
                flow->protos.stun_ssl.ssl.server_certificate[sizeof(flow->protos.stun_ssl.ssl.server_certificate) - 1] = '\0'; // Ensure null termination

                // Optionally match the server name to a known protocol
                if (match_protocol(server_name, &flow->guessed_protocol_id)) {
                    flow->guessed_host_protocol_id = flow->guessed_protocol_id;
                }

                return 1; // Indicate success
            }