char *server_name = (char*)&packet->payload[i+4];
u_int16_t server_name_len = (packet->payload[i+3] << 8) + packet->payload[i+4];

if (server_name_len < buffer_len) {
    strncpy(buffer, server_name, server_name_len);
    buffer[server_name_len] = '\0'; // Null-terminate the string

    // Optionally, check if the server name is a valid hostname or IP address
    if (is_valid_hostname_or_ip(buffer)) {
        snprintf(flow->protos.stun_ssl.ssl.server_certificate, sizeof(flow->protos.stun_ssl.ssl.server_certificate), "%s", buffer);
        return 1; // Indicate success
    }
}