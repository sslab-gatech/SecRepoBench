char server_name[256];
            memset(server_name, 0, sizeof(server_name));
            u_int16_t server_name_len = (packet->payload[i + 3] << 8) + packet->payload[i + 4];

            if (server_name_len < sizeof(server_name) && (i + 5 + server_name_len) < packet->payload_packet_len) {
                strncpy(server_name, (char*)&packet->payload[i + 5], server_name_len);
                server_name[server_name_len] = '\0';

                // Validate the server name
                if (is_valid_hostname(server_name) || is_valid_ip_address(server_name)) {
                    strncpy(flow->protos.stun_ssl.ssl.server_certificate, server_name, sizeof(flow->protos.stun_ssl.ssl.server_certificate) - 1);
                    flow->protos.stun_ssl.ssl.server_certificate[sizeof(flow->protos.stun_ssl.ssl.server_certificate) - 1] = '\0';

                    // Optionally match the server name to a known protocol
                    match_protocol(ndpi_struct, flow, server_name);

                    return 1; // Indicate success
                }
            }