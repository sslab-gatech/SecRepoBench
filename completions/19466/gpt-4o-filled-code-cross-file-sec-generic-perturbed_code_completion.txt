u_int8_t server_name_len = packet->payload[i+3];
            if(i + 3 + server_name_len < packet->payload_packet_len) {
              char server_name[256];
              u_int len = (u_int)ndpi_min(server_name_len, sizeof(server_name) - 1);
              strncpy(server_name, (char*)&packet->payload[i+3], len);
              server_name[len] = '\0';

              // Validate server name
              if(ndpi_is_valid_hostname_or_ip(server_name)) {
                snprintf(flow->protos.stun_ssl.ssl.server_certificate,
                         sizeof(flow->protos.stun_ssl.ssl.server_certificate), "%s", server_name);

                // Attempt to match the server name to a known protocol
                if(ndpi_match_protocol_by_server_name(ndpi_struct, flow, server_name)) {
                  return 1; // Success
                }
              }
            }