char server_name[256];
	    u_int16_t server_name_len = packet->payload[i+3];

	    if((i + 4 + server_name_len) < packet->payload_packet_len) {
	      strncpy(server_name, (char*)&packet->payload[i+4], server_name_len);
	      server_name[server_name_len] = '\0';

	      // Validate the server name
	      if(ndpi_is_valid_hostname_or_ip(server_name)) {
		snprintf(flow->protos.stun_ssl.ssl.server_certificate,
			 sizeof(flow->protos.stun_ssl.ssl.server_certificate), "%s", server_name);

		// Attempt to match the server name to a known protocol
		if(ndpi_match_protocol_by_hostname(ndpi_struct, flow, server_name)) {
		  return 1; // Successfully matched and processed
		}

		return 1; // Valid server name extracted
	      }
	    }