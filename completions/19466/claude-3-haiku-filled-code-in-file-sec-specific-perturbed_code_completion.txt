// <MASK>
  u_int8_t is_valid_hostname = 0;
  u_int8_t is_valid_ip_address = 0;

  // Check if the extracted server name appears to be a valid host name or IP address
  if(ndpi_is_valid_hostname(certificate, strlen(certificate))) {
    is_valid_hostname = 1;
  } else if(ndpi_is_valid_ip_address(certificate, strlen(certificate))) {
    is_valid_ip_address = 1;
  }

  if(is_valid_hostname || is_valid_ip_address) {
    // Store the server name in the flow's `server_certificate` field
    snprintf(flow->protos.stun_ssl.ssl.server_certificate, sizeof(flow->protos.stun_ssl.ssl.server_certificate), "%s", certificate);

    // Optionally, attempt to match the extracted server name to a known protocol
    ndpi_protocol_match_result ret_match;
    u_int16_t subproto = ndpi_match_host_subprotocol(ndpi_struct, flow, certificate, strlen(certificate), &ret_match, NDPI_PROTOCOL_TLS);
    if(subproto != NDPI_PROTOCOL_UNKNOWN) {
      // If a subprotocol is detected, set the flow's detected protocol accordingly
      ndpi_set_detected_protocol(ndpi_struct, flow, subproto, NDPI_PROTOCOL_TLS);
    }

    return 1; // Indicate success
  }
  return 0; // Indicate failure