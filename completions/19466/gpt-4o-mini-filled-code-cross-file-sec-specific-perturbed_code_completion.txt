u_int16_t server_name_len = ntohs(*((u_int16_t*)&packet->payload[i+3]));
	      if (server_name_len > 0 && (i + 5 + server_name_len) < packet->payload_packet_len) {
		strncpy(buffer, (char*)&packet->payload[i + 5], server_name_len);
		buffer[server_name_len] = '\0';

		// Validate the server name
		if (is_valid_hostname(buffer) || is_valid_ip_address(buffer)) {
		  snprintf(flow->protos.stun_ssl.ssl.server_certificate, sizeof(flow->protos.stun_ssl.ssl.server_certificate), "%s", buffer);
		  return 1; // Indicate success
		}
	      }