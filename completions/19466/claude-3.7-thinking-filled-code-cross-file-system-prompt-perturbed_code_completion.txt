/* Common Name (CN) */
u_int8_t len = packet->payload[i+3];

if((i+4+len) <= packet->payload_packet_len) {
  char server_name[256];
  u_int16_t j;
  u_int8_t is_printable = 1;
  
  if(len >= sizeof(server_name))
    len = sizeof(server_name)-1;
  
  // Copy the certificate name
  strncpy(server_name, (char*)&packet->payload[i+4], len);
  server_name[len] = '\0';
  
  // Check if server_name contains only printable chars
  for(j=0; j<len; j++) {
    if(!ndpi_isprint(server_name[j])) {
      is_printable = 0;
      break;
    }
  }
  
  if(is_printable) {
    stripCertificateTrailer(server_name, sizeof(server_name));
    
    if(!ndpi_struct->disable_metadata_export) {
      snprintf(flow->protos.stun_ssl.ssl.server_certificate, 
               sizeof(flow->protos.stun_ssl.ssl.server_certificate), "%s", server_name);
    }
    
    // Copy the server name to the provided buffer
    snprintf(buffer, buffer_len, "%s", server_name);
    
    certificate_count++;
    
    return(1); /* Server Certificate */
  }
}