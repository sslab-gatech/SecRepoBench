u_int16_t len = ntohs(*(u_int16_t*)&packet->payload[i + 3]);
            len = (u_int)ndpi_min(len, buffer_len - 1);

            if ((i + 5 + len) < packet->payload_packet_len) {
                strncpy(buffer, (char*)&packet->payload[i + 5], len);
                buffer[len] = '\0';

                stripCertificateTrailer(buffer, buffer_len);

                if (!ndpi_struct->disable_metadata_export) {
                    snprintf(flow->protos.stun_ssl.ssl.server_certificate,
                             sizeof(flow->protos.stun_ssl.ssl.server_certificate), "%s", buffer);
                }
            }
            return 1; // Indicate success in extracting the server name