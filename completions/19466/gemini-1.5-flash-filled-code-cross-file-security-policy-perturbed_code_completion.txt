size_t len = ndpi_min((size_t)packet->payload_packet_len - (size_t)i - 3, (size_t)buffer_len - 1);
            strncpy(buffer, (char *)&packet->payload[i + 3], len);
            buffer[len] = '\0';

            stripCertificateTrailer(buffer, buffer_len);

            if (!ndpi_struct->disable_metadata_export) {
              snprintf(flow->protos.stun_ssl.ssl.server_certificate,
                       sizeof(flow->protos.stun_ssl.ssl.server_certificate), "%s", buffer);
            }

            return (1 /* Server Certificate */);