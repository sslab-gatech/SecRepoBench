memcpy(flow->protos.stun_ssl.ssl.server_certificate, &packet->payload[i + 5], len);
    flow->protos.stun_ssl.ssl.server_certificate[len] = '\0';

    stripCertificateTrailer(flow->protos.stun_ssl.ssl.server_certificate,
			    sizeof(flow->protos.stun_ssl.ssl.server_certificate));

    if(flow->protos.stun_ssl.ssl.server_certificate[0] != '\0') {
      ndpi_protocol_match_result ret_match;
      u_int16_t subproto;

      subproto = ndpi_match_host_subprotocol(ndpi_struct, flow,
					     flow->protos.stun_ssl.ssl.server_certificate,
					     strlen(flow->protos.stun_ssl.ssl.server_certificate),
					     &ret_match,
					     NDPI_PROTOCOL_TLS);

      if(subproto != NDPI_PROTOCOL_UNKNOWN) {
	ndpi_set_detected_protocol(ndpi_struct, flow, subproto,
				   ndpi_tls_refine_master_protocol(ndpi_struct, flow, NDPI_PROTOCOL_TLS));
	return(1);
      }
    }

    return(1);