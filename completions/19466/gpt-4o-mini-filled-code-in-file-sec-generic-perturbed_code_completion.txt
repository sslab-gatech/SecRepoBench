char *server_name = &packet->payload[i + 3];
            u_int16_t server_name_len = ntohs(*(u_int16_t *)&packet->payload[i + 1]);

            if (server_name_len < buffer_len) {
                strncpy(buffer, server_name, server_name_len);
                buffer[server_name_len] = '\0'; // Null-terminate the string

                // Validate the extracted server name
                if (is_valid_hostname(buffer)) {
                    snprintf(flow->protos.stun_ssl.ssl.server_certificate, sizeof(flow->protos.stun_ssl.ssl.server_certificate), "%s", buffer);
                    return 1; // Indicate success
                }
            }