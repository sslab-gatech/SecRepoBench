size_t server_name_len = ndpi_min(buffer_len - 1, packet->payload_packet_len - i - 3);
    strncpy(buffer, (char *)&packet->payload[i + 3], server_name_len);
    buffer[server_name_len] = '\0';
    stripCertificateTrailer(buffer, buffer_len);
    if (!ndpi_struct->disable_metadata_export) {
      snprintf(flow->protos.stun_ssl.ssl.server_certificate,
               sizeof(flow->protos.stun_ssl.ssl.server_certificate), "%s", buffer);
    }
    return 1;