// Extract the server name from the TLS certificate payload.
      // Check if the extracted server name appears to be a valid host name or IP address.
      // If valid, store the server name in the flow's `server_certificate` field.
      // Optionally, attempt to match the extracted server name to a known protocol.
      // If a subprotocol is detected, set the flow's detected protocol accordingly.
      // If a valid server name is extracted and optionally matched, return indicating success.

      char server_name[256];
      int server_name_len = 0;
      u_int16_t offset = extension_offset + 5;
      u_int16_t name_type;

      while (offset < packet->payload_packet_len) {
        name_type = ntohs(*((u_int16_t*)&packet->payload[offset]));
        offset += 2;
        u_int16_t name_len = ntohs(*((u_int16_t*)&packet->payload[offset]));
        offset += 2;

        if (name_type == 0 && name_len > 0) {
          u_int8_t *name_data = &packet->payload[offset];
          int name_data_len = (int)ndpi_min(name_len, sizeof(server_name) - 1);
          strncpy(server_name, (char *)name_data, name_data_len);
          server_name[name_data_len] = '\0';
          server_name_len = name_data_len;

          // Check if the extracted server name is a valid host name or IP address
          struct hostent *host = gethostbyname(server_name);
          if (host != NULL) {
            // Store the server name in the flow's `server_certificate` field
            strncpy(flow->protos.stun_ssl.ssl.server_certificate, server_name, sizeof(flow->protos.stun_ssl.ssl.server_certificate) - 1);
            flow->protos.stun_ssl.ssl.server_certificate[sizeof(flow->protos.stun_ssl.ssl.server_certificate) - 1] = '\0';

            // Optionally, attempt to match the extracted server name to a known protocol
            // This is a simplified example, and you may need to implement a more robust protocol detection mechanism
            if (strstr(server_name, "example.com") != NULL) {
              flow->guessed_protocol_id = NDPI_PROTOCOL_HTTP;
            } else if (strstr(server_name, "api.example.com") != NULL) {
              flow->guessed_protocol_id = NDPI_PROTOCOL_API;
            }

            return 2; // Client Certificate
          }
        }

        offset += name_len;
      }