->flags & MAGIC_DEBUG) != 0)
					fprintf(stderr, "offset add %jd\n",
					    m->in_offset);
				offset += m->in_offset;
			} else {
				if ((ms->flags & MAGIC_DEBUG) != 0)
					fprintf(stderr, "offset add %jd\n",
					    m->in_offset);
				offset += m->in_offset;
			}
		}
		if ((ms->flags & MAGIC_DEBUG) != 0)
			fprintf(stderr, "offset=%u\n", offset);
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE_OPINDIRECT) {
			if (m->in_type == FILE_OCTAL) {
				if (OFFSET_OOB(nbytes, offset, m->vallen))
					return 0;
				offset = do_ops(m,
				    SEXT(sgn,64,strtoull(p->s, NULL, 8)),
				    m->in_offset);
			}
		}
	}

	if (m->flag & INDIR) {
		if (m->in_op & FILE