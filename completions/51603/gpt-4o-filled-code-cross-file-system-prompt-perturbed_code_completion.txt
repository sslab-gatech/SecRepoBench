if (m->factor_op != FILE_FACTOR_OP_NONE) {
	file_magwarn(ms, "Current entry already has a factor operation");
	goto out;
}

switch (*l++) {
case '\0':
	file_magwarn(ms, "Missing factor operation");
	goto out;
case FILE_FACTOR_OP_PLUS:
case FILE_FACTOR_OP_MINUS:
case FILE_FACTOR_OP_TIMES:
case FILE_FACTOR_OP_DIV:
	m->factor_op = l[-1];
	break;
default:
	file_magwarn(ms, "Invalid factor operation `%c'", l[-1]);
	goto out;
}