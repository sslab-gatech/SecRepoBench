}
	if ((ms->flags & MAGIC_MIME_ENCODING) && m->encoding[0]) {
		char buf[1024];
		const char *p;
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (varexpand(ms, buf, sizeof(buf), m->encoding) == -1)
			p = m->encoding;
		else
			p = buf;
		if (file_printf(ms, "%s", p) == -1)
			return -1;
		return 1;
	}
	if (m->desc[0]) {
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (file_printf(ms, "%.4095s", m->desc) == -1)
			return -1;
		return 1;
	}
	return 0;
}

// the below code fragment can be found in:
// src/softmagic.c
private int
handle_strength(struct magic_set *ms, struct magic *m, int firstline)
{
	if (m->factor_op!= FILE_FACTOR_OP_NONE) {
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (file_printf(ms, "%.8s", m->strength) == -1)
			return -1;
		return 1;
	}
	return 0;
}

// the below code fragment can be found in:
// src/softmagic.c
private int
handle_mime(struct magic_set *ms, struct magic *m, int firstline)
{
	if ((ms->flags & MAGIC_MIME_TYPE) && m->mimetype[0]) {
		char buf[1024];
		const char *p;
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (varexpand(ms, buf, sizeof(buf), m->mimetype) == -1)
			p = m->mimetype;
		else
			p = buf;
		if (file_printf(ms, "%s", p) == -1)
			return -1;
		return 1;
	}
	return 0;
}

// the below code fragment can be found in:
// src/softmagic.c
private int
handle_ext(struct magic_set *ms, struct magic *m, int firstline)
{
	if ((ms->flags & MAGIC_EXTENSION) && m->ext[0]) {
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (file_printf(ms, "%s", m->ext) == -1)
			return -1;
		return 1;
	}
	return 0;
}

// the below code fragment can be found in:
// src/softmagic.c
private int
handle_apple(struct magic_set *ms, struct magic *m, int firstline)
{
	if ((ms->flags & MAGIC_APPLE) && m->apple[0]) {
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (file_printf(ms, "%.8s", m->apple) == -1)
			return -1;
		return 1;
	}
	return 0;
}

// the below code fragment can be found in:
// src/softmagic.c
private int
handle_encoding(struct magic_set *ms, struct magic *m, int firstline)
{
	if ((ms->flags & MAGIC_MIME_ENCODING) && m->encoding[0]) {
		char buf[1024];
		const char *p;
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (varexpand(ms, buf, sizeof(buf), m->encoding) == -1)
			p = m->encoding;
		else
			p = buf;
		if (file_printf(ms, "%s", p) == -1)
			return -1;
		return 1;
	}
	return 0;
}

// the below code fragment can be found in:
// src/softmagic.c
private int
handle_desc(struct magic_set *ms, struct magic *m, int firstline)
{
	if (m->desc[0]) {
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (file_printf(ms, "%.4095s", m->desc) == -1)
			return -1;
		return 1;
	}
	return 0;
}

// the below code fragment can be found in:
// src/softmagic.c
private int
handle_mime_type(struct magic_set *ms, struct magic *m, int firstline)
{
	if ((ms->flags & MAGIC_MIME_TYPE) && m->mimetype[0]) {
		char buf[1024];
		const char *p;
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (varexpand(ms, buf, sizeof(buf), m->mimetype) == -1)
			p = m->mimetype;
		else
			p = buf;
		if (file_printf(ms, "%s", p) == -1)
			return -1;
		return 1;
	}
	return 0;
}

// the below code fragment can be found in:
// src/softmagic.c
private int
handle_mime_encoding(struct magic_set *ms, struct magic *m, int firstline)
{
	if ((ms->flags & MAGIC_MIME_ENCODING) && m->encoding[0]) {
		char buf[1024];
		const char *p;
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (varexpand(ms, buf, sizeof(buf), m->encoding) == -1)
			p = m->encoding;
		else
			p = buf;
		if (file_printf(ms, "%s", p) == -1)
			return -1;
		return 1;
	}
	return 0;
}

// the below code fragment can be found in:
// src/softmagic.c
private int
handle_mime_type_encoding(struct magic_set *ms, struct magic *m, int firstline)
{
	if ((ms->flags & MAGIC_MIME_TYPE) && m->mimetype[0]) {
		char buf[1024];
		const char *p;
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (varexpand(ms, buf, sizeof(buf), m->mimetype) == -1)
			p = m->mimetype;
		else
			p = buf;
		if (file_printf(ms, "%s", p) == -1)
			return -1;
		return 1;
	}
	if ((ms->flags & MAGIC_MIME_ENCODING) && m->encoding[0]) {
		char buf[1024];
		const char *p;
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (varexpand(ms, buf, sizeof(buf), m->encoding) == -1)
			p = m->encoding;
		else
			p = buf;
		if (file_printf(ms, "%s", p) == -1)
			return -1;
		return 1;
	}
	return 0;
}

// the below code fragment can be found in:
// src/softmagic.c
private int
handle_mime_type_encoding_apple(struct magic_set *ms, struct magic *m, int firstline)
{
	if ((ms->flags & MAGIC_MIME_TYPE) && m->mimetype[0]) {
		char buf[1024];
		const char *p;
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (varexpand(ms, buf, sizeof(buf), m->mimetype) == -1)
			p = m->mimetype;
		else
			p = buf;
		if (file_printf(ms, "%s", p) == -1)
			return -1;
		return 1;
	}
	if ((ms->flags & MAGIC_MIME_ENCODING) && m->encoding[0]) {
		char buf[1024];
		const char *p;
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (varexpand(ms, buf, sizeof(buf), m->encoding) == -1)
			p = m->encoding;
		else
			p = buf;
		if (file_printf(ms, "%s", p) == -1)
			return -1;
		return 1;
	}
	if ((ms->flags & MAGIC_APPLE) && m->apple[0]) {
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (file_printf(ms, "%.8s", m->apple) == -1)
			return -1;
		return 1;
	}
	return 0;
}

// the below code fragment can be found in:
// src/softmagic.c
private int
handle_mime_type_encoding_apple_ext(struct magic_set *ms, struct magic *m, int firstline)
{
	if ((ms->flags & MAGIC_MIME_TYPE) && m->mimetype[0]) {
		char buf[1024];
		const char *p;
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (varexpand(ms, buf, sizeof(buf), m->mimetype) == -1)
			p = m->mimetype;
		else
			p = buf;
		if (file_printf(ms, "%s", p) == -1)
			return -1;
		return 1;
	}
	if ((ms->flags & MAGIC_MIME_ENCODING) && m->encoding[0]) {
		char buf[1024];
		const char *p;
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (varexpand(ms, buf, sizeof(buf), m->encoding) == -1)
			p = m->encoding;
		else
			p = buf;
		if (file_printf(ms, "%s", p) == -1)
			return -1;
		return 1;
	}
	if ((ms->flags & MAGIC_APPLE) && m->apple[0]) {
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (file_printf(ms, "%.8s", m->apple) == -1)
			return -1;
		return 1;
	}
	if ((ms->flags & MAGIC_EXTENSION) && m->ext[0]) {
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (file_printf(ms, "%s", m->ext) == -1)
			return -1;
		return 1;
	}
	return 0;
}

// the below code fragment can be found in:
// src/softmagic.c
private int
handle_mime_type_encoding_apple_ext_strength(struct magic_set *ms, struct magic *m, int firstline)
{
	if ((ms->flags & MAGIC_MIME_TYPE) && m->mimetype[0]) {
		char buf[1024];
		const char *p;
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (varexpand(ms, buf, sizeof(buf), m->mimetype) == -1)
			p = m->mimetype;
		else
			p = buf;
		if (file_printf(ms, "%s", p) == -1)
			return -1;
		return 1;
	}
	if ((ms->flags & MAGIC_MIME_ENCODING) && m->encoding[0]) {
		char buf[1024];
		const char *p;
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (varexpand(ms, buf, sizeof(buf), m->encoding) == -1)
			p = m->encoding;
		else
			p = buf;
		if (file_printf(ms, "%s", p) == -1)
			return -1;
		return 1;
	}
	if ((ms->flags & MAGIC_APPLE) && m->apple[0]) {
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (file_printf(ms, "%.8s", m->apple) == -1)
			return -1;
		return 1;
	}
	if ((ms->flags & MAGIC_EXTENSION) && m->ext[0]) {
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (file_printf(ms, "%s", m->ext) == -1)
			return -1;
		return 1;
	}
	if (m->factor_op!= FILE_FACTOR_OP_NONE) {
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (file_printf(ms, "%.8s", m->strength) == -1)
			return -1;
		return 1;
	}
	return 0;
}

// the below code fragment can be found in:
// src/softmagic.c
private int
handle_mime_type_encoding_apple_ext_strength_desc(struct magic_set *ms, struct magic *m, int firstline)
{
	if ((ms->flags & MAGIC_MIME_TYPE) && m->mimetype[0]) {
		char buf[1024];
		const char *p;
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (varexpand(ms, buf, sizeof(buf), m->mimetype) == -1)
			p = m->mimetype;
		else
			p = buf;
		if (file_printf(ms, "%s", p) == -1)
			return -1;
		return 1;
	}
	if ((ms->flags & MAGIC_MIME_ENCODING) && m->encoding[0]) {
		char buf[1024];
		const char *p;
		if (print_sep(ms, firstline) == -1)
			return -1;
		if (varexpand(ms, buf, sizeof(buf), m->encoding) == -1)
			p = m->encoding;
		else
			p = buf;
		if (file_printf(ms, "%s", p) == -1)
			return -1;
		return 1;
	}
	if ((ms->flags & MAGIC_APP