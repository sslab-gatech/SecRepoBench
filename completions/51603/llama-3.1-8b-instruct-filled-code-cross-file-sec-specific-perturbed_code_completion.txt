// <MASK>
EATAB;
factor = strtoul(l, &el, 0);
if (factor > 255) {
    file_magwarn(ms, "Too large factor `%lu'", factor);
    goto out;
}
if (*el &&!isspace(CAST(unsigned char, *el))) {
    file_magwarn(ms, "Bad factor `%s'", l);
    goto out;
}
m->factor = CAST(uint8_t, factor);
if (m->factor == 0 && m->factor_op == FILE_FACTOR_OP_DIV) {
    file_magwarn(ms, "Cannot have factor op `%c' and factor %u",
        m->factor_op, m->factor);
    goto out;
}
// Check for overflow
if (m->factor > 0 && m->factor < 256) {
    // Check if the factor is a power of 2
    if ((m->factor & (m->factor - 1)) == 0) {
        // If it is, check if the factor is a valid power of 2
        if (m->factor!= 1 && (m->factor & (m->factor - 1)) == 0) {
            file_magwarn(ms, "Invalid power of 2 factor `%u'", m->factor);
            goto out;
        }
    }
}
return 0;
out:
m->factor_op = FILE_FACTOR_OP_NONE;
m->factor = 0;
return -1;