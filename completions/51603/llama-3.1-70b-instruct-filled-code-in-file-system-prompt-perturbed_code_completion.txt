rv = 0;
out2:
if (fd!= -1)
    (void)close(fd);
out:
apprentice_unmap(map);
free(dbname);
return rv;