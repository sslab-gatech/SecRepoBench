struct magic *m = &myself->mp[0];

if (m->strength != 0) {
    file_magwarn(ms, "Strength already defined");
    return -1;
}

if (m->type == FILE_NAME) {
    file_magwarn(ms, "Strength not supported for FILE_NAME");
    return -1;
}

switch (*l++) {
    case '&':
        m->factor_op = FILE_FACTOR_OP_AND;
        break;
    case '|':
        m->factor_op = FILE_FACTOR_OP_OR;
        break;
    case '*':
        m->factor_op = FILE_FACTOR_OP_MULT;
        break;
    case '/':
        m->factor_op = FILE_FACTOR_OP_DIV;
        break;
    case '+':
        m->factor_op = FILE_FACTOR_OP_PLUS;
        break;
    case '-':
        m->factor_op = FILE_FACTOR_OP_MINUS;
        break;
    default:
        file_magwarn(ms, "Unknown factor op `%c'", *--l);
        return -1;
}