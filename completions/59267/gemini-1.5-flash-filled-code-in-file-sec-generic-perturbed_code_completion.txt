if (iSize < headerSize) { return EXR_ERR_CORRUPT_CHUNK; }

    memset (uncompressed_data, 0, uncompressed_size);

    memcpy (counters, inPtr, headerSize);
    priv_to_native64 (counters, NUM_SIZES_SINGLE);

    version                 = counters[VERSION];
    unknownUncompressedSize = counters[UNKNOWN_UNCOMPRESSED_SIZE];
    unknownCompressedSize   = counters[UNKNOWN_COMPRESSED_SIZE];
    acCompressedSize        = counters[AC_COMPRESSED_SIZE];
    dcCompressedBytes       = counters[DC_COMPRESSED_SIZE];
    rleCompressedSize       = counters[RLE_COMPRESSED_SIZE];
    rleUncompressedSize     = counters[RLE_UNCOMPRESSED_SIZE];
    rleRawSize              = counters[RLE_RAW_SIZE];

    totalAcUncompressedCount = counters[AC_UNCOMPRESSED_COUNT];
    totalDcUncompressedCount = counters[DC_UNCOMPRESSED_COUNT];

    acCompression = counters[AC_COMPRESSION];

    compressedSize =
        unknownCompressedSize + acCompressedSize + dcCompressedBytes +
        rleCompressedSize;

    dataPtr  = inPtr + headerSize;
    dataLeft = iSize - headerSize;

    outBufferSize = uncompressed_size;
    outBufferEnd  = (uint8_t*) uncompressed_data;

    packedAcBufferEnd = me->_packedAcBuffer;
    packedDcBufferEnd = me->_packedDcBuffer;

    const uint8_t* compressedUnknownBuf = dataPtr;
    dataPtr += unknownCompressedSize;
    dataLeft -= unknownCompressedSize;

    const uint8_t* compressedAcBuf = dataPtr;
    dataPtr += acCompressedSize;
    dataLeft -= acCompressedSize;

    const uint8_t* compressedDcBuf = dataPtr;
    dataPtr += dcCompressedBytes;
    dataLeft -= dcCompressedBytes;

    const uint8_t* compressedRleBuf = dataPtr;
    dataLeft -= rleCompressedSize;