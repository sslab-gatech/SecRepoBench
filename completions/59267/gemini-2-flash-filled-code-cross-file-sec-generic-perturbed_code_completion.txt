const uint8_t* compressedUnknownBuf = inPtr + headerSize;
    const uint8_t* compressedAcBuf      = compressedUnknownBuf + unknownCompressedSize;
    const uint8_t* compressedDcBuf      = compressedAcBuf + acCompressedSize;
    const uint8_t* compressedRleBuf     = compressedDcBuf + dcCompressedBytes;

    rv = exr_decode_xdr (
        counters, (uint8_t*) inPtr, NUM_SIZES_SINGLE * sizeof (uint64_t));

    if (rv != EXR_ERR_SUCCESS) { return rv; }

    version                 = native_from_one64 (counters[0]);
    unknownUncompressedSize = native_from_one64 (counters[1]);
    unknownCompressedSize   = native_from_one64 (counters[2]);
    acCompressedSize        = native_from_one64 (counters[3]);
    dcCompressedBytes       = native_from_one64 (counters[4]);
    rleCompressedSize       = native_from_one64 (counters[5]);
    rleUncompressedSize     = native_from_one64 (counters[6]);
    rleRawSize              = native_from_one64 (counters[7]);
    totalAcUncompressedCount = native_from_one64 (counters[8]);
    totalDcUncompressedCount = native_from_one64 (counters[9]);
    acCompression           = native_from_one64 (counters[10]);

    compressedSize = headerSize + unknownCompressedSize + acCompressedSize +
                     dcCompressedBytes + rleCompressedSize;

    dataPtr  = inPtr + headerSize;
    dataLeft = iSize - headerSize;

    if (unknownCompressedSize > iSize || acCompressedSize > iSize ||
        dcCompressedBytes > iSize || rleCompressedSize > iSize ||
        compressedSize > iSize)
    {
        return EXR_ERR_CORRUPT_CHUNK;
    }

    if (version > 2) { return EXR_ERR_BAD_CHUNK_LEADER; }

    outBufferSize = (size_t) me->_max[0] - (size_t) me->_min[0] + 1;
    outBufferSize *= (size_t) me->_max[1] - (size_t) me->_min[1] + 1;

    outBufferEnd = (uint8_t*) uncompressed_data;

    packedAcBufferEnd = me->_packedAcBuffer;
    packedDcBufferEnd = me->_packedDcBuffer;