const uint8_t* compressedUnknownBuf = dataPtr;
const uint8_t* compressedAcBuf = compressedUnknownBuf + unknownCompressedSize;
const uint8_t* compressedDcBuf = compressedAcBuf + acCompressedSize;
const uint8_t* compressedRleBuf = compressedDcBuf + dcCompressedBytes;

uint8_t* outBufferEnd = (uint8_t*)uncompressed_data;
uint8_t* packedAcBufferEnd = me->_packedAcBuffer;
uint8_t* packedDcBufferEnd = me->_packedDcBuffer;

compressedSize = unknownCompressedSize + acCompressedSize + dcCompressedBytes + rleCompressedSize;
if (compressedSize > dataLeft)
    return EXR_ERR_CORRUPT_CHUNK;

if (version >= 2)
{
    rv = DwaCompressor_readChannelRules(me, &dataPtr, dataLeft);
    if (rv != EXR_ERR_SUCCESS)
        return rv;
}

rv = DwaCompressor_initializeBuffers(me, &outBufferSize);
if (rv != EXR_ERR_SUCCESS)
    return rv;

if (outBufferSize > uncompressed_size)
    return EXR_ERR_CORRUPT_CHUNK;

memset(uncompressed_data, 0, uncompressed_size);