/* Read and verify the header */
    if (iSize < headerSize)
        return EXR_ERR_CORRUPT_CHUNK;

    memcpy (counters, inPtr, headerSize);
    for (int i = 0; i < NUM_SIZES_SINGLE; ++i)
        counters[i] = exr_big_to_native64 (counters[i]);

    version                = counters[0];
    unknownUncompressedSize= counters[1];
    unknownCompressedSize  = counters[2];
    acCompressedSize       = counters[3];
    totalAcUncompressedCount = counters[4];
    dcCompressedBytes      = counters[5];
    totalDcUncompressedCount = counters[6];
    rleCompressedSize      = counters[7];
    rleUncompressedSize    = counters[8];
    rleRawSize             = counters[9];
    acCompression          = counters[10];

    /* Advance the data pointer beyond the header, calculate remaining size */
    dataPtr = inPtr + headerSize;
    dataLeft = iSize - headerSize;

    /* Verify compressed sections do not exceed remaining data */
    if (unknownCompressedSize > dataLeft) return EXR_ERR_CORRUPT_CHUNK;
    if (acCompressedSize > (dataLeft - unknownCompressedSize))
        return EXR_ERR_CORRUPT_CHUNK;
    if (dcCompressedBytes >
        (dataLeft - unknownCompressedSize - acCompressedSize))
        return EXR_ERR_CORRUPT_CHUNK;
    if (rleCompressedSize >
        (dataLeft - unknownCompressedSize - acCompressedSize - dcCompressedBytes))
        return EXR_ERR_CORRUPT_CHUNK;

    /* Assign pointers for each compressed data section */
    compressedUnknownBuf = dataPtr;
    dataPtr += unknownCompressedSize;

    compressedAcBuf = dataPtr;
    dataPtr += acCompressedSize;

    compressedDcBuf = dataPtr;
    dataPtr += dcCompressedBytes;

    compressedRleBuf = dataPtr;
    dataPtr += rleCompressedSize;

    /* Initialize the output buffer if provided */
    if (uncompressed_data && uncompressed_size > 0)
        memset (uncompressed_data, 0, (size_t) uncompressed_size);

    /* Prepare pointers used later for decoding */
    outBufferEnd      = (uint8_t*) uncompressed_data;
    packedAcBufferEnd = me->_packedAcBuffer;
    packedDcBufferEnd = me->_packedDcBuffer;