// Define pointers for compressed data sections: UNKNOWN, AC, DC, and RLE
    const uint8_t* compressedUnknownBuf = NULL;
    const uint8_t* compressedAcBuf      = NULL;
    const uint8_t* compressedDcBuf      = NULL;
    const uint8_t* compressedRleBuf     = NULL;

    // Verify that the input size is adequate for the header
    if (iSize < headerSize) return EXR_ERR_CORRUPT_CHUNK;

    // Initialize the output (uncompressed) buffer to zero
    memset(uncompressed_data, 0, uncompressed_size);

    // Copy header information and convert from XDR to native
    memcpy(counters, inPtr, headerSize);
    priv_to_native64(counters, NUM_SIZES_SINGLE);

    version                 = counters[VERSION];
    unknownUncompressedSize = counters[UNKNOWN_UNCOMPRESSED_SIZE];
    unknownCompressedSize   = counters[UNKNOWN_COMPRESSED_SIZE];
    acCompressedSize        = counters[AC_COMPRESSED_SIZE];
    dcCompressedBytes       = counters[DC_COMPRESSED_SIZE];
    rleCompressedSize       = counters[RLE_COMPRESSED_SIZE];
    rleUncompressedSize     = counters[RLE_UNCOMPRESSED_SIZE];
    rleRawSize              = counters[RLE_RAW_SIZE];
    totalAcUncompressedCount= counters[AC_UNCOMPRESSED_COUNT];
    totalDcUncompressedCount= counters[DC_UNCOMPRESSED_COUNT];
    acCompression           = counters[AC_COMPRESSION];

    // Calculate the total size of compressed data
    compressedSize = unknownCompressedSize + acCompressedSize +
                     dcCompressedBytes + rleCompressedSize;

    // Advance past the header
    dataPtr  = inPtr + headerSize;
    dataLeft = iSize - headerSize;

    // If version >= 2, read stored channel classification rules
    if (version >= 2)
    {
        rv = DwaCompressor_readChannelRules(me, &dataPtr, &dataLeft, &headerSize);
        if (rv != EXR_ERR_SUCCESS) return rv;
    }

    // Check for sufficient data to cover the declared compressed sizes
    if (compressedSize > dataLeft) return EXR_ERR_CORRUPT_CHUNK;

    // Set pointers to the start of each compressed data section
    compressedUnknownBuf = dataPtr;
    dataPtr += unknownCompressedSize;

    compressedAcBuf = dataPtr;
    dataPtr += acCompressedSize;

    compressedDcBuf = dataPtr;
    dataPtr += dcCompressedBytes;

    compressedRleBuf = dataPtr;
    dataPtr += rleCompressedSize;