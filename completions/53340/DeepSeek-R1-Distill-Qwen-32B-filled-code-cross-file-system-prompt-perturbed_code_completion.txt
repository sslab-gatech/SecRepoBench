const int max_audio_channels = m->avctx->codec_id == AV_CODEC_ID_MLP
                                 ? MAX_CHANNELS_MLP
                                 : MAX_CHANNELS_TRUEHD;

    if (maxaudiochannel >= max_audio_channels) {
        av_log(m->avctx, AV_LOG_ERROR, "maxaudiochannel %d exceeds maximum %d\n",
               maxaudiochannel, max_audio_channels - 1);
        return AVERROR_INVALIDDATA;
    }

    if (max_matrix_channel > std_max_matrix_channel) {
        av_log(m->avctx, AV_LOG_ERROR, "max_matrix_channel %d exceeds maximum %d\n",
               max_matrix_channel, std_max_matrix_channel);
        return AVERROR_INVALIDDATA;
    }

    if (max_matrix_channel < maxaudiochannel) {
        av_log(m->avctx, AV_LOG_ERROR, "max_matrix_channel %d < maxaudiochannel %d\n",
               max_matrix_channel, maxaudiochannel);
        return AVERROR_INVALIDDATA;
    }