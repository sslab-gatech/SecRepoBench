if (maxaudiochannel + 1 > MAX_CHANNELS || maxaudiochannel + 1 < min_channel)
    return AVERROR_INVALIDDATA;

if (m->avctx->codec_id == AV_CODEC_ID_MLP && maxaudiochannel + 1 > MAX_MATRIX_CHANNEL_MLP) {
    av_log(m->avctx, AV_LOG_ERROR, "Too many channels in MLP substream.\n");
    return AVERROR_INVALIDDATA;
}

if (m->avctx->codec_id == AV_CODEC_ID_TRUEHD && maxaudiochannel + 1 > MAX_MATRIX_CHANNEL_TRUEHD) {
    av_log(m->avctx, AV_LOG_ERROR, "Too many channels in TrueHD substream.\n");
    return AVERROR_INVALIDDATA;
}