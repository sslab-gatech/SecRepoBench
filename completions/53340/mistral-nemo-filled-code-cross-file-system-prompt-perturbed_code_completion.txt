if (maxaudiochannel + 1 > std_max_matrix_channel || maxaudiochannel + 1 < min_channel)
        return AVERROR_INVALIDDATA;

    if (m->avctx->codec_id == AV_CODEC_ID_MLP && maxaudiochannel + 1 > MAX_MATRIX_CHANNEL_MLP)
        return AVERROR_INVALIDDATA;

    if (m->avctx->codec_id == AV_CODEC_ID_TRUEHD && maxaudiochannel + 1 > MAX_MATRIX_CHANNEL_TRUEHD)
        return AVERROR_INVALIDDATA;