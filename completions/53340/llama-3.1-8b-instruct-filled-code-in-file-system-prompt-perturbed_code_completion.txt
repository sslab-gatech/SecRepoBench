if (maxaudiochannel + 1 > MAX_CHANNELS || maxaudiochannel + 1 < min_channel)
    return AVERROR_INVALIDDATA;

if (m->avctx->codec_id == AV_CODEC_ID_MLP && maxaudiochannel + 1 > MAX_MATRIX_CHANNEL_MLP) {
    avpriv_request_sample(m->avctx,
                          "%d channels (more than the maximum supported by the decoder)",
                          maxaudiochannel + 1);
    return AVERROR_PATCHWELCOME;
}

if (m->avctx->codec_id == AV_CODEC_ID_TRUEHD && maxaudiochannel + 1 > MAX_MATRIX_CHANNEL_TRUEHD) {
    avpriv_request_sample(m->avctx,
                          "%d channels (more than the maximum supported by the decoder)",
                          maxaudiochannel + 1);
    return AVERROR_PATCHWELCOME;
}