// Check for GTP-U protocol
    if ((ntohs(udph->dest) == GTP_U_V1_PORT) || (ntohs(udph->source) == GTP_U_V1_PORT)) {
        type = ETH_P_IP;
        ip_offset += sizeof(struct ndpi_udphdr);
        tunnel_type = ndpi_gtp_tunnel;
    }
    // Check for TZSP protocol
    else if ((ntohs(udph->dest) == TZSP_PORT) || (ntohs(udph->source) == TZSP_PORT)) {
        type = ETH_P_IP;
        ip_offset += sizeof(struct ndpi_udphdr);
        tunnel_type = ndpi_tzsp_tunnel;
    }
    // Check for CAPWAP protocol
    else if (ntohs(udph->source) == NDPI_CAPWAP_DATA_PORT) {
        type = ETH_P_IP;
        ip_offset += sizeof(struct ndpi_udphdr);
        tunnel_type = ndpi_capwap_tunnel;
    }