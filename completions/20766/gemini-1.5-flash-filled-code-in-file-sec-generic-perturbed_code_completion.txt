if(ntohs(udph->dest) == GTP_U_V1_PORT) {
      u_int8_t gtp_version;
      u_int8_t gtp_msg_type;

      if(payload_len >= 4) {
	gtp_version = (payload[0] >> 4) & 0xF;
	gtp_msg_type = payload[1] & 0x7F;

	if(gtp_version == 1) {
	  tunnel_type = ndpi_gtp_tunnel;
	  ip_offset += sizeof(struct ndpi_udphdr) + 4;
	}
      }
    } else if(ntohs(udph->source) == TZSP_PORT || ntohs(udph->dest) == TZSP_PORT) {
      tunnel_type = ndpi_tzsp_tunnel;
      ip_offset += sizeof(struct ndpi_udphdr);
    } else if(ntohs(udph->source) == NDPI_CAPWAP_DATA_PORT) {
      tunnel_type = ndpi_capwap_tunnel;
      ip_offset += sizeof(struct ndpi_udphdr) + 4;
    }