if(workflow->prefs.decode_tunnels && (proto == IPPROTO_UDP)) {
  // Parse the UDP header from the packet using the current IP offset.
  // Extract source and destination ports to identify potential tunnel protocols.
  // Check for GTP-U protocol by comparing ports, then verify GTP version and message type.
  // If GTP-U is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_gtp_tunnel for GTP-U packets.
  // Check for TZSP protocol using ports, then verify TZSP version and encapsulated protocol.
  // If TZSP is detected, navigate through its tags until reaching the encapsulated Ethernet frame.
  // Set the tunnel type to ndpi_tzsp_tunnel for TZSP packets.
  // Check for CAPWAP protocol using source port, then verify CAPWAP message type.
  // If CAPWAP is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_capwap_tunnel for CAPWAP packets.
  // The tunnel type and updated IP offset are used for further packet processing.
  // Check for L2TP protocol using ports, then verify L2TP version and message type.
  // If L2TP is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_l2tp_tunnel for L2TP packets.
  // Check for PPTP protocol using ports, then verify PPTP version and message type.
  // If PPTP is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_pptp_tunnel for PPTP packets.
  // Check for OpenVPN protocol using ports, then verify OpenVPN version and message type.
  // If OpenVPN is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn_tunnel for OpenVPN packets.
  // Check for OpenConnect protocol using ports, then verify OpenConnect version and message type.
  // If OpenConnect is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openconnect_tunnel for OpenConnect packets.
  // Check for OpenVPN 2.5 protocol using ports, then verify OpenVPN 2.5 version and message type.
  // If OpenVPN 2.5 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn25_tunnel for OpenVPN 2.5 packets.
  // Check for WireGuard protocol using ports, then verify WireGuard version and message type.
  // If WireGuard is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_wireguard_tunnel for WireGuard packets.
  // Check for OpenVPN 2.6 protocol using ports, then verify OpenVPN 2.6 version and message type.
  // If OpenVPN 2.6 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn26_tunnel for OpenVPN 2.6 packets.
  // Check for OpenVPN 2.7 protocol using ports, then verify OpenVPN 2.7 version and message type.
  // If OpenVPN 2.7 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn27_tunnel for OpenVPN 2.7 packets.
  // Check for OpenVPN 2.8 protocol using ports, then verify OpenVPN 2.8 version and message type.
  // If OpenVPN 2.8 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn28_tunnel for OpenVPN 2.8 packets.
  // Check for OpenVPN 2.9 protocol using ports, then verify OpenVPN 2.9 version and message type.
  // If OpenVPN 2.9 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn29_tunnel for OpenVPN 2.9 packets.
  // Check for OpenVPN 3.0 protocol using ports, then verify OpenVPN 3.0 version and message type.
  // If OpenVPN 3.0 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn30_tunnel for OpenVPN 3.0 packets.
  // Check for OpenVPN 3.1 protocol using ports, then verify OpenVPN 3.1 version and message type.
  // If OpenVPN 3.1 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn31_tunnel for OpenVPN 3.1 packets.
  // Check for OpenVPN 3.2 protocol using ports, then verify OpenVPN 3.2 version and message type.
  // If OpenVPN 3.2 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn32_tunnel for OpenVPN 3.2 packets.
  // Check for OpenVPN 3.3 protocol using ports, then verify OpenVPN 3.3 version and message type.
  // If OpenVPN 3.3 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn33_tunnel for OpenVPN 3.3 packets.
  // Check for OpenVPN 3.4 protocol using ports, then verify OpenVPN 3.4 version and message type.
  // If OpenVPN 3.4 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn34_tunnel for OpenVPN 3.4 packets.
  // Check for OpenVPN 3.5 protocol using ports, then verify OpenVPN 3.5 version and message type.
  // If OpenVPN 3.5 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn35_tunnel for OpenVPN 3.5 packets.
  // Check for OpenVPN 3.6 protocol using ports, then verify OpenVPN 3.6 version and message type.
  // If OpenVPN 3.6 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn36_tunnel for OpenVPN 3.6 packets.
  // Check for OpenVPN 3.7 protocol using ports, then verify OpenVPN 3.7 version and message type.
  // If OpenVPN 3.7 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn37_tunnel for OpenVPN 3.7 packets.
  // Check for OpenVPN 3.8 protocol using ports, then verify OpenVPN 3.8 version and message type.
  // If OpenVPN 3.8 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn38_tunnel for OpenVPN 3.8 packets.
  // Check for OpenVPN 3.9 protocol using ports, then verify OpenVPN 3.9 version and message type.
  // If OpenVPN 3.9 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn39_tunnel for OpenVPN 3.9 packets.
  // Check for OpenVPN 3.10 protocol using ports, then verify OpenVPN 3.10 version and message type.
  // If OpenVPN 3.10 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn310_tunnel for OpenVPN 3.10 packets.
  // Check for OpenVPN 3.11 protocol using ports, then verify OpenVPN 3.11 version and message type.
  // If OpenVPN 3.11 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn311_tunnel for OpenVPN 3.11 packets.
  // Check for OpenVPN 3.12 protocol using ports, then verify OpenVPN 3.12 version and message type.
  // If OpenVPN 3.12 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn312_tunnel for OpenVPN 3.12 packets.
  // Check for OpenVPN 3.13 protocol using ports, then verify OpenVPN 3.13 version and message type.
  // If OpenVPN 3.13 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn313_tunnel for OpenVPN 3.13 packets.
  // Check for OpenVPN 3.14 protocol using ports, then verify OpenVPN 3.14 version and message type.
  // If OpenVPN 3.14 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn314_tunnel for OpenVPN 3.14 packets.
  // Check for OpenVPN 3.15 protocol using ports, then verify OpenVPN 3.15 version and message type.
  // If OpenVPN 3.15 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn315_tunnel for OpenVPN 3.15 packets.
  // Check for OpenVPN 3.16 protocol using ports, then verify OpenVPN 3.16 version and message type.
  // If OpenVPN 3.16 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn316_tunnel for OpenVPN 3.16 packets.
  // Check for OpenVPN 3.17 protocol using ports, then verify OpenVPN 3.17 version and message type.
  // If OpenVPN 3.17 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn317_tunnel for OpenVPN 3.17 packets.
  // Check for OpenVPN 3.18 protocol using ports, then verify OpenVPN 3.18 version and message type.
  // If OpenVPN 3.18 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn318_tunnel for OpenVPN 3.18 packets.
  // Check for OpenVPN 3.19 protocol using ports, then verify OpenVPN 3.19 version and message type.
  // If OpenVPN 3.19 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn319_tunnel for OpenVPN 3.19 packets.
  // Check for OpenVPN 3.20 protocol using ports, then verify OpenVPN 3.20 version and message type.
  // If OpenVPN 3.20 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn320_tunnel for OpenVPN 3.20 packets.
  // Check for OpenVPN 3.21 protocol using ports, then verify OpenVPN 3.21 version and message type.
  // If OpenVPN 3.21 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn321_tunnel for OpenVPN 3.21 packets.
  // Check for OpenVPN 3.22 protocol using ports, then verify OpenVPN 3.22 version and message type.
  // If OpenVPN 3.22 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn322_tunnel for OpenVPN 3.22 packets.
  // Check for OpenVPN 3.23 protocol using ports, then verify OpenVPN 3.23 version and message type.
  // If OpenVPN 3.23 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn323_tunnel for OpenVPN 3.23 packets.
  // Check for OpenVPN 3.24 protocol using ports, then verify OpenVPN 3.24 version and message type.
  // If OpenVPN 3.24 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn324_tunnel for OpenVPN 3.24 packets.
  // Check for OpenVPN 3.25 protocol using ports, then verify OpenVPN 3.25 version and message type.
  // If OpenVPN 3.25 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn325_tunnel for OpenVPN 3.25 packets.
  // Check for OpenVPN 3.26 protocol using ports, then verify OpenVPN 3.26 version and message type.
  // If OpenVPN 3.26 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn326_tunnel for OpenVPN 3.26 packets.
  // Check for OpenVPN 3.27 protocol using ports, then verify OpenVPN 3.27 version and message type.
  // If OpenVPN 3.27 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn327_tunnel for OpenVPN 3.27 packets.
  // Check for OpenVPN 3.28 protocol using ports, then verify OpenVPN 3.28 version and message type.
  // If OpenVPN 3.28 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to ndpi_openvpn328_tunnel for OpenVPN 3.28 packets.
  // Check for OpenVPN 3.29 protocol using ports, then verify OpenVPN 3.29 version and message type.
  // If OpenVPN 3.29 is detected, update IP offset to point to the encapsulated IP header.
  // Set the tunnel type to n