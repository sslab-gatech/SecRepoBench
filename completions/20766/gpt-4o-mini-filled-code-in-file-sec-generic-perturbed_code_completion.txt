// Check for GTP-U protocol
    if (ntohs(udph->dest) == GTP_U_V1_PORT || ntohs(udph->source) == GTP_U_V1_PORT) {
        // Verify GTP version and message type
        if (payload_len >= 1 && (payload[0] & 0xC0) == 0x20) {
            ip_offset += 8; // Skip GTP header
            tunnel_type = ndpi_gtp_tunnel;
        }
    }

    // Check for TZSP protocol
    if (ntohs(udph->dest) == TZSP_PORT || ntohs(udph->source) == TZSP_PORT) {
        // Verify TZSP version and encapsulated protocol
        if (payload_len >= 2 && payload[0] == 0x00) {
            ip_offset += 4; // Skip TZSP header
            tunnel_type = ndpi_tzsp_tunnel;
        }
    }

    // Check for CAPWAP protocol
    if (ntohs(udph->dest) == NDPI_CAPWAP_DATA_PORT || ntohs(udph->source) == NDPI_CAPWAP_DATA_PORT) {
        // Verify CAPWAP message type
        if (payload_len >= 1 && payload[0] == 0x01) {
            ip_offset += 8; // Skip CAPWAP header
            tunnel_type = ndpi_capwap_tunnel;
        }
    }