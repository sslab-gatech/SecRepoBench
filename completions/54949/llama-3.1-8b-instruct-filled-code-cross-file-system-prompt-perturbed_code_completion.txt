if (ctx->pos < ctx->end && *ctx->pos == '=') {
    // Attempt to parse the data as a dictionary of'strings'.
    // If parsing fails, free the allocated plist and set an error code.
    // If parsing succeeds, assign the newly created dictionary to the plist.
    plist_t dict = plist_new_dict();
    while (ctx->pos < ctx->end &&!ctx->err) {
        parse_skip_ws(ctx);
        if (*ctx->pos == '}') {
            break;
        }
        plist_data_t data = plist_new_plist_data();
        if (*ctx->pos == '"') {
            data->type = PLIST_STRING;
            ctx->pos++;
            size_t slen = 0;
            char* p = ctx->pos;
            while (ctx->pos < ctx->end) {
                if (*ctx->pos == '\\') {
                    unescape_entities(ctx->pos, &slen);
                    ctx->pos += slen;
                } else if (*ctx->pos == '"') {
                    break;
                }
                ctx->pos++;
            }
            if (ctx->pos >= ctx->end) {
                PLIST_OSTEP_ERR("Missing closing quote at offset %ld\n", ctx->pos - ctx->start);
                ctx->err++;
                break;
            }
            ctx->pos++;
            data->strval = strndup(p, ctx->pos - p);
            data->length = ctx->pos - p;
            ctx->pos++;
        } else {
            // unquoted string
            size_t slen = 0;
            parse_skip_ws(ctx);
            p = ctx->pos;
            while (ctx->pos < ctx->end) {
                if (!allowed_unquoted_chars[(uint8_t)*ctx->pos]) {
                    break;
                }
                ctx->pos++;
            }
            slen = ctx->pos-p;
            if (slen > 0) {
                data->type = PLIST_STRING;
                data->strval = strndup(p, slen);
                data->length = slen;
                ctx->pos++;
            } else {
                PLIST_OSTEP_ERR("Unexpected character when parsing unquoted string at offset %ld\n", ctx->pos - ctx->start);
                ctx->err++;
                break;
            }
        }
        plist_dict_insert(dict, data->strval, data);
        parse_skip_ws(ctx);
    }
    if (ctx->err) {
        plist_free(dict);
        goto err_out;
    }
    if (*ctx->pos!= '}') {
        PLIST_OSTEP_ERR("Missing terminating '}' at offset %ld\n", ctx->pos - ctx->start);
        ctx->err++;
        goto err_out;
    }
    ctx->pos++;
    *plist = dict;
    parse_skip_ws(ctx);
    break;
}