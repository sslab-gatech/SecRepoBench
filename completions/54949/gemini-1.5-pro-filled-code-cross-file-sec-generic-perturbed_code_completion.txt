{
            plist_t dict = plist_new_dict();
            if (!dict) {
                err = PLIST_ERR_OUT_OF_MEMORY;
            } else {
                const char *key = ctx.pos;
                const char *val = NULL;
                size_t keylen = 0;
                size_t vallen = 0;
                while (ctx.pos < ctx.end && *ctx.pos != '\0') {
                    parse_skip_ws(&ctx);
                    key = ctx.pos;
                    while (ctx.pos < ctx.end && *ctx.pos != '=') {
                        ctx.pos++;
                    }
                    keylen = ctx.pos - key;
                    if (ctx.pos >= ctx.end || *ctx.pos != '=') {
                        PLIST_OSTEP_ERR("Missing '=' at offset %ld\n", ctx.pos - ctx.start);
                        err = PLIST_ERR_PARSE;
                        break;
                    }
                    ctx.pos++; // skip '='
                    parse_skip_ws(&ctx);
                    if (ctx.pos >= ctx.end) {
                        PLIST_OSTEP_ERR("Missing value at offset %ld\n", ctx.pos - ctx.start);
                        err = PLIST_ERR_PARSE;
                        break;
                    }
                    val = ctx.pos;
                    while (ctx.pos < ctx.end && *ctx.pos != '\0') {
                        ctx.pos++;
                    }
                    vallen = ctx.pos - val;

                    char *keystr = strndup(key, keylen);
                    char *valstr = strndup(val, vallen);

                    plist_t valnode = NULL;
                    plist_data_t valdata = plist_new_plist_data();
                    valdata->type = PLIST_STRING;
                    valdata->strval = valstr;
                    valdata->length = vallen;
                    valnode = plist_new_node(valdata);

                    plist_dict_set_item(dict, keystr, valnode);
                    free(keystr);

                    if (ctx.pos >= ctx.end || *ctx.pos == '\0') {
                        break;
                    }
                 }
            }

            if (err != 0) {
                plist_free(dict);
            } else {
                plist_free(*plist);
                *plist = dict;
            }
        }