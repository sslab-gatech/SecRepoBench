// Check if the primitive type is undefined or if there are no coordinates
if (primitive_type == UndefinedPrimitive || primitive_info->coordinates == 0)
  return(0);

// Allocate memory for the primitive info array
primitive_info=(PrimitiveInfo *) AcquireQuantumMemory((size_t) number_points,
  sizeof(*primitive_info));
if (primitive_info == (PrimitiveInfo *) NULL)
  ThrowFatalException(ResourceLimitFatalError,"MemoryAllocationFailed");

// Initialize the primitive info array
(void) memset(primitive_info,0,(size_t) number_points*sizeof(*primitive_info));

// Set up the first primitive info element
primitive_info[0].primitive=primitive_type;
primitive_info[0].point.x=x;
primitive_info[0].point.y=y;
primitive_info[0].coordinates=0;

// Parse the coordinates and fill in the primitive info array
for (i=0; i < (ssize_t) number_points; i++)
{
  primitive_info[i].primitive=primitive_type;
  primitive_info[i].flags=0;
  status=ParseGeometry(token,&primitive_info[i].point.x);
  if (status == 0)
    break;
  primitive_info[0].coordinates++;
  GetNextToken(q,(const char **) NULL,extent,token);
}

// Set the last element's primitive type to UndefinedPrimitive
primitive_info[i].primitive=UndefinedPrimitive;

return(primitive_info[0].coordinates);