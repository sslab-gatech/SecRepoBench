if (primitive_info == (PrimitiveInfo *) NULL)
  return((PathInfo *) NULL);
if (primitive_info[0].primitive == UndefinedPrimitive)
  return((PathInfo *) NULL);

for (n=0; primitive_info[n].primitive != UndefinedPrimitive; n++)
{
  if (n == SSIZE_MAX-1) /* Prevent overflow during counting */
    return((PathInfo *) NULL);
}
if (n == 0)
  return((PathInfo *) NULL);

/* Ensure no overflow in allocation size calculation */
if (n > (SSIZE_MAX-1)/3)
  return((PathInfo *) NULL);

path_info=(PathInfo *) AcquireMagickMemory((size_t) (3*n+1)*sizeof(*path_info));
if (path_info == (PathInfo *) NULL)
  return((PathInfo *) NULL);

n=0;
coordinates=0;
q.x=0.0;
q.y=0.0;