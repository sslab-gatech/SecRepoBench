if (filter == NULL)
  return 0;

tstart = (int64_t)filter->blockstartpos;
if (tstart < 0)
  return 0;
start = (size_t)tstart;

tend = tstart + filter->blocklength;
/* Invalidate the recorded filter start, effectively resetting it. */
filters->filterstart = INT64_MAX;

/* Attempt to ensure the read buffer is expanded (or consumed) to the end position. */
if (__archive_read_consume(archivereadptr, (tend - rar->offset)) < 0)
  return 0;