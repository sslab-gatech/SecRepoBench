size_t start, end;
  int ret;
  uint32_t lastfilteraddress, lastfilterlength;
  int64_t tend;

  if (!filter)
    return 0;

  start = filter->blockstartpos;
  tend = start + filter->blocklength;
  if (filters->stack && filters->stack->next)
    tend = filters->stack->next->blockstartpos;
  if (lzss_position(&rar->lzss) < start)
  {
    tend = start;
    if (expand(archivereadptr, &tend) != ARCHIVE_OK)
      return 0;
    if (tend < start)
      return 0;
  }