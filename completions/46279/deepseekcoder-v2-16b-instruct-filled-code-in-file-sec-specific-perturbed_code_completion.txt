IVE_FATAL);
      }
    }
    fn_sconv = rar->sconv_utf16be;
  }
  else
  {
    fn_sconv = sconv;
  }

  strp = filename;
  if (fn_sconv != NULL) {
    ret2 = archive_string_conversion_to_charset(
        &a->archive, strp, fn_sconv, &strp);
    if (ret2 != 0) {
      archive_set_error(&a->archive, ret2,
          "Can't convert filename to the specified charset.");
      return (ARCHIVE_FATAL);
    }
  }

  archive_entry_set_pathname(entry, strp);

  rar->mode = file_header.host_os;
  rar->mode |= (file_header.file_attr[0] & 0x1F) << 8;
  rar->mode |= (file_header.file_attr[1] & 0x1F) << 13;
  rar->mode |= (file_header.file_attr[2] & 0x1F) << 16;
  rar->mode |= (file_header.file_attr[3] & 0x03) << 21;

  rar->bytes_remaining -= filename_size;
  p += filename_size;

  rar->bytes_remaining -= 4; /* Skip over the CRC. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 2; /* Skip over the method. */
  p += 2;

  rar->bytes_remaining -= 2; /* Skip over the time. */
  p += 2;

  rar->bytes_remaining -= 4; /* Skip over the CRC. */
  p += 4;

  rar->bytes_remaining -= 2; /* Skip over the size. */
  p += 2;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 2; /* Skip over the size. */
  p += 2;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size. */
  p += 4;

  rar->bytes_remaining -= 4; /* Skip over the size