// <MASK>
int tend = filter->blockstartpos + filter->blocklength;
size_t start = (size_t)filter->blockstartpos;
size_t end;
int ret;

if (filters == NULL || filter == NULL)
  return 0;

if (tend < 0)
  return 0;
end = (size_t)tend;
if (end != start + filter->blocklength)
  return 0;

if (!filters->vm)
{
  filters->vm = calloc(1, sizeof(*filters->vm));
  if (!filters->vm)
    return 0;
}

ret = copy_from_lzss_window(archivereadptr, filters->vm->memory, start, filter->blocklength);
if (ret != ARCHIVE_OK)
  return 0;
if (!execute_filter(archivereadptr, filter, filters->vm, rar->offset))
  return 0;