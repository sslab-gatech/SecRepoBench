import archive_read
import archive_entry

def archive_read_support_format_rar_capabilities(self):
    # ... (existing code)
    return (ARCHIVE_READ_FORMAT_CAPS_ENCRYPT_DATA
            | ARCHIVE_READ_FORMAT_CAPS_ENCRYPT_METADATA)

def archive_read_format_rar_has_encrypted_entries(self, _a):
    rar = self.format.data
    if rar.has_encrypted_entries == ARCHIVE_READ_FORMAT_ENCRYPTION_DONT_KNOW:
        rar.has_encrypted_entries = 0
        for entry in self.entries:
            if entry.is_data_encrypted:
                rar.has_encrypted_entries = 1
                break
    return rar.has_encrypted_entries