if (ret < 0) {
    BLOSC_TRACE_ERROR("Unable to get meta info from frame.");
    return -1;
  }

  // Calculate the trailer offset
  int64_t trailer_offset = header_len + cbytes;
  if (trailer_offset + FRAME_TRAILER_USERMETA_LEN_OFFSET + sizeof(int32_t) > frame_len) {
    BLOSC_TRACE_ERROR("Trailer offset exceeds frame length.");
    return -1;
  }

  // Initialize usermeta_len_network
  int32_t usermeta_len_network;