if (ret < 0) {
  BLOSC_TRACE_ERROR("Unable to retrieve the header info from frame.");
  return -1;
}

// Calculate the trailer offset using the header length and total compressed bytes
int64_t trailer_offset = (int64_t)header_len + cbytes;
if (trailer_offset < 0 || trailer_offset > frame_len) {
  BLOSC_TRACE_ERROR("Trailer offset is out of the frame boundaries.");
  return -1;
}

// Prepare a variable to read the usermeta length (in network order)
int32_t usermeta_len_network = 0;