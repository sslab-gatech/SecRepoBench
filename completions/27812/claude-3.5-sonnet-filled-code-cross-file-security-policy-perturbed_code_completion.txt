if (ret < 0) {
    return ret;
}

int64_t trailer_offset = header_len + cbytes;
if (trailer_offset > frame_len - FRAME_TRAILER_MINLEN) {
    BLOSC_TRACE_ERROR("Invalid trailer offset in frame.");
    return -1;
}

int32_t usermeta_len_network;