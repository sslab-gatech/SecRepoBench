import blosc2

# Function to get the usermeta chunk out of a frame
def frame_get_usermeta(frame_struct, usermeta):
    # Get the size of the user metadata from within the trailer
    if frame_struct.sdata is not None:
        usermeta_len_network = frame_struct.sdata[trailer_offset + FRAME_TRAILER_USERMETA_LEN_OFFSET:trailer_offset + FRAME_TRAILER_USERMETA_LEN_OFFSET + 4]
        usermeta_len = int.from_bytes(usermeta_len_network, byteorder='little')
    else:
        with open(frame_struct.fname, 'rb') as fp:
            fp.seek(trailer_offset + FRAME_TRAILER_USERMETA_LEN_OFFSET)
            usermeta_len_network = fp.read(4)
            usermeta_len = int.from_bytes(usermeta_len_network, byteorder='little')

    if usermeta_len == 0:
        return None, 0

    # Read the user metadata chunk from the trailer
    if frame_struct.sdata is not None:
        usermeta = frame_struct.sdata[trailer_offset + FRAME_TRAILER_USERMETA_OFFSET:trailer_offset + FRAME_TRAILER_USERMETA_OFFSET + usermeta_len]
    else:
        with open(frame_struct.fname, 'rb') as fp:
            fp.seek(trailer_offset + FRAME_TRAILER_USERMETA_OFFSET)
            usermeta = fp.read(usermeta_len)

    return usermeta, usermeta_len