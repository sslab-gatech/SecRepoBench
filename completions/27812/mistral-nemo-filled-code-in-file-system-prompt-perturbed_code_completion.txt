import blosc2

# Function to get the usermeta chunk out of a frame
def frame_get_usermeta(frame_struct, usermeta):
    # Get the size of the user metadata from within the trailer
    if frame_struct.sdata is not None:
        usermeta_len_network = frame_struct.sdata[trailer_offset + FRAME_TRAILER_USERMETA_LEN_OFFSET]
    else:
        with open(frame_struct.fname, 'rb') as fp:
            fp.seek(trailer_offset + FRAME_TRAILER_USERMETA_LEN_OFFSET)
            usermeta_len_network = fp.read(4)
        usermeta_len_network = int.from_bytes(usermeta_len_network, 'big')
    usermeta_len = usermeta_len_network

    if usermeta_len == 0:
        return None, 0

    usermeta = bytearray(usermeta_len)
    if frame_struct.sdata is not None:
        usermeta = frame_struct.sdata[trailer_offset + FRAME_TRAILER_USERMETA_OFFSET:trailer_offset + FRAME_TRAILER_USERMETA_OFFSET + usermeta_len]
    else:
        with open(frame_struct.fname, 'rb') as fp:
            fp.seek(trailer_offset + FRAME_TRAILER_USERMETA_OFFSET)
            usermeta = fp.read(usermeta_len)

    return usermeta, usermeta_len