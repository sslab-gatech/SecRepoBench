if (ret < 0) {
  BLOSC_TRACE_ERROR("Unable to retrieve header information from frame.");
  return -1;
}

int64_t trailer_offset = frame_len - header_len - cbytes - FRAME_TRAILER_MINLEN;
if (trailer_offset < 0 || trailer_offset >= frame_len) {
  BLOSC_TRACE_ERROR("Invalid trailer offset calculated.");
  return -1;
}

int32_t usermeta_len_network;