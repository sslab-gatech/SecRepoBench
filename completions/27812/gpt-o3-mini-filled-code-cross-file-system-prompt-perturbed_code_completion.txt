if (ret < 0) {
  BLOSC_TRACE_ERROR("Failed to retrieve header information.");
  return ret;
}
if (frame_struct->trailer_len <= 0) {
  BLOSC_TRACE_ERROR("Trailer length is invalid.");
  return -1;
}
int64_t trailer_offset = frame_struct->len - frame_struct->trailer_len;
if (trailer_offset < header_len || trailer_offset > frame_struct->len) {
  BLOSC_TRACE_ERROR("Calculated trailer offset (%ld) is out of bounds.", trailer_offset);
  return -1;
}