if (ret < 0) {
  BLOSC_TRACE_ERROR("Failed to retrieve header info for trailer computation.");
  return ret;
}

if (frame_struct->len < header_len + cbytes + FRAME_TRAILER_MINLEN) {
  BLOSC_TRACE_ERROR("Frame is too short to contain a trailer.");
  return -1;
}

int64_t trailer_offset = frame_struct->len - frame_struct->trailer_len;

if (frame_struct->trailer_len < FRAME_TRAILER_USERMETA_LEN_OFFSET + (int32_t)sizeof(int32_t)) {
  BLOSC_TRACE_ERROR("Trailer is too short to contain usermeta length info.");
  return -1;
}