if (ret != 0) {
    return ret;
  }

  int64_t trailer_offset = header_len + cbytes;
  if (trailer_offset < 0 || trailer_offset + FRAME_TRAILER_MINLEN > frame_len) {
    BLOSC_TRACE_ERROR("Invalid trailer offset.");
    return -1;
  }