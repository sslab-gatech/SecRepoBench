if (ret < 0) {
    return ret;
  }

  int32_t usermeta_len_network;
  int64_t trailer_offset = header_len + cbytes;

  if (trailer_offset + FRAME_TRAILER_USERMETA_LEN_OFFSET + sizeof(int32_t) > frame_len) {
      BLOSC_TRACE_ERROR("Invalid trailer offset.");
      return -1;
  }