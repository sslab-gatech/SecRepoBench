if (child->type == RE_NODE_RANGE_ANY &&
    !child->greedy &&
    child->start > YR_RE_CHAINING_THRESHOLD)
{
  FAIL_ON_ERROR(yr_re_ast_create(remainder_re_ast));

  (*remainder_re_ast)->flags = re_ast->flags;
  (*remainder_re_ast)->root_node = child->children_head;

  child->children_head = NULL;
  child->children_tail = NULL;

  *min_gap = child->start;
  *maximumgap = child->end;

  concat = re_ast->root_node;
  concat->children_tail = child->prev_sibling;

  if (child->prev_sibling != NULL)
    child->prev_sibling->next_sibling = NULL;
  else
    concat->children_head = NULL;

  yr_re_node_destroy(child);

  return ERROR_SUCCESS;
}