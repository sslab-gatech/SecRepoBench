(child->type == RE_NODE_RANGE_ANY &&
        !child->greedy &&
        child->min > YR_RE_CHAINING_THRESHOLD)
    {
      *min_gap = child->min;
      *maximumgap = child->max;

      // Create a new AST for the remainder of the expression.
      *remainder_re_ast = (RE_AST*) yr_malloc(sizeof(RE_AST));
      if (*remainder_re_ast == NULL)
        return ERROR_INSUFFICIENT_MEMORY;

      (*remainder_re_ast)->root_node = child->next_sibling;

      if ((*remainder_re_ast)->root_node != NULL)
        (*remainder_re_ast)->root_node->prev_sibling = NULL;

      // Terminate the current AST.
      child->next_sibling = NULL;
      re_ast->root_node->children_tail = child;

      return ERROR_SUCCESS;
    }