if (child->type == RE_NODE_RANGE_ANY || child->type == RE_NODE_STAR)
{
  int32_t range_value = child->range_value;
  if (range_value > *maximumgap)
  {
    *maximumgap = range_value;
  }

  if (*min_gap == 0 || range_value < *min_gap)
  {
    *min_gap = range_value;
  }

  RE_AST* new_re_ast;
  RE_AST* new_remainder_re_ast;

  result = yr_re_ast_create(&new_re_ast);
  if (result != ERROR_SUCCESS)
  {
    return result;
  }

  new_re_ast->root_node = child;

  RE_NODE* new_child = child->next_sibling;
  while (new_child != NULL)
  {
    RE_NODE* next_sibling = new_child->next_sibling;
    new_child->prev_sibling = NULL;
    new_child->next_sibling = NULL;
    yr_re_node_destroy(new_child);
    new_child = next_sibling;
  }

  child->next_sibling = NULL;

  *remainder_re_ast = new_remainder_re_ast;
  *result_re_ast = new_re_ast;

  return ERROR_SUCCESS;
}