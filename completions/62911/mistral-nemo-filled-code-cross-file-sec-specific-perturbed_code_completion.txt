if (entry->name == NULL || len < 0) {
    *pfound = 0;
    return (NULL);
}

if (prefix == NULL) {
    if (len == 0 || entry->name[len] == '\0') {
        *pfound = 1;
        return (entry);
    }
} else {
    if (xmlStrEqual(prefix, entry->prefix) && xmlStrEqual(key_name, entry->name)) {
        *pfound = 1;
        return (entry);
    }
}

*pfound = 0;
return (NULL);