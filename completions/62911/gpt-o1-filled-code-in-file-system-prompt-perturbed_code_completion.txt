if (prefix == NULL) {
    if (!memcmp(entry->name, key_name, len) &&
        (entry->name[len] == 0)) {
        found = 1;
        break;
    }
} else {
    if (!memcmp(entry->name, prefix, plen) &&
        (entry->name[plen] == ':') &&
        !memcmp(&entry->name[plen + 1], key_name, len - (plen + 1)) &&
        (entry->name[len] == 0)) {
        found = 1;
        break;
    }
}