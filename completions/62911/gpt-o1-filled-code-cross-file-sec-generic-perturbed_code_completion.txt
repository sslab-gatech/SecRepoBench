if (prefix == NULL) {
    /*
     * If no prefix is given, compare the entry name with the provided key_name
     * up to the specified length, then check if the dictionary entry's name is
     * null-terminated at that position.
     */
    if (len < 0) {
        /* Safely determine length if not already provided */
        len = xmlStrlen(key_name);
    }
    if ((xmlStrncmp(entry->name, key_name, len) == 0) &&
        (entry->name[len] == 0))
    {
        found = 1;
        break;
    }
} else {
    /*
     * If a prefix is provided, use a specialized function to compare
     * the qualified names (prefix:name).
     */
    if (xmlDictCompareQNames(entry->name, prefix, key_name)) {
        found = 1;
        break;
    }
}