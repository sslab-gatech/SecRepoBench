if (prefix == NULL) {
    if (len == entry->klen && memcmp(name, entry->name, len) == 0) {
        found = 1;
    }
} else {
    if (plen == entry->plen && len == entry->len &&
        memcmp(prefix, entry->prefix, plen) == 0 &&
        memcmp(name, &entry->name[plen + 1], len) == 0) {
        found = 1;
    }
}