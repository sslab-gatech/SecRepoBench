// Ensure the input record is not null
if (record.isNull())
    return resRec;

// Calculate the next record's base pointer
const uint8_t* nextRecordPtr = record.getBasePtr() + record.getSize();

// Check if the next record pointer is within bounds
if (nextRecordPtr < tlvBufferPtr || nextRecordPtr >= tlvBufferPtr + tlvDataLen)
    return resRec; // Out of bounds, return null record

// Initialize the next record
TLVRecordType nextRecord(nextRecordPtr);

// Validate the next record
if (!nextRecord.isValid() || nextRecord.getBasePtr() + nextRecord.getSize() > tlvBufferPtr + tlvDataLen)
    return resRec; // Invalid or out of bounds, return null record

// Assign the valid next record to the result
resRec = nextRecord;
return resRec;