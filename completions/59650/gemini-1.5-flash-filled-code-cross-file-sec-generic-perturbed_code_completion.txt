if (record.isNull())
				return resRec;

			size_t recordSize = record.getSize();
			uint8_t* nextRecordPtr = record.getRawData() + recordSize;
			size_t nextRecordLen = tlvDataLen - (nextRecordPtr - tlvBufferPtr);

			if (nextRecordLen < sizeof(uint16_t) * 2) // check if there is at least enough space for a TLV record header
			{
				resRec.assign(NULL);
				return resRec; // for NRVO optimization
			}

			resRec.parse(nextRecordPtr, nextRecordLen);
			if (resRec.isNull())
			{
				resRec.assign(NULL);
				return resRec; // for NRVO optimization
			}

			return resRec; // for NRVO optimization