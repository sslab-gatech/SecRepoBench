size_t recordSize = record.getSize();
const uint8_t* nextRecordPtr = tlvBufferPtr + record.getOffset() + recordSize;

if (nextRecordPtr >= tlvBufferPtr && (nextRecordPtr + recordSize) <= (tlvBufferPtr + tlvDataLen)) {
    resRec = TLVRecordType(nextRecordPtr);
} else {
    resRec.assign(NULL);
}