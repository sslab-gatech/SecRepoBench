if (record.isNull())
    return resRec;

const size_t curSize = record.getTotalSize();
if (curSize == 0)
    return resRec;

const uint8_t* nextPtr = record.getRecordBasePtr() + curSize;
if (nextPtr < tlvBufferPtr || nextPtr >= tlvBufferPtr + tlvDataLen)
    return resRec;

resRec.assign(nextPtr);
if (resRec.isNull() || (nextPtr + resRec.getTotalSize() > tlvBufferPtr + tlvDataLen))
    resRec.assign(NULL);

return resRec;