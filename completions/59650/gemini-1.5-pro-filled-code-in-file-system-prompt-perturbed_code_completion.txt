if (record.isNull())
{
    return resRec;
}

uint8_t* nextRecPtr = record.getRecordBasePtr() + record.getTotalSize();

// Check if the next record's memory location is within the bounds of the TLV buffer.
if (nextRecPtr >= tlvBufferPtr + tlvDataLen)
{
    return resRec;
}


resRec.assign(nextRecPtr);

// Check if the calculated next record is valid and within the bounds of the TLV memory.
if (resRec.getRecordBasePtr() + resRec.getTotalSize() > tlvBufferPtr + tlvDataLen)
{
    resRec.assign(NULL);
}

return resRec;