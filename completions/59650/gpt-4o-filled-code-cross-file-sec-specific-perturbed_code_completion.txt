if (record.isNull() || tlvBufferPtr == nullptr || tlvDataLen == 0) {
    return resRec;
}

size_t currentRecordSize = record.getSize();
const uint8_t* nextRecordPtr = record.getBasePtr() + currentRecordSize;

// Check if the next record pointer is within bounds
if (nextRecordPtr < tlvBufferPtr || nextRecordPtr >= tlvBufferPtr + tlvDataLen) {
    return resRec;
}

// Create the next TLV record
resRec = TLVRecordType(nextRecordPtr);

// Validate the new record
if (resRec.isNull() || resRec.getBasePtr() + resRec.getSize() > tlvBufferPtr + tlvDataLen) {
    resRec.assign(NULL);
}

return resRec;