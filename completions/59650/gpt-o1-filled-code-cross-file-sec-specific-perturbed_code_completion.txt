if (record.isNull())
{
    // If the current record is null, there is no next record
    return resRec;
}

size_t currentOffset = static_cast<size_t>(record.getRecordBase() - tlvBufferPtr);
if (currentOffset >= tlvDataLen)
{
    // Out of buffer bounds
    return resRec;
}

size_t currentSize = record.getTotalSize();
if (currentSize == 0 || (currentOffset + currentSize) > tlvDataLen)
{
    // Invalid size or out of buffer bounds
    return resRec;
}

size_t nextOffset = currentOffset + currentSize;
if (nextOffset >= tlvDataLen)
{
    // No space for another record
    return resRec;
}

// Construct the next record
TLVRecordType nextRec(tlvBufferPtr + nextOffset);

// Validate the next record
if (!nextRec.isValid(tlvBufferPtr, tlvDataLen))
{
    // If invalid, reset to null
    return resRec;
}

// Otherwise, it's a valid next record
resRec = nextRec;
return resRec;