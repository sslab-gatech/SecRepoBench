if (record.isNull())
    return resRec;

const uint8_t* currentPtr = record.getRecordPtr();
size_t recordSize = record.getSize();
const uint8_t* nextPtr = currentPtr + recordSize;

if (nextPtr >= (tlvBufferPtr + tlvDataLen))
{
    resRec.assign(NULL);
    return resRec;
}

resRec.assign(nextPtr);

if (!resRec.isValid(tlvBufferPtr, tlvDataLen))
    resRec.assign(NULL);

return resRec;