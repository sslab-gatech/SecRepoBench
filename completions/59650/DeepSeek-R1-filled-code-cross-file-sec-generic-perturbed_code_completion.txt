if (record.isNull())
{
	return resRec;
}

const uint8_t* nextPtr = record.getBasePtr() + record.getTotalSize();
size_t remainingLen = tlvDataLen - (nextPtr - tlvBufferPtr);

if (nextPtr >= tlvBufferPtr + tlvDataLen || remainingLen < TLVRecordType::getHeaderSize())
{
	resRec.assign(NULL);
	return resRec;
}

resRec.assign(nextPtr, remainingLen);

if (!resRec.isValid() || (nextPtr + resRec.getTotalSize() > tlvBufferPtr + tlvDataLen))
{
	resRec.assign(NULL);
}

return resRec;