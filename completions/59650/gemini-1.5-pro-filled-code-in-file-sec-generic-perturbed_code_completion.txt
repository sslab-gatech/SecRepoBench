if (record.isNull())
{
    return resRec;
}

uint8_t* nextRecPtr = record.getRecordBasePtr() + record.getTotalSize();

// Check if the next record's memory range is within the bounds of the TLV buffer.
if (nextRecPtr + sizeof(typename TLVRecordType::TLVRawData) > tlvBufferPtr + tlvDataLen)
{
    return resRec;
}


resRec.assign(nextRecPtr);

// Check if the next record's total size exceeds the remaining TLV buffer size.
if (resRec.getRecordBasePtr() + resRec.getTotalSize() > tlvBufferPtr + tlvDataLen)
{
    resRec.assign(NULL);
}

// Check if the next record's total size is zero.
if (!resRec.isNull() && resRec.getTotalSize() == 0)
{
    resRec.assign(NULL);
}


return resRec;