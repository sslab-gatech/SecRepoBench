if (record.isNull())
				return resRec;

			uint8_t* nextRecPtr = record.getRecordBasePtr() + record.getTotalSize();
			if (nextRecPtr + sizeof(TLVRecordType) > (uint8_t*)tlvBufferPtr + tlvDataLen)
			{
				resRec.assign(NULL);
				return resRec;
			}

			resRec.assign(nextRecPtr);
			if (resRec.getRecordBasePtr() + resRec.getTotalSize() > (uint8_t*)tlvBufferPtr + tlvDataLen)
				resRec.assign(NULL);

			if (!resRec.isNull() && (tlvDataLen == 0 || resRec.getTotalSize() == 0))
				resRec.assign(NULL);

			return resRec;