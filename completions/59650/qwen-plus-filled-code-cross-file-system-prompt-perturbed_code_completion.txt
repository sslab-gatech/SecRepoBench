if (record.isNull())
{
	resRec.assign(NULL);
	return resRec;
}

uint8_t* nextRecordPtr = record.getBasePointer() + record.getTotalSize();
size_t remainingDataLen = tlvDataLen - (nextRecordPtr - tlvBufferPtr);

if (remainingDataLen < sizeof(TLVRecordType) || !TLVRecordType::isValid(nextRecordPtr, remainingDataLen))
{
	resRec.assign(NULL);
}
else
{
	resRec.assign(nextRecordPtr);
}

return resRec;