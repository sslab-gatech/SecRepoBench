if (record.isNull()) {
    return resRec;
}

size_t recordSize = record.getSize();
if (recordSize == 0 || record.getBasePtr() + recordSize > tlvBufferPtr + tlvDataLen) {
    return resRec;
}

const uint8_t* nextRecordPtr = record.getBasePtr() + recordSize;
if (nextRecordPtr >= tlvBufferPtr + tlvDataLen) {
    return resRec;
}

resRec = TLVRecordType(nextRecordPtr);
return resRec;