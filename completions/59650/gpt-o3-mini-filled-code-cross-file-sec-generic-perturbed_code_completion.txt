if (record.isNull())
    return resRec;

size_t currentRecordSize = record.getSize();
if (currentRecordSize == 0)
    return resRec;

// Assume getRecordBase() returns a pointer to the beginning of the current TLV record.
const uint8_t* currentRecordPtr = record.getRecordBase();

// Ensure the current record pointer is within bounds.
if (currentRecordPtr < tlvBufferPtr || currentRecordPtr >= tlvBufferPtr + tlvDataLen)
    return resRec;

// Calculate the pointer for the next record safely.
const uint8_t* nextRecordPtr = currentRecordPtr + currentRecordSize;
if (nextRecordPtr < tlvBufferPtr || nextRecordPtr >= tlvBufferPtr + tlvDataLen)
    return resRec;

// Initialize the next TLV record.
resRec = TLVRecordType(nextRecordPtr);

// Validate that the new record is entirely within the TLV buffer bounds.
size_t nextRecordSize = resRec.getSize();
if (nextRecordSize == 0 || (nextRecordPtr + nextRecordSize) > (tlvBufferPtr + tlvDataLen))
    resRec.assign(NULL);

return resRec;