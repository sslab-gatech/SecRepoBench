if (record.isNull())
{
	resRec.assign(NULL);
	return resRec;
}

const uint8_t* nextBasePtr = record.getBasePtr() + record.getTotalSize();
if (nextBasePtr < tlvBufferPtr || nextBasePtr >= tlvBufferPtr + tlvDataLen)
{
	resRec.assign(NULL);
	return resRec;
}

TLVRecordType nextRec(nextBasePtr);
if (nextRec.isNull() || (nextRec.getBasePtr() + nextRec.getTotalSize() > (tlvBufferPtr + tlvDataLen)))
{
	resRec.assign(NULL);
}
else
{
	resRec = nextRec;
}

return resRec;