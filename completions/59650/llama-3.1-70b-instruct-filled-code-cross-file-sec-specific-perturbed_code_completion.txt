if (record.isNull() || tlvDataLen == 0)
    return resRec;

size_t recordSize = record.getSize();
if (recordSize == 0 || recordSize > tlvDataLen)
    return resRec;

const uint8_t* nextRecordPtr = tlvBufferPtr + recordSize;
size_t nextRecordLen = tlvDataLen - recordSize;
if (nextRecordLen < sizeof(TLVRecordHeader))
    return resRec;

resRec = TLVRecordType(nextRecordPtr, nextRecordLen);
if (resRec.isNull())
    return resRec;

return resRec;