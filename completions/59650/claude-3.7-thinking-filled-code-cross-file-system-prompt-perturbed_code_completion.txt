if (record.isNull())
{
    return resRec; // Return uninitialized result record
}

// Calculate the next TLV record by advancing the current record's base pointer by its total size
const uint8_t* nextRecordPtr = record.getRawData() + record.getSize();

// Check if the next record is out-of-bounds
size_t offsetFromStart = nextRecordPtr - tlvBufferPtr;
if (offsetFromStart >= tlvDataLen)
{
    return resRec; // Return uninitialized (null) result record
}

// Initialize the next record
resRec.assign(const_cast<uint8_t*>(nextRecordPtr));

// Verify the record is valid and not out-of-bounds
if (!resRec.isValid() || (resRec.getRawData() + resRec.getSize() > tlvBufferPtr + tlvDataLen))
{
    resRec.assign(NULL); // Reset to null if invalid or out-of-bounds
}

return resRec;