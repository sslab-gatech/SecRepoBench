if (record.isNull())
    return resRec;

uint8_t* nextRecPtr = record.getRecordBasePtr() + record.getTotalSize();

// Check if the next record's memory range is within the valid TLV buffer bounds.
if (nextRecPtr + sizeof(typename TLVRecordType::TLVRawData) > tlvBufferPtr + tlvDataLen)
	return resRec;


resRec.assign(nextRecPtr);

if (resRec.getRecordBasePtr() + resRec.getTotalSize() > tlvBufferPtr + tlvDataLen)
	resRec.assign(NULL);

if (resRec.getTotalSize() == 0)
	resRec.assign(NULL);

return resRec;