if (record.isNull())
    return resRec;

// Calculate the next record's base pointer
const uint8_t* nextRecordPtr = record.getBasePtr() + record.getTotalSize();

// Check if the next record pointer is within bounds
if (nextRecordPtr < tlvBufferPtr || nextRecordPtr >= tlvBufferPtr + tlvDataLen)
    return resRec;

// Initialize the next record
resRec = TLVRecordType(nextRecordPtr);

// Validate the next record
if (!resRec.isValid() || resRec.getBasePtr() + resRec.getTotalSize() > tlvBufferPtr + tlvDataLen)
    resRec.assign(NULL);

return resRec;