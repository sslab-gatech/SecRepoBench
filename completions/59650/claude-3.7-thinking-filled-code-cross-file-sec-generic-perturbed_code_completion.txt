if (record.isNull())
{
    return resRec; // Return uninitialized result record
}

// Get the base pointer and size of the current record
const uint8_t* recordPtr = record.getData();
size_t recordSize = record.getSize();

// Check if the current record is valid and within bounds
if (recordPtr < tlvBufferPtr || recordSize == 0 || 
    tlvDataLen < recordSize || // Avoid overflow in the next check
    recordPtr > tlvBufferPtr + tlvDataLen - recordSize)
{
    return resRec; // Invalid record, return uninitialized result
}

// Calculate the pointer to the next record
const uint8_t* nextRecordPtr = recordPtr + recordSize;

// Assign the next record
resRec.assign(nextRecordPtr);

// Validate the next record
size_t nextRecordSize = resRec.getSize();
if (nextRecordSize == 0 || 
    tlvDataLen < nextRecordSize || // Avoid overflow in the next check
    nextRecordPtr > tlvBufferPtr + tlvDataLen - nextRecordSize)
{
    resRec.assign(NULL); // Invalid next record, reset to null
}

return resRec;