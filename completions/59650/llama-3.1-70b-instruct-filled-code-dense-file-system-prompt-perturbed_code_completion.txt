if (record.isNull())
{
    return resRec;
}

const uint8_t* nextRecPtr = record.getRecordBasePtr() + record.getTotalSize();
resRec.assign(nextRecPtr);

// resRec pointer is out-bounds of the TLV records memory
if (resRec.getRecordBasePtr() + resRec.getTotalSize() > tlvBufferPtr + tlvDataLen)
    resRec.assign(NULL);

// check if there are records at all and the total size is not zero
if (!resRec.isNull() && (tlvDataLen == 0 || resRec.getTotalSize() == 0))
    resRec.assign(NULL);

return resRec;