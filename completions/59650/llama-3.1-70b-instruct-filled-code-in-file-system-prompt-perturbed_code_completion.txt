if (record.isNull())
    return resRec;

uint8_t* nextRecPtr = record.getRecordBasePtr() + record.getTotalSize();
if (nextRecPtr + sizeof(TLVRecordType::TLVRawData) > tlvBufferPtr + tlvDataLen)
    return resRec;

resRec.assign(nextRecPtr);
if (resRec.getTotalSize() > tlvDataLen - (nextRecPtr - tlvBufferPtr))
    resRec.assign(NULL);

return resRec;