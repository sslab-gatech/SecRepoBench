if (record.isNull())
    return resRec;

size_t recordSize = record.getSize();
if (recordSize == 0)
    return resRec;

const uint8_t* recordBasePtr = record.getBasePtr();
if (recordBasePtr + recordSize > tlvBufferPtr + tlvDataLen)
    return resRec;

resRec = TLVRecordType(recordBasePtr + recordSize, tlvBufferPtr, tlvDataLen);
return resRec;