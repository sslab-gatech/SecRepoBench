if (record.isNull())
    return resRec;

size_t recordSize = record.getSize();
if (recordSize == 0)
    return resRec;

const uint8_t* recordBasePtr = record.getBasePtr();
if (recordBasePtr == NULL)
    return resRec;

size_t nextRecordOffset = (size_t)(recordBasePtr - tlvBufferPtr) + recordSize;
if (nextRecordOffset > tlvDataLen)
    return resRec;

const uint8_t* nextRecordBasePtr = tlvBufferPtr + nextRecordOffset;
resRec.assign(nextRecordBasePtr);
return resRec;