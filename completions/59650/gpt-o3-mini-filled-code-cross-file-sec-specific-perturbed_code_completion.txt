if(record.isNull())
    return resRec;

const uint8_t* currentPtr = record.getRecordStart();
if (currentPtr < tlvBufferPtr || currentPtr >= tlvBufferPtr + tlvDataLen)
    return resRec;

size_t currentSize = record.getSize();
if (currentSize == 0)
    return resRec;

const uint8_t* nextPtr = currentPtr + currentSize;
if (nextPtr < tlvBufferPtr || nextPtr >= tlvBufferPtr + tlvDataLen)
    return resRec;

TLVRecordType nextRec(const_cast<uint8_t*>(nextPtr));
size_t remainingLen = tlvDataLen - (nextPtr - tlvBufferPtr);
if (nextRec.getSize() > remainingLen)
{
    nextRec.assign(NULL);
}

return nextRec;