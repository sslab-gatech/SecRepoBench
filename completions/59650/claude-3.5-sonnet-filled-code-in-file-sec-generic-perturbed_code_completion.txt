if (record.isNull()) {
    return resRec;
}

uint8_t* nextRecordPtr = record.getRecordBasePtr() + record.getTotalSize();
resRec.assign(nextRecordPtr);

if (resRec.isNull() || resRec.getTotalSize() == 0 || 
    nextRecordPtr + resRec.getTotalSize() > tlvBufferPtr + tlvDataLen) {
    resRec.assign(NULL);
}

return resRec;