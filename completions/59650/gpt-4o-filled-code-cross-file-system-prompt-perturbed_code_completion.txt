if (record.isNull())
    return resRec;

const uint8_t* nextRecordPtr = record.getBasePtr() + record.getTotalSize();
if (nextRecordPtr >= tlvBufferPtr + tlvDataLen)
{
    resRec.assign(NULL);
    return resRec;
}

resRec.assign(nextRecordPtr);
if (!resRec.isValid() || resRec.getBasePtr() + resRec.getTotalSize() > tlvBufferPtr + tlvDataLen)
{
    resRec.assign(NULL);
}

return resRec;