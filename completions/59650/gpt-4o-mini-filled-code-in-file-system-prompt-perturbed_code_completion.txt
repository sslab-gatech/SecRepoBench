const uint8_t* nextRecordPtr = record.getRecordBasePtr() + record.getTotalSize();
if (nextRecordPtr >= tlvBufferPtr + tlvDataLen)
    return resRec;

resRec.assign((uint8_t*)nextRecordPtr);

// Check if the next record is valid
if (resRec.getTotalSize() == 0 || resRec.getRecordBasePtr() + resRec.getTotalSize() > tlvBufferPtr + tlvDataLen)
    resRec.assign(NULL);

return resRec;