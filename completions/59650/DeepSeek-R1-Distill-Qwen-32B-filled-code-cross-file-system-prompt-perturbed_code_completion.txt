if (record.isNull())
{
    return resRec;
}

const uint8_t* currentRecPtr = record.getBasePtr();
const uint8_t* nextRecPtr = currentRecPtr + record.getTotalSize();

// Check if next record is within bounds
if (nextRecPtr > tlvBufferPtr + tlvDataLen || nextRecPtr < tlvBufferPtr)
{
    resRec.assign(NULL);
    return resRec;
}

resRec.assign(nextRecPtr);
return resRec;