if (record.isNull())
{
    return resRec; // Return uninitialized record (NULL)
}

// Calculate the position of the next record
const uint8_t* nextRecordPtr = record.getRawData() + record.getSize();

// Check if the next record is within the valid TLV memory range
if (nextRecordPtr < tlvBufferPtr || nextRecordPtr >= (tlvBufferPtr + tlvDataLen))
{
    return resRec; // Out of bounds, return null record
}

// Initialize the next record
resRec.assign(const_cast<uint8_t*>(nextRecordPtr));

// Check if the next record is valid (its size fits within the remaining buffer)
size_t remainingSize = (tlvBufferPtr + tlvDataLen) - nextRecordPtr;
if (resRec.getSize() > remainingSize)
{
    resRec.assign(NULL); // Invalid size, reset to null
}

return resRec;