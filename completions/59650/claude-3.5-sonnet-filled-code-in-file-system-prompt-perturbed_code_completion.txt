if (record.isNull())
    return resRec;

resRec.assign((uint8_t*)(record.getRecordBasePtr() + record.getTotalSize()));

if (resRec.getRecordBasePtr() + resRec.getTotalSize() > tlvBufferPtr + tlvDataLen || resRec.getTotalSize() == 0)
    resRec.assign(NULL);

return resRec;