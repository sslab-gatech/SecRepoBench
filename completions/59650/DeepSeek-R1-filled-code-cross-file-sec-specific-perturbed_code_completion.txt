if (record.isNull())
{
	return resRec;
}

const uint8_t* currentBase = record.getBasePtr();
size_t currentTotalSize = record.getTotalSize();

// Validate current record boundaries
if (currentBase < tlvBufferPtr || (currentBase + currentTotalSize) > (tlvBufferPtr + tlvDataLen))
{
	resRec.assign(NULL);
	return resRec;
}

const uint8_t* nextBase = currentBase + currentTotalSize;
size_t remainingBytes = tlvDataLen - (nextBase - tlvBufferPtr);

// Check minimum required space for TLV header (type + length)
const size_t minHeaderSize = sizeof(uint32_t) + sizeof(uint32_t);
if (remainingBytes < minHeaderSize)
{
	resRec.assign(NULL);
	return resRec;
}

// Create and validate next record
TLVRecordType nextRec(nextBase);
if (nextRec.isValid() && (nextBase + nextRec.getTotalSize()) <= (tlvBufferPtr + tlvDataLen))
{
	resRec = nextRec;
}
else
{
	resRec.assign(NULL);
}

return resRec;