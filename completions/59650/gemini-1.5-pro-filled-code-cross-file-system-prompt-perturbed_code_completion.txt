if (record.isNull())
				return resRec;

			const uint8_t* nextRecordPtr = record.getRecordBasePtr() + record.getRecordTotalSize();
			size_t nextRecordOffset = nextRecordPtr - tlvBufferPtr;

			if (nextRecordOffset >= tlvDataLen || nextRecordPtr + sizeof(uint32_t) > tlvBufferPtr + tlvDataLen)
				return resRec;

			resRec.assign(nextRecordPtr, tlvBufferPtr, tlvDataLen);
			if (resRec.isNull()) // check if the record is valid
				return TLVRecordType(NULL);

			return resRec;