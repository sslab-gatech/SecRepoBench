if (record.isNull() || tlvBufferPtr == nullptr || tlvDataLen == 0) {
    return resRec;
}

size_t currentRecordSize = record.getSize();
const uint8_t* nextRecordPtr = record.getBasePtr() + currentRecordSize;

// Check if the next record pointer is within bounds
if (nextRecordPtr < tlvBufferPtr || nextRecordPtr >= tlvBufferPtr + tlvDataLen) {
    return resRec;
}

// Create the next record
TLVRecordType nextRecord(nextRecordPtr);

// Validate the next record
if (nextRecord.isValid() && nextRecord.getBasePtr() + nextRecord.getSize() <= tlvBufferPtr + tlvDataLen) {
    resRec = nextRecord;
}

return resRec;