if (record.isNull())
    return resRec;

// Calculate the next record's base pointer
const uint8_t* nextRecordBasePtr = record.getBasePtr() + record.getTotalSize();

// Check if the next record is within bounds
if (nextRecordBasePtr < tlvBufferPtr || nextRecordBasePtr >= tlvBufferPtr + tlvDataLen)
{
    resRec.assign(NULL);
    return resRec;
}

// Initialize the next record
resRec.assign(nextRecordBasePtr);

// Validate the next record
if (!resRec.isValid() || resRec.getTotalSize() > (tlvBufferPtr + tlvDataLen - nextRecordBasePtr))
{
    resRec.assign(NULL);
}

return resRec;