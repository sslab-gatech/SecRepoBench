;
    case RightTopOrientation: dpx.image.orientation=5; break;
    case LeftBottomOrientation: dpx.image.orientation=6; break;
    case RightBottomOrientation: dpx.image.orientation=7; break;
  }
  offset+=WriteBlobShort(image,dpx.image.orientation);
  dpx.image.number_elements=(unsigned short) image->number_scenes;
  offset+=WriteBlobShort(image,dpx.image.number_elements);
  dpx.image.pixels_per_line=(unsigned int) image->columns;
  offset+=WriteBlobLong(image,dpx.image.pixels_per_line);
  dpx.image.lines_per_element=(unsigned int) image->rows;
  offset+=WriteBlobLong(image,dpx.image.lines_per_element);
  for (i=0; i < (ssize_t) image->number_scenes; i++)
  {
    const DPXImageElement
      *element;

    element=&dpx.image.image_element[i];
    element->data_sign=0x00000000U;
    offset+=WriteBlobLong(image,element->data_sign);
    element->low_data=0x00000000U;
    offset+=WriteBlobLong(image,element->low_data);
    element->low_quantity=0.0F;
    offset+=WriteBlobFloat(image,element->low_quantity);
    element->high_data=0x00000000U;
    offset+=WriteBlobLong(image,element->high_data);
    element->high_quantity=0.0F;
    offset+=WriteBlobFloat(image,element->high_quantity);
    element->descriptor=0x00;
    offset+=WriteBlobByte(image,element->descriptor);
    element->transfer_characteristic=0x00;
    offset+=WriteBlobByte(image,element->transfer_characteristic);
    element->colorimetric=0x00;
    offset+=WriteBlobByte(image,element->colorimetric);
    element->bit_size=0x00;
    offset+=WriteBlobByte(image,element->bit_size);
    element->packing=0x0000;
    offset+=WriteBlobShort(image,element->packing);
    element->encoding=0x0000;
    offset+=WriteBlobShort(image,element->encoding);
    element->data_offset=0x00000000U;
    offset+=WriteBlobLong(image,element->data_offset);
    element->end_of_line_padding=0x00000000U;
    offset+=WriteBlobLong(image,element->end_of_line_padding);
    element->end_of_image_padding=0x00000000U;
    offset+=WriteBlobLong(image,element->end_of_image_padding);
    offset+=WriteBlob(image,sizeof(element->description),(unsigned char *)
      element->description);
  }
  offset+=WriteBlob(image,sizeof(dpx.image.reserve),(unsigned char *)
    dpx.image.reserve);
  /*
    Write orientation header.
  */
  if (image->orientation != TopLeftOrientation)
    {
      dpx.orientation.x_offset=0x00000000U;
      offset+=WriteBlobLong(image,dpx.orientation.x_offset);
      dpx.orientation.y_offset=0x00000000U;
      offset+=WriteBlobLong(image,dpx.orientation.y_offset);
      dpx.orientation.x_center=0.0F;
      offset+=WriteBlobFloat(image,dpx.orientation.x_center);
      dpx.orientation.y_center=0.0F;
      offset+=WriteBlobFloat(image,dpx.orientation.y_center);
      dpx.orientation.x_size=0x00000000U;
      offset+=WriteBlobLong(image,dpx.orientation.x_size);
      dpx.orientation.y_size=0x00000000U;
      offset+=WriteBlobLong(image,dpx.orientation.y_size);
      offset+=WriteBlob(image,sizeof(dpx.orientation.filename),(unsigned char *)
        dpx.orientation.filename);
      offset+=WriteBlob(image,sizeof(dpx.orientation.timestamp),(unsigned char *)
        dpx.orientation.timestamp);
      offset+=WriteBlob(image,sizeof(dpx.orientation.device),(unsigned char *)
        dpx.orientation.device);
      offset+=WriteBlob(image,sizeof(dpx.orientation.serial),(unsigned char *)
        dpx.orientation.serial);
      for (i=0; i < 4; i++)
        offset+=WriteBlobShort(image,dpx.orientation.border[i]);
      offset+=WriteBlob(image,sizeof(dpx.orientation.aspect_ratio),(unsigned char *)
        dpx.orientation.aspect_ratio);
      offset+=WriteBlob(image,sizeof(dpx.orientation.reserve),(unsigned char *)
        dpx.orientation.reserve);
    }
  /*
    Write film header.
  */
  (void) strncpy(dpx.film.id,"00",sizeof(dpx.film.id)-1);
  offset+=WriteBlob(image,sizeof(dpx.film.id),(unsigned char *) dpx.film.id);
  (void) strncpy(dpx.film.type,"00",sizeof(dpx.film.type)-1);
  offset+=WriteBlob(image,sizeof(dpx.film.type),(unsigned char *) dpx.film.type);
  (void) strncpy(dpx.film.offset,"00",sizeof(dpx.film.offset)-1);
  offset+=WriteBlob(image,sizeof(dpx.film.offset),(unsigned char *) dpx.film.offset);
  (void) strncpy(dpx.film.prefix,"000000",sizeof(dpx.film.prefix)-1);
  offset+=WriteBlob(image,sizeof(dpx.film.prefix),(unsigned char *) dpx.film.prefix);
  (void) FormatLocaleString(dpx.film.count,"%04u",image->scene);
  offset+=WriteBlob(image,sizeof(dpx.film.count),(unsigned char *) dpx.film.count);
  dpx.film.frame_position=0;
  offset+=WriteBlobLong(image,dpx.film.frame_position);
  dpx.film.sequence_extent=0;
  offset+=WriteBlobLong(image,dpx.film.sequence_extent);
  dpx.film.held_count=0;
  offset+=WriteBlobLong(image,dpx.film.held_count);
  dpx.film.frame_rate=image->animation_delay;
  offset+=WriteBlobFloat(image,dpx.film.frame_rate);
  dpx.film.shutter_angle=0.0F;
  offset+=WriteBlobFloat(image,dpx.film.shutter_angle);
  offset+=WriteBlob(image,sizeof(dpx.film.frame_id),(unsigned char *) dpx.film.frame_id);
  offset+=WriteBlob(image,sizeof(dpx.film.slate),(unsigned char *) dpx.film.slate);
  offset+=WriteBlob(image,sizeof(dpx.film.reserve),(unsigned char *) dpx.film.reserve);
  /*
    Write television header.
  */
  dpx.television.time_code=0;
  value=GetDPXProperty(image,"dpx:television.time.code",exception);
  if (value != (const char *) NULL)
    dpx.television.time_code=StringToTimeCode(value);
  offset+=WriteBlobLong(image,dpx.television.time_code);
  dpx.television.user_bits=0;
  value=GetDPXProperty(image,"dpx:television.user.bits",exception);
  if (value != (const char *) NULL)
    dpx.television.user_bits=StringToTimeCode(value);
  offset+=WriteBlobLong(image,dpx.television.user_bits);
  dpx.television.interlace=0;
  value=GetDPXProperty(image,"dpx:television.interlace",exception);
  if (value != (const char *) NULL)
    dpx.television.interlace=(unsigned char) atoi(value);
  offset+=WriteBlobByte(image,dpx.television.interlace);
  dpx.television.field_number=0;
  value=GetDPXProperty(image,"dpx:television.field_number",exception);
  if (value != (const char *) NULL)
    dpx.television.field_number=(unsigned char) atoi(value);
  offset+=WriteBlobByte(image,dpx.television.field_number);
  dpx.television.video_signal=0;
  value=GetDPXProperty(image,"dpx:television.video_signal",exception);
  if (value != (const char *) NULL)
    dpx.television.video_signal=(unsigned char) atoi(value);
  offset+=WriteBlobByte(image,dpx.television.video_signal);
  dpx.television.padding=0;
  value=GetDPXProperty(image,"dpx:television.padding",exception);
  if (value != (const char *) NULL)
    dpx.television.padding=(unsigned char) atoi(value);
  offset+=WriteBlobByte(image,dpx.television.padding);
  dpx.television.horizontal_sample_rate=0.0F;
  value=GetDPXProperty(image,"dpx:television.horizontal_sample_rate",exception);
  if (value != (const char *) NULL)
    dpx.television.horizontal_sample_rate=(float) atof(value);
  offset+=WriteBlobFloat(image,dpx.television.horizontal_sample_rate);
  dpx.television.vertical_sample_rate=0.0F;
  value=GetDPXProperty(image,"dpx:television.vertical_sample_rate",exception);
  if (value != (const char *) NULL)
    dpx.television.vertical_sample_rate=(float) atof(value);
  offset+=WriteBlobFloat(image,dpx.television.vertical_sample_rate);
  dpx.television.frame_rate=0.0F;
  value=GetDPXProperty(image,"dpx:television.frame_rate",exception);
  if (value != (const char *) NULL)
    dpx.television.frame_rate=(float) atof(value);
  offset+=WriteBlobFloat(image,dpx.television.frame_rate);
  dpx.television.time_offset=0.0F;
  value=GetDPXProperty(image,"dpx:television.time_offset",exception);
  if (value != (const char *) NULL)
    dpx.television.time_offset=(float) atof(value);
  offset+=WriteBlobFloat(image,dpx.television.time_offset);
  dpx.television.gamma=0.0F;
  value=GetDPXProperty(image,"dpx:television.gamma",exception);
  if (value != (const char *) NULL)
    dpx.television.gamma=(float) atof(value);
  offset+=WriteBlobFloat(image,dpx.television.gamma);
  dpx.television.black_level=0.0F;
  value=GetDPXProperty(image,"dpx:television.black_level",exception);
  if (value != (const char *) NULL)
    dpx.television.black_level=(float) atof(value);
  offset+=WriteBlobFloat(image,dpx.television.black_level);
  dpx.television.black_gain=0.0F;
  value=GetDPXProperty(image,"dpx:television.black_gain",exception);
  if (value != (const char *) NULL)
    dpx.television.black_gain=(float) atof(value);
  offset+=WriteBlobFloat(image,dpx.television.black_gain);
  dpx.television.break_point=0.0F;
  value=GetDPXProperty(image,"dpx:television