case 0x07: /* Open Connection Request 2 */
  case 0x08: /* Open Connection Reply 2 */
    {
      u_int16_t packet_len = ntohs(get_u_int16_t(packet->payload, 0));
      if (packet_len != packet->payload_packet_len)
      {
        NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
        return;
      }

      u_int8_t protocol_version = packet->payload[2];
      if (protocol_version > 10 /* maximum supported protocol version */)
      {
        NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
        return;
      }

      u_int16_t mtu_size = ntohs(get_u_int16_t(packet->payload, 4));
      if (mtu_size > 1500 /* Max. supported MTU, see: http://www.jenkinssoftware.com/raknet/manual/programmingtips.html */)
      {
        NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
        return;
      }

      ip_addr_offset = 6 + raknet_dissect_ip(packet, 6);
      if (ip_addr_offset != packet->payload_packet_len)
      {
        NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
        return;
      }
    }
    break;