case 0x07: /* Open Connection Request 2 */
case 0x08: /* Open Connection Reply 2 */
  ip_addr_offset = 4;
  if (op == 0x07)
    ip_addr_offset += 18;
  else
    ip_addr_offset += 28;

  if (packet->payload_packet_len < ip_addr_offset + 4)
  {
    NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
    return;
  }

  u_int16_t mtu_size = ntohs(get_u_int16_t(packet->payload, ip_addr_offset));
  if (mtu_size > 1500 /* Max. supported MTU, see: http://www.jenkinssoftware.com/raknet/manual/programmingtips.html */)
  {
    NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
    return;
  }

  required_packets = 4;
  break;