case 0x07: /* Open Connection Request 2 */
    case 0x08: /* Open Connection Reply 2 */
      if (packet->payload_packet_len < 34) {
        NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
        return;
      }

      ip_addr_offset = 4 + raknet_dissect_ip(packet, 0);
      ip_addr_offset += 2; // System Index

      if (op == 0x08) {
        ip_addr_offset += 2; // MTU Size
      }

      for (size_t i = 0; i < 10; ++i) {
        ip_addr_offset += 3 + raknet_dissect_ip(packet, ip_addr_offset);
      }

      if (ip_addr_offset + 2 > packet->payload_packet_len) {
        NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
        return;
      }

      u_int16_t mtu_size = ntohs(get_u_int16_t(packet->payload, ip_addr_offset));
      if (mtu_size > 1500) {
        NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
        return;
      }

      required_packets = 4;
      break;