case 0x07: /* Open Connection Request 2 */
      if (packet->payload_packet_len < 22 || packet->payload[1] != 0 ||
          packet->payload[21] > 10 /* maximum supported protocol version */)
      {
        NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
        return;
      }
      required_packets = 4;
      break;

    case 0x08: /* Open Connection Reply 2 */
      ip_addr_offset = 16;
      if (packet->payload_packet_len < ip_addr_offset + 10 ||
          packet->payload[ip_addr_offset + 8] > 0x01 /* connection uses encryption: bool -> 0x00 or 0x01 */)
      {
        NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
        return;
      }

      {
        u_int16_t max_mtu_size = ntohs(get_u_int16_t(packet->payload, ip_addr_offset + 9));
        if (max_mtu_size > 1500 /* Max. supported MTU, see: http://www.jenkinssoftware.com/raknet/manual/programmingtips.html */)
        {
          NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
          return;
        }
      }
      required_packets = 4;
      break;