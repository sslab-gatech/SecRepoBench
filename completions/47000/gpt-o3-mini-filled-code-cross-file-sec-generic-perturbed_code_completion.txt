case 0x07: /* Open Connection Request 2 */
    case 0x08: /* Open Connection Reply 2 */
      {
        /* Minimum length: 1 byte op code + 8 bytes GUID + at least 1 byte for IP address +
           2 bytes for port + 2 bytes for MTU = 14 bytes */
        if (packet->payload_packet_len < 14) {
          NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
          return;
        }

        /* Assume that the IP address field starts immediately after the 8-byte GUID.
           The GUID occupies bytes 1..8, so the IP address starts at offset 9. */
        ip_addr_offset = 9;
        u_int8_t ip_len = raknet_dissect_ip(packet, ip_addr_offset);
        if (ip_len == 0 || ip_addr_offset + ip_len + 4 != packet->payload_packet_len) {
          NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
          return;
        }
        ip_addr_offset += ip_len;

        /* After the IP address, there should be 4 bytes:
           2 bytes for port and 2 bytes for the maximum MTU size.
           The MTU is located at offset (ip_addr_offset + 2). */
        u_int16_t mtu_size = ntohs(get_u_int16_t(packet->payload, ip_addr_offset + 2));
        if (mtu_size > 1500) {
          NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
          return;
        }

        required_packets = 4;
      }
      break;