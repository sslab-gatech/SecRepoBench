case 0x07: /* Open Connection Request 2 */
      if (packet->payload_packet_len < 20)
      {
        NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
        return;
      }
      required_packets = 6;
      break;

    case 0x08: /* Open Connection Reply 2 */
      ip_addr_offset = 1;
      if (packet->payload_packet_len < (ip_addr_offset + 6))
      {
        NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
        return;
      }

      ip_addr_offset += raknet_dissect_ip(packet, ip_addr_offset);

      if (packet->payload_packet_len < (ip_addr_offset + 2))
      {
        NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
        return;
      }

      {
        u_int16_t client_mtu = ntohs(get_u_int16_t(packet->payload, ip_addr_offset));

        if (client_mtu > 1500)
        {
          NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
          return;
        }
      }
      required_packets = 4;
      break;