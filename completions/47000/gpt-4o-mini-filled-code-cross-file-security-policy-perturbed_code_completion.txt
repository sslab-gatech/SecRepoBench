case 0x07: /* Open Connection Request 2 */
    case 0x08: /* Open Connection Reply 2 */
      if (packet->payload_packet_len < 18)
      {
        NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
        return;
      }
      ip_addr_offset = 4 + raknet_dissect_ip(packet, 0);
      if (ip_addr_offset + 2 > packet->payload_packet_len) // Validate IP address offset
      {
        NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
        return;
      }
      if (packet->payload[ip_addr_offset + 1] > 10) // Check protocol version
      {
        NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
        return;
      }
      {
        u_int16_t max_mtu_size = ntohs(get_u_int16_t(packet->payload, 16));
        if (max_mtu_size > 1500) // Validate MTU size
        {
          NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
          return;
        }
      }
      required_packets = 4;
      break;