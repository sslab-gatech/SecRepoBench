case 0x07: /* Open Connection Request 2 */
  if (packet->payload_packet_len < 35)
  {
    NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
    return;
  }
  
  ip_addr_offset = 25;
  size_t ip_size = raknet_dissect_ip(packet, ip_addr_offset);
  if (ip_size == 0 || ip_addr_offset + ip_size + 6 != packet->payload_packet_len)
  {
    NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
    return;
  }

  {
    u_int16_t mtu_size = ntohs(get_u_int16_t(packet->payload, ip_addr_offset + ip_size + 2));
    if (mtu_size > 1500 /* Max. supported MTU */)
    {
      NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
      return;
    }
  }
  required_packets = 4;
  break;

case 0x08: /* Open Connection Reply 2 */
  if (packet->payload_packet_len < 30)
  {
    NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
    return;
  }
  
  ip_addr_offset = 20;
  size_t ip_size = raknet_dissect_ip(packet, ip_addr_offset);
  if (ip_size == 0 || ip_addr_offset + ip_size + 7 != packet->payload_packet_len)
  {
    NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
    return;
  }

  {
    u_int16_t mtu_size = ntohs(get_u_int16_t(packet->payload, ip_addr_offset + ip_size + 2));
    if (mtu_size > 1500 /* Max. supported MTU */)
    {
      NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
      return;
    }
  }
  required_packets = 4;
  break;