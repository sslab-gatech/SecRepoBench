mx = motion_x;
    my = motion_y;
    sx = mx & s_mask;
    sy = my & s_mask;
    sourcex = s->mb_x * block_s + (mx >> (lowres + 1));
    src_y   = mb_y * block_s + (my >> (lowres + 1));

    ptr_y = ref_picture[0] + src_y * s->linesize + sourcex;
    if ((unsigned)sourcex > (unsigned)(h_edge_pos - block_s) ||
        (unsigned)src_y   > (unsigned)(v_edge_pos - h)) {
        s->vdsp.emulated_edge_mc(s->sc.edge_emu_buffer, ptr_y,
                                 s->linesize, s->linesize,
                                 block_s, h,
                                 sourcex, src_y,
                                 h_edge_pos, v_edge_pos);
        ptr_y = s->sc.edge_emu_buffer;
    }
    if (sx || sy) {
        s->vdsp.put_pixels_tab[op_index](dest_y, ptr_y,
                                           s->linesize, block_s, sx, sy);
    } else {
        for (int i = 0; i < h; i++)
            memcpy(dest_y + i * s->linesize, ptr_y + i * s->linesize, block_s);
    }

    if (!CONFIG_GRAY || !(s->avctx->flags & AV_CODEC_FLAG_GRAY))
        chroma_4mv_motion_lowres(s, dest_cb, dest_cr, ref_picture, pix_op, mx, my);