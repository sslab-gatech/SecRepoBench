bitint *x1 = (bitint*)x;
  bitint *y1 = (bitint*)y;
  bitint m1 = m / sizeof(bitint);
  bitint n1 = n / sizeof(bitint);
  bitint i;

  if (m1 == 0) return -1;
  if (n1 == 0) return -1;

  for (i = 0; i < n1 - m1 + 1; i++) {
    bitint a = *y1++;
    bitint b = *x1;
    bitint c = a ^ b;
    if ((c & MASK3) == 0) {
      if ((c & MASK2) == 0) {
        if ((c & MASK1) == 0) {
          if (c == 0) {
            if (m % sizeof(bitint) == 0) return i * sizeof(bitint);
            const unsigned char *xp = x + i * sizeof(bitint);
            const unsigned char *yp = y + i * sizeof(bitint);
            if (memcmp(xp, yp, m % sizeof(bitint)) == 0) return i * sizeof(bitint);
          }
          else if ((c & MASK4) == 0) {
            if (m % sizeof(bitint) == 0) return i * sizeof(bitint);
            const unsigned char *xp = x + i * sizeof(bitint);
            const unsigned char *yp = y + i * sizeof(bitint);
            if (memcmp(xp, yp, m % sizeof(bitint)) == 0) return i * sizeof(bitint);
          }
        }
      }
    }
  }