if (m < 1 || lengthy < 1) return -1;

  const bitint mask = (bitint)x[0] * MASK1;
  const bitint bmask = NOASCII(x[0]) ? MASK3 : 0;

  for (long j = 0; j <= lengthy - m; ++j) {
    if ((*((bitint*)(ys + j)) ^ mask) & MASK2 & ~bmask) {
      continue;
    }
    if (memcmp(xs, ys + j, m) == 0) {
      return (mrb_int)j;
    }
  }