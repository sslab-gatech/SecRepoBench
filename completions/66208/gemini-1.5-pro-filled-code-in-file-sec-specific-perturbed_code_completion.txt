bitint mask;
  bitint j, k;

  if (m == 0) return 0;
  if (lengthy < m) return -1;

  /* Initialize the mask. */
  mask = (bitint)MASK4;
  for (k = 1; k < m; ++k) {
    mask |= (bitint)MASK4 >> k;
  }

  /* Search */
  j = 0;
  while (j <= lengthy - m) {
    bitint diff = ((bitint*)ys)[j] ^ ((bitint*)xs)[0];
    if (!(diff & mask)) {
      if (memcmp(xs + sizeof(bitint), ys + (j + 1) * sizeof(bitint), m - sizeof(bitint)) == 0) {
        return j * sizeof(bitint);
      }
    }
    ++j;
  }