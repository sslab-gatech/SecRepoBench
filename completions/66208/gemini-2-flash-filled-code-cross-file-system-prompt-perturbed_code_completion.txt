if (m <= 0 || lengthy <= 0 || m > lengthy) return -1;
  if (m == 1) {
    const unsigned char c = xs[0];
    const unsigned char *p = ys;
    long i;

    for (i = 0; i < lengthy; i++) {
      if (*p++ == c) return i;
    }
    return -1;
  }
  else if (m <= sizeof(bitint)) {
    bitint x, y;
    long i;

    memcpy(&x, xs, m);
    x *= MASK1;

    for (i = 0; i <= lengthy - m; i++) {
      memcpy(&y, ys + i, m);
      y *= MASK1;
      if (x == y) return i;
    }
  }
  else {
    long i;

    for (i = 0; i <= lengthy - m; i++) {
      if (memcmp(xs, ys + i, m) == 0) return i;
    }
  }