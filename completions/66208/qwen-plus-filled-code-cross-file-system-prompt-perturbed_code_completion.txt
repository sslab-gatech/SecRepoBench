if (m <= 0 || lengthy < m) {
    return -1;
  }

  bitint MASK = MASK4;
  long n = lengthy - m + 1;
  long j;

  for (j = 0; j < n; ++j) {
    bitint s = 0;
    long k;

    for (k = 0; k < m; ++k) {
      bitint x = xs[k];
      bitint y = ys[j + k];
      bitint diff = (bitint)((x ^ y) & MASK3);
      s |= ((diff - MASK1) & ~diff) & MASK2;
      if (s == MASK) break;
    }
    if (s != MASK) {
      return j;
    }
  }

  return -1;