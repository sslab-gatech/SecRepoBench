if (m == 0) return 0;
  if (m > lengthy) return -1;
  if (m > sizeof(bitint) * 8) return -1;

  bitint table[256];
  memset(table, 0xFF, sizeof(table));
  for (long j = 0; j < m; j++) {
    unsigned char c = xs[j];
    table[c] &= ~((bitint)1 << j);
  }

  bitint s = (bitint)-1;
  const bitint mask = (bitint)1 << (m - 1);

  for (long i = 0; i < lengthy; i++) {
    s = (s << 1) | table[ys[i]];
    if ((s & mask) == 0) {
      return i - m + 1;
    }
  }