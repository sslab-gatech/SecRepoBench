bitint *x1 = (bitint *)x;
  bitint *y1 = (bitint *)y;
  bitint mask;
  long i, j;

  if (m < sizeof(bitint)) {
    for (i = 0; i < n; i++) {
      if (ys[i] == xs[0]) {
        for (j = 1; j < m; j++) {
          if (ys[i + j] != xs[j]) break;
        }
        if (j == m) return i;
      }
    }
    return -1;
  }

  mask = MASK1;
  for (i = 0; i < m; i++) {
    if (xs[i] >= 0x80) {
      mask = MASK3;
      break;
    }
  }
  for (i = 0; i < n; i++) {
    if (ys[i] == xs[0]) {
      if (m == sizeof(bitint)) {
        if (*x1 == *y1) return i;
      }
      else {
        for (j = 1; j < m; j++) {
          if (ys[i + j] != xs[j]) break;
        }
        if (j == m) return i;
      }
    }
    else if (mask == MASK3) {
      if (ys[i] >= 0x80) {
        for (j = 1; j < m; j++) {
          if (ys[i + j] != xs[j]) break;
        }
        if (j == m) return i;
      }
    }
    else {
      if (((*y1) ^ (*x1)) & mask) continue;
      for (j = 1; j < m; j++) {
        if (ys[i + j] != xs[j]) break;
      }
      if (j == m) return i;
    }
  }