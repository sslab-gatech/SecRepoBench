bitint x = 0, y = 0;
  long i;

  for (i = 0; i < m; ++i) {
    x = (x << 8) | xs[i];
  }

  for (i = 0; i < lengthy; ++i) {
    y = (y << 8) | ys[i];
  }

  bitint mask = (bitint)MASK1 << (m - 1) * 8;
  bitint result = 0;

  for (i = 0; i <= lengthy - m; ++i) {
    if ((y & mask) == (x & mask)) {
      result = i;
      break;
    }
    y = (y << 8) | ys[i + m];
    y &= ~((bitint)MASK3 << 8);
  }

  return result;
}