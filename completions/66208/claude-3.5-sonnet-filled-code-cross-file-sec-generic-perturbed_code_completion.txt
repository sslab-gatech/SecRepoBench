bitint *p1 = (bitint*)xs;
  bitint *p2 = (bitint*)ys;
  bitint x = *p1;
  bitint v;
  long n = lengthy - m + 1;
  long i = 0;

  while (i < n) {
    v = *p2 ^ x;
    if ((v - MASK1) & ~v & MASK3) {
      if (memcmp(xs, ys + i, m) == 0)
        return i;
    }
    i++;
    p2 = (bitint*)(ys + i);
  }