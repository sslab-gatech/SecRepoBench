bitint *x = (bitint *)xs;
  bitint *y = (bitint *)ys;
  bitint *end = y + lengthy / sizeof(bitint);

  bitint h = 0;
  for (; x < xs + m / sizeof(bitint); x++) {
    h = (h * MASK1) ^ *x;
  }

  for (; y < end; y++) {
    if (h == (*y * MASK1)) {
      if (mrb_memcmp(xs, y, m) == 0) {
        return y - ys;
      }
    }
    if (y + 1 < end) {
      h = (h * MASK1) ^ (*(y + 1) ^ *y);
    }
  }

  return -1;