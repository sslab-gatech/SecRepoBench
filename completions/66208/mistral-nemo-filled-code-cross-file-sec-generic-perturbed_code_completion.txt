bitint h = 0, g;
int i, j;
for (i = 0; i < m; i++) h = (h << 8) | xs[i];
for (g = 1, i = 0; i < 8 * sizeof(bitint) - 1; i++) g = (g << 8) | 255;
for (i = 0; i < lengthy - m; i++) {
  if ((h & MASK1) == (ys[i] & MASK1) && (h & MASK2) == (ys[i] & MASK2)) {
    for (j = 0; j < m; j++) {
      if ((ys[i + j] & MASK3) != (xs[j] & MASK3)) break;
      if (j == m - 1) return i;
    }
  }
  h = ((h << 8) | ys[i + m]) & MASK4;
}
return -1;