if (m == 0) return 0;
if (m > lengthy) return -1;

bitint pattern_mask[256];
for (int i = 0; i < 256; i++) {
  pattern_mask[i] = 0;
}
for (long i = 0; i < m; i++) {
  pattern_mask[xs[i]] |= ((bitint)1 << i);
}

bitint state = 0;
bitint match_bit = (bitint)1 << (m - 1);
for (long j = 0; j < lengthy; j++) {
  state = ((state << 1) | 1) & pattern_mask[ys[j]];
  if (state & match_bit)
    return j - m + 1;
}