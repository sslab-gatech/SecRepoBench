if (m <= 0 || lengthy <= 0 || m > lengthy) return -1;
  if (m == 1) {
    const unsigned char *ye = ys + lengthy;
    while (ys < ye) {
      if (*xs == *ys) return ys - (const unsigned char*)ys;
      ys++;
    }
    return -1;
  }
  if (m <= sizeof(bitint)) {
    bitint x = 0;
    for (long i = 0; i < m; i++) {
#if defined(MRB_ENDIAN_BIG)
      x = (x << 8) | xs[i];
#else
      x |= (bitint)xs[i] << (i * 8);
#endif
    }
    for (long i = 0; i <= lengthy - m; i++) {
      bitint y = 0;
      for (long j = 0; j < m; j++) {
#if defined(MRB_ENDIAN_BIG)
        y = (y << 8) | ys[i+j];
#else
        y |= (bitint)ys[i+j] << (j * 8);
#endif
      }
      if (x == y) return i;
    }
  }
  else {
    for (long i = 0; i <= lengthy - m; i++) {
      if (memcmp(xs, ys + i, m) == 0) return i;
    }
  }