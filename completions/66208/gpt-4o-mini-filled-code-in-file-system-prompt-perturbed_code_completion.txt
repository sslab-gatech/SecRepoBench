const bitint *p, *pend;
  bitint *s;
  bitint bitmask;
  mrb_int i, j;

  if (m < 1 || lengthy < m) return -1;

  p = (const bitint *)xs;
  pend = (const bitint *)(ys + lengthy);
  s = (bitint *)ys;

  for (i = 0; i < m; i++) {
    bitmask = (bitint)(1ULL << (i % (sizeof(bitint) * 8)));
    for (j = 0; j < lengthy; j++) {
      if ((s[j / (sizeof(bitint) * 8)] & bitmask) == 0) {
        if (memcmp(xs + i, ys + j, m) == 0) {
          return j;
        }
      }
    }
  }