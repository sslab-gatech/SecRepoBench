bitint i, j;
  unsigned char first_byte;
  
  if (m <= 0) return 0;
  if (lengthy < m) return -1;
  
  // For single byte search, optimize the loop
  if (m == 1) {
    first_byte = xs[0];
    for (i = 0; i < lengthy; i++) {
      if (ys[i] == first_byte) return i;
    }
    return -1;
  }
  
  // For multi-byte search, check first byte quickly then match the rest
  first_byte = xs[0];
  for (i = 0; i <= lengthy - m; i++) {
    if (ys[i] == first_byte) {
      // First byte matches, check the rest
      for (j = 1; j < m; j++) {
        if (ys[i+j] != xs[j]) break;
      }
      
      if (j == m) return i; // Found a match
    }
  }