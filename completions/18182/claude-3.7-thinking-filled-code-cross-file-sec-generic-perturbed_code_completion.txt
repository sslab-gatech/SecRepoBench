(void) ReadProfile(img,"xmp",profile,(ssize_t) length,exception);
if (length > 30)  /* Minimum length to contain the string we're looking for */
{
  char *xmp_profile;
  
  /* Allocate memory for a null-terminated copy of the profile */
  xmp_profile=(char *) AcquireQuantumMemory(length+1,sizeof(*xmp_profile));
  if (xmp_profile != (char *) NULL)
  {
    (void) memcpy(xmp_profile,profile,length);
    xmp_profile[length]='\0';
    
    /* Check if profile contains the DNG format string */
    if (strstr(xmp_profile,"dc:format=\"image/dng\"") != (char *) NULL)
      (void) SetImageProperty(img,"magick:format","DNG",exception);
    
    xmp_profile=(char *) RelinquishMagickMemory(xmp_profile);
  }
}