(void) ReadProfile(img,"xmp",profile,(ssize_t) length,exception);

// Check if the profile contains "dc:format=\"image/dng\""
if (length > 20) // Minimum length for the pattern
  {
    const char *pattern = "dc:format=\"image/dng\"";
    size_t pattern_length = strlen(pattern);
    ssize_t i;

    for (i = 0; i <= (ssize_t) (length - pattern_length); i++)
      {
        if (memcmp(profile + i, pattern, pattern_length) == 0)
          {
            (void) SetImageFormat(img, "DNG");
            break;
          }
      }
  }