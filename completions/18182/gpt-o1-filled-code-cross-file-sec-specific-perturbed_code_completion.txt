{
  char *xmp_buffer;

  /*
    Clone the XMP profile data so we can safely search for our substring
    without risking reading beyond the buffer.
  */
  xmp_buffer=(char *) AcquireMagickMemory((size_t) length+1);
  if (xmp_buffer != (char *) NULL)
  {
    (void) memcpy(xmp_buffer,profile,(size_t) length);
    xmp_buffer[length] = '\0';
    /*
      If the XMP profile contains "dc:format=\"image/dng\"",
      mark this image as DNG.
    */
    if (strstr(xmp_buffer,"dc:format=\"image/dng\"") != (char *) NULL)
      (void) CopyMagickString(img->magick,"DNG",MaxTextExtent);
    xmp_buffer=DestroyString(xmp_buffer);
  }
  (void) ReadProfile(img,"xmp",profile,(ssize_t) length,exception);
}