primary.x=chromaticity[4];
            image->chromaticity.blue_primary.y=chromaticity[5];
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_YCBCRCOEFFICIENTS,&chromaticity) == 1)
      {
        if (chromaticity != (float *) NULL)
          {
            image->chromaticity.y_chroma_weight=chromaticity[0];
            image->chromaticity.cb_chroma_weight=chromaticity[1];
            image->chromaticity.cr_chroma_weight=chromaticity[2];
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_REFERENCEBLACKWHITE,&chromaticity) == 1)
      {
        if (chromaticity != (float *) NULL)
          {
            image->chromaticity.black_point.x=chromaticity[0];
            image->chromaticity.black_point.y=chromaticity[1];
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SOFTWARE,&value) == 1)
      (void) SetImageProperty(image,"tiff:software",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ARTIST,&value) == 1)
      (void) SetImageProperty(image,"tiff:artist",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_COPYRIGHT,&value) == 1)
      (void) SetImageProperty(image,"tiff:copyright",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_DATETIME,&value) == 1)
      (void) SetImageProperty(image,"tiff:timestamp",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_DOCUMENTNAME,&value) == 1)
      (void) SetImageProperty(image,"tiff:document",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_HOSTCOMPUTER,&value) == 1)
      (void) SetImageProperty(image,"tiff:hostcomputer",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_IMAGEDESCRIPTION,&value) == 1)
      (void) SetImageProperty(image,"comment",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_MAKE,&value) == 1)
      (void) SetImageProperty(image,"tiff:make",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_MODEL,&value) == 1)
      (void) SetImageProperty(image,"tiff:model",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_OPIIMAGEID,&value) == 1)
      (void) SetImageProperty(image,"tiff:image-id",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PAGENAME,&value) == 1)
      (void) SetImageProperty(image,"label",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SOFTWARE,&value) == 1)
      (void) SetImageProperty(image,"tiff:software",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,33423,&value) == 1)
      (void) SetImageProperty(image,"tiff:kodak-33423",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,36867,&value) == 1)
      (void) SetImageProperty(image,"tiff:kodak-36867",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBFILETYPE,&value) == 1)
      {
        switch (value)
        {
          case 0x01:
          {
            (void) SetImageProperty(image,"tiff:subfiletype","REDUCEDIMAGE",
              exception);
            break;
          }
          case 0x02:
          {
            (void) SetImageProperty(image,"tiff:subfiletype","PAGE",exception);
            break;
          }
          case 0x04:
          {
            (void) SetImageProperty(image,"tiff:subfiletype","MASK",exception);
            break;
          }
          default:
            break;
        }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBSECTIME,&value) == 1)
      (void) SetImageProperty(image,"exif:SubSecTime",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBSECTIMEORIGINAL,&value) == 1)
      (void) SetImageProperty(image,"exif:SubSecTimeOriginal",(char *) value,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBSECTIMEDIGITIZED,&value) == 1)
      (void) SetImageProperty(image,"exif:SubSecTimeDigitized",(char *) value,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_FLASHPIXVERSION,&value) == 1)
      (void) SetImageProperty(image,"exif:FlashpixVersion",(char *) value,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PIXELXDIMENSION,&value) == 1)
      (void) SetImageProperty(image,"exif:PixelXDimension",(char *) value,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PIXELYDIMENSION,&value) == 1)
      (void) SetImageProperty(image,"exif:PixelYDimension",(char *) value,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_RELATEDSOUNDFILE,&value) == 1)
      (void) SetImageProperty(image,"exif:RelatedSoundFile",(char *) value,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_FLASHENERGY,&value) == 1)
      (void) SetImageProperty(image,"exif:FlashEnergy",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SPATIALFREQUENCYRESPONSE,&value) == 1)
      (void) SetImageProperty(image,"exif:SpatialFrequencyResponse",(char *)
        value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_FOCALPLANEXRESOLUTION,&value) == 1)
      (void) SetImageProperty(image,"exif:FocalPlaneXResolution",(char *) value,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_FOCALPLANEYRESOLUTION,&value) == 1)
      (void) SetImageProperty(image,"exif:FocalPlaneYResolution",(char *) value,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_FOCALPLANERESOLUTIONUNIT,&value) == 1)
      (void) SetImageProperty(image,"exif:FocalPlaneResolutionUnit",(char *)
        value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBJECTLOCATION,&value) == 1)
      (void) SetImageProperty(image,"exif:SubjectLocation",(char *) value,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_EXPOSUREINDEX,&value) == 1)
      (void) SetImageProperty(image,"exif:ExposureIndex",(char *) value,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SENSINGMETHOD,&value) == 1)
      (void) SetImageProperty(image,"exif:SensingMethod",(char *) value,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_FILESOURCE,&value) == 1)
      (void) SetImageProperty(image,"exif:FileSource",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SCENETYPE,&value) == 1)
      (void) SetImageProperty(image,"exif:SceneType",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_CFAPATTERN,&value) == 1)
      (void) SetImageProperty(image,"exif:CFAPattern",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_CUSTOMRENDERED,&value) == 1)
      (void) SetImageProperty(image,"exif:CustomRendered",(char *) value,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_EXPOSUREMODE,&value) == 1)
      (void) SetImageProperty(image,"exif:ExposureMode",(char *) value,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_WHITEBALANCE,&value) == 1)
      (void) SetImageProperty(image,"exif:WhiteBalance",(char *) value,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_DIGITALZOOMRATIO,&value) == 1)
      (void) SetImageProperty(image,"exif:DigitalZoomRatio",(char *) value,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_FOCALLENGTHIN35MMFILM,&value) == 1)
      (void) SetImageProperty(image,"exif:FocalLengthIn35mmFilm",(char *) value,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SCENECAPTURETYPE,&value) == 1)
      (void) SetImageProperty(image,"exif:SceneCaptureType",(char *) value,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_GAINCONTROL,&value) == 1)
      (void) SetImageProperty(image,"exif:GainControl",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_CONTRAST,&value) == 1)
      (void) SetImageProperty(image,"exif:Contrast",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SATURATION,&value) == 1)
      (void) SetImageProperty(image,"exif:Saturation",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SHARPNESS,&value) == 1)
      (void) SetImageProperty(image,"exif:Sharpness",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_DEVICESETTINGDESCRIPTION,&value) == 1)
      (void) SetImageProperty(image,"exif:DeviceSettingDescription",(char *)
        value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBJECTDISTANCERANGE,&value) == 1)
      (void) SetImageProperty(image,"exif:SubjectDistanceRange",(char *) value,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_IMAGEUNIQUEID,&value) == 1)
      (void) SetImageProperty(image,"exif:ImageUniqueID",(char *) value,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_MAKERNOTE,&value) == 1)
      (void) SetImageProperty(image,"exif:MakerNote",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_USERCOMMENT,&value) == 1)
      (void) SetImageProperty(image,"exif:UserComment",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_COLORRESPONSEUNIT,&value) == 1)
      (void) SetImageProperty(image,"exif:ColorSpace",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_IMAGEWIDTH,&width) == 1)
      image->columns=(size_t) width;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_IMAGELENGTH,&height) == 1)
      image->rows=(size_t) height;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_XRESOLUTION,&x_resolution) == 1)
      image->resolution.x=x_resolution;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_YRESOLUTION,&y_resolution) == 1)
      image->resolution.y=y_resolution;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_RESOLUTIONUNIT,&units) == 1)
      {