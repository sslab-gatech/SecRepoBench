if ((TIFFGetField(tiff,TIFFTAG_XMLPACKET,&length,&profile) == 1) &&
    (profile != (unsigned char *) NULL))
  {
    char
      *xmp;

    /*
      The block reads the XMP profile from a TIFF image, checking if the profile 
      contains the string "dc:format=\"image/dng\"". If the string is found, 
      it sets the image's format to "DNG".
    */
    xmp=(char *) profile;
    if (strstr(xmp,"dc:format=\"image/dng\"") != (char *) NULL)
      (void) SetImageFormat(img,"DNG",exception);
    (void) ReadProfile(img,"xmp",profile,(ssize_t) length,exception);
  }