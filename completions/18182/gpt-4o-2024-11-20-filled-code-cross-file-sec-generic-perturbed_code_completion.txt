char
        *xmp_profile;

      ssize_t
        xmp_length;

      /*
        Copy the XMP profile to a null-terminated string for safe string operations.
      */
      xmp_profile=(char *) AcquireQuantumMemory(length+1,sizeof(*xmp_profile));
      if (xmp_profile == (char *) NULL)
        {
          (void) ThrowMagickException(exception,GetMagickModule(),
            ResourceLimitError,"MemoryAllocationFailed","`%s'","TIFFGetProfiles");
          return;
        }
      (void) memcpy(xmp_profile,profile,length);
      xmp_profile[length]='\0';

      /*
        Check if the XMP profile contains the "dc:format=\"image/dng\"" string.
      */
      if (strstr(xmp_profile,"dc:format=\"image/dng\"") != (char *) NULL)
        (void) CopyMagickString(img->magick,"DNG",MagickPathExtent);

      /*
        Read the XMP profile into the image.
      */
      (void) ReadProfile(img,"xmp",profile,(ssize_t) length,exception);

      /*
        Free the allocated memory for the XMP profile.
      */
      xmp_profile=RelinquishMagickMemory(xmp_profile);