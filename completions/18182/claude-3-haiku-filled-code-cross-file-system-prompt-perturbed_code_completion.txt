if ((TIFFGetField(tiff,TIFFTAG_XMLPACKET,&length,&profile) == 1) &&
    (profile != (unsigned char *) NULL))
{
    const char *format = "image/dng";
    const size_t format_len = strlen(format);
    if (strstr((const char*)profile, format) != NULL)
    {
        image->format = ConstantString("DNG");
    }
    (void) ReadProfile(img,"xmp",profile,(ssize_t) length,exception);
}