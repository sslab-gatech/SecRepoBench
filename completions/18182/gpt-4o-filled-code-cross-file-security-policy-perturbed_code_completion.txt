// Create a StringInfo structure to safely handle the profile data
      StringInfo
        *profile_info;

      // Allocate and initialize the StringInfo structure
      profile_info=AcquireStringInfo(length);
      if (profile_info == (StringInfo *) NULL)
        return;

      // Copy the profile data into the StringInfo structure
      SetStringInfoDatum(profile_info,profile);

      // Check if the profile contains the string "dc:format=\"image/dng\""
      if (LocaleNCompare((const char *) GetStringInfoDatum(profile_info),
          "dc:format=\"image/dng\"",length) == 0)
        (void) SetImageFormat(img,"DNG",exception);

      // Clean up the StringInfo structure
      profile_info=DestroyStringInfo(profile_info);