if ((TIFFGetField(tiff,TIFFTAG_XMLPACKET,&length,&profile) == 1) &&
    (profile != (unsigned char *) NULL))
{
  StringInfo *xml_profile;
  
  xml_profile = BlobToStringInfo(profile, length);
  if (xml_profile != (StringInfo *) NULL)
  {
    const char *xmp_data = (const char *)GetStringInfoDatum(xml_profile);
    if (strstr(xmp_data, "dc:format=\"image/dng\"") != NULL)
    {
      (void) SetImageFormat(image, "DNG");
    }
    xml_profile = DestroyStringInfo(xml_profile);
  }
}