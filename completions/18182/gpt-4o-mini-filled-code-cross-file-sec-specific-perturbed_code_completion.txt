if (length > 0 && length < MAX_PROFILE_SIZE) {
        char *xmp_profile = (char *)malloc(length + 1);
        if (xmp_profile != NULL) {
          memcpy(xmp_profile, profile, length);
          xmp_profile[length] = '\0'; // Null-terminate the string
          if (strstr(xmp_profile, "dc:format=\"image/dng\"") != NULL) {
            SetImageProperty(img, "format", "DNG", exception);
          }
          free(xmp_profile);
        }
      }