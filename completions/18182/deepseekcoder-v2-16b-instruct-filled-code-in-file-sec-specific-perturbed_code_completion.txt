image->chromaticity.red_primary.y=chromaticity[1];
            image->chromaticity.green_primary.x=chromaticity[2];
            image->chromaticity.green_primary.y=chromaticity[3];
            image->chromaticity.blue_primary.x=chromaticity[4];
            image->chromaticity.blue_primary.y=chromaticity[5];
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_YCBCRCOEFFICIENTS,&chromaticity) == 1)
      {
        if (chromaticity != (float *) NULL)
          {
            image->chromaticity.y_chroma_weight=chromaticity[0];
            image->chromaticity.cb_chroma_weight=chromaticity[1];
            image->chromaticity.cr_chroma_weight=chromaticity[2];
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_REFERENCEBLACKWHITE,&chromaticity) == 1)
      {
        if (chromaticity != (float *) NULL)
          {
            image->chromaticity.black_point.x=chromaticity[0];
            image->chromaticity.black_point.y=chromaticity[1];
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SOFTWARE,&value) == 1)
      (void) SetImageProperty(image,"tiff:software",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ARTIST,&value) == 1)
      (void) SetImageProperty(image,"tiff:artist",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_COPYRIGHT,&value) == 1)
      (void) SetImageProperty(image,"tiff:copyright",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_DATETIME,&value) == 1)
      (void) SetImageProperty(image,"tiff:timestamp",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_DOCUMENTNAME,&value) == 1)
      (void) SetImageProperty(image,"tiff:document",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_HOSTCOMPUTER,&value) == 1)
      (void) SetImageProperty(image,"tiff:hostcomputer",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_IMAGEDESCRIPTION,&value) == 1)
      (void) SetImageProperty(image,"comment",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_MAKE,&value) == 1)
      (void) SetImageProperty(image,"tiff:make",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_MODEL,&value) == 1)
      (void) SetImageProperty(image,"tiff:model",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_OPIIMAGEID,&value) == 1)
      (void) SetImageProperty(image,"tiff:image-id",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PAGENAME,&value) == 1)
      (void) SetImageProperty(image,"label",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SOFTWARE,&value) == 1)
      (void) SetImageProperty(image,"tiff:software",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,33423,&value) == 1)
      (void) SetImageProperty(image,"tiff:kodak-33423",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,36867,&value) == 1)
      (void) SetImageProperty(image,"tiff:kodak-36867",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBFILETYPE,&value) == 1)
      {
        if (value & FILETYPE_REDUCEDIMAGE)
          (void) SetImageProperty(image,"tiff:subfiletype","REDUCEDIMAGE",
            exception);
        if (value & FILETYPE_PAGE)
          (void) SetImageProperty(image,"tiff:subfiletype","PAGE",exception);
        if (value & FILETYPE_MASK)
          (void) SetImageProperty(image,"tiff:subfiletype","MASK",exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ORIENTATION,&value) == 1)
      (void) SetImageProperty(image,"tiff:orientation",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SAMPLEFORMAT,&sample_format) == 1)
      {
        if (sample_format == SAMPLEFORMAT_UINT)
          (void) SetImageProperty(image,"tiff:sample-format","unsigned integer",
            exception);
        if (sample_format == SAMPLEFORMAT_INT)
          (void) SetImageProperty(image,"tiff:sample-format","signed integer",
            exception);
        if (sample_format == SAMPLEFORMAT_IEEEFP)
          (void) SetImageProperty(image,"tiff:sample-format","floating-point",
            exception);
        if (sample_format == SAMPLEFORMAT_VOID)
          (void) SetImageProperty(image,"tiff:sample-format","undefined",
            exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PREDICTOR,&value) == 1)
      {
        if (value == PREDICTOR_HORIZONTAL)
          (void) SetImageProperty(image,"tiff:predictor","horizontal",
            exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_RESOLUTIONUNIT,&units) == 1)
      {
        if (units == RESUNIT_INCH)
          (void) SetImageProperty(image,"tiff:resolution-unit","inch",
            exception);
        if (units == RESUNIT_CENTIMETER)
          (void) SetImageProperty(image,"tiff:resolution-unit","cm",
            exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_XRESOLUTION,&x_resolution) == 1)
      (void) SetImageProperty(image,"tiff:x-resolution",(char *) x_resolution,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_YRESOLUTION,&y_resolution) == 1)
      (void) SetImageProperty(image,"tiff:y-resolution",(char *) y_resolution,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PAGEXDIMENSION,&value) == 1)
      (void) SetImageProperty(image,"tiff:page-x-dimension",(char *) value,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PAGEYDIMENSION,&value) == 1)
      (void) SetImageProperty(image,"tiff:page-y-dimension",(char *) value,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBIFD,&value) == 1)
      {
        if (value != 0)
          {
            TIFF *subifd;
            subifd=TIFFClientOpen(image->filename,"rb",(thandle_t) image,
              TIFFReadBlob,TIFFWriteBlob,TIFFSeekBlob,TIFFCloseBlob,
              TIFFGetBlobSize,TIFFMapBlob,TIFFUnmapBlob);
            if (subifd != (TIFF *) NULL)
              {
                (void) TIFFReadDirectory(subifd);
                TIFFClose(subifd);
              }
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_MINSAMPLEVALUE,&min_sample_value) == 1)
      (void) SetImageProperty(image,"tiff:min-sample-value",(char *) min_sample_value,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_MAXSAMPLEVALUE,&max_sample_value) == 1)
      (void) SetImageProperty(image,"tiff:max-sample-value",(char *) max_sample_value,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_XPOSITION,&x_position) == 1)
      (void) SetImageProperty(image,"tiff:x-position",(char *) x_position,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_YPOSITION,&y_position) == 1)
      (void) SetImageProperty(image,"tiff:y-position",(char *) y_position,
        exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_COLORMAP,&chromaticity) == 1)
      {
        if (chromaticity != (float *) NULL)
          {
            image->colormap[0][0]=chromaticity[0];
            image->colormap[0][1]=chromaticity[1];
            image->colormap[0][2]=chromaticity[2];
            image->colormap[1][0]=chromaticity[3];
            image->colormap[1][1]=chromaticity[4];
            image->colormap[1][2]=chromaticity[5];
            image->colormap[2][0]=chromaticity[6];
            image->colormap[2][1]=chromaticity[7];
            image->colormap[2][2]=chromaticity[8];
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_EXTRASAMPLES,&extra_samples,&sample_info) == 1)
      {
        if (extra_samples > 0)
          {
            for (i=0; i < (ssize_t) extra_samples; i++)
            {
              if (sample_info[i] == EXTRASAMPLE_ASSOCALPHA)
                {
                  image->alpha_trait=BlendPixelTrait;
                  break;
                }
            }
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SAMPLESPERPIXEL,&samples_per_pixel) == 1)
      {
        if (samples_per_pixel == 1)
          SetImageColorspace(image,GrayColorspace,exception);
        if (samples_per_pixel == 2)
          SetImageColorspace(image,GrayColorspace,exception);
        if (samples_per_pixel == 3)
          SetImageColorspace(image,RGBColorspace,exception);
        if (samples_per_pixel == 4)
          SetImageColorspace(image,CMYKColorspace,exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PLANARCONFIG,&interlace) == 1)
      {
        if (interlace == PLANARCONFIG_SEPARATE)
          image->storage_class=PseudoClass;
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ROWSPERSTRIP,&rows_per_strip) == 1)
      {
        if (rows_per_strip == 0)
          rows_per_strip=height;
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_COMPRESSION,&compress_tag) == 1)
      {
        if (compress_tag == COMPRESSION_ADOBE_DEFLATE)
          (void) SetImageProperty(image,"tiff:compression","deflate",
            exception);
        if (compress_tag == COMPRESSION_LZW)
          (void) SetImageProperty(image,"tiff:compression","lzw",exception);
        if (compress_tag == COMPRESSION_PACKBITS)
          (void) SetImageProperty(image,"tiff:compression","packbits",
            exception);
        if (compress_tag == COMPRESSION_ZSTD)
          (void) SetImageProperty(image,"tiff:compression","zstd",exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PHOTOMETRIC,&photometric) == 1)
      {
        if (photometric == PHOTOMETRIC_YCBCR)
          (void) SetImageProperty(image,"tiff:photometric","YCBCR",exception);
        if (photometric == PHOTOMETRIC_CFA)
          (void) SetImageProperty(image,"tiff:photometric","CFA",exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PREDICTOR,&value) == 1)
      {
        if (value == PREDICTOR_HORIZONTAL)
          (void) SetImage