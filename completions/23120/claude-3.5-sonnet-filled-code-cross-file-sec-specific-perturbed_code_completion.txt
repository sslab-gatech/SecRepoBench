if (attribute->name != NULL) {
    if (dict != NULL)
        xmlDictFree(dict, attribute->name);
    else
        xmlFree((xmlChar *) attribute->name);
}

if (attribute->children != NULL)
    xmlTextReaderFreeNodeList(reader, attribute->children);

if ((__xmlRegisterCallbacks) && (xmlDeregisterNodeDefaultValue))
    xmlDeregisterNodeDefaultValue((xmlNodePtr) attribute);

if (attribute->atype == XML_ATTRIBUTE_ID)
    xmlRemoveID(NULL, attribute);
else if (attribute->atype == XML_ATTRIBUTE_IDREF)
    xmlRemoveRef(NULL, attribute);

attribute->name = NULL;
attribute->children = NULL;
attribute->last = NULL;
attribute->parent = NULL;

if ((reader != NULL) && (reader->ctxt != NULL) &&
    (reader->ctxt->freeAttrsNr < 100)) {
    attribute->next = reader->ctxt->freeAttrs;
    reader->ctxt->freeAttrs = attribute;
    reader->ctxt->freeAttrsNr++;
} else {
    xmlFree(attribute);
}