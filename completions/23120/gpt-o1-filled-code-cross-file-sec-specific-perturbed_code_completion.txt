/* Deregister the node if callbacks are enabled */
    if ((__xmlRegisterCallbacks) && (xmlDeregisterNodeDefaultValue != NULL)) {
        xmlDeregisterNodeDefaultValue((xmlNodePtr) attribute);
    }

    /* If the attribute is an ID or a reference, remove it from the document tables */
    if (attribute->parent && attribute->parent->doc) {
        xmlDocPtr doc = attribute->parent->doc;
        if (attribute->atype == XML_ATTRIBUTE_ID && doc->ids) {
            xmlRemoveID(doc, attribute);
        } else if (attribute->atype == XML_ATTRIBUTE_IDREF && doc->refs) {
            xmlRemoveRef(doc, attribute);
        }
    }

    /* Recursively free any child nodes */
    if (attribute->children != NULL) {
        xmlTextReaderFreeNodeList(reader, attribute->children);
        attribute->children = NULL;
    }

    /* Free the attribute name if it is not in the shared dictionary */
    if (attribute->name != NULL) {
        if (dict == NULL || !xmlDictOwns(dict, attribute->name)) {
            xmlFree((char *)attribute->name);
        }
        attribute->name = NULL;
    }