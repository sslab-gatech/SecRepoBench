if ((__xmlRegisterCallbacks) && (xmlDeregisterNodeDefaultValue))
    xmlDeregisterNodeDefaultValue((xmlNodePtr) attribute);

if (attribute->children!= NULL)
    xmlTextReaderFreeNodeList(reader, attribute->children);

if (attribute->type == XML_IDREF_NODE) {
    xmlNodePtr prev = NULL;
    xmlNodePtr ref = attribute->doc->ids;
    while (ref!= NULL) {
        if (ref->type == XML_IDREF_NODE) {
            if (ref->children == attribute)
                break;
        }
        prev = ref;
        ref = ref->next;
    }
    if (ref!= NULL) {
        if (prev == NULL)
            attribute->doc->ids = ref->next;
        else
            prev->next = ref->next;
    }
}

if (attribute->type == XML_ID_NODE) {
    xmlNodePtr prev = NULL;
    xmlNodePtr ref = attribute->doc->refs;
    while (ref!= NULL) {
        if (ref->type == XML_IDREF_NODE) {
            if (ref->children == attribute)
                break;
        }
        prev = ref;
        ref = ref->next;
    }
    if (ref!= NULL) {
        if (prev == NULL)
            attribute->doc->refs = ref->next;
        else
            prev->next = ref->next;
    }
}

if (dict) {
    if ((attribute->name!= NULL) && (!xmlDictOwns(dict, attribute->name)))
        xmlFree((xmlChar *) attribute->name);
    if ((attribute->children!= NULL) && (attribute->children->content!= NULL) &&
        (!xmlDictOwns(dict, attribute->children->content)))
        xmlFree((xmlChar *) attribute->children->content);
} else {
    if (attribute->name!= NULL)
        xmlFree((xmlChar *) attribute->name);
    if ((attribute->children!= NULL) && (attribute->children->content!= NULL))
        xmlFree((xmlChar *) attribute->children->content);
}