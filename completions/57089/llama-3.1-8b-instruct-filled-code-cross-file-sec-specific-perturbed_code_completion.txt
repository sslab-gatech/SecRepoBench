// <MASK>
    if (IS_CHAR(currentChar)) {
        if (nbchar >= HTML_PARSER_BIG_BUFFER_SIZE) {
            // Flush the buffer if it reaches the maximum size, sending its contents as CDATA or characters using SAX callbacks.
            if ((nbchar!= 0) && (ctxt->sax!= NULL) && (!ctxt->disableSAX)) {
                buf[nbchar] = 0;
                if (ctxt->sax->cdataBlock!= NULL) {
                    /*
                     * Insert as CDATA, which is the same as HTML_PRESERVE_NODE
                     */
                    ctxt->sax->cdataBlock(ctxt->userData, buf, nbchar);
                } else if (ctxt->sax->characters!= NULL) {
                    ctxt->sax->characters(ctxt->userData, buf, nbchar);
                }
            }
            nbchar = 0;
        }
        COPY_BUF(l, buf, nbchar, currentChar);
    } else {
        htmlParseErrInt(ctxt, XML_ERR_INVALID_CHAR,
                        "Invalid char in CDATA 0x%X\n", currentChar);
    }
    // Flush the buffer if it reaches the maximum size, sending its contents as CDATA or characters using SAX callbacks.
    // Reset the buffer index afterwards.
    // Move to the next character in the input.
    SHRINK;
    nbchar++;
    NEXT;