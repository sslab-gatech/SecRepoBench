if (yr_le32toh(codeview_header->signature) == CVINFO_PDB70_CVSIGNATURE)
    {
      PCV_INFO_PDB70 pdb70 = (PCV_INFO_PDB70) codeview_header;

      if (fits_in_pe(pe, pdb70, CV_INFO_PDB70) &&
          fits_in_pe(pe, pdb70->pdb_file_name, 1))
      {
        pdb_path_len = strnlen((char*) pdb70->pdb_file_name, pe->data_size - pcv_hdr_offset - sizeof(CV_INFO_PDB70));

        if (pdb_path_len > 0 && pdb_path_len < pe->data_size - pcv_hdr_offset - sizeof(CV_INFO_PDB70))
        {
          pdb_path = (char*) yr_malloc(pdb_path_len + 1);

          if (pdb_path != NULL)
          {
            memcpy(pdb_path, pdb70->pdb_file_name, pdb_path_len);
            pdb_path[pdb_path_len] = '\0';

            set_string(pdb_path, pe->object, "pdb_path");
            yr_free(pdb_path);
            break;
          }
        }
      }
    }
    else if (yr_le32toh(codeview_header->signature) == CVINFO_PDB20_CVSIGNATURE)
    {
      PCV_INFO_PDB20 pdb20 = (PCV_INFO_PDB20) codeview_header;

      if (fits_in_pe(pe, pdb20, CV_INFO_PDB20) &&
          fits_in_pe(pe, pdb20->pdb_file_name, 1))
      {
        pdb_path_len = strnlen((char*) pdb20->pdb_file_name, pe->data_size - pcv_hdr_offset - sizeof(CV_INFO_PDB20));

        if (pdb_path_len > 0 && pdb_path_len < pe->data_size - pcv_hdr_offset - sizeof(CV_INFO_PDB20))
        {
          pdb_path = (char*) yr_malloc(pdb_path_len + 1);

          if (pdb_path != NULL)
          {
            memcpy(pdb_path, pdb20->pdb_file_name, pdb_path_len);
            pdb_path[pdb_path_len] = '\0';

            set_string(pdb_path, pe->object, "pdb_path");
            yr_free(pdb_path);
            break;
          }
        }
      }
    }