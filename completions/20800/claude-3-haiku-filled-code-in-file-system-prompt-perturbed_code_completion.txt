// <MASK>
// Determine the type of CodeView debug information by checking the signature.
// Depending on the signature, cast the header to the appropriate PDB structure.
// Extract the PDB file name from the structure if it fits within the PE bounds.
// Compute the length of the PDB path and ensure it's within valid limits.
// If a valid PDB path is found, store the path in the object associated with the PE.
// Stop further processing after successfully storing a valid PDB path.

if (yr_le32toh(codeview_header->Signature) == 'SDSR')
{
    PDB2_HEADER* pdb2_header = (PDB2_HEADER*) codeview_header;
    if (struct_fits_in_pe(pe, pdb2_header, PDB2_HEADER))
    {
        pdb_path_len = yr_min(
            available_space(pe, pdb2_header->PdbFileName),
            sizeof(pdb2_header->PdbFileName));
        pdb_path = (char*) yr_malloc(pdb_path_len + 1);
        if (pdb_path != NULL)
        {
            strlcpy(pdb_path, pdb2_header->PdbFileName, pdb_path_len + 1);
            set_string(pdb_path, pe->object, "pdb_path");
            yr_free(pdb_path);
            return;
        }
    }
}
else if (yr_le32toh(codeview_header->Signature) == 'SDSR')
{
    PDB7_HEADER* pdb7_header = (PDB7_HEADER*) codeview_header;
    if (struct_fits_in_pe(pe, pdb7_header, PDB7_HEADER))
    {
        pdb_path_len = yr_min(
            available_space(pe, pdb7_header->PdbFileName),
            sizeof(pdb7_header->PdbFileName));
        pdb_path = (char*) yr_malloc(pdb_path_len + 1);
        if (pdb_path != NULL)
        {
            strlcpy(pdb_path, pdb7_header->PdbFileName, pdb_path_len + 1);
            set_string(pdb_path, pe->object, "pdb_path");
            yr_free(pdb_path);
            return;
        }
    }
}