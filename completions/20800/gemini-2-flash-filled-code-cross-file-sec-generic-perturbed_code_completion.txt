switch (yr_le32toh(codeview_header->Signature))
    {
      case CODEVIEW_SIGNATURE_PDB20:
      {
        PCV_HEADER_PDB20 pdb20_header = (PCV_HEADER_PDB20) codeview_header;

        if (!struct_fits_in_pe(pe, pdb20_header, CV_HEADER_PDB20))
          continue;

        pdb_path = pdb20_header->PdbFileName;
        pdb_path_len = sizeof(pdb20_header->PdbFileName);
        break;
      }
      case CODEVIEW_SIGNATURE_PDB70:
      {
        PCV_HEADER_PDB70 pdb70_header = (PCV_HEADER_PDB70) codeview_header;

        if (!struct_fits_in_pe(pe, pdb70_header, CV_HEADER_PDB70))
          continue;

        // The PDB path is located immediately after the GUID and Age fields.
        pdb_path = (char*) &pdb70_header->Signature + sizeof(GUID) + sizeof(uint32_t);
        pdb_path_len = pe->data_size - (pcv_hdr_offset + sizeof(CV_HEADER_PDB70) - sizeof(pdb70_header->PdbFileName));
        break;
      }
      default:
        continue;
    }

    // Ensure the PDB path is null-terminated and within the PE bounds.
    if (!fits_in_pe(pe, pdb_path, 1))
        continue;

    pdb_path_len = strnlen(pdb_path, pdb_path_len);

    if (!fits_in_pe(pe, pdb_path, pdb_path_len + 1))
        continue;

    if (pdb_path_len > 0 && pdb_path_len < MAX_PDB_PATH)
    {
      pe->pdb_path = yr_strdup(pdb_path);
      break;
    }