if (codeview_header->Signature == CVINFO_PDB20_CODEVIEW_SIGNATURE)
{
  PCV_INFO_PDB20 pdb20 = (PCV_INFO_PDB20) codeview_header;
  if (struct_fits_in_pe(pe, pdb20, CV_INFO_PDB20))
  {
    pdb_path = (char*) pdb20->PdbFileName;
    pdb_path_len = strnlen(pdb_path, pe->data_size - (size_t) pcv_hdr_offset - offsetof(CV_INFO_PDB20, PdbFileName));
  }
}
else if (codeview_header->Signature == CVINFO_PDB70_CODEVIEW_SIGNATURE)
{
  PCV_INFO_PDB70 pdb70 = (PCV_INFO_PDB70) codeview_header;
  if (struct_fits_in_pe(pe, pdb70, CV_INFO_PDB70))
  {
    pdb_path = (char*) pdb70->PdbFileName;
    pdb_path_len = strnlen(pdb_path, pe->data_size - (size_t) pcv_hdr_offset - offsetof(CV_INFO_PDB70, PdbFileName));
  }
}

if (pdb_path != NULL && pdb_path_len > 0 && pdb_path_len < MAX_PATH)
{
  set_string(pdb_path, pe->object, "pdb_path");
  break;
}