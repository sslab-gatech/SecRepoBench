if (pcv_hdr_offset + sizeof(PCV_HEADER) > pe->data_size)
      continue;

    switch (yr_le32toh(codeview_header->Signature)) {
      case CV_SIGNATURE: {
        PCV_INFO_PDB70 pdb70 = (PCV_INFO_PDB70) codeview_header;
        if (struct_fits_in_pe(pe, pdb70, PCV_INFO_PDB70)) {
          pdb_path_len = strnlen(pdb70->PDB70.Path, sizeof(pdb70->PDB70.Path));
          if (pdb_path_len > 0 && pdb_path_len < MAX_PDB_PATH_LENGTH) {
            pdb_path = (char*) yr_malloc(pdb_path_len + 1);
            if (pdb_path != NULL) {
              strlcpy(pdb_path, pdb70->PDB70.Path, pdb_path_len + 1);
              set_string(pdb_path, pe->object, "pdb_path");
              yr_free(pdb_path);
              return;
            }
          }
        }
        break;
      }
      case CV_SIGNATURE_RSDS: {
        PCV_INFO_PDB200 pdb200 = (PCV_INFO_PDB200) codeview_header;
        if (struct_fits_in_pe(pe, pdb200, PCV_INFO_PDB200)) {
          pdb_path_len = strnlen(pdb200->PDB200.Path, sizeof(pdb200->PDB200.Path));
          if (pdb_path_len > 0 && pdb_path_len < MAX_PDB_PATH_LENGTH) {
            pdb_path = (char*) yr_malloc(pdb_path_len + 1);
            if (pdb_path != NULL) {
              strlcpy(pdb_path, pdb200->PDB200.Path, pdb_path_len + 1);
              set_string(pdb_path, pe->object, "pdb_path");
              yr_free(pdb_path);
              return;
            }
          }
        }
        break;
      }
    }