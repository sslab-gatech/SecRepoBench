// Determine the type of CodeView debug information by checking the signature.
// Depending on the signature, cast the header to the appropriate PDB structure.
// Extract the PDB file name from the structure if it fits within the PE bounds.
// Compute the length of the PDB path and ensure it's within valid limits.
// If a valid PDB path is found, store the path in the object associated with the PE.
// Stop further processing after successfully storing a valid PDB path.
if (yr_le32toh(codeview_header->Signature) == 0x4550)
{
    PDB_HEADER pdb_header = (PDB_HEADER) codeview_header;
    if (struct_fits_in_pe(pe, pdb_header, PDB_HEADER))
    {
        if (pdb_header->Signature == 0x4550)
        {
            char pdb_path[1024];
            size_t pdb_path_len = 1024;
            if (pdb_header->Length <= pdb_path_len)
            {
                memcpy(pdb_path, (char*) (pe->data + pcv_hdr_offset + sizeof(PCV_HEADER)), pdb_header->Length);
                pdb_path[pdb_header->Length] = '\0';
                set_string(pdb_path, pe->object, "pdb_path");
            }
        }
    }
}
else if (yr_le32toh(codeview_header->Signature) == 0x5344)
{
    PDB2_HEADER pdb2_header = (PDB2_HEADER) codeview_header;
    if (struct_fits_in_pe(pe, pdb2_header, PDB2_HEADER))
    {
        if (pdb2_header->Signature == 0x5344)
        {
            char pdb_path[1024];
            size_t pdb_path_len = 1024;
            if (pdb2_header->Length <= pdb_path_len)
            {
                memcpy(pdb_path, (char*) (pe->data + pcv_hdr_offset + sizeof(PCV_HEADER)), pdb2_header->Length);
                pdb_path[pdb2_header->Length] = '\0';
                set_string(pdb_path, pe->object, "pdb_path");
            }
        }
    }
}