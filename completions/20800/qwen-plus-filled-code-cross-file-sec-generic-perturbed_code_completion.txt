if (codeview_header->CvSignature == CV_INFO_PDB70_SIGNATURE)
{
  PDBG_HEADER70 pdb_header = (PDBG_HEADER70) codeview_header;

  if (!struct_fits_in_pe(pe, pdb_header, DGB_HEADER70))
    break;

  size_t pdb_guid_len = sizeof(pdb_header->signature);
  size_t pdb_age_len = sizeof(pdb_header->age);

  if (!fits_in_pe(pe, pdb_header->signature, pdb_guid_len) ||
      !fits_in_pe(pe, &pdb_header->age, pdb_age_len))
    break;

  // Extract the PDB file name
  size_t pdb_name_offset = sizeof(PDBG_HEADER70);
  size_t pdb_name_max_len = pe->data_size - (pcv_hdr_offset + pdb_name_offset);

  if (pdb_name_max_len <= 0)
    break;

  pdb_path_len = strnlen((const char*)(pe->data + pcv_hdr_offset + pdb_name_offset), pdb_name_max_len);
  
  if (pdb_path_len > MAX_PDB_PATH_LEN || pdb_path_len == 0)
    continue;

  pdb_path = (char*) yr_malloc(pdb_path_len + 1);

  if (pdb_path != NULL)
  {
    memcpy(pdb_path, pe->data + pcv_hdr_offset + pdb_name_offset, pdb_path_len);
    pdb_path[pdb_path_len] = '\0';

    set_string(pdb_path, pe->object, "pdb_file");
    yr_free(pdb_path);
    break; // Stop processing after successfully storing a valid PDB path
  }
}