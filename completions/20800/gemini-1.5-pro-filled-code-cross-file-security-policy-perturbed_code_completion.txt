if (struct_fits_in_pe(pe, codeview_header, sizeof(CV_HEADER)))
    {
      switch (codeview_header->Signature)
      {
        case CV_SIGNATURE_RSDS:
        {
          PCV_RSDS_HEADER pdb_header = (PCV_RSDS_HEADER) codeview_header;

          if (struct_fits_in_pe(pe, pdb_header, sizeof(CV_RSDS_HEADER)))
          {
            pdb_path_len = strnlen(pdb_header->PdbFileName, MAX_PATH);

            if (pdb_path_len > 0 && pdb_path_len < MAX_PATH)
            {
              pe->pdb_path = yr_strndup(
                  pdb_header->PdbFileName, pdb_path_len);
              break;
            }
          }
          break;
        }

        case CV_SIGNATURE_NB10:
        {
          PCV_NB10_HEADER pdb_header = (PCV_NB10_HEADER) codeview_header;
          if (struct_fits_in_pe(pe, pdb_header, sizeof(CV_NB10_HEADER)))
          {
            pdb_path_len = strnlen(pdb_header->PdbFileName, MAX_PATH);
            if (pdb_path_len > 0 && pdb_path_len < MAX_PATH)
            {
              pe->pdb_path = yr_strndup(
                  pdb_header->PdbFileName, pdb_path_len);
              break;
            }
          }
          break;
        }
      }

      if (pe->pdb_path)
        break;
    }