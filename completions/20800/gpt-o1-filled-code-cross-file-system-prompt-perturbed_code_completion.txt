{
  // Signatures for CodeView debug info.
  // "RSDS" -> 0x53445352 (CV_INFO_PDB70), "NB10" -> 0x3031424E (CV_INFO_PDB20)
  #define CVINFO_PDB70_SIG 0x53445352
  #define CVINFO_PDB20_SIG 0x3031424E

  uint32_t cv_signature = yr_le32toh(*(uint32_t*) codeview_header);

  // Handle PDB 7.0 ("RSDS")
  if (cv_signature == CVINFO_PDB70_SIG)
  {
    PCV_INFO_PDB70 cv_info = (PCV_INFO_PDB70) codeview_header;
    char* filename = (char*) cv_info->PdbFileName;

    // Ensure the filename pointer is within the PE buffer.
    if (!fits_in_pe(pe, filename, 1))
      continue;

    // Compute the remaining space and check the length of the PDB path.
    pdb_path_len = strnlen(
        filename,
        (pe->data + pe->data_size) - (uint8_t*) filename);

    if (pdb_path_len > 0 &&
        pdb_path_len < (size_t) ((pe->data + pe->data_size) - (uint8_t*) filename))
    {
      pdb_path = (char*) yr_malloc(pdb_path_len + 1);

      if (pdb_path == NULL)
        continue;

      memcpy(pdb_path, filename, pdb_path_len);
      pdb_path[pdb_path_len] = '\0';

      set_string(pdb_path, pe->object, "pdb_path");
      yr_free(pdb_path);

      // Stop after successfully storing a valid PDB path.
      break;
    }
  }
  // Handle PDB 2.0 ("NB10")
  else if (cv_signature == CVINFO_PDB20_SIG)
  {
    PCV_INFO_PDB20 cv_info = (PCV_INFO_PDB20) codeview_header;
    char* filename = (char*) cv_info->PdbFileName;

    if (!fits_in_pe(pe, filename, 1))
      continue;

    pdb_path_len = strnlen(
        filename,
        (pe->data + pe->data_size) - (uint8_t*) filename);

    if (pdb_path_len > 0 &&
        pdb_path_len < (size_t) ((pe->data + pe->data_size) - (uint8_t*) filename))
    {
      pdb_path = (char*) yr_malloc(pdb_path_len + 1);

      if (pdb_path == NULL)
        continue;

      memcpy(pdb_path, filename, pdb_path_len);
      pdb_path[pdb_path_len] = '\0';

      set_string(pdb_path, pe->object, "pdb_path");
      yr_free(pdb_path);

      break;
    }
  }
}