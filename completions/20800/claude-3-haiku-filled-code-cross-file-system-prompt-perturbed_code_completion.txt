// Determine the type of CodeView debug information by checking the signature.
// Depending on the signature, cast the header to the appropriate PDB structure.
// Extract the PDB file name from the structure if it fits within the PE bounds.
// Compute the length of the PDB path and ensure it's within valid limits.
// If a valid PDB path is found, store the path in the object associated with the PE.
// Stop further processing after successfully storing a valid PDB path.

if (yr_le32toh(codeview_header->Signature) == CODEVIEW_PDB2_SIGNATURE)
{
    PDB2_HEADER* pdb2_header = (PDB2_HEADER*) codeview_header;
    if (fits_in_pe(pe, pdb2_header->PdbFileName, strlen(pdb2_header->PdbFileName) + 1))
    {
        pdb_path = pdb2_header->PdbFileName;
        pdb_path_len = strlen(pdb_path);
        if (pdb_path_len <= MAX_PATH)
        {
            set_string(pdb_path, pe->object, "debug_file");
            return;
        }
    }
}
else if (yr_le32toh(codeview_header->Signature) == CODEVIEW_PDB7_SIGNATURE)
{
    PDB7_HEADER* pdb7_header = (PDB7_HEADER*) codeview_header;
    if (fits_in_pe(pe, pdb7_header->PdbFileName, strlen(pdb7_header->PdbFileName) + 1))
    {
        pdb_path = pdb7_header->PdbFileName;
        pdb_path_len = strlen(pdb_path);
        if (pdb_path_len <= MAX_PATH)
        {
            set_string(pdb_path, pe->object, "debug_file");
            return;
        }
    }
}