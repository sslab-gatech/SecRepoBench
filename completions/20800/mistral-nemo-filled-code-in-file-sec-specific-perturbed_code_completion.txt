def pe_parse_rich_signature(PE* pe, uint64_t base_address):
    # ... (existing code)

    # Masked region
    if (pe->header->OptionalHeader.Magic == IMAGE_NT_OPTIONAL_HDR_MAGIC):
        # ... (existing code)
    else:
        # Masked region
        return;

    # ... (existing code)