if (!struct_fits_in_pe(pe, codeview_header, PCV_HEADER))
      continue;

    if (yr_le32toh(codeview_header->Signature) == RSDS_SIGNATURE)
    {
      PRSDS_DEBUG_INFO rsds_info = (PRSDS_DEBUG_INFO) codeview_header;

      if (!struct_fits_in_pe(pe, rsds_info, RSDS_DEBUG_INFO))
        continue;

      pdb_path_len = strnlen(rsds_info->PdbFileName, MAX_PDB_PATH_LENGTH);

      if (pdb_path_len > 0 && pdb_path_len < MAX_PDB_PATH_LENGTH)
      {
        pdb_path = rsds_info->PdbFileName;
        set_string(pdb_path, pe->object, "pdb_path");
        break;
      }
    }
    else if (yr_le32toh(codeview_header->Signature) == NB10_SIGNATURE)
    {
      PNB10_DEBUG_INFO nb10_info = (PNB10_DEBUG_INFO) codeview_header;

      if (!struct_fits_in_pe(pe, nb10_info, NB10_DEBUG_INFO))
        continue;

      pdb_path_len = strnlen(nb10_info->PdbFileName, MAX_PDB_PATH_LENGTH);

      if (pdb_path_len > 0 && pdb_path_len < MAX_PDB_PATH_LENGTH)
      {
        pdb_path = nb10_info->PdbFileName;
        set_string(pdb_path, pe->object, "pdb_path");
        break;
      }
    }