switch(yr_le32toh(debug_dir->Type))
{
  case IMAGE_DEBUG_TYPE_CODEVIEW:
    {
      PCV_HEADER codeview_header = (PCV_HEADER) (pe->data + pcv_hdr_offset);

      if (codeview_header->Signature == CV_SIGNATURE_PDB70)
      {
        PDB70_HEADER pdb70_header = (PDB70_HEADER) codeview_header;

        if (pdb70_header->Name[0]!= '\0')
        {
          pdb_path_len = strnlen_w(pdb70_header->Name, 256);
          pdb_path = (char*) yr_malloc((pdb_path_len + 1) * 2);

          if (pdb_path!= NULL)
          {
            strlcpy_w(pdb_path, pdb70_header->Name, pdb_path_len + 1);
            set_string(pdb_path, pe->object, "pdb_path");
            yr_free(pdb_path);
          }
        }
      }
      else if (codeview_header->Signature == CV_SIGNATURE_RSDS)
      {
        PDB_RSDS_HEADER pdb_rsds_header = (PDB_RSDS_HEADER) codeview_header;

        if (pdb_rsds_header->Guid.Data1!= 0)
        {
          char pdb_path_guid[37];

          sprintf(pdb_path_guid, "%08x-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x",
              pdb_rsds_header->Guid.Data1,
              pdb_rsds_header->Guid.Data2,
              pdb_rsds_header->Guid.Data3,
              pdb_rsds_header->Guid.Data4[0],
              pdb_rsds_header->Guid.Data4[1],
              pdb_rsds_header->Guid.Data4[2],
              pdb_rsds_header->Guid.Data4[3],
              pdb_rsds_header->Guid.Data4[4],
              pdb_rsds_header->Guid.Data4[5],
              pdb_rsds_header->Guid.Data4[6],
              pdb_rsds_header->Guid.Data4[7]);

          pdb_path_len = strnlen_w(pdb_rsds_header->Age, 256);
          pdb_path = (char*) yr_malloc(strlen(pdb_path_guid) + pdb_path_len + 2);

          if (pdb_path!= NULL)
          {
            sprintf(pdb_path, "%s\\%s", pdb_path_guid, pdb_rsds_header->Age);
            set_string(pdb_path, pe->object, "pdb_path");
            yr_free(pdb_path);
          }
        }
      }
    }
    break;
}