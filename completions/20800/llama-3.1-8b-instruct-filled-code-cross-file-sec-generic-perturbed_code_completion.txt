// Determine the type of CodeView debug information by checking the signature.
// Depending on the signature, cast the header to the appropriate PDB structure.
// Extract the PDB file name from the structure if it fits within the PE bounds.
// Compute the length of the PDB path and ensure it's within valid limits.
// If a valid PDB path is found, store the path in the object associated with the PE.
// Stop further processing after successfully storing a valid PDB path.
if (yr_le32toh(codeview_header->Signature) == 0x4550) // CodeView 1.0
{
    PDB1_HEADER pdb_header = (PDB1_HEADER) codeview_header;
    if (struct_fits_in_pe(pe, pdb_header, PDB1_HEADER))
    {
        char pdb_path[MAX_PDB_PATH_LENGTH];
        size_t pdb_path_len = 0;
        if (wide_string_fits_in_pe(pe, pdb_header->FileName))
        {
            char* pdb_file_name = (char*) ADD_OFFSET(pdb_header, sizeof(PDB1_HEADER));
            if (wide_string_fits_in_pe(pe, pdb_file_name))
            {
                strlcpy_w(pdb_path, pdb_file_name, MAX_PDB_PATH_LENGTH);
                pdb_path_len = strlen(pdb_path);
            }
        }
        set_string(pdb_path, pe->object, "pdb_path");
        return;
    }
}
else if (yr_le32toh(codeview_header->Signature) == 0x4551) // CodeView 2.0
{
    PDB2_HEADER pdb_header = (PDB2_HEADER) codeview_header;
    if (struct_fits_in_pe(pe, pdb_header, PDB2_HEADER))
    {
        char pdb_path[MAX_PDB_PATH_LENGTH];
        size_t pdb_path_len = 0;
        if (wide_string_fits_in_pe(pe, pdb_header->FileName))
        {
            char* pdb_file_name = (char*) ADD_OFFSET(pdb_header, sizeof(PDB2_HEADER));
            if (wide_string_fits_in_pe(pe, pdb_file_name))
            {
                strlcpy_w(pdb_path, pdb_file_name, MAX_PDB_PATH_LENGTH);
                pdb_path_len = strlen(pdb_path);
            }
        }
        set_string(pdb_path, pe->object, "pdb_path");
        return;
    }
}
else if (yr_le32toh(codeview_header->Signature) == 0x4552) // CodeView 3.0
{
    PDB3_HEADER pdb_header = (PDB3_HEADER) codeview_header;
    if (struct_fits_in_pe(pe, pdb_header, PDB3_HEADER))
    {
        char pdb_path[MAX_PDB_PATH_LENGTH];
        size_t pdb_path_len = 0;
        if (wide_string_fits_in_pe(pe, pdb_header->FileName))
        {
            char* pdb_file_name = (char*) ADD_OFFSET(pdb_header, sizeof(PDB3_HEADER));
            if (wide_string_fits_in_pe(pe, pdb_file_name))
            {
                strlcpy_w(pdb_path, pdb_file_name, MAX_PDB_PATH_LENGTH);
                pdb_path_len = strlen(pdb_path);
            }
        }
        set_string(pdb_path, pe->object, "pdb_path");
        return;
    }
}
else if (yr_le32toh(codeview_header->Signature) == 0x4553) // CodeView 4.0
{
    PDB4_HEADER pdb_header = (PDB4_HEADER) codeview_header;
    if (struct_fits_in_pe(pe, pdb_header, PDB4_HEADER))
    {
        char pdb_path[MAX_PDB_PATH_LENGTH];
        size_t pdb_path_len = 0;
        if (wide_string_fits_in_pe(pe, pdb_header->FileName))
        {
            char* pdb_file_name = (char*) ADD_OFFSET(pdb_header, sizeof(PDB4_HEADER));
            if (wide_string_fits_in_pe(pe, pdb_file_name))
            {
                strlcpy_w(pdb_path, pdb_file_name, MAX_PDB_PATH_LENGTH);
                pdb_path_len = strlen(pdb_path);
            }
        }
        set_string(pdb_path, pe->object, "pdb_path");
        return;
    }
}