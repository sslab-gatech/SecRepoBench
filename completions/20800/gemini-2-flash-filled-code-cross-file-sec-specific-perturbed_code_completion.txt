if (yr_le32toh(debug_dir->SizeOfData) < sizeof(CV_HEADER))
      continue;

    PCV_HEADER cv_header = (PCV_HEADER) (pe->data + pcv_hdr_offset);

    if (!struct_fits_in_pe(pe, cv_header, CV_HEADER))
      continue;

    if (cv_header->CvSignature == CV_SIGNATURE_PDB70)
    {
      PCV_INFO_PDB70 pdb70 = (PCV_INFO_PDB70) (pe->data + pcv_hdr_offset);

      if (!struct_fits_in_pe(pe, pdb70, CV_INFO_PDB70))
        continue;

      pdb_path_len = yr_min(
          yr_le32toh(debug_dir->SizeOfData) - sizeof(GUID) - sizeof(DWORD) - sizeof(DWORD),
          MAX_PDB_PATH);

      if (pdb_path_len <= 0)
        continue;

      if (!fits_in_pe(pe, pdb70->PdbFileName, pdb_path_len))
        continue;

      pdb_path = (char*) yr_malloc(pdb_path_len + 1);

      if (pdb_path != NULL)
      {
        memcpy(pdb_path, pdb70->PdbFileName, pdb_path_len);
        pdb_path[pdb_path_len] = '\0';

        set_string(pdb_path, pe->object, "pdb_path");
        yr_free(pdb_path);
        break;
      }
    }
    else if (cv_header->CvSignature == CV_SIGNATURE_PDB20)
    {
      PCV_INFO_PDB20 pdb20 = (PCV_INFO_PDB20) (pe->data + pcv_hdr_offset);

      if (!struct_fits_in_pe(pe, pdb20, CV_INFO_PDB20))
        continue;

      pdb_path_len = yr_min(
          yr_le32toh(debug_dir->SizeOfData) - sizeof(DWORD),
          MAX_PDB_PATH);

      if (pdb_path_len <= 0)
        continue;

      if (!fits_in_pe(pe, pdb20->PdbFileName, pdb_path_len))
        continue;

      pdb_path = (char*) yr_malloc(pdb_path_len + 1);

      if (pdb_path != NULL)
      {
        memcpy(pdb_path, pdb20->PdbFileName, pdb_path_len);
        pdb_path[pdb_path_len] = '\0';

        set_string(pdb_path, pe->object, "pdb_path");
        yr_free(pdb_path);
        break;
      }
    }