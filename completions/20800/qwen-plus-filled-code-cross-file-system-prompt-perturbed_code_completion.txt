if (yr_le16toh(codeview_header->Sig) == CV_RSDS_SIGNATURE)
{
  PCV_CODEVIEW_RSDS codeview_rsds = (PCV_CODEVIEW_RSDS) codeview_header;

  if (!struct_fits_in_pe(pe, codeview_rsds, CV_CODEVIEW_RSDS))
    continue;

  pdb_path_len = strnlen((const char*) codeview_rsds->PdbFileName,
      yr_min(available_space(pe, codeview_rsds->PdbFileName),
      MAX_PDB_PATH_LENGTH));

  if (pdb_path_len > 0 && pdb_path_len <= MAX_PDB_PATH_LENGTH)
  {
    pdb_path = yr_strndup((const char*) codeview_rsds->PdbFileName, pdb_path_len);

    set_string(pdb_path, pe->object, "debug.pdb_path");
    break;
  }
}
else if (yr_le16toh(codeview_header->Sig) == CV_NB10_SIGNATURE)
{
  PCV_CODEVIEW_NB10 codeview_nb10 = (PCV_CODEVIEW_NB10) codeview_header;

  if (!struct_fits_in_pe(pe, codeview_nb10, CV_CODEVIEW_NB10))
    continue;

  pdb_path_len = strnlen((const char*) ADD_OFFSET(codeview_nb10, sizeof(PCV_CODEVIEW_NB10)),
      yr_min(available_space(pe, ADD_OFFSET(codeview_nb10, sizeof(PCV_CODEVIEW_NB10))),
      MAX_PDB_PATH_LENGTH));

  if (pdb_path_len > 0 && pdb_path_len <= MAX_PDB_PATH_LENGTH)
  {
    pdb_path = yr_strndup((const char*) ADD_OFFSET(codeview_nb10, sizeof(PCV_CODEVIEW_NB10)), pdb_path_len);

    set_string(pdb_path, pe->object, "debug.pdb_path");
    break;
  }
}