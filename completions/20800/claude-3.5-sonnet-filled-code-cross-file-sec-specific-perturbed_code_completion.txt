if (struct_fits_in_pe(pe, codeview_header, CV_HEADER))
{
    if (codeview_header->Signature == RSDS_SIGNATURE)
    {
        PCV_INFO_PDB70 cv_pdb = (PCV_INFO_PDB70) codeview_header;
        if (struct_fits_in_pe(pe, cv_pdb, CV_INFO_PDB70))
        {
            pdb_path = (char*) cv_pdb->PdbFileName;
            pdb_path_len = strnlen(pdb_path, PE_MAX_PDB_PATH_SIZE);
            if (fits_in_pe(pe, pdb_path, pdb_path_len + 1))
            {
                set_string(pdb_path, pe->object, "pdb_path");
                break;
            }
        }
    }
    else if (codeview_header->Signature == NB10_SIGNATURE)
    {
        PCV_INFO_PDB20 cv_pdb = (PCV_INFO_PDB20) codeview_header;
        if (struct_fits_in_pe(pe, cv_pdb, CV_INFO_PDB20))
        {
            pdb_path = (char*) cv_pdb->PdbFileName;
            pdb_path_len = strnlen(pdb_path, PE_MAX_PDB_PATH_SIZE);
            if (fits_in_pe(pe, pdb_path, pdb_path_len + 1))
            {
                set_string(pdb_path, pe->object, "pdb_path");
                break;
            }
        }
    }
}