if (!struct_fits_in_pe(pe, codeview_header, sizeof(DWORD)))
      continue;

    // Check for "RSDS" signature (PDB 7.0)
    if (memcmp(&codeview_header->Signature, "RSDS", 4) == 0)
    {
      PCV_INFO_PDB70 pdb70 = (PCV_INFO_PDB70) codeview_header;
      size_t available = pe->data_size - (size_t)pcv_hdr_offset;
      // Ensure that the PDB file name pointer is within the PE bounds.
      if (!fits_in_pe(pe, pdb70->PdbFileName, 1))
        continue;

      // Use available space from the PDB file name pointer as an upper bound.
      size_t name_len = strnlen(pdb70->PdbFileName, available);
      // Check for a non-empty name that does not exceed a reasonable limit (e.g. 260).
      if (name_len > 0 && name_len < available && name_len < 260)
      {
        set_string(pdb70->PdbFileName, pe->object, "pdb_path");
        return;
      }
    }
    // Check for "NB10" signature (older PDB format)
    else if (memcmp(&codeview_header->Signature, "NB10", 4) == 0)
    {
      PCV_INFO_PDB pdb = (PCV_INFO_PDB) codeview_header;
      size_t available = pe->data_size - (size_t)pcv_hdr_offset;
      if (!fits_in_pe(pe, pdb->PdbFileName, 1))
        continue;

      size_t name_len = strnlen(pdb->PdbFileName, available);
      if (name_len > 0 && name_len < available && name_len < 260)
      {
        set_string(pdb->PdbFileName, pe->object, "pdb_path");
        return;
      }
    }