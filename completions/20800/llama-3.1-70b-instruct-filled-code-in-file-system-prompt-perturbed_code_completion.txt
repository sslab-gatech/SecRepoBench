switch(yr_le32toh(debug_dir->Type))
{
  case IMAGE_DEBUG_TYPE_CODEVIEW:
    {
      PCV_HEADER codeview_header = (PCV_HEADER) (pe->data + pcv_hdr_offset);

      if (codeview_header->Signature == CV_SIGNATURE_PDB70)
      {
        PDB70_HEADER pdb70_header = (PDB70_HEADER) codeview_header;

        if (pdb70_header->Name[0]!= '\0')
        {
          pdb_path_len = strnlen_w(pdb70_header->Name, 256);

          if (pdb_path_len > 0)
          {
            pdb_path = (char*) yr_malloc((pdb_path_len + 1) * 2);

            if (pdb_path!= NULL)
            {
              strlcpy_w(pdb_path, pdb70_header->Name, pdb_path_len + 1);
              set_string(pdb_path, pe->object, "pdb_path");
              yr_free(pdb_path);
            }
          }
        }
      }
      else if (codeview_header->Signature == CV_SIGNATURE_RSDS)
      {
        PRSDS_HEADER rsds_header = (PRSDS_HEADER) codeview_header;

        if (yr_le32toh(rsds_header->Flags) == 1)
        {
          pdb_path_len = strnlen_w(rsds_header->Guid, 16);

          if (pdb_path_len > 0)
          {
            pdb_path = (char*) yr_malloc((pdb_path_len + 1) * 2);

            if (pdb_path!= NULL)
            {
              strlcpy_w(pdb_path, rsds_header->Guid, pdb_path_len + 1);
              set_string(pdb_path, pe->object, "pdb_path");
              yr_free(pdb_path);
            }
          }
        }
      }
    }
    break;
}