if (!struct_fits_in_pe(pe, codeview_header, CV_HEADER))
  continue;

// Get the signature (in little-endian format)
uint32_t signature = yr_le32toh(codeview_header->Signature);

// RSDS signature (PDB 7.0) - 'RSDS' = 0x53445352
if (signature == 0x53445352)
{
  // Make sure we have enough data to read the signature, GUID, and age
  if (!fits_in_pe(pe, codeview_header, sizeof(CV_HEADER) + 20))
    continue;
  
  // Get pointer to the PDB path (after signature + GUID + age)
  char* pdb_filename = (char*) codeview_header + sizeof(CV_HEADER) + 20;
  
  // Check if the PDB path is within PE bounds
  if (!fits_in_pe(pe, pdb_filename, 1))
    continue;
  
  // Calculate length of PDB path (null-terminated string)
  pdb_path_len = strnlen(pdb_filename, MAX_PATH);
  if (pdb_path_len == 0 || pdb_path_len == MAX_PATH)
    continue;
  
  // Ensure the complete path (including null terminator) is within PE bounds
  if (!fits_in_pe(pe, pdb_filename, pdb_path_len + 1))
    continue;
  
  // Store the PDB path
  pdb_path = pdb_filename;
  
  // Found a valid PDB path, no need to check further
  break;
}
// NB10 signature (PDB 2.0) - 'NB10' = 0x3031424E
else if (signature == 0x3031424E)
{
  // Make sure we have enough data to read the signature, timestamp, and age
  if (!fits_in_pe(pe, codeview_header, sizeof(CV_HEADER) + 8))
    continue;
  
  // Get pointer to the PDB path (after signature + timestamp + age)
  char* pdb_filename = (char*) codeview_header + sizeof(CV_HEADER) + 8;
  
  // Check if the PDB path is within PE bounds
  if (!fits_in_pe(pe, pdb_filename, 1))
    continue;
  
  // Calculate length of PDB path (null-terminated string)
  pdb_path_len = strnlen(pdb_filename, MAX_PATH);
  if (pdb_path_len == 0 || pdb_path_len == MAX_PATH)
    continue;
  
  // Ensure the complete path (including null terminator) is within PE bounds
  if (!fits_in_pe(pe, pdb_filename, pdb_path_len + 1))
    continue;
  
  // Store the PDB path
  pdb_path = pdb_filename;
  
  // Found a valid PDB path, no need to check further
  break;
}