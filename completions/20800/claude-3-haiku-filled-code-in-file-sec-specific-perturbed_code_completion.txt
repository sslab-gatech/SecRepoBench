// <MASK>
// Determine the type of CodeView debug information by checking the signature.
// Depending on the signature, cast the header to the appropriate PDB structure.
// Extract the PDB file name from the structure if it fits within the PE bounds.
// Compute the length of the PDB path and ensure it's within valid limits.
// If a valid PDB path is found, store the path in the object associated with the PE.
// Stop further processing after successfully storing a valid PDB path.

if (yr_le32toh(codeview_header->Signature) == CV_SIGNATURE_RSDS)
{
    PCV_INFO_PDB70 pdb70 = (PCV_INFO_PDB70) codeview_header;
    if (fits_in_pe(pe, pdb70->PdbFileName, strlen(pdb70->PdbFileName) * 2 + 1))
    {
        pdb_path = yr_strndup(pdb70->PdbFileName, strlen(pdb70->PdbFileName));
        set_string(pdb_path, pe->object, "pdb_path");
        yr_free(pdb_path);
        return;
    }
}
else if (yr_le32toh(codeview_header->Signature) == CV_SIGNATURE_NB10)
{
    PCV_INFO_PDB20 pdb20 = (PCV_INFO_PDB20) codeview_header;
    if (fits_in_pe(pe, pdb20->PdbFileName, strlen(pdb20->PdbFileName) * 2 + 1))
    {
        pdb_path = yr_strndup(pdb20->PdbFileName, strlen(pdb20->PdbFileName));
        set_string(pdb_path, pe->object, "pdb_path");
        yr_free(pdb_path);
        return;
    }
}