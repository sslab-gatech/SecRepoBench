if (codeview_header->CvSignature == CV_SIGNATURE_NB10)
{
  PCV_HEADER_NB10 codeview_nb10 = (PCV_HEADER_NB10) codeview_header;

  if (!struct_fits_in_pe(pe, codeview_nb10, CV_HEADER_NB10))
    continue;

  size_t pdb_path_size = yr_le32toh(codeview_nb10->PathSize);

  if (pdb_path_size > MAX_PDB_PATH_LENGTH || 
      !fits_in_pe(pe, codeview_nb10->PdbFileName, pdb_path_size))
    continue;

  pdb_path_len = pdb_path_size + 1; // Include space for null terminator
  pdb_path = (char*) yr_malloc(pdb_path_len);

  if (!pdb_path)
    continue;

  strncpy(pdb_path, (const char*) codeview_nb10->PdbFileName, pdb_path_size);
  pdb_path[pdb_path_size] = '\0';

  set_string(
      pdb_path,
      pe->object,
      "debug.pdb_path");

  yr_free(pdb_path);
  break;
}
else if (codeview_header->CvSignature == CV_SIGNATURE_RSDS)
{
  PCV_HEADER_RSDS codeview_rsds = (PCV_HEADER_RSDS) codeview_header;

  if (!struct_fits_in_pe(pe, codeview_rsds, CV_HEADER_RSDS))
    continue;

  size_t pdb_path_size = strlen((const char*) codeview_rsds->PdbFileName);

  if (pdb_path_size > MAX_PDB_PATH_LENGTH || 
      !fits_in_pe(pe, codeview_rsds->PdbFileName, pdb_path_size))
    continue;

  pdb_path_len = pdb_path_size + 1; // Include space for null terminator
  pdb_path = (char*) yr_malloc(pdb_path_len);

  if (!pdb_path)
    continue;

  strncpy(pdb_path, (const char*) codeview_rsds->PdbFileName, pdb_path_size);
  pdb_path[pdb_path_size] = '\0';

  set_string(
      pdb_path,
      pe->object,
      "debug.pdb_path");

  yr_free(pdb_path);
  break;
}