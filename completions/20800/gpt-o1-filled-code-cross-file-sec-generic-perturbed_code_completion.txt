{
    // CodeView signature constants for NB10 and RSDS.
    #define CV_SIGNATURE_NB10 0x3031424E  // "NB10"
    #define CV_SIGNATURE_RSDS 0x53445352  // "RSDS"

    uint32_t cv_signature = yr_le32toh(codeview_header->Signature);

    // Check CodeView signature to determine how to parse the structure.
    if (cv_signature == CV_SIGNATURE_NB10)
    {
      // NB10 (PDB 2.0) structure: Signature (4 bytes), Offset (4 bytes),
      // Signature2 (4 bytes), Age (4 bytes), followed by PDB file name.
      // Minimum size for string offset is 16 bytes.
      if (!fits_in_pe(pe, codeview_header, 16))
        continue;

      // The PDB filename is located immediately after the first 16 bytes.
      char* pdb_file = (char*) codeview_header + 16;
      size_t max_len = available_space(pe, pdb_file);
      size_t pdb_path_len = strnlen(pdb_file, max_len);

      if (pdb_path_len > 0 && pdb_path_len < 4096)
      {
        set_string(pdb_file, pe->object, "pdb_path");
        break;
      }
    }
    else if (cv_signature == CV_SIGNATURE_RSDS)
    {
      // RSDS (PDB 7.0) structure: Signature (4 bytes), GUID (16 bytes),
      // Age (4 bytes), followed by PDB file name.
      // Minimum size for string offset is 24 bytes.
      if (!fits_in_pe(pe, codeview_header, 24))
        continue;

      // The PDB filename is located immediately after the first 24 bytes.
      char* pdb_file = (char*) codeview_header + 24;
      size_t max_len = available_space(pe, pdb_file);
      size_t pdb_path_len = strnlen(pdb_file, max_len);

      if (pdb_path_len > 0 && pdb_path_len < 4096)
      {
        set_string(pdb_file, pe->object, "pdb_path");
        break;
      }
    }
}