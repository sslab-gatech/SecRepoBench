if (struct_fits_in_pe(pe, codeview_header, PCV_HEADER))
    {
      switch (codeview_header->signature)
      {
        case CV_RSDS_SIGNATURE:
        {
          PRSDS_HEADER rsdsh = (PRSDS_HEADER) codeview_header;
          if (struct_fits_in_pe(pe, rsdsh, RSDS_HEADER) &&
              wide_string_fits_in_pe(pe, rsdsh->pdb_path))
          {
            pdb_path_len = strnlen_w(rsdsh->pdb_path, 256);
            pdb_path = (char*) yr_malloc(pdb_path_len + 1);
            if (pdb_path != NULL)
            {
              strlcpy_w(pdb_path, rsdsh->pdb_path, pdb_path_len + 1);
              set_string(pdb_path, pe->object, "pdb_path");
              yr_free(pdb_path);
            }
          }
          break;
        }
        case CV_NB10_SIGNATURE:
        {
          PNB10_HEADER nb10h = (PNB10_HEADER) codeview_header;
          if (struct_fits_in_pe(pe, nb10h, NB10_HEADER) &&
              wide_string_fits_in_pe(pe, nb10h->pdb_path))
          {
            pdb_path_len = strnlen_w(nb10h->pdb_path, 256);
            pdb_path = (char*) yr_malloc(pdb_path_len + 1);
            if (pdb_path != NULL)
            {
              strlcpy_w(pdb_path, nb10h->pdb_path, pdb_path_len + 1);
              set_string(pdb_path, pe->object, "pdb_path");
              yr_free(pdb_path);
            }
          }
          break;
        }
        case CV_NB10_SIGNATURE_2:
        {
          PNB10_HEADER_2 nb10h2 = (PNB10_HEADER_2) codeview_header;
          if (struct_fits_in_pe(pe, nb10h2, NB10_HEADER_2) &&
              wide_string_fits_in_pe(pe, nb10h2->pdb_path))
          {
            pdb_path_len = strnlen_w(nb10h2->pdb_path, 256);
            pdb_path = (char*) yr_malloc(pdb_path_len + 1);
            if (pdb_path != NULL)
            {
              strlcpy_w(pdb_path, nb10h2->pdb_path, pdb_path_len + 1);
              set_string(pdb_path, pe->object, "pdb_path");
              yr_free(pdb_path);
            }
          }
          break;
        }
      }
    }