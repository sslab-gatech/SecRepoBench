{
      uint32_t signature = yr_le32toh(codeview_header->Signature);
      size_t header_size = 0;
      const char* pdb_str;

      // Check signature for CodeView (PDB) formats "RSDS" (PDB 7.0) or "NB10" (older)
      if (signature == 0x53445352)  // 'RSDS'
      {
        // Signature (4 bytes) + GUID (16 bytes) + Age (4 bytes)
        header_size = 4 + 16 + 4;
      }
      else if (signature == 0x3031424E)  // 'NB10'
      {
        // Signature (4 bytes) + Offset (4 bytes) + Timestamp (4 bytes) + Age (4 bytes)
        header_size = 4 + 4 + 4 + 4;
      }
      else
      {
        // Unknown signature, skip.
        continue;
      }

      // Ensure the header is within file bounds
      if (pcv_hdr_offset + header_size >= pe->data_size)
        continue;

      // PDB file path starts right after the known header part
      pdb_str = (const char*)(pe->data + pcv_hdr_offset + header_size);

      // Calculate the maximum possible length for the PDB path
      size_t max_len = pe->data_size - (pcv_hdr_offset + header_size);

      // Find the actual length of the null-terminated PDB path
      pdb_path_len = strnlen(pdb_str, max_len);

      if (pdb_path_len == 0 || pdb_path_len == max_len || pdb_path_len > 1024)
        continue;

      pdb_path = (char*) yr_malloc(pdb_path_len + 1);
      if (pdb_path == NULL)
        continue;

      memcpy(pdb_path, pdb_str, pdb_path_len);
      pdb_path[pdb_path_len] = '\0';

      // Store the PDB path in the PE object
      set_string(pdb_path, pe->object, "pdb_path");

      yr_free(pdb_path);
      pdb_path = NULL;

      // Stop after storing a valid path
      break;
    }