if (!struct_fits_in_pe(pe, codeview_header, PCV_HEADER))
      continue;

    uint32_t signature = yr_le32toh(codeview_header->signature);

    if (signature == CV_SIGNATURE_RSDS)
    {
      PCV_RSDS_HEADER rsds_header = (PCV_RSDS_HEADER) codeview_header;
      
      if (!struct_fits_in_pe(pe, rsds_header, CV_RSDS_HEADER))
        continue;

      pdb_path_len = strnlen((char*)rsds_header->pdb_name, MAX_PDB_PATH_LENGTH);
      if (pdb_path_len > 0 && pdb_path_len < MAX_PDB_PATH_LENGTH)
      {
        pdb_path = (char*) yr_malloc(pdb_path_len + 1);
        if (pdb_path != NULL)
        {
          strncpy(pdb_path, (char*)rsds_header->pdb_name, pdb_path_len);
          pdb_path[pdb_path_len] = '\0';
          set_string(pdb_path, pe->object, "pdb_path");
          yr_free(pdb_path);
          break;
        }
      }
    }
    else if (signature == CV_SIGNATURE_NB10)
    {
      PCV_NB10_HEADER nb10_header = (PCV_NB10_HEADER) codeview_header;
      
      if (!struct_fits_in_pe(pe, nb10_header, CV_NB10_HEADER))
        continue;

      pdb_path_len = strnlen((char*)nb10_header->pdb_name, MAX_PDB_PATH_LENGTH);
      if (pdb_path_len > 0 && pdb_path_len < MAX_PDB_PATH_LENGTH)
      {
        pdb_path = (char*) yr_malloc(pdb_path_len + 1);
        if (pdb_path != NULL)
        {
          strncpy(pdb_path, (char*)nb10_header->pdb_name, pdb_path_len);
          pdb_path[pdb_path_len] = '\0';
          set_string(pdb_path, pe->object, "pdb_path");
          yr_free(pdb_path);
          break;
        }
      }
    }