if (struct_fits_in_pe(pe, codeview_header, PCV_HEADER))
    {
      switch (yr_le32toh(codeview_header->Signature))
      {
        case CV_SIGNATURE_RSDS:
        {
          PRSDS_HEADER rsds_header = (PRSDS_HEADER) codeview_header;
          if (struct_fits_in_pe(pe, rsds_header, RSDS_HEADER) &&
              struct_fits_in_pe(pe, rsds_header->PDB, PDB_INFO))
          {
            pdb_path_len = strnlen(rsds_header->PDB->PDB70.Name, MAX_PDB_PATH_LENGTH);
            if (pdb_path_len > 0 && pdb_path_len < MAX_PDB_PATH_LENGTH)
            {
              pdb_path = (char*) yr_malloc(pdb_path_len + 1);
              if (pdb_path != NULL)
              {
                strlcpy(pdb_path, rsds_header->PDB->PDB70.Name, pdb_path_len + 1);
                set_string(pdb_path, pe->object, "pdb_path");
                yr_free(pdb_path);
                return;
              }
            }
          }
          break;
        }
        case CV_SIGNATURE_NB10:
        case CV_SIGNATURE_NB11:
        {
          PNB10_HEADER nb10_header = (PNB10_HEADER) codeview_header;
          if (struct_fits_in_pe(pe, nb10_header, NB10_HEADER) &&
              struct_fits_in_pe(pe, nb10_header->PDB, PDB_INFO))
          {
            pdb_path_len = strnlen(nb10_header->PDB->PDB70.Name, MAX_PDB_PATH_LENGTH);
            if (pdb_path_len > 0 && pdb_path_len < MAX_PDB_PATH_LENGTH)
            {
              pdb_path = (char*) yr_malloc(pdb_path_len + 1);
              if (pdb_path != NULL)
              {
                strlcpy(pdb_path, nb10_header->PDB->PDB70.Name, pdb_path_len + 1);
                set_string(pdb_path, pe->object, "pdb_path");
                yr_free(pdb_path);
                return;
              }
            }
          }
          break;
        }
      }
    }