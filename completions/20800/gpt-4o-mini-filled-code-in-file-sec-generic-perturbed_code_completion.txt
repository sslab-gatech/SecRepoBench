if (yr_le32toh(debug_dir->AddressOfRawData) < sizeof(IMAGE_DEBUG_DIRECTORY))
      continue;

    if (yr_le32toh(debug_dir->AddressOfRawData) == 0)
      continue;

    pcv_hdr_offset = pe_rva_to_offset(pe, yr_le32toh(debug_dir->AddressOfRawData));

    if (pcv_hdr_offset < 0)
      continue;

    if (!struct_fits_in_pe(pe, (PIMAGE_DEBUG_DIRECTORY)(pe->data + pcv_hdr_offset), IMAGE_DEBUG_DIRECTORY))
      continue;

    codeview_header = (PCV_HEADER)(pe->data + pcv_hdr_offset);

    if (codeview_header->Signature == CV_SIGNATURE_NT_SYMBOLS)
    {
      pdb_path_len = codeview_header->PdbFileNameLength;

      if (pdb_path_len > 0 && pdb_path_len < pe->data_size - pcv_hdr_offset)
      {
        pdb_path = (char*)yr_malloc(pdb_path_len + 1);
        if (pdb_path)
        {
          memcpy(pdb_path, (char*)codeview_header + sizeof(CV_HEADER), pdb_path_len);
          pdb_path[pdb_path_len] = '\0';
          set_string(pdb_path, pe->object, "pdb_path");
          yr_free(pdb_path);
        }
      }
    }