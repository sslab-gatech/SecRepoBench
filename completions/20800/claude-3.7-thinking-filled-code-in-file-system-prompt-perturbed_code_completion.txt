if (codeview_header->Signature == 0x53445352)  // 'RSDS' signature
{
  // RSDS structure: Signature (4) + GUID (16) + Age (4) + PdbFileName (variable)
  if (pcv_hdr_offset + sizeof(uint32_t) + 16 + sizeof(uint32_t) < pe->data_size)
  {
    // PDB filename starts after signature (4) + GUID (16) + age (4)
    pdb_path = (char*)(pe->data + pcv_hdr_offset + sizeof(uint32_t) + 16 + sizeof(uint32_t));
    
    // Calculate safe string length
    pdb_path_len = strnlen(pdb_path, pe->data_size - (pdb_path - (char*)pe->data));
    
    // Verify we have a valid string
    if (pdb_path_len > 0 && pdb_path_len < pe->data_size - (pdb_path - (char*)pe->data))
    {
      set_string(pdb_path, pe->object, "pdb_path");
      break;
    }
  }
}
else if (codeview_header->Signature == 0x3031424E)  // 'NB10' signature
{
  // NB10 structure: Signature (4) + Offset (4) + Timestamp (4) + Age (4) + PdbFileName (variable)
  if (pcv_hdr_offset + 4*sizeof(uint32_t) < pe->data_size)
  {
    // PDB filename starts after signature (4) + offset (4) + timestamp (4) + age (4)
    pdb_path = (char*)(pe->data + pcv_hdr_offset + 4*sizeof(uint32_t));
    
    // Calculate safe string length
    pdb_path_len = strnlen(pdb_path, pe->data_size - (pdb_path - (char*)pe->data));
    
    // Verify we have a valid string
    if (pdb_path_len > 0 && pdb_path_len < pe->data_size - (pdb_path - (char*)pe->data))
    {
      set_string(pdb_path, pe->object, "pdb_path");
      break;
    }
  }
}