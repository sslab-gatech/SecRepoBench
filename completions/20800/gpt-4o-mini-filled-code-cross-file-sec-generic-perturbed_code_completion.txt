// Check the CodeView signature to determine the PDB format
    if (codeview_header->Signature == CV_SIGNATURE_CV) {
        // Extract the PDB file name
        char* pdb_name = (char*) (codeview_header + 1);
        pdb_path_len = strnlen(pdb_name, MAX_PDB_PATH_LENGTH);
        
        if (pdb_path_len < MAX_PDB_PATH_LENGTH && fits_in_pe(pe, pdb_name, pdb_path_len + 1)) {
            pdb_path = (char*) yr_malloc(pdb_path_len + 1);
            if (pdb_path) {
                strncpy(pdb_path, pdb_name, pdb_path_len);
                pdb_path[pdb_path_len] = '\0'; // Null-terminate the string
                set_string(pdb_path, pe->object, "pdb_path");
                yr_free(pdb_path);
                break; // Stop processing after finding a valid PDB path
            }
        }
    }