if (!struct_fits_in_pe(pe, codeview_header, PCV_HEADER))
  continue;

if (codeview_header->Signature == CODEVIEW_SIGNATURE_NB10)
{
  PCV_INFO_PDB20 cv_info = (PCV_INFO_PDB20) codeview_header;
  if (!struct_fits_in_pe(pe, cv_info, CV_INFO_PDB20))
    continue;

  pdb_path = (char*) cv_info->PdbFileName;
  pdb_path_len = strnlen(pdb_path, pe->data_size - (pdb_path - pe->data));
}
else if (codeview_header->Signature == CODEVIEW_SIGNATURE_RSDS)
{
  PCV_INFO_PDB70 cv_info = (PCV_INFO_PDB70) codeview_header;
  if (!struct_fits_in_pe(pe, cv_info, CV_INFO_PDB70))
    continue;

  pdb_path = (char*) cv_info->PdbFileName;
  pdb_path_len = strnlen(pdb_path, pe->data_size - (pdb_path - pe->data));
}
else
{
  continue;
}

if (pdb_path_len > 0 && pdb_path_len < MAX_PATH)
{
  set_string(pdb_path, pe->object, "pdb_path");
  break;
}