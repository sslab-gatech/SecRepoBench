if (codeview_header->Signature == 'SDSR')
    {
      PCV_INFO_PDB70 pdb_info = (PCV_INFO_PDB70*)(pe->data + pcv_hdr_offset);

      if (struct_fits_in_pe(pe, pdb_info, CV_INFO_PDB70))
      {
        pdb_path = (char*)pdb_info->PdbFileName;
        pdb_path_len = strnlen(pdb_path, MAX_PATH);

        if (pdb_path_len > 0 && pdb_path_len < MAX_PATH &&
            wide_string_fits_in_pe(pe, pdb_path))
        {
          pe->pdb_path = yr_strndup(pdb_path, pdb_path_len);
          break;
        }
      }
    }
    else if (codeview_header->Signature == 'NB10')
    {
       PCV_INFO_PDB20 pdb_info = (PCV_INFO_PDB20*)(pe->data + pcv_hdr_offset);
       if (struct_fits_in_pe(pe, pdb_info, CV_INFO_PDB20))
       {
         pdb_path = (char*)pdb_info->PdbFileName;
         pdb_path_len = strnlen(pdb_path, MAX_PATH);

         if (pdb_path_len > 0 && pdb_path_len < MAX_PATH &&
             wide_string_fits_in_pe(pe, pdb_path))
         {
           pe->pdb_path = yr_strndup(pdb_path, pdb_path_len);
           break;
         }
       }
    }