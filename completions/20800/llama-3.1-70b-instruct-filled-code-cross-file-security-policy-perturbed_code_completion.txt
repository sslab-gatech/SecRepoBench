if (!struct_fits_in_pe(pe, codeview_header, CV_HEADER))
  continue;

switch (yr_le32toh(codeview_header->cv_signature))
{
  case CV_SIGNATURE_PDB70:
    {
      PDB70 pdb70 = (PDB70) codeview_header;

      if (!struct_fits_in_pe(pe, pdb70, PDB70))
        continue;

      pdb_path_len = yr_min(yr_le32toh(pdb70->name_size), MAX_PDB_PATH_LENGTH);

      if (!fits_in_pe(pe, pdb70->name, pdb_path_len))
        continue;

      pdb_path = (char*) yr_malloc(pdb_path_len + 1);

      if (pdb_path == NULL)
        continue;

      memcpy(pdb_path, pdb70->name, pdb_path_len);
      pdb_path[pdb_path_len] = '\0';

      set_string(pdb_path, pe->object, "pdb_path");
      yr_free(pdb_path);
      break;
    }

  case CV_SIGNATURE_PDB20:
    {
      PDB20 pdb20 = (PDB20) codeview_header;

      if (!struct_fits_in_pe(pe, pdb20, PDB20))
        continue;

      pdb_path_len = yr_min(yr_le32toh(pdb20->name_size), MAX_PDB_PATH_LENGTH);

      if (!fits_in_pe(pe, pdb20->name, pdb_path_len))
        continue;

      pdb_path = (char*) yr_malloc(pdb_path_len + 1);

      if (pdb_path == NULL)
        continue;

      memcpy(pdb_path, pdb20->name, pdb_path_len);
      pdb_path[pdb_path_len] = '\0';

      set_string(pdb_path, pe->object, "pdb_path");
      yr_free(pdb_path);
      break;
    }

  default:
    continue;
}