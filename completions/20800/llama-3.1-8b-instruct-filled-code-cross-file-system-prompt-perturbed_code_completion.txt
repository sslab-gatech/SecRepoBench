// Determine the type of CodeView debug information by checking the signature.
// Depending on the signature, cast the header to the appropriate PDB structure.
// Extract the PDB file name from the structure if it fits within the PE bounds.
// Compute the length of the PDB path and ensure it's within valid limits.
// If a valid PDB path is found, store the path in the object associated with the PE.
// Stop further processing after successfully storing a valid PDB path.
if (yr_le32toh(codeview_header->Signature) == 0x4550) // PDB signature
{
  PDB_HEADER pdb_header = (PDB_HEADER) codeview_header;
  if (pdb_header->Signature == 0x4550)
  {
    // Extract the PDB file name from the structure if it fits within the PE bounds.
    char* pdb_path = (char*) ADD_OFFSET(pdb_header, sizeof(PDB_HEADER));
    if (wide_string_fits_in_pe(pe, pdb_path))
    {
      size_t pdb_path_len = strnlen_w(pdb_path, MAX_PDB_PATH_LENGTH);
      if (pdb_path_len <= MAX_PDB_PATH_LENGTH)
      {
        set_string(pdb_path, pe->object, "pdb_path");
        return;
      }
    }
  }
}
else if (yr_le32toh(codeview_header->Signature) == 0x5344) // CVP signature
{
  PCVP_HEADER cvp_header = (PCVP_HEADER) codeview_header;
  if (cvp_header->Signature == 0x5344)
  {
    // Extract the PDB file name from the structure if it fits within the PE bounds.
    char* pdb_path = (char*) ADD_OFFSET(cvp_header, sizeof(PCVP_HEADER));
    if (wide_string_fits_in_pe(pe, pdb_path))
    {
      size_t pdb_path_len = strnlen_w(pdb_path, MAX_PDB_PATH_LENGTH);
      if (pdb_path_len <= MAX_PDB_PATH_LENGTH)
      {
        set_string(pdb_path, pe->object, "pdb_path");
        return;
      }
    }
  }
}