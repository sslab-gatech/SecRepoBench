for (i=1; i < (ssize_t) p->number_points; i++)
  {
    const PointInfo
      *point1 = p->points + i - 1,
      *point2 = p->points + i;

    /*
      Check if the edge crosses the scanline at ycoordinate.
    */
    if ((((point1->y <= (double) ycoordinate) && (point2->y > (double) ycoordinate)) ||
         ((point2->y <= (double) ycoordinate) && (point1->y > (double) ycoordinate))))
      {
        double
          intersect_x;

        /*
          Compute the x coordinate of the intersection of the edge with the scanline.
        */
        intersect_x = (point2->x - point1->x) * ((double) ycoordinate - point1->y) /
          (point2->y - point1->y + MagickEpsilon) + point1->x;

        if ((double) x < intersect_x)
          {
            if (fill_rule == NonZeroRule)
              {
                if (point1->y < point2->y)
                  winding_number++;
                else
                  winding_number--;
              }
            else
              winding_number++;
          }
      }
  }