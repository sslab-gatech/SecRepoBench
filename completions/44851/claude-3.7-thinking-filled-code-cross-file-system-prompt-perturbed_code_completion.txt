ssize_t k;
double x_intersect;

for (k=0; k < (ssize_t) p->number_points-1; k++)
{
  /* Check if edge crosses the horizontal ray from (x, y) */
  if ((p->points[k].y <= (double) ycoordinate && p->points[k+1].y > (double) ycoordinate) ||
      (p->points[k].y > (double) ycoordinate && p->points[k+1].y <= (double) ycoordinate))
  {
    /* Check if crossing is to the right of the point */
    x_intersect = p->points[k].x + 
                   ((double) ycoordinate - p->points[k].y) / 
                   (p->points[k+1].y - p->points[k].y) * 
                   (p->points[k+1].x - p->points[k].x);
    
    if ((double) x < x_intersect)
    {
      /* Adjust winding number based on direction of edge */
      if (p->points[k].y < p->points[k+1].y)
        winding_number++;
      else
        winding_number--;
    }
  }
}