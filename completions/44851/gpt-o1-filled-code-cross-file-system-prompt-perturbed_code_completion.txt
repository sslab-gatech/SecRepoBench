{
  /*
    Determine if this edge might intersect the horizontal ray to the right of (x,y).
    Then update the winding number based on the direction of the edge.
  */
  if ((p->ghostline == MagickFalse) &&
      ((double) ycoordinate > (p->bounds.y1-mid-0.5)) &&
      ((double) ycoordinate <= (p->bounds.y2+mid+0.5)))
    {
      q=p->points;
      for (i=1; i < (ssize_t) p->number_points; i++)
      {
        /*
          Check if the line segment between q[i-1] and q[i] crosses
          the horizontal line at ycoordinate, ignoring segments
          that do not span across this Y.
        */
        if (((q[i-1].y <= (double) ycoordinate) && (q[i].y > (double) ycoordinate)) ||
            ((q[i-1].y > (double) ycoordinate) && (q[i].y <= (double) ycoordinate)))
          {
            /*
              Find the X coordinate where the segment intersects ycoordinate.
            */
            double x_intersect = q[i-1].x + (ycoordinate - q[i-1].y) *
              (q[i].x - q[i-1].x) / (q[i].y - q[i-1].y);
            /*
              If the intersection is to the right of our test point,
              increment or decrement the winding number depending on
              the direction of the edge.
            */
            if (x_intersect >= (double) x)
              {
                if (q[i].y > q[i-1].y)
                  winding_number++;
                else
                  winding_number--;
              }
          }
      }
    }
}