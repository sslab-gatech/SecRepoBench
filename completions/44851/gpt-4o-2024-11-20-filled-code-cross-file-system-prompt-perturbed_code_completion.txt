if ((p->points[0].y <= (double) ycoordinate) &&
        (p->points[p->number_points-1].y > (double) ycoordinate))
      {
        if (p->direction == 0)
          winding_number++;
        else
          winding_number--;
      }
    else if ((p->points[0].y > (double) ycoordinate) &&
             (p->points[p->number_points-1].y <= (double) ycoordinate))
      {
        if (p->direction == 0)
          winding_number--;
        else
          winding_number++;
      }