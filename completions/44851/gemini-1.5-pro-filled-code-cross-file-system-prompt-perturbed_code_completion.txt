if (((double) x <= p->points[0].x) &&
        (ycoordinate > p->bounds.y1) && (ycoordinate <= p->points[0].y))
      winding_number+=p->direction ? 1 : -1;
    if (((double) x > p->points[p->number_points-1].x) &&
        (ycoordinate > p->points[p->number_points-1].y) &&
        (ycoordinate <= p->bounds.y2))
      winding_number+=p->direction ? -1 : 1;
    for (i=1; i < (ssize_t) p->number_points; i++)
    {
      if (ycoordinate > p->points[i].y)
        continue;
      if (((double) x <= p->points[i].x) && ((double) x > p->points[i-1].x))
        winding_number+=p->direction ? -1 : 1;
      else
        if (((double) x > p->points[i].x) && ((double) x <= p->points[i-1].x))
          winding_number+=p->direction ? 1 : -1;
    }