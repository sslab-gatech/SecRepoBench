for (const auto& gid_klass_pair : + iterator)
    {
      unsigned klass = gid_klass_pair.second;
      if (klass != prev_klass)
      {
        if (num_ranges > 0)
        {
          rangeRecord.last = prev_gid;
          if (unlikely (!c->copy (rangeRecord))) return_trace (false);
        }

        rangeRecord.first = gid_klass_pair.first;
        rangeRecord.value = klass;
        rangeRecord.last = gid_klass_pair.first;
        prev_klass = klass;
        prev_gid = gid_klass_pair.first;
        num_ranges++;
      }
      else
      {
        rangeRecord.last = gid_klass_pair.first;
      }
    }

    if (num_ranges > 0)
    {
      rangeRecord.last = prev_gid;
      if (unlikely (!c->copy (rangeRecord))) return_trace (false);
    }

    rangeRecord.len = num_ranges;
    return_trace (true);