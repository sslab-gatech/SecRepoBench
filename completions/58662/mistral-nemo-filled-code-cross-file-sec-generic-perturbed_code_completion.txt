for (; iterator; ++iterator)
    {
      if ((*iterator).first == prev_gid + 1 && (*iterator).second == prev_klass)
      {
        range_rec.last = (*iterator).first;
      }
      else
      {
        auto *record = c->copy (range_rec);
        if (unlikely (!record)) return_trace (false);
        num_ranges++;
        range_rec.first = (*iterator).first;
        range_rec.last = (*iterator).first;
        range_rec.value = (*iterator).second;
      }
      prev_gid = (*iterator).first;
      prev_klass = (*iterator).second;
    }
    range_rec.last = prev_gid;
    range_record.len = num_ranges;
    std::sort(range_record.begin(), range_record.end());
    return_trace (true);