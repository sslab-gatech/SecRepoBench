for (; iterator.hasNext(); ++iterator) {
      auto [gid, klass] = *iterator;
      if (gid != prev_gid + 1 || klass != prev_klass) {
        range_rec.last = prev_gid;
        auto *record = c->copy(range_rec);
        if (unlikely(!record)) return_trace(false);
        ++num_ranges;
        range_rec.first = range_rec.last = gid;
        range_rec.value = klass;
      } else {
        range_rec.last = gid;
      }
      prev_gid = gid;
      prev_klass = klass;
    }
    range_rec.last = prev_gid;
    rangeRecord.len = num_ranges;
    std::sort(rangeRecord.begin(), rangeRecord.end());
    return_trace(true);