} else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
  /* Gather SSH flow information */
  flow_info->info_type = INFO_SSH;

  if(flow_info->ndpi_flow->protos.ssh.client_signature[0] != '\0') {
    flow_info->ssh.client_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_signature);
  }
  if(flow_info->ndpi_flow->protos.ssh.server_signature[0] != '\0') {
    flow_info->ssh.server_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_signature);
  }
  if(flow_info->ndpi_flow->protos.ssh.client_hash[0] != '\0') {
    flow_info->ssh.client_hash = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_hash);
  }
  if(flow_info->ndpi_flow->protos.ssh.server_hash[0] != '\0') {
    flow_info->ssh.server_hash = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_hash);
  }

} else if((flow_info->detected_protocol.master_protocol == NDPI_PROTOCOL_TLS) ||
          is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS) ||
          is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC)) {

  /* TLS/QUIC flow information */
  if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC)) {
    is_quic = 1;
  }
  flow_info->info_type = INFO_SSL;

  /* SSL version */
  if(flow_info->ndpi_flow->protos.ssl.version[0] != '\0') {
    flow_info->ssl.version = ndpi_strdup(flow_info->ndpi_flow->protos.ssl.version);
  }

  /* Server Name */
  if(flow_info->ndpi_flow->protos.ssl.server_names &&
     flow_info->ndpi_flow->protos.ssl.server_names[0] != '\0') {
    flow_info->ssl.server_names = ndpi_strdup(flow_info->ndpi_flow->protos.ssl.server_names);
  }

  /* ALPN */
  if(flow_info->ndpi_flow->protos.ssl.alpn &&
     flow_info->ndpi_flow->protos.ssl.alpn[0] != '\0') {
    flow_info->ssl.alpn = ndpi_strdup(flow_info->ndpi_flow->protos.ssl.alpn);
  }

  /* JA3 fingerprints */
  if(flow_info->ndpi_flow->protos.ssl.client_ja3[0] != '\0') {
    flow_info->ssl.client_ja3 = ndpi_strdup(flow_info->ndpi_flow->protos.ssl.client_ja3);
  }
  if(flow_info->ndpi_flow->protos.ssl.server_ja3[0] != '\0') {
    flow_info->ssl.server_ja3 = ndpi_strdup(flow_info->ndpi_flow->protos.ssl.server_ja3);
  }

  /* Certificate information */
  if(flow_info->ndpi_flow->protos.ssl.cert_issuer_dn &&
     flow_info->ndpi_flow->protos.ssl.cert_issuer_dn[0] != '\0') {
    flow_info->ssl.cert_issuer_dn = ndpi_strdup(flow_info->ndpi_flow->protos.ssl.cert_issuer_dn);
  }
  if(flow_info->ndpi_flow->protos.ssl.cert_subject_dn &&
     flow_info->ndpi_flow->protos.ssl.cert_subject_dn[0] != '\0') {
    flow_info->ssl.cert_subject_dn = ndpi_strdup(flow_info->ndpi_flow->protos.ssl.cert_subject_dn);
  }

  /* Validity dates */
  flow_info->ssl.notBefore = flow_info->ndpi_flow->protos.ssl.notBefore;
  flow_info->ssl.notAfter  = flow_info->ndpi_flow->protos.ssl.notAfter;

  /*
    Optionally, you might reset/update any flow distribution metrics
    based on these TLS block lengths or other TLS/QUIC extras,
    ensuring bounds are respected.
  */
}