if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
    if(flow_info->ndpi_flow->protos.ssh.client_signature[0] != '\0')
      flow_info->ssh_tls.client_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_signature);
    if(flow_info->ndpi_flow->protos.ssh.server_signature[0] != '\0')
      flow_info->ssh_tls.server_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_signature);
    if(flow_info->ndpi_flow->protos.ssh.hassh_client[0] != '\0')
      flow_info->ssh_tls.hassh_client = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.hassh_client);
    if(flow_info->ndpi_flow->protos.ssh.hassh_server[0] != '\0')
      flow_info->ssh_tls.hassh_server = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.hassh_server);
  } else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS)
            || is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC)
            || is_ndpi_proto(flow_info, NDPI_PROTOCOL_DTLS)
            || flow_info->detected_protocol.master_protocol == NDPI_PROTOCOL_TLS) {
    if(flow_info->ndpi_flow->protos.tls_quic.ssl_version) {
      flow_info->ssh_tls.ssl_version = ndpi_ssl_version2str(flow_info->ndpi_flow->protos.tls_quic.ssl_version, 
                                                            &known_tls);
    }

    if(flow_info->ndpi_flow->protos.tls_quic.server_names_len > 0) {
      flow_info->ssh_tls.server_names = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.server_names);
    }

    if(flow_info->ndpi_flow->protos.tls_quic.notBefore)
      flow_info->ssh_tls.notBefore = flow_info->ndpi_flow->protos.tls_quic.notBefore;
    if(flow_info->ndpi_flow->protos.tls_quic.notAfter)
      flow_info->ssh_tls.notAfter  = flow_info->ndpi_flow->protos.tls_quic.notAfter;

    if(flow_info->ndpi_flow->protos.tls_quic.ja3_client[0] != '\0')
      flow_info->ssh_tls.ja3_client = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.ja3_client);
    if(flow_info->ndpi_flow->protos.tls_quic.ja3_server[0] != '\0')
      flow_info->ssh_tls.ja3_server = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.ja3_server);

    if(flow_info->ndpi_flow->l4.tcp.tls.fingerprint_set) {
      memcpy(flow_info->ssh_tls.sha1_cert_fingerprint,
             flow_info->ndpi_flow->l4.tcp.tls.sha1_certificate_fingerprint, 20);
      flow_info->ssh_tls.sha1_cert_fingerprint_set = 1;
    }

    flow_info->ssh_tls.client_requested_server_name = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.client_requested_server_name);
    flow_info->ssh_tls.client_unsafe_cipher = flow_info->ndpi_flow->protos.tls_quic.client_unsafe_cipher;
    flow_info->ssh_tls.server_unsafe_cipher = flow_info->ndpi_flow->protos.tls_quic.server_unsafe_cipher;
    flow_info->ssh_tls.server_cipher = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.server_cipher);
    flow_info->ssh_tls.server_organization = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.server_organization);

    if(flow_info->ndpi_flow->protos.tls_quic.alpn) {
      flow_info->ssh_tls.tls_alpn = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.alpn);
    }
    if(flow_info->ndpi_flow->protos.tls_quic.tls_supported_versions) {
      flow_info->ssh_tls.tls_supported_versions = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.tls_supported_versions);
    }

    if(flow_info->ssh_tls.tls_alpn || flow_info->ssh_tls.tls_supported_versions) {
      flow_info->info_type = INFO_TLS_QUIC;
    }

    if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC)) {
      ndpi_reset_bin(&flow_info->payload_len_bin);

      for(i=0; i<MAX_NUM_TLS_APPL_BLOCKS; i++) {
        if(flow_info->ndpi_flow->l4.tcp.tls.tls_application_blocks_len[i] != 0) {
          ndpi_inc_bin(&flow_info->payload_len_bin,
                       plen2slot(flow_info->ndpi_flow->l4.tcp.tls.tls_application_blocks_len[i]), 1);
        }
      }
    }
  }