} else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS) || is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC)) {
  if(flow_info->ndpi_flow->tls.ssl_version!= NDPI_SSL_UNKNOWN) {
    ndpi_snprintf(flow_info->tls.ssl_version, sizeof(flow_info->tls.ssl_version), "%s",
                  ndpi_get_ssl_version_name(flow_info->ndpi_flow->tls.ssl_version));
  }

  if(flow_info->ndpi_flow->tls.server_names!= NULL) {
    u_int i;
    for(i = 0; i < flow_info->ndpi_flow->tls.num_server_names; i++) {
      ndpi_snprintf(flow_info->tls.server_names[i], sizeof(flow_info->tls.server_names[i]), "%s",
                    flow_info->ndpi_flow->tls.server_names[i]);
    }
  }

  if(flow_info->ndpi_flow->tls.certificate_validity_dates!= NULL) {
    u_int i;
    for(i = 0; i < flow_info->ndpi_flow->tls.num_certificate_validity_dates; i++) {
      ndpi_snprintf(flow_info->tls.certificate_validity_dates[i], sizeof(flow_info->tls.certificate_validity_dates[i]), "%s",
                    flow_info->ndpi_flow->tls.certificate_validity_dates[i]);
    }
  }

  if(flow_info->ndpi_flow->tls.ja3_fingerprint!= NULL) {
    ndpi_snprintf(flow_info->tls.ja3_fingerprint, sizeof(flow_info->tls.ja3_fingerprint), "%s",
                  flow_info->ndpi_flow->tls.ja3_fingerprint);
  }

  if(flow_info->ndpi_flow->tls.alpn!= NULL) {
    u_int i;
    for(i = 0; i < flow_info->ndpi_flow->tls.num_alpn; i++) {
      ndpi_snprintf(flow_info->tls.alpn[i], sizeof(flow_info->tls.alpn[i]), "%s",
                    flow_info->ndpi_flow->tls.alpn[i]);
    }
  }

  if(flow_info->ndpi_flow->tls.supported_versions!= NULL) {
    u_int i;
    for(i = 0; i < flow_info->ndpi_flow->tls.num_supported_versions; i++) {
      ndpi_snprintf(flow_info->tls.supported_versions[i], sizeof(flow_info->tls.supported_versions[i]), "%s",
                    ndpi_get_ssl_version_name(flow_info->ndpi_flow->tls.supported_versions[i]));
    }
  }

  if(flow_info->ndpi_flow->tls.alpn && flow_info->ndpi_flow->tls.supported_versions) {
    flow_info->info_type = INFO_TLS;
  } else {
    flow_info->info_type = INFO_TLS_ALPN;
  }

  if(flow_info->detection_completed && (!flow_info->check_extra_packets)) {
    if(workflow->__flow_detected_callback!= NULL)
      workflow->__flow_detected_callback(workflow, flow_info, workflow->__flow_detected_udata);
  }
}