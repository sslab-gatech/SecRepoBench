else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
    if(flow_info->ndpi_flow->protos.ssh.client_signature[0] != '\0')
      flow_info->ssh.client_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_signature);
    if(flow_info->ndpi_flow->protos.ssh.server_signature[0] != '\0')
      flow_info->ssh.server_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_signature);
    if(flow_info->ndpi_flow->protos.ssh.client_hash[0] != '\0')
      flow_info->ssh.client_hash = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_hash);
    if(flow_info->ndpi_flow->protos.ssh.server_hash[0] != '\0')
      flow_info->ssh.server_hash = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_hash);
  }
  else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS) ||
          is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC) ||
          is_ndpi_proto(flow_info, NDPI_PROTOCOL_DOH) ||
          is_ndpi_proto(flow_info, NDPI_PROTOCOL_DOT)) {
    is_quic = is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC);

    flow_info->info_type = is_quic ? INFO_QUIC : INFO_TLS;

    if(flow_info->ndpi_flow->protos.tls.ssl_version[0] != '\0')
      ndpi_snprintf(flow_info->tls.ssl_version, sizeof(flow_info->tls.ssl_version), "%s", flow_info->ndpi_flow->protos.tls.ssl_version);

    if(flow_info->ndpi_flow->protos.tls.server_name[0] != '\0')
      flow_info->tls.server_name = ndpi_strdup(flow_info->ndpi_flow->protos.tls.server_name);

    if(flow_info->ndpi_flow->protos.tls.cert_valid_not_before[0] != '\0')
      flow_info->tls.cert_valid_not_before = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_valid_not_before);

    if(flow_info->ndpi_flow->protos.tls.cert_valid_not_after[0] != '\0')
      flow_info->tls.cert_valid_not_after = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_valid_not_after);

    if(flow_info->ndpi_flow->protos.tls.cert_serial[0] != '\0')
      flow_info->tls.cert_serial = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_serial);

    if(flow_info->ndpi_flow->protos.tls.cert_issuer[0] != '\0')
      flow_info->tls.cert_issuer = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_issuer);

    if(flow_info->ndpi_flow->protos.tls.cert_subject[0] != '\0')
      flow_info->tls.cert_subject = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_subject);

    if(flow_info->ndpi_flow->protos.tls.cert_alt_subject[0] != '\0')
      flow_info->tls.cert_alt_subject = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_alt_subject);

    if(flow_info->ndpi_flow->protos.tls.ja3_hash[0] != '\0')
      flow_info->tls.ja3_hash = ndpi_strdup(flow_info->ndpi_flow->protos.tls.ja3_hash);

    if(flow_info->ndpi_flow->protos.tls.ja3_string[0] != '\0')
      flow_info->tls.ja3_string = ndpi_strdup(flow_info->ndpi_flow->protos.tls.ja3_string);

    if(flow_info->ndpi_flow->protos.tls.ja3s_hash[0] != '\0')
      flow_info->tls.ja3s_hash = ndpi_strdup(flow_info->ndpi_flow->protos.tls.ja3s_hash);

    if(flow_info->ndpi_flow->protos.tls.ja3s_string[0] != '\0')
      flow_info->tls.ja3s_string = ndpi_strdup(flow_info->ndpi_flow->protos.tls.ja3s_string);

    if(flow_info->ndpi_flow->protos.tls.alpn[0] != '\0')
      flow_info->tls.alpn = ndpi_strdup(flow_info->ndpi_flow->protos.tls.alpn);

    if(flow_info->ndpi_flow->protos.tls.supported_versions[0] != '\0')
      flow_info->tls.supported_versions = ndpi_strdup(flow_info->ndpi_flow->protos.tls.supported_versions);

    if(flow_info->ndpi_flow->protos.tls.sni[0] != '\0')
      flow_info->tls.sni = ndpi_strdup(flow_info->ndpi_flow->protos.tls.sni);

    if(flow_info->ndpi_flow->protos.tls.fingerprint[0] != '\0')
      flow_info->tls.fingerprint = ndpi_strdup(flow_info->ndpi_flow->protos.tls.fingerprint);

    if(flow_info->ndpi_flow->protos.tls.fingerprint_str[0] != '\0')
      flow_info->tls.fingerprint_str = ndpi_strdup(flow_info->ndpi_flow->protos.tls.fingerprint_str);

    if(flow_info->ndpi_flow->protos.tls.cert_signature[0] != '\0')
      flow_info->tls.cert_signature = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_signature);

    if(flow_info->ndpi_flow->protos.tls.cert_pubkey[0] != '\0')
      flow_info->tls.cert_pubkey = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_pubkey);

    if(flow_info->ndpi_flow->protos.tls.cert_pubkey_type[0] != '\0')
      flow_info->tls.cert_pubkey_type = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_pubkey_type);

    if(flow_info->ndpi_flow->protos.tls.cert_pubkey_bits[0] != '\0')
      flow_info->tls.cert_pubkey_bits = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_pubkey_bits);

    if(flow_info->ndpi_flow->protos.tls.cert_curve[0] != '\0')
      flow_info->tls.cert_curve = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_curve);

    if(flow_info->ndpi_flow->protos.tls.cert_sig_alg[0] != '\0')
      flow_info->tls.cert_sig_alg = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_sig_alg);

    if(flow_info->ndpi_flow->protos.tls.cert_key_alg[0] != '\0')
      flow_info->tls.cert_key_alg = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_key_alg);

    if(flow_info->ndpi_flow->protos.tls.cert_issuer_cn[0] != '\0')
      flow_info->tls.cert_issuer_cn = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_issuer_cn);

    if(flow_info->ndpi_flow->protos.tls.cert_subject_cn[0] != '\0')
      flow_info->tls.cert_subject_cn = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_subject_cn);

    if(flow_info->ndpi_flow->protos.tls.cert_issuer_org[0] != '\0')
      flow_info->tls.cert_issuer_org = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_issuer_org);

    if(flow_info->ndpi_flow->protos.tls.cert_subject_org[0] != '\0')
      flow_info->tls.cert_subject_org = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_subject_org);

    if(flow_info->ndpi_flow->protos.tls.cert_issuer_country[0] != '\0')
      flow_info->tls.cert_issuer_country = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_issuer_country);

    if(flow_info->ndpi_flow->protos.tls.cert_subject_country[0] != '\0')
      flow_info->tls.cert_subject_country = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_subject_country);

    if(flow_info->ndpi_flow->protos.tls.cert_issuer_state[0] != '\0')
      flow_info->tls.cert_issuer_state = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_issuer_state);

    if(flow_info->ndpi_flow->protos.tls.cert_subject_state[0] != '\0')
      flow_info->tls.cert_subject_state = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_subject_state);

    if(flow_info->ndpi_flow->protos.tls.cert_issuer_locality[0] != '\0')
      flow_info->tls.cert_issuer_locality = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_issuer_locality);

    if(flow_info->ndpi_flow->protos.tls.cert_subject_locality[0] != '\0')
      flow_info->tls.cert_subject_locality = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_subject_locality);

    if(flow_info->ndpi_flow->protos.tls.cert_issuer_email[0] != '\0')
      flow_info->tls.cert_issuer_email = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_issuer_email);

    if(flow_info->ndpi_flow->protos.tls.cert_subject_email[0] != '\0')
      flow_info->tls.cert_subject_email = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_subject_email);

    if(flow_info->ndpi_flow->protos.tls.cert_issuer_uri[0] != '\0')
      flow_info->tls.cert_issuer_uri = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_issuer_uri);

    if(flow_info->ndpi_flow->protos.tls.cert_subject_uri[0] != '\0')
      flow_info->tls.cert_subject_uri = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_subject_uri);

    if(flow_info->ndpi_flow->protos.tls.cert_issuer_dn[0] != '\0')
      flow_info->tls.cert_issuer_dn = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_issuer_dn);

    if(flow_info->ndpi_flow->protos.tls.cert_subject_dn[0] != '\0')
      flow_info->tls.cert_subject_dn = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_subject_dn);

    if(flow_info->ndpi_flow->protos.tls.cert_issuer_serial[0] != '\0')
      flow_info->tls.cert_issuer_serial = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_issuer_serial);

    if(flow_info->ndpi_flow->protos.tls.cert_subject_serial[0] != '\0')
      flow_info->tls.cert_subject_serial = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_subject_serial);

    if(flow_info->ndpi_flow->protos.tls.cert_issuer_dn_hash[0] != '\0')
      flow_info->tls.cert_issuer_dn_hash = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_issuer_dn_hash);

    if(flow_info->ndpi_flow->protos.tls.cert_subject_dn_hash[0] != '\0')
      flow_info->tls.cert_subject_dn_hash = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_subject_dn_hash);

    if(flow_info->ndpi_flow->protos.tls.cert_issuer_fingerprint[0] != '\0')
      flow_info->tls.cert_issuer_fingerprint = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_issuer_fingerprint);

    if(flow_info->ndpi_flow->protos.tls.cert_subject_fingerprint[0] != '\0')
      flow_info->tls.cert_subject_fingerprint = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_subject_fingerprint);

    if(flow_info->ndpi_flow->protos.tls.cert_issuer_pem[0] != '\0')
      flow_info->tls.cert_issuer_pem = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_issuer_pem);

    if(flow_info->ndpi_flow->protos.tls.cert_subject_pem[0] != '\0')
      flow_info->tls.cert_subject_pem = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_subject_pem);

    if(flow_info->ndpi_flow->protos.tls.cert_chain[0] != '\0')
      flow_info->tls.cert_chain = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_chain);

    if(flow_info->ndpi_flow->protos.tls.cert_chain_pem[0] != '\0')
      flow_info->tls.cert_chain_pem = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_chain_pem);

    if(flow_info->ndpi_flow->protos.tls.cert_chain_fingerprint[0] != '\0')
      flow_info->tls.cert_chain_fingerprint = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_chain_fingerprint);

    if(flow_info->ndpi_flow->protos.tls.cert_chain_hash[0] != '\0')
      flow_info->tls.cert_chain_hash = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_chain_hash);

    if(flow_info->ndpi_flow->protos.tls.cert_chain_hash_alg[0] != '\0')
      flow_info->tls.cert_chain_hash_alg = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cert_chain_hash_alg);

    if(flow_info->ndpi_flow->protos.tls.cert_chain_hash_len[0] != '\0')
      flow_info->tls.cert_chain_hash_len = n