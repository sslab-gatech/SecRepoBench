else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
  if(flow_info->ndpi_flow->protos.ssh.client_signature != NULL)
    flow_info->ssh_client_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_signature);
  if(flow_info->ndpi_flow->protos.ssh.server_signature != NULL)
    flow_info->ssh_server_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_signature);
  if(flow_info->ndpi_flow->protos.ssh.hassh_client[0] != '\0')
    flow_info->ssh_hassh_client = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.hassh_client);
  if(flow_info->ndpi_flow->protos.ssh.hassh_server[0] != '\0')
    flow_info->ssh_hassh_server = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.hassh_server);
} else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS) 
          || is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC)
          || is_ndpi_proto(flow_info, NDPI_PROTOCOL_DTLS)
          || is_ndpi_proto(flow_info, NDPI_PROTOCOL_MAIL_SMTPS)
          || is_ndpi_proto(flow_info, NDPI_PROTOCOL_MAIL_IMAPS)
          || is_ndpi_proto(flow_info, NDPI_PROTOCOL_MAIL_POPS)) {
  
  if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC))
    is_quic = 1;
  
  flow_info->tls_quic.ssl_version = flow_info->ndpi_flow->protos.tls_quic.ssl_version;
  flow_info->tls_quic.notBefore = flow_info->ndpi_flow->protos.tls_quic.notBefore;
  flow_info->tls_quic.notAfter = flow_info->ndpi_flow->protos.tls_quic.notAfter;
  
  if(flow_info->ndpi_flow->protos.tls_quic.server_names[0] != '\0')
    flow_info->tls_quic.server_names = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.server_names);
  
  if(flow_info->ndpi_flow->protos.tls_quic.issuerDN != NULL)
    flow_info->tls_quic.issuerDN = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.issuerDN);
  
  if(flow_info->ndpi_flow->protos.tls_quic.subjectDN != NULL)
    flow_info->tls_quic.subjectDN = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.subjectDN);
  
  if(flow_info->ndpi_flow->protos.tls_quic.ja3_client[0] != '\0')
    flow_info->tls_quic.ja3_client = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.ja3_client);
  
  if(flow_info->ndpi_flow->protos.tls_quic.ja3_server[0] != '\0')
    flow_info->tls_quic.ja3_server = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.ja3_server);
  
  if(flow_info->ndpi_flow->protos.tls_quic.ja4_client[0] != '\0')
    flow_info->tls_quic.ja4_client = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.ja4_client);
  
  if(flow_info->ndpi_flow->protos.tls_quic.ja4_server[0] != '\0')
    flow_info->tls_quic.ja4_server = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.ja4_server);
  
  if(flow_info->ndpi_flow->protos.tls_quic.tls_supported_versions != NULL)
    flow_info->tls_quic.tls_supported_versions = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.tls_supported_versions);
  
  if(flow_info->ndpi_flow->protos.tls_quic.alpn != NULL) {
    flow_info->tls_quic.alpn = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.alpn);
    flow_info->info_type = INFO_TLS_QUIC;
    ndpi_snprintf(flow_info->info, sizeof(flow_info->info), "%s", flow_info->ndpi_flow->protos.tls_quic.alpn);
  }
  
  if(flow_info->ndpi_flow->protos.tls_quic.tls_supported_versions != NULL)
    flow_info->info_type = INFO_TLS_QUIC;
  
  if(is_quic) {
    /* Reset payload */
    for(i=0; i<16; i++) flow_info->entropy->payload_len_count[i] = 0;
    
    if(flow_info->entropy && flow_info->entropy->payload_len_count_direction[0] > 0) {
      u_int32_t v;
      
      flow_info->entropy->payload_len_entropy_direction[0] = 0.0;
      
      for(i=0; i<16; i++) {
        v = flow_info->entropy->payload_len_count_direction[0];
        if(v > 0) {
          float tmp = (float)flow_info->entropy->packet_len_count_direction[0][i]/(float)v;
          
          tmp = tmp * log2f(tmp);
          flow_info->entropy->payload_len_entropy_direction[0] += -tmp;
        }
      }
    }
    
    if(flow_info->entropy && flow_info->entropy->payload_len_count_direction[1] > 0) {
      u_int32_t v;
      
      flow_info->entropy->payload_len_entropy_direction[1] = 0.0;
      
      for(i=0; i<16; i++) {
        v = flow_info->entropy->payload_len_count_direction[1];
        if(v > 0) {
          float tmp = (float)flow_info->entropy->packet_len_count_direction[1][i]/(float)v;
          
          tmp = tmp * log2f(tmp);
          flow_info->entropy->payload_len_entropy_direction[1] += -tmp;
        }
      }
    }
  }
}