if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
    // SSH
    ndpi_snprintf(flow_info->ssh.client_signature,
                  sizeof(flow_info->ssh.client_signature), "%s",
                  flow_info->ndpi_flow->protos.ssh.client_signature);
    ndpi_snprintf(flow_info->ssh.server_signature,
                  sizeof(flow_info->ssh.server_signature), "%s",
                  flow_info->ndpi_flow->protos.ssh.server_signature);

    for (i = 0; i < sizeof(flow_info->ssh.client_hash); i++) {
      sprintf(&flow_info->ssh.client_hash[i * 2], "%02x",
              flow_info->ndpi_flow->protos.ssh.client_hash[i]);
    }
    flow_info->ssh.client_hash[i * 2] = '\0';

    for (i = 0; i < sizeof(flow_info->ssh.server_hash); i++) {
      sprintf(&flow_info->ssh.server_hash[i * 2], "%02x",
              flow_info->ndpi_flow->protos.ssh.server_hash[i]);
    }

    flow_info->ssh.server_hash[i * 2] = '\0';
  } else if (is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS) ||
             (flow_info->detected_protocol.master_protocol ==
              NDPI_PROTOCOL_TLS)) {
    // TLS/QUIC

    flow_info->tls.tls_version = flow_info->ndpi_flow->protos.tls.version;

    if (flow_info->ndpi_flow->protos.tls.server_names) {
      flow_info->ssh_tls.server_names =
          ndpi_strdup(flow_info->ndpi_flow->protos.tls.server_names);
    }

    flow_info->tls.not_before = flow_info->ndpi_flow->protos.tls.not_before;
    flow_info->tls.not_after = flow_info->ndpi_flow->protos.tls.not_after;

    ndpi_snprintf(flow_info->tls.ja3_fingerprint,
                  sizeof(flow_info->tls.ja3_fingerprint), "%s",
                  flow_info->ndpi_flow->protos.tls.ja3_fingerprint);

    ndpi_snprintf(flow_info->tls.sni, sizeof(flow_info->tls.sni), "%s",
                  flow_info->ndpi_flow->protos.tls.sni);

    ndpi_snprintf(flow_info->tls.subject, sizeof(flow_info->tls.subject), "%s",
                  flow_info->ndpi_flow->protos.tls.subject);

    ndpi_snprintf(flow_info->tls.issuer, sizeof(flow_info->tls.issuer), "%s",
                  flow_info->ndpi_flow->protos.tls.issuer);

    if (flow_info->ndpi_flow->protos.tls.tls_alpn) {
      flow_info->ssh_tls.tls_alpn =
          ndpi_strdup(flow_info->ndpi_flow->protos.tls.tls_alpn);
    }

    if (flow_info->ndpi_flow->protos.tls.tls_supported_versions) {
      flow_info->ssh_tls.tls_supported_versions =
          ndpi_strdup(flow_info->ndpi_flow->protos.tls.tls_supported_versions);
    }

    if (flow_info->ndpi_flow->protos.tls.tls_issuerDN) {
      flow_info->ssh_tls.tls_issuerDN =
          ndpi_strdup(flow_info->ndpi_flow->protos.tls.tls_issuerDN);
    }

    if (flow_info->ndpi_flow->protos.tls.tls_subjectDN) {
      flow_info->ssh_tls.tls_subjectDN =
          ndpi_strdup(flow_info->ndpi_flow->protos.tls.tls_subjectDN);
    }

    if (flow_info->ndpi_flow->protos.tls.encrypted_sni.esni) {
      flow_info->ssh_tls.encrypted_sni.esni =
          ndpi_strdup(flow_info->ndpi_flow->protos.tls.encrypted_sni.esni);
      flow_info->ssh_tls.encrypted_sni.checksum =
          flow_info->ndpi_flow->protos.tls.encrypted_sni.checksum;
      flow_info->ssh_tls.encrypted_sni.valid =
          flow_info->ndpi_flow->protos.tls.encrypted_sni.valid;
    }

    if (flow_info->ndpi_flow->protos.tls.quic.version != 0) {
      is_quic = 1;
      flow_info->tls.quic_version = flow_info->ndpi_flow->protos.tls.quic.version;
      ndpi_snprintf(flow_info->tls.quic_ja3_fingerprint,
                    sizeof(flow_info->tls.quic_ja3_fingerprint), "%s",
                    flow_info->ndpi_flow->protos.tls.quic.ja3_fingerprint);
    }

    if (flow_info->ssh_tls.tls_alpn && flow_info->ssh_tls.tls_supported_versions)
      flow_info->info_type = INFO_TLS_ALPN;
  }