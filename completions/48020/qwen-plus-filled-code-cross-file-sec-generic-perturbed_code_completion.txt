if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
  flow_info->info_type = INFO_SSH;
  ndpi_snprintf(flow_info->ssh.client_signature,
                sizeof(flow_info->ssh.client_signature),
                "%s", flow_info->ndpi_flow->protos.ssh.client_signature);
  ndpi_snprintf(flow_info->ssh.server_signature,
                sizeof(flow_info->ssh.server_signature),
                "%s", flow_info->ndpi_flow->protos.ssh.server_signature);
  ndpi_snprintf(flow_info->ssh.client_hash,
                sizeof(flow_info->ssh.client_hash),
                "%s", flow_info->ndpi_flow->protos.ssh.client_hash);
  ndpi_snprintf(flow_info->ssh.server_hash,
                sizeof(flow_info->ssh.server_hash),
                "%s", flow_info->ndpi_flow->protos.ssh.server_hash);
}

if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS) || is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC)) {
  if (is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC)) {
    is_quic = 1;
  }

  flow_info->info_type = is_quic ? INFO_QUIC : INFO_TLS;

  if(flow_info->ndpi_flow->protos.tls.version[0] != '\0') {
    ndpi_snprintf(flow_info->tls.version,
                  sizeof(flow_info->tls.version),
                  "%s", flow_info->ndpi_flow->protos.tls.version);
  }

  if(flow_info->ndpi_flow->protos.tls.server_name[0] != '\0') {
    ndpi_snprintf(flow_info->tls.server_name,
                  sizeof(flow_info->tls.server_name),
                  "%s", flow_info->ndpi_flow->protos.tls.server_name);
  }

  if(flow_info->ndpi_flow->protos.tls.certificate_not_before[0] != '\0') {
    ndpi_snprintf(flow_info->tls.certificate_not_before,
                  sizeof(flow_info->tls.certificate_not_before),
                  "%s", flow_info->ndpi_flow->protos.tls.certificate_not_before);
  }

  if(flow_info->ndpi_flow->protos.tls.certificate_not_after[0] != '\0') {
    ndpi_snprintf(flow_info->tls.certificate_not_after,
                  sizeof(flow_info->tls.certificate_not_after),
                  "%s", flow_info->ndpi_flow->protos.tls.certificate_not_after);
  }

  if(flow_info->ndpi_flow->protos.tls.ja3[0] != '\0') {
    ndpi_snprintf(flow_info->tls.ja3,
                  sizeof(flow_info->tls.ja3),
                  "%s", flow_info->ndpi_flow->protos.tls.ja3);
  }

  if(flow_info->ndpi_flow->protos.tls.alpn[0] != '\0') {
    ndpi_snprintf(flow_info->tls.alpn,
                  sizeof(flow_info->tls.alpn),
                  "%s", flow_info->ndpi_flow->protos.tls.alpn);
  }

  if(flow_info->ndpi_flow->protos.quic.supported_versions[0] != '\0' && is_quic) {
    ndpi_snprintf(flow_info->quic.supported_versions,
                  sizeof(flow_info->quic.supported_versions),
                  "%s", flow_info->ndpi_flow->protos.quic.supported_versions);
  }
}