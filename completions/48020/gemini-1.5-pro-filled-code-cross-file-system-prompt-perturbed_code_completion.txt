if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
    if(flow_info->ndpi_flow->protos.ssh.client_signature[0] != '\0')
      flow_info->ssh.client_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_signature);
    if(flow_info->ndpi_flow->protos.ssh.server_signature[0] != '\0')
      flow_info->ssh.server_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_signature);

    memcpy(flow_info->ssh.client_hash, flow_info->ndpi_flow->protos.ssh.client_hash,
           sizeof(flow_info->ssh.client_hash));
    memcpy(flow_info->ssh.server_hash, flow_info->ndpi_flow->protos.ssh.server_hash,
           sizeof(flow_info->ssh.server_hash));
  } else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS) ||
	    is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC) ||
            is_ndpi_proto(flow_info, NDPI_PROTOCOL_DTLS)) {
    is_quic = is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC);

    flow_info->tls.ssl_version = flow_info->ndpi_flow->tls.ssl_version;
    if(flow_info->ndpi_flow->tls.server_name[0] != '\0') {
      flow_info->tls.server_name = ndpi_strdup(flow_info->ndpi_flow->tls.server_name);
    }

    flow_info->tls.not_before = flow_info->ndpi_flow->tls.not_before;
    flow_info->tls.not_after = flow_info->ndpi_flow->tls.not_after;

    if(flow_info->ndpi_flow->tls.ja3_fingerprint[0] != '\0')
      flow_info->tls.ja3_fingerprint = ndpi_strdup(flow_info->ndpi_flow->tls.ja3_fingerprint);

    memcpy(flow_info->tls.client_random, flow_info->ndpi_flow->tls.client_random,
	   sizeof(flow_info->tls.client_random));
    memcpy(flow_info->tls.master_key, flow_info->ndpi_flow->tls.master_key,
	   sizeof(flow_info->tls.master_key));

    if(flow_info->ndpi_flow->tls.alpn[0] != '\0') {
      flow_info->info_type = INFO_TLS_ALPN;
      flow_info->tls.alpn = ndpi_strdup(flow_info->ndpi_flow->tls.alpn);
    }

    if(flow_info->ndpi_flow->tls.supported_versions[0] != '\0')
      flow_info->tls.supported_versions = ndpi_strdup(flow_info->ndpi_flow->tls.supported_versions);

    if(flow_info->ndpi_flow->tls.ja3_plus_fingerprint[0] != '\0')
      flow_info->tls.ja3_plus_fingerprint = ndpi_strdup(flow_info->ndpi_flow->tls.ja3_plus_fingerprint);

    if(flow_info->ndpi_flow->tls.sni_fingerprint[0] != '\0')
      flow_info->tls.sni_fingerprint = ndpi_strdup(flow_info->ndpi_flow->tls.sni_fingerprint);

    if(flow_info->ndpi_flow->tls.handshake_failure_reason > 0)
      flow_info->tls.handshake_failure_reason = flow_info->ndpi_flow->tls.handshake_failure_reason;

#if 0
    if(is_quic) {
      ndpi_reset_tls_payload_length_distribution(flow_info->ndpi_flow);
      ndpi_update_tls_payload_length_distribution(flow_info->ndpi_flow,
						 flow_info->ndpi_flow->tls.tls_record_len,
						 flow_info->ndpi_flow->tls.tls_record_type);
    }
#endif
  }