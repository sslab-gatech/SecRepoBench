else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
  if(flow_info->ndpi_flow->protos.ssh.client_signature[0] != '\0')
    flow_info->ssh.client_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_signature);
  if(flow_info->ndpi_flow->protos.ssh.server_signature[0] != '\0')
    flow_info->ssh.server_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_signature);
  if(flow_info->ndpi_flow->protos.ssh.hassh_client[0] != '\0')
    flow_info->ssh.hassh_client = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.hassh_client);
  if(flow_info->ndpi_flow->protos.ssh.hassh_server[0] != '\0')
    flow_info->ssh.hassh_server = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.hassh_server);
} 
else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS) || 
        is_ndpi_proto(flow_info, NDPI_PROTOCOL_DTLS) ||
        is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC) ||
        is_ndpi_proto(flow_info, NDPI_PROTOCOL_MAIL_SMTPS) ||
        is_ndpi_proto(flow_info, NDPI_PROTOCOL_MAIL_POPS) ||
        is_ndpi_proto(flow_info, NDPI_PROTOCOL_MAIL_IMAPS)) {
  
  is_quic = is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC);

  flow_info->tls_quic.ssl_version = flow_info->ndpi_flow->protos.tls_quic.ssl_version;
  flow_info->tls_quic.ja3_client = flow_info->ndpi_flow->protos.tls_quic.ja3_client ?
    ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.ja3_client) : NULL;
  flow_info->tls_quic.ja3_server = flow_info->ndpi_flow->protos.tls_quic.ja3_server ?
    ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.ja3_server) : NULL;
  flow_info->tls_quic.server_unsafe_cipher = flow_info->ndpi_flow->protos.tls_quic.server_unsafe_cipher;
  flow_info->tls_quic.server_cipher = flow_info->ndpi_flow->protos.tls_quic.server_cipher;
  
  if(flow_info->ndpi_flow->protos.tls_quic.client_requested_server_name[0] != '\0')
    ndpi_snprintf(flow_info->tls_quic.client_requested_server_name, 
                 sizeof(flow_info->tls_quic.client_requested_server_name), "%s",
                 flow_info->ndpi_flow->protos.tls_quic.client_requested_server_name);

  if(flow_info->ndpi_flow->protos.tls_quic.server_names)
    flow_info->tls_quic.server_names = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.server_names);

  flow_info->tls_quic.notBefore = flow_info->ndpi_flow->protos.tls_quic.notBefore;
  flow_info->tls_quic.notAfter = flow_info->ndpi_flow->protos.tls_quic.notAfter;

  if(flow_info->ndpi_flow->protos.tls_quic.issuerDN)
    flow_info->tls_quic.issuerDN = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.issuerDN);
  
  if(flow_info->ndpi_flow->protos.tls_quic.subjectDN)
    flow_info->tls_quic.subjectDN = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.subjectDN);
  
  memcpy(flow_info->tls_quic.sha1_certificate_fingerprint,
         flow_info->ndpi_flow->protos.tls_quic.sha1_certificate_fingerprint, 20);

  if(flow_info->ndpi_flow->protos.tls_quic.alpn)
    flow_info->tls_quic.alpn = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.alpn);
  
  if(flow_info->ndpi_flow->protos.tls_quic.tls_supported_versions)
    flow_info->tls_quic.tls_supported_versions = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.tls_supported_versions);

  if(flow_info->tls_quic.alpn || flow_info->tls_quic.tls_supported_versions)
    flow_info->info_type = INFO_TLS_QUIC;

  if(!is_quic && flow_info->ndpi_flow->protos.tls_quic.ssl_version) {
    /* resetting standard block length as this is not standard anymore with this information */
    ndpi_reset_bin(&flow_info->payload_len_bin);
    
    /* Creating instance of payload length distribution based on TLS block lengths */
    u_int i, n = 0, cumulative_len = 0;
    char str[1024];
    
    n = ndpi_min(flow_info->ndpi_flow->l4.tcp.tls.num_tls_blocks, 24);
    
    for(i=0; i<n; i++) {
      if(flow_info->ndpi_flow->l4.tcp.tls.tls_application_blocks_len[i] == 0) break;
      
      if(i > 0) cumulative_len += flow_info->ndpi_flow->l4.tcp.tls.tls_application_blocks_len[i-1];
      
      ndpi_inc_bin(&flow_info->payload_len_bin, 
                  plen2slot(flow_info->ndpi_flow->l4.tcp.tls.tls_application_blocks_len[i]));
    }
  }
}