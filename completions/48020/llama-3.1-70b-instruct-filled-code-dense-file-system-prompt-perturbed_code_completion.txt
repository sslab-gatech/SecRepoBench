0? ":" : ""), flow->protos.tls_quic.sha1_certificate_fingerprint[i]);
	    if(rc < 0 || rc >= (int)(sizeof(buf)-off)) {
	      ndpi_serialize_string_string(serializer, "sha1_certificate_fingerprint", buf);
	      break;
	    }
	    off += rc;
	  }
	  ndpi_serialize_string_string(serializer, "sha1_certificate_fingerprint", buf);
	}

	if(flow->protos.tls_quic.sha256_certificate_fingerprint[0]!= '\0') {
	  for(i=0, off=0; i<32; i++) {
	    int rc = ndpi_snprintf(&buf[off], sizeof(buf)-off,"%s%02X", (i > 0? ":" : ""), flow->protos.tls_quic.sha256_certificate_fingerprint[i]);
	    if(rc < 0 || rc >= (int)(sizeof(buf)-off)) {
	      ndpi_serialize_string_string(serializer, "sha256_certificate_fingerprint", buf);
	      break;
	    }
	    off += rc;
	  }
	  ndpi_serialize_string_string(serializer, "sha256_certificate_fingerprint", buf);
	}

	if(flow->protos.tls_quic.encrypted_sni.esni)
	  ndpi_serialize_string_string(serializer, "encrypted_sni", flow->protos.tls_quic.encrypted_sni.esni);

	ndpi_serialize_end_of_block(serializer);
      }
    }
    break;

  case NDPI_PROTOCOL_SMB:
    ndpi_serialize_start_of_block(serializer, "smb");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smb.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smb.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMB2:
    ndpi_serialize_start_of_block(serializer, "smb2");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smb2.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smb2.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV1:
    ndpi_serialize_start_of_block(serializer, "smbv1");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv1.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv1.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV2:
    ndpi_serialize_start_of_block(serializer, "smbv2");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv2.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv2.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3:
    ndpi_serialize_start_of_block(serializer, "smbv3");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11:
    ndpi_serialize_start_of_block(serializer, "smbv3_11");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_11.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_11.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_02:
    ndpi_serialize_start_of_block(serializer, "smbv3_02");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_02.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_02.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_03:
    ndpi_serialize_start_of_block(serializer, "smbv3_03");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_03.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_03.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11_1:
    ndpi_serialize_start_of_block(serializer, "smbv3_11_1");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_11_1.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_11_1.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11_2:
    ndpi_serialize_start_of_block(serializer, "smbv3_11_2");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_11_2.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_11_2.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11_3:
    ndpi_serialize_start_of_block(serializer, "smbv3_11_3");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_11_3.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_11_3.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11_4:
    ndpi_serialize_start_of_block(serializer, "smbv3_11_4");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_11_4.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_11_4.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11_5:
    ndpi_serialize_start_of_block(serializer, "smbv3_11_5");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_11_5.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_11_5.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11_6:
    ndpi_serialize_start_of_block(serializer, "smbv3_11_6");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_11_6.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_11_6.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11_7:
    ndpi_serialize_start_of_block(serializer, "smbv3_11_7");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_11_7.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_11_7.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11_8:
    ndpi_serialize_start_of_block(serializer, "smbv3_11_8");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_11_8.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_11_8.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11_9:
    ndpi_serialize_start_of_block(serializer, "smbv3_11_9");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_11_9.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_11_9.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11_10:
    ndpi_serialize_start_of_block(serializer, "smbv3_11_10");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_11_10.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_11_10.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11_11:
    ndpi_serialize_start_of_block(serializer, "smbv3_11_11");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_11_11.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_11_11.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11_12:
    ndpi_serialize_start_of_block(serializer, "smbv3_11_12");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_11_12.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_11_12.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11_13:
    ndpi_serialize_start_of_block(serializer, "smbv3_11_13");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_11_13.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_11_13.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11_14:
    ndpi_serialize_start_of_block(serializer, "smbv3_11_14");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_11_14.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_11_14.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11_15:
    ndpi_serialize_start_of_block(serializer, "smbv3_11_15");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_11_15.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_11_15.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11_16:
    ndpi_serialize_start_of_block(serializer, "smbv3_11_16");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_11_16.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_11_16.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11_17:
    ndpi_serialize_start_of_block(serializer, "smbv3_11_17");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_11_17.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_11_17.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11_18:
    ndpi_serialize_start_of_block(serializer, "smbv3_11_18");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_11_18.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_11_18.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11_19:
    ndpi_serialize_start_of_block(serializer, "smbv3_11_19");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_11_19.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_11_19.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11_20:
    ndpi_serialize_start_of_block(serializer, "smbv3_11_20");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_11_20.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_11_20.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11_21:
    ndpi_serialize_start_of_block(serializer, "smbv3_11_21");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_11_21.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_11_21.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11_22:
    ndpi_serialize_start_of_block(serializer, "smbv3_11_22");
    ndpi_serialize_string_string(serializer, "username", flow->protos.smbv3_11_22.username);
    ndpi_serialize_string_string(serializer, "password", flow->protos.smbv3_11_22.password);
    ndpi_serialize_end_of_block(serializer);
    break;

  case NDPI_PROTOCOL_SMBV3_11_23:
    ndpi_serialize_start_of_block(serializer, "smbv3_11_23");
    ndpi_serialize_string_string(serializer