// Check if the flow corresponds to the SSH protocol.
// If so, copy SSH-related information, such as client and server signatures,
// and client/server hash data to the flow structure.
if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
    if(flow_info->ndpi_flow->protos.ssh.client_signature[0] != '\0')
        flow_info->ssh.client_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_signature);
    if(flow_info->ndpi_flow->protos.ssh.server_signature[0] != '\0')
        flow_info->ssh.server_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_signature);
    if(flow_info->ndpi_flow->protos.ssh.client_hash[0] != '\0')
        flow_info->ssh.client_hash = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_hash);
    if(flow_info->ndpi_flow->protos.ssh.server_hash[0] != '\0')
        flow_info->ssh.server_hash = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_hash);
}
// Check if the flow corresponds to the TLS protocol or related protocols.
// If the protocol matches, update the flow structure with relevant TLS/QUIC information.
// This includes SSL version, server names, certificate validity dates, and JA3 fingerprints.
else if((flow_info->detected_protocol.master_protocol == NDPI_PROTOCOL_TLS) ||
        (flow_info->detected_protocol.master_protocol == NDPI_PROTOCOL_QUIC) ||
        (flow_info->detected_protocol.master_protocol == NDPI_PROTOCOL_DTLS)) {
    flow_info->info_type = INFO_TLS;
    flow_info->tls.ssl_version = flow_info->ndpi_flow->protos.tls.ssl_version;
    if(flow_info->ndpi_flow->protos.tls.server_names[0] != '\0')
        flow_info->tls.server_names = ndpi_strdup(flow_info->ndpi_flow->protos.tls.server_names);
    flow_info->tls.notBefore = flow_info->ndpi_flow->protos.tls.notBefore;
    flow_info->tls.notAfter = flow_info->ndpi_flow->protos.tls.notAfter;
    if(flow_info->ndpi_flow->protos.tls.ja3_client[0] != '\0')
        flow_info->tls.ja3_client = ndpi_strdup(flow_info->ndpi_flow->protos.tls.ja3_client);
    if(flow_info->ndpi_flow->protos.tls.ja3_server[0] != '\0')
        flow_info->tls.ja3_server = ndpi_strdup(flow_info->ndpi_flow->protos.tls.ja3_server);
    if(flow_info->ndpi_flow->protos.tls.alpn[0] != '\0') {
        flow_info->info_type = INFO_TLS_ALPN;
        flow_info->tls.alpn = ndpi_strdup(flow_info->ndpi_flow->protos.tls.alpn);
    }
    if(flow_info->ndpi_flow->protos.tls.supported_versions[0] != '\0') {
        flow_info->info_type = INFO_TLS_VERSIONS;
        flow_info->tls.supported_versions = ndpi_strdup(flow_info->ndpi_flow->protos.tls.supported_versions);
    }
    if(flow_info->ndpi_flow->protos.tls.cipher_suite[0] != '\0')
        flow_info->tls.cipher_suite = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cipher_suite);
    if(flow_info->ndpi_flow->protos.tls.client_requested_server_name[0] != '\0')
        flow_info->tls.client_requested_server_name = ndpi_strdup(flow_info->ndpi_flow->protos.tls.client_requested_server_name);
    if(flow_info->ndpi_flow->protos.tls.server_server_name[0] != '\0')
        flow_info->tls.server_server_name = ndpi_strdup(flow_info->ndpi_flow->protos.tls.server_server_name);
    if(flow_info->ndpi_flow->protos.tls.client_SNI[0] != '\0')
        flow_info->tls.client_SNI = ndpi_strdup(flow_info->ndpi_flow->protos.tls.client_SNI);
    if(flow_info->ndpi_flow->protos.tls.client_ticket_len > 0) {
        flow_info->tls.client_ticket_len = flow_info->ndpi_flow->protos.tls.client_ticket_len;
        flow_info->tls.client_ticket = ndpi_malloc(flow_info->tls.client_ticket_len);
        memcpy(flow_info->tls.client_ticket, flow_info->ndpi_flow->protos.tls.client_ticket, flow_info->tls.client_ticket_len);
    }
    if(flow_info->ndpi_flow->protos.tls.server_ticket_len > 0) {
        flow_info->tls.server_ticket_len = flow_info->ndpi_flow->protos.tls.server_ticket_len;
        flow_info->tls.server_ticket = ndpi_malloc(flow_info->tls.server_ticket_len);
        memcpy(flow_info->tls.server_ticket, flow_info->ndpi_flow->protos.tls.server_ticket, flow_info->tls.server_ticket_len);
    }
    if(flow_info->ndpi_flow->protos.tls.encrypted_sni_len > 0) {
        flow_info->tls.encrypted_sni_len = flow_info->ndpi_flow->protos.tls.encrypted_sni_len;
        flow_info->tls.encrypted_sni = ndpi_malloc(flow_info->tls.encrypted_sni_len);
        memcpy(flow_info->tls.encrypted_sni, flow_info->ndpi_flow->protos.tls.encrypted_sni, flow_info->tls.encrypted_sni_len);
    }
    if(flow_info->ndpi_flow->protos.tls.esni_len > 0) {
        flow_info->tls.esni_len = flow_info->ndpi_flow->protos.tls.esni_len;
        flow_info->tls.esni = ndpi_malloc(flow_info->tls.esni_len);
        memcpy(flow_info->tls.esni, flow_info->ndpi_flow->protos.tls.esni, flow_info->tls.esni_len);
    }
    if(flow_info->ndpi_flow->protos.tls.client_hello_len > 0) {
        flow_info->tls.client_hello_len = flow_info->ndpi_flow->protos.tls.client_hello_len;
        flow_info->tls.client_hello = ndpi_malloc(flow_info->tls.client_hello_len);
        memcpy(flow_info->tls.client_hello, flow_info->ndpi_flow->protos.tls.client_hello, flow_info->tls.client_hello_len);
    }
    if(flow_info->ndpi_flow->protos.tls.server_hello_len > 0) {
        flow_info->tls.server_hello_len = flow_info->ndpi_flow->protos.tls.server_hello_len;
        flow_info->tls.server_hello = ndpi_malloc(flow_info->tls.server_hello_len);
        memcpy(flow_info->tls.server_hello, flow_info->ndpi_flow->protos.tls.server_hello, flow_info->tls.server_hello_len);
    }
    if(flow_info->ndpi_flow->protos.tls.ja3_version[0] != '\0')
        flow_info->tls.ja3_version = ndpi_strdup(flow_info->ndpi_flow->protos.tls.ja3_version);
    if(flow_info->ndpi_flow->protos.tls.ja3_cipher[0] != '\0')
        flow_info->tls.ja3_cipher = ndpi_strdup(flow_info->ndpi_flow->protos.tls.ja3_cipher);
    if(flow_info->ndpi_flow->protos.tls.ja3_extension[0] != '\0')
        flow_info->tls.ja3_extension = ndpi_strdup(flow_info->ndpi_flow->protos.tls.ja3_extension);
    if(flow_info->ndpi_flow->protos.tls.ja3_elliptic_curves[0] != '\0')
        flow_info->tls.ja3_elliptic_curves = ndpi_strdup(flow_info->ndpi_flow->protos.tls.ja3_elliptic_curves);
    if(flow_info->ndpi_flow->protos.tls.ja3_ec_point_formats[0] != '\0')
        flow_info->tls.ja3_ec_point_formats = ndpi_strdup(flow_info->ndpi_flow->protos.tls.ja3_ec_point_formats);
}