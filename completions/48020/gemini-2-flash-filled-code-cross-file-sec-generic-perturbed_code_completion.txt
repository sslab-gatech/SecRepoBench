if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
    flow_info->info_type = INFO_SSH;
    ndpi_snprintf(flow_info->ssh.client_sig,
                  sizeof(flow_info->ssh.client_sig),
                  "%s", flow_info->ndpi_flow->protos.ssh.client_sig);
    ndpi_snprintf(flow_info->ssh.server_sig,
                  sizeof(flow_info->ssh.server_sig),
                  "%s", flow_info->ndpi_flow->protos.ssh.server_sig);
    ndpi_snprintf(flow_info->ssh.client_hash,
                  sizeof(flow_info->ssh.client_hash),
                  "%s", flow_info->ndpi_flow->protos.ssh.client_hash);
    ndpi_snprintf(flow_info->ssh.server_hash,
                  sizeof(flow_info->ssh.server_hash),
                  "%s", flow_info->ndpi_flow->protos.ssh.server_hash);
  } else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS) ||
            is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSL) ||
            is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC) ||
            is_ndpi_proto(flow_info, NDPI_PROTOCOL_GRE_TLS) ||
            is_ndpi_proto(flow_info, NDPI_PROTOCOL_DTLS)) {
    flow_info->info_type = INFO_TLS;

    flow_info->tls.ssl_version = flow_info->ndpi_flow->tls.ssl_version;

    ndpi_snprintf(flow_info->tls.server_name,
                  sizeof(flow_info->tls.server_name),
                  "%s", flow_info->ndpi_flow->tls.server_name);

    ndpi_snprintf(flow_info->tls.certificate_issuer,
                  sizeof(flow_info->tls.certificate_issuer),
                  "%s", flow_info->ndpi_flow->tls.certificate_issuer);

    ndpi_snprintf(flow_info->tls.certificate_subject,
                  sizeof(flow_info->tls.certificate_subject),
                  "%s", flow_info->ndpi_flow->tls.certificate_subject);

    flow_info->tls.certificate_valid_from = flow_info->ndpi_flow->tls.certificate_valid_from;
    flow_info->tls.certificate_valid_to = flow_info->ndpi_flow->tls.certificate_valid_to;

    ndpi_snprintf(flow_info->tls.alpn,
                  sizeof(flow_info->tls.alpn),
                  "%s", flow_info->ndpi_flow->tls.alpn);

    ndpi_snprintf(flow_info->tls.ja3_digest,
                  sizeof(flow_info->tls.ja3_digest),
                  "%s", flow_info->ndpi_flow->tls.ja3_digest);

    ndpi_snprintf(flow_info->tls.ja3s_digest,
                  sizeof(flow_info->tls.ja3s_digest),
                  "%s", flow_info->ndpi_flow->tls.ja3s_digest);

    ndpi_snprintf(flow_info->tls.supported_versions,
                  sizeof(flow_info->tls.supported_versions),
                  "%s", flow_info->ndpi_flow->tls.supported_versions);

    flow_info->tls.quic = flow_info->ndpi_flow->tls.quic;

    if(flow_info->ndpi_flow->tls.alpn[0] != '\0' && flow_info->ndpi_flow->tls.supported_versions[0] != '\0')
      flow_info->info_type = INFO_TLS_ALPN;

#ifdef NDPI_RESET_PAYLOAD_LENGTH_DISTRIBUTION_ON_TLS_BLOCK
    if(flow_info->ndpi_flow->tls.ssl_version != 0) {
      ndpi_reset_payload_length_distribution(flow_info->payload_length_distribution);
      flow_info->update_payload_length_distribution = 1;
    }
#endif
  }