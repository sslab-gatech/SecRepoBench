else if (is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
  flow_info->info_type = INFO_SSH;
  /* Copy SSH client version if available */
  if (flow_info->ndpi_flow->ssh.client_version[0] != '\0')
    ndpi_snprintf(flow_info->ssh.client_version, sizeof(flow_info->ssh.client_version),
                  "%s", flow_info->ndpi_flow->ssh.client_version);
  /* Copy SSH server version if available */
  if (flow_info->ndpi_flow->ssh.server_version[0] != '\0')
    ndpi_snprintf(flow_info->ssh.server_version, sizeof(flow_info->ssh.server_version),
                  "%s", flow_info->ndpi_flow->ssh.server_version);
  /* Copy SSH client hash data if present */
  if (flow_info->ndpi_flow->ssh.client_hash_len > 0) {
    flow_info->ssh.client_hash = ndpi_malloc(flow_info->ndpi_flow->ssh.client_hash_len + 1);
    if (flow_info->ssh.client_hash != NULL) {
      memcpy(flow_info->ssh.client_hash,
             flow_info->ndpi_flow->ssh.client_hash,
             flow_info->ndpi_flow->ssh.client_hash_len);
      flow_info->ssh.client_hash[flow_info->ndpi_flow->ssh.client_hash_len] = '\0';
    }
  }
  /* Copy SSH server hash data if present */
  if (flow_info->ndpi_flow->ssh.server_hash_len > 0) {
    flow_info->ssh.server_hash = ndpi_malloc(flow_info->ndpi_flow->ssh.server_hash_len + 1);
    if (flow_info->ssh.server_hash != NULL) {
      memcpy(flow_info->ssh.server_hash,
             flow_info->ndpi_flow->ssh.server_hash,
             flow_info->ndpi_flow->ssh.server_hash_len);
      flow_info->ssh.server_hash[flow_info->ndpi_flow->ssh.server_hash_len] = '\0';
    }
  }
} else if (is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS) ||
           is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC)) {
  flow_info->info_type = INFO_TLS;
  /* Copy SSL/TLS version */
  ndpi_snprintf(flow_info->tls.ssl_version, sizeof(flow_info->tls.ssl_version),
                "%s", flow_info->ndpi_flow->tls.ssl_version);
  /* Copy server name if available */
  ndpi_snprintf(flow_info->tls.server_name, sizeof(flow_info->tls.server_name),
                "%s", flow_info->ndpi_flow->tls.server_name);
  /* Copy ALPN information if present */
  ndpi_snprintf(flow_info->tls.alpn, sizeof(flow_info->tls.alpn),
                "%s", flow_info->ndpi_flow->tls.alpn ? flow_info->ndpi_flow->tls.alpn : "");
  /* Copy certificate validity dates */
  if (flow_info->ndpi_flow->tls.cert_valid_from[0] != '\0')
    ndpi_snprintf(flow_info->tls.cert_valid_from, sizeof(flow_info->tls.cert_valid_from),
                  "%s", flow_info->ndpi_flow->tls.cert_valid_from);
  if (flow_info->ndpi_flow->tls.cert_valid_to[0] != '\0')
    ndpi_snprintf(flow_info->tls.cert_valid_to, sizeof(flow_info->tls.cert_valid_to),
                  "%s", flow_info->ndpi_flow->tls.cert_valid_to);
  /* Copy JA3 fingerprint if available */
  if (flow_info->ndpi_flow->tls.ja3_fingerprint[0] != '\0')
    flow_info->tls.ja3_fingerprint = ndpi_strdup(flow_info->ndpi_flow->tls.ja3_fingerprint);
  /* Update TLS block lengths distribution if TLS blocks are present */
  if (flow_info->ndpi_flow->tls.tls_block_count > 0) {
    flow_info->tls.tls_block_count = flow_info->ndpi_flow->tls.tls_block_count;
    memcpy(flow_info->tls.tls_block_lengths,
           flow_info->ndpi_flow->tls.tls_block_lengths,
           sizeof(flow_info->tls.tls_block_lengths));
  }
}