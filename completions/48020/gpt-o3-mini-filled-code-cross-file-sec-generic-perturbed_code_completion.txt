else if (is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
  flow_info->info_type = INFO_SSH;
  if (flow_info->ndpi_flow->protos.ssh.client_version[0])
    ndpi_snprintf(flow_info->ssh.client_version, sizeof(flow_info->ssh.client_version), "%s", flow_info->ndpi_flow->protos.ssh.client_version);
  if (flow_info->ndpi_flow->protos.ssh.server_version[0])
    ndpi_snprintf(flow_info->ssh.server_version, sizeof(flow_info->ssh.server_version), "%s", flow_info->ndpi_flow->protos.ssh.server_version);
  if (flow_info->ndpi_flow->protos.ssh.client_kexhash[0])
    ndpi_snprintf(flow_info->ssh.client_kexhash, sizeof(flow_info->ssh.client_kexhash), "%s", flow_info->ndpi_flow->protos.ssh.client_kexhash);
  if (flow_info->ndpi_flow->protos.ssh.server_kexhash[0])
    ndpi_snprintf(flow_info->ssh.server_kexhash, sizeof(flow_info->ssh.server_kexhash), "%s", flow_info->ndpi_flow->protos.ssh.server_kexhash);
} else if (is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS) || is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC)) {
  flow_info->info_type = INFO_TLS;
  if (flow_info->ndpi_flow->tls.ssl_version[0])
    ndpi_snprintf(flow_info->tls.ssl_version, sizeof(flow_info->tls.ssl_version), "%s", flow_info->ndpi_flow->tls.ssl_version);
  if (flow_info->ndpi_flow->tls.server_name[0])
    ndpi_snprintf(flow_info->tls.server_name, sizeof(flow_info->tls.server_name), "%s", flow_info->ndpi_flow->tls.server_name);
  if (flow_info->ndpi_flow->tls.cert_valid_from[0])
    ndpi_snprintf(flow_info->tls.cert_valid_from, sizeof(flow_info->tls.cert_valid_from), "%s", flow_info->ndpi_flow->tls.cert_valid_from);
  if (flow_info->ndpi_flow->tls.cert_valid_to[0])
    ndpi_snprintf(flow_info->tls.cert_valid_to, sizeof(flow_info->tls.cert_valid_to), "%s", flow_info->ndpi_flow->tls.cert_valid_to);
  if (flow_info->ndpi_flow->tls.ja3_fp[0])
    ndpi_snprintf(flow_info->tls.ja3_fp, sizeof(flow_info->tls.ja3_fp), "%s", flow_info->ndpi_flow->tls.ja3_fp);
  if (flow_info->ndpi_flow->tls.alpn[0]) {
    ndpi_snprintf(flow_info->tls.alpn, sizeof(flow_info->tls.alpn), "%s", flow_info->ndpi_flow->tls.alpn);
    flow_info->info_type = INFO_TLS_ALPN;
  }
  /* Optionally update payload length distribution based on TLS block lengths */
  flow_info->tls.tls_payload_block_length = flow_info->ndpi_flow->tls.tls_payload_block_length;
}