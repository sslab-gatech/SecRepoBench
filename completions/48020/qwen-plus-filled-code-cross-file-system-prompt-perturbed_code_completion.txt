if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
  flow_info->info_type = INFO_SSH;
  ndpi_snprintf(flow_info->ssh.client_signature,
                sizeof(flow_info->ssh.client_signature),
                "%s", flow_info->ndpi_flow->protos.ssh.client_signature);
  ndpi_snprintf(flow_info->ssh.server_signature,
                sizeof(flow_info->ssh.server_signature),
                "%s", flow_info->ndpi_flow->protos.ssh.server_signature);
  ndpi_snprintf(flow_info->ssh.client_hash,
                sizeof(flow_info->ssh.client_hash),
                "%s", flow_info->ndpi_flow->protos.ssh.client_hash);
  ndpi_snprintf(flow_info->ssh.server_hash,
                sizeof(flow_info->ssh.server_hash),
                "%s", flow_info->ndpi_flow->protos.ssh.server_hash);
}

if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS) || is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC)) {
  if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC))
    is_quic = 1;

  flow_info->info_type = is_quic ? INFO_QUIC : INFO_TLS;

  if(flow_info->ndpi_flow->protos.tls.version != 0)
    ndpi_snprintf(flow_info->tls.ssl_version,
                  sizeof(flow_info->tls.ssl_version),
                  "%s", ndpi_tls_version_name(flow_info->ndpi_flow->protos.tls.version));

  ndpi_snprintf(flow_info->tls.server_name,
                sizeof(flow_info->tls.server_name),
                "%s", flow_info->ndpi_flow->protos.tls.server_name);

  if(flow_info->ndpi_flow->protos.tls.cert_not_before != NULL &&
     flow_info->ndpi_flow->protos.tls.cert_not_after != NULL) {
    ndpi_strncpy(flow_info->tls.certificate_validity_start,
                 flow_info->ndpi_flow->protos.tls.cert_not_before,
                 sizeof(flow_info->tls.certificate_validity_start));
    ndpi_strncpy(flow_info->tls.certificate_validity_end,
                 flow_info->ndpi_flow->protos.tls.cert_not_after,
                 sizeof(flow_info->tls.certificate_validity_end));
  }

  if(flow_info->ndpi_flow->protos.tls.ja3_client != NULL) {
    flow_info->tls.ja3_client = ndpi_strdup(flow_info->ndpi_flow->protos.tls.ja3_client);
  }

  if(flow_info->ndpi_flow->protos.tls.ja3_server != NULL) {
    flow_info->tls.ja3_server = ndpi_strdup(flow_info->ndpi_flow->protos.tls.ja3_server);
  }

  if(flow_info->ndpi_flow->protos.tls.alpn_selected != NULL) {
    ndpi_snprintf(flow_info->tls.alpn_selected,
                  sizeof(flow_info->tls.alpn_selected),
                  "%s", flow_info->ndpi_flow->protos.tls.alpn_selected);
  }

  if(flow_info->ndpi_flow->protos.tls.supported_versions != NULL) {
    flow_info->tls.supported_versions = ndpi_strdup(flow_info->ndpi_flow->protos.tls.supported_versions);
  }

  if(flow_info->ndpi_flow->protos.tls.client_hello_packet_len > 0) {
    flow_info->tls.client_hello_packet_len = ndpi_malloc(flow_info->ndpi_flow->protos.tls.client_hello_packet_len + 1);
    memcpy(flow_info->tls.client_hello_packet_len, flow_info->ndpi_flow->protos.tls.client_hello_packet_len,
           flow_info->ndpi_flow->protos.tls.client_hello_packet_len);
    flow_info->tls.client_hello_packet_len[flow_info->ndpi_flow->protos.tls.client_hello_packet_len] = '\0';
  }
}