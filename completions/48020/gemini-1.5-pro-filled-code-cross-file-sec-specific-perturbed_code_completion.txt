if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
    if(flow_info->ndpi_flow->protos.ssh.client_signature[0] != '\0')
      flow_info->ssh.client_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_signature);
    if(flow_info->ndpi_flow->protos.ssh.server_signature[0] != '\0')
      flow_info->ssh.server_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_signature);

    memcpy(flow_info->ssh.client_hash, flow_info->ndpi_flow->protos.ssh.client_hash, sizeof(flow_info->ssh.client_hash));
    memcpy(flow_info->ssh.server_hash, flow_info->ndpi_flow->protos.ssh.server_hash, sizeof(flow_info->ssh.server_hash));
  } else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS) ||
	    is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC) ||
            is_ndpi_proto(flow_info, NDPI_PROTOCOL_DTLS)) {
    flow_info->ssl.protocol_version = flow_info->ndpi_flow->protos.tls.protocol_version;
    if(flow_info->ndpi_flow->protos.tls.sni[0] != '\0') {
      ndpi_snprintf(flow_info->ssl.server_name, sizeof(flow_info->ssl.server_name), "%s", flow_info->ndpi_flow->protos.tls.sni);
    }
    if(flow_info->ndpi_flow->protos.tls.ja3_fingerprint[0] != '\0') {
      ndpi_snprintf(flow_info->ssl.ja3_fingerprint, sizeof(flow_info->ssl.ja3_fingerprint), "%s", flow_info->ndpi_flow->protos.tls.ja3_fingerprint);
    }
    flow_info->ssl.not_before = flow_info->ndpi_flow->protos.tls.not_before;
    flow_info->ssl.not_after = flow_info->ndpi_flow->protos.tls.not_after;

    // Copy various TLS/QUIC attributes
    memcpy(flow_info->ssl.client_random, flow_info->ndpi_flow->protos.tls.client_random, 32);
    memcpy(flow_info->ssl.master_key, flow_info->ndpi_flow->protos.tls.master_key, 48);

    if(flow_info->ndpi_flow->protos.tls.alpn[0] != '\0') {
      ndpi_snprintf(flow_info->ssl.alpn, sizeof(flow_info->ssl.alpn), "%s", flow_info->ndpi_flow->protos.tls.alpn);
      if(flow_info->ndpi_flow->protos.tls.supported_versions[0] != '\0') {
        ndpi_snprintf(flow_info->ssl.supported_versions, sizeof(flow_info->ssl.supported_versions), "%s", flow_info->ndpi_flow->protos.tls.supported_versions);
        flow_info->info_type = INFO_SSL_SUPPORTED_VERSIONS;
      } else {
        flow_info->info_type = INFO_SSL_ALPN;
      }
    }
  }