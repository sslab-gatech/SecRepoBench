// Check if the flow corresponds to the SSH protocol.
if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
  if(flow_info->ndpi_flow->protos.ssh.client_signature[0]!= '\0')
    flow_info->ssh.client_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_signature);
  if(flow_info->ndpi_flow->protos.ssh.server_signature[0]!= '\0')
    flow_info->ssh.server_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_signature);
  if(flow_info->ndpi_flow->protos.ssh.client_hash[0]!= '\0')
    flow_info->ssh.client_hash = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_hash);
  if(flow_info->ndpi_flow->protos.ssh.server_hash[0]!= '\0')
    flow_info->ssh.server_hash = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_hash);
}

// Check if the flow corresponds to the TLS protocol or related protocols.
else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS) ||
        is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC) ||
        is_ndpi_proto(flow_info, NDPI_PROTOCOL_DTLS)) {
  flow_info->info_type = INFO_TLS;
  ndpi_snprintf(flow_info->tls.version, sizeof(flow_info->tls.version), "%s",
                flow_info->ndpi_flow->protos.tls.version);
  if(flow_info->ndpi_flow->protos.tls.server_name[0]!= '\0')
    flow_info->tls.server_name = ndpi_strdup(flow_info->ndpi_flow->protos.tls.server_name);
  if(flow_info->ndpi_flow->protos.tls.cipher[0]!= '\0')
    flow_info->tls.cipher = ndpi_strdup(flow_info->ndpi_flow->protos.tls.cipher);
  if(flow_info->ndpi_flow->protos.tls.subject[0]!= '\0')
    flow_info->tls.subject = ndpi_strdup(flow_info->ndpi_flow->protos.tls.subject);
  if(flow_info->ndpi_flow->protos.tls.issuer[0]!= '\0')
    flow_info->tls.issuer = ndpi_strdup(flow_info->ndpi_flow->protos.tls.issuer);
  if(flow_info->ndpi_flow->protos.tls.not_before[0]!= '\0')
    flow_info->tls.not_before = ndpi_strdup(flow_info->ndpi_flow->protos.tls.not_before);
  if(flow_info->ndpi_flow->protos.tls.not_after[0]!= '\0')
    flow_info->tls.not_after = ndpi_strdup(flow_info->ndpi_flow->protos.tls.not_after);
  if(flow_info->ndpi_flow->protos.tls.ja3[0]!= '\0')
    flow_info->tls.ja3 = ndpi_strdup(flow_info->ndpi_flow->protos.tls.ja3);
  if(flow_info->ndpi_flow->protos.tls.ja3s[0]!= '\0')
    flow_info->tls.ja3s = ndpi_strdup(flow_info->ndpi_flow->protos.tls.ja3s);
  if(flow_info->ndpi_flow->protos.tls.alpn[0]!= '\0')
    flow_info->tls.alpn = ndpi_strdup(flow_info->ndpi_flow->protos.tls.alpn);
  if(flow_info->ndpi_flow->protos.tls.alpns[0]!= '\0')
    flow_info->tls.alpns = ndpi_strdup(flow_info->ndpi_flow->protos.tls.alpns);
  if(flow_info->ndpi_flow->protos.tls.sni[0]!= '\0')
    flow_info->tls.sni = ndpi_strdup(flow_info->ndpi_flow->protos.tls.sni);
  if(flow_info->ndpi_flow->protos.tls.snissl[0]!= '\0')
    flow_info->tls.snissl = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snissl);
  if(flow_info->ndpi_flow->protos.tls.snisslv6[0]!= '\0')
    flow_info->tls.snisslv6 = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snisslv6);
  if(flow_info->ndpi_flow->protos.tls.snialpn[0]!= '\0')
    flow_info->tls.snialpn = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snialpn);
  if(flow_info->ndpi_flow->protos.tls.snialpns[0]!= '\0')
    flow_info->tls.snialpns = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snialpns);
  if(flow_info->ndpi_flow->protos.tls.snisslpayload[0]!= '\0')
    flow_info->tls.snisslpayload = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snisslpayload);
  if(flow_info->ndpi_flow->protos.tls.snisslpayloadv6[0]!= '\0')
    flow_info->tls.snisslpayloadv6 = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snisslpayloadv6);
  if(flow_info->ndpi_flow->protos.tls.snialpnpayload[0]!= '\0')
    flow_info->tls.snialpnpayload = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snialpnpayload);
  if(flow_info->ndpi_flow->protos.tls.snialpnpayloadv6[0]!= '\0')
    flow_info->tls.snialpnpayloadv6 = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snialpnpayloadv6);
  if(flow_info->ndpi_flow->protos.tls.snisslpayloadalpn[0]!= '\0')
    flow_info->tls.snisslpayloadalpn = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snisslpayloadalpn);
  if(flow_info->ndpi_flow->protos.tls.snisslpayloadalpnv6[0]!= '\0')
    flow_info->tls.snisslpayloadalpnv6 = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snisslpayloadalpnv6);
  if(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpn[0]!= '\0')
    flow_info->tls.snialpnpayloadalpn = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpn);
  if(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpnv6[0]!= '\0')
    flow_info->tls.snialpnpayloadalpnv6 = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpnv6);
  if(flow_info->ndpi_flow->protos.tls.snisslpayloadalpns[0]!= '\0')
    flow_info->tls.snisslpayloadalpns = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snisslpayloadalpns);
  if(flow_info->ndpi_flow->protos.tls.snisslpayloadalpnsv6[0]!= '\0')
    flow_info->tls.snisslpayloadalpnsv6 = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snisslpayloadalpnsv6);
  if(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpns[0]!= '\0')
    flow_info->tls.snialpnpayloadalpns = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpns);
  if(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpnsv6[0]!= '\0')
    flow_info->tls.snialpnpayloadalpnsv6 = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpnsv6);
  if(flow_info->ndpi_flow->protos.tls.snisslpayloadalpnpayload[0]!= '\0')
    flow_info->tls.snisslpayloadalpnpayload = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snisslpayloadalpnpayload);
  if(flow_info->ndpi_flow->protos.tls.snisslpayloadalpnpayloadv6[0]!= '\0')
    flow_info->tls.snisslpayloadalpnpayloadv6 = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snisslpayloadalpnpayloadv6);
  if(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpnpayload[0]!= '\0')
    flow_info->tls.snialpnpayloadalpnpayload = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpnpayload);
  if(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpnpayloadv6[0]!= '\0')
    flow_info->tls.snialpnpayloadalpnpayloadv6 = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpnpayloadv6);
  if(flow_info->ndpi_flow->protos.tls.snisslpayloadalpnpayloadalpn[0]!= '\0')
    flow_info->tls.snisslpayloadalpnpayloadalpn = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snisslpayloadalpnpayloadalpn);
  if(flow_info->ndpi_flow->protos.tls.snisslpayloadalpnpayloadalpnv6[0]!= '\0')
    flow_info->tls.snisslpayloadalpnpayloadalpnv6 = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snisslpayloadalpnpayloadalpnv6);
  if(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpnpayloadalpn[0]!= '\0')
    flow_info->tls.snialpnpayloadalpnpayloadalpn = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpnpayloadalpn);
  if(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpnpayloadalpnv6[0]!= '\0')
    flow_info->tls.snialpnpayloadalpnpayloadalpnv6 = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpnpayloadalpnv6);
  if(flow_info->ndpi_flow->protos.tls.snisslpayloadalpnpayloadalpns[0]!= '\0')
    flow_info->tls.snisslpayloadalpnpayloadalpns = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snisslpayloadalpnpayloadalpns);
  if(flow_info->ndpi_flow->protos.tls.snisslpayloadalpnpayloadalpnsv6[0]!= '\0')
    flow_info->tls.snisslpayloadalpnpayloadalpnsv6 = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snisslpayloadalpnpayloadalpnsv6);
  if(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpnpayloadalpns[0]!= '\0')
    flow_info->tls.snialpnpayloadalpnpayloadalpns = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpnpayloadalpns);
  if(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpnpayloadalpnsv6[0]!= '\0')
    flow_info->tls.snialpnpayloadalpnpayloadalpnsv6 = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpnpayloadalpnsv6);
  if(flow_info->ndpi_flow->protos.tls.snisslpayloadalpnpayloadalpnpayload[0]!= '\0')
    flow_info->tls.snisslpayloadalpnpayloadalpnpayload = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snisslpayloadalpnpayloadalpnpayload);
  if(flow_info->ndpi_flow->protos.tls.snisslpayloadalpnpayloadalpnpayloadv6[0]!= '\0')
    flow_info->tls.snisslpayloadalpnpayloadalpnpayloadv6 = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snisslpayloadalpnpayloadalpnpayloadv6);
  if(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpnpayloadalpnpayload[0]!= '\0')
    flow_info->tls.snialpnpayloadalpnpayloadalpnpayload = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpnpayloadalpnpayload);
  if(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpnpayloadalpnpayloadv6[0]!= '\0')
    flow_info->tls.snialpnpayloadalpnpayloadalpnpayloadv6 = ndpi_strdup(flow_info->ndpi_flow->protos.tls.snialpnpayloadalpnpayloadalpnpayloadv6);
  if(flow_info->ndpi_flow->protos.tls.snisslpayloadalpnpayloadalpnpayloadalpn[0]!= '\0')
    flow_info->tls.snisslpayloadalpnpayloada