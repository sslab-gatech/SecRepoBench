if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
    flow_info->info_type = INFO_SSH;
    if(flow_info->ndpi_flow->protos.ssh.client_sig[0] != '\0')
      flow_info->ssh.client_sig = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_sig);
    if(flow_info->ndpi_flow->protos.ssh.server_sig[0] != '\0')
      flow_info->ssh.server_sig = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_sig);
    if(flow_info->ndpi_flow->protos.ssh.client_hash[0] != '\0')
      flow_info->ssh.client_hash = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_hash);
    if(flow_info->ndpi_flow->protos.ssh.server_hash[0] != '\0')
      flow_info->ssh.server_hash = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_hash);
  } else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS)
	    || is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSL)
            || is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC)
            || is_ndpi_proto(flow_info, NDPI_PROTOCOL_GRE_TLS)
            || is_ndpi_proto(flow_info, NDPI_PROTOCOL_DTLS)) {
    flow_info->tls.ssl_version = flow_info->ndpi_flow->tls.ssl_version;

    if(flow_info->ndpi_flow->tls.server_name[0] != '\0')
      flow_info->tls.server_name = ndpi_strdup(flow_info->ndpi_flow->tls.server_name);

    if(flow_info->ndpi_flow->tls.certificate_cn[0] != '\0')
      flow_info->tls.certificate_cn = ndpi_strdup(flow_info->ndpi_flow->tls.certificate_cn);

    if(flow_info->ndpi_flow->tls.certificate_issuer[0] != '\0')
      flow_info->tls.certificate_issuer = ndpi_strdup(flow_info->ndpi_flow->tls.certificate_issuer);

    flow_info->tls.certificate_valid_from = flow_info->ndpi_flow->tls.certificate_valid_from;
    flow_info->tls.certificate_valid_to = flow_info->ndpi_flow->tls.certificate_valid_to;

    if(flow_info->ndpi_flow->tls.alpn[0] != '\0')
      flow_info->tls.alpn = ndpi_strdup(flow_info->ndpi_flow->tls.alpn);

    if(flow_info->ndpi_flow->tls.ja3_digest[0] != '\0')
      flow_info->tls.ja3_digest = ndpi_strdup(flow_info->ndpi_flow->tls.ja3_digest);

    if(flow_info->ndpi_flow->tls.ja3s_digest[0] != '\0')
      flow_info->tls.ja3s_digest = ndpi_strdup(flow_info->ndpi_flow->tls.ja3s_digest);

    if(flow_info->ndpi_flow->tls.supported_versions[0] != '\0')
      flow_info->tls.supported_versions = ndpi_strdup(flow_info->ndpi_flow->tls.supported_versions);

    flow_info->tls.cipher = flow_info->ndpi_flow->tls.cipher;
    flow_info->tls.extensions = flow_info->ndpi_flow->tls.extensions;

    if(flow_info->ndpi_flow->tls.alpn[0] != '\0' && flow_info->ndpi_flow->tls.supported_versions[0] != '\0') {
      flow_info->info_type = INFO_TLS;
    }

    if(flow_info->ndpi_flow->tls.reset_payload_length_distribution) {
      flow_info->ndpi_flow->tls.reset_payload_length_distribution = 0;
      memset(flow_info->tls.payload_length_distribution, 0, sizeof(flow_info->tls.payload_length_distribution));
    }

    for(i = 0; i < sizeof(flow_info->ndpi_flow->tls.payload_length_distribution) / sizeof(flow_info->ndpi_flow->tls.payload_length_distribution[0]); i++) {
      flow_info->tls.payload_length_distribution[i] += flow_info->ndpi_flow->tls.payload_length_distribution[i];
    }
  }