if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
    flow_info->info_type = INFO_SSH;
    ndpi_snprintf(flow_info->ssh.client_sig,
                  sizeof(flow_info->ssh.client_sig),
                  "%s", flow_info->ndpi_flow->protos.ssh.client_sig);
    ndpi_snprintf(flow_info->ssh.server_sig,
                  sizeof(flow_info->ssh.server_sig),
                  "%s", flow_info->ndpi_flow->protos.ssh.server_sig);
    memcpy(flow_info->ssh.client_hash,
           flow_info->ndpi_flow->protos.ssh.client_hash,
           sizeof(flow_info->ssh.client_hash));
    memcpy(flow_info->ssh.server_hash,
           flow_info->ndpi_flow->protos.ssh.server_hash,
           sizeof(flow_info->ssh.server_hash));
  } else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS) ||
            is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSL) ||
            is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC) ||
            is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS_HANDSHAKE)) {
    flow_info->tls.ssl_version = flow_info->ndpi_flow->ssl.ssl_version;

    if(flow_info->ndpi_flow->ssl.server_name[0] != '\0')
      ndpi_snprintf(flow_info->tls.server_name, sizeof(flow_info->tls.server_name), "%s", flow_info->ndpi_flow->ssl.server_name);

    if(flow_info->ndpi_flow->ssl.certificate_valid_from[0] != '\0')
      ndpi_snprintf(flow_info->tls.certificate_valid_from, sizeof(flow_info->tls.certificate_valid_from), "%s", flow_info->ndpi_flow->ssl.certificate_valid_from);

    if(flow_info->ndpi_flow->ssl.certificate_valid_to[0] != '\0')
      ndpi_snprintf(flow_info->tls.certificate_valid_to, sizeof(flow_info->tls.certificate_valid_to), "%s", flow_info->ndpi_flow->ssl.certificate_valid_to);

    if(flow_info->ndpi_flow->ssl.alpn[0] != '\0')
      ndpi_snprintf(flow_info->tls.alpn, sizeof(flow_info->tls.alpn), "%s", flow_info->ndpi_flow->ssl.alpn);

    if(flow_info->ndpi_flow->ssl.ja3_digest[0] != '\0')
      ndpi_snprintf(flow_info->tls.ja3_digest, sizeof(flow_info->tls.ja3_digest), "%s", flow_info->ndpi_flow->ssl.ja3_digest);

    if(flow_info->ndpi_flow->ssl.ja3s_digest[0] != '\0')
      ndpi_snprintf(flow_info->tls.ja3s_digest, sizeof(flow_info->tls.ja3s_digest), "%s", flow_info->ndpi_flow->ssl.ja3s_digest);

    flow_info->tls.cipher = flow_info->ndpi_flow->ssl.cipher;
    flow_info->tls.session_reused = flow_info->ndpi_flow->ssl.session_reused;
    flow_info->tls.sni_found = flow_info->ndpi_flow->ssl.sni_found;
    flow_info->tls.cert_found = flow_info->ndpi_flow->ssl.cert_found;
    flow_info->tls.extended_master_secret = flow_info->ndpi_flow->ssl.extended_master_secret;
    flow_info->tls.secure_renegotiation = flow_info->ndpi_flow->ssl.secure_renegotiation;
    flow_info->tls.ocsp_stapling = flow_info->ndpi_flow->ssl.ocsp_stapling;
    flow_info->tls.alpn_found = flow_info->ndpi_flow->ssl.alpn_found;
    flow_info->tls.npn_found = flow_info->ndpi_flow->ssl.npn_found;
    flow_info->tls.quic = flow_info->ndpi_flow->ssl.quic;
    flow_info->tls.version_negotiation = flow_info->ndpi_flow->ssl.version_negotiation;
    flow_info->tls.supported_versions_count = flow_info->ndpi_flow->ssl.supported_versions_count;
    memcpy(flow_info->tls.supported_versions, flow_info->ndpi_flow->ssl.supported_versions, sizeof(flow_info->tls.supported_versions));

    if(flow_info->ndpi_flow->ssl.alpn[0] != '\0' && flow_info->ndpi_flow->ssl.supported_versions_count > 0) {
      flow_info->info_type = INFO_TLS;
    }

    if(is_quic) {
      flow_info->info_type = INFO_QUIC;
    }
  }