/* Check if the flow corresponds to the SSH protocol.
   If so, copy SSH-related information, such as client and server signatures,
   and client/server hash data to the flow structure.
   */

else if(is_ndpi_proto(flow, NDPI_PROTOCOL_SSH)) {
  if(flow->ndpi_flow->protos.ssh.server_names[0]!= '\0')
    flow->ssh_tls.server_names = ndpi_strdup(flow->ndpi_flow->protos.ssh.server_names);
  if(flow->ndpi_flow->protos.ssh.tls_alpn[0]!= '\0')
    flow->ssh_tls.tls_alpn = ndpi_strdup(flow->ndpi_flow->protos.ssh.tls_alpn);
  if(flow->ndpi_flow->protos.ssh.tls_supported_versions[0]!= '\0')
    flow->ssh_tls.tls_supported_versions = ndpi_strdup(flow->ndpi_flow->protos.ssh.tls_supported_versions);
  if(flow->ndpi_flow->protos.ssh.encrypted_sni.esni[0]!= '\0')
    flow->ssh_tls.encrypted_sni.esni = ndpi_strdup(flow->ndpi_flow->protos.ssh.encrypted_sni.esni);
  if(flow->ndpi_flow->protos.ssh.issuerDN[0]!= '\0')
    flow->ssh_tls.tls_issuerDN = ndpi_strdup(flow->ndpi_flow->protos.ssh.issuerDN);
  if(flow->ndpi_flow->protos.ssh.subjectDN[0]!= '\0')
    flow->ssh_tls.tls_subjectDN = ndpi_strdup(flow->ndpi_flow->protos.ssh.subjectDN);
}

/* Check if the flow corresponds to the TLS protocol or related protocols.
   If the protocol matches, update the flow structure with relevant TLS/QUIC information.
   This includes SSL version, server names, certificate validity dates, and JA3 fingerprints.
   Extract and store SSL/TLS version, server names, and certificate information.
   Copy various TLS/QUIC attributes, including ALPN and fingerprint data, to the flow.
   */

else if(is_ndpi_proto(flow, NDPI_PROTOCOL_TLS)
        || (flow->detected_protocol.master_protocol == NDPI_PROTOCOL_TLS)
        || is_ndpi_proto(flow, NDPI_PROTOCOL_QUIC)
        || (flow->detected_protocol.master_protocol == NDPI_PROTOCOL_QUIC)) {
  if(flow->ndpi_flow->protos.tls.ssl_version[0]!= '\0')
    flow->ssh_tls.ssl_version = ndpi_strdup(flow->ndpi_flow->protos.tls.ssl_version);
  if(flow->ndpi_flow->protos.tls.server_names[0]!= '\0')
    flow->ssh_tls.server_names = ndpi_strdup(flow->ndpi_flow->protos.tls.server_names);
  if(flow->ndpi_flow->protos.tls.tls_alpn[0]!= '\0')
    flow->ssh_tls.tls_alpn = ndpi_strdup(flow->ndpi_flow->protos.tls.tls_alpn);
  if(flow->ndpi_flow->protos.tls.tls_supported_versions[0]!= '\0')
    flow->ssh_tls.tls_supported_versions = ndpi_strdup(flow->ndpi_flow->protos.tls.tls_supported_versions);
  if(flow->ndpi_flow->protos.tls.encrypted_sni.esni[0]!= '\0')
    flow->ssh_tls.encrypted_sni.esni = ndpi_strdup(flow->ndpi_flow->protos.tls.encrypted_sni.esni);
  if(flow->ndpi_flow->protos.tls.issuerDN[0]!= '\0')
    flow->ssh_tls.tls_issuerDN = ndpi_strdup(flow->ndpi_flow->protos.tls.issuerDN);
  if(flow->ndpi_flow->protos.tls.subjectDN[0]!= '\0')
    flow->ssh_tls.tls_subjectDN = ndpi_strdup(flow->ndpi_flow->protos.tls.subjectDN);
  if(flow->ndpi_flow->protos.tls.ja3_fingerprint[0]!= '\0')
    flow->ssh_tls.ja3_fingerprint = ndpi_strdup(flow->ndpi_flow->protos.tls.ja3_fingerprint);
  if(flow->ndpi_flow->protos.tls.ja3s_fingerprint[0]!= '\0')
    flow->ssh_tls.ja3s_fingerprint = ndpi_strdup(flow->ndpi_flow->protos.tls.ja3s_fingerprint);
  if(flow->ndpi_flow->protos.tls.certificate_validity_start[0]!= '\0')
    flow->ssh_tls.certificate_validity_start = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_validity_start);
  if(flow->ndpi_flow->protos.tls.certificate_validity_end[0]!= '\0')
    flow->ssh_tls.certificate_validity_end = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_validity_end);
  if(flow->ndpi_flow->protos.tls.certificate_serial_number[0]!= '\0')
    flow->ssh_tls.certificate_serial_number = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_serial_number);
  if(flow->ndpi_flow->protos.tls.certificate_issuer[0]!= '\0')
    flow->ssh_tls.certificate_issuer = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_issuer);
  if(flow->ndpi_flow->protos.tls.certificate_subject[0]!= '\0')
    flow->ssh_tls.certificate_subject = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_subject);
  if(flow->ndpi_flow->protos.tls.certificate_algorithm[0]!= '\0')
    flow->ssh_tls.certificate_algorithm = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_algorithm);
  if(flow->ndpi_flow->protos.tls.certificate_signature[0]!= '\0')
    flow->ssh_tls.certificate_signature = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_signature);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint);
  if(flow->ndpi_flow->protos.tls.certificate_issuer_fingerprint[0]!= '\0')
    flow->ssh_tls.certificate_issuer_fingerprint = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_issuer_fingerprint);
  if(flow->ndpi_flow->protos.tls.certificate_subject_fingerprint[0]!= '\0')
    flow->ssh_tls.certificate_subject_fingerprint = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_subject_fingerprint);
  if(flow->ndpi_flow->protos.tls.certificate_serial_number_fingerprint[0]!= '\0')
    flow->ssh_tls.certificate_serial_number_fingerprint = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_serial_number_fingerprint);
  if(flow->ndpi_flow->protos.tls.certificate_algorithm_fingerprint[0]!= '\0')
    flow->ssh_tls.certificate_algorithm_fingerprint = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_algorithm_fingerprint);
  if(flow->ndpi_flow->protos.tls.certificate_signature_fingerprint[0]!= '\0')
    flow->ssh_tls.certificate_signature_fingerprint = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_signature_fingerprint);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_algorithm[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_algorithm = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_algorithm);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_hash[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_hash = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_hash);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_value[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_value = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_value);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_type[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_type = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_type);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_algorithm_type[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_algorithm_type = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_algorithm_type);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_hash_type[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_hash_type = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_hash_type);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_type[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_value_type = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_type);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_algorithm[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_value_algorithm = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_algorithm);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_hash[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_value_hash = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_hash);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_type[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_value_type = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_type);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_algorithm_type[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_value_algorithm_type = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_algorithm_type);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_hash_type[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_value_hash_type = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_hash_type);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_type[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_value_type = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_type);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_algorithm_type[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_value_algorithm_type = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_algorithm_type);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_hash_type[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_value_hash_type = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_hash_type);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_type[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_value_type = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_type);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_algorithm_type[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_value_algorithm_type = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_algorithm_type);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_hash_type[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_value_hash_type = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_hash_type);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_type[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_value_type = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_type);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_algorithm_type[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_value_algorithm_type = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_algorithm_type);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_hash_type[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_value_hash_type = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_hash_type);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_type[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_value_type = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_type);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_algorithm_type[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_value_algorithm_type = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_algorithm_type);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_hash_type[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_value_hash_type = ndpi_strdup(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_hash_type);
  if(flow->ndpi_flow->protos.tls.certificate_fingerprint_value_type[0]!= '\0')
    flow->ssh_tls.certificate_fingerprint_value_type = ndp