if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
    if(flow_info->ndpi_flow->protos.ssh.client_signature[0] != '\0') {
      flow_info->ssh_tls.client_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_signature);
    }
    if(flow_info->ndpi_flow->protos.ssh.server_signature[0] != '\0') {
      flow_info->ssh_tls.server_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_signature);
    }
    if(flow_info->ndpi_flow->protos.ssh.client_hash.length > 0) {
      flow_info->ssh_tls.client_hash.data = ndpi_malloc(flow_info->ndpi_flow->protos.ssh.client_hash.length);
      if (flow_info->ssh_tls.client_hash.data != NULL) {
        memcpy(flow_info->ssh_tls.client_hash.data, flow_info->ndpi_flow->protos.ssh.client_hash.data, flow_info->ndpi_flow->protos.ssh.client_hash.length);
        flow_info->ssh_tls.client_hash.length = flow_info->ndpi_flow->protos.ssh.client_hash.length;
      }
    }
    if(flow_info->ndpi_flow->protos.ssh.server_hash.length > 0) {
      flow_info->ssh_tls.server_hash.data = ndpi_malloc(flow_info->ndpi_flow->protos.ssh.server_hash.length);
      if (flow_info->ssh_tls.server_hash.data != NULL) {
        memcpy(flow_info->ssh_tls.server_hash.data, flow_info->ndpi_flow->protos.ssh.server_hash.data, flow_info->ndpi_flow->protos.ssh.server_hash.length);
        flow_info->ssh_tls.server_hash.length = flow_info->ndpi_flow->protos.ssh.server_hash.length;
      }
    }
  } else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS) ||
	    (flow_info->detected_protocol.master_protocol == NDPI_PROTOCOL_TLS) ||
            is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC) ||
	    (flow_info->detected_protocol.master_protocol == NDPI_PROTOCOL_QUIC)) {
    is_quic = is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC);

    flow_info->info_type = INFO_TLS;
    flow_info->tls.ssl_v = flow_info->ndpi_flow->protos.tls.version;

    if(flow_info->ndpi_flow->protos.tls.server_names)
      flow_info->ssh_tls.server_names = ndpi_strdup(flow_info->ndpi_flow->protos.tls.server_names);

    flow_info->tls.cert_start = flow_info->ndpi_flow->protos.tls.cert_start;
    flow_info->tls.cert_end = flow_info->ndpi_flow->protos.tls.cert_end;

    ndpi_snprintf(flow_info->tls.ja3_fingerprint, sizeof(flow_info->tls.ja3_fingerprint), "%s", flow_info->ndpi_flow->protos.tls.ja3_fingerprint);
    ndpi_snprintf(flow_info->tls.ja3s_fingerprint, sizeof(flow_info->tls.ja3s_fingerprint), "%s", flow_info->ndpi_flow->protos.tls.ja3s_fingerprint);

    ndpi_snprintf(flow_info->tls.sni, sizeof(flow_info->tls.sni), "%s", flow_info->ndpi_flow->protos.tls.sni);

    if(flow_info->ndpi_flow->protos.tls.tls_alpn)
      flow_info->ssh_tls.tls_alpn = ndpi_strdup(flow_info->ndpi_flow->protos.tls.tls_alpn);

    if(flow_info->ndpi_flow->protos.tls.supported_versions)
      flow_info->ssh_tls.tls_supported_versions = ndpi_strdup(flow_info->ndpi_flow->protos.tls.supported_versions);

    if(flow_info->ndpi_flow->protos.tls.issuerDN)
      flow_info->ssh_tls.tls_issuerDN = ndpi_strdup(flow_info->ndpi_flow->protos.tls.issuerDN);

    if(flow_info->ndpi_flow->protos.tls.subjectDN)
      flow_info->ssh_tls.tls_subjectDN = ndpi_strdup(flow_info->ndpi_flow->protos.tls.subjectDN);

    if(flow_info->ndpi_flow->protos.tls.encrypted_sni.esni) {
      flow_info->ssh_tls.encrypted_sni.esni = ndpi_malloc(flow_info->ndpi_flow->protos.tls.encrypted_sni.esni_len);
      if(flow_info->ssh_tls.encrypted_sni.esni) {
        memcpy(flow_info->ssh_tls.encrypted_sni.esni, flow_info->ndpi_flow->protos.tls.encrypted_sni.esni, flow_info->ndpi_flow->protos.tls.encrypted_sni.esni_len);
        flow_info->ssh_tls.encrypted_sni.esni_len = flow_info->ndpi_flow->protos.tls.encrypted_sni.esni_len;
      }
    }

    if(flow_info->ssh_tls.tls_alpn && flow_info->ssh_tls.tls_supported_versions) {
      flow_info->info_type = INFO_TLS_ALPN;
    }

#ifdef HAVE_NDPI_RESET_PAYLOAD_LENGTH_DISTRIBUTION
    if(!is_quic) {
      ndpi_reset_payload_length_distribution(flow_info->ndpi_flow);
      ndpi_set_tls_block_length(flow_info->ndpi_flow, payload_len);
    }
#endif
  }