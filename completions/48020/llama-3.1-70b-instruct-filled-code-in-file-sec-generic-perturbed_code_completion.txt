// <MASK>
} else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS) ||
          (flow_info->detected_protocol.master_protocol == NDPI_PROTOCOL_TLS) ||
          is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC) ||
          (flow_info->detected_protocol.master_protocol == NDPI_PROTOCOL_QUIC)) {
  if(flow_info->ndpi_flow->protos.tls.ssl_version[0]!= '\0')
    ndpi_snprintf(flow_info->ssh_tls.tls_version, sizeof(flow_info->ssh_tls.tls_version), "%s", flow_info->ndpi_flow->protos.tls.ssl_version);
  if(flow_info->ndpi_flow->protos.tls.server_names[0]!= '\0')
    flow_info->ssh_tls.server_names = ndpi_strdup(flow_info->ndpi_flow->protos.tls.server_names);
  if(flow_info->ndpi_flow->protos.tls.tls_alpn[0]!= '\0')
    flow_info->ssh_tls.tls_alpn = ndpi_strdup(flow_info->ndpi_flow->protos.tls.tls_alpn);
  if(flow_info->ndpi_flow->protos.tls.tls_supported_versions[0]!= '\0')
    flow_info->ssh_tls.tls_supported_versions = ndpi_strdup(flow_info->ndpi_flow->protos.tls.tls_supported_versions);
  if(flow_info->ndpi_flow->protos.tls.tls_issuerDN[0]!= '\0')
    flow_info->ssh_tls.tls_issuerDN = ndpi_strdup(flow_info->ndpi_flow->protos.tls.tls_issuerDN);
  if(flow_info->ndpi_flow->protos.tls.tls_subjectDN[0]!= '\0')
    flow_info->ssh_tls.tls_subjectDN = ndpi_strdup(flow_info->ndpi_flow->protos.tls.tls_subjectDN);
  if(flow_info->ndpi_flow->protos.tls.encrypted_sni.esni[0]!= '\0')
    flow_info->ssh_tls.encrypted_sni.esni = ndpi_strdup(flow_info->ndpi_flow->protos.tls.encrypted_sni.esni);
  if(flow_info->ndpi_flow->protos.tls.tls_alpn[0]!= '\0' && flow_info->ndpi_flow->protos.tls.tls_supported_versions[0]!= '\0') {
    flow_info->info_type = INFO_TLS_ALPN_VERSIONS;
    ndpi_snprintf(flow_info->tls_alpn_versions, sizeof(flow_info->tls_alpn_versions), "%s", flow_info->ndpi_flow->protos.tls.tls_alpn);
    ndpi_snprintf(flow_info->tls_alpn_versions + strlen(flow_info->tls_alpn_versions), sizeof(flow_info->tls_alpn_versions) - strlen(flow_info->tls_alpn_versions), "%s", flow_info->ndpi_flow->protos.tls.tls_supported_versions);
  }
  if(flow_info->ndpi_flow->protos.tls.tls_block_len[0]!= '\0') {
    flow_info->info_type = INFO_TLS_BLOCK_LEN;
    ndpi_snprintf(flow_info->tls_block_len, sizeof(flow_info->tls_block_len), "%s", flow_info->ndpi_flow->protos.tls.tls_block_len);
    // Reset and update the payload length distribution based on TLS block lengths.
    // ndpi_reset_bin(&flow->payload_len_bin);
    // ndpi_update_bin(&flow->payload_len_bin, flow->ndpi_flow->protos.tls.tls_block_len);
  }
  if(flow_info->ndpi_flow->protos.tls.ja3_fingerprint[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_fingerprint, sizeof(flow_info->ja3_fingerprint), "%s", flow_info->ndpi_flow->protos.tls.ja3_fingerprint);
  if(flow_info->ndpi_flow->protos.tls.ja3_hash[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_hash, sizeof(flow_info->ja3_hash), "%s", flow_info->ndpi_flow->protos.tls.ja3_hash);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash, sizeof(flow_info->ja3_collector_hash), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash2[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash2, sizeof(flow_info->ja3_collector_hash2), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash2);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash3[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash3, sizeof(flow_info->ja3_collector_hash3), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash3);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash4[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash4, sizeof(flow_info->ja3_collector_hash4), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash4);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash5[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash5, sizeof(flow_info->ja3_collector_hash5), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash5);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash6[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash6, sizeof(flow_info->ja3_collector_hash6), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash6);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash7[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash7, sizeof(flow_info->ja3_collector_hash7), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash7);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash8[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash8, sizeof(flow_info->ja3_collector_hash8), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash8);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash9[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash9, sizeof(flow_info->ja3_collector_hash9), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash9);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash10[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash10, sizeof(flow_info->ja3_collector_hash10), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash10);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash11[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash11, sizeof(flow_info->ja3_collector_hash11), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash11);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash12[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash12, sizeof(flow_info->ja3_collector_hash12), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash12);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash13[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash13, sizeof(flow_info->ja3_collector_hash13), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash13);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash14[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash14, sizeof(flow_info->ja3_collector_hash14), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash14);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash15[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash15, sizeof(flow_info->ja3_collector_hash15), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash15);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash16[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash16, sizeof(flow_info->ja3_collector_hash16), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash16);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash17[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash17, sizeof(flow_info->ja3_collector_hash17), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash17);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash18[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash18, sizeof(flow_info->ja3_collector_hash18), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash18);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash19[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash19, sizeof(flow_info->ja3_collector_hash19), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash19);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash20[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash20, sizeof(flow_info->ja3_collector_hash20), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash20);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash21[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash21, sizeof(flow_info->ja3_collector_hash21), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash21);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash22[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash22, sizeof(flow_info->ja3_collector_hash22), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash22);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash23[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash23, sizeof(flow_info->ja3_collector_hash23), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash23);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash24[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash24, sizeof(flow_info->ja3_collector_hash24), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash24);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash25[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash25, sizeof(flow_info->ja3_collector_hash25), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash25);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash26[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash26, sizeof(flow_info->ja3_collector_hash26), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash26);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash27[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash27, sizeof(flow_info->ja3_collector_hash27), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash27);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash28[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash28, sizeof(flow_info->ja3_collector_hash28), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash28);
  if(flow_info->ndpi_flow->protos.tls.ja3_collector_hash29[0]!= '\0')
    ndpi_snprintf(flow_info->ja3_collector_hash29, sizeof(flow_info->ja3_collector_hash29), "%s", flow_info->ndpi_flow->protos.tls.ja3_collector_hash29);
  if(flow_info->ndpi_flow-