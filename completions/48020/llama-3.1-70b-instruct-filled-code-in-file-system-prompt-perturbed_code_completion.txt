else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS) ||
        (flow_info->detected_protocol.master_protocol == NDPI_PROTOCOL_TLS) ||
        is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC) ||
        (flow_info->detected_protocol.master_protocol == NDPI_PROTOCOL_QUIC)) {
  if(flow_info->ndpi_flow->protos.tls.ssl_version[0]!= '\0')
    ndpi_snprintf(flow_info->ssh_tls.tls_version, sizeof(flow_info->ssh_tls.tls_version), "%s",
                  flow_info->ndpi_flow->protos.tls.ssl_version);
  if(flow_info->ndpi_flow->protos.tls.server_names[0]!= '\0')
    flow_info->ssh_tls.server_names = ndpi_strdup(flow_info->ndpi_flow->protos.tls.server_names);
  if(flow_info->ndpi_flow->protos.tls.tls_alpn[0]!= '\0')
    flow_info->ssh_tls.tls_alpn = ndpi_strdup(flow_info->ndpi_flow->protos.tls.tls_alpn);
  if(flow_info->ndpi_flow->protos.tls.tls_supported_versions[0]!= '\0')
    flow_info->ssh_tls.tls_supported_versions = ndpi_strdup(flow_info->ndpi_flow->protos.tls.tls_supported_versions);
  if(flow_info->ndpi_flow->protos.tls.tls_issuerDN[0]!= '\0')
    flow_info->ssh_tls.tls_issuerDN = ndpi_strdup(flow_info->ndpi_flow->protos.tls.tls_issuerDN);
  if(flow_info->ndpi_flow->protos.tls.tls_subjectDN[0]!= '\0')
    flow_info->ssh_tls.tls_subjectDN = ndpi_strdup(flow_info->ndpi_flow->protos.tls.tls_subjectDN);
  if(flow_info->ndpi_flow->protos.tls.encrypted_sni.esni[0]!= '\0')
    flow_info->ssh_tls.encrypted_sni.esni = ndpi_strdup(flow_info->ndpi_flow->protos.tls.encrypted_sni.esni);
  if(flow_info->ndpi_flow->protos.tls.tls_alpn[0]!= '\0' &&
     flow_info->ndpi_flow->protos.tls.tls_supported_versions[0]!= '\0') {
    flow_info->info_type = INFO_TLS_ALPN_VERSIONS;
    ndpi_snprintf(flow_info->tls_alpn_versions, sizeof(flow_info->tls_alpn_versions), "%s %s",
                  flow_info->ndpi_flow->protos.tls.tls_alpn, flow_info->ndpi_flow->protos.tls.tls_supported_versions);
  }
  if(flow_info->ndpi_flow->protos.tls.tls_block_len[0]!= '\0') {
    flow_info->info_type = INFO_TLS_BLOCK_LEN;
    ndpi_snprintf(flow_info->tls_block_len, sizeof(flow_info->tls_block_len), "%s",
                  flow_info->ndpi_flow->protos.tls.tls_block_len);
    if(flow->entropy->src2dst_pkt_count < max_num_packets_per_flow) {
      u_int16_t i;
      for(i=0; i<flow->entropy->src2dst_pkt_count; i++) {
        flow->entropy->src2dst_pkt_len[i] = flow->entropy->src2dst_pkt_len[i] - flow->entropy->src2dst_pkt_len[i] % 16;
      }
    }
    if(flow->entropy->dst2src_pkt_count < max_num_packets_per_flow) {
      u_int16_t i;
      for(i=0; i<flow->entropy->dst2src_pkt_count; i++) {
        flow->entropy->dst2src_pkt_len[i] = flow->entropy->dst2src_pkt_len[i] - flow->entropy->dst2src_pkt_len[i] % 16;
      }
    }
  }
}