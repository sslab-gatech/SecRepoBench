if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
  if(flow_info->ndpi_flow->protos.ssh.client_signature)
    flow_info->ssh_tls.client_info = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_signature);
  if(flow_info->ndpi_flow->protos.ssh.server_signature)
    flow_info->ssh_tls.server_info = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_signature);
  
  flow_info->ssh_tls.client_hassh[0] = '\0';
  if(flow_info->ndpi_flow->protos.ssh.hassh_client[0] != '\0') {
    strncpy(flow_info->ssh_tls.client_hassh, flow_info->ndpi_flow->protos.ssh.hassh_client, sizeof(flow_info->ssh_tls.client_hassh)-1);
    flow_info->ssh_tls.client_hassh[sizeof(flow_info->ssh_tls.client_hassh)-1] = '\0';
  }
  
  flow_info->ssh_tls.server_hassh[0] = '\0';
  if(flow_info->ndpi_flow->protos.ssh.hassh_server[0] != '\0') {
    strncpy(flow_info->ssh_tls.server_hassh, flow_info->ndpi_flow->protos.ssh.hassh_server, sizeof(flow_info->ssh_tls.server_hassh)-1);
    flow_info->ssh_tls.server_hassh[sizeof(flow_info->ssh_tls.server_hassh)-1] = '\0';
  }
} else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS)
          || is_ndpi_proto(flow_info, NDPI_PROTOCOL_DTLS)
          || is_ndpi_proto(flow_info, NDPI_PROTOCOL_MAIL_SMTPS)
          || is_ndpi_proto(flow_info, NDPI_PROTOCOL_MAIL_IMAPS)
          || is_ndpi_proto(flow_info, NDPI_PROTOCOL_MAIL_POPS)
          || is_ndpi_proto(flow_info, NDPI_PROTOCOL_HTTPS)
          || is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC)) {
  if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC))
    is_quic = 1;
  
  flow_info->ssh_tls.ssl_version = flow_info->ndpi_flow->protos.tls_quic.ssl_version;
  flow_info->ssh_tls.ja3_client[0] = '\0';
  flow_info->ssh_tls.ja3_server[0] = '\0';
  flow_info->ssh_tls.client_unsafe_cipher = 0;
  flow_info->ssh_tls.server_unsafe_cipher = 0;
  flow_info->ssh_tls.server_cipher = flow_info->ndpi_flow->protos.tls_quic.server_cipher;
  flow_info->ssh_tls.client_cipher = flow_info->ndpi_flow->protos.tls_quic.client_cipher;
  
  if(flow_info->ndpi_flow->protos.tls_quic.ja3_client)
    strncpy(flow_info->ssh_tls.ja3_client, flow_info->ndpi_flow->protos.tls_quic.ja3_client, sizeof(flow_info->ssh_tls.ja3_client)-1);
  
  if(flow_info->ndpi_flow->protos.tls_quic.ja3_server)
    strncpy(flow_info->ssh_tls.ja3_server, flow_info->ndpi_flow->protos.tls_quic.ja3_server, sizeof(flow_info->ssh_tls.ja3_server)-1);
  
  if(flow_info->ndpi_flow->protos.tls_quic.client_unsafe_cipher)
    flow_info->ssh_tls.client_unsafe_cipher = flow_info->ndpi_flow->protos.tls_quic.client_unsafe_cipher;
  
  if(flow_info->ndpi_flow->protos.tls_quic.server_unsafe_cipher)
    flow_info->ssh_tls.server_unsafe_cipher = flow_info->ndpi_flow->protos.tls_quic.server_unsafe_cipher;
  
  if(flow_info->ndpi_flow->protos.tls_quic.alpn)
    flow_info->ssh_tls.tls_alpn = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.alpn);
  
  if(flow_info->ndpi_flow->protos.tls_quic.tls_supported_versions)
    flow_info->ssh_tls.tls_supported_versions = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.tls_supported_versions);
  
  if(flow_info->ndpi_flow->protos.tls_quic.issuerDN)
    flow_info->ssh_tls.tls_issuerDN = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.issuerDN);
  
  if(flow_info->ndpi_flow->protos.tls_quic.subjectDN)
    flow_info->ssh_tls.tls_subjectDN = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.subjectDN);
  
  if(flow_info->ndpi_flow->protos.tls_quic.server_names)
    flow_info->ssh_tls.server_names = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.server_names);
  
  if(flow_info->ndpi_flow->protos.tls_quic.esni) {
    flow_info->ssh_tls.encrypted_sni.esni = ndpi_malloc(sizeof(flow_info->ndpi_flow->protos.tls_quic.esni_len));
    
    if(flow_info->ssh_tls.encrypted_sni.esni) {
      memcpy(flow_info->ssh_tls.encrypted_sni.esni, 
             flow_info->ndpi_flow->protos.tls_quic.esni, 
             flow_info->ndpi_flow->protos.tls_quic.esni_len);
      flow_info->ssh_tls.encrypted_sni.esni_len = flow_info->ndpi_flow->protos.tls_quic.esni_len;
    }
  }
  
  flow_info->ssh_tls.notBefore = flow_info->ndpi_flow->protos.tls_quic.notBefore;
  flow_info->ssh_tls.notAfter = flow_info->ndpi_flow->protos.tls_quic.notAfter;
}