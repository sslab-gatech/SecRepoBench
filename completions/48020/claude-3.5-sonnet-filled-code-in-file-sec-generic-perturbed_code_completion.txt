if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
  if(flow_info->ndpi_flow->protos.ssh.client_signature[0] != '\0')
    flow_info->ssh_tls.client_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_signature);
  if(flow_info->ndpi_flow->protos.ssh.server_signature[0] != '\0')
    flow_info->ssh_tls.server_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_signature);
  if(flow_info->ndpi_flow->protos.ssh.hassh_client[0] != '\0')
    flow_info->ssh_tls.hassh_client = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.hassh_client);
  if(flow_info->ndpi_flow->protos.ssh.hassh_server[0] != '\0')
    flow_info->ssh_tls.hassh_server = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.hassh_server);
} else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS)
          || is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC)
          || is_ndpi_proto(flow_info, NDPI_PROTOCOL_DTLS)) {
  is_quic = is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC);
  flow_info->ssh_tls.ssl_version = flow_info->ndpi_flow->protos.tls_quic.ssl_version;
  if(flow_info->ndpi_flow->protos.tls_quic.server_names[0] != '\0')
    flow_info->ssh_tls.server_names = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.server_names);
  if(flow_info->ndpi_flow->protos.tls_quic.tls_supported_versions[0] != '\0')
    flow_info->ssh_tls.tls_supported_versions = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.tls_supported_versions);
  if(flow_info->ndpi_flow->protos.tls_quic.alpn[0] != '\0')
    flow_info->ssh_tls.tls_alpn = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.alpn);
  if(flow_info->ndpi_flow->protos.tls_quic.issuerDN[0] != '\0')
    flow_info->ssh_tls.tls_issuerDN = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.issuerDN);
  if(flow_info->ndpi_flow->protos.tls_quic.subjectDN[0] != '\0')
    flow_info->ssh_tls.tls_subjectDN = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.subjectDN);
  flow_info->ssh_tls.notBefore = flow_info->ndpi_flow->protos.tls_quic.notBefore;
  flow_info->ssh_tls.notAfter = flow_info->ndpi_flow->protos.tls_quic.notAfter;
  memcpy(flow_info->ssh_tls.ja3_client, flow_info->ndpi_flow->protos.tls_quic.ja3_client, sizeof(flow_info->ssh_tls.ja3_client));
  memcpy(flow_info->ssh_tls.ja3_server, flow_info->ndpi_flow->protos.tls_quic.ja3_server, sizeof(flow_info->ssh_tls.ja3_server));
  flow_info->ssh_tls.server_cipher = flow_info->ndpi_flow->protos.tls_quic.server_cipher;
  flow_info->ssh_tls.server_unsafe_cipher = flow_info->ndpi_flow->protos.tls_quic.server_unsafe_cipher;
  if(flow_info->ndpi_flow->protos.tls_quic.encrypted_sni.esni) {
    flow_info->ssh_tls.encrypted_sni.esni = ndpi_malloc(flow_info->ndpi_flow->protos.tls_quic.encrypted_sni.esni_len);
    if(flow_info->ssh_tls.encrypted_sni.esni) {
      memcpy(flow_info->ssh_tls.encrypted_sni.esni, 
             flow_info->ndpi_flow->protos.tls_quic.encrypted_sni.esni,
             flow_info->ndpi_flow->protos.tls_quic.encrypted_sni.esni_len);
      flow_info->ssh_tls.encrypted_sni.esni_len = flow_info->ndpi_flow->protos.tls_quic.encrypted_sni.esni_len;
    }
  }

  if(flow_info->ssh_tls.tls_alpn && flow_info->ssh_tls.tls_supported_versions) {
    flow_info->info_type = INFO_TLS_QUIC;
    ndpi_snprintf(flow_info->info, sizeof(flow_info->info), "%s;%s",
                  flow_info->ssh_tls.tls_alpn, flow_info->ssh_tls.tls_supported_versions);
  }

  if(is_quic) {
#ifdef DIRECTION_BINS
    ndpi_free_bin(&flow_info->payload_len_bin_src2dst);
    ndpi_free_bin(&flow_info->payload_len_bin_dst2src);
#else
    ndpi_free_bin(&flow_info->payload_len_bin);
#endif
  }
}