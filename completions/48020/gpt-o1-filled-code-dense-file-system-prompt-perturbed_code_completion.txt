} else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
  /* SSH */
  flow_info->info_type = INFO_GENERIC;
  
  if(flow_info->ndpi_flow->protos.ssh.client_signature[0] != '\0')
    flow_info->ssh.client_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_signature);

  if(flow_info->ndpi_flow->protos.ssh.server_signature[0] != '\0')
    flow_info->ssh.server_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_signature);

  if(flow_info->ndpi_flow->protos.ssh.hassh_client[0] != '\0')
    flow_info->ssh.hassh_client = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.hassh_client);

  if(flow_info->ndpi_flow->protos.ssh.hassh_server[0] != '\0')
    flow_info->ssh.hassh_server = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.hassh_server);

} else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS) ||
          flow_info->detected_protocol.master_protocol == NDPI_PROTOCOL_TLS ||
          is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC) ||
          is_ndpi_proto(flow_info, NDPI_PROTOCOL_DTLS) ||
          is_ndpi_proto(flow_info, NDPI_PROTOCOL_MAIL_SMTPS) ||
          is_ndpi_proto(flow_info, NDPI_PROTOCOL_MAIL_POPS) ||
          is_ndpi_proto(flow_info, NDPI_PROTOCOL_MAIL_IMAPS)) {
  /* TLS/QUIC/DTLS and encrypted mail protocols */
  flow_info->info_type = INFO_GENERIC;

  /* Copy SSL/TLS version */
  flow_info->ssl.ssl_version = flow_info->ndpi_flow->protos.tls_quic.ssl_version;
  
  /* Copy server names */
  if(flow_info->ndpi_flow->protos.tls_quic.server_names)
    flow_info->ssl.server_names = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.server_names);

  /* Copy ALPN */
  if(flow_info->ndpi_flow->protos.tls_quic.alpn)
    flow_info->ssl.alpn = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.alpn);

  /* Copy certificate validity dates if available */
  flow_info->ssl.notBefore = flow_info->ndpi_flow->protos.tls_quic.notBefore;
  flow_info->ssl.notAfter  = flow_info->ndpi_flow->protos.tls_quic.notAfter;

  /* Copy JA3 fingerprints if available */
  if(flow_info->ndpi_flow->protos.tls_quic.ja3_client[0] != '\0')
    flow_info->ssl.ja3_client = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.ja3_client);

  if(flow_info->ndpi_flow->protos.tls_quic.ja3_server[0] != '\0')
    flow_info->ssl.ja3_server = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.ja3_server);

  /* Copy issuer and subject DN */
  if(flow_info->ndpi_flow->protos.tls_quic.issuerDN)
    flow_info->ssl.issuerDN = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.issuerDN);

  if(flow_info->ndpi_flow->protos.tls_quic.subjectDN)
    flow_info->ssl.subjectDN = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.subjectDN);

  /* Copy supported versions if present */
  if(flow_info->ndpi_flow->protos.tls_quic.tls_supported_versions)
    flow_info->ssl.tls_supported_versions = ndpi_strdup(flow_info->ndpi_flow->protos.tls_quic.tls_supported_versions);

  /* Optionally, reset or update payload distribution based on TLS block lengths if required */