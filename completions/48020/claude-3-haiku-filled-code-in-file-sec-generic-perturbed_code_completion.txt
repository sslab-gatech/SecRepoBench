// <MASK>
else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS) || (flow_info->detected_protocol.master_protocol == NDPI_PROTOCOL_TLS)) {
    flow_info->info_type = INFO_TLS;

    if(flow_info->ndpi_flow->protos.tls.server_names != NULL) {
        flow_info->ssh_tls.server_names = ndpi_strdup(flow_info->ndpi_flow->protos.tls.server_names);
    }

    if(flow_info->ndpi_flow->protos.tls.alpn != NULL) {
        flow_info->ssh_tls.tls_alpn = ndpi_strdup(flow_info->ndpi_flow->protos.tls.alpn);
    }

    if(flow_info->ndpi_flow->protos.tls.tls_supported_versions != NULL) {
        flow_info->ssh_tls.tls_supported_versions = ndpi_strdup(flow_info->ndpi_flow->protos.tls.tls_supported_versions);
    }

    if(flow_info->ndpi_flow->protos.tls.tls_issuerDN != NULL) {
        flow_info->ssh_tls.tls_issuerDN = ndpi_strdup(flow_info->ndpi_flow->protos.tls.tls_issuerDN);
    }

    if(flow_info->ndpi_flow->protos.tls.tls_subjectDN != NULL) {
        flow_info->ssh_tls.tls_subjectDN = ndpi_strdup(flow_info->ndpi_flow->protos.tls.tls_subjectDN);
    }

    if(flow_info->ndpi_flow->protos.tls.encrypted_sni.esni != NULL) {
        flow_info->ssh_tls.encrypted_sni.esni = ndpi_strdup(flow_info->ndpi_flow->protos.tls.encrypted_sni.esni);
    }

    if(enable_ja3_plus) {
        flow_info->ja3_str = ndpi_strdup(flow_info->ndpi_flow->protos.tls.ja3_str);
        flow_info->ja3s_str = ndpi_strdup(flow_info->ndpi_flow->protos.tls.ja3s_str);
    }

    if(enable_doh_dot_detection) {
        flow_info->info_type = INFO_DOH_DOT;
        ndpi_snprintf(flow_info->info, sizeof(flow_info->info), "%s", flow_info->ndpi_flow->protos.tls.doh_dot_name);
    }
} else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH) || (flow_info->detected_protocol.master_protocol == NDPI_PROTOCOL_SSH)) {
    flow_info->info_type = INFO_SSH;

    if(flow_info->ndpi_flow->protos.ssh.client_signature != NULL) {
        flow_info->ssh_tls.client_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_signature);
    }

    if(flow_info->ndpi_flow->protos.ssh.server_signature != NULL) {
        flow_info->ssh_tls.server_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_signature);
    }

    if(flow_info->ndpi_flow->protos.ssh.client_hassh != NULL) {
        flow_info->ssh_tls.client_hassh = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_hassh);
    }

    if(flow_info->ndpi_flow->protos.ssh.server_hassh != NULL) {
        flow_info->ssh_tls.server_hassh = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_hassh);
    }
} else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC) || (flow_info->detected_protocol.master_protocol == NDPI_PROTOCOL_QUIC)) {
    flow_info->info_type = INFO_QUIC;

    if(flow_info->ndpi_flow->protos.quic.server_names != NULL) {
        flow_info->ssh_tls.server_names = ndpi_strdup(flow_info->ndpi_flow->protos.quic.server_names);
    }

    if(flow_info->ndpi_flow->protos.quic.esni != NULL) {
        flow_info->ssh_tls.encrypted_sni.esni = ndpi_strdup(flow_info->ndpi_flow->protos.quic.esni);
    }

    if(flow_info->ndpi_flow->protos.quic.version != NULL) {
        flow_info->ssh_tls.tls_supported_versions = ndpi_strdup(flow_info->ndpi_flow->protos.quic.version);
    }

    if(enable_ja3_plus) {
        flow_info->ja3_str = ndpi_strdup(flow_info->ndpi_flow->protos.quic.ja3_str);
    }

    if(enable_doh_dot_detection) {
        flow_info->info_type = INFO_DOH_DOT;
        ndpi_snprintf(flow_info->info, sizeof(flow_info->info), "%s", flow_info->ndpi_flow->protos.quic.doh_dot_name);
    }

    if(flow_info->ndpi_flow->protos.quic.tls_version != NULL) {
        flow_info->ssh_tls.tls_supported_versions = ndpi_strdup(flow_info->ndpi_flow->protos.quic.tls_version);
    }
}