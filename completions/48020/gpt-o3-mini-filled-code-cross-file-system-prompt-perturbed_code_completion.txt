else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
    flow_info->info_type = INFO_SSH;
    if(flow_info->ndpi_flow->protos.ssh.client_banner[0] != '\0')
      flow_info->ssh.client_banner = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_banner);
    if(flow_info->ndpi_flow->protos.ssh.server_banner[0] != '\0')
      flow_info->ssh.server_banner = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_banner);
    if(flow_info->ndpi_flow->protos.ssh.client_hash[0] != '\0') {
      u_int j;
      flow_info->ssh.client_hash = ndpi_malloc(sizeof(flow_info->ndpi_flow->protos.ssh.client_hash) * 2 + 1);
      for(i = 0, j = 0; i < sizeof(flow_info->ndpi_flow->protos.ssh.client_hash); i++) {
        sprintf(&flow_info->ssh.client_hash[j], "%02x", flow_info->ndpi_flow->protos.ssh.client_hash[i]);
        j += 2;
      }
      flow_info->ssh.client_hash[j] = '\0';
    }
    if(flow_info->ndpi_flow->protos.ssh.server_hash[0] != '\0') {
      u_int j;
      flow_info->ssh.server_hash = ndpi_malloc(sizeof(flow_info->ndpi_flow->protos.ssh.server_hash) * 2 + 1);
      for(i = 0, j = 0; i < sizeof(flow_info->ndpi_flow->protos.ssh.server_hash); i++) {
        sprintf(&flow_info->ssh.server_hash[j], "%02x", flow_info->ndpi_flow->protos.ssh.server_hash[i]);
        j += 2;
      }
      flow_info->ssh.server_hash[j] = '\0';
    }
  } else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS) ||
            is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC)) {
    flow_info->info_type = INFO_TLS;
    ndpi_snprintf(flow_info->tls.ssl_version,
                  sizeof(flow_info->tls.ssl_version),
                  "%s", flow_info->ndpi_flow->protos.tls.ssl_version);
    ndpi_snprintf(flow_info->tls.server_name,
                  sizeof(flow_info->tls.server_name),
                  "%s", flow_info->ndpi_flow->protos.tls.server_name);
    ndpi_snprintf(flow_info->tls.client_version,
                  sizeof(flow_info->tls.client_version),
                  "%s", flow_info->ndpi_flow->protos.tls.client_version);
    ndpi_snprintf(flow_info->tls.cert_validity,
                  sizeof(flow_info->tls.cert_validity),
                  "%s", flow_info->ndpi_flow->protos.tls.cert_validity);
    if(flow_info->ndpi_flow->protos.tls.ja3_fingerprint[0] != '\0')
      flow_info->tls.ja3_fingerprint = ndpi_strdup(flow_info->ndpi_flow->protos.tls.ja3_fingerprint);
    if(flow_info->ndpi_flow->protos.tls.alpn[0] != '\0') {
      ndpi_snprintf(flow_info->tls.alpn,
                    sizeof(flow_info->tls.alpn),
                    "%s", flow_info->ndpi_flow->protos.tls.alpn);
      flow_info->info_type = INFO_TLS_EXT;
    }
    /* Optionally, update payload length distribution based on TLS block lengths here */
  }