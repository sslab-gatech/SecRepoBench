/* Check if the flow corresponds to the SSH protocol.
   If so, copy SSH-related information, such as client and server signatures,
   and client/server hash data to the flow structure.
   */
else if(is_ndpi_proto(flow, NDPI_PROTOCOL_SSH)) {
  if(flow->ndpi_flow->protos.ssh.server_names[0]!= '\0') {
    flow->ssh_tls.server_names = ndpi_strdup(flow->ndpi_flow->protos.ssh.server_names);
  }

  if(flow->ndpi_flow->protos.ssh.tls_alpn[0]!= '\0') {
    flow->ssh_tls.tls_alpn = ndpi_strdup(flow->ndpi_flow->protos.ssh.tls_alpn);
  }

  if(flow->ndpi_flow->protos.ssh.tls_supported_versions[0]!= '\0') {
    flow->ssh_tls.tls_supported_versions = ndpi_strdup(flow->ndpi_flow->protos.ssh.tls_supported_versions);
  }

  if(flow->ndpi_flow->protos.ssh.encrypted_sni.esni[0]!= '\0') {
    flow->ssh_tls.encrypted_sni.esni = ndpi_strdup(flow->ndpi_flow->protos.ssh.encrypted_sni.esni);
  }

  if(flow->ndpi_flow->protos.ssh.tls_issuerDN[0]!= '\0') {
    flow->ssh_tls.tls_issuerDN = ndpi_strdup(flow->ndpi_flow->protos.ssh.tls_issuerDN);
  }

  if(flow->ndpi_flow->protos.ssh.tls_subjectDN[0]!= '\0') {
    flow->ssh_tls.tls_subjectDN = ndpi_strdup(flow->ndpi_flow->protos.ssh.tls_subjectDN);
  }
}
/* Check if the flow corresponds to the TLS protocol or related protocols.
   If the protocol matches, update the flow structure with relevant TLS/QUIC information.
   This includes SSL version, server names, certificate validity dates, and JA3 fingerprints.
   Extract and store SSL/TLS version, server names, and certificate information.
   Copy various TLS/QUIC attributes, including ALPN and fingerprint data, to the flow.
   */
else if(is_ndpi_proto(flow, NDPI_PROTOCOL_TLS) || is_ndpi_proto(flow, NDPI_PROTOCOL_QUIC)) {
  if(flow->ndpi_flow->protos.tls.ssl_version[0]!= '\0') {
    flow->ssh_tls.ssl_version = ndpi_strdup(flow->ndpi_flow->protos.tls.ssl_version);
  }

  if(flow->ndpi_flow->protos.tls.server_names[0]!= '\0') {
    flow->ssh_tls.server_names = ndpi_strdup(flow->ndpi_flow->protos.tls.server_names);
  }

  if(flow->ndpi_flow->protos.tls.tls_alpn[0]!= '\0') {
    flow->ssh_tls.tls_alpn = ndpi_strdup(flow->ndpi_flow->protos.tls.tls_alpn);
  }

  if(flow->ndpi_flow->protos.tls.tls_supported_versions[0]!= '\0') {
    flow->ssh_tls.tls_supported_versions = ndpi_strdup(flow->ndpi_flow->protos.tls.tls_supported_versions);
  }

  if(flow->ndpi_flow->protos.tls.tls_issuerDN[0]!= '\0') {
    flow->ssh_tls.tls_issuerDN = ndpi_strdup(flow->ndpi_flow->protos.tls.tls_issuerDN);
  }

  if(flow->ndpi_flow->protos.tls.tls_subjectDN[0]!= '\0') {
    flow->ssh_tls.tls_subjectDN = ndpi_strdup(flow->ndpi_flow->protos.tls.tls_subjectDN);
  }

  if(flow->ndpi_flow->protos.tls.encrypted_sni.esni[0]!= '\0') {
    flow->ssh_tls.encrypted_sni.esni = ndpi_strdup(flow->ndpi_flow->protos.tls.encrypted_sni.esni);
  }

  if(flow->ndpi_flow->protos.tls.ja3_fingerprint[0]!= '\0') {
    flow->ssh_tls.ja3_fingerprint = ndpi_strdup(flow->ndpi_flow->protos.tls.ja3_fingerprint);
  }

  if(flow->ndpi_flow->protos.tls.ja3s_fingerprint[0]!= '\0') {
    flow->ssh_tls.ja3s_fingerprint = ndpi_strdup(flow->ndpi_flow->protos.tls.ja3s_fingerprint);
  }

  if(flow->ndpi_flow->protos.tls.tls_cert_validity_start[0]!= '\0') {
    flow->ssh_tls.tls_cert_validity_start = ndpi_strdup(flow->ndpi_flow->protos.tls.tls_cert_validity_start);
  }

  if(flow->ndpi_flow->protos.tls.tls_cert_validity_end[0]!= '\0') {
    flow->ssh_tls.tls_cert_validity_end = ndpi_strdup(flow->ndpi_flow->protos.tls.tls_cert_validity_end);
  }
}