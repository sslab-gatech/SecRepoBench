if (is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
    flow_info->info_type = INFO_SSH;

    if (flow_info->ndpi_flow->protos.ssh.client_signature[0] != '\0') {
        size_t client_sig_len = strlen(flow_info->ndpi_flow->protos.ssh.client_signature);
        if (client_sig_len < sizeof(flow_info->ssh.client_signature)) {
            ndpi_snprintf(flow_info->ssh.client_signature, sizeof(flow_info->ssh.client_signature), "%s", flow_info->ndpi_flow->protos.ssh.client_signature);
        }
    }

    if (flow_info->ndpi_flow->protos.ssh.server_signature[0] != '\0') {
        size_t server_sig_len = strlen(flow_info->ndpi_flow->protos.ssh.server_signature);
        if (server_sig_len < sizeof(flow_info->ssh.server_signature)) {
            ndpi_snprintf(flow_info->ssh.server_signature, sizeof(flow_info->ssh.server_signature), "%s", flow_info->ndpi_flow->protos.ssh.server_signature);
        }
    }

    if (flow_info->ndpi_flow->protos.ssh.client_hash[0] != '\0') {
        size_t client_hash_len = strlen(flow_info->ndpi_flow->protos.ssh.client_hash);
        if (client_hash_len < sizeof(flow_info->ssh.client_hash)) {
            ndpi_snprintf(flow_info->ssh.client_hash, sizeof(flow_info->ssh.client_hash), "%s", flow_info->ndpi_flow->protos.ssh.client_hash);
        }
    }

    if (flow_info->ndpi_flow->protos.ssh.server_hash[0] != '\0') {
        size_t server_hash_len = strlen(flow_info->ndpi_flow->protos.ssh.server_hash);
        if (server_hash_len < sizeof(flow_info->ssh.server_hash)) {
            ndpi_snprintf(flow_info->ssh.server_hash, sizeof(flow_info->ssh.server_hash), "%s", flow_info->ndpi_flow->protos.ssh.server_hash);
        }
    }
} else if (is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS) ||
           is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC) ||
           (flow_info->detected_protocol.master_protocol == NDPI_PROTOCOL_TLS) ||
           (flow_info->detected_protocol.master_protocol == NDPI_PROTOCOL_QUIC)) {
    is_quic = is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC);

    flow_info->info_type = INFO_SSL;
    flow_info->ssl.tls_version = flow_info->ndpi_flow->ssl.tls_version;

    if (flow_info->ndpi_flow->ssl.server_name[0] != '\0') {
        size_t server_name_len = strlen(flow_info->ndpi_flow->ssl.server_name);
        if (server_name_len < sizeof(flow_info->ssl.server_name)) {
            ndpi_snprintf(flow_info->ssl.server_name, sizeof(flow_info->ssl.server_name), "%s", flow_info->ndpi_flow->ssl.server_name);
        }
    }
    flow_info->ssl.not_valid_before = flow_info->ndpi_flow->ssl.not_valid_before;
    flow_info->ssl.not_valid_after = flow_info->ndpi_flow->ssl.not_valid_after;

    if (flow_info->ndpi_flow->ssl.ja3_fingerprint[0] != '\0') {
        size_t ja3_len = strlen(flow_info->ndpi_flow->ssl.ja3_fingerprint);
        if (ja3_len < sizeof(flow_info->ssl.ja3_fingerprint)) {
            ndpi_snprintf(flow_info->ssl.ja3_fingerprint, sizeof(flow_info->ssl.ja3_fingerprint), "%s", flow_info->ndpi_flow->ssl.ja3_fingerprint);
        }
    }

    // ... (Copy other TLS/QUIC attributes like ALPN and fingerprint data)

    if (flow_info->ndpi_flow->ssl.alpn && flow_info->ndpi_flow->ssl.supported_versions) {
        size_t alpn_len = strlen(flow_info->ndpi_flow->ssl.alpn);
        if (alpn_len < sizeof(flow_info->ssl.alpn)) {
            ndpi_snprintf(flow_info->ssl.alpn, sizeof(flow_info->ssl.alpn), "%s", flow_info->ndpi_flow->ssl.alpn);
        }
        flow_info->ssl.supported_versions = flow_info->ndpi_flow->ssl.supported_versions;
        flow_info->info_type = INFO_SSL_WITH_ALPN;
    }
    // ... (Reset and update payload length distribution)
}