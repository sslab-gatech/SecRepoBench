if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_SSH)) {
    if(flow_info->ndpi_flow->protos.ssh.client_signature[0] != '\0')
      flow_info->ssh.client_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.client_signature);
    if(flow_info->ndpi_flow->protos.ssh.server_signature[0] != '\0')
      flow_info->ssh.server_signature = ndpi_strdup(flow_info->ndpi_flow->protos.ssh.server_signature);

    memcpy(flow_info->ssh.client_hash, flow_info->ndpi_flow->protos.ssh.client_hash, sizeof(flow_info->ssh.client_hash));
    memcpy(flow_info->ssh.server_hash, flow_info->ndpi_flow->protos.ssh.server_hash, sizeof(flow_info->ssh.server_hash));
  } else if(is_ndpi_proto(flow_info, NDPI_PROTOCOL_TLS) ||
	    is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC) ||
            is_ndpi_proto(flow_info, NDPI_PROTOCOL_DTLS)) {
    flow_info->ssl.protocol_version = flow_info->ndpi_flow->protos.tls.protocol_version;
    if(flow_info->ndpi_flow->protos.tls.sni[0] != '\0') {
      ndpi_snprintf(flow_info->ssl.server_name, sizeof(flow_info->ssl.server_name), "%s", flow_info->ndpi_flow->protos.tls.sni);
    }
    if(flow_info->ndpi_flow->protos.tls.ja3_fingerprint[0] != '\0') {
      ndpi_snprintf(flow_info->ssl.ja3_fingerprint, sizeof(flow_info->ssl.ja3_fingerprint), "%s", flow_info->ndpi_flow->protos.tls.ja3_fingerprint);
    }

    flow_info->ssl.not_before = flow_info->ndpi_flow->protos.tls.not_before;
    flow_info->ssl.not_after = flow_info->ndpi_flow->protos.tls.not_after;

    // Copy various TLS/QUIC attributes
    memcpy(flow_info->ssl.client_random, flow_info->ndpi_flow->protos.tls.client_random, NDPI_RANDOM_BYTES_LEN);
    memcpy(flow_info->ssl.server_random, flow_info->ndpi_flow->protos.tls.server_random, NDPI_RANDOM_BYTES_LEN);
    flow_info->ssl.alpn = flow_info->ndpi_flow->protos.tls.alpn;
    if (flow_info->ssl.alpn) {
        flow_info->info_type = INFO_GENERIC;
        ndpi_snprintf(flow_info->info, sizeof(flow_info->info), "%s", flow_info->ndpi_flow->protos.tls.alpn_str);
    }

    if(flow_info->ndpi_flow->protos.tls.supported_versions[0] != '\0') {
      ndpi_snprintf(flow_info->ssl.supported_versions, sizeof(flow_info->ssl.supported_versions), "%s", flow_info->ndpi_flow->protos.tls.supported_versions);
    }
    if(flow_info->ndpi_flow->protos.tls.ja3_plus_fingerprint[0] != '\0') {
        ndpi_snprintf(flow_info->ssl.ja3_plus_fingerprint, sizeof(flow_info->ssl.ja3_plus_fingerprint), "%s", flow_info->ndpi_flow->protos.tls.ja3_plus_fingerprint);
    }
    is_quic = is_ndpi_proto(flow_info, NDPI_PROTOCOL_QUIC);
  }