if (strncmp(aux, "RG", 2) == 0) {
            char *rg = (char *)aux+3;
            brg = sam_hrecs_find_rg(fd->header->hrecs, rg);
            if (!brg) {
                hts_log_warning("Read group '%s' not present in header", rg);
            }
            if (cram_stats_add(c->stats[DS_RG], brg ? brg->id : -1) < 0)
                goto block_err;
        } else if (strncmp(aux, "MD", 2) == 0) {
            if (!md) {
                if (kputsn((char *)aux+3, bam_auxB_len(aux), MD) < 0)
                    goto block_err;
            }
            if (!verbatim_MD)
                continue;
        } else if (strncmp(aux, "NM", 2) == 0) {
            if (!verbatim_NM)
                continue;
        }

        // Generic aux storage
        if (!(tm = c->tags_used->find_or_insert(aux[0]<<8|aux[1])))
            goto block_err;

        if (!tm->codec) {
            if (!(tm->codec = cram_encoder_init(E_EXTERNAL, aux[2], 
                                                E_BYTE_ARRAY_BLOCK, NULL,
                                                fd->version, &fd->vv)))
                goto block_err;
            tm->codec->content_id = DS_aux + (aux[0]<<8) + aux[1];
        }

        if (tm->codec->store(tm->codec, aux+3, bam_auxB_len(aux), aux[2]) < 0)
            goto block_err;

        tm->blk = tm->codec->out;