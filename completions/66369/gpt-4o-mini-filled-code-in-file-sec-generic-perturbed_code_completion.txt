case 'R':
            if (cram_add_read_group(c, s, r, &aux[1]) < 0) {
                hts_log_error("Failed to add read group");
                goto err;
            }
            break;

        case 'M':
            if (verbatim_MD) {
                if (cram_add_mismatch(c, s, r, &aux[1]) < 0) {
                    hts_log_error("Failed to add mismatch");
                    goto err;
                }
            } else {
                if (cram_add_mismatch(c, s, r, &aux[1]) < 0) {
                    hts_log_error("Failed to add mismatch");
                    goto err;
                }
            }
            break;

        case 'N':
            if (cram_add_nm(c, s, r, &aux[1]) < 0) {
                hts_log_error("Failed to add NM");
                goto err;
            }
            break;

        default:
            hts_log_warning("Unknown auxiliary tag '%c'", aux[0]);
            break;
        }
    }