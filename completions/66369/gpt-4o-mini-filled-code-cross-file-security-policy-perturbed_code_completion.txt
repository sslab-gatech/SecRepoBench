if (aux_end - aux < 4 || aux[0] != 'R' || aux[1] != 'G' || aux[2] != 'Z') {
            goto err;
        }

        size_t rg_len = strlen(aux + 3);
        if (rg_len + 1 > (size_t)(aux_end - aux)) {
            goto err;
        }

        // Ensure null-termination
        aux[3 + rg_len] = '\0';

        // Process the RG tag
        BLOCK_APPEND(s->aux_blk, aux, 3 + rg_len + 1);
        cr->aux_size += 3 + rg_len + 1;

        aux += 3 + rg_len + 1; // Move to the next tag