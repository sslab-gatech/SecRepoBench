// RG:Z
if (TN[0] == 'R' && TN[1] == 'G') {
    const char *rg = sam_hdr_line_name(fd->header, "RG", cr->rg);
    if (!rg)
        continue;

    size_t rg_len = strlen(rg);
    tag_data[2] = 'Z';
    BLOCK_APPEND(s->aux_blk, (char *)tag_data, 3);
    BLOCK_APPEND(s->aux_blk, rg, rg_len);
    BLOCK_APPEND_CHAR(s->aux_blk, '\0');
    cr->aux_size += 3 + rg_len + 1;
    cr->rg = -1; // prevents auto-add later
    continue;
}