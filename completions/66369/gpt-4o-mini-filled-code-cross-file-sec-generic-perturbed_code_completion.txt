if (aux[0] == 'R' && aux[1] == 'G') {
            // Handle RG:Z tag
            const char *rg = sam_hdr_line_name(c->comp_hdr->header, "RG", aux[2]);
            if (rg) {
                size_t rg_len = strlen(rg);
                BLOCK_APPEND(s->aux_blk, aux, 3);
                BLOCK_APPEND(s->aux_blk, rg, rg_len);
                BLOCK_APPEND_CHAR(s->aux_blk, '\0');
                cr->aux_size += 3 + rg_len + 1;
            } else {
                hts_log_warning("Missing RG header for tag: %s", aux);
            }
        } else if (aux[0] == 'M' && aux[1] == 'D') {
            // Handle MD:Z tag
            BLOCK_APPEND(s->aux_blk, aux, 3);
            cr->aux_size += 3; // MD tag size
        } else if (aux[0] == 'N' && aux[1] == 'M') {
            // Handle NM:i tag
            BLOCK_APPEND(s->aux_blk, aux, 3);
            cr->aux_size += 3; // NM tag size
        } else {
            // Handle other tags
            int tag_size = 3; // Base size for tag
            // Assume we have a function to get the size of the value
            int value_size = get_value_size(aux);
            if (value_size < 0) {
                hts_log_error("Invalid value size for tag: %s", aux);
                goto err;
            }
            BLOCK_APPEND(s->aux_blk, aux, tag_size);
            cr->aux_size += tag_size + value_size;
        }