if (aux[0] == 'R' && aux[1] == 'G' && aux[2] == 'Z') {
            char *rg = (char *)aux+3;
            khint_t k = kh_get(m_s2i, c->tags_used, "RG");
            int kv;
            if (k == kh_end(c->tags_used)) {
                if (cram_add_aux(fd, c, s, cr, aux, aux_size) < 0)
                    return NULL;
            } else {
                kv = kh_value(c->tags_used, k);
                cram_tag_map *tm = (cram_tag_map *)kh_val(c->tags_used, k);
                if (cram_stats_add(c->stats[DS_RG], tm->codec_id) < 0)
                    return NULL;
                cr->rg = tm->codec_id;
                brg = sam_hrecs_find_rg(fd->header->hrecs, rg);
            }
        } else if ((aux[0] == 'M' && aux[1] == 'D' && aux[2] == 'Z') ||
                   (aux[0] == 'N' && aux[1] == 'M' && aux[2] == 'i')) {
            if (verbatim_NM_MD) {
                if (cram_add_aux(fd, c, s, cr, aux, aux_size) < 0)
                    return NULL;
            }
        } else {
            if (cram_add_aux(fd, c, s, cr, aux, aux_size) < 0)
                return NULL;
        }

        aux += aux_size;
        tm->blk->m = tm->m;
    }