if (aux[0] == 'R' && aux[1] == 'G') {
            // Handle RG:Z tag
            const char *rg = sam_hdr_line_name(filedescriptor->header, "RG", aux + 3);
            if (rg) {
                size_t rg_len = strlen(rg);
                BLOCK_APPEND(s->aux_blk, "RG", 2);
                BLOCK_APPEND(s->aux_blk, rg, rg_len);
                BLOCK_APPEND_CHAR(s->aux_blk, '\0');
                cr->aux_size += 2 + rg_len + 1;
            } else {
                // Log warning if RG is missing
                fprintf(stderr, "Warning: RG tag present but no corresponding Read Group found.\n");
            }
        } else if (aux[0] == 'M' && aux[1] == 'D') {
            // Handle MD:Z tag
            BLOCK_APPEND(s->aux_blk, aux, 3);
            cr->aux_size += 3;
        } else if (aux[0] == 'N' && aux[1] == 'M') {
            // Handle NM:i tag
            BLOCK_APPEND(s->aux_blk, aux, 3);
            cr->aux_size += 3;
        } else {
            // Handle other tags
            BLOCK_APPEND(s->aux_blk, aux, 3);
            cr->aux_size += 3;
        }