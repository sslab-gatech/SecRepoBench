// RG:Z
    // This code block handles the processing of auxiliary tags during CRAM
    // encoding. It checks the presence of specific tags like RG (Read Group),
    // MD (Mismatch Description), and NM (Number of Mismatches) and applies
    // specific logic to either store them directly, append special markers,
    // or log warnings if expected header records are missing. The block also
    // manages the encoding of auxiliary data, creating and using codecs based
    // on the tag's type (e.g., string, integer, float). For container-level
    // tracking, it adds integer keys to a tag map and uses these keys to
    // initialize and configure the codecs, updating both slice-level and
    // global CRAM metrics as appropriate. Each auxiliary tag's data is then
    // appended to the corresponding blocks designated for external storage.
    while (aux_end - aux >= 1 && aux[0] != 0) {
        int r;

        // Room for code + type + at least 1 byte of data
        if (aux - orig >= aux_size - 3)
            goto err;

        // RG:Z
        if (aux[0] == 'R' && aux[1] == 'G' && aux[2] == 'Z') {
            // Store RG tag directly
            BLOCK_APPEND(s->aux_blk, aux, 3);
            BLOCK_APPEND(s->aux_blk, orig + 3, aux_size - 3);
            cr->rg = cram_add_rg(fd, c, s, cr, orig + 3, aux_size - 3);
            if (cr->rg < 0)
                goto err;
        } else if (aux[0] == 'M' && aux[1] == 'D') {
            // MD tag is handled separately
            if (has_MD == 0)
                *has_MD = 1;
        } else if (aux[0] == 'N' && aux[1] == 'M') {
            // NM tag is handled separately
            if (has_NM == 0)
                *has_NM = 1;
        } else {
            // Unknown tag, log warning and skip
            hts_log_warning("Unknown auxiliary tag: %c%c", aux[0], aux[1]);
            aux += 3;
            continue;
        }

        aux += 3;
    }