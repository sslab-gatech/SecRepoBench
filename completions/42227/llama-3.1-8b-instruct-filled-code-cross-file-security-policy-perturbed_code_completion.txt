if (it8_parser->ch == '\'' || it8_parser->ch == '\"')
{
    cmsUInt32Number bufferCapacity = 256;
    cmsUInt32Number bufferUsed = 0;
    char* stringBuffer = (char*)malloc(bufferCapacity * sizeof(char));
    cmsBool stringEnded = FALSE;

    while (!stringEnded)
    {
        if (it8_parser->ch == it8_parser->quoteChar)
        {
            stringBuffer[bufferUsed] = '\0';
            stringEnded = TRUE;
        }
        else if (it8_parser->ch == '\n' || it8_parser->ch == '\r')
        {
            stringBuffer[bufferUsed] = '\0';
            stringEnded = TRUE;
        }
        else if (bufferUsed < bufferCapacity - 1)
        {
            stringBuffer[bufferUsed] = it8_parser->ch;
            bufferUsed++;
        }

        if (it8_parser->ch == '\0')
        {
            break;
        }

        NextCh(it8_parser);
    }

    if (stringEnded)
    {
        cmsStringPtr stringPtr = StringPtr(stringBuffer);
        cmsIT8SetString(it8_parser, stringPtr);
        free(stringBuffer);
    }
    else
    {
        free(stringBuffer);
        SynError(it8_parser, "Invalid string");
    }
}