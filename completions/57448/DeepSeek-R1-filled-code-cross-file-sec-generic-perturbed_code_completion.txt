if (flow->protos.tls_quic.server_names == NULL) {
    flow->protos.tls_quic.server_names = ndpi_strdup(dNSName);
    if (flow->protos.tls_quic.server_names != NULL) {
        flow->protos.tls_quic.server_names_len = dns_name_length;
    }
} else {
    size_t new_len = flow->protos.tls_quic.server_names_len + dns_name_length + 2; /* +1 for comma, +1 for null term */
    char *new_buf = ndpi_realloc(flow->protos.tls_quic.server_names, new_len);
    
    if (new_buf != NULL) {
        flow->protos.tls_quic.server_names = new_buf;
        strncat(flow->protos.tls_quic.server_names, ",", new_len - flow->protos.tls_quic.server_names_len - 1);
        strncat(flow->protos.tls_quic.server_names, dNSName, new_len - flow->protos.tls_quic.server_names_len - 1);
        flow->protos.tls_quic.server_names_len += dns_name_length + 1;
    }
}