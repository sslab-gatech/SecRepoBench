if (flow->protos.tls_quic.server_names == NULL) {
  flow->protos.tls_quic.server_names = ndpi_strdup(dNSName);
  flow->protos.tls_quic.server_names_len = dns_name_length;
} else {
  size_t current_len = flow->protos.tls_quic.server_names_len;
  size_t new_len = current_len + dns_name_length + 2; // +2 for comma and space

  char *new_server_names = realloc(flow->protos.tls_quic.server_names, new_len + 1); // +1 for null terminator
  if (new_server_names == NULL) {
    // Handle memory allocation failure
    ndpi_set_risk(ndpi_struct, flow, NDPI_MEMORY_ALLOCATION_FAILED, NULL);
    break;
  }

  flow->protos.tls_quic.server_names = new_server_names;
  snprintf(flow->protos.tls_quic.server_names + current_len, new_len + 1 - current_len, ", %s", dNSName);
  flow->protos.tls_quic.server_names_len = new_len;
}