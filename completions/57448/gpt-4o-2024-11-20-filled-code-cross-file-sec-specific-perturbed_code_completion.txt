if (flow->protos.tls_quic.server_names == NULL) {
  // Allocate memory for the first server name
  flow->protos.tls_quic.server_names = ndpi_strdup(dNSName);
  flow->protos.tls_quic.server_names_len = dns_name_length;
} else {
  // Calculate the new length for the concatenated string
  u_int16_t new_len = flow->protos.tls_quic.server_names_len + dns_name_length + 1; // +1 for the comma separator

  // Allocate memory for the new concatenated string
  char *new_server_names = (char *)malloc(new_len + 1); // +1 for the null terminator
  if (new_server_names == NULL) {
    // Handle memory allocation failure
    ndpi_set_risk(ndpi_struct, flow, NDPI_MEMORY_ALLOCATION_FAILED, "Failed to allocate memory for server names");
    break;
  }

  // Copy the existing server names and append the new one
  snprintf(new_server_names, new_len + 1, "%s,%s", flow->protos.tls_quic.server_names, dNSName);

  // Free the old server names and update the structure
  free(flow->protos.tls_quic.server_names);
  flow->protos.tls_quic.server_names = new_server_names;
  flow->protos.tls_quic.server_names_len = new_len;
}