if(flow->protos.tls_quic.server_names == NULL) {
  flow->protos.tls_quic.server_names = ndpi_strdup(dNSName);
} else {
  u_int32_t old_len = strlen(flow->protos.tls_quic.server_names);
  u_int32_t new_len = old_len + 1 + dns_name_length + 1; // comma + dNSName + null terminator

  // Simple check to avoid very unlikely integer overflow
  if(new_len <= old_len || new_len <= dns_name_length) {
    // Something went wrong, skip
    break;
  }

  char *new_ptr = ndpi_malloc(new_len);
  if(new_ptr) {
    ndpi_snprintf(new_ptr, new_len, "%s,%s", flow->protos.tls_quic.server_names, dNSName);
    ndpi_free(flow->protos.tls_quic.server_names);
    flow->protos.tls_quic.server_names = new_ptr;
  }
}