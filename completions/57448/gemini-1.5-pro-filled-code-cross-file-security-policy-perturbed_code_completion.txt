if (flow->protos.tls_quic.server_names == NULL) {
  flow->protos.tls_quic.server_names = ndpi_strdup(dNSName);
  flow->protos.tls_quic.server_names_len = dns_name_length;
} else {
  size_t current_len = flow->protos.tls_quic.server_names_len;
  size_t new_data_len = dns_name_length;
  size_t additional_space = 2; // for comma and null terminator

  // Check for potential overflow
  if (current_len > SIZE_MAX - new_data_len - additional_space) {
    // Handle overflow (e.g., log error, return early)
    ndpi_set_risk(ndpi_struct, flow, NDPI_MEMORY_ALLOC_ERROR, NULL);
    break;
  }

  size_t new_len = current_len + new_data_len + additional_space;
  char *new_str = realloc(flow->protos.tls_quic.server_names, new_len);

  if (new_str == NULL) {
    // Handle memory allocation failure
    ndpi_set_risk(ndpi_struct, flow, NDPI_MEMORY_ALLOC_ERROR, NULL);
    break;
  }

  flow->protos.tls_quic.server_names = new_str;
  strcat(flow->protos.tls_quic.server_names, ",");
  strcat(flow->protos.tls_quic.server_names, dNSName);
  flow->protos.tls_quic.server_names_len = new_len -1; // Exclude null terminator from length
}