if(flow->protos.tls_quic.server_names == NULL) {
  flow->protos.tls_quic.server_names = ndpi_strdup(dNSName);
  flow->protos.tls_quic.server_names_length = strlen(dNSName);
} else {
  char *new_server_names = ndpi_realloc(flow->protos.tls_quic.server_names, flow->protos.tls_quic.server_names_length + strlen(dNSName) + 2);
  if(new_server_names != NULL) {
    flow->protos.tls_quic.server_names = new_server_names;
    strcat(flow->protos.tls_quic.server_names, ",");
    strcat(flow->protos.tls_quic.server_names, dNSName);
    flow->protos.tls_quic.server_names_length += strlen(dNSName) + 1;
  }
}

if(flow->protos.tls_quic.server_names_length > sizeof(flow->protos.tls_quic.server_names)) {
  ndpi_set_risk(ndpi_struct, flow, NDPI_TLS_SERVER_NAMES_TOO_LONG, NULL);
}