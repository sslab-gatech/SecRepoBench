if(flow->protos.tls_quic.server_names == NULL) {
    flow->protos.tls_quic.server_names = ndpi_strdup(dNSName);
    flow->protos.tls_quic.server_names_len = dns_name_length;
} else {
    char *new_str;
    u_int new_len = flow->protos.tls_quic.server_names_len + dns_name_length + 2; /* +2 for comma and null terminator */
    
    if((new_str = (char*)ndpi_malloc(new_len)) != NULL) {
        snprintf(new_str, new_len, "%s,%s", flow->protos.tls_quic.server_names, dNSName);
        ndpi_free(flow->protos.tls_quic.server_names);
        flow->protos.tls_quic.server_names = new_str;
        flow->protos.tls_quic.server_names_len = new_len - 1; /* exclude null terminator */
    }
}