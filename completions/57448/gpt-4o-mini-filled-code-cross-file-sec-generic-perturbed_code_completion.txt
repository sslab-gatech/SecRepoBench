if (flow->protos.tls_quic.server_names == NULL) {
    flow->protos.tls_quic.server_names = ndpi_strdup(dNSName);
    flow->protos.tls_quic.server_names_length = dns_name_length;
} else {
    size_t new_length = strlen(flow->protos.tls_quic.server_names) + dns_name_length + 2; // +2 for comma and null terminator
    char *new_server_names = (char *)ndpi_malloc(new_length);
    if (new_server_names) {
        snprintf(new_server_names, new_length, "%s,%s", flow->protos.tls_quic.server_names, dNSName);
        ndpi_free(flow->protos.tls_quic.server_names);
        flow->protos.tls_quic.server_names = new_server_names;
        flow->protos.tls_quic.server_names_length = new_length - 1; // Exclude null terminator
    }
}