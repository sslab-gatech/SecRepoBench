if(flow->protos.tls_quic.server_names == NULL) {
    flow->protos.tls_quic.server_names = ndpi_strdup(dNSName);
    flow->protos.tls_quic.server_names_length = strlen(dNSName);
} else {
    size_t old_len = strlen(flow->protos.tls_quic.server_names);
    size_t dns_len = strlen(dNSName);
    size_t new_len = old_len + 1 /* for comma */ + dns_len;
    char *new_server_names = (char *) malloc(new_len + 1);
    if(new_server_names) {
        snprintf(new_server_names, new_len + 1, "%s,%s", flow->protos.tls_quic.server_names, dNSName);
        free(flow->protos.tls_quic.server_names);
        flow->protos.tls_quic.server_names = new_server_names;
        flow->protos.tls_quic.server_names_length = new_len;
    }
}