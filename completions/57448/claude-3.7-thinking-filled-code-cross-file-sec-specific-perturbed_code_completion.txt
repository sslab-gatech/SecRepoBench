if(flow->protos.tls_quic.server_names == NULL) {
  flow->protos.tls_quic.server_names = ndpi_strdup(dNSName);
  flow->protos.tls_quic.server_names_len = dns_name_length;
} else {
  char *old_str = flow->protos.tls_quic.server_names;
  char tmp_buf[2048]; /* Same size as rdnSeqBuf */
  
  if(flow->protos.tls_quic.server_names_len + 1 + dns_name_length < sizeof(tmp_buf)) {
    snprintf(tmp_buf, sizeof(tmp_buf), "%s,%s", old_str, dNSName);
    
    flow->protos.tls_quic.server_names = ndpi_strdup(tmp_buf);
    
    if(flow->protos.tls_quic.server_names) {
      ndpi_free(old_str);
      flow->protos.tls_quic.server_names_len = strlen(flow->protos.tls_quic.server_names);
    } else {
      /* If allocation failed, restore the original pointer */
      flow->protos.tls_quic.server_names = old_str;
    }
  }
}