if (flow->protos.tls_quic.server_names == NULL) {
    flow->protos.tls_quic.server_names = ndpi_strdup(dNSName);
} else {
    size_t current_length = strlen(flow->protos.tls_quic.server_names);
    size_t new_length = current_length + strlen(dNSName) + 2; // +2 for comma and null terminator

    if (new_length < sizeof(flow->protos.tls_quic.server_names)) {
        snprintf(flow->protos.tls_quic.server_names + current_length, new_length - current_length, ",%s", dNSName);
    }
}