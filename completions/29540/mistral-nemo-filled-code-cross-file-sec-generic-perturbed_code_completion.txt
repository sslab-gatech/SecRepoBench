if ( nfields <= 0 || nelems < 1 ) {
        return;
    }

    size_t nbytes = nfields * nelems * sizeof(matvar_t*);
    fields = (matvar_t**)malloc(nbytes);
    if ( NULL == fields ) {
        Mat_Critical("Error allocating memory for fields");
        return;
    }

    data_variable->data = (void*)fields;
    data_variable->internal->fieldnames = (char**)realloc((void*)data_variable->internal->fieldnames, nfields * sizeof(char*));
    if ( NULL == data_variable->internal->fieldnames ) {
        Mat_Critical("Error reallocating memory for field names");
        free(fields);
        data_variable->data = NULL;
        return;
    }

    data_variable->internal->num_fields = nfields;