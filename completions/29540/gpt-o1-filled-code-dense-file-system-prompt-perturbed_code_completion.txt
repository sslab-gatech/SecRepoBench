if (nfields < 1 || nelems < 1) {
        return;
    }

    /* Set class type to structure */
    data_variable->class_type = MAT_C_STRUCT;

    /* Set the data size to pointer size */
    data_variable->data_size = sizeof(matvar_t **);

    /* Calculate total bytes needed for all fields, check for overflow, then allocate */
    {
        size_t total_fields = (size_t)(nfields * nelems);
        if (total_fields > SIZE_MAX / sizeof(matvar_t *)) {
            Mat_Critical("Integer multiplication overflow");
            return;
        }
        data_variable->nbytes = total_fields * sizeof(matvar_t *);
    }

    data_variable->data = malloc(data_variable->nbytes);
    if (NULL == data_variable->data) {
        Mat_Critical("Error allocating memory for data_variable->data");
        return;
    }
    memset(data_variable->data, 0, data_variable->nbytes);

    /* Set fields pointer for batch processing later */
    fields = (matvar_t **)data_variable->data;