if (nfields < 1 || nelems < 1) {
        data_variable->nbytes = 0;
        data_variable->data = NULL;
        return;
    }

    {
        size_t nfields_size = (size_t)nfields;
        size_t nelems_size = (size_t)nelems;

        /* Check for overflow before multiplication */
        if (nfields_size > SIZE_MAX / nelems_size) {
            Mat_Critical("Size overflow in field array allocation");
            return;
        }
        size_t total_elems = nfields_size * nelems_size;
        if (total_elems > SIZE_MAX / sizeof(matvar_t*)) {
            Mat_Critical("Size overflow in field array allocation");
            return;
        }

        data_variable->nbytes = total_elems * sizeof(matvar_t*);
        fields = (matvar_t**)calloc(total_elems, sizeof(matvar_t*));
        if (NULL == fields) {
            data_variable->nbytes = 0;
            Mat_Critical("Error allocating memory for matvar->data");
            return;
        }

        data_variable->data = fields;
    }