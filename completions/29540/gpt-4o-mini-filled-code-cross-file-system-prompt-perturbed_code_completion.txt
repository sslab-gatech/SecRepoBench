if (nfields < 1 || data_variable->dims == NULL) {
        return;
    }

    size_t nbytes = 0;
    for (hsize_t i = 0; i < nfields; i++) {
        nbytes += Mat_VarSizeOf(data_variable->internal->fieldnames[i]);
    }

    fields = (matvar_t **)malloc(nbytes);
    if (fields == NULL) {
        Mat_Critical("Error allocating memory for fields array");
        return;
    }
    data_variable->data = fields;