{
  u_int16_t qtype;
  if(offset >= flow->packet.payload_packet_len)
    return 1;

  /* Iterate over the domain name until the null terminator is found */
  while((offset < flow->packet.payload_packet_len) && (flow->packet.payload[offset] != '\0')) {
    offset++;
  }

  if(offset >= flow->packet.payload_packet_len)
    return 1;

  /* Skip the null terminator */
  offset++;

  /* Ensure there are at least two bytes available to read the query type */
  if((offset + 1) >= flow->packet.payload_packet_len)
    return 1;

  /* Read the query type (2 bytes) */
  qtype = get16(&offset, flow->packet.payload);
  NDPI_LOG_DBG(ndpi_struct, "DNS Query type: %u", qtype);
}