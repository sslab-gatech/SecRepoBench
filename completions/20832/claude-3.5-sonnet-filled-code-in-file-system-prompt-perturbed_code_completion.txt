{
    while (offset < flow->packet.payload_packet_len && flow->packet.payload[offset] != '\0') {
        offset++;
    }
    
    if (offset + 4 <= flow->packet.payload_packet_len) {
        offset++; // Skip the null terminator
        u_int16_t query_type = ntohs(*(u_int16_t*)&flow->packet.payload[offset]);
        flow->protos.dns.query_type = query_type;
        
#ifdef DNS_DEBUG
        NDPI_LOG_DBG2(ndpi_struct, "DNS query type: %u\n", query_type);
#endif
    }
    
    return 0; // Valid DNS query
}