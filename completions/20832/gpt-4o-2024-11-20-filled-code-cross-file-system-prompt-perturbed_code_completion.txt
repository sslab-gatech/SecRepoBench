while((offset < flow->packet.payload_packet_len) && (flow->packet.payload[offset] != '\0')) {
        offset++;
      }

      if(offset >= flow->packet.payload_packet_len) {
        return 1; /* invalid */
      }

      offset++; /* Skip the null character */

      if((offset + 4) > flow->packet.payload_packet_len) {
        return 1; /* invalid */
      }

      u_int16_t query_type = ntohs(*(u_int16_t*)&flow->packet.payload[offset]);
      offset += 2; /* Move past query type */

      u_int16_t query_class = ntohs(*(u_int16_t*)&flow->packet.payload[offset]);
      offset += 2; /* Move past query class */

#ifdef DEBUG
      printf("DNS Query Type: %u, Query Class: %u\n", query_type, query_class);
#endif