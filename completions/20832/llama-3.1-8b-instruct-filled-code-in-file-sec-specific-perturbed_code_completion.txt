if((dns_header->num_queries > 0) && (dns_header->num_queries <= NDPI_MAX_DNS_REQUESTS)
   && (((dns_header->flags & 0x2800) == 0x2800 /* Dynamic DNS Update */)
       || ((dns_header->num_answers == 0) && (dns_header->authority_rrs == 0)))) 
   // Extract the query type from the DNS query section of the packet.
   // Iterate over the payload starting from the current offset until a null character is found.
   // Once the null character is found, increment the offset and read the query type.
   // Optionally, log the query type for debugging purposes.
   // Ensure the operation is performed within the packet's payload length.
   {
     u_int8_t *query_type = (u_int8_t*)&flow->packet.payload[offset];
     u_int8_t query_type_len = 0;
     while((offset < flow->packet.payload_packet_len) && (query_type[query_type_len]!= '\0')) {
       query_type_len++;
       offset++;
     }
     if(query_type_len > 0) {
       // Log the query type for debugging purposes
       // printf("[query_type: %s]\n", query_type);
     }
   }
 else
    return(1 /* invalid */);