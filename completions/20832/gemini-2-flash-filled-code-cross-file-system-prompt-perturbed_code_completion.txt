{
      while((offset < flow->packet.payload_packet_len)
	    && (flow->packet.payload[offset] != '\0')) {
	offset++;
      }

      if(offset < flow->packet.payload_packet_len) {
	offset++; /* Skip the null terminator */

	if((offset + 4) <= flow->packet.payload_packet_len) {
	  u_int16_t query_type = ntohs(*(u_int16_t*)&flow->packet.payload[offset]);
	  /*
	  NDPI_LOG_DBG(ndpi_struct, "DNS Query Type: %u\n", query_type);
	  */
	  flow->protos.dns.query_type = query_type;
	} else {
	  return 1;
	}
      } else {
	return 1;
      }
    }