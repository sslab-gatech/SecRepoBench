{
      int name_length = 0;
      int temp_offset = offset;

      while ((temp_offset < flow->packet.payload_packet_len) && (flow->packet.payload[temp_offset] != '\0')) {
        temp_offset++;
        name_length++;
      }

      if (temp_offset < flow->packet.payload_packet_len) {
        offset = temp_offset + 1;

        if ((offset + 4) <= flow->packet.payload_packet_len) {
          u_int16_t query_type = ntohs(*(u_int16_t*)&flow->packet.payload[offset]);
          offset += 2;
          u_int16_t query_class = ntohs(*(u_int16_t*)&flow->packet.payload[offset]);
          offset += 2;

          flow->protos.dns.query_type = query_type;
          /*printf("DNS Query Type: %u\n", query_type);*/
        } else {
          return 1; // Invalid: not enough data for query type and class
        }
      } else {
        return 1; // Invalid: null terminator not found within payload length
      }
    }