u_int8_t query_type = flow->packet.payload[offset];
    if (query_type < 1 || query_type > 255) {
        return 1; // invalid query type
    }
    offset++;

    // Ensure we do not exceed the payload length
    if (offset >= flow->packet.payload_packet_len) {
        return 1; // invalid offset
    }

    // Log the query type for debugging purposes
    printf("Query Type: %u\n", query_type);