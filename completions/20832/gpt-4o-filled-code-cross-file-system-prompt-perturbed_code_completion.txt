{
  u_int16_t query_type;
  u_int16_t num;

  for(num = 0; num < dns_header->num_queries; num++) {
    u_int16_t data_len;

    if((offset+6) >= flow->packet.payload_packet_len) {
      break;
    }

    if((data_len = getNameLength(offset, flow->packet.payload, flow->packet.payload_packet_len)) == 0) {
      break;
    } else
      offset += data_len;

    if((offset+2) >= flow->packet.payload_packet_len) {
      break;
    }
    query_type = get16(&offset, flow->packet.payload);
    flow->protos.dns.query_type = query_type;

    /* here x points to the query "class" field */
    if((offset+4) <= flow->packet.payload_packet_len) {
      offset += 4;
    }
  }
}