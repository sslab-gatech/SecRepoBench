{
    u_int16_t query_type;
    while (offset < flow->packet.payload_packet_len && flow->packet.payload[offset] != '\0') {
        offset++;
    }
    offset++; // Skip the null terminator

    if (offset + 2 <= flow->packet.payload_packet_len) {
        query_type = ntohs(*(u_int16_t*)&flow->packet.payload[offset]);
        flow->protos.dns.query_type = query_type;
        // Uncomment the following line for debugging
        // printf("DNS query type: %u\n", query_type);
    }
    return(0 /* valid */);
}