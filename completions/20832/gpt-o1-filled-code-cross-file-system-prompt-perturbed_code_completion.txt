{
  /* Iterate until we find the null terminator of the QNAME. */
  while((offset < flow->packet.payload_packet_len) &&
        (flow->packet.payload[offset] != '\0')) {
    offset++;
  }

  /* Check that there's enough space left in the packet for QTYPE + QCLASS (4 bytes). */
  if((offset + 1 + 4) > flow->packet.payload_packet_len) {
    return(1 /* invalid */);
  }

  /* Advance past the null terminator. */
  offset++;

  /* Extract the QTYPE from the payload. */
  u_int16_t query_type = get16(&offset, flow->packet.payload);

  /* Optionally store or log the QTYPE for debugging. */
  NDPI_LOG_DBG(ndpi_struct, "DNS Query Type: %u\n", query_type);

  /* Advance past the QCLASS field (2 bytes). */
  offset += 2;
}