{
  /* Extract queries. In case of multiple queries, parse them one by one. */
  int i;
  for(i = 0; i < dns_header->num_queries; i++) {
    u_int name_len;

    /* Get the length of the QNAME. */
    name_len = getNameLength(offset, flow->packet.payload, flow->packet.payload_packet_len);
    if(name_len == 0 || (offset + name_len + 4) > flow->packet.payload_packet_len) {
      return(1 /* invalid */);
    }

    /* Skip the QNAME bytes. */
    offset += name_len;

    /* Extract QTYPE. */
    {
      u_int16_t qtype = get16(&offset, flow->packet.payload);
#ifdef DNS_DEBUG
      NDPI_LOG_DBG2(ndpi_struct, "DNS Query: qtype=%u\n", qtype);
#endif
    }

    /* Extract QCLASS. */
    {
      u_int16_t qclass = get16(&offset, flow->packet.payload);
#ifdef DNS_DEBUG
      NDPI_LOG_DBG2(ndpi_struct, "DNS Query: qclass=%u\n", qclass);
#endif
    }
  }
}