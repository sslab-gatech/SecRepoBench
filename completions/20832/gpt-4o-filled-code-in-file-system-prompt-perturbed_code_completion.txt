{
  int query_name_len = 0;

  while((offset < flow->packet.payload_packet_len) && (flow->packet.payload[offset] != '\0')) {
    offset++;
    query_name_len++;
  }

  if(offset < flow->packet.payload_packet_len) {
    offset++; // Skip the null character
    if((offset + 2) <= flow->packet.payload_packet_len) {
      u_int16_t query_type = get16(&offset, flow->packet.payload);
#ifdef DNS_DEBUG
      NDPI_LOG_DBG2(ndpi_struct, "DNS Query Type: %u\n", query_type);
#endif
    }
  }
}