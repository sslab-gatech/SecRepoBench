{
      u_int16_t q_type;
      u_int len = getNameLength(offset, flow->packet.payload, flow->packet.payload_packet_len);

      if(len == 0)
	return(1 /* invalid */);
      else
	offset += len;

      if((offset+4) >= flow->packet.payload_packet_len)
	return(1 /* invalid */);

      q_type = get16(&offset, flow->packet.payload);
      // NDPI_LOG_DBG(ndpi_struct, "DNS query type: %u\n", q_type);
    }