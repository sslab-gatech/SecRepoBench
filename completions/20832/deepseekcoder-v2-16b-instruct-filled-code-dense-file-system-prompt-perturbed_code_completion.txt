// Extract the query type from the DNS query section of the packet.
// Iterate over the payload starting from the current offset until a null character is found.
// Once the null character is found, increment the offset and read the query type.
// Optionally, log the query type for debugging purposes.
// Ensure the operation is performed within the packet's payload length.

u_int16_t query_type;
u_int16_t query_class;
u_int16_t name_length;

offset = payload_offset;

while (offset < flow->packet.payload_packet_len && flow->packet.payload[offset] != '\0') {
    name_length = getNameLength(offset, flow->packet.payload, flow->packet.payload_packet_len);
    if (name_length == 0) break;

    offset += name_length;

    if (offset + 2 >= flow->packet.payload_packet_len) break;
    query_type = get16(&offset, flow->packet.payload);
    query_class = get16(&offset, flow->packet.payload);

    // Log the query type for debugging purposes
    // printf("Query Type: %u, Query Class: %u\n", query_type, query_class);

    offset += 4; // Skip the next 4 bytes (name length and class)
}