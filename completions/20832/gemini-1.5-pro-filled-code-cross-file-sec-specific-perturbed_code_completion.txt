{
      u_int16_t type;

      if (flow->packet.payload_packet_len <= offset) {
          return 1; /* invalid */
      }

      while (offset < flow->packet.payload_packet_len && flow->packet.payload[offset] != '\0') {
          offset++;
      }

      offset++;

      if ((offset + 2) > flow->packet.payload_packet_len) {
          return 1; /* invalid */
      }

      type = get16(&offset, flow->packet.payload);
      NDPI_LOG_DBG(ndpi_struct, "DNS query type: %u\n", type);
    }