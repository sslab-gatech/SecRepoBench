{
  // Ensure the operation is performed within the packet's payload length
  while((offset < flow->packet.payload_packet_len) && (flow->packet.payload[offset] != '\0')) {
    offset++;
  }

  // Check if we have reached the end of the payload
  if(offset >= flow->packet.payload_packet_len) {
    return(1 /* invalid */);
  }

  // Move past the null character
  offset++;

  // Ensure there are at least 2 bytes available for reading the query type
  if((offset + 2) > flow->packet.payload_packet_len) {
    return(1 /* invalid */);
  }

  // Read the query type
  u_int16_t query_type = get16(&offset, flow->packet.payload);

  // Optionally, log the query type for debugging purposes
  // printf("Query type: %u\n", query_type);
}