{
  // Ensure the operation is performed within the packet's payload length
  if (offset >= flow->packet.payload_packet_len) {
    return 1; // invalid
  }

  // Iterate over the payload starting from the current offset until a null character is found
  while ((offset < flow->packet.payload_packet_len) && (flow->packet.payload[offset] != '\0')) {
    offset++;
  }

  // Check if we reached the end of the payload without finding a null character
  if (offset >= flow->packet.payload_packet_len) {
    return 1; // invalid
  }

  // Increment the offset to move past the null character
  offset++;

  // Ensure there is enough space to read the query type
  if ((offset + 2) > flow->packet.payload_packet_len) {
    return 1; // invalid
  }

  // Read the query type
  u_int16_t query_type = get16(&offset, flow->packet.payload);

  // Optionally, log the query type for debugging purposes
  // printf("DNS Query Type: %u\n", query_type);

  // Continue processing as needed
}