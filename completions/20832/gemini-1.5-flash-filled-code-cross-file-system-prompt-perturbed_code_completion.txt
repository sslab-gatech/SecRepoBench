u_int16_t q_type;
    int i;
    
    for(i = 0; i < dns_header->num_queries; i++) {
      u_int16_t data_len;

      if((offset + 6) >= flow->packet.payload_packet_len) {
	break;
      }

      if((data_len = getNameLength(offset, flow->packet.payload, flow->packet.payload_packet_len)) == 0) {
	break;
      } else
	offset += data_len;

      if((offset + 4) >= flow->packet.payload_packet_len) {
	break;
      }

      q_type = get16(&offset, flow->packet.payload);
      flow->protos.dns.q_type = q_type;
      offset += 4;
    }
  }