{
	  int k;
	  for(k=0; k<dns_header->num_queries; k++) {
	    u_int off = offset;
	    while(off < flow->packet.payload_packet_len && flow->packet.payload[off] != '\0') {
	      off++;
	    }

	    if(off >= flow->packet.payload_packet_len)
	      return(1 /* invalid */);

	    off++;
	    if(off+1 >= flow->packet.payload_packet_len)
	      return(1 /* invalid */);

	    offset = off+2; // skip query type

#ifdef DNS_DEBUG
	    NDPI_LOG_DBG2(ndpi_struct, "query type %u\n", get16(&off, flow->packet.payload));
#endif
	  }
	}