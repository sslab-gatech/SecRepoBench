if((dns_header->num_queries > 0) && (dns_header->num_queries <= NDPI_MAX_DNS_REQUESTS)
   && (((dns_header->flags & 0x2800) == 0x2800 /* Dynamic DNS Update */)
       || ((dns_header->num_answers == 0) && (dns_header->authority_rrs == 0)))) {
  // Extract the query type from the DNS query section of the packet.
  u_int16_t query_type = get16(&offset, flow->packet.payload);
  flow->protos.dns.query_type = query_type;

  // Log the query type for debugging purposes.
  NDPI_LOG_DBG(ndpi_struct, "DNS Query Type: %u\n", query_type);

  // Ensure the operation is performed within the packet's payload length.
  if(offset >= flow->packet.payload_packet_len) {
    return(1 /* invalid */);
  }
}