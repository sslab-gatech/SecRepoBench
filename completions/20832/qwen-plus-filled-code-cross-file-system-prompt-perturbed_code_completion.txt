u_int16_t query_type = 0;
int name_length = 0;

while ((offset < flow->packet.payload_packet_len) && (flow->packet.payload[offset] != '\0')) {
  offset++;
}

if (offset < flow->packet.payload_packet_len && flow->packet.payload[offset] == '\0') {
  offset++; // Skip the null character
}

if ((offset + 2) <= flow->packet.payload_packet_len) {
  query_type = get16(&offset, flow->packet.payload);
}

// Optionally log the query type for debugging purposes
#ifdef DEBUG_DNS
printf("DNS Query Type: %u\n", query_type);
#endif

// Ensure that we do not exceed packet payload length while processing
if ((offset + sizeof(u_int16_t)) > flow->packet.payload_packet_len)
  return(1 /* invalid */);

return(0);