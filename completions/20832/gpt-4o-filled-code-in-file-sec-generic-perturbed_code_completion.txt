{
  // Ensure the operation is performed within the packet's payload length
  while (offset < flow->packet.payload_packet_len && flow->packet.payload[offset] != '\0') {
    offset++;
  }

  // Check if we have reached the end of the payload without finding a null character
  if (offset >= flow->packet.payload_packet_len) {
    return 1; // invalid
  }

  // Increment offset to move past the null character
  offset++;

  // Ensure there is enough space to read the query type
  if (offset + 2 > flow->packet.payload_packet_len) {
    return 1; // invalid
  }

  // Read the query type
  u_int16_t query_type = get16(&offset, flow->packet.payload);

#ifdef DNS_DEBUG
  NDPI_LOG_DBG2(ndpi_struct, "DNS Query Type: %u\n", query_type);
#endif

  // Optionally, store or process the query type as needed
}