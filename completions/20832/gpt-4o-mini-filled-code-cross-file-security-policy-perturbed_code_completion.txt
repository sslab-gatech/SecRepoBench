for (int i = 0; i < dns_header->num_queries; i++) {
        if (offset >= flow->packet.payload_packet_len) {
            return 1; // invalid
        }

        while (offset < flow->packet.payload_packet_len && flow->packet.payload[offset] != '\0') {
            offset++;
        }

        // Move past the null character
        offset++;

        if (offset + 1 >= flow->packet.payload_packet_len) {
            return 1; // invalid
        }

        u_int16_t query_type = get16(&offset, flow->packet.payload);
        // Optionally log the query type for debugging purposes
        // printf("Query Type: %u\n", query_type);
    }