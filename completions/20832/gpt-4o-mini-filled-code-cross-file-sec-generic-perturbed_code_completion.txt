// Ensure we do not exceed the payload length
    while (offset < flow->packet.payload_packet_len && flow->packet.payload[offset] != '\0') {
        offset++;
    }

    // Check if we reached the end of the payload
    if (offset >= flow->packet.payload_packet_len) {
        return 1; // Invalid if we exceed the payload length
    }

    // Increment offset to skip the null character
    offset++;

    // Read the query type
    if ((offset + 2) > flow->packet.payload_packet_len) {
        return 1; // Invalid if we cannot read the query type
    }

    u_int16_t query_type = get16(&offset, flow->packet.payload);
    
    // Optionally log the query type for debugging
    NDPI_LOG_DBG(ndpi_struct, "Query Type: %u\n", query_type);