{
  while ((offset < flow->packet.payload_packet_len) && (flow->packet.payload[offset] != '\0')) {
    offset++;
  }

  if (offset + 2 > flow->packet.payload_packet_len) {
    return 1; /* invalid */
  }

  offset++; // Move past the null character
  u_int16_t query_type = ntohs(*(u_int16_t*)&flow->packet.payload[offset]);
  offset += 2;

  // Optionally log the query type for debugging purposes
  // printf("Query Type: %u\n", query_type);
}