// Extract the query type from the DNS query section of the packet.
// Iterate over the payload starting from the current offset until a null character is found.
// Once the null character is found, increment the offset and read the query type.
// Optionally, log the query type for debugging purposes.
// Ensure the operation is performed within the packet's payload length.

u_int16_t query_type = 0;
u_int16_t query_class = 0;

if (is_query) {
    // DNS Request
    if ((dns_header->num_queries > 0) && (dns_header->num_queries <= NDPI_MAX_DNS_REQUESTS)
        && (((dns_header->flags & 0x2800) == 0x2800 /* Dynamic DNS Update */)
            || ((dns_header->num_answers == 0) && (dns_header->authority_rrs == 0)))) {
        offset += 4; // Skip the query type and class
        if (offset < flow->packet.payload_packet_len) {
            query_type = get16(&offset, flow->packet.payload);
            query_class = get16(&offset, flow->packet.payload);
#ifdef DNS_DEBUG
            NDPI_LOG_DBG2(ndpi_struct, "Query type: %u, Query class: %u\n", query_type, query_class);
#endif
        }
    } else {
        return 1 /* invalid */;
    }
}