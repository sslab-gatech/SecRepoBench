if (offset + 1 >= flow->packet.payload_packet_len) {
        return 1; // Invalid packet
      }

      u_int8_t query_type = flow->packet.payload[offset++];
      // Log or handle the query type as needed
      // For example, you could print it or store it for further processing
      // printf("Query Type: %u\n", query_type);

      // Ensure that we do not exceed the payload length
      if (offset >= flow->packet.payload_packet_len) {
        return 1; // Invalid packet
      }

      // Continue processing the DNS query as needed