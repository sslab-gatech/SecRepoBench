{
  u_int16_t query_type;
  while (offset < flow->packet.payload_packet_len && flow->packet.payload[offset] != '\0') {
    offset++;
  }
  
  if (offset + 5 <= flow->packet.payload_packet_len) {
    offset += 1; // Skip the null terminator
    query_type = get16(&offset, flow->packet.payload);
    // Optionally, log the query type:
    // NDPI_LOG_DBG(ndpi_struct, "DNS query type: %u\n", query_type);
    return 0; // Valid
  } else {
    return 1; // Invalid
  }
}