u_int16_t q_type;
    u_int16_t q_class;
    
    if((offset + 4) >= flow->packet.payload_packet_len)
      return(1 /* invalid */);

    for(int i = 0; i < dns_header->num_queries; i++) {
      u_int16_t data_len;

      if((data_len = getNameLength(offset, flow->packet.payload, flow->packet.payload_packet_len)) == 0) {
	return(1 /* invalid */);
      } else
	offset += data_len;

      if((offset + 4) >= flow->packet.payload_packet_len) {
	return(1 /* invalid */);
      }

      q_type = get16(&offset, flow->packet.payload);
      q_class = get16(&offset, flow->packet.payload);
      flow->protos.dns.q_type = q_type;
      
      // Log the query type for debugging purposes.
      // NDPI_LOG_DBG(ndpi_struct, "Query type: %u\n", q_type);
    }