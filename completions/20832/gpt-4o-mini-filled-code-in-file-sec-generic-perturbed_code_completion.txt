u_int16_t query_type = get16(&offset, flow->packet.payload);
      flow->protos.dns.query_type = query_type;

      // Ensure the query type is valid
      if (query_type != 0x01 && query_type != 0x1C) { // A or AAAA
        return 1; // invalid query type
      }

      // Optionally log the query type for debugging
#ifdef DNS_DEBUG
      NDPI_LOG_DBG2(ndpi_struct, "Query Type: %u\n", query_type);
#endif