{
	  int name_len;
	  int query_type_offset = offset;

	  // Iterate until null character or end of payload
	  while (query_type_offset < flow->packet.payload_packet_len && flow->packet.payload[query_type_offset] != '\0') {
	    name_len = flow->packet.payload[query_type_offset];
	    query_type_offset += (name_len + 1);
	  }

	  if(query_type_offset < flow->packet.payload_packet_len) {
	    query_type_offset++; // Skip null terminator
	    if(query_type_offset + 1 < flow->packet.payload_packet_len) {
	      u_int16_t query_type = get16(&query_type_offset, flow->packet.payload);
#ifdef DNS_DEBUG
	      NDPI_LOG_DBG2(ndpi_struct, "DNS query type: %u\n", query_type);
#endif
	    }
	  }
	}