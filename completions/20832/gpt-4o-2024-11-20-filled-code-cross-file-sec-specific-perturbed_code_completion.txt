// Ensure the operation is performed within the packet's payload length
      while ((offset < flow->packet.payload_packet_len) && (flow->packet.payload[offset] != '\0')) {
        offset++;
      }

      // Check if we reached the end of the payload without finding a null character
      if (offset >= flow->packet.payload_packet_len) {
        return 1; // invalid
      }

      // Increment offset to move past the null character
      offset++;

      // Ensure there is enough space to read the query type (2 bytes)
      if ((offset + 2) > flow->packet.payload_packet_len) {
        return 1; // invalid
      }

      // Read the query type
      u_int16_t query_type = (flow->packet.payload[offset] << 8) | flow->packet.payload[offset + 1];
      offset += 2;

      // Optionally, log the query type for debugging purposes
      // printf("DNS Query Type: %u\n", query_type);