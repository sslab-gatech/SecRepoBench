{
    u_int16_t query_type = 0;
    while (offset < flow->packet.payload_packet_len && flow->packet.payload[offset] != '\0') {
        offset++;
    }
    
    if (offset + 4 <= flow->packet.payload_packet_len) {
        offset += 1; // Skip the null terminator
        query_type = ntohs(*(u_int16_t*)&flow->packet.payload[offset]);
        // Optionally log the query type (commented out for security)
        // printf("DNS query type: %u\n", query_type);
    }
    
    return(0 /* valid */);
}