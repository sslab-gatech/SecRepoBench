{
    // Skip the query name until we find a null byte
    while((offset < flow->packet.payload_packet_len) && 
          (flow->packet.payload[offset] != '\0')) {
        offset++;
    }
    
    // Move past the null byte to the query type field
    if((offset + 5) > flow->packet.payload_packet_len)
        return(1 /* invalid */);
        
    offset++;
    
    // Read the query type (next 2 bytes)
    u_int16_t query_type = get16(&offset, flow->packet.payload);
    flow->protos.dns.query_type = query_type;
    
    // Skip the class (next 2 bytes)
    offset += 2;
    
    // NDPI_LOG_DBG(ndpi_struct, "DNS query type: %u\n", query_type);
    
    return(0 /* valid */);
}