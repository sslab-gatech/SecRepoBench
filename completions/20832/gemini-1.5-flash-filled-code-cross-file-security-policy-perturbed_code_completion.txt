u_int8_t *qname;
    u_int16_t qtype;
    if (offset + 2 >= flow->packet.payload_packet_len) return 1;
    qname = &flow->packet.payload[offset];
    while ((offset < flow->packet.payload_packet_len) && (*qname != '\0')) {
      offset += strlen((char*)qname) + 1;
      qname = &flow->packet.payload[offset];
    }
    if (offset + 2 >= flow->packet.payload_packet_len) return 1;
    offset++;
    qtype = get16(&offset, flow->packet.payload);
    flow->protos.dns.query_type = qtype;