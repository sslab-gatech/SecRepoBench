{
      int query_offset = offset;
      int query_length = 0;

      while ((query_offset < flow->packet.payload_packet_len) && (flow->packet.payload[query_offset] != '\0')) {
        query_offset++;
        query_length++;
      }

      if (query_offset < flow->packet.payload_packet_len) {
        offset = query_offset + 1;

        if ((offset + 4) <= flow->packet.payload_packet_len) {
          u_int16_t query_type = ntohs(*(u_int16_t*)&flow->packet.payload[offset]);
          /* u_int16_t query_class = ntohs(*(u_int16_t*)&flow->packet.payload[offset + 2]); */

          flow->protos.dns.query_type = query_type;
          offset += 4;
        } else {
          return (1);
        }
      } else {
        return (1);
      }
    }