{
  u_int16_t query_type;
  int name_length = 0;

  // Ensure we do not exceed the payload length
  while((offset < flow->packet.payload_packet_len) && (flow->packet.payload[offset] != '\0')) {
    offset++;
    name_length++;
  }

  // Check if we found a null character and are within bounds
  if(offset < flow->packet.payload_packet_len && flow->packet.payload[offset] == '\0') {
    offset++; // Move past the null character

    // Ensure there is enough space to read the query type
    if((offset + 2) <= flow->packet.payload_packet_len) {
      query_type = (flow->packet.payload[offset] << 8) | flow->packet.payload[offset + 1];
      offset += 2;

      // Optionally log the query type for debugging
      // printf("DNS Query Type: %u\n", query_type);
    } else {
      return(1 /* invalid */);
    }
  } else {
    return(1 /* invalid */);
  }
}