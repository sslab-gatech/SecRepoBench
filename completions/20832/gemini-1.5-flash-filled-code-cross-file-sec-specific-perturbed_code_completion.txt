u_int16_t q_type;
    u_int16_t name_len;

    if((offset + 2) >= flow->packet.payload_packet_len)
      return(1 /* invalid */);

    for(int i = 0; i < dns_header->num_queries; i++) {
      if((name_len = getNameLength(offset, flow->packet.payload, flow->packet.payload_packet_len)) == 0) {
	return(1 /* invalid */);
      } else
	offset += name_len;

      if((offset + 4) >= flow->packet.payload_packet_len) {
	return(1 /* invalid */);
      }

      q_type = get16(&offset, flow->packet.payload);
      flow->protos.dns.q_type = q_type;
      offset += 2; /* q_class */
    }