// Extract the query type from the DNS query section of the packet.
// Iterate over the payload starting from the current offset until a null character is found.
// Once the null character is found, increment the offset and read the query type.
// Optionally, log the query type for debugging purposes.
// Ensure the operation is performed within the packet's payload length.
while((offset < flow->packet.payload_packet_len) && (flow->packet.payload[offset]!= '\0')) {
  offset++;
}

if(offset < flow->packet.payload_packet_len) {
  offset++;
  if((offset+2) <= flow->packet.payload_packet_len) {
    u_int16_t query_type = get16(&offset, flow->packet.payload);
    // Optionally, log the query type for debugging purposes.
    // printf("[query_type: %u]\n", query_type);
  }
}