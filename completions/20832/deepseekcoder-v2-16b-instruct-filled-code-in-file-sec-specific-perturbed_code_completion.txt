// Extract the query type from the DNS query section of the packet.
// Iterate over the payload starting from the current offset until a null character is found.
// Once the null character is found, increment the offset and read the query type.
// Optionally, log the query type for debugging purposes.
// Ensure the operation is performed within the packet's payload length.

u_int16_t query_type = 0;
u_int16_t query_type_offset = offset + 1; // Assuming the query type starts immediately after the null character

if (query_type_offset < flow->packet.payload_packet_len && flow->packet.payload[query_type_offset] != '\0') {
    query_type = get16(&query_type_offset, flow->packet.payload);
    NDPI_LOG_DBG2(ndpi_struct, "Extracted query type: %u\n", query_type);
}