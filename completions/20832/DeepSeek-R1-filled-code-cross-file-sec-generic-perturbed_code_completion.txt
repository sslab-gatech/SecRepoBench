if (offset >= flow->packet.payload_packet_len) {
    return 1;
}
while (offset < flow->packet.payload_packet_len && flow->packet.payload[offset] != '\0') {
    offset++;
}
if (offset >= flow->packet.payload_packet_len) {
    return 1;
}
offset++;
if (offset + 4 > flow->packet.payload_packet_len) {
    return 1;
}
flow->protos.dns.query_type = ntohs(*(u_int16_t*)(flow->packet.payload + offset));
offset += 4;