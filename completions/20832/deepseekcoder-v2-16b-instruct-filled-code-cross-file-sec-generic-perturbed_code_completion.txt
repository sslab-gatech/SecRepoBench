// Extract the query type from the DNS query section of the packet.
  // Iterate over the payload starting from the current offset until a null character is found.
  // Once the null character is found, increment the offset and read the query type.
  // Optionally, log the query type for debugging purposes.
  // Ensure the operation is performed within the packet's payload length.

  u_int16_t query_type = 0;
  u_int16_t query_class = 0;
  u_int16_t i = 0;

  while (offset < flow->packet.payload_packet_len && flow->packet.payload[offset] != '\0') {
    offset++;
  }

  if (offset >= flow->packet.payload_packet_len) {
    return 1; /* invalid */
  }

  offset++; // Move past the null character

  if (offset + 4 >= flow->packet.payload_packet_len) {
    return 1; /* invalid */
  }

  query_type = get16(&offset, flow->packet.payload);
  query_class = get16(&offset, flow->packet.payload);

  // Log the query type for debugging purposes
  // printf("[Query Type: %u][Query Class: %u]\n", query_type, query_class);

  // Ensure the operation is performed within the packet's payload length.
  if (offset >= flow->packet.payload_packet_len) {
    return 1; /* invalid */
  }