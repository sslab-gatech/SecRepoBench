if(packet->payload_packet_len > 0) {
        // Check for specific BitTorrent patterns in the UDP payload
        if(ndpi_strnstr((const char *)packet->payload, bt_search, packet->payload_packet_len) ||
           ndpi_strnstr((const char *)packet->payload, bt_search1, packet->payload_packet_len)) {
          NDPI_LOG_INFO(detectionmodule, "found BT: UDP search\n");
          ndpi_add_connection_as_bittorrent(detectionmodule, flow, -1, 0, NDPI_CONFIDENCE_DPI);
          return;
        }

        // Check for uTP packet characteristics
        if(is_utpv1_pkt(packet->payload, packet->payload_packet_len)) {
          NDPI_LOG_INFO(detectionmodule, "found BT: uTP packet\n");
          ndpi_add_connection_as_bittorrent(detectionmodule, flow, -1, 0, NDPI_CONFIDENCE_DPI);
          return;
        }
      }