if(packet->payload_packet_len >= 20) {
  /* For protocol v0 (uTP), analyze the first byte to determine version/type */
  u_int8_t utp_version = packet->payload[0] & 0x0f;
  u_int8_t utp_type    = (packet->payload[0] & 0xf0) >> 4;

  /* Heuristic: version 1 and type <= 4 often indicates a possible uTP packet */
  if((utp_version == 1) && (utp_type <= 4)) {
    NDPI_LOG_DBG(detectionmodule, "Detected potential uTP (UDP BitTorrent) traffic\n");

    /* Check for BitTorrent protocol string in the payload to confirm */
    if(ndpi_strnstr((const char *)packet->payload, BITTORRENT_PROTO_STRING, packet->payload_packet_len)) {
      NDPI_LOG_DBG(detectionmodule, "Detected BitTorrent protocol string in uTP header\n");
      goto bittorrent_found;
    }
  }
}