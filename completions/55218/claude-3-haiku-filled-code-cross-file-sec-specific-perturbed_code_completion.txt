// Check if the UDP packet payload indicates a BitTorrent connection by examining specific patterns.
// If the payload matches known BitTorrent search strings or protocol headers, mark the connection as BitTorrent.
// For protocol v0, analyze certain packet fields to determine if they fit the characteristics of BitTorrent.
// If the packet appears to be uTP (Micro Transport Protocol), check for the BitTorrent protocol string.
// Apply heuristics to further identify potential BitTorrent connections based on specific byte patterns.
// If a match is found, extract protocol details and update the connection state accordingly.
if (packet->payload_packet_len > 19) { // minimum size
    if (ndpi_strnstr((const char *)packet->payload, ":target20:", packet->payload_packet_len) ||
        ndpi_strnstr((const char *)packet->payload, ":find_node1:", packet->payload_packet_len) ||
        ndpi_strnstr((const char *)packet->payload, "d1:ad2:id20:", packet->payload_packet_len) ||
        ndpi_strnstr((const char *)packet->payload, ":info_hash20:", packet->payload_packet_len) ||
        ndpi_strnstr((const char *)packet->payload, ":filter64", packet->payload_packet_len) ||
        ndpi_strnstr((const char *)packet->payload, "d1:rd2:id20:", packet->payload_packet_len) ||
        (bt_proto = ndpi_strnstr((const char *)packet->payload, BITTORRENT_PROTO_STRING, packet->payload_packet_len))) {
        goto bittorrent_found;
    }
}