if(packet->payload_packet_len > 0) {
  size_t len_search = strlen(bt_search);
  size_t len_search1 = strlen(bt_search1);

  if(packet->payload_packet_len >= len_search &&
     ndpi_strnstr((const char *)packet->payload, bt_search, packet->payload_packet_len) != NULL) {
    NDPI_LOG_INFO(detectionmodule, "found BT: udp via BT-SEARCH string\n");
    ndpi_add_connection_as_bittorrent(detectionmodule, flow, 0, 0, NDPI_CONFIDENCE_DPI);
    return;
  }

  if(packet->payload_packet_len >= len_search1 &&
     ndpi_strnstr((const char *)packet->payload, bt_search1, packet->payload_packet_len) != NULL) {
    NDPI_LOG_INFO(detectionmodule, "found BT: udp via d1:ad2:id20: string\n");
    ndpi_add_connection_as_bittorrent(detectionmodule, flow, 0, 1, NDPI_CONFIDENCE_DPI);
    return;
  }
}