/* Check for known UDP BitTorrent patterns before incrementing detection stage */
  if(packet->payload_packet_len >= 20) {
    /* Check if payload contains the "uTP" identifier for Micro Transport Protocol */
    if(ndpi_strnstr((const char *)packet->payload, "uTP", packet->payload_packet_len) != NULL) {
      NDPI_LOG_INFO(detectionmodule, "found BT: potential uTP\n");
      goto bittorrent_found;
    }

    /* Heuristic check for a possible BitTorrent v0 handshake */
    if((packet->payload[0] == 0x13) &&
       ndpi_strnstr((const char *)packet->payload, "BitTorrent protocol", packet->payload_packet_len)) {
      NDPI_LOG_INFO(detectionmodule, "found BT: v0 handshake\n");
      goto bittorrent_found;
    }

    /* Check for the "BT-SEARCH" signature in UDP payload, indicating possible BitTorrent search request */
    if(ndpi_strnstr((const char *)packet->payload, bt_search, packet->payload_packet_len) != NULL) {
      NDPI_LOG_INFO(detectionmodule, "found BT: BT-SEARCH pattern\n");
      goto bittorrent_found;
    }
  }