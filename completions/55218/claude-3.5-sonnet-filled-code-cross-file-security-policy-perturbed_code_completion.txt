if(packet->payload_packet_len >= 20) {
  if(memcmp(packet->payload, bt_search, strlen(bt_search)) == 0 ||
     memcmp(packet->payload, bt_search1, strlen(bt_search1)) == 0) {
    goto bittorrent_found;
  }

  if(packet->payload_packet_len >= 23) {
    if((packet->payload[0] == 0x13) && (packet->payload[1] == 0x42) &&
       (packet->payload[2] == 0x69) && (packet->payload[3] == 0x74) &&
       (packet->payload[4] == 0x54) && (packet->payload[5] == 0x6f) &&
       (packet->payload[6] == 0x72) && (packet->payload[7] == 0x72) &&
       (packet->payload[8] == 0x65) && (packet->payload[9] == 0x6e) &&
       (packet->payload[10] == 0x74) && (packet->payload[11] == 0x20) &&
       (packet->payload[12] == 0x70) && (packet->payload[13] == 0x72) &&
       (packet->payload[14] == 0x6f) && (packet->payload[15] == 0x74) &&
       (packet->payload[16] == 0x6f) && (packet->payload[17] == 0x63) &&
       (packet->payload[18] == 0x6f) && (packet->payload[19] == 0x6c)) {
      goto bittorrent_found;
    }
  }

  if(packet->payload_packet_len >= 4) {
    u_int8_t v = packet->payload[0];

    if((v == 0x01) || (v == 0x11) || (v == 0x21) || (v == 0x31)) {
      if((packet->payload[1] == 0x00) && (packet->payload[2] == 0x00) &&
         (packet->payload[3] == 0x00)) {
        goto bittorrent_found;
      }
    }
  }
}