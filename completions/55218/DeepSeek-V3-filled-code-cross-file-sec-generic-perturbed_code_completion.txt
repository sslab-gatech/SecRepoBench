if(packet->payload_packet_len >= 20) {
        /* Check for uTP header */
        if((packet->payload[0] & 0xF0) == 0x10) { /* uTP version 1 */
          /* Check for BitTorrent protocol string */
          if(ndpi_strnstr((const char *)packet->payload, BITTORRENT_PROTO_STRING, packet->payload_packet_len)) {
            goto bittorrent_found;
          }
        }

        /* Check for BitTorrent protocol v0 */
        if(packet->payload[0] == 0x13 && 
           memcmp(&packet->payload[1], "BitTorrent protocol", 19) == 0) {
          goto bittorrent_found;
        }

        /* Check for common BitTorrent patterns */
        if(ndpi_strnstr((const char *)packet->payload, bt_search, packet->payload_packet_len) ||
           ndpi_strnstr((const char *)packet->payload, bt_search1, packet->payload_packet_len)) {
          goto bittorrent_found;
        }
      }