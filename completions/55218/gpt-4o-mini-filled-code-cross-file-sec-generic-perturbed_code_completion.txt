if (packet->payload_packet_len > 0) {
        // Check for known BitTorrent protocol patterns in the UDP payload
        if (ndpi_strnstr((const char *)packet->payload, bt_search, packet->payload_packet_len) ||
            ndpi_strnstr((const char *)packet->payload, bt_search1, packet->payload_packet_len)) {
          // If a match is found, mark the flow as BitTorrent
          NDPI_LOG_INFO(detectionmodule, "found BT: search pattern\n");
          ndpi_add_connection_as_bittorrent(detectionmodule, flow, -1, 0, NDPI_CONFIDENCE_DPI);
          return;
        }

        // Check for uTP specific patterns
        if (packet->payload_packet_len >= 8 && 
            (packet->payload[0] == 0x00 || packet->payload[0] == 0x01)) { // Example uTP header check
          NDPI_LOG_INFO(detectionmodule, "found BT: uTP pattern\n");
          ndpi_add_connection_as_bittorrent(detectionmodule, flow, -1, 0, NDPI_CONFIDENCE_DPI);
          return;
        }
      }