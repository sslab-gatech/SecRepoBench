if(is_utpv1_pkt(packet->payload, packet->payload_packet_len)) {
  NDPI_LOG_INFO(detectionmodule, "found BT: uTP\n");
  ndpi_add_connection_as_bittorrent(detectionmodule, flow, -1, 1, NDPI_CONFIDENCE_DPI);
  return;
}

if(packet->payload_packet_len > 19 && memcmp(packet->payload, "BitTorrent protocol", 19) == 0) {
  NDPI_LOG_INFO(detectionmodule, "found BT: plain\n");
  ndpi_add_connection_as_bittorrent(detectionmodule, flow, 20, 1, NDPI_CONFIDENCE_DPI);
  return;
}

if(packet->payload_packet_len > 23 && memcmp(packet->payload, "GET /webseed?info_hash=", 23) == 0) {
  NDPI_LOG_INFO(detectionmodule, "found BT: plain webseed\n");
  ndpi_add_connection_as_bittorrent(detectionmodule, flow, -1, 1, NDPI_CONFIDENCE_DPI);
  return;
}

if(packet->payload_packet_len > 60 && memcmp(packet->payload, "GET /data?fid=", 14) == 0 && memcmp(&packet->payload[54], "&size=", 6) == 0) {
  NDPI_LOG_INFO(detectionmodule, "found BT: plain Bitcomet persistent seed\n");
  ndpi_add_connection_as_bittorrent(detectionmodule, flow, -1, 1, NDPI_CONFIDENCE_DPI);
  return;
}