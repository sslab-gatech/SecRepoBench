if(packet->payload_packet_len > 15) {
        if(ndpi_match_string(bt_search, packet->payload_packet_len, (const char *)packet->payload) ||
           ndpi_match_string(bt_search1, packet->payload_packet_len, (const char *)packet->payload)) {
          goto bittorrent_found;
        }

        if(packet->payload[0] == 0x13 && packet->payload[1] == 0 || packet->payload[0] == 0 && packet->payload[1] == 0x13) {
          if(packet->payload_packet_len > 23 && packet->payload[20] == 0x00 && packet->payload[21] == 0x04 &&
             packet->payload[22] == 0x17 && packet->payload[23] == 0x27) {
            goto bittorrent_found;
          }
        }

        if(packet->payload[0] == 0x00 && packet->payload[1] == 0x00 && packet->payload[2] == 0x04 &&
           packet->payload[3] == 0x17 && packet->payload[4] == 0x27) {
          goto bittorrent_found;
        }

        /* uTP */
        if(packet->payload[0] == 0x3c) {
          if(ndpi_strnstr((const char *)packet->payload, "BitTorrent protocol", packet->payload_packet_len)) {
            goto bittorrent_found;
          }
        }

        /*
         * Some clients starts with \0\0...\0, then real data
         * e.g. vuze
         */
        if(packet->payload[0] == 0x00 && packet->payload[1] == 0x00 && packet->payload[2] == 0x00 && packet->payload[3] == 0x00 && packet->payload[4] == 0x13) {
          goto bittorrent_found;
        }

        if(packet->payload[0] == 0x00 && packet->payload[1] == 0x00 && packet->payload[2] == 0x00 && packet->payload[3] == 0x00 && packet->payload[4] == 0x00 && packet->payload[5] == 0x13) {
          goto bittorrent_found;
        }
      }