if(packet->payload_packet_len > 20) {
        // Check for uTP (Micro Transport Protocol) header
        if((packet->payload[0] & 0x0F) == 0x01 /* uTP version 1 */
           && (packet->payload[1] == 0 || packet->payload[1] == 1) /* Type: ST_DATA or ST_FIN */
           && (packet->payload[2] == 0) /* Extension: none */) {
          NDPI_LOG_DBG(detectionmodule, "uTP detected\n");
          goto bittorrent_found;
        }

        // Check for BitTorrent protocol string
        if(ndpi_strnstr((const char *)packet->payload, "BitTorrent protocol", packet->payload_packet_len)) {
          NDPI_LOG_DBG(detectionmodule, "BitTorrent protocol string detected\n");
          goto bittorrent_found;
        }

        // Check for DHT (Distributed Hash Table) messages
        if(ndpi_strnstr((const char *)packet->payload, "d1:ad2:id20:", packet->payload_packet_len)
           || ndpi_strnstr((const char *)packet->payload, "d1:rd2:id20:", packet->payload_packet_len)
           || ndpi_strnstr((const char *)packet->payload, "d1:ad2:info_hash20:", packet->payload_packet_len)) {
          NDPI_LOG_DBG(detectionmodule, "DHT message detected\n");
          goto bittorrent_found;
        }
      }