// <MASK>
if(is_utpv1_pkt(packet->payload, packet->payload_packet_len)) {
  const char *bt_hash = ndpi_strnstr((const char *)packet->payload, "info_hash20:", packet->payload_packet_len);
  if(bt_hash && (packet->payload_packet_len >= (20 + (bt_hash-(const char*)packet->payload)))) {
    memcpy(flow->protos.bittorrent.hash, bt_hash + 11, 20);
    goto bittorrent_found;
  }
}
// </MASK>