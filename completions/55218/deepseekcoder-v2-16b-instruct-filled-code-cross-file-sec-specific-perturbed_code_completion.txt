if(packet->payload_packet_len > 19 /* min size */) {
        if(ndpi_strnstr((const char *)packet->payload, ":target20:", packet->payload_packet_len)
           || ndpi_strnstr((const char *)packet->payload, ":find_node1:", packet->payload_packet_len)
           || ndpi_strnstr((const char *)packet->payload, "d1:ad2:id20:", packet->payload_packet_len)
           || ndpi_strnstr((const char *)packet->payload, ":info_hash20:", packet->payload_packet_len)
           || ndpi_strnstr((const char *)packet->payload, ":filter64", packet->payload_packet_len)
           || ndpi_strnstr((const char *)packet->payload, "d1:rd2:id20:", packet->payload_packet_len)
           || (bt_proto = ndpi_strnstr((const char *)packet->payload, BITTORRENT_PROTO_STRING, packet->payload_packet_len))
           ) {
        bittorrent_found:
          if(bt_proto != NULL && ((u_int8_t *)&bt_proto[27] - packet->payload +
                                  sizeof(flow->protos.bittorrent.hash)) < packet->payload_packet_len) {
            memcpy(flow->protos.bittorrent.hash, &bt_proto[27], sizeof(flow->protos.bittorrent.hash));
            flow->extra_packets_func = NULL; /* Nothing else to do */
          }

          NDPI_LOG_INFO(detectionmodule, "found BT: plain\n");
          ndpi_add_connection_as_bittorrent(detectionmodule, flow, -1, 0, NDPI_CONFIDENCE_DPI);
          return;
        }
      }