// Check if the UDP packet payload indicates a BitTorrent connection by examining specific patterns.
// If the payload matches known BitTorrent search strings or protocol headers, mark the connection as BitTorrent.
// For protocol v0, analyze certain packet fields to determine if they fit the characteristics of BitTorrent.
// If the packet appears to be uTP (Micro Transport Protocol), check for the BitTorrent protocol string.
// Apply heuristics to further identify potential BitTorrent connections based on specific byte patterns.
// If a match is found, extract protocol details and update the connection state accordingly.
if (ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", packet->payload_packet_len)
    || ndpi_strnstr((const char *)packet->payload, "UTP/1.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\