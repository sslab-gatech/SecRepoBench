/* Heuristic check for uTP (Micro Transport Protocol) based on BEP 0029:
   Ensure payload is large enough and the first nibble of the first byte
   indicates a valid uTP packet type (1 .. 4). */
if (packet->payload_packet_len >= 20) {
  uint8_t pkt_type = packet->payload[0] & 0x0F;
  /* ST_DATA (1), ST_FIN (2), ST_STATE (3), ST_RESET (4), ST_SYN (0) */
  if (pkt_type >= 1 && pkt_type <= 4) {
    NDPI_LOG_INFO(detectionmodule, "found BT: possible uTP\n");
    goto bittorrent_found;
  }
}