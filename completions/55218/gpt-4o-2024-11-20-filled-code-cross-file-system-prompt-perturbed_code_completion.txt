if(packet->payload_packet_len > 20) {
        if(ndpi_strnstr((const char *)packet->payload, bt_search, packet->payload_packet_len)
           || ndpi_strnstr((const char *)packet->payload, bt_search1, packet->payload_packet_len)) {
          NDPI_LOG_INFO(detectionmodule, "found BT: search string\n");
          goto bittorrent_found;
        }

        /* Check for uTP */
        if(packet->payload[0] == 0x13 && packet->payload[1] == 0x42 && packet->payload[2] == 0x54) {
          NDPI_LOG_INFO(detectionmodule, "found BT: uTP\n");
          goto bittorrent_found;
        }

        /* Heuristic checks for BitTorrent patterns */
        if(packet->payload[0] == 0x64 && packet->payload[1] == 0x31 && packet->payload[2] == 0x3a) {
          NDPI_LOG_INFO(detectionmodule, "found BT: heuristic pattern\n");
          goto bittorrent_found;
        }
      }