{
	if(packet->payload_packet_len > 10) {
	  if(memcmp(packet->payload, bt_search, MIN(packet->payload_packet_len, strlen(bt_search))) == 0) {
	    NDPI_LOG_INFO(detectionmodule, "found BT: BT-SEARCH\n");
	    ndpi_add_connection_as_bittorrent(detectionmodule, flow, -1, 0, NDPI_CONFIDENCE_DPI);
	    return;
	  } else if(memcmp(packet->payload, bt_search1, MIN(packet->payload_packet_len, strlen(bt_search1))) == 0) {
	    NDPI_LOG_INFO(detectionmodule, "found BT: d1:ad2:id20:\n");
	    ndpi_add_connection_as_bittorrent(detectionmodule, flow, -1, 0, NDPI_CONFIDENCE_DPI);
	    return;
	  } else if(packet->payload[0] == 0x01) { /* uTP */
	    const char *bittorrent_string = "BitTorrent protocol";

	    if(ndpi_strnstr((const char *)packet->payload, bittorrent_string, packet->payload_packet_len) != NULL) {
	      NDPI_LOG_INFO(detectionmodule, "found BT: uTP\n");
	      ndpi_add_connection_as_bittorrent(detectionmodule, flow, -1, 0, NDPI_CONFIDENCE_DPI);
	      return;
	    }
	  } else if((packet->payload[0] == 0xFE) && (packet->payload[1] == 0xFD)) {
	    /*
	      0000  fe fd 09 76 04 3b 6b 5e  00 00                    ...v.;k^..
	    */
	    NDPI_LOG_INFO(detectionmodule, "found BT: 0xFE 0xFD\n");
	    ndpi_add_connection_as_bittorrent(detectionmodule, flow, -1, 0, NDPI_CONFIDENCE_DPI);
	    return;
	  } else if((packet->payload[0] == 0x67) && (packet->payload[1] == 0x65)) {
	    /*
	      0000  67 65 00 01 00 00 00 00  00 00 00 00 08 64 6e 73   ge...........dns
	    */
	    NDPI_LOG_INFO(detectionmodule, "found BT: 0x67 0x65\n");
	    ndpi_add_connection_as_bittorrent(detectionmodule, flow, -1, 0, NDPI_CONFIDENCE_DPI);
	    return;
	  }
	}
}