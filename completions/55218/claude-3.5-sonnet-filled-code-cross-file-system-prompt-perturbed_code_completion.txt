if(packet->payload_packet_len >= 20) {
  if(memcmp(packet->payload, bt_search, strlen(bt_search)) == 0 ||
     memcmp(packet->payload, bt_search1, strlen(bt_search1)) == 0) {
    goto bittorrent_found;
  }

  if(packet->payload[0] == 0x13) { /* uTP protocol v0 */
    if((packet->payload[1] == 0x00) && (packet->payload[2] == 0x00) && (packet->payload[3] == 0x00) &&
       (packet->payload[8] == 0x00) && (packet->payload[15] == 0x00) && (packet->payload[16] == 0x00) &&
       (packet->payload[17] == 0x00) && (packet->payload[18] == 0x00) && (packet->payload[19] == 0x00)) {
      goto bittorrent_found;
    }
  } else if((packet->payload[0] == 0x01) && (packet->payload_packet_len > 27)) {
    /* uTP protocol v1 */
    bt_proto = ndpi_strnstr((const char *)&packet->payload[20], BITTORRENT_PROTO_STRING, packet->payload_packet_len-20);
    if(bt_proto) goto bittorrent_found;
  }

  /* Heuristic */
  if((packet->payload[0] == 0x00) && (packet->payload[1] == 0x00) &&
     (packet->payload[2] == 0x00) && (packet->payload[3] == 0x00) &&
     (packet->payload_packet_len > 23)) {
    goto bittorrent_found;
  }
}