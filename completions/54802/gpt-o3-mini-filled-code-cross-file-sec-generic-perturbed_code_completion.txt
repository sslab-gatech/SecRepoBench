if(packet->payload_packet_len > 15) {
  /* Example pattern 1: Check for a fixed byte sequence at specific offsets.
     Ensure that reading the bytes is safe given the total payload length. */
  if(packet->payload[0] == 0x43 && packet->payload[7] == 0x50) {
    stream->l4.udp.ppstream_stage++;
    ndpi_int_ppstream_add_connection(ndpi_struct, stream);
    return;
  }

  /* Example pattern 2: Check an alternative signature.
     First, verify that the payload length is sufficient for the offsets used. */
  if(packet->payload_packet_len > 10 && packet->payload[1] == 0x57 && packet->payload[4] == 0x2D) {
    stream->l4.udp.ppstream_stage++;
    ndpi_int_ppstream_add_connection(ndpi_struct, stream);
    return;
  }
}