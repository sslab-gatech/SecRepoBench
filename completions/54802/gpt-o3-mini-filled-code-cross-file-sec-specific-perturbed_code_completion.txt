if(packet->payload_packet_len >= 8) {
    // Check for PPStream signature pattern #1: 0xA1 0xB2 0xC3 0xD4 at offset 0
    if(packet->payload[0] == 0xa1 && packet->payload[1] == 0xb2 &&
       packet->payload[2] == 0xc3 && packet->payload[3] == 0xd4) {
        stream->l4.udp.ppstream_stage++;
        ndpi_int_ppstream_add_connection(ndpi_struct, stream);
        return;
    }
    // Check for PPStream signature pattern #2: 0xD4 0xC3 0xB2 0xA1 at offset 0
    if(packet->payload[0] == 0xd4 && packet->payload[1] == 0xc3 &&
       packet->payload[2] == 0xb2 && packet->payload[3] == 0xa1) {
        stream->l4.udp.ppstream_stage++;
        ndpi_int_ppstream_add_connection(ndpi_struct, stream);
        return;
    }
}