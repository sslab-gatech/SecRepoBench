// Check specific byte patterns in the packet payload to identify PPStream traffic
if(packet->payload[0] == 0x01 && packet->payload[1] == 0x00 &&
   packet->payload[2] == 0x00 && packet->payload[3] == 0x00) {
  // Increase the PPStream stage counter for the flow structure
  stream->l4.udp.ppstream_stage++;

  // Register this flow structure as a PPStream connection
  ndpi_int_ppstream_add_connection(ndpi_struct, stream);
  return;
} else if(packet->payload[0] == 0x02 && packet->payload[1] == 0x10 &&
          packet->payload[2] == 0x00 && packet->payload[3] == 0x00) {
  // Increase the PPStream stage counter for the flow structure
  stream->l4.udp.ppstream_stage++;

  // Register this flow structure as a PPStream connection
  ndpi_int_ppstream_add_connection(ndpi_struct, stream);
  return;
}