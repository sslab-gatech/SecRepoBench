if (packet->payload_packet_len >= 14) {
    /* Check for byte pattern at offset 4 */
    if ((packet->payload[4] == 0x43) && (packet->payload[5] == 0xAB)) {
        /* Increase PPStream stage counter */
        stream->l4.udp.ppstream_stage++;
        
        /* Register the flow as a PPStream connection */
        ndpi_int_ppstream_add_connection(ndpi_struct, stream);
        return;
    }
    /* Check for another byte pattern at offset 6 */
    else if ((packet->payload[6] == 0x7F) && (packet->payload[7] == 0x12)) {
        /* Increase PPStream stage counter */
        stream->l4.udp.ppstream_stage++;
        
        /* Register the flow as a PPStream connection */
        ndpi_int_ppstream_add_connection(ndpi_struct, stream);
        return;
    }
}
/* If no patterns matched, exclude the protocol */
NDPI_EXCLUDE_PROTO(ndpi_struct, stream);