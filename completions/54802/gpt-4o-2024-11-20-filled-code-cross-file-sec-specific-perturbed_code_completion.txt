// Ensure the payload length is sufficient to avoid buffer overflows
if (packet->payload_packet_len >= 6) {
  // Check specific byte patterns in the payload
  if (packet->payload[0] == 0x43 && packet->payload[1] == 0x00 &&
      packet->payload[2] == 0x00 && packet->payload[3] == 0x01 &&
      packet->payload[4] == 0x00 && packet->payload[5] == 0x01) {

    // Increment the PPStream stage counter
    stream->l4.udp.ppstream_stage++;

    // Register the flow as a PPStream connection
    ndpi_int_ppstream_add_connection(ndpi_struct, stream);
    return;
  }
}