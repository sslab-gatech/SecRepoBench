if ((length = (token & MAX_SHORT_LITLEN)) == MAX_SHORT_LITLEN) {
    /* Ensure we have at least 1 byte available to read */
    if (unlikely(ctx->literalsPtr > iend - 1)) {
        LIZARD_LOG_DECOMPRESS_LIZv1("5");
        goto _output_error;
    }
    length = *ctx->literalsPtr;
    /* If this byte indicates a larger length, read the extra bytes safely */
    if unlikely(length >= 254) {
        if (length == 254) {
            /* Ensure we have at least 2 more bytes available */
            if (unlikely(ctx->literalsPtr > iend - 2)) {
                LIZARD_LOG_DECOMPRESS_LIZv1("5.1");
                goto _output_error;
            }
            length = MEM_readLE16(ctx->literalsPtr + 1);
            ctx->literalsPtr += 2;
        } else {
            /* Ensure we have at least 3 more bytes available */
            if (unlikely(ctx->literalsPtr > iend - 3)) {
                LIZARD_LOG_DECOMPRESS_LIZv1("5.2");
                goto _output_error;
            }
            length = MEM_readLE24(ctx->literalsPtr + 1);
            ctx->literalsPtr += 3;
        }
    }
    ctx->literalsPtr++;
    length += MAX_SHORT_LITLEN;
    /* Check for overflow in pointer arithmetic */
    if (unlikely((size_t)(output_ptr + length) < (size_t)(output_ptr))) {
        LIZARD_LOG_DECOMPRESS_LIZv1("5.3");
        goto _output_error;
    }
}