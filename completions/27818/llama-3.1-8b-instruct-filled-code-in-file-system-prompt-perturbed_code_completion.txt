if ((length=(token & MAX_SHORT_LITLEN)) == MAX_SHORT_LITLEN) {
    // Extract the length of the literals from the token.
    // If the extracted length indicates it is a special case, read the actual literal length from the input stream.
    // Adjust the length by adding a predefined constant to account for the special case.
    // Move the pointer in the input stream to account for the bytes read.
    if (token & SPECIAL_CASE_FLAG) {
        // Special case: read the actual length from the input stream
        length = MEM_readLE16(ctx->literalsPtr + 1);
        ctx->literalsPtr += 2;
        // Adjust the length by adding a predefined constant
        length += SPECIAL_CASE_ADJUSTMENT;
    } else {
        // Not a special case: just read the length from the token
        length = (token & MAX_SHORT_LITLEN);
    }
}