if (strstr(time_fmt, "%Y") || strstr(time_fmt, "%y")) {
            is_epoch = FLB_FALSE;
        } else if (strstr(time_fmt, "%s")) {
            is_epoch = FLB_TRUE;
        } else {
            size = strlen(time_fmt) + 3; // For "%Y" prefix
            p->time_fmt_year = flb_malloc(size);
            if (!p->time_fmt_year) {
                flb_error("[parser:%s] Memory allocation failed for time format year", name);
                flb_free(p->time_fmt);
                flb_free(p->time_fmt_full);
                flb_free(p);
                return NULL;
            }
            snprintf(p->time_fmt_year, size, "%%Y %s", time_fmt);
            p->time_fmt = p->time_fmt_year; // Update to use the new format
        }

        // Check for timezone indicators
        if (strstr(time_fmt, "%z") || strstr(time_fmt, "%Z")) {
            // Timezone support is enabled
            // Set a flag or handle accordingly if needed
        } else {
            flb_error("[parser:%s] Timezone support not enabled", name);
            flb_free(p->time_fmt);
            flb_free(p->time_fmt_full);
            flb_free(p);
            return NULL;
        }

        // Handle fractional seconds
        if (strstr(time_fmt, "%L")) {
            // Truncate the format string at the fractional seconds position
            char *frac_pos = strstr(time_fmt, "%L");
            *frac_pos = '\0'; // Truncate the string
            // Store the pointer for fractional seconds handling if needed
        }