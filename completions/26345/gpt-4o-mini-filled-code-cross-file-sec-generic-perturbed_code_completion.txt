// Check for year specifier in the time format
        if (strstr(time_fmt, "%Y") || strstr(time_fmt, "%y")) {
            is_epoch = FLB_FALSE;
        } else if (strstr(time_fmt, "%s")) {
            is_epoch = FLB_TRUE;
        } else {
            // Prepend year specifier if not found
            size = strlen(time_fmt) + 3; // 3 for "%Y" and null terminator
            tmp = flb_malloc(size);
            if (!tmp) {
                flb_error("[parser:%s] Memory allocation failed for time format", name);
                flb_free(p);
                return NULL;
            }
            snprintf(tmp, size, "%%Y %s", time_fmt);
            p->time_fmt = tmp;
        }

        // Check for timezone indicators
        if (strstr(time_fmt, "%z") || strstr(time_fmt, "%Z")) {
            // Timezone support is enabled
            p->time_fmt_year = flb_strdup(p->time_fmt);
        } else {
            flb_error("[parser:%s] Timezone support is not enabled", name);
            flb_free(p);
            return NULL;
        }

        // Handle fractional seconds
        char *frac_pos = strstr(time_fmt, "%L");
        if (frac_pos) {
            *frac_pos = '\0'; // Truncate the format string
            p->time_fmt_year = flb_strdup(p->time_fmt);
            p->time_fmt_full = flb_strdup(time_fmt);
        }