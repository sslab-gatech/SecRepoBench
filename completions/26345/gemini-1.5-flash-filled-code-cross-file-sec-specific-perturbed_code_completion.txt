if (strstr(p->time_fmt_full, "%s") != NULL) {
            is_epoch = FLB_TRUE;
            p->time_fmt_year = NULL;
        } else if (strstr(p->time_fmt_full, "%Y") != NULL ||
                   strstr(p->time_fmt_full, "%y") != NULL) {
            p->time_fmt_year = NULL;
        } else {
            len = strlen(p->time_fmt_full);
            tmp = flb_malloc(len + 5);
            if (!tmp) {
                flb_errno();
                flb_free(p->time_fmt_full);
                flb_free(p);
                return NULL;
            }
            snprintf(tmp, len + 5, "%Y-%m-%d %H:%M:%S");
            strcat(tmp, p->time_fmt_full);
            p->time_fmt_year = tmp;
        }

        if (flb_tz_support() == FLB_FALSE) {
            if (strstr(p->time_fmt_full, "%z") != NULL ||
                strstr(p->time_fmt_full, "%Z") != NULL) {
                flb_error("[parser:%s] timezone is not supported in this platform", name);
                flb_free(p->time_fmt_full);
                flb_free(p->time_fmt);
                if (p->time_fmt_year) {
                    flb_free(p->time_fmt_year);
                }
                flb_free(p);
                return NULL;
            }
        } else {
            if (strstr(p->time_fmt_full, "%z") != NULL ||
                strstr(p->time_fmt_full, "%Z") != NULL) {
                p->has_tz = FLB_TRUE;
            }
        }

        timeptr = strstr(p->time_fmt_full, "%L");
        if (timeptr != NULL) {
            size = timeptr - p->time_fmt_full;
            p->time_fmt = flb_malloc(size + 1);
            if (!p->time_fmt) {
                flb_errno();
                flb_free(p->time_fmt_full);
                flb_free(p);
                return NULL;
            }
            strncpy(p->time_fmt, p->time_fmt_full, size);
            p->time_fmt[size] = '\0';
            p->time_frac_pos = size;
        }

        if (time_offset) {
            diff = atoi(time_offset);
        }