if (strstr(p->time_fmt, "%Y") || strstr(p->time_fmt, "%y")) {
            p->time_with_year = FLB_TRUE;
        }
        else if (strstr(p->time_fmt, "%s")) {
            is_epoch = FLB_TRUE;
            p->time_with_year = FLB_TRUE;
        } else {
            size = strlen(p->time_fmt);
            p->time_fmt_year = flb_malloc(size + 6);
            if (!p->time_fmt_year) {
                flb_errno();
                flb_interim_parser_destroy(p);
                return NULL;
            }
            memcpy(p->time_fmt_year, "%Y ", 4);
            memcpy(p->time_fmt_year + 4, p->time_fmt, size + 1);

            p->time_with_year = FLB_FALSE;
        }

#ifdef FLB_HAVE_TZSET
        /* Check if the format contains timezone indicators */
        if (strstr(p->time_fmt, "%z") || strstr(p->time_fmt, "%Z")) {
            p->time_with_tz = FLB_TRUE;
        }
        else {
            p->time_with_tz = FLB_FALSE;
        }
#else
        if (strstr(p->time_fmt, "%z") || strstr(p->time_fmt, "%Z")) {
            flb_error("[parser] timezone parsing not supported on this " \
                      "platform. Aborting.");
            flb_interim_parser_destroy(p);
            return NULL;
        }
        p->time_with_tz = FLB_FALSE;
#endif

        /* Check if we have fractional seconds (%L) */
        if ((timeptr = strstr(p->time_fmt, "%L"))) {
            /*
             * We want to keep two format strings:
             *
             * - time_fmt: format up to %L, useful to parse date/time up to
             *   seconds.
             * - time_frac_secs: format for fractional seconds and remaining
             *   format after fractional seconds.
             */
            len = timeptr - p->time_fmt;
            tmp = flb_strdup(p->time_fmt);
            tmp[len] = '\0';
            flb_free(p->time_fmt);
            p->time_fmt = tmp;

            p->time_frac_secs = flb_strdup(timeptr);
        }

        if (time_offset) {
            flb_parser_tzone_offset(time_offset, flb_sds_len(time_offset), &diff);
            p->time_offset = diff;
            flb_sds_destroy(time_offset);
        }
        else {
            p->time_offset = 0;
        }