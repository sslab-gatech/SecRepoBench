if (strstr(time_fmt, "%Y") != NULL || strstr(time_fmt, "%y") != NULL) {
            p->time_with_year = FLB_TRUE;
        }
        else if (strstr(time_fmt, "%s") != NULL) {
            is_epoch = FLB_TRUE;
            p->time_with_year = FLB_TRUE;
        }
        else {
            len = strlen(time_fmt);
            size = len + 5; /* +5 for "%Y " */
            p->time_fmt_year = flb_malloc(size);
            if (!p->time_fmt_year) {
                flb_errno();
                flb_interim_parser_destroy(p);
                return NULL;
            }
            snprintf(p->time_fmt_year, size, "%Y %s", time_fmt);
            p->time_with_year = FLB_FALSE;
        }

        /* Timezone support */
#ifdef FLB_HAVE_GMTOFF
        if (strstr(time_fmt, "%z") != NULL || strstr(time_fmt, "%Z") != NULL) {
            p->time_with_tz = FLB_TRUE;
        }
        else {
            p->time_with_tz = FLB_FALSE;
        }
#else
        if (strstr(time_fmt, "%z") != NULL || strstr(time_fmt, "%Z") != NULL) {
            flb_error("[parser] timezone support is not enabled, "
                      "please recompile fluent-bit with --with-tz");
            flb_interim_parser_destroy(p);
            return NULL;
        }
#endif

        /* Fractional seconds */
        timeptr = strstr(p->time_fmt, "%L");
        if (timeptr != NULL) {
            p->time_frac_secs = flb_strndup(timeptr + 2, strlen(timeptr + 2));
            diff = timeptr - p->time_fmt;
            p->time_fmt = flb_strndup(p->time_fmt, diff);
            p->time_frac_secs_pos = diff;
        }

        /* Time offset */
        if (time_offset) {
            status = flb_parser_tzone_offset(time_offset, strlen(time_offset),
                                             &p->time_offset);
            if (status != 0) {
                flb_error("[parser] invalid timezone offset '%s'", time_offset);
                flb_interim_parser_destroy(p);
                return NULL;
            }
        }