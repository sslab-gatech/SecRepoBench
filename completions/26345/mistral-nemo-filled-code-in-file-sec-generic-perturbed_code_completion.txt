if (time_fmt) {
        p->time_fmt_full = flb_strdup(time_fmt);
        p->time_fmt = flb_strdup(time_fmt);

        /* Check if the format is considering the year */
        if (strchr(time_fmt, '%') != NULL) {
            if (strchr(time_fmt, 'Y') != NULL || strchr(time_fmt, 'y') != NULL) {
                p->time_with_year = FLB_TRUE;
            }
            else {
                p->time_with_year = FLB_FALSE;
            }
        }
        else {
            p->time_with_year = FLB_FALSE;
        }

        /* Check if the format is considering timezone */
        if (strchr(time_fmt, 'z') != NULL || strchr(time_fmt, 'Z') != NULL) {
            p->time_with_tz = FLB_TRUE;
        }
        else {
            p->time_with_tz = FLB_FALSE;
        }

        /* Check if the format is considering fractional seconds */
        if (strchr(time_fmt, 'L') != NULL) {
            p->time_frac_secs = flb_strdup("%L");
        }
        else {
            p->time_frac_secs = NULL;
        }

        /* Check if the format is considering timezone offset */
        if (time_offset) {
            int tmdiff;
            if (flb_parser_tzone_offset(time_offset, strlen(time_offset), &tmdiff) == 0) {
                p->time_offset = tmdiff;
            }
            else {
                flb_error("[parser] invalid timezone offset '%s'", time_offset);
                return NULL;
            }
        }
        else {
            p->time_offset = 0;
        }
    }
    else {
        p->time_with_year = FLB_FALSE;
        p->time_with_tz = FLB_FALSE;
        p->time_offset = 0;
        p->time_frac_secs = NULL;
    }