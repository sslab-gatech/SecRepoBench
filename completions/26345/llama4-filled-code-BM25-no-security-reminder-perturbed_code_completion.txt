/* Check if the time format is considering the year */
    is_epoch = strstr(time_fmt, "%s") != NULL;
    if (is_epoch == FLB_TRUE) {
        p->time_fmt = flb_strdup(time_fmt);
        p->time_fmt_full = flb_strdup(time_fmt);
        p->time_fmt_year = FLB_TRUE;
    }
    else {
        timeptr = strstr(time_fmt, "%Y");
        if (timeptr == NULL) {
            timeptr = strstr(time_fmt, "%y");
        }
        if (timeptr != NULL) {
            p->time_fmt_year = FLB_TRUE;
        }
        else {
            size = strlen(time_fmt) + 6; /* strlen("%Y") + 1 */
            tmp = flb_malloc(size);
            if (!tmp) {
                flb_errno();
                flb_free(p);
                return NULL;
            }
            snprintf(tmp, size, "%%Y %s", time_fmt);
            p->time_fmt_year = FLB_FALSE;
            p->time_fmt = flb_strdup(time_fmt);
            p->time_fmt_full = tmp;
        }
    }

    if (strstr(p->time_fmt, "%z") != NULL ||
        strstr(p->time_fmt, "%Z") != NULL ||
        strstr(p->time_fmt, "%::z") != NULL ||
        strstr(p->time_fmt, "%:::z") != NULL) {
#ifdef FLB_HAVE_TZSET
        p->time_fmt_tz = FLB_TRUE;
#else
        flb_error("[parser:%s] Timezone offset not supported, ignored", name);
        flb_free(p);
        return NULL;
#endif
    }

    /* Handle fractional seconds */
    timeptr = strstr(p->time_fmt, "%L");
    if (timeptr != NULL) {
        diff = timeptr - p->time_fmt;
        p->time_fmt_lfrac = p->time_fmt + diff;
    }

    /* Time offset */
    if (time_offset) {
        p->time_offset = atoi(time_offset);
        if (p->time_offset < 0) {
            p->time_offset = abs(p->time_offset) * -1;
        }
    }