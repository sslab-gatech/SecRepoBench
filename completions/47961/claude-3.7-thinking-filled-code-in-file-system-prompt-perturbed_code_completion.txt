int more_than_one = 0;
uc = json_skip_space(uc, ueend);
if (uc == ueend)
    goto out;
if (*uc == ']') {
    uc++;
    goto done;
}
for (;;) {
    if (!json_parse(&uc, ueend, st, lvl + 1)) {
        DPRINTF("not json", uc, *ucp);
        goto out;
    }
    uc = json_skip_space(uc, ueend);
    if (uc == ueend)
        goto out;
    switch (*uc++) {
    case ',':
        more_than_one = 1;
        uc = json_skip_space(uc, ueend);
        if (uc == ueend)
            goto out;
        continue;
    case ']':
    done:
        DPRINTF("Good array: ", uc, *ucp);
        *ucp = uc;
        if (more_than_one)
            st[JSON_ARRAYN]++;
        return 1;
    default:
        DPRINTF("not more", uc, *ucp);
        *ucp = uc - 1;
        goto out;
    }
}