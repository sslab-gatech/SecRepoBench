uc = json_skip_space(uc, ueend);
        if (uc == ueend)
            goto out;

        if (*uc == ']') {
            uc++;
            DPRINTF("Good array: ", uc, *ucp);
            *ucp = uc;
            return 1;
        }

        if (!json_parse(ucp, ueend, st, lvl + 1)) {
            DPRINTF("Failed to parse element", uc, *ucp);
            goto out;
        }

        uc = json_skip_space(*ucp, ueend);
        if (uc == ueend)
            goto out;

        if (*uc == ',') {
            uc++;
            continue;
        } else if (*uc == ']') {
            uc++;
            DPRINTF("Good array: ", uc, *ucp);
            *ucp = uc;
            return 1;
        } else {
            DPRINTF("Unexpected character in array", uc, *ucp);
            goto out;
        }