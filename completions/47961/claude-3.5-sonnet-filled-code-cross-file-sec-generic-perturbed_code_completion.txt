uc = json_skip_space(uc, ueend);
if (uc == ueend)
    goto out;

if (*uc == ']') {
    uc++;
    st[JSON_ARRAYN]++;
    DPRINTF("Good array: ", uc, *ucp);
    *ucp = uc;
    return 1;
}

if (!json_parse(&uc, ueend, st, lvl + 1)) {
    goto out;
}

uc = json_skip_space(uc, ueend);
if (uc == ueend)
    goto out;

switch (*uc++) {
    case ',':
        continue;
    case ']':
        st[JSON_ARRAYN]++;
        DPRINTF("Good array: ", uc, *ucp);
        *ucp = uc;
        return 1;
    default:
        uc--;
        goto out;
}