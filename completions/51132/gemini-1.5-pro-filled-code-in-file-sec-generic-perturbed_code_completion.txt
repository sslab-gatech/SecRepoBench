char *type_str;

        /* type */
        tmp_str = get_parser_key(config, cf, s, "type");
        if (!tmp_str) {
            flb_error("[multiline_parser] no 'type' defined for '%s' in file '%s'",
                      name, cfg);
            goto fconf_error;
        }

        type_str = tmp_str;
        if (strcasecmp(type_str, "regex") == 0) {
            type = FLB_ML_REGEX;
        }
        else if (strcasecmp(type_str, "endswith") == 0) {
            type = FLB_ML_ENDSWITH;
        }
        else if (strcasecmp(type_str, "equal") == 0) {
            type = FLB_ML_EQUALS;
        }
        else if (strcasecmp(type_str, "startswith") == 0) {
            type = FLB_ML_STARTSWITH;
        }
        else if (strcasecmp(type_str, "contain") == 0) {
            type = FLB_ML_CONTAINS;
        }
        else {
            flb_error("[multiline_parser] invalid 'type=%s' for '%s' in file '%s'",
                      type_str, name, cfg);
            flb_sds_destroy(tmp_str);
            goto fconf_error;
        }
        flb_sds_destroy(tmp_str);