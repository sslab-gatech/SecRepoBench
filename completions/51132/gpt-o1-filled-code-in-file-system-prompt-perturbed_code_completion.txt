flb_sds_t type_str;

    type_str = get_parser_key(config, cf, s, "type");
    if (!type_str) {
        flb_error("[multiline_parser: %s] no 'type' defined", name);
        goto fconf_error;
    }

    if (!strcasecmp(type_str, "regex")) {
        type = FLB_ML_REGEX;
    }
    else {
        flb_error("[multiline_parser: %s] invalid 'type' value '%s'", name, type_str);
        flb_sds_destroy(type_str);
        goto fconf_error;
    }

    flb_sds_destroy(type_str);