// Retrieve the 'type' key from the configuration section.
// If the 'type' is not found, log an error and exit with a failure.
// Convert the type string to its corresponding integer value.
// If the conversion fails, log an error and exit with a failure.
// Proceed to handle the 'match_string' key retrieval.
type = get_parser_key(config, cf, s, "type");
if (!type) {
    flb_error("[multiline_parser] no 'type' defined in file '%s'", cfg);
    goto fconf_error;
}

// Convert the type string to an integer
if (strcasecmp(type, "regex") == 0) {
    type = FLB_ML_REGEX;
} else if (strcasecmp(type, "multiline") == 0) {
    type = FLB_ML_MULTILINE;
} else {
    flb_error("[multiline_parser] Invalid type %s", type);
    goto fconf_error;
}