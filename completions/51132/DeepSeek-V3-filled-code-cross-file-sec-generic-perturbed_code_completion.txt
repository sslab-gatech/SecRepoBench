type = get_parser_key(config, cf, s, "type");
        if (!type) {
            flb_error("[multiline_parser] no 'type' defined in file '%s'", cfg);
            goto fconf_error;
        }

        if (strcasecmp(type, "regex") == 0) {
            type = FLB_ML_REGEX;
        }
        else if (strcasecmp(type, "string") == 0) {
            type = FLB_ML_STRING;
        }
        else {
            flb_error("[multiline_parser] invalid type '%s' in file '%s'", type, cfg);
            flb_sds_destroy(type);
            goto fconf_error;
        }
        flb_sds_destroy(type);