flb_sds_t type_str = get_parser_key(config, cf, s, "type");
        if (!type_str) {
            flb_error("[multiline_parser] no 'type' defined in section '%s' of file '%s'", name, cfg);
            goto fconf_error;
        }

        if (strcasecmp(type_str, "regex") == 0) {
            type = FLB_ML_REGEX;
        }
        else if (strcasecmp(type_str, "text") == 0) {
            type = FLB_ML_TEXT;
        }
        else {
            flb_error("[multiline_parser] invalid type '%s' in section '%s' of file '%s'",
                      type_str, name, cfg);
            flb_sds_destroy(type_str);
            goto fconf_error;
        }
        flb_sds_destroy(type_str);