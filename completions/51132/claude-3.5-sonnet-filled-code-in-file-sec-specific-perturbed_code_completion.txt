flb_sds_t type_str = get_parser_key(config, cf, s, "type");
if (!type_str) {
    flb_error("[multiline_parser] no 'type' defined for parser '%s' in file '%s'", name, cfg);
    goto fconf_error;
}

if (strcasecmp(type_str, "regex") == 0) {
    type = FLB_ML_REGEX;
}
else if (strcasecmp(type_str, "endswith") == 0) {
    type = FLB_ML_ENDSWITH;
}
else if (strcasecmp(type_str, "multiline") == 0) {
    type = FLB_ML_MULTILINE;
}
else {
    flb_error("[multiline_parser] invalid type '%s' for parser '%s' in file '%s'", type_str, name, cfg);
    flb_sds_destroy(type_str);
    goto fconf_error;
}

flb_sds_destroy(type_str);

if (type != FLB_ML_REGEX) {
    match_string = get_parser_key(config, cf, s, "match_string");
    if (!match_string) {
        flb_error("[multiline_parser] no 'match_string' defined for parser '%s' in file '%s'", name, cfg);
        goto fconf_error;
    }
}