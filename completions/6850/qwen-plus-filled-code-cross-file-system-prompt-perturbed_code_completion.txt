FxInfo
  *fx_info;

PixelInfo
  pixel;

MagickStatusType
  status;

/*
  Pixel - color value calculator (hexadecimal format).
*/
if (image == (Image *) NULL)
  {
    (void) ThrowMagickException(exception,GetMagickModule(),
      OptionWarning,"NoImageForProperty","\"%%[%s]\"",lookup_pattern);
    continue; /* else no image to retrieve artifact */
  }
GetPixelInfo(image,&pixel);
fx_info=AcquireFxInfo(image,lookup_pattern+4,exception);
status=FxEvaluateChannelExpression(fx_info,RedPixelChannel,0,0,
  &pixel.red,exception);
status&=FxEvaluateChannelExpression(fx_info,GreenPixelChannel,0,0,
  &pixel.green,exception);
status&=FxEvaluateChannelExpression(fx_info,BluePixelChannel,0,0,
  &pixel.blue,exception);
if (image->colorspace == CMYKColorspace)
  {
    status&=FxEvaluateChannelExpression(fx_info,BlackPixelChannel,0,0,
      &pixel.black,exception);
  }
status&=FxEvaluateChannelExpression(fx_info,AlphaPixelChannel,0,0,
  &pixel.alpha,exception);
fx_info=DestroyFxInfo(fx_info);
if (status != MagickFalse)
  {
    char
      result[MagickPathExtent];

    /*
      Scale the evaluated channel values to the QuantumRange and convert to hexadecimal.
    */
    (void) FormatLocaleString(result,MagickPathExtent,"#%02X%02X%02X",
      ScaleQuantumToChar(ClampToQuantum(pixel.red)),
      ScaleQuantumToChar(ClampToQuantum(pixel.green)),
      ScaleQuantumToChar(ClampToQuantum(pixel.blue)));
    AppendString2Text(result);
  }
continue;