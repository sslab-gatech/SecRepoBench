PixelInfo
            pixel;

          size_t
            length;

          unsigned char
            *p;

          /*
            Hex color value calculator.
          */
          if (image == (Image *) NULL)
            {
              (void) ThrowMagickException(exception,GetMagickModule(),
                OptionWarning,"NoImageForProperty","\"%%[%s]\"",lookup_pattern);
              continue; /* else no image to retrieve artifact */
            }
          length=strlen(lookup_pattern+4);
          if (length == 0)
            {
              (void) ThrowMagickException(exception,GetMagickModule(),
                OptionError,"MissingHexValue","\"%%[hex:]\"");
              return((char *) NULL);
            }
          if (length > 16)
            length=16;
          p=(unsigned char *) AcquireQuantumMemory(length+1,sizeof(*p));
          if (p == (unsigned char *) NULL)
            {
              (void) ThrowMagickException(exception,GetMagickModule(),
                ResourceLimitError,"MemoryAllocationFailed",
                "Unable to allocate memory",image->filename);
              return((char *) NULL);
            }
          (void) memcpy(p,lookup_pattern+4,length);
          p[length]='\0';
          if (IsHexColor(p) == MagickFalse)
            {
              (void) ThrowMagickException(exception,GetMagickModule(),
                OptionError,"InvalidHexValue","\"%%[hex:%s]\"",p);
              p=RelinquishMagickMemory(p);
              return((char *) NULL);
            }
          GetPixelInfo(image,&pixel);
          (void) QueryColorCompliance(p,AllCompliance,&pixel,exception);
          p=RelinquishMagickMemory(p);
          (void) FormatLocaleString(value,MagickPathExtent,"%.20g %.20g %.20g",
            (double) pixel.red,(double) pixel.green,(double) pixel.blue);
          if (image->colorspace == CMYKColorspace)
            (void) FormatLocaleString(value,MagickPathExtent,
              "%.20g %.20g %.20g %.20g",(double) pixel.red,(double)
              pixel.green,(double) pixel.blue,(double) pixel.black);
          AppendString2Text(value);
          continue;
        }