FxInfo
  *fx_info;

MagickStatusType
  status;

PixelInfo
  pixel;

if (image == (Image *) NULL)
{
  (void) ThrowMagickException(exception,GetMagickModule(),
    OptionWarning,"NoImageForProperty","\"%%[%s]\"",lookup_pattern);
  continue;
}
GetPixelInfo(image,&pixel);
fx_info=AcquireFxInfo(image,lookup_pattern+4,exception);
status=FxEvaluateChannelExpression(fx_info,RedPixelChannel,0,0,
  &pixel.red,exception);
status&=FxEvaluateChannelExpression(fx_info,GreenPixelChannel,0,0,
  &pixel.green,exception);
status&=FxEvaluateChannelExpression(fx_info,BluePixelChannel,0,0,
  &pixel.blue,exception);
if (image->colorspace == CMYKColorspace)
{
  status&=FxEvaluateChannelExpression(fx_info,BlackPixelChannel,0,0,
    &pixel.black,exception);
}
status&=FxEvaluateChannelExpression(fx_info,AlphaPixelChannel,0,0,
  &pixel.alpha,exception);
fx_info=DestroyFxInfo(fx_info);
if (status != MagickFalse)
{
  char
    hex[MagickPathExtent];

  GetColorTuple(&pixel,MagickTrue,hex);
  AppendString2Text(hex);
}