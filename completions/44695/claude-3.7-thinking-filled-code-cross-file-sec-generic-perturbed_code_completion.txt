if (endp < str_end) {
    // We have more characters after the integer part
    if (*endp == '.' || *endp == 'e' || *endp == 'E') {
        // This is a floating point number
        double dval = (double)intpart;
        
        // Process decimal part
        if (*endp == '.') {
            endp++;
            if (endp >= str_end || !isdigit(*endp)) {
                PLIST_JSON_ERR("%s: invalid floating point format - digit expected after decimal point\n", __func__);
                return NULL;
            }
            
            double frac = 0.0;
            double div = 10.0;
            
            while (endp < str_end && isdigit(*endp)) {
                frac += (*endp - '0') / div;
                div *= 10.0;
                endp++;
            }
            
            dval = intpart >= 0 ? dval + frac : dval - frac;
        }
        
        // Process exponent part
        if (endp < str_end && (*endp == 'e' || *endp == 'E')) {
            endp++;
            int exp_sign = 1;
            if (endp < str_end && (*endp == '+' || *endp == '-')) {
                exp_sign = (*endp == '-') ? -1 : 1;
                endp++;
            }
            
            if (endp >= str_end || !isdigit(*endp)) {
                PLIST_JSON_ERR("%s: invalid floating point format - digit expected in exponent\n", __func__);
                return NULL;
            }
            
            int exp_val = 0;
            while (endp < str_end && isdigit(*endp)) {
                exp_val = exp_val * 10 + (*endp - '0');
                endp++;
            }
            
            // Apply exponent
            if (exp_val > 0) {
                double scale = 1.0;
                for (int i = 0; i < exp_val; i++) {
                    scale *= 10.0;
                }
                
                dval = exp_sign > 0 ? dval * scale : dval / scale;
            }
        }
        
        // Verify we've consumed all characters
        if (endp != str_end) {
            PLIST_JSON_ERR("%s: invalid floating point format - unexpected characters after number\n", __func__);
            return NULL;
        }
        
        // Create a PLIST_REAL node
        plist_data_t data = plist_new_plist_data();
        data->type = PLIST_REAL;
        data->realval = dval;
        primitivevalue = plist_new_node(data);
    } else {
        // Unexpected character after the number
        PLIST_JSON_ERR("%s: unexpected character '%c' after number\n", __func__, *endp);
        return NULL;
    }
} else {
    // This is an integer (we've consumed all characters)
    plist_data_t data = plist_new_plist_data();
    if (intpart >= 0) {
        data->type = PLIST_UINT;
        data->uintval = (uint64_t)intpart;
    } else {
        data->type = PLIST_INT;
        data->intval = intpart;
    }
    primitivevalue = plist_new_node(data);
}