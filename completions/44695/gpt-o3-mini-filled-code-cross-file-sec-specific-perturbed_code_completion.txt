if (endp == str_end) {
    plist_data_t data = plist_new_plist_data();
    data->type = PLIST_UINT;
    data->uint = (uint64_t)intpart;
    primitivevalue = plist_new_node(data);
} else {
    char *numstr = malloc(str_len + 1);
    if (!numstr) {
        PLIST_JSON_ERR("%s: Out of memory\n", __func__);
        return NULL;
    }
    memcpy(numstr, str_val, str_len);
    numstr[str_len] = '\0';

    char *endptr = NULL;
    errno = 0;
    double real_val = strtod(numstr, &endptr);
    if (errno != 0 || endptr == numstr || *endptr != '\0') {
        free(numstr);
        PLIST_JSON_ERR("%s: invalid floating point number '%.*s'\n", __func__, (int)str_len, str_val);
        return NULL;
    }
    free(numstr);

    plist_data_t data = plist_new_plist_data();
    data->type = PLIST_REAL;
    data->real = real_val;
    primitivevalue = plist_new_node(data);
}