if (endp < str_end) {
    if (*endp == '.') {
        endp++;
        if (endp < str_end && isdigit(*endp)) {
            double realval = (double)intpart + parse_fraction(endp, str_end, &endp);
            if (endp < str_end && (*endp == 'e' || *endp == 'E')) {
                endp++;
                if (endp < str_end && (*endp == '+' || *endp == '-' || isdigit(*endp))) {
                    int sign = 1;
                    if (*endp == '-') {
                        sign = -1;
                        endp++;
                    } else if (*endp == '+') {
                        endp++;
                    }
                    if (endp < str_end && isdigit(*endp)) {

                        int64_t exp = parse_decimal(endp, str_end, &endp);
                        if (exp > 500 || exp < -500) {
                            PLIST_JSON_ERR("%s: exponent too large or too small\n", __func__);
                            return NULL;
                        }

                        realval = realval * pow(10, (double)(sign * exp));
                    } else {
                        PLIST_JSON_ERR("%s: invalid floating point value\n", __func__);
                        return NULL;
                    }
                } else {
                    PLIST_JSON_ERR("%s: invalid floating point value\n", __func__);
                    return NULL;
                }
            }
            if (endp == str_end) {
                primitivevalue = plist_new_real(realval);
            } else {
                PLIST_JSON_ERR("%s: invalid floating point value\n", __func__);
            }
        }
         else {
            PLIST_JSON_ERR("%s: invalid floating point value\n", __func__);
        }
    } else {
        PLIST_JSON_ERR("%s: invalid numeric value\n", __func__);
    }
} else {
    primitivevalue = plist_new_uint(intpart);
}