int64_t fracpart = 0;
int64_t exppart = 0;
int exp_sign = 1;
int exp_num = 0;
int exp_len = 0;
bool is_float = false;

const char* endp_frac = NULL;
const char* endp_exp = NULL;

int64_t frac_val = parse_decimal(str_val, str_end, &endp_frac);
if (endp_frac == str_val) {
    // No fractional part
    primitivevalue = plist_new_int(intpart);
} else {
    fracpart = parse_decimal(endp_frac, str_end, &endp_frac);
    is_float = true;
}

if (endp_frac != str_end) {
    // Check for exponent part
    if (*endp_frac == 'e' || *endp_frac == 'E') {
        endp_exp = endp_frac + 1;
        if (*endp_exp == '-') {
            exp_sign = -1;
            endp_exp++;
        } else if (*endp_exp == '+') {
            endp_exp++;
        }
        exp_num = parse_decimal(endp_exp, str_end, &endp_exp);
        exp_len = endp_exp - endp_exp;
        exppart = exp_num;
    }
}

if (is_float) {
    double float_val = (double)intpart + ((double)fracpart / pow(10, (endp_frac - str_val)));
    if (exp_len > 0) {
        float_val *= pow(10, exp_sign * exppart);
    }
    primitivevalue = plist_new_real(float_val);
} else {
    primitivevalue = plist_new_int(intpart);
}