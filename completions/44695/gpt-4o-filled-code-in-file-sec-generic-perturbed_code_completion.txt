if (endp < str_end && *endp == '.') {
            // It's a floating point number
            endp++;
            double fracpart = 0.0;
            double divisor = 10.0;
            while (endp < str_end && isdigit(*endp)) {
                fracpart += (*endp - '0') / divisor;
                divisor *= 10.0;
                endp++;
            }
            double realval = intpart + fracpart;
            if (endp < str_end && (*endp == 'e' || *endp == 'E')) {
                endp++;
                int exp_is_neg = 0;
                if (*endp == '-') {
                    exp_is_neg = 1;
                    endp++;
                } else if (*endp == '+') {
                    endp++;
                }
                int exp = 0;
                while (endp < str_end && isdigit(*endp)) {
                    exp = exp * 10 + (*endp - '0');
                    endp++;
                }
                if (exp_is_neg) {
                    exp = -exp;
                }
                realval *= pow(10, exp);
            }
            if (endp == str_end) {
                primitivevalue = plist_new_real(realval);
            } else {
                PLIST_JSON_ERR("%s: invalid character in real number\n", __func__);
            }
        } else if (endp == str_end) {
            // It's an integer
            if (intpart >= 0) {
                primitivevalue = plist_new_uint((uint64_t)intpart);
            } else {
                primitivevalue = plist_new_int(intpart);
            }
        } else {
            PLIST_JSON_ERR("%s: invalid character in number\n", __func__);
        }