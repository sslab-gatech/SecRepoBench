for (i = 0; i < srclen; i++) {
  unsigned char c = *s++;
  if (n > (MRB_INT_MAX >> 7)) {
    mrb_raise(mrb, E_RANGE_ERROR, "BER unpacking overflow");
  }
  n = (n << 7) | (c & 0x7f);
  if (!(c & 0x80)) {
    mrb_ary_push(mrb, ary, mrb_int_value(mrb, n));
    return i + 1;
  }
}
mrb_raise(mrb, E_ARGUMENT_ERROR, "BER unpacking failed");