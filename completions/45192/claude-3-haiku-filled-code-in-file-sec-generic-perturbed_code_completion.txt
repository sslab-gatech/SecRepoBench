mrb_int i = 0;
while (srclen > 0) {
  unsigned char c = *sptr++;
  srclen--;
  if (c & 0x80) {
    mrb_int n = 0;
    while (c & 0x80) {
      if (srclen == 0) {
        mrb_raise(mrb, E_ARGUMENT_ERROR, "malformed BER integer");
      }
      n = (n << 7) + (c & 0x7f);
      c = *sptr++;
      srclen--;
    }
    n = (n << 7) + c;
    mrb_ary_push(mrb, ary, mrb_int_value(mrb, n));
  }
  else {
    mrb_ary_push(mrb, ary, mrb_int_value(mrb, c));
  }
  i++;
}
return i;