n = 0;
  
  if (srclen <= 0) {
    mrb_raise(mrb, E_ARGUMENT_ERROR, "empty BER data");
  }
  
  // Limit the number of chunks we read to the size of mrb_int
  const int max_chunks = sizeof(mrb_int) * 8 / 7;
  int chunk_count = 0;
  
  for (i = 0; i < srclen; i++) {
    unsigned char c = sourcedata[i];
    
    chunk_count++;
    if (chunk_count > max_chunks) {
      mrb_raise(mrb, E_RANGE_ERROR, "BER integer too large");
    }
    
    n = (n << 7) | (c & 0x7f);
    
    if (!(c & 0x80)) {
      i++;  // Move past the last byte we consumed
      break;  // We've successfully decoded the BER integer
    }
  }
  
  // If we've processed all bytes without finding a terminating byte
  if (i == srclen) {
    mrb_raise(mrb, E_ARGUMENT_ERROR, "incomplete BER format");
  }