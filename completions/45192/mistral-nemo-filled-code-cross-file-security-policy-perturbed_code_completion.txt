if (srclen == 0) {
  return 0;
}

n = 0;
for (i = 0; i < srclen; i++) {
  n = (n << 7) | (sourcedata[i] & 0x7f);
  if ((sourcedata[i] & 0x80) == 0) {
    break;
  }
}

if (i == srclen) {
  mrb_raise(mrb, E_RANGE_ERROR, "BER integer too long");
}

mrb_ary_push(mrb, ary, mrb_int_value(mrb, n));
return i + 1;