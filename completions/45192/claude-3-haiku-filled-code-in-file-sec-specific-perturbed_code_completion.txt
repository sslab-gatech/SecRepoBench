// This code block is responsible for unpacking a BER-compressed integer from a byte array.
// Each byte in the source data contributes 7 bits to the final value, with the 8th bit indicating if
// more bytes follow. If a byte's 8th bit is clear, the value is complete. The code raises an
// exception if the integer is invalid.
i = 0;
while (sourcedata[i] & 0x80) {
    if (++i >= srclen) {
        mrb_raise(mrb, E_ARGUMENT_ERROR, "malformed BER-compressed integer");
    }
    n = (n << 7) + (sourcedata[i] & 0x7f);
}
n = (n << 7) + sourcedata[i];
mrb_ary_push(mrb, ary, mrb_int_value(mrb, n));
return ++i;