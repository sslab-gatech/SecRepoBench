if (srclen > 0) {
    for (i = 0; i < srclen; i++) {
      n |= (sourcedata[i] & 0x7F);
      if (i < srclen - 1) {
        n <<= 7;
      }
    }
    if (sourcedata[srclen - 1] & 0x80) {
      mrb_raise(mrb, E_ARGUMENT_ERROR, "incomplete BER-compressed integer");
    }
  } else {
    mrb_raise(mrb, E_ARGUMENT_ERROR, "empty source data for BER-compressed integer");
  }