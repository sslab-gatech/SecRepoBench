if (iterator.is_empty ())
    {
      this->startGlyph = 0;
      this->classValueCount = 0;
      return_trace (true);
    }

    unsigned min_glyph = UINT_MAX;
    unsigned max_glyph = 0;
    for (const auto& pair : iterator)
    {
      unsigned g = pair.first;
      min_glyph = hb_min (min_glyph, g);
      max_glyph = hb_max (max_glyph, g);
    }

    unsigned glyph_count = max_glyph - min_glyph + 1;
    this->startGlyph = min_glyph;
    this->classValueCount = glyph_count;

    if (unlikely (!c->extend (*this, classValueCount))) return_trace (false);

    for (unsigned i = 0; i < classValueCount; i++)
      this->classValue[i] = 0;

    for (const auto& pair : iterator)
    {
      unsigned idx = pair.first - this->startGlyph;
      this->classValue[idx] = pair.second;
    }

    return_trace (true);