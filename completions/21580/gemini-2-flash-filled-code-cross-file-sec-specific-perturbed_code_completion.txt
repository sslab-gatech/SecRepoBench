if (!iterator)
    {
      c->serializer->start_glyph_index = 0;
      c->serializer->class_value_length = 0;
      return_trace (true);
    }

  hb_codepoint_t min_glyph = iterator.min ();
  hb_codepoint_t max_glyph = iterator.max ();
  unsigned glyph_count = max_glyph - min_glyph + 1;

  c->serializer->start_glyph_index = min_glyph;
  c->serializer->class_value_length = glyph_count;

  for (; iterator; ++iterator)
  {
    hb_codepoint_t glyph_index = iterator.key ();
    unsigned class_value = iterator.value ();
    if (unlikely (glyph_index < min_glyph || glyph_index > max_glyph))
      continue;

    c->serializer->class_values[glyph_index - min_glyph] = class_value;
  }

  return_trace (true);