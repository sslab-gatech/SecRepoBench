if (!iterator) {
      startGlyph = 0;
      classValue.len = 0;
      return true;
    }

    hb_codepoint_t min_glyph = + iterator | hb_map (hb_first) | hb_reduce (hb_min, HB_SET_VALUE_INVALID);
    hb_codepoint_t max_glyph = + iterator | hb_map (hb_first) | hb_reduce (hb_max, 0u);

    startGlyph = min_glyph;
    unsigned int glyph_count = max_glyph - min_glyph + 1;

    if (unlikely (!classValue.serialize (c, glyph_count)))
      return_trace (false);

    for (const auto& [glyph, klass] : iterator)
      classValue[glyph - startGlyph] = klass;

    return true;