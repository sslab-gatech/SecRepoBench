if (iterator == nullptr) {
        c->set_start_glyph_index(0);
        c->set_class_value_length(0);
        return_trace(true);
    }

    uint32_t min_glyph_index = std::numeric_limits<uint32_t>::max();
    uint32_t max_glyph_index = 0;

    for (const auto& pair : iterator) {
        min_glyph_index = std::min(min_glyph_index, pair.first);
        max_glyph_index = std::max(max_glyph_index, pair.first);
    }

    c->set_start_glyph_index(min_glyph_index);

    uint32_t glyph_count = max_glyph_index - min_glyph_index + 1;
    if (!c->serialize_class_value(glyph_count)) {
        return_trace(false);
    }

    for (const auto& pair : iterator) {
        uint32_t glyph_index = pair.first - min_glyph_index;
        if (!c->assign_class_value(glyph_index, pair.second)) {
            return_trace(false);
        }
    }

    return_trace(true);