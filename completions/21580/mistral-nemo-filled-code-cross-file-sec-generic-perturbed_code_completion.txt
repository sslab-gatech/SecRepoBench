if (iterator.is_null()) {
  c->set_starting_glyph_index(0);
  c->set_class_value_length(0);
  return true;
}

auto min_max = iterator.min_max();
c->set_starting_glyph_index(min_max.first);
c->set_glyph_count(min_max.second - min_max.first + 1);
c->serialize_class_value(min_max.second - min_max.first + 1);

auto it = iterator.begin();
for (auto i = min_max.first; i <= min_max.second; ++i, ++it) {
  c->assign_class_value(i - min_max.first, *it);
}

return true;