if (iterator.len () == 0)
{
  startGlyphID = 0;
  classValue.len = 0;
  return_trace (true);
}

hb_codepoint_t min_glyph = 0xFFFF;
hb_codepoint_t max_glyph = 0;

for (auto p : iterator)
{
  hb_codepoint_t glyph = p.first;
  min_glyph = hb_min (min_glyph, glyph);
  max_glyph = hb_max (max_glyph, glyph);
}

startGlyphID = min_glyph;
unsigned glyph_count = max_glyph - min_glyph + 1;

if (unlikely (!classValue.serialize (c, glyph_count)))
  return_trace (false);

for (auto p : iterator)
{
  hb_codepoint_t glyph = p.first;
  unsigned klass = p.second;
  unsigned index = glyph - min_glyph;
  if (likely (index < glyph_count))
    classValue[index] = klass;
}

return_trace (true);