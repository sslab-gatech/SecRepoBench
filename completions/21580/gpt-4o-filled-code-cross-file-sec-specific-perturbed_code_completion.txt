if (iterator.is_null()) {
      c->serialize_uint32(0); // starting glyph index
      c->serialize_uint32(0); // class value length
      return true;
    }

    hb_codepoint_t min_glyph = iterator.min();
    hb_codepoint_t max_glyph = iterator.max();
    unsigned int glyph_count = max_glyph - min_glyph + 1;

    c->serialize_uint32(min_glyph); // starting glyph index
    c->serialize_uint32(glyph_count); // class value length

    for (auto it = iterator; it; ++it) {
      hb_codepoint_t glyph_index = it->first - min_glyph;
      c->serialize_uint32(glyph_index);
      c->serialize_uint32(it->second); // class value
    }

    return true;