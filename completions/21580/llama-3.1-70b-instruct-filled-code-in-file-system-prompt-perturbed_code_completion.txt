if (unlikely (!c->extend_min (*this))) return_trace (false);

// If the iterator is null, set the starting glyph index and class value length to zero, and return true.
if (unlikely (!it))
{
  startGlyph = 0;
  classValue.len = 0;
  return_trace (true);
}

// Determine the minimum and maximum glyph indices from the iterator to calculate the glyph count.
hb_codepoint_t glyph_min = (*it).first;
hb_codepoint_t glyph_max = + it
                           | hb_map (hb_first)
                           | hb_reduce (hb_max, 0u);

// Set the starting glyph index to the minimum glyph index.
startGlyph = glyph_min;

// Serialize the class value using the serialization context and the calculated glyph count.
if (unlikely (!classValue.serialize (c, glyph_max - glyph_min + 1))) return_trace (false);

// Iterate over the glyph-class pairs in the iterator, and assign the class value to each glyph index relative to the starting glyph index.
unsigned int i = 0;
for (const auto gid_klass_pair : it)
{
  classValue[i++] = gid_klass_pair.second;
}

return_trace (true);