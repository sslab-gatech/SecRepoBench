if (!iterator) {
  startGlyphID = 0;
  classFormat = 1;
  return_trace (true);
}

hb_codepoint_t min_glyph = 0xFFFF, max_glyph = 0;
for (const auto& pair : iterator) {
  min_glyph = hb_min (min_glyph, pair.first);
  max_glyph = hb_max (max_glyph, pair.first);
}

startGlyphID = min_glyph;
unsigned int glyph_count = max_glyph - min_glyph + 1;

if (unlikely (!c->extend (classFormat))) return_trace (false);
classFormat = 1;

if (unlikely (!c->extend (classValue, glyph_count))) return_trace (false);

for (unsigned int i = 0; i < glyph_count; i++)
  classValue[i] = 0;

for (const auto& pair : iterator)
  classValue[pair.first - startGlyphID] = pair.second;

return_trace (true);