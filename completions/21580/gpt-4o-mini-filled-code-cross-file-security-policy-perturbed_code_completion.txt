if (iterator == nullptr) {
        c->start_glyph_index = 0;
        c->class_value_length = 0;
        return_trace (true);
    }

    hb_codepoint_t min_glyph_index = iterator.min();
    hb_codepoint_t max_glyph_index = iterator.max();
    unsigned glyph_count = max_glyph_index - min_glyph_index + 1;

    if (unlikely (!c->extend_min(glyph_count))) return_trace (false);

    c->start_glyph_index = min_glyph_index;

    if (unlikely (!c->serialize_class_value(glyph_count))) return_trace (false);

    for (hb_codepoint_t glyph_index = min_glyph_index; glyph_index <= max_glyph_index; ++glyph_index) {
        c->assign_class_value(glyph_index, iterator.get_class_value(glyph_index));
    }

    return_trace (true);