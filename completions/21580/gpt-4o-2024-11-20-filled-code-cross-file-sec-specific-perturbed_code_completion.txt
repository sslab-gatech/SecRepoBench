if (iterator.is_null())
    {
      c->serialize_uint32(0); // Starting glyph index
      c->serialize_uint32(0); // Class value length
      return true;
    }

    hb_codepoint_t min_glyph = iterator.min_glyph();
    hb_codepoint_t max_glyph = iterator.max_glyph();
    unsigned int glyph_count = max_glyph - min_glyph + 1;

    if (unlikely(!c->serialize_uint32(min_glyph))) return false;
    if (unlikely(!c->serialize_uint32(glyph_count))) return false;

    for (auto it = iterator.begin(); it != iterator.end(); ++it)
    {
      hb_codepoint_t glyph_index = it->first - min_glyph;
      if (glyph_index >= glyph_count) return false; // Prevent overflow
      c->serialize_uint32(it->second); // Serialize class value
    }

    return true;