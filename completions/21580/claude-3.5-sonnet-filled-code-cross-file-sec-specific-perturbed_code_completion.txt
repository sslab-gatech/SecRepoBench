if (!iterator) {
  startGlyphID = 0;
  classFormat = 1;
  classCount = 0;
  return_trace (true);
}

hb_codepoint_t minGlyph = HB_SET_VALUE_INVALID;
hb_codepoint_t maxGlyph = 0;
for (const auto &_ : iterator) {
  minGlyph = hb_min (minGlyph, _.first);
  maxGlyph = hb_max (maxGlyph, _.first);
}

startGlyphID = minGlyph;
unsigned int glyphCount = maxGlyph - minGlyph + 1;

if (unlikely (!c->extend (classFormat))) return_trace (false);
classFormat = 1;
if (unlikely (!c->extend (classCount))) return_trace (false);
classCount = 1;

if (unlikely (!c->extend_size (HBUINT16::static_size * glyphCount)))
  return_trace (false);

HBUINT16 *classValue = c->start_embed<HBUINT16> ();
for (unsigned int i = 0; i < glyphCount; i++)
  classValue[i] = 0;

for (const auto &pair : iterator)
  classValue[pair.first - minGlyph] = pair.second;

return_trace (true);