if (!iterator)
{
  startGlyphID = 0;
  classValueArray.len = 0;
  return_trace (true);
}

hb_codepoint_t minGlyph = HB_SET_VALUE_INVALID;
hb_codepoint_t maxGlyph = HB_SET_VALUE_INVALID;
for (const auto &_ : iterator)
{
  minGlyph = hb_min (minGlyph, _.first);
  maxGlyph = hb_max (maxGlyph, _.first);
}

startGlyphID = minGlyph;
unsigned int glyphCount = maxGlyph - minGlyph + 1;

if (unlikely (!classValueArray.serialize (c, glyphCount)))
  return_trace (false);

for (const auto &pair : iterator)
  classValueArray[pair.first - minGlyph] = pair.second;

return_trace (true);