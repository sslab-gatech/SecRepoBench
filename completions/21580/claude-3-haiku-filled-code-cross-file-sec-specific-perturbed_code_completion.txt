// Determine if the iterator is null
if (unlikely (iterator == nullptr))
{
    // Set the starting glyph index and class value length to zero
    c->start_glyph = 0;
    c->class_values_length = 0;
    return_trace (true);
}

// Determine the minimum and maximum glyph indices from the iterator
hb_codepoint_t min_glyph = HB_SET_VALUE_INVALID;
hb_codepoint_t max_glyph = 0;
for (const auto& pair : iterator)
{
    min_glyph = hb_min (min_glyph, pair.first);
    max_glyph = hb_max (max_glyph, pair.first);
}

// Set the starting glyph index to the minimum glyph index
c->start_glyph = min_glyph;

// Serialize the class value using the serialization context and the calculated glyph count
unsigned glyph_count = max_glyph - min_glyph + 1;
if (unlikely (!c->extend_min (c->class_values, glyph_count)))
    return_trace (false);

// Iterate over the glyph-class pairs in the iterator, and assign the class value to each glyph index relative to the starting glyph index
for (const auto& pair : iterator)
{
    c->class_values[pair.first - min_glyph] = pair.second;
}

return_trace (true);