if (iterator.IsEmpty ()) {
    startingGlyphIndex = 0;
    classValueLen = 0;
    return_trace (true);
  }

  unsigned min_glyph = UINT_MAX;
  unsigned max_glyph = 0;
  for (const auto& entry : iterator) {
    min_glyph = hb_min (min_glyph, entry.glyph);
    max_glyph = hb_max (max_glyph, entry.glyph);
  }

  startingGlyphIndex = min_glyph;
  unsigned glyphCount = max_glyph - min_glyph + 1;
  classValueLen = glyphCount;

  if (!classValue.serialize (c, glyphCount)) return_trace (false);

  for (unsigned i = 0; i < glyphCount; i++)
    classValue[i] = 0; // Initialize to default class

  for (const auto& entry : iterator)
    classValue[entry.glyph - startingGlyphIndex] = entry.value;

  return_trace (true);