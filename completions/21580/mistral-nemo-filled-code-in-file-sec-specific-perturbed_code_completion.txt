// <MASK>
template<typename Iterator>
static inline void
Coverage_serialize (hb_serialize_context_t *c,
                    Iterator it)
{
  TRACE_SERIALIZE (this);
  if (unlikely (!c->extend_min (*this))) return_trace (false);

  // If the iterator is null, set the format to 1 and return true.
  if (!it)
  {
    format = 1;
    return_trace (true);
  }

  // Determine the minimum and maximum glyph indices from the iterator to calculate the glyph count.
  hb_codepoint_t glyph_min = (*it).first;
  hb_codepoint_t glyph_max = + it
				 | hb_map (hb_first)
                                 | hb_reduce (hb_max, 0u);

  // Set the format to 2 if the glyph count is less than or equal to three times the number of glyphs.
  if (1 + (glyph_max - glyph_min + 1) <= 3 * (*it).len)
    format = 2;

  // Serialize the coverage based on the format.
  switch (format)
  {
  case 1:
    return_trace (u.format1.serialize (c, it));
  case 2:
    return_trace (u.format2.serialize (c, it));
  default:
    return_trace (false);
  }
}
// </MASK>