if (iterator == nullptr) {
    c->start_glyph = 0;
    c->class_values_length = 0;
    return_trace (true);
}

unsigned int min_glyph = UINT_MAX, max_glyph = 0;
for (const auto& pair : iterator) {
    min_glyph = std::min (min_glyph, pair.first);
    max_glyph = std::max (max_glyph, pair.first);
}
c->start_glyph = min_glyph;

unsigned int glyph_count = max_glyph - min_glyph + 1;
if (unlikely (!c->allocate_size<HBUINT16> (glyph_count))) return_trace (false);

for (const auto& pair : iterator) {
    c->embed<HBUINT16> (pair.second);
}

return_trace (true);