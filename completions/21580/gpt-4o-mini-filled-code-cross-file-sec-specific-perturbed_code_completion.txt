if (iterator == NULL) {
        c->starting_glyph_index = 0;
        c->class_value_length = 0;
        return true;
    }

    int min_glyph_index = iterator.get_min_glyph_index();
    int max_glyph_index = iterator.get_max_glyph_index();
    int glyph_count = max_glyph_index - min_glyph_index + 1;

    c->starting_glyph_index = min_glyph_index;

    // Allocate memory for class values securely
    size_t class_value_size = glyph_count * sizeof(ClassValueType);
    ClassValueType *class_values = (ClassValueType *)malloc(class_value_size);
    if (class_values == NULL) {
        return false; // Handle memory allocation failure
    }

    // Serialize the class values
    for (int i = 0; i < glyph_count; i++) {
        class_values[i] = iterator.get_class_value(min_glyph_index + i);
    }

    // Use the serialization context to serialize the class values
    if (!c->serialize_class_values(class_values, glyph_count)) {
        free(class_values); // Free allocated memory on failure
        return false;
    }

    free(class_values); // Free allocated memory after use
    return true;