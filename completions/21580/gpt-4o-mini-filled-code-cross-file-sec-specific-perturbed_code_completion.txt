if (iterator == nullptr) {
        c->start_glyph_index = 0;
        c->class_value_length = 0;
        return_trace(true);
    }

    unsigned min_glyph_index = iterator.min();
    unsigned max_glyph_index = iterator.max();
    unsigned glyph_count = max_glyph_index - min_glyph_index + 1;

    c->start_glyph_index = min_glyph_index;

    if (unlikely(!c->serialize_class_value(glyph_count))) return_trace(false);

    for (unsigned i = 0; i < glyph_count; i++) {
        hb_codepoint_t glyph_index = min_glyph_index + i;
        c->assign_class_value(glyph_index, iterator.get_class_value(glyph_index));
    }

    return_trace(true);