if (iterator == nullptr)
{
    c->start_glyph = 0;
    c->class_values.len = 0;
    return_trace (true);
}

hb_codepoint_t min_glyph = UINT_MAX, max_glyph = 0;
for (const auto& pair : iterator)
{
    min_glyph = hb_min (min_glyph, pair.first);
    max_glyph = hb_max (max_glyph, pair.first);
}
c->start_glyph = min_glyph;

if (!c->allocate_size<HBUINT16> (max_glyph - min_glyph + 1))
    return_trace (false);

for (const auto& pair : iterator)
    c->embed (pair.second);

return_trace (true);