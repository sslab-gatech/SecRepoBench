if (!iterator)
    {
      startGlyph = 0;
      classValue.len = 0;
      return_trace (true);
    }

    hb_codepoint_t glyph_min = (*iterator).first;
    hb_codepoint_t glyph_max = glyph_min;

    for (const auto gid_klass_pair : iterator)
    {
      hb_codepoint_t cur_gid = gid_klass_pair.first;
      glyph_max = hb_max (glyph_max, cur_gid);
    }

    unsigned glyph_count = glyph_max - glyph_min + 1;

    startGlyph = glyph_min;
    if (unlikely (!classValue.serialize (c, glyph_count))) return_trace (false);

    unsigned int i = 0;
    for (const auto gid_klass_pair : iterator)
    {
      hb_codepoint_t cur_gid = gid_klass_pair.first;
      unsigned cur_klass = gid_klass_pair.second;

      classValue.arrayZ[cur_gid - startGlyph] = cur_klass;
      i++;
    }

    return_trace (true);