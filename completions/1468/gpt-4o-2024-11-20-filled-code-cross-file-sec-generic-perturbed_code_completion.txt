// Calculate the coefficient using the magnitude, qscale, and position
        coeff = (magnitude * qscale * ctx->quant_matrix[pos]) >> 4;

        // If the magnitude is non-zero, determine the sign
        if (magnitude) {
            if (get_bits1(&ctx->gb)) // Read the sign bit
                coeff = -coeff;
        }