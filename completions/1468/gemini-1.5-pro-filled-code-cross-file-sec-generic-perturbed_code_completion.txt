if (num_bits) {
            if (magnitude & (1 << (num_bits - 1)))
                coeff = magnitude;
            else
                coeff = magnitude - (1 << num_bits) + 1;
        } else {
            coeff = 0;
        }

        coeff *= qscale * ctx->intra_quant_bias;