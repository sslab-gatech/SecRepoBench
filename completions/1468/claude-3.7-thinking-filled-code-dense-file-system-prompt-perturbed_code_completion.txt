if (magnitude) {
    // Extract sign (1 = negative, 0 = positive)
    int sign = magnitude & 1;
    
    // Calculate absolute coefficient value
    int abs_coeff = (magnitude + 1) >> 1;
    
    // Apply quantization scale
    coeff = (abs_coeff * (1 << 16)) / qscale;
    
    // Apply sign
    if (sign)
        coeff = -coeff;
} else {
    coeff = 0;
}