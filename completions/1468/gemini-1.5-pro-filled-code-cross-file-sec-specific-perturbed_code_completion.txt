coeff = magnitude;
        if (vlc & 16) // sign
            coeff = -coeff;
        coeff <<= num_bits + 1;
        if (qscale < 24)
            coeff = (coeff * ctx->vlc.iqscale[qscale] + 0x8000) >> 16;