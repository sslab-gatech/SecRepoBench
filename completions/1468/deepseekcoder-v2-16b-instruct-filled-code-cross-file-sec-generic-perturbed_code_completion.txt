coeff = lookup_table[magnitude] * (1 << (qscale / 2));
        if (pos < 8) {
            coeff = (coeff * (8 - pos)) >> 3;
        } else {
            coeff = (coeff * (16 - pos)) >> 4;
        }
        if (pos % 2 == 0) {
            coeff = -coeff;
        }