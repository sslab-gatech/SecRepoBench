coeff = magnitude * qscale; // Calculate the coefficient based on magnitude and quality scale

        // Ensure the calculated coefficient is within the valid range for the block
        if (ctx->scantable.permutated[pos] >= 0 && ctx->scantable.permutated[pos] < 64) {
            block[ctx->scantable.permutated[pos]] = coeff;
        } else {
            return AVERROR_INVALIDDATA; // Handle invalid index
        }