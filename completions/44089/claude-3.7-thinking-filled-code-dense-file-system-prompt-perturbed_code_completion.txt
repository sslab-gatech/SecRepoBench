// Create a NUL-terminated copy of the number string
char* tmp_str = malloc(str_len + 1);
if (!tmp_str) {
    PLIST_JSON_ERR("%s: malloc failed\n", __func__);
    return NULL;
}
memcpy(tmp_str, str_val, str_len);
tmp_str[str_len] = '\0';

// First try to parse as integer
errno = 0;
long long int int_val = strtoll(tmp_str, &endp, 10);
if (errno == 0 && endp && *endp == '\0') {
    // Successfully parsed as integer
    parsed_value = plist_new_uint(int_val);
} else {
    // Try parsing as floating-point
    errno = 0;
    double real_val = strtod(tmp_str, &endp);
    if (errno == 0 && endp && *endp == '\0') {
        // Successfully parsed as float
        parsed_value = plist_new_real(real_val);
    } else {
        PLIST_JSON_ERR("%s: invalid numerical value '%s' encountered\n", __func__, tmp_str);
    }
}
free(tmp_str);