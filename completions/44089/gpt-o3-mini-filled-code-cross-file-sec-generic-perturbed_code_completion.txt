errno = 0;
if (strchr(str_val, ".") || strchr(str_val, "e") || strchr(str_val, "E")) {
    double d = strtod(str_val, &endp);
    if (endp != str_end || errno != 0) {
        PLIST_JSON_ERR("%s: invalid floating-point number '%.*s'\n", __func__, (int)str_len, str_val);
        return NULL;
    }
    parsed_value = plist_new_real(d);
} else {
    if (str_val[0] == '-') {
        long long val = strtoll(str_val, &endp, 10);
        if (endp != str_end || errno != 0) {
            PLIST_JSON_ERR("%s: invalid integer number '%.*s'\n", __func__, (int)str_len, str_val);
            return NULL;
        }
        parsed_value = plist_new_integer(val);
    } else {
        unsigned long long val = strtoull(str_val, &endp, 10);
        if (endp != str_end || errno != 0) {
            PLIST_JSON_ERR("%s: invalid integer number '%.*s'\n", __func__, (int)str_len, str_val);
            return NULL;
        }
        parsed_value = plist_new_uint(val);
    }
}