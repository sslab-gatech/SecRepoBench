// Create a null-terminated copy of the token for numeric parsing
char* temp_str = malloc(str_len + 1);
if (!temp_str) {
    PLIST_JSON_ERR("%s: Out of memory\n", __func__);
    return NULL;
}
memcpy(temp_str, str_val, str_len);
temp_str[str_len] = '\0';

// Try parsing as integer first
errno = 0;
long long int int_val = strtoll(temp_str, &endp, 10);
if (errno == 0 && *endp == '\0') {
    // Successfully parsed as integer
    parsed_value = plist_new_uint(int_val);
} else {
    // Try parsing as floating-point
    errno = 0;
    double float_val = strtod(temp_str, &endp);
    if (errno == 0 && *endp == '\0') {
        // Successfully parsed as float
        parsed_value = plist_new_real(float_val);
    } else {
        PLIST_JSON_ERR("%s: invalid numerical value '%.*s' encountered\n", __func__, (int)str_len, str_val);
    }
}

free(temp_str);