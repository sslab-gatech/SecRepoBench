char numbuf[64];
size_t numlen = (str_len < sizeof(numbuf)-1) ? str_len : sizeof(numbuf)-1;
memcpy(numbuf, str_val, numlen);
numbuf[numlen] = '\0';

errno = 0;
unsigned long long uval = strtoull(numbuf, &endp, 10);
if (endp == numbuf + numlen && errno == 0) {
    parsed_value = plist_new_uint(uval);
} else {
    errno = 0;
    double dval = strtod(numbuf, &endp);
    if (endp == numbuf + numlen && errno == 0) {
        parsed_value = plist_new_real(dval);
    } else {
        PLIST_JSON_ERR("%s: invalid number value '%.*s' encountered\n", __func__, (int)str_len, str_val);
    }
}