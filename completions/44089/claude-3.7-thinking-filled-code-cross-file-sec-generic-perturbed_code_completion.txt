long long int intval;
double dval;
char* temp_str = malloc(str_len + 1);
if (!temp_str) {
    PLIST_JSON_ERR("%s: Out of memory\n", __func__);
    return NULL;
}
memcpy(temp_str, str_val, str_len);
temp_str[str_len] = '\0';

// Check if it's a floating point number
int is_float = 0;
for (size_t i = 0; i < str_len; i++) {
    if (temp_str[i] == '.' || temp_str[i] == 'e' || temp_str[i] == 'E') {
        is_float = 1;
        break;
    }
}

if (is_float) {
    // Parse as a floating-point number
    errno = 0;
    dval = strtod(temp_str, &endp);
    if (*endp != '\0' || errno == ERANGE) {
        PLIST_JSON_ERR("%s: invalid real value '%s' encountered\n", __func__, temp_str);
        free(temp_str);
        return NULL;
    }
    parsed_value = plist_new_real(dval);
} else {
    // Parse as an integer
    errno = 0;
    intval = strtoll(temp_str, &endp, 10);
    if (*endp != '\0' || errno == ERANGE) {
        PLIST_JSON_ERR("%s: invalid integer value '%s' encountered\n", __func__, temp_str);
        free(temp_str);
        return NULL;
    }
    
    if (intval >= 0) {
        parsed_value = plist_new_uint(intval);
    } else {
        parsed_value = plist_new_int(intval);
    }
}

free(temp_str);