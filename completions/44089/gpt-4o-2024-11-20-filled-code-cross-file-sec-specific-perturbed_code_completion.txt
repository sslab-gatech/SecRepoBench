// Ensure the string is null-terminated before parsing
        char* num_str = (char*)malloc(str_len + 1);
        if (!num_str) {
            PLIST_JSON_ERR("%s: Memory allocation failed\n", __func__);
            return NULL;
        }
        memcpy(num_str, str_val, str_len);
        num_str[str_len] = '\0';

        // Attempt to parse as an integer
        long long int_val = strtoll(num_str, &endp, 10);
        if (endp != num_str + str_len) {
            // If not fully consumed, attempt to parse as a floating-point number
            double real_val = strtod(num_str, &endp);
            if (endp == num_str + str_len) {
                parsed_value = plist_new_real(real_val);
            } else {
                PLIST_JSON_ERR("%s: invalid numeric value '%.*s'\n", __func__, (int)str_len, str_val);
            }
        } else {
            // Successfully parsed as an integer
            if (int_val >= 0) {
                parsed_value = plist_new_uint((uint64_t)int_val);
            } else {
                parsed_value = plist_new_int(int_val);
            }
        }

        free(num_str);