errno = 0;
double dblval = strtod(str_val, &endp);
if ((errno == ERANGE && (dblval == HUGE_VAL || dblval == -HUGE_VAL)) || (endp == str_val)) {
    PLIST_JSON_ERR("%s: invalid numeric value '%.*s' encountered\n",
                   __func__, (int)str_len, str_val);
} else if (endp != str_end) {
    PLIST_JSON_ERR("%s: invalid numeric value '%.*s' encountered\n",
                   __func__, (int)str_len, str_val);
} else {
    double intpart;
    if (modf(dblval, &intpart) == 0.0 && dblval >= 0.0 && dblval <= (double)UINT64_MAX) {
        plist_data_t data = plist_new_plist_data();
        data->type = PLIST_UINT;
        data->uintval = (uint64_t)dblval;
        parsed_value = plist_new_node(data);
    } else {
        plist_data_t data = plist_new_plist_data();
        data->type = PLIST_REAL;
        data->realval = dblval;
        parsed_value = plist_new_node(data);
    }
}