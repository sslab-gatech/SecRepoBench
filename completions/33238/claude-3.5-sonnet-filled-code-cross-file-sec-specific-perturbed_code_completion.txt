if (input_string.empty()) {
    return;
}

// Remove leading spaces or new lines
size_t start = input_string.find_first_not_of(" \n");
if (start != std::string::npos) {
    input_string = input_string.substr(start);
}

char os_separator = '/';
#ifdef _WIN32
os_separator = '\\';
#endif

std::string result;
result.reserve(input_string.length());

for (size_t i = 0; i < input_string.length(); ++i) {
    char c = input_string[i];

    // Handle directory separators
    if (c == '/' || c == '\\') {
        if (result.empty() || result.back() != os_separator) {
            result += os_separator;
        }
        continue;
    }

    // Skip over "://" and "\\\\"
    if (i + 2 < input_string.length()) {
        if ((c == ':' && input_string[i + 1] == '/' && input_string[i + 2] == '/') ||
            (c == '\\' && input_string[i + 1] == '\\' && input_string[i + 2] == '\\')) {
            result += input_string.substr(i, 3);
            i += 2;
            continue;
        }
    }

    // Handle hexadecimal sequences
    if (c == '%' && i + 2 < input_string.length()) {
        std::string hex = input_string.substr(i + 1, 2);
        char *end;
        long value = std::strtol(hex.c_str(), &end, 16);
        if (end == hex.c_str() + 2) {
            result += static_cast<char>(value);
            i += 2;
            continue;
        }
    }

    result += c;
}

input_string = result;