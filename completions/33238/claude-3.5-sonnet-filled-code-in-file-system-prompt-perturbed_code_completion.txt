if (input_string.empty()) {
    return;
}

// Remove leading spaces or newlines
while (!input_string.empty() && (input_string[0] == ' ' || input_string[0] == '\n')) {
    input_string.erase(0, 1);
}

std::string::iterator it = input_string.begin();
bool is_uri = false;

while (it != input_string.end()) {
    if (*it == '/' || *it == '\\') {
        *it = mSep;

        // Reduce double delimiters to single ones
        std::string::iterator next = it + 1;
        if (next != input_string.end() && (*next == '/' || *next == '\\')) {
            if ((it != input_string.begin() && *(it - 1) == ':') || 
                (it == input_string.begin() && *(it + 1) == '/' && *(it + 2) == '/')) {
                // Keep the double slash for "://" and "\\\\" cases
                ++it;
            } else {
                input_string.erase(next);
            }
        }
    } else if (*it == '%' && is_uri) {
        // Assume URI encoding, replace %XX with the actual character
        if (std::distance(it, input_string.end()) > 2 && IsHex(*(it + 1)) && IsHex(*(it + 2))) {
            const char val = (HexOctetToDecimal(*(it + 1)) << 4) + HexOctetToDecimal(*(it + 2));
            *it = val;
            input_string.erase(it + 1, it + 3);
        }
    } else if (*it == ':' && std::distance(input_string.begin(), it) > 1) {
        is_uri = true;
    }

    ++it;
}