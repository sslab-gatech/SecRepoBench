if (input_string.empty()) {
            return;
        }

        // Remove leading spaces and newlines
        size_t first_valid_char = input_string.find_first_not_of(" \r\n");
        if (first_valid_char != std::string::npos) {
            input_string.erase(0, first_valid_char);
        }

        // Use the correct directory separator
        char dir_sep = directory_separator();

        std::string output_string;
        output_string.reserve(input_string.size() + 1); // Reserve enough space

        for (size_t i = 0; i < input_string.size(); ++i) {
            char current_char = input_string[i];

            if (current_char == '/' || current_char == '\\') {
                // Check for double delimiters and special cases
                if (!output_string.empty() && output_string.back() == dir_sep) {
                    if (i + 1 < input_string.size()) {
                        char next_char = input_string[i + 1];
                        if ((current_char == '/' && next_char == '/') || (current_char == '\\' && next_char == '\\')) {
                            // Skip over "//" or "\\"
                            ++i;
                            continue;
                        }
                        if ((current_char == '/' || current_char == '\\') && (next_char == '/' || next_char == '\\')) {
                            // Skip over "/\" or "\/"
                            ++i;
                        }
                    }
                    continue; // Skip adding a second delimiter
                }
                output_string += dir_sep;
            } else if (current_char == '%') {
                // Handle URI encoding
                if (i + 2 < input_string.size()) {
                    char hex_str[3] = {input_string[i + 1], input_string[i + 2], '\0'};
                    char decoded_char = static_cast<char>(strtol(hex_str, nullptr, 16));
                    if (decoded_char != '\0') {
                        output_string += decoded_char;
                        i += 2;
                        continue;
                    }
                }
                output_string += current_char; // If not a valid hex sequence, treat as normal char.
            } else if (current_char == ':' && i + 2 < input_string.size() && input_string[i + 1] == '/' && input_string[i + 2] == '/') {
                // Skip over "://"
                output_string += "://";
                i += 2;
            } else {
                output_string += current_char;
            }
        }

        input_string = output_string;