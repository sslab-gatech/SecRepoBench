std::string* word_copy = NULL;
std::string* desc_copy = NULL;
const std::string* word = &in_word;
const std::string* desc = inputdesc;

// Check if we need to handle ignored characters or complex prefixes
if (!ignorechars.empty() || complexprefixes) {
  word_copy = new std::string(in_word);
  if (!word_copy) {
    free_flag(aff, al);
    return 1;
  }
  
  // Remove ignored characters if needed
  if (!ignorechars.empty()) {
    for (size_t i = 0; i < ignorechars.size(); ++i) {
      char ch = ignorechars[i];
      word_copy->erase(std::remove(word_copy->begin(), word_copy->end(), ch), word_copy->end());
    }
  }
  
  // Reverse the word if complex prefixes are enabled
  if (complexprefixes) {
    std::reverse(word_copy->begin(), word_copy->end());
    
    // Also reverse the description if there is one and aliasing is not used
    if (inputdesc && aliasm.empty()) {
      desc_copy = new std::string(*inputdesc);
      if (!desc_copy) {
        delete word_copy;
        free_flag(aff, al);
        return 1;
      }
      std::reverse(desc_copy->begin(), desc_copy->end());
      desc = desc_copy;
    }
  }
  
  word = word_copy;
}