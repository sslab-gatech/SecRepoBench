image->resolution.y);
          }
      }
    if (image->orientation != TopLeftOrientation)
      (void) TIFFSetField(tiff,TIFFTAG_ORIENTATION,(uint16) image->orientation);
    if (image->chromaticity.white_point.x != 0.0)
      {
        float
          *chromaticity;

        chromaticity=(float *) AcquireQuantumMemory(3*sizeof(*chromaticity));
        if (chromaticity == (float *) NULL)
          ThrowWriterException(ResourceLimitError,"MemoryAllocationFailed");
        chromaticity[0]=image->chromaticity.white_point.x;
        chromaticity[1]=image->chromaticity.white_point.y;
        chromaticity[2]=0.0;
        (void) TIFFSetField(tiff,TIFFTAG_WHITEPOINT,chromaticity);
        chromaticity=(float *) RelinquishMagickMemory(chromaticity);
      }
    if (image->chromaticity.red_primary.x != 0.0)
      {
        float
          *chromaticity;

        chromaticity=(float *) AcquireQuantumMemory(3*sizeof(*chromaticity));
        if (chromaticity == (float *) NULL)
          ThrowWriterException(ResourceLimitError,"MemoryAllocationFailed");
        chromaticity[0]=image->chromaticity.red_primary.x;
        chromaticity[1]=image->chromaticity.red_primary.y;
        chromaticity[2]=0.0;
        (void) TIFFSetField(tiff,TIFFTAG_RED_PRIMARIES,chromaticity);
        chromaticity=(float *) RelinquishMagickMemory(chromaticity);
      }
    if (image->chromaticity.green_primary.x != 0.0)
      {
        float
          *chromaticity;

        chromaticity=(float *) AcquireQuantumMemory(3*sizeof(*chromaticity));
        if (chromaticity == (float *) NULL)
          ThrowWriterException(ResourceLimitError,"MemoryAllocationFailed");
        chromaticity[0]=image->chromaticity.green_primary.x;
        chromaticity[1]=image->chromaticity.green_primary.y;
        chromaticity[2]=0.0;
        (void) TIFFSetField(tiff,TIFFTAG_GREEN_PRIMARIES,chromaticity);
        chromaticity=(float *) RelinquishMagickMemory(chromaticity);
      }
    if (image->chromaticity.blue_primary.x != 0.0)
      {
        float
          *chromaticity;

        chromaticity=(float *) AcquireQuantumMemory(3*sizeof(*chromaticity));
        if (chromaticity == (float *) NULL)
          ThrowWriterException(ResourceLimitError,"MemoryAllocationFailed");
        chromaticity[0]=image->chromaticity.blue_primary.x;
        chromaticity[1]=image->chromaticity.blue_primary.y;
        chromaticity[2]=0.0;
        (void) TIFFSetField(tiff,TIFFTAG_BLUE_PRIMARIES,chromaticity);
        chromaticity=(float *) RelinquishMagickMemory(chromaticity);
      }
    if (image->colorspace == CMYKColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_INKSET,INKSET_CMYK);
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_SEPARATED);
      }
    if (image->colorspace == YCbCrColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_YCBCR);
        (void) TIFFSetField(tiff,TIFFTAG_YCBCRSUBSAMPLING,1,1);
      }
    if (image->colorspace == LabColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_CIELAB);
        (void) TIFFSetField(tiff,TIFFTAG_EXTRASAMPLES,1,&EXTRASAMPLE_ASSOCALPHA);
      }
    if (image->colorspace == GrayColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_MINISBLACK);
        (void) TIFFSetField(tiff,TIFFTAG_BITSPERSAMPLE,8);
      }
    if (image->colorspace == BilevelColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_MINISBLACK);
        (void) TIFFSetField(tiff,TIFFTAG_BITSPERSAMPLE,1);
      }
    if (image->colorspace == RGBColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
        (void) TIFFSetField(tiff,TIFFTAG_BITSPERSAMPLE,8);
      }
    if (image->colorspace == RGBAColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
        (void) TIFFSetField(tiff,TIFFTAG_BITSPERSAMPLE,8);
        (void) TIFFSetField(tiff,TIFFTAG_EXTRASAMPLES,1,&EXTRASAMPLE_UNASSALPHA);
      }
    if (image->colorspace == CMYKAColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_SEPARATED);
        (void) TIFFSetField(tiff,TIFFTAG_BITSPERSAMPLE,8);
        (void) TIFFSetField(tiff,TIFFTAG_EXTRASAMPLES,1,&EXTRASAMPLE_UNASSALPHA);
      }
    if (image->colorspace == GrayAlphaColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_MINISBLACK);
        (void) TIFFSetField(tiff,TIFFTAG_BITSPERSAMPLE,8);
        (void) TIFFSetField(tiff,TIFFTAG_EXTRASAMPLES,1,&EXTRASAMPLE_UNASSALPHA);
      }
    if (image->colorspace == BilevelAlphaColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_MINISBLACK);
        (void) TIFFSetField(tiff,TIFFTAG_BITSPERSAMPLE,1);
        (void) TIFFSetField(tiff,TIFFTAG_EXTRASAMPLES,1,&EXTRASAMPLE_UNASSALPHA);
      }
    if (image->colorspace == RGBAlphaColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
        (void) TIFFSetField(tiff,TIFFTAG_BITSPERSAMPLE,8);
        (void) TIFFSetField(tiff,TIFFTAG_EXTRASAMPLES,1,&EXTRASAMPLE_UNASSALPHA);
      }
    if (image->colorspace == CMYKAlphaColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_SEPARATED);
        (void) TIFFSetField(tiff,TIFFTAG_BITSPERSAMPLE,8);
        (void) TIFFSetField(tiff,TIFFTAG_EXTRASAMPLES,1,&EXTRASAMPLE_UNASSALPHA);
      }
    if (image->colorspace == YCbCrAlphaColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_YCBCR);
        (void) TIFFSetField(tiff,TIFFTAG_YCBCRSUBSAMPLING,1,1);
        (void) TIFFSetField(tiff,TIFFTAG_EXTRASAMPLES,1,&EXTRASAMPLE_UNASSALPHA);
      }
    if (image->colorspace == LabAlphaColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_CIELAB);
        (void) TIFFSetField(tiff,TIFFTAG_EXTRASAMPLES,1,&EXTRASAMPLE_ASSOCALPHA);
      }
    if (image->colorspace == GRAYColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_MINISBLACK);
        (void) TIFFSetField(tiff,TIFFTAG_BITSPERSAMPLE,8);
      }
    if (image->colorspace == BilevelColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_MINISBLACK);
        (void) TIFFSetField(tiff,TIFFTAG_BITSPERSAMPLE,1);
      }
    if (image->colorspace == RGBColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
        (void) TIFFSetField(tiff,TIFFTAG_BITSPERSAMPLE,8);
      }
    if (image->colorspace == RGBAColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
        (void) TIFFSetField(tiff,TIFFTAG_BITSPERSAMPLE,8);
        (void) TIFFSetField(tiff,TIFFTAG_EXTRASAMPLES,1,&EXTRASAMPLE_UNASSALPHA);
      }
    if (image->colorspace == CMYKColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_SEPARATED);
        (void) TIFFSetField(tiff,TIFFTAG_BITSPERSAMPLE,8);
      }
    if (image->colorspace == CMYKAColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_SEPARATED);
        (void) TIFFSetField(tiff,TIFFTAG_BITSPERSAMPLE,8);
        (void) TIFFSetField(tiff,TIFFTAG_EXTRASAMPLES,1,&EXTRASAMPLE_UNASSALPHA);
      }
    if (image->colorspace == YCbCrColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_YCBCR);
        (void) TIFFSetField(tiff,TIFFTAG_YCBCRSUBSAMPLING,1,1);
      }
    if (image->colorspace == LabColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_CIELAB);
      }
    if (image->colorspace == GrayAlphaColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_MINISBLACK);
        (void) TIFFSetField(tiff,TIFFTAG_BITSPERSAMPLE,8);
        (void) TIFFSetField(tiff,TIFFTAG_EXTRASAMPLES,1,&EXTRASAMPLE_UNASSALPHA);
      }
    if (image->colorspace == BilevelAlphaColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_MINISBLACK);
        (void) TIFFSetField(tiff,TIFFTAG_BITSPERSAMPLE,1);
        (void) TIFFSetField(tiff,TIFFTAG_EXTRASAMPLES,1,&EXTRASAMPLE_UNASSALPHA);
      }
    if (image->colorspace == RGBAlphaColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_RGB);
        (void) TIFFSetField(tiff,TIFFTAG_BITSPERSAMPLE,8);
        (void) TIFFSetField(tiff,TIFFTAG_EXTRASAMPLES,1,&EXTRASAMPLE_UNASSALPHA);
      }
    if (image->colorspace == CMYKAlphaColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_SEPARATED);
        (void) TIFFSetField(tiff,TIFFTAG_BITSPERSAMPLE,8);
        (void) TIFFSetField(tiff,TIFFTAG_EXTRASAMPLES,1,&EXTRASAMPLE_UNASSALPHA);
      }
    if (image->colorspace == YCbCrAlphaColorspace)
      {
        (void) TIFFSetField(tiff,TIFFTAG_PHOTOMETRIC,PHOTOMETRIC_YCBCR);
        (void) TIFFSetField(tiff,TIFFTAG_YCBCRSUBSAMPLING,1,1);
        (void) TIFFSetField(tiff,TIFFTAG_EXTRASAMPLES,1,&EXTRASAMPLE_UNASSALPHA);
      }
    if (image