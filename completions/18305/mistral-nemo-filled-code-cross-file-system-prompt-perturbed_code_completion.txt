0)
      {
        float
          white_point[2];

        white_point[0]=image->chromaticity.white_point.x;
        white_point[1]=image->chromaticity.white_point.y;
        (void) TIFFSetField(tiff,TIFFTAG_WHITEPOINT,white_point);
      }
    if (image->chromaticity.red_primary.x != 0.0)
      {
        float
          primary[6];

        primary[0]=image->chromaticity.red_primary.x;
        primary[1]=image->chromaticity.red_primary.y;
        primary[2]=image->chromaticity.green_primary.x;
        primary[3]=image->chromaticity.green_primary.y;
        primary[4]=image->chromaticity.blue_primary.x;
        primary[5]=image->chromaticity.blue_primary.y;
        (void) TIFFSetField(tiff,TIFFTAG_PRIMARYCHROMATICITIES,primary);
      }
    if (image->orientation != TopLeftOrientation)
      (void) TIFFSetField(tiff,TIFFTAG_ORIENTATION,(uint16) image->orientation);
    if (image->page.x != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEOFFSET,(uint32) image->page.x);
    if (image->page.y != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEOFFSET,(uint32) image->page.y);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILEWIDTH,(uint32) image->page.width);
    if (image->page.height != 0)
      (void) TIFFSetField(tiff,TIFFTAG_TILELENGTH,(uint32) image->page.height);
    if (image->page.width != 0)
      (void) TI