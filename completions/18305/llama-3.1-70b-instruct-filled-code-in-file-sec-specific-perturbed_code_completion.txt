if (TIFFGetFieldDefaulted(tiff,TIFFTAG_RESOLUTIONUNIT,&units) == 1)
{
    if (units == RESUNIT_INCH)
        image->units=PixelsPerInchResolution;
    if (units == RESUNIT_CENTIMETER)
        image->units=PixelsPerCentimeterResolution;
}
if ((TIFFGetFieldDefaulted(tiff,TIFFTAG_XPOSITION,&x_position) == 1) &&
    (TIFFGetFieldDefaulted(tiff,TIFFTAG_YPOSITION,&y_position) == 1))
{
    image->page.x=(ssize_t) ceil(x_position*image->resolution.x-0.5);
    image->page.y=(ssize_t) ceil(y_position*image->resolution.y-0.5);
}
if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ORIENTATION,&orientation) == 1)
    image->orientation=(OrientationType) orientation;
if (TIFFGetField(tiff,TIFFTAG_WHITEPOINT,&chromaticity) == 1)
{
    if (chromaticity!= (float *) NULL)
    {
        image->chromaticity.white_point.x=chromaticity[0];
        image->chromaticity.white_point.y=chromaticity[1];
    }
}
if (TIFFGetField(tiff,TIFFTAG_PRIMARYCHROMATICITIES,&chromaticity) == 1)
{
    if (chromaticity!= (float *) NULL)
    {
        image->chromaticity.red_primary.x=chromaticity[0];
        image->chromaticity.red_primary.y=chromaticity[1];
        image->chromaticity.green_primary.x=chromaticity[2];
        image->chromaticity.green_primary.y=chromaticity[3];
        image->chromaticity.blue_primary.x=chromaticity[4];
        image->chromaticity.blue_primary.y=chromaticity[5];
    }
}
#if defined(MAGICKCORE_HAVE_TIFFISCODECCONFIGURED) || (TIFFLIB_VERSION > 20040919)
if ((compress_tag!= COMPRESSION_NONE) &&
    (TIFFIsCODECConfigured(compress_tag) == 0))
{
    TIFFClose(tiff);
    ThrowReaderException(CoderError,"CompressNotSupported");
}
#endif
switch (compress_tag)
{
    case COMPRESSION_NONE: image->compression=NoCompression; break;
    case COMPRESSION_CCITTFAX3: image->compression=FaxCompression; break;
    case COMPRESSION_CCITTFAX4: image->compression=Group4Compression; break;
    case COMPRESSION_JPEG:
    {
        image->compression=JPEGCompression;
#if defined(JPEG_SUPPORT)
        {
            char
                sampling_factor[MagickPathExtent];

            uint16
                horizontal,
                vertical;

            tiff_status=TIFFGetField(tiff,TIFFTAG_YCBCRSUBSAMPLING,&horizontal,
                &vertical);
            if (tiff_status == 1)
            {
                (void) FormatLocaleString(sampling_factor,MagickPathExtent,
                    "%dx%d",horizontal,vertical);
                (void) SetImageProperty(image,"jpeg:sampling-factor",
                    sampling_factor,exception);
                (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                    "Sampling Factors: %s",sampling_factor);
            }
        }
#endif
        break;
    }
    case COMPRESSION_OJPEG: image->compression=JPEGCompression; break;
#if defined(COMPRESSION_LZMA)
    case COMPRESSION_LZMA: image->compression=LZMACompression; break;
#endif
    case COMPRESSION_LZW: image->compression=LZWCompression; break;
    case COMPRESSION_DEFLATE: image->compression=ZipCompression; break;
    case COMPRESSION_ADOBE_DEFLATE: image->compression=ZipCompression; break;
#if defined(COMPRESSION_WEBP)
    case COMPRESSION_WEBP: image->compression=WebPCompression; break;
#endif
#if defined(COMPRESSION_ZSTD)
    case COMPRESSION_ZSTD: image->compression=ZstdCompression; break;
#endif
    default: image->compression=RLECompression; break;
}