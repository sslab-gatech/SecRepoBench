,&bits_per_sample);
        if (bits_per_sample == 8)
          predictor=PREDICTOR_HORIZONTAL;
        break;
#endif
      }
      default:
        break;
    }
    if (predictor != 0)
      (void) TIFFSetField(tiff,TIFFTAG_PREDICTOR,predictor);
    if (image_info->adjoin != MagickFalse)
      (void) TIFFSetField(tiff,TIFFTAG_SUBFILETYPE,FILETYPE_REDUCEDIMAGE);
    if (image_info->scene != 0)
      (void) TIFFSetField(tiff,TIFFTAG_PAGENUMBER,scene+1,image_info->number_scenes);
    if (image_info->resolution.x != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_XRESOLUTION,image_info->resolution.x);
    if (image_info->resolution.y != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_YRESOLUTION,image_info->resolution.y);
    if (image_info->units != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_RESOLUTIONUNIT,
        (uint16) image_info->units);
    if (image_info->compression != UndefinedCompression)
      (void) TIFFSetField(tiff,TIFFTAG_COMPRESSION,image_info->compression);
    if (image_info->adjoin != MagickFalse)
      (void) TIFFSetField(tiff,TIFFTAG_SUBFILETYPE,FILETYPE_REDUCEDIMAGE);
    if (image_info->scene != 0)
      (void) TIFFSetField(tiff,TIFFTAG_PAGENUMBER,scene+1,image_info->number_scenes);
    if (image_info->resolution.x != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_XRESOLUTION,image_info->resolution.x);
    if (image_info->resolution.y != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_YRESOLUTION,image_info->resolution.y);
    if (image_info->units != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_RESOLUTIONUNIT,
        (uint16) image_info->units);
    if (image_info->compression != UndefinedCompression)
      (void) TIFFSetField(tiff,TIFFTAG_COMPRESSION,image_info->compression);
    if (image_info->adjoin != MagickFalse)
      (void) TIFFSetField(tiff,TIFFTAG_SUBFILETYPE,FILETYPE_REDUCEDIMAGE);
    if (image_info->scene != 0)
      (void) TIFFSetField(tiff,TIFFTAG_PAGENUMBER,scene+1,image_info->number_scenes);
    if (image_info->resolution.x != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_XRESOLUTION,image_info->resolution.x);
    if (image_info->resolution.y != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_YRESOLUTION,image_info->resolution.y);
    if (image_info->units != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_RESOLUTIONUNIT,
        (uint16) image_info->units);
    if (image_info->compression != UndefinedCompression)
      (void) TIFFSetField(tiff,TIFFTAG_COMPRESSION,image_info->compression);
    if (image_info->adjoin != MagickFalse)
      (void) TIFFSetField(tiff,TIFFTAG_SUBFILETYPE,FILETYPE_REDUCEDIMAGE);
    if (image_info->scene != 0)
      (void) TIFFSetField(tiff,TIFFTAG_PAGENUMBER,scene+1,image_info->number_scenes);
    if (image_info->resolution.x != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_XRESOLUTION,image_info->resolution.x);
    if (image_info->resolution.y != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_YRESOLUTION,image_info->resolution.y);
    if (image_info->units != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_RESOLUTIONUNIT,
        (uint16) image_info->units);
    if (image_info->compression != UndefinedCompression)
      (void) TIFFSetField(tiff,TIFFTAG_COMPRESSION,image_info->compression);
    if (image_info->adjoin != MagickFalse)
      (void) TIFFSetField(tiff,TIFFTAG_SUBFILETYPE,FILETYPE_REDUCEDIMAGE);
    if (image_info->scene != 0)
      (void) TIFFSetField(tiff,TIFFTAG_PAGENUMBER,scene+1,image_info->number_scenes);
    if (image_info->resolution.x != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_XRESOLUTION,image_info->resolution.x);
    if (image_info->resolution.y != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_YRESOLUTION,image_info->resolution.y);
    if (image_info->units != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_RESOLUTIONUNIT,
        (uint16) image_info->units);
    if (image_info->compression != UndefinedCompression)
      (void) TIFFSetField(tiff,TIFFTAG_COMPRESSION,image_info->compression);
    if (image_info->adjoin != MagickFalse)
      (void) TIFFSetField(tiff,TIFFTAG_SUBFILETYPE,FILETYPE_REDUCEDIMAGE);
    if (image_info->scene != 0)
      (void) TIFFSetField(tiff,TIFFTAG_PAGENUMBER,scene+1,image_info->number_scenes);
    if (image_info->resolution.x != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_XRESOLUTION,image_info->resolution.x);
    if (image_info->resolution.y != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_YRESOLUTION,image_info->resolution.y);
    if (image_info->units != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_RESOLUTIONUNIT,
        (uint16) image_info->units);
    if (image_info->compression != UndefinedCompression)
      (void) TIFFSetField(tiff,TIFFTAG_COMPRESSION,image_info->compression);
    if (image_info->adjoin != MagickFalse)
      (void) TIFFSetField(tiff,TIFFTAG_SUBFILETYPE,FILETYPE_REDUCEDIMAGE);
    if (image_info->scene != 0)
      (void) TIFFSetField(tiff,TIFFTAG_PAGENUMBER,scene+1,image_info->number_scenes);
    if (image_info->resolution.x != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_XRESOLUTION,image_info->resolution.x);
    if (image_info->resolution.y != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_YRESOLUTION,image_info->resolution.y);
    if (image_info->units != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_RESOLUTIONUNIT,
        (uint16) image_info->units);
    if (image_info->compression != UndefinedCompression)
      (void) TIFFSetField(tiff,TIFFTAG_COMPRESSION,image_info->compression);
    if (image_info->adjoin != MagickFalse)
      (void) TIFFSetField(tiff,TIFFTAG_SUBFILETYPE,FILETYPE_REDUCEDIMAGE);
    if (image_info->scene != 0)
      (void) TIFFSetField(tiff,TIFFTAG_PAGENUMBER,scene+1,image_info->number_scenes);
    if (image_info->resolution.x != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_XRESOLUTION,image_info->resolution.x);
    if (image_info->resolution.y != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_YRESOLUTION,image_info->resolution.y);
    if (image_info->units != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_RESOLUTIONUNIT,
        (uint16) image_info->units);
    if (image_info->compression != UndefinedCompression)
      (void) TIFFSetField(tiff,TIFFTAG_COMPRESSION,image_info->compression);
    if (image_info->adjoin != MagickFalse)
      (void) TIFFSetField(tiff,TIFFTAG_SUBFILETYPE,FILETYPE_REDUCEDIMAGE);
    if (image_info->scene != 0)
      (void) TIFFSetField(tiff,TIFFTAG_PAGENUMBER,scene+1,image_info->number_scenes);
    if (image_info->resolution.x != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_XRESOLUTION,image_info->resolution.x);
    if (image_info->resolution.y != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_YRESOLUTION,image_info->resolution.y);
    if (image_info->units != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_RESOLUTIONUNIT,
        (uint16) image_info->units);
    if (image_info->compression != UndefinedCompression)
      (void) TIFFSetField(tiff,TIFFTAG_COMPRESSION,image_info->compression);
    if (image_info->adjoin != MagickFalse)
      (void) TIFFSetField(tiff,TIFFTAG_SUBFILETYPE,FILETYPE_REDUCEDIMAGE);
    if (image_info->scene != 0)
      (void) TIFFSetField(tiff,TIFFTAG_PAGENUMBER,scene+1,image_info->number_scenes);
    if (image_info->resolution.x != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_XRESOLUTION,image_info->resolution.x);
    if (image_info->resolution.y != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_YRESOLUTION,image_info->resolution.y);
    if (image_info->units != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_RESOLUTIONUNIT,
        (uint16) image_info->units);
    if (image_info->compression != UndefinedCompression)
      (void) TIFFSetField(tiff,TIFFTAG_COMPRESSION,image_info->compression);
    if (image_info->adjoin != MagickFalse)
      (void) TIFFSetField(tiff,TIFFTAG_SUBFILETYPE,FILETYPE_REDUCEDIMAGE);
    if (image_info->scene != 0)
      (void) TIFFSetField(tiff,TIFFTAG_PAGENUMBER,scene+1,image_info->number_scenes);
    if (image_info->resolution.x != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_XRESOLUTION,image_info->resolution.x);
    if (image_info->resolution.y != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_YRESOLUTION,image_info->resolution.y);
    if (image_info->units != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_RESOLUTIONUNIT,
        (uint16) image_info->units);
    if (image_info->compression != UndefinedCompression)
      (void) TIFFSetField(tiff,TIFFTAG_COMPRESSION,image_info->compression);
    if (image_info->adjoin != MagickFalse)
      (void) TIFFSetField(tiff,TIFFTAG_SUBFILETYPE,FILETYPE_REDUCEDIMAGE);
    if (image_info->scene != 0)
      (void) TIFFSetField(tiff,TIFFTAG_PAGENUMBER,scene+1,image_info->number_scenes);
    if (image_info->resolution.x != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_XRESOLUTION,image_info->resolution.x);
    if (image_info->resolution.y != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_YRESOLUTION,image_info->resolution.y);
    if (image_info->units != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_RESOLUTIONUNIT,
        (uint16) image_info->units);
    if (image_info->compression != UndefinedCompression)
      (void) TIFFSetField(tiff,TIFFTAG_COMPRESSION,image_info->compression);
    if (image_info->adjoin !=