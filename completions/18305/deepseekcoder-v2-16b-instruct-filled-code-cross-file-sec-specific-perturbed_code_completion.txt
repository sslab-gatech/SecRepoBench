YCBCRSUBSAMPLING,
                      geometry_info.rho,geometry_info.sigma);
                  }
              }
          }
#endif
        break;
      }
      case COMPRESSION_NONE:
      {
        if (image->storage_class == DirectClass)
          {
            if (image->depth == 1)
              predictor=PREDICTOR_HORIZONTAL;
            else
              if (image->depth == 8)
                predictor=PREDICTOR_FLOATINGPOINT;
          }
        break;
      }
      default:
        break;
    }
    if (predictor != 0)
      (void) TIFFSetField(tiff,TIFFTAG_PREDICTOR,predictor);
    if (image->resolution.x != 0.0)
      (void) TIFFSetField(tiff,TIFFTAG_XRESOLUTION,image->resolution.x);
    if (image->resolution.y != 0.0)
      (void) TIFFSetField(tiff,TIFFTAG_YRESOLUTION,image->resolution.y);
    if (image->units != UndefinedResolution)
      (void) TIFFSetField(tiff,TIFFTAG_RESOLUTIONUNIT,
        (uint16) image->units);
    if (image->page.x != 0)
      (void) TIFFSetField(tiff,TIFFTAG_XPOSITION,image->page.x);
    if (image->page.y != 0)
      (void) TIFFSetField(tiff,TIFFTAG_YPOSITION,image->page.y);
    if (image->orientation != UndefinedOrientation)
      (void) TIFFSetField(tiff,TIFFTAG_ORIENTATION,
        (uint16) image->orientation);
    if (image->chromaticity.white_point.x != 0.0)
      (void) TIFFSetField(tiff,TIFFTAG_WHITEPOINT,image->chromaticity.white_point.x,
        image->chromaticity.white_point.y);
    if (image->chromaticity.red_primary.x != 0.0)
      (void) TIFFSetField(tiff,TIFFTAG_PRIMARYCHROMATICITIES,
        image->chromaticity.red_primary.x,image->chromaticity.red_primary.y,
        image->chromaticity.green_primary.x,image->chromaticity.green_primary.y,
        image->chromaticity.blue_primary.x,image->chromaticity.blue_primary.y);
    if (image->debug != MagickFalse)
      {
        (void) LogMagickEvent(CoderEvent,GetMagickModule(),"Geometry: %ux%u",
          (unsigned int) image->columns,(unsigned int) image->rows);
        (void) LogMagickEvent(CoderEvent,GetMagickModule(),"Depth: %u",
          (unsigned int) image->depth);
        (void) LogMagickEvent(CoderEvent,GetMagickModule(),"Resolution: %.20g x %.20g",
          image->resolution.x,image->resolution.y);
        (void) LogMagickEvent(CoderEvent,GetMagickModule(),"Units: %s",
          GetQuantumUnits(image->units));
        (void) LogMagickEvent(CoderEvent,GetMagickModule(),"Page: %ux%u",
          (unsigned int) image->page.x,(unsigned int) image->page.y);
        (void) LogMagickEvent(CoderEvent,GetMagickModule(),"Orientation: %s",
          GetOrientation(image->orientation));
      }
    if (image->storage_class == DirectClass)
      {
        if (image->depth == 1)
          quantum_type=BitPixel;
        else
          if (image->depth == 8)
            quantum_type=CharPixel;
          else
            if (image->depth == 16)
              quantum_type=ShortPixel;
            else
              if (image->depth == 32)
                quantum_type=FloatPixel;
        if (image->colorspace == CMYKColorspace)
          quantum_type=CMYKPixel;
        if (image->colorspace == YCbCrColorspace)
          quantum_type=YCbCrPixel;
        if (image->colorspace == LabColorspace)
          quantum_type=LabPixel;
        if (image->colorspace == RGBColorspace)
          quantum_type=RGBPixel;
        if (image->colorspace == GRAYColorspace)
          quantum_type=GrayPixel;
        if (image->colorspace == OHTAColorspace)
          quantum_type=OHTAPixel;
        if (image->colorspace == XYZColorspace)
          quantum_type=XYZPixel;
        if (image->colorspace == YCCColorspace)
          quantum_type=YCCPixel;
        if (image->colorspace == YUVColorspace)
          quantum_type=YUVPixel;
        if (image->colorspace == CMYColorspace)
          quantum_type=CMYPixel;
        if (image->colorspace == HSLColorspace)
          quantum_type=HSLPixel;
        if (image->colorspace == HSVColorspace)
          quantum_type=HSPPixel;
        if (image->colorspace == Rec601YUVColorspace)
          quantum_type=Rec601YUVPixel;
        if (image->colorspace == Rec709YUVColorspace)
          quantum_type=Rec709YUVPixel;
        if (image->colorspace == LogColorspace)
          quantum_type=LogPixel;
        if (image->colorspace == RGBColorspace)
          quantum_type=RGBPixel;
        if (image->colorspace == HSBColorspace)
          quantum_type=HSBSPixel;
        if (image->colorspace == HSIColorspace)
          quantum_type=HSIPixel;
        if (image->colorspace == AdobeRGBColorspace)
          quantum_type=AdobeRGBPixel;
        if (image->colorspace == TransparentColorspace)
          quantum_type=AlphaPixel;
        if (image->colorspace == Rec2020YUVColorspace)
          quantum_type=Rec2020YUVPixel;
        if (image->colorspace == LogColorspace)
          quantum_type=LogPixel;
        if (image->colorspace == RGBColorspace)
          quantum_type=RGBPixel;
        if (image->colorspace == HSBColorspace)
          quantum_type=HSBSPixel;
        if (image->colorspace == HSIColorspace)
          quantum_type=HSIPixel;
        if (image->colorspace == AdobeRGBColorspace)
          quantum_type=AdobeRGBPixel;
        if (image->colorspace == TransparentColorspace)
          quantum_type=AlphaPixel;
        if (image->colorspace == Rec2020YUVColorspace)
          quantum_type=Rec2020YUVPixel;
        if (image->colorspace == YUVColorspace)
          quantum_type=YUVPixel;
        if (image->colorspace == CMYColorspace)
          quantum_type=CMYPixel;
        if (image->colorspace == HSLColorspace)
          quantum_type=HSLPixel;
        if (image->colorspace == HSVColorspace)
          quantum_type=HSPPixel;
        if (image->colorspace == Rec601YUVColorspace)
          quantum_type=Rec601YUVPixel;
        if (image->colorspace == Rec709YUVColorspace)
          quantum_type=Rec709YUVPixel;
        if (image->colorspace == LogColorspace)
          quantum_type=LogPixel;
        if (image->colorspace == RGBColorspace)
          quantum_type=RGBPixel;
        if (image->colorspace == HSBColorspace)
          quantum_type=HSBSPixel;
        if (image->colorspace == HSIColorspace)
          quantum_type=HSIPixel;
        if (image->colorspace == AdobeRGBColorspace)
          quantum_type=AdobeRGBPixel;
        if (image->colorspace == TransparentColorspace)
          quantum_type=AlphaPixel;
        if (image->colorspace == Rec2020YUVColorspace)
          quantum_type=Rec2020YUVPixel;
        if (image->colorspace == YUVColorspace)
          quantum_type=YUVPixel;
        if (image->colorspace == CMYColorspace)
          quantum_type=CMYPixel;
        if (image->colorspace == HSLColorspace)
          quantum_type=HSLPixel;
        if (image->colorspace == HSVColorspace)
          quantum_type=HSPPixel;
        if (image->colorspace == Rec601YUVColorspace)
          quantum_type=Rec601YUVPixel;
        if (image->colorspace == Rec709YUVColorspace)
          quantum_type=Rec709YUVPixel;
        if (image->colorspace == LogColorspace)
          quantum_type=LogPixel;
        if (image->colorspace == RGBColorspace)
          quantum_type=RGBPixel;
        if (image->colorspace == HSBColorspace)
          quantum_type=HSBSPixel;
        if (image->colorspace == HSIColorspace)
          quantum_type=HSIPixel;
        if (image->colorspace == AdobeRGBColorspace)
          quantum_type=AdobeRGBPixel;
        if (image->colorspace == TransparentColorspace)
          quantum_type=AlphaPixel;
        if (image->colorspace == Rec2020YUVColorspace)
          quantum_type=Rec2020YUVPixel;
        if (image->colorspace == YUVColorspace)
          quantum_type=YUVPixel;
        if (image->colorspace == CMYColorspace)
          quantum_type=CMYPixel;
        if (image->colorspace == HSLColorspace)
          quantum_type=HSLPixel;
        if (image->colorspace == HSVColorspace)
          quantum_type=HSPPixel;
        if (image->colorspace == Rec601YUVColorspace)
          quantum_type=Rec601YUVPixel;
        if (image->colorspace == Rec709YUVColorspace)
          quantum_type=Rec709YUVPixel;
        if (image->colorspace == LogColorspace)
          quantum_type=LogPixel;
        if (image->colorspace == RGBColorspace)
          quantum_type=RGBPixel;
        if (image->colorspace == HSBColorspace)
          quantum_type=HSBSPixel;
        if (image->colorspace == HSIColorspace)
          quantum_type=HSIPixel;
        if (image->colorspace == AdobeRGBColorspace)
          quantum_type=AdobeRGBPixel;
        if (image->colorspace == TransparentColorspace)
          quantum_type=AlphaPixel;
        if (image->colorspace == Rec2020YUVColorspace)
          quantum_type=Rec2020YUVPixel;
        if (image->colorspace == YUVColorspace)
          quantum_type=YUVPixel;
        if (image->colorspace == CMYColorspace)
          quantum_type=CMYPixel;
        if (image->colorspace == HSLColorspace)
          quantum_type=HSLPixel;
        if (image->colorspace == HSVColorspace)
          quantum_type=HSPPixel;
        if (image->colorspace == Rec601YUVColorspace)
          quantum_type=Rec601YUVPixel;
        if (image->colorspace == Rec709YUVColorspace)
          quantum_type=Rec709YUVPixel;
        if (image->colorspace == LogColorspace)
          quantum_type=LogPixel;
        if (image->colorspace == RGBColorspace)
          quantum_type=RGBPixel;
        if (image->colorspace == HSBColorspace)
          quantum_type=HSBSPixel;
        if (image->colorspace == HSIColorspace)
          quantum_type=HSIPixel;
        if (image->colorspace == AdobeRGBColorspace)
          quantum_type=AdobeRGBPixel;
        if (image->colorspace == TransparentColorspace)
          quantum_type=AlphaPixel;
        if (image->colorspace == Rec2020YUVColorspace)
          quantum_type=Rec2020YUVPixel;
        if (image->colorspace == YUVColorspace)
          quantum_type=YUVPixel;
        if (image->colorspace == CMYColorspace)
          quantum_type=CMYPixel;
        if (image->colorspace == HSLColorspace)
          quantum_type=HSLPixel;
        if (image->colorspace == HSVColorspace)
          quantum_type=HSPPixel;
        if (image->colorspace