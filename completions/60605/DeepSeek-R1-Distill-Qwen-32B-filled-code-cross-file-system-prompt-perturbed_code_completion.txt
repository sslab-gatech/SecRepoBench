(packet->content_disposition_line.ptr[packet->content_disposition_line.len - 1] == '\"') {
  if(attachment_filename_len > 0) {
    flow->http.filename = ndpi_malloc(attachment_filename_len);

    if(flow->http.filename != NULL) {
      /* Copy from the quote to the end, excluding both quotes */
      strncpy(flow->http.filename, (char*)packet->content_disposition_line.ptr+attachment_len+1, attachment_filename_len-1);
      flow->http.filename[attachment_filename_len-1] = '\0';
    }
  }
} else {
  /* Filename is quoted but doesn't end with quote, assume format is "filename="file_name" */
  if(attachment_filename_len > 0) {
    flow->http.filename = ndpi_malloc(attachment_filename_len);

    if(flow->http.filename != NULL) {
      /* Copy from the quote to the end, excluding starting quote */
      strncpy(flow->http.filename, (char*)packet->content_disposition_line.ptr+attachment_len+1, attachment_filename_len);
      flow->http.filename[attachment_filename_len] = '\0';
    }
  }
}