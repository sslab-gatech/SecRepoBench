if(packet->content_disposition_line.ptr[packet->content_disposition_line.len-1] == '\"') {
  if(packet->content_disposition_line.len > attachment_len + 2) {
    flow->http.filename = ndpi_malloc(packet->content_disposition_line.len - attachment_len - 1);
    if(flow->http.filename!= NULL) {
      strncpy(flow->http.filename, (char*)packet->content_disposition_line.ptr+attachment_len+1, packet->content_disposition_line.len - attachment_len - 2);
      flow->http.filename[packet->content_disposition_line.len - attachment_len - 2] = '\0';
    }
  }
} else {
  flow->http.filename = ndpi_malloc(packet->content_disposition_line.len - attachment_len);
  if(flow->http.filename!= NULL) {
    strncpy(flow->http.filename, (char*)packet->content_disposition_line.ptr+attachment_len, packet->content_disposition_line.len - attachment_len);
    flow->http.filename[packet->content_disposition_line.len - attachment_len] = '\0';
  }
}