if(flow->http.filename!= NULL) {
  if(flow->http.filename[0] == '\"') {
    /* Check if the filename in the content disposition line is enclosed in quotes.
       If the last character is not a quote, assume the format is 'filename="file_name'.
       Allocate memory and copy the filename from the packet to the flow structure, excluding the starting quote.
       If the last character is a quote and the filename length is sufficient, assume the format is 'filename="file_name"'.
       Allocate memory and copy the filename from the packet to the flow structure, excluding both starting and ending quotes.
       */
    flow->http.filename = ndpi_malloc(strlen(flow->http.filename) + 1);
    if(flow->http.filename!= NULL) {
      strncpy(flow->http.filename, flow->http.filename + 1, strlen(flow->http.filename) - 2);
      flow->http.filename[strlen(flow->http.filename) - 2] = '\0';
    }
  } else {
    /*case: filename=file_name
       Allocate memory and copy the filename from the packet to the flow structure, excluding the starting filename.
       */
    flow->http.filename = ndpi_malloc(strlen(flow->http.filename) + 1);
    if(flow->http.filename!= NULL) {
      strncpy(flow->http.filename, flow->http.filename, strlen(flow->http.filename));
      flow->http.filename[strlen(flow->http.filename)] = '\0';
    }
  }
}