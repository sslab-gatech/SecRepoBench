if(packet->content_disposition_line.ptr[packet->payload_packet_len - 1] != '\"') {
  /* Format: filename="file_name */
  attachment_filename_len++; /* Include the ending quote in length */
  flow->http.filename = ndpi_malloc(attachment_filename_len);

  if(flow->http.filename != NULL) {
    memcpy(flow->http.filename, &packet->content_disposition_line.ptr[attachment_len + 1], attachment_filename_len - 1);
    flow->http.filename[attachment_filename_len - 1] = '\0';
  }
} else {
  /* Format: filename="file_name" */
  attachment_filename_len -= 2; /* Exclude starting and ending quotes */
  flow->http.filename = ndpi_malloc(attachment_filename_len + 1);

  if(flow->http.filename != NULL) {
    memcpy(flow->http.filename, &packet->content_disposition_line.ptr[attachment_len + 1], attachment_filename_len);
    flow->http.filename[attachment_filename_len] = '\0';
  }
}