if(packet->content_disposition_line.ptr[attachment_len] == '\"') {
  if(packet->content_disposition_line.ptr[attachment_len + attachment_filename_len - 1] != '\"') {
    // case: filename="file_name
    if(attachment_filename_len > 1) {
      flow->http.filename = ndpi_malloc(attachment_filename_len - 1);

      if(flow->http.filename != NULL) {
        strncpy(flow->http.filename, (char*)packet->content_disposition_line.ptr + attachment_len + 1, attachment_filename_len - 2);
        flow->http.filename[attachment_filename_len - 2] = '\0';
      }
    }
  } else {
    // case: filename="file_name"
    if(attachment_filename_len > 2) {
      flow->http.filename = ndpi_malloc(attachment_filename_len - 2);

      if(flow->http.filename != NULL) {
        strncpy(flow->http.filename, (char*)packet->content_disposition_line.ptr + attachment_len + 1, attachment_filename_len - 2);
        flow->http.filename[attachment_filename_len - 2] = '\0';
      }
    }
  }
} else {
  // case: filename=file_name
  flow->http.filename = ndpi_malloc(attachment_filename_len);

  if(flow->http.filename != NULL) {
    strncpy(flow->http.filename, (char*)packet->content_disposition_line.ptr + attachment_len, attachment_filename_len);
    flow->http.filename[attachment_filename_len] = '\0';
  }
}