(attachment_filename_len > 1 && packet->content_disposition_line.ptr[packet->content_disposition_line.len-1] == '\"') {
    // Case: filename="file_name"
    flow->http.filename = ndpi_malloc(attachment_filename_len);

    if(flow->http.filename != NULL) {
        strncpy(flow->http.filename, (char*)packet->content_disposition_line.ptr+attachment_len+1, attachment_filename_len-2);
        flow->http.filename[attachment_filename_len-2] = '\0';
    }
} else {
    // Case: filename="file_name (missing closing quote)
    flow->http.filename = ndpi_malloc(attachment_filename_len);

    if(flow->http.filename != NULL) {
        strncpy(flow->http.filename, (char*)packet->content_disposition_line.ptr+attachment_len+1, attachment_filename_len-1);
        flow->http.filename[attachment_filename_len-1] = '\0';
    }
}