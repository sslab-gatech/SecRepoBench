if(packet->content_disposition_line.ptr[attachment_len] == '\"') {
  if(packet->content_disposition_line.ptr[attachment_filename_len + attachment_len - 1] != '\"') {
    // The filename in the content disposition line is enclosed in quotes, but the last character is not a quote.
    // Assume the format is 'filename="file_name'.
    flow->http.filename = ndpi_malloc(attachment_filename_len);
    if(flow->http.filename != NULL) {
      strncpy(flow->http.filename, (char*)packet->content_disposition_line.ptr+attachment_len+1, attachment_filename_len-1);
      flow->http.filename[attachment_filename_len-1] = '\0';
    }
  } else {
    // The filename in the content disposition line is enclosed in quotes, and the last character is a quote.
    // Assume the format is 'filename="file_name"'.
    flow->http.filename = ndpi_malloc(attachment_filename_len-1);
    if(flow->http.filename != NULL) {
      strncpy(flow->http.filename, (char*)packet->content_disposition_line.ptr+attachment_len+1, attachment_filename_len-2);
      flow->http.filename[attachment_filename_len-2] = '\0';
    }
  }
}