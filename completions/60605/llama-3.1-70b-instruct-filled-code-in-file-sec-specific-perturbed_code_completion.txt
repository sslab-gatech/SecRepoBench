if(packet->content_disposition_line.ptr[attachment_len] == '\"') {
  if(packet->content_disposition_line.ptr[packet->content_disposition_line.len-1]!= '\"') {
    /* Assume the format is 'filename="file_name' */
    u_int8_t attachment_filename_len = packet->content_disposition_line.len - attachment_len - 1;
    flow->http.filename = ndpi_malloc(attachment_filename_len+1);
    if(flow->http.filename!= NULL) {
      strncpy(flow->http.filename, (char*)packet->content_disposition_line.ptr+attachment_len+1, attachment_filename_len);
      flow->http.filename[attachment_filename_len] = '\0';
    }
  } else {
    /* Assume the format is 'filename="file_name"' */
    u_int8_t attachment_filename_len = packet->content_disposition_line.len - attachment_len - 2;
    flow->http.filename = ndpi_malloc(attachment_filename_len+1);
    if(flow->http.filename!= NULL) {
      strncpy(flow->http.filename, (char*)packet->content_disposition_line.ptr+attachment_len+1, attachment_filename_len);
      flow->http.filename[attachment_filename_len] = '\0';
    }
  }
}