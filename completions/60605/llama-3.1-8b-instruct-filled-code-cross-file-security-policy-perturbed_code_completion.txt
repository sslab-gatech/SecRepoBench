if(packet->content_disposition_line.ptr[attachment_len] == '\"') {
  if
  // Check if the filename in the content disposition line is enclosed in quotes.
  // If the last character is not a quote, assume the format is 'filename="file_name'.
  // Allocate memory and copy the filename from the packet to the flow structure, excluding the starting quote.
  // If the last character is a quote and the filename length is sufficient, assume the format is 'filename="file_name"'.
  // Allocate memory and copy the filename from the packet to the flow structure, excluding both starting and ending quotes.
  {
    u_int attachment_filename_len = 0;
    char *filename = NULL;

    if(packet->content_disposition_line.ptr[attachment_len]!= '\"') {
      //case: filename=file_name
      attachment_filename_len = strlen((char*)packet->content_disposition_line.ptr+attachment_len);
      filename = ndpi_malloc(attachment_filename_len+1);

      if(filename!= NULL) {
        strncpy(filename, (char*)packet->content_disposition_line.ptr+attachment_len, attachment_filename_len);
        filename[attachment_filename_len] = '\0';
      }
    } else {
      //case: filename="file_name"
      attachment_filename_len = 0;
      for(i = attachment_len + 1; i < packet->content_disposition_line.len; i++) {
        if(packet->content_disposition_line.ptr[i] == '\"') {
          attachment_filename_len = i - attachment_len - 1;
          break;
        }
      }

      if(attachment_filename_len > 0) {
        filename = ndpi_malloc(attachment_filename_len+1);

        if(filename!= NULL) {
          strncpy(filename, (char*)packet->content_disposition_line.ptr+attachment_len+1, attachment_filename_len);
          filename[attachment_filename_len] = '\0';
        }
      }
    }

    if(filename!= NULL) {
      flow->http.filename = filename;
    }
  } else {
    //case: filename=file_name
    flow->http.filename = ndpi_malloc(attachment_filename_len+1);

    if(flow->http.filename!= NULL) {
      strncpy(flow->http.filename, (char*)packet->content_disposition_line.ptr+attachment_len, attachment_filename_len);
      flow->http.filename[attachment_filename_len] = '\0';
    }
  }
}