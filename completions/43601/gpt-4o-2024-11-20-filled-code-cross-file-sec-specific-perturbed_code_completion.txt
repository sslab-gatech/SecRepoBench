// Search for the specified tag in the profile directory.
    n = _cmsSearchTag(Icc, tagSignature, TRUE);

    // Validate the result of the search
    if (n < 0 || n >= (int)Icc->TagCount) {
        cmsSignalError(Icc->ContextID, cmsERROR_UNKNOWN_EXTENSION, "Tag not found or invalid index");
        _cmsUnlockMutex(Icc->ContextID, Icc->UsrMutex);
        return NULL;
    }