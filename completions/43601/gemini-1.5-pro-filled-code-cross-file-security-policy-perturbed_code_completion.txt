n = _cmsSearchTag(Icc, tagSignature, TRUE);
    if (n < 0) {
        _cmsUnlockMutex(Icc->ContextID, Icc->UsrMutex);
        return NULL;
    }

    // Check if the tag index is within the bounds of the arrays
    if (n < 0 || n >= MAX_TABLE_TAG) {
        _cmsUnlockMutex(Icc->ContextID, Icc->UsrMutex);
        return NULL;
    }