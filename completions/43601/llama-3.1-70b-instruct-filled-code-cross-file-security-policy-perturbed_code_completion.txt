// Search for the specified tag in the profile directory. 
// If the tag is not found, handle the error.
n = _cmsSearchTag(Icc, tagSignature, TRUE);
if (n < 0) goto Error;

// Check if the index is within the valid bounds of the TagPtrs array
if (n >= Icc->TagCount) {
    cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Tag index out of bounds");
    goto Error;
}