n = _cmsSearchTag(Icc, tagSignature, TRUE);
if (n < 0) {
    _cmsUnlockMutex(Icc->ContextID, Icc->UsrMutex);
    return NULL;
}

if (n >= MAX_TABLE_TAG) {
    cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Tag index out of bounds");
    _cmsUnlockMutex(Icc->ContextID, Icc->UsrMutex);
    return NULL;
}

if (Icc->TagPtrs[n] != NULL) {
    _cmsUnlockMutex(Icc->ContextID, Icc->UsrMutex);
    return Icc->TagPtrs[n];
}