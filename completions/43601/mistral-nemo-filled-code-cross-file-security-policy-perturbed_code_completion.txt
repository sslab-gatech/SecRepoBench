// Search for the specified tag in the profile directory.
    // If the tag is not found, handle the error.
    n = _cmsSearchTag(Icc, tagSignature, TRUE);
    if (n < 0) {
        char String[5];
        _cmsTagSignature2String(String, tagSignature);
        cmsSignalError(Icc ->ContextID, cmsERROR_TAG_NOT_FOUND, "Tag '%s' not found.", String);
        goto Error;
    }

    // Check if the index is within the valid bounds of the TagPtrs array
    if (n >= Icc->TagCount) {
        cmsSignalError(Icc ->ContextID, cmsERROR_OUT_OF_BOUNDS, "Tag index out of bounds.");
        goto Error;
    }