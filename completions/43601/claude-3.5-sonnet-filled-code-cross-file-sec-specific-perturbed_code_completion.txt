n = _cmsSearchTag(Icc, tagSignature, TRUE);
if (n < 0 || n >= (int)Icc->TagCount) {
    cmsSignalError(Icc->ContextID, cmsERROR_UNKNOWN_EXTENSION, "Tag not found");
    goto Error;
}

if (Icc->TagPtrs[n] != NULL) {
    // The tag is already read, return the cached data
    _cmsUnlockMutex(Icc->ContextID, Icc->UsrMutex);
    return Icc->TagPtrs[n];
}