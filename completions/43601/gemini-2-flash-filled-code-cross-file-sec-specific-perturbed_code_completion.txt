n = _cmsSearchTag(Icc, tagSignature, TRUE);
    if (n < 0) {
        char String[5];
        _cmsTagSignature2String(String, tagSignature);
        cmsSignalError(Icc ->ContextID, cmsERROR_NOT_FOUND, "Tag '%s' not found", String);
        _cmsUnlockMutex(Icc->ContextID, Icc ->UsrMutex);
        return NULL;
    }

    if (n >= MAX_TABLE_TAG) {
        cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Tag index out of range: %d (max is %d)", n, MAX_TABLE_TAG - 1);
        _cmsUnlockMutex(Icc->ContextID, Icc->UsrMutex);
        return NULL;
    }