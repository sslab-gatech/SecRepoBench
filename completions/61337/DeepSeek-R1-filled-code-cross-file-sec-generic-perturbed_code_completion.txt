handler = xmlFindCharEncodingHandler((const char*)encoding_guess);
        if (handler != NULL) {
            if (xmlStrcasecmp(handler->name, BAD_CAST "UTF-8") != 0) {
                xmlSwitchEncoding(ctxt, handler->name);
            }
            xmlFree(encoding_guess);
        } else {
            htmlParseErr(ctxt, XML_ERR_UNSUPPORTED_ENCODING,
                        "Unsupported encoding %s\n", encoding_guess, NULL);
            xmlFree(encoding_guess);
            xmlSwitchEncoding(ctxt, XML_CHAR_ENCODING_8859_1);
        }