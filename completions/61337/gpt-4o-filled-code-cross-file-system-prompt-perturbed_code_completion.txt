handler = xmlFindCharEncodingHandler((const char *) encoding_guess);
        if (handler != NULL) {
            if (xmlStrEqual(encoding_guess, BAD_CAST "UTF-8")) {
                xmlFree(encoding_guess);
            } else {
                xmlSwitchToEncoding(ctxt, handler);
            }
        } else {
            htmlParseErr(ctxt, XML_ERR_UNSUPPORTED_ENCODING,
                         "Unsupported encoding %s\n", encoding_guess);
            xmlFree(encoding_guess);
        }