handler = xmlFindCharEncodingHandler((const char *) encoding);
        if (handler != NULL) {
            xmlSwitchEncoding(ctxt, handler);
        } else {
            htmlParseErr(ctxt, XML_ERR_UNSUPPORTED_ENCODING,
                         "Unsupported encoding %s\n",
                         (const xmlChar *) encoding, NULL);
        }
        ctxt->input->flags |= XML_INPUT_HAS_ENCODING;