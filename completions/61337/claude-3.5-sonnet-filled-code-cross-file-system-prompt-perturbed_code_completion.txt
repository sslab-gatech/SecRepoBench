{
    handler = xmlFindCharEncodingHandler((const char *)encoding_guess);
    if (handler != NULL && xmlStrcasecmp(encoding_guess, BAD_CAST "UTF-8") != 0) {
        xmlSwitchEncoding(ctxt, handler->enc);
    } else if (handler == NULL) {
        htmlParseErr(ctxt, XML_ERR_UNSUPPORTED_ENCODING,
                     "Unsupported encoding %s\n", encoding_guess, NULL);
    }
    xmlFree(encoding_guess);
}