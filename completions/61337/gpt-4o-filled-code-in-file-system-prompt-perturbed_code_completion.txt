{
            handler = xmlFindCharEncodingHandler((const char *) encoding_guess);
            if (handler != NULL) {
                if (xmlSwitchToEncoding(ctxt, handler) < 0) {
                    htmlParseErr(ctxt, XML_ERR_UNSUPPORTED_ENCODING,
                                 "Unsupported encoding %s\n", encoding_guess, NULL);
                }
            } else {
                htmlParseErr(ctxt, XML_ERR_UNSUPPORTED_ENCODING,
                             "Unsupported encoding %s\n", encoding_guess, NULL);
            }
            xmlFree(encoding_guess);
        }