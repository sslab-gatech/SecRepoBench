{
            handler = xmlFindCharEncodingHandler(
                (const char *) encoding_guess);
            if ((handler != NULL) && (handler->encoding != XML_CHAR_ENCODING_UTF8)) {
                xmlSwitchEncoding(ctxt, handler->encoding);
            } else if (handler == NULL) {
                htmlParseErr(ctxt, XML_ERR_UNSUPPORTED_ENCODING,
                             "Unsupported encoding %s\n", encoding_guess, NULL);
            }
            xmlFree(encoding_guess);
        }