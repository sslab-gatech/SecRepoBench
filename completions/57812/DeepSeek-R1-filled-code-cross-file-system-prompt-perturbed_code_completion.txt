if (pictureparameterset->num_ref_loc_offsets > 0) {
        pictureparameterset->ref_loc_offsets = av_malloc_array(pictureparameterset->num_ref_loc_offsets,
                                                              sizeof(*pictureparameterset->ref_loc_offsets));
        if (!pictureparameterset->ref_loc_offsets)
            return AVERROR(ENOMEM);

        for (int i = 0; i < pictureparameterset->num_ref_loc_offsets; i++) {
            HEVCRefLocationOffset *rlo = &pictureparameterset->ref_loc_offsets[i];
            rlo->layer_id = get_bits(gb, 6);
            rlo->scaled_ref_layer_offset_present_flag = get_bits1(gb);
            rlo->ref_region_offset_present_flag = get_bits1(gb);
            rlo->resample_phase_present_flag = get_bits1(gb);

            if (rlo->scaled_ref_layer_offset_present_flag) {
                rlo->scaled_ref_layer_offset_h = get_se_golomb_long(gb);
                rlo->scaled_ref_layer_offset_v = get_se_golomb_long(gb);
            }

            if (rlo->ref_region_offset_present_flag) {
                rlo->ref_region_left_offset   = get_se_golomb_long(gb);
                rlo->ref_region_right_offset  = get_se_golomb_long(gb);
                rlo->ref_region_top_offset    = get_se_golomb_long(gb);
                rlo->ref_region_bottom_offset = get_se_golomb_long(gb);
            }

            if (rlo->resample_phase_present_flag) {
                rlo->phase_h = get_bits(gb, 8);
                rlo->phase_v = get_bits(gb, 8);
                if (sps->chroma_format_idc != 0) {
                    rlo->phase_h_chroma = get_bits(gb, 8);
                    rlo->phase_v_chroma = get_bits(gb, 8);
                }

                if (rlo->phase_h > 7 || rlo->phase_v > 7 ||
                    (sps->chroma_format_idc != 0 && (rlo->phase_h_chroma > 7 || rlo->phase_v_chroma > 7))) {
                    av_log(avctx, AV_LOG_ERROR, "Resample phase values must be in [0,7]\n");
                    return AVERROR_INVALIDDATA;
                }
            }
        }
    }