pictureparameterset->ref_loc_offset_list = av_malloc_array(pictureparameterset->num_ref_loc_offsets, sizeof(*pictureparameterset->ref_loc_offset_list));
    if (!pictureparameterset->ref_loc_offset_list)
        return AVERROR(ENOMEM);

    for (int i = 0; i < pictureparameterset->num_ref_loc_offsets; i++) {
        pictureparameterset->ref_loc_offset_list[i].layer_id = get_bits(gb, 6);
        pictureparameterset->ref_loc_offset_list[i].offset = get_se_golomb_long(gb);

        // Validate the layer_id to ensure it is within a valid range
        if (pictureparameterset->ref_loc_offset_list[i].layer_id >= MAX_LAYER_ID) {
            av_log(avctx, AV_LOG_ERROR, "Invalid layer_id: %d\n", pictureparameterset->ref_loc_offset_list[i].layer_id);
            return AVERROR_INVALIDDATA;
        }
    }