for (x=0; x < (ssize_t) number_pixels; x++)
{
  p=PushQuantumPixel(quantum_info,p,&pixel);
  SetPixelGray(img,ScaleAnyToQuantum(pixel,range),q);
  p+=quantum_info->pad;
  q+=GetPixelChannels(img);
}