if (utf8) {
    std::vector<w_char> utf16_ckey;
    u8_u16(utf16_ckey, ckey);
    ckeyl = utf16_ckey.size();

    std::vector<w_char> utf16_ctry;
    u8_u16(utf16_ctry, try_chars);
    ctryl = utf16_ctry.size();

    ctry = try_chars;
} else {
    ckeyl = ckey.size();
    ctry = try_chars;
    ctryl = ctry.size();
}