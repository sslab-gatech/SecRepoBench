if (utf8) {
    std::vector<w_char> ckey_utf16;
    std::vector<w_char> ctry_utf16;
    u8_u16(ckey_utf16, ckey);
    u8_u16(ctry_utf16, try_chars);
    ckeyl = static_cast<int>(ckey_utf16.size());
    ctryl = static_cast<int>(ctry_utf16.size());
    ctry = try_chars; // Keep the original string for further use if needed
} else {
    ckeyl = static_cast<int>(ckey.length());
    ctryl = static_cast<int>(try_chars.length());
    ctry = try_chars;
}