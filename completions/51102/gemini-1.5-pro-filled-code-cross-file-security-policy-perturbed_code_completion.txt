if (utf8) {
    std::vector<w_char> ckey_utf16;
    int ret = u8_u16(ckey_utf16, ckey);
    if (ret < 0) {
      // Handle the error, e.g., log it or throw an exception.
      // For simplicity, we return in this example.
      return; 
    }
    ckeyl = ckey_utf16.size();

    std::vector<w_char> ctry_utf16;
    ret = u8_u16(ctry_utf16, try_chars);
    if (ret < 0) {
      return;
    }

    ctryl = ctry_utf16.size();
    ctry = try_chars;


  } else {
    ckeyl = ckey.size();
    ctryl = try_chars.size();
    ctry = try_chars;
  }