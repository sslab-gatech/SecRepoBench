if (utf8) {
    int ret = u8_u16(sunicw, ckey);
    if (ret < 0 || ret > MAXWORDUTF16LEN) {
      return; // Handle error appropriately
    }
    ckeyl = ret;

    ret = u8_u16(sunicw, try_chars);
    if (ret < 0 || ret > MAXWORDUTF16LEN) {
      return; // Handle error appropriately
    }
    ctryl = ret;
    ctry = try_chars;
  } else {
    csconv = get_current_cs(pAMgr->get_encoding());
    ckeyl = ckey.length();
    ctryl = try_chars.length();
    ctry = try_chars;
  }