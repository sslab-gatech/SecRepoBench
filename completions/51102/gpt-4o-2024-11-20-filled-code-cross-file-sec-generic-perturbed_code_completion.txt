if (utf8) {
    // Convert ckey to UTF-16 and assign its length to ckeyl
    u8_u16(ckey_utf16, ckey);
    ckeyl = ckey_utf16.size();

    // Convert try_chars to UTF-16, assign its length to ctryl, and store it in ctry
    u8_u16(ctry_utf16, try_chars);
    ctryl = ctry_utf16.size();
    ctry = try_chars;
  } else {
    // In non-UTF-8 mode, directly assign ckey and try_chars
    ckeyl = ckey.size();
    ctryl = try_chars.size();
    ctry = try_chars;
  }