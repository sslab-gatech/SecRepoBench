if (utf8) {
    std::vector<w_char> ckey_utf16, ctry_utf16;
    u8_u16(ckey_utf16, ckey);
    u8_u16(ctry_utf16, try_chars);
    ckeyl = ckey_utf16.size();
    ctryl = ctry_utf16.size();
    ctry = try_chars;
} else {
    ckeyl = ckey.length();
    ctryl = try_chars.length();
    ctry = try_chars;
}