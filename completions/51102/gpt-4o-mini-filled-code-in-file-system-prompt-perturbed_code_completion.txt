if (utf8) {
    ckeyl = u8_u16(ckey_utf, ckey.c_str());
    ctryl = u8_u16(ctry_utf, try_chars.c_str());
  } else {
    ckeyl = ckey.length();
    ctryl = try_chars.length();
    std::copy(ckey.begin(), ckey.end(), ckey_utf);
    std::copy(try_chars.begin(), try_chars.end(), ctry_utf);
  }