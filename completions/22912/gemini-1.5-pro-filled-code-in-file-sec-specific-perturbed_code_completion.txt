(packet->l4.protocol == IPPROTO_UDP && (packet->l4.udp.dst_port == 4070 || packet->l4.udp.src_port == 4070)) {
    if (payload_len >= 4 && memcmp(packet->payload, "SPID", 4) == 0) {
      NDPI_LOG_INFO(ndpi_struct, "found spotify\n");
      ndpi_int_spotify_add_connection(ndpi_struct, stream, 0);
      return;
    }
  } else if (packet->l4.protocol == IPPROTO_TCP) {
    if (payload_len >= 2 && memcmp(packet->payload, "\x00\x04", 2) == 0) {
      NDPI_LOG_INFO(ndpi_struct, "found spotify\n");
      ndpi_int_spotify_add_connection(ndpi_struct, stream, 0);
      return;
    }
  } else if (packet->l4.protocol == IPPROTO_IP) {
    if ((ntohl(packet->l3.ip.src) >= 0xAC440000 && ntohl(packet->l3.ip.src) <= 0xAC44FFFF) ||
        (ntohl(packet->l3.ip.dst) >= 0xAC440000 && ntohl(packet->l3.ip.dst) <= 0xAC44FFFF)) {
      NDPI_LOG_INFO(ndpi_struct, "found spotify\n");
      ndpi_int_spotify_add_connection(ndpi_struct, stream, 0);
      return;
    }
  }