if (packet->payload_packet_len >= 7) {
    if (packet->protocol == IPPROTO_UDP && packet->udp_dst == htons(4070)) {
      if (memcmp(packet->payload, "Spotify", 7) == 0) {
        NDPI_LOG_DBG(ndpi_struct, "Spotify detected via UDP\n");
        ndpi_set_detection_bitmask(ndpi_struct, stream, NDPI_PROTOCOL_SPOTIFY);
        return;
      }
    } else if (packet->protocol == IPPROTO_TCP) {
      // Add TCP analysis for Spotify here
    } else if (packet->protocol == IPPROTO_IP) {
      // Add IP address range check for Spotify here
    }
  }