(packet->udp != NULL) && (ntohs(packet->udp->source) == 4070 || ntohs(packet->udp->dest) == 4070)) {
    if (payload_len >= 4 && memcmp(packet_payload, "SPFY", 4) == 0) {
      NDPI_LOG_INFO(ndpi_struct, "found spotify\n");
      ndpi_int_spotify_add_connection(ndpi_struct, stream, 0);
      return;
    }
  } else if (packet->tcp != NULL) {
    if (payload_len >= 4 && memcmp(packet_payload, "SPFY", 4) == 0) {
      NDPI_LOG_INFO(ndpi_struct, "found spotify\n");
      ndpi_int_spotify_add_connection(ndpi_struct, stream, 0);
      return;
    } else {
      if (ndpi_struct->host_server_name != NULL
          && (strstr(ndpi_struct->host_server_name, "spotify.com") != NULL
              || strstr(ndpi_struct->host_server_name, "pscdn.co") != NULL
              || strstr(ndpi_struct->host_server_name, "scdn.co") != NULL)) {
        NDPI_LOG_INFO(ndpi_struct, "found spotify\n");
        ndpi_int_spotify_add_connection(ndpi_struct, stream, 0);
        return;
      }
    }
  }