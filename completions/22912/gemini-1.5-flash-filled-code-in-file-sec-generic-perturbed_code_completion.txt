(payload_len > 0 && packet->transport_protocol == NDPI_PROTOCOL_UDP && packet->dst_port == 4070) {
    // Check for Spotify UDP identifier
    // ... (Implementation to check for Spotify identifier in UDP payload) ...
    if (/* Spotify identifier found */) {
      NDPI_LOG_DBG(ndpi_struct, "Spotify detected (UDP)\n");
      ndpi_int_spotify_add_connection(ndpi_struct, stream, 0);
      return;
    }
  } else if (payload_len > 0 && packet->transport_protocol == NDPI_PROTOCOL_TCP) {
    // Check for Spotify TCP byte patterns
    // ... (Implementation to check for Spotify byte patterns in TCP payload) ...
    if (/* Spotify byte patterns found */) {
      NDPI_LOG_DBG(ndpi_struct, "Spotify detected (TCP)\n");
      ndpi_int_spotify_add_connection(ndpi_struct, stream, 0);
      return;
    }
  } else {
    // Check for Spotify IP ranges
    // ... (Implementation to check for Spotify IP ranges) ...
    if (/* Spotify IP range found */) {
      NDPI_LOG_DBG(ndpi_struct, "Spotify detected (IP range)\n");
      ndpi_int_spotify_add_connection(ndpi_struct, stream, 0);
      return;
    }
  }