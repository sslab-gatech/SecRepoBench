if((packet->udp != NULL && (ntohs(packet->udp->dest) == 4070 || ntohs(packet->udp->source) == 4070) &&
    (payload_len > 7 && !memcmp(packet->payload, "SPOTIFY", 7))) ||
   (packet->tcp != NULL && payload_len > 7 && !memcmp(packet->payload, "SPOTIFY", 7)) ||
   (((ntohl(packet->iph->saddr) & 0xFFFFF800) == 0x4E1F0800) ||
    ((ntohl(packet->iph->daddr) & 0xFFFFF800) == 0x4E1F0800))) {
  NDPI_LOG_INFO(ndpi_struct, "Spotify detected\n");
  stream->detected_protocol_stack[0] = NDPI_PROTOCOL_SPOTIFY;
  return;
}