(packet->udp != 0 && ((packet->udp->source == htons(57621) || packet->udp->dest == htons(57621)) ||
                      (packet->udp->source == htons(4070) || packet->udp->dest == htons(4070)))) {
    if (payload_len >= 4 && memcmp(packet->payload, "\x00\x01\x00\x00", 4) == 0) {
      NDPI_LOG_INFO(ndpi_struct, "Found Spotify UDP\n");
      ndpi_int_spotify_add_connection(ndpi_struct, stream, 0);
      return;
    }
  } else if (packet->tcp != 0) {
    if (payload_len >= 4 && memcmp(packet->payload, "\x00\x04\x00\x00", 4) == 0) {
      NDPI_LOG_INFO(ndpi_struct, "Found Spotify TCP\n");
      ndpi_int_spotify_add_connection(ndpi_struct, stream, 0);
      return;
    }
  }

  if (packet->iph) {
    u_int32_t src_ip = ntohl(packet->iph->saddr);
    u_int32_t dst_ip = ntohl(packet->iph->daddr);

    if ((src_ip >= 0x4E000000 && src_ip <= 0x4E7FFFFF) ||
        (dst_ip >= 0x4E000000 && dst_ip <= 0x4E7FFFFF)) {
      NDPI_LOG_INFO(ndpi_struct, "Found Spotify IP range\n");
      ndpi_int_spotify_add_connection(ndpi_struct, stream, 0);
      return;
    }
  }