(packet->udp != 0) && (payload_len > 4) &&
  ((ntohs(packet->udp->source) == 57621) || (ntohs(packet->udp->dest) == 57621)) {
    if (packet->payload[0] == 0x00 && packet->payload[1] == 0x04 &&
        packet->payload[2] == 0x00 && packet->payload[3] == 0x00) {
      NDPI_LOG_INFO(ndpi_struct, "Found Spotify\n");
      ndpi_int_spotify_add_connection(ndpi_struct, stream, 0);
      return;
    }
  } else if (packet->tcp != 0) {
    if (payload_len > 7 &&
        packet->payload[0] == 0x00 && packet->payload[1] == 0x04 &&
        packet->payload[2] == 0x00 && packet->payload[3] == 0x00 &&
        packet->payload[4] == 0x01 && packet->payload[5] == 0x00 &&
        packet->payload[6] == 0x00 && packet->payload[7] == 0x00) {
      NDPI_LOG_INFO(ndpi_struct, "Found Spotify\n");
      ndpi_int_spotify_add_connection(ndpi_struct, stream, 0);
      return;
    }
  } else if (packet->iph) {
    u_int32_t src = ntohl(packet->iph->saddr);
    u_int32_t dst = ntohl(packet->iph->daddr);
    if ((src >= 0x4E000000 && src <= 0x4E7FFFFF) ||
        (dst >= 0x4E000000 && dst <= 0x4E7FFFFF)) {
      NDPI_LOG_INFO(ndpi_struct, "Found Spotify\n");
      ndpi_int_spotify_add_connection(ndpi_struct, stream, 0);
      return;
    }
  }