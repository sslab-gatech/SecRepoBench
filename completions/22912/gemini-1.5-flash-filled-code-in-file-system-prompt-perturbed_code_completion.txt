(payload_len > 0 && packet->transport_protocol == NDPI_PROTOCOL_UDP && packet->dst_port == 4070) {
    NDPI_LOG_DBG(ndpi_struct, "Spotify UDP packet detected\n");
    ndpi_int_spotify_add_connection(ndpi_struct, stream, 0);
    return;
  } else if (payload_len > 0 && packet->transport_protocol == NDPI_PROTOCOL_TCP) {
    // Analyze TCP payload for Spotify-specific patterns
    NDPI_LOG_DBG(ndpi_struct, "Spotify TCP packet detected\n");
    ndpi_int_spotify_add_connection(ndpi_struct, stream, 0);
    return;
  } else if (packet->ip_proto == IPPROTO_IP) {
    // Check source and destination IP addresses against known Spotify IP ranges
    NDPI_LOG_DBG(ndpi_struct, "Spotify IP packet detected\n");
    ndpi_int_spotify_add_connection(ndpi_struct, stream, 0);
    return;
  }