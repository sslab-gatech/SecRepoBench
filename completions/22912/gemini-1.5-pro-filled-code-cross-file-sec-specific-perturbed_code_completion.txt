(packet->l4.protocol == IPPROTO_UDP) {
    if (packet->l4.udp.dst_port == 4070 || packet->l4.udp.src_port == 4070) {
      if (payload_len >= 4 && memcmp(packet->payload, "Spot", 4) == 0) {
        NDPI_LOG(ndpi_struct, "found Spotify over UDP\n");
        NDPI_ADD_PROTOCOL_TO_BITMASK(ndpi_struct, stream, NDPI_PROTOCOL_SPOTIFY);
        return;
      }
    }
  } else if (packet->l4.protocol == IPPROTO_TCP) {
    if (payload_len > 8 && memcmp(packet->payload, "GET /", 5) == 0) {
      NDPI_LOG(ndpi_struct, "found Spotify over TCP\n");
      NDPI_ADD_PROTOCOL_TO_BITMASK(ndpi_struct, stream, NDPI_PROTOCOL_SPOTIFY);
      return;
    }
  } else if (packet->l4.protocol == IPPROTO_IP) {
    if ((ntohl(packet->l3.ip.src) & 0xffffff00) == 0xAC440A00 /* 172.68.10.0/24 */ ||
        (ntohl(packet->l3.ip.dst) & 0xffffff00) == 0xAC440A00) {
      NDPI_LOG(ndpi_struct, "found Spotify over IP\n");
      NDPI_ADD_PROTOCOL_TO_BITMASK(ndpi_struct, stream, NDPI_PROTOCOL_SPOTIFY);
      return;
    }
  }