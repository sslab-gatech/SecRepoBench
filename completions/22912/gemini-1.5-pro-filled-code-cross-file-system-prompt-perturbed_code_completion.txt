((packet->l4.protocol == IPPROTO_UDP) && ((packet->l4.udp.dst_port == htons(SPOTIFY_PORT_1)) || (packet->l4.udp.dst_port == htons(SPOTIFY_PORT_2)))) {
    if (payload_len >= SPOTIFY_PAYLOAD_ID_LEN && memcmp(packet->payload, SPOTIFY_PAYLOAD_ID, SPOTIFY_PAYLOAD_ID_LEN) == 0) {
      NDPI_LOG_INFO(ndpi_struct, "found Spotify (UDP)\n");
      NDPI_ADD_PROTOCOL_TO_BITMASK(ndpi_struct, stream, NDPI_PROTOCOL_SPOTIFY);
      return;
    }
  } else if (packet->l4.protocol == IPPROTO_TCP) {
    if (payload_len >= SPOTIFY_TCP_LEN && memcmp(packet->payload, SPOTIFY_TCP_ID, SPOTIFY_TCP_LEN) == 0) {
      NDPI_LOG_INFO(ndpi_struct, "found Spotify (TCP)\n");
      NDPI_ADD_PROTOCOL_TO_BITMASK(ndpi_struct, stream, NDPI_PROTOCOL_SPOTIFY);
    }
  }

  if (packet->l3.protocol == IPPROTO_IP) {
    if (((ntohl(packet->l3.ip.src) & SPOTIFY_IP_MASK) == SPOTIFY_IP_NET) || ((ntohl(packet->l3.ip.dst) & SPOTIFY_IP_MASK) == SPOTIFY_IP_NET)) {
      NDPI_LOG_INFO(ndpi_struct, "found Spotify (IP)\n");
      NDPI_ADD_PROTOCOL_TO_BITMASK(ndpi_struct, stream, NDPI_PROTOCOL_SPOTIFY);
      return;
    }
  }