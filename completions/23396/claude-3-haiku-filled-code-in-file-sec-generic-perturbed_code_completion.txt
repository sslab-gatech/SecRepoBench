/* Check if there is a sequence of two consecutive CR+LF ("\r\n\r\n") in the payload
 * after the current CR+LF position. If found, calculate the remaining payload length
 * beyond the sequence. Limit this length to the size of the initial_binary_bytes
 * buffer and copy the data into it. Update the length of the copied data in
 * initial_binary_bytes_len.
 */
if(packet->empty_line_position_set) {
  int remaining_len = packet->payload_packet_len - (packet->empty_line_position + 4);
  if(remaining_len > 0) {
    int copy_len = ndpi_min(remaining_len, sizeof(flow->initial_binary_bytes));
    memcpy(flow->initial_binary_bytes, &packet->payload[packet->empty_line_position + 4], copy_len);
    flow->initial_binary_bytes_len = copy_len;
  } else {
    flow->initial_binary_bytes_len = 0;
  }
}