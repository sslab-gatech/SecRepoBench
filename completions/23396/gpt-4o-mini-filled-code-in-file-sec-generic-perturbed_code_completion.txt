if(packet->parsed_lines >= NDPI_MAX_PARSE_LINES_PER_PACKET) {
        packet->line[packet->parsed_lines].len = 0; // Reset length for the next line
        break; // Exit the loop if maximum lines have been parsed
      }

      packet->line[packet->parsed_lines].len =
        (u_int16_t)(((unsigned long) &packet->payload[a]) - ((unsigned long) packet->line[packet->parsed_lines].ptr));

      // Check for the end of the HTTP headers
      if(packet->empty_line_position_set == 0 && packet->line[packet->parsed_lines].len == 0) {
        packet->empty_line_position = a;
        packet->empty_line_position_set = 1;
      }

      packet->parsed_lines++;
      packet->line[packet->parsed_lines].ptr = &packet->payload[a + 2]; // Move to the next line
      packet->line[packet->parsed_lines].len = 0; // Reset length for the next line
      a++; // Move to the next character in the payload