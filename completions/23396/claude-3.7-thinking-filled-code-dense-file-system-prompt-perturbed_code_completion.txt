if(((a + 4) < packet->payload_packet_len) && (packet->payload[a+2] == 0x0d) && (packet->payload[a+3] == 0x0a)) {
  /* Found the end of headers "\r\n\r\n" */
  u_int16_t remaining_len = packet->payload_packet_len - (a + 4); /* Data after the headers */
  
  if(remaining_len > 0) {
    /* We have binary data after the headers */
    u_int16_t bytes_to_copy = remaining_len;
    
    /* Limit the number of bytes to copy based on buffer size */
    if(bytes_to_copy > sizeof(packet->initial_binary_bytes)) 
      bytes_to_copy = sizeof(packet->initial_binary_bytes);
    
    if(bytes_to_copy > 0) {
      memcpy(packet->initial_binary_bytes, &packet->payload[a + 4], bytes_to_copy);
      packet->initial_binary_bytes_len = bytes_to_copy;
    }
  }
}