if((a + 3) < packet->payload_packet_len &&
   packet->payload[a + 2] == 0x0d &&
   packet->payload[a + 3] == 0x0a) {
  /* Found two consecutive CR+LF. Calculate remaining payload length beyond them. */
  u_int32_t remain = packet->payload_packet_len - (a + 4);
  
  /* Limit the number of bytes copied to the size of initial_binary_bytes. */
  if(remain > sizeof(packet->initial_binary_bytes))
    remain = sizeof(packet->initial_binary_bytes);

  /* Copy the remaining payload to initial_binary_bytes and record its length. */
  if(remain > 0) {
    memcpy(packet->initial_binary_bytes, &packet->payload[a + 4], remain);
    packet->initial_binary_bytes_len = remain;
  }
}