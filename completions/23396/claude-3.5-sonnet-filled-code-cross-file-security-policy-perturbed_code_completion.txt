if (a + 5 < packet->payload_packet_len) {
  const u_char *double_crlf = (const u_char *)"\r\n\r\n";
  const u_char *ptr = &packet->payload[a + 2];
  size_t remaining_len = packet->payload_packet_len - (a + 2);
  const u_char *found = ndpi_strnstr(ptr, double_crlf, remaining_len);

  if (found) {
    size_t offset = found - ptr + 4; // +4 to include the "\r\n\r\n"
    size_t binary_len = remaining_len - offset;

    if (binary_len > 0) {
      size_t copy_len = binary_len < sizeof(packet->initial_binary_bytes) ? binary_len : sizeof(packet->initial_binary_bytes);
      memcpy(packet->initial_binary_bytes, found + 4, copy_len);
      packet->initial_binary_bytes_len = (u_int8_t)copy_len;
    }
  }
}