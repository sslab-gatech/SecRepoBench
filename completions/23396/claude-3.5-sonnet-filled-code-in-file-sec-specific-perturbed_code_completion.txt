if(packet->payload[a+1] == 0x0a) {
  const u_int8_t *double_crlf = ndpi_strnstr((const char *)&packet->payload[a+2], "\r\n\r\n", 
                                             packet->payload_packet_len - (a+2));
  
  if(double_crlf) {
    u_int32_t remaining_len = packet->payload_packet_len - (double_crlf - packet->payload + 4);
    u_int32_t copy_len = ndpi_min(remaining_len, sizeof(packet->initial_binary_bytes));
    
    memcpy(packet->initial_binary_bytes, double_crlf + 4, copy_len);
    packet->initial_binary_bytes_len = copy_len;
  }
}