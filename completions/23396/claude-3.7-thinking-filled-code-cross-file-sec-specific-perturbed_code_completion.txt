if ((a + 3) < packet->payload_packet_len && 
    packet->payload[a+2] == 0x0d && 
    packet->payload[a+3] == 0x0a) {
    
    // Calculate position after the double CR+LF sequence
    u_int32_t start_pos = a + 4;
    
    // Calculate remaining payload length
    if (start_pos < packet->payload_packet_len) {
        u_int32_t binary_len = packet->payload_packet_len - start_pos;
        
        // Limit the length to the size of the initial_binary_bytes buffer
        if (binary_len > sizeof(packet->initial_binary_bytes))
            binary_len = sizeof(packet->initial_binary_bytes);
        
        // Copy the data into the buffer
        if (binary_len > 0) {
            memcpy(packet->initial_binary_bytes, &packet->payload[start_pos], binary_len);
            packet->initial_binary_bytes_len = binary_len;
        } else {
            packet->initial_binary_bytes_len = 0;
        }
    } else {
        packet->initial_binary_bytes_len = 0;
    }
}