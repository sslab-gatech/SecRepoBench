if((packet->payload[a] == 0x0d) && (packet->payload[a+1] == 0x0a)) {
    /* If end of line char sequence CR+LF ("\r\n"), process line */

    /* Check if a sequence of two consecutive CR+LF ("\r\n\r\n") is present in the payload
       after the current CR+LF position. If found, calculate the remaining payload length
       beyond the sequence. Limit this length to the size of the initial_binary_bytes
       buffer and copy the data into it. Update the length of the copied data in
       initial_binary_bytes_len. */
    if((a + 4) < packet->payload_packet_len && packet->payload[a+2] == 0x0d && packet->payload[a+3] == 0x0a) {
      u_int32_t remaining_len = packet->payload_packet_len - (a + 4);
      if(remaining_len > NDPI_MAX_INITIAL_BINARY_BYTES)
	remaining_len = NDPI_MAX_INITIAL_BINARY_BYTES;

      memcpy(initial_binary_bytes, &packet->payload[a+4], remaining_len);
      initial_binary_bytes_len = remaining_len;
    }
  }