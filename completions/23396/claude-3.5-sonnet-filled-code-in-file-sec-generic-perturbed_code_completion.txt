const u_int8_t *crlfcrlf = (const u_int8_t *)"\r\n\r\n";
const u_int8_t *crlfcrlf_pos = ndpi_strnstr((const char *)&packet->payload[a+2], 
                                            (const char *)crlfcrlf,
                                            packet->payload_packet_len - (a+2));

if(crlfcrlf_pos != NULL) {
  u_int16_t remaining_len = packet->payload_packet_len - (crlfcrlf_pos - packet->payload + 4);
  u_int16_t copy_len = ndpi_min(remaining_len, sizeof(packet->initial_binary_bytes));
  
  memcpy(packet->initial_binary_bytes, crlfcrlf_pos + 4, copy_len);
  packet->initial_binary_bytes_len = copy_len;
}