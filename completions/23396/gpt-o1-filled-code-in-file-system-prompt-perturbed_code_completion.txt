if ((a + 3) < packet->payload_packet_len &&
    packet->payload[a + 2] == 0x0d &&
    packet->payload[a + 3] == 0x0a)
{
  /* We've encountered a second consecutive CR+LF. Compute how many bytes remain
   * after this second CR+LF. Then limit that amount to the size of our
   * initial_binary_bytes buffer, copy those bytes, and store the count.
   */
  const uint16_t leftover_len = packet->payload_packet_len - (a + 4);
  const uint16_t copy_len = (leftover_len > MAX_INITIAL_BINARY_BYTES)
                              ? MAX_INITIAL_BINARY_BYTES
                              : leftover_len;

  memcpy(flow->http.initial_binary_bytes, &packet->payload[a + 4], copy_len);
  flow->http.initial_binary_bytes_len = copy_len;
}