{
  size_t i;
  /* Search for "\r\n\r\n" after the current CR+LF (i.e. starting at a+2) */
  for (i = a + 2; i + 3 < packet->payload_packet_len; i++) {
    if (packet->payload[i] == 0x0d &&
        packet->payload[i + 1] == 0x0a &&
        packet->payload[i + 2] == 0x0d &&
        packet->payload[i + 3] == 0x0a) {
      break;
    }
  }
  if (i + 3 < packet->payload_packet_len &&
      packet->payload[i] == 0x0d &&
      packet->payload[i + 1] == 0x0a &&
      packet->payload[i + 2] == 0x0d &&
      packet->payload[i + 3] == 0x0a) {
    size_t start = i + 4;
    size_t remaining = packet->payload_packet_len - start;
    size_t buffer_size = sizeof(packet->initial_binary_bytes);
    size_t to_copy = (remaining < buffer_size) ? remaining : buffer_size;
    memcpy(packet->initial_binary_bytes, packet->payload + start, to_copy);
    packet->initial_binary_bytes_len = to_copy;
  }
}