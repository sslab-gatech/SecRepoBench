if ((a + 3) < packet->payload_packet_len &&
    packet->payload[a+2] == 0x0d && packet->payload[a+3] == 0x0a) {
  u_int32_t remaining = packet->payload_packet_len - (a + 4);
  u_int32_t copy_len = remaining;
  /* Limit the copy to the size of the initial_binary_bytes buffer.
     Assume INITIAL_BINARY_BYTES_SIZE is defined appropriately. */
  if (copy_len > INITIAL_BINARY_BYTES_SIZE)
    copy_len = INITIAL_BINARY_BYTES_SIZE;
  memcpy(packet->initial_binary_bytes, &packet->payload[a+4], copy_len);
  packet->initial_binary_bytes_len = copy_len;
}