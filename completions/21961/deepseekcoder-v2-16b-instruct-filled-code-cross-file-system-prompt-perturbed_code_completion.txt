// Implement reading TIFF images using either strip-based or tile-based methods.
// For strip-based images, allocate memory for the strip size, read each strip,
// and import quantum pixels for each scanline. For tile-based images, get tile
// dimensions, allocate memory, read each tile, and import quantum pixels for
// each row within the tile. Handle various color channels (RGB, CMYK, Alpha)
// and manage progress updates for loading the image.

case ReadStripMethod:
{
  MemoryInfo
    *strip_info = (MemoryInfo *) NULL;

  uint32
    *strip;

  uint32
    strip_size;

  /*
    Read strip-based TIFF image.
  */
  strip_size = TIFFScanlineSize(tiff);
  strip_info = AcquireVirtualMemory(strip_size, sizeof(uint32));
  if (strip_info == (MemoryInfo *) NULL)
    ThrowTIFFException(ResourceLimitError, "MemoryAllocationFailed");
  strip = (uint32 *) GetVirtualMemoryBlob(strip_info);

  for (row_index = 0; row_index < (ssize_t) image->rows; row_index++)
  {
    tiff_status = TIFFReadPixels(tiff, 0, row_index, (char *) strip);
    if (tiff_status == -1)
      break;

    register Quantum
      *magick_restrict q;

    register ssize_t
      x;

    q = QueueAuthenticPixels(image, 0, row_index, image->columns, 1, exception);
    if (q == (Quantum *) NULL)
      break;

    for (x = 0; x < (ssize_t) image->columns; x++)
    {
      switch (quantum_type)
      {
        case RGBQuantum:
          SetPixelRed(image, ScaleCharToQuantum((unsigned char) TIFFGetR(strip[x])), q);
          SetPixelGreen(image, ScaleCharToQuantum((unsigned char) TIFFGetG(strip[x])), q);
          SetPixelBlue(image, ScaleCharToQuantum((unsigned char) TIFFGetB(strip[x])), q);
          if (image->alpha_trait != UndefinedPixelTrait)
            SetPixelAlpha(image, ScaleCharToQuantum((unsigned char) TIFFGetA(strip[x])), q);
          break;
        case CMYKQuantum:
          SetPixelCyan(image, ScaleCharToQuantum((unsigned char) TIFFGetC(strip[x])), q);
          SetPixelMagenta(image, ScaleCharToQuantum((unsigned char) TIFFGetM(strip[x])), q);
          SetPixelYellow(image, ScaleCharToQuantum((unsigned char) TIFFGetY(strip[x])), q);
          SetPixelBlack(image, ScaleCharToQuantum((unsigned char) TIFFGetK(strip[x])), q);
          if (image->alpha_trait != UndefinedPixelTrait)
            SetPixelAlpha(image, ScaleCharToQuantum((unsigned char) TIFFGetA(strip[x])), q);
          break;
        case GrayQuantum:
          SetPixelGray(image, ScaleCharToQuantum((unsigned char) TIFFGetG(strip[x])), q);
          if (image->alpha_trait != UndefinedPixelTrait)
            SetPixelAlpha(image, ScaleCharToQuantum((unsigned char) TIFFGetA(strip[x])), q);
          break;
        case GrayAlphaQuantum:
          SetPixelGray(image, ScaleCharToQuantum((unsigned char) TIFFGetG(strip[x])), q);
          SetPixelAlpha(image, ScaleCharToQuantum((unsigned char) TIFFGetA(strip[x])), q);
          break;
        case RGBAQuantum:
          SetPixelRed(image, ScaleCharToQuantum((unsigned char) TIFFGetR(strip[x])), q);
          SetPixelGreen(image, ScaleCharToQuantum((unsigned char) TIFFGetG(strip[x])), q);
          SetPixelBlue(image, ScaleCharToQuantum((unsigned char) TIFFGetB(strip[x])), q);
          SetPixelAlpha(image, ScaleCharToQuantum((unsigned char) TIFFGetA(strip[x])), q);
          break;
        case CMYKAQuantum:
          SetPixelCyan(image, ScaleCharToQuantum((unsigned char) TIFFGetC(strip[x])), q);
          SetPixelMagenta(image, ScaleCharToQuantum((unsigned char) TIFFGetM(strip[x])), q);
          SetPixelYellow(image, ScaleCharToQuantum((unsigned char) TIFFGetY(strip[x])), q);
          SetPixelBlack(image, ScaleCharToQuantum((unsigned char) TIFFGetK(strip[x])), q);
          SetPixelAlpha(image, ScaleCharToQuantum((unsigned char) TIFFGetA(strip[x])), q);
          break;
        case IndexQuantum:
          SetPixelIndex(image, ScaleCharToQuantum((unsigned char) TIFFGetG(strip[x])), q);
          if (image->alpha_trait != UndefinedPixelTrait)
            SetPixelAlpha(image, ScaleCharToQuantum((unsigned char) TIFFGetA(strip[x])), q);
          break;
        case IndexAlphaQuantum:
          SetPixelIndex(image, ScaleCharToQuantum((unsigned char) TIFFGetG(strip[x])), q);
          SetPixelAlpha(image, ScaleCharToQuantum((unsigned char) TIFFGetA(strip[x])), q);
          break;
      }
      q += GetPixelChannels(image);
    }

    if (SyncAuthenticPixels(image, exception) == MagickFalse)
      break;

    if (image->previous == (Image *) NULL)
    {
      status = SetImageProgress(image, LoadImageTag, (MagickOffsetType) row_index, image->rows);
      if (status == MagickFalse)
        break;
    }
  }

  strip_info = RelinquishVirtualMemory(strip_info);
  break;
}