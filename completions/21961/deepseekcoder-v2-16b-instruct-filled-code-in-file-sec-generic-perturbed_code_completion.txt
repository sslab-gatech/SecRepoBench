aticity) == 1)
      {
        image->chromaticity.white_x=chromaticity[0];
        image->chromaticity.white_y=chromaticity[1];
      }
    if (TIFFGetField(tiff,TIFFTAG_PRIMARYCHROMA,&chromaticity) == 1)
      {
        image->chromaticity.red_x=chromaticity[0];
        image->chromaticity.red_y=chromaticity[1];
      }
    if (TIFFGetField(tiff,TIFFTAG_SECONDPARAMETRIC,&chromaticity) == 1)
      {
        image->chromaticity.green_x=chromaticity[0];
        image->chromaticity.green_y=chromaticity[1];
      }
    if (TIFFGetField(tiff,TIFFTAG_MATRIXPARAMETRIC,&chromaticity) == 1)
      {
        image->chromaticity.blue_x=chromaticity[0];
        image->chromaticity.blue_y=chromaticity[1];
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBIFD,&value) == 1)
      {
        if (value != 0)
          {
            TIFF *subifd;

            subifd=TIFFClientOpen(image->filename,"rb",(thandle_t) image,
              TIFFReadBlob,TIFFWriteBlob,TIFFSeekBlob,TIFFCloseBlob,
              TIFFGetBlobSize,TIFFMapBlob,TIFFUnmapBlob);
            if (subifd != (TIFF *) NULL)
              {
                status=TIFFReadTIFFImage(subifd,image_info,exception);
                TIFFClose(subifd);
                if (status == MagickFalse)
                  {
                    TIFFClose(tiff);
                    return(DestroyImageList(image));
                  }
              }
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_EXTRASAMPLES,&extra_samples,&sample_info) == 1)
      {
        for (i=0; i < (ssize_t) extra_samples; i++)
        {
          switch (sample_info[i])
          {
            case EXTRASAMPLE_ASSOCALPHA:
            {
              image->alpha_trait=BlendPixelTrait;
              break;
            }
            case EXTRASAMPLE_UNASSALPHA:
            {
              image->alpha_trait=OpaqueAlphaTrait;
              break;
            }
            default:
            {
              break;
            }
          }
        }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ROWSPERSTRIP,&rows_per_strip,sans) != 1)
      rows_per_strip=height;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ORIENTATION,&orientation,sans) == 1)
      image->orientation=(OrientationType) orientation;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PAGENUMBER,&pages,sans) == 1)
      {
        image->page.x=(ssize_t) pages;
        image->page.y=(ssize_t) pages;
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBFILETYPE,&value,sans) == 1)
      {
        if ((value & FILETYPE_REDUCEDIMAGE) != 0)
          {
            image->page.x=0;
            image->page.y=0;
          }
        if ((value & FILETYPE_PAGE) != 0)
          {
            image->page.x=(ssize_t) pages;
            image->page.y=(ssize_t) pages;
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PAGENUMBER,&pages,sans) == 1)
      {
        image->page.x=(ssize_t) pages;
        image->page.y=(ssize_t) pages;
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBIFD,&value) == 1)
      {
        if (value != 0)
          {
            TIFF *subifd;

            subifd=TIFFClientOpen(image->filename,"rb",(thandle_t) image,
              TIFFReadBlob,TIFFWriteBlob,TIFFSeekBlob,TIFFCloseBlob,
              TIFFGetBlobSize,TIFFMapBlob,TIFFUnmapBlob);
            if (subifd != (TIFF *) NULL)
              {
                status=TIFFReadTIFFImage(subifd,image_info,exception);
                TIFFClose(subifd);
                if (status == MagickFalse)
                  {
                    TIFFClose(tiff);
                    return(DestroyImageList(image));
                  }
              }
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_EXTRASAMPLES,&extra_samples,&sample_info) == 1)
      {
        for (i=0; i < (ssize_t) extra_samples; i++)
        {
          switch (sample_info[i])
          {
            case EXTRASAMPLE_ASSOCALPHA:
            {
              image->alpha_trait=BlendPixelTrait;
              break;
            }
            case EXTRASAMPLE_UNASSALPHA:
            {
              image->alpha_trait=OpaqueAlphaTrait;
              break;
            }
            default:
            {
              break;
            }
          }
        }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ROWSPERSTRIP,&rows_per_strip,sans) != 1)
      rows_per_strip=height;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ORIENTATION,&orientation,sans) == 1)
      image->orientation=(OrientationType) orientation;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PAGENUMBER,&pages,sans) == 1)
      {
        image->page.x=(ssize_t) pages;
        image->page.y=(ssize_t) pages;
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBFILETYPE,&value,sans) == 1)
      {
        if ((value & FILETYPE_REDUCEDIMAGE) != 0)
          {
            image->page.x=0;
            image->page.y=0;
          }
        if ((value & FILETYPE_PAGE) != 0)
          {
            image->page.x=(ssize_t) pages;
            image->page.y=(ssize_t) pages;
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PAGENUMBER,&pages,sans) == 1)
      {
        image->page.x=(ssize_t) pages;
        image->page.y=(ssize_t) pages;
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBIFD,&value) == 1)
      {
        if (value != 0)
          {
            TIFF *subifd;

            subifd=TIFFClientOpen(image->filename,"rb",(thandle_t) image,
              TIFFReadBlob,TIFFWriteBlob,TIFFSeekBlob,TIFFCloseBlob,
              TIFFGetBlobSize,TIFFMapBlob,TIFFUnmapBlob);
            if (subifd != (TIFF *) NULL)
              {
                status=TIFFReadTIFFImage(subifd,image_info,exception);
                TIFFClose(subifd);
                if (status == MagickFalse)
                  {
                    TIFFClose(tiff);
                    return(DestroyImageList(image));
                  }
              }
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_EXTRASAMPLES,&extra_samples,&sample_info) == 1)
      {
        for (i=0; i < (ssize_t) extra_samples; i++)
        {
          switch (sample_info[i])
          {
            case EXTRASAMPLE_ASSOCALPHA:
            {
              image->alpha_trait=BlendPixelTrait;
              break;
            }
            case EXTRASAMPLE_UNASSALPHA:
            {
              image->alpha_trait=OpaqueAlphaTrait;
              break;
            }
            default:
            {
              break;
            }
          }
        }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ROWSPERSTRIP,&rows_per_strip,sans) != 1)
      rows_per_strip=height;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ORIENTATION,&orientation,sans) == 1)
      image->orientation=(OrientationType) orientation;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PAGENUMBER,&pages,sans) == 1)
      {
        image->page.x=(ssize_t) pages;
        image->page.y=(ssize_t) pages;
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBFILETYPE,&value,sans) == 1)
      {
        if ((value & FILETYPE_REDUCEDIMAGE) != 0)
          {
            image->page.x=0;
            image->page.y=0;
          }
        if ((value & FILETYPE_PAGE) != 0)
          {
            image->page.x=(ssize_t) pages;
            image->page.y=(ssize_t) pages;
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PAGENUMBER,&pages,sans) == 1)
      {
        image->page.x=(ssize_t) pages;
        image->page.y=(ssize_t) pages;
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBIFD,&value) == 1)
      {
        if (value != 0)
          {
            TIFF *subifd;

            subifd=TIFFClientOpen(image->filename,"rb",(thandle_t) image,
              TIFFReadBlob,TIFFWriteBlob,TIFFSeekBlob,TIFFCloseBlob,
              TIFFGetBlobSize,TIFFMapBlob,TIFFUnmapBlob);
            if (subifd != (TIFF *) NULL)
              {
                status=TIFFReadTIFFImage(subifd,image_info,exception);
                TIFFClose(subifd);
                if (status == MagickFalse)
                  {
                    TIFFClose(tiff);
                    return(DestroyImageList(image));
                  }
              }
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_EXTRASAMPLES,&extra_samples,&sample_info) == 1)
      {
        for (i=0; i < (ssize_t) extra_samples; i++)
        {
          switch (sample_info[i])
          {
            case EXTRASAMPLE_ASSOCALPHA:
            {
              image->alpha_trait=BlendPixelTrait;
              break;
            }
            case EXTRASAMPLE_UNASSALPHA:
            {
              image->alpha_trait=OpaqueAlphaTrait;
              break;
            }
            default:
            {
              break;
            }
          }
        }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ROWSPERSTRIP,&rows_per_strip,sans) != 1)
      rows_per_strip=height;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ORIENTATION,&orientation,sans) == 1)
      image->orientation=(OrientationType) orientation;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PAGENUMBER,&pages,sans) == 1)
      {
        image->page.x=(ssize_t) pages;
        image->page.y=(ssize_t) pages;
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBFILETYPE,&value,sans) == 1)
      {
        if ((value & FILETYPE_REDUCEDIMAGE) != 0)
          {
            image->page.x=0;
            image->page.y=0;
          }
        if ((value & FILETYPE_PAGE) != 0)
          {
            image->page.x=(ssize_t) pages;
            image->page.y=(ssize_t) pages;
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PAGENUMBER,&pages,sans) == 1)
      {
        image->page.x=(ssize_t) pages;
        image->page.y=(ssize_t) pages;
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBIFD,&value) == 1)