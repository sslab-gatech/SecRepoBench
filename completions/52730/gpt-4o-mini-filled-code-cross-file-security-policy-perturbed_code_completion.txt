if (codeLength < (uint64_t) SHORT_ZEROCODE_RUN)
        {
            if (codeLength == 0) continue;

            if (codeLength < (uint64_t) MAX_CODE_LEN && currByte < topByte)
            {
                fhd->_minCodeLength = std::min(fhd->_minCodeLength, (unsigned char)codeLength);
                fhd->_maxCodeLength = std::max(fhd->_maxCodeLength, (unsigned char)codeLength);
                codeCount[codeLength]++;
            }
            else
            {
                if (pctxt)
                    pctxt->print_error (
                        pctxt,
                        EXR_ERR_CORRUPT_CHUNK,
                        "Error decoding Huffman table (Invalid code length).");
                return EXR_ERR_CORRUPT_CHUNK;
            }
        }
        else if (codeLength == (uint64_t) LONG_ZEROCODE_RUN)
        {
            if (currByte < topByte)
            {
                int runLength = fasthuf_read_bits(8, &currBits, &currBitCount, &currByte);
                symbol += runLength + SHORTEST_LONG_RUN - 1;
            }
            else
            {
                if (pctxt)
                    pctxt->print_error (
                        pctxt,
                        EXR_ERR_CORRUPT_CHUNK,
                        "Error decoding Huffman table (Truncated run length).");
                return EXR_ERR_CORRUPT_CHUNK;
            }
        }
        else
        {
            symbol += codeLength - SHORT_ZEROCODE_RUN + 1;
        }