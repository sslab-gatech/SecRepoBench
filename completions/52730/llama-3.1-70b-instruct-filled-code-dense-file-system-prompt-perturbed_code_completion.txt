if (codeLength == (uint64_t) LONG_ZEROCODE_RUN)
{
    if (currByte >= topByte)
    {
        if (pctxt)
            pctxt->print_error (
                pctxt,
                EXR_ERR_CORRUPT_CHUNK,
                "Error decoding Huffman table (Truncated table data).");
        return EXR_ERR_CORRUPT_CHUNK;
    }

    int runLen = fasthuf_read_bits (8, &currBits, &currBitCount, &currByte) +
                 SHORTEST_LONG_RUN;

    if (symbol + runLen > (uint64_t) maxSymbol + 1)
    {
        if (pctxt)
            pctxt->print_error (
                pctxt,
                EXR_ERR_CORRUPT_CHUNK,
                "Error decoding Huffman table (Run beyond end of table).");
        return EXR_ERR_CORRUPT_CHUNK;
    }

    symbol += runLen - 1;
}
else if (codeLength >= (uint64_t) SHORT_ZEROCODE_RUN)
{
    int runLen = codeLength - SHORT_ZEROCODE_RUN + 2;

    if (symbol + runLen > (uint64_t) maxSymbol + 1)
    {
        if (pctxt)
            pctxt->print_error (
                pctxt,
                EXR_ERR_CORRUPT_CHUNK,
                "Error decoding Huffman table (Run beyond end of table).");
        return EXR_ERR_CORRUPT_CHUNK;
    }

    symbol += runLen - 1;
}
else if (codeLength!= 0)
{
    if (codeLength < fhd->_minCodeLength) fhd->_minCodeLength = codeLength;

    if (codeLength > fhd->_maxCodeLength) fhd->_maxCodeLength = codeLength;

    codeCount[codeLength]++;
}