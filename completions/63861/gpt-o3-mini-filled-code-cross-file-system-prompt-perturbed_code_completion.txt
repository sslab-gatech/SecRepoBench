{
    cmsUInt32Number j;
    cmsUInt16Number* buffer = NULL;

    // Ensure there is enough data for the Unicode string
    if (SizeOfTag < unicodeLength * sizeof(cmsUInt16Number))
        goto Done;

    // Allocate a temporary buffer to read the Unicode string (stored as 16-bit values)
    buffer = (cmsUInt16Number*) _cmsMalloc(self->ContextID, unicodeLength * sizeof(cmsUInt16Number));
    if (buffer == NULL)
        goto Error;

    if (io->Read(io, buffer, sizeof(cmsUInt16Number), unicodeLength) != unicodeLength) {
        _cmsFree(self->ContextID, buffer);
        goto Error;
    }
    SizeOfTag -= unicodeLength * sizeof(cmsUInt16Number);

    // Allocate a wide-character buffer for conversion (add one for terminator)
    UnicodeString = (wchar_t*) _cmsMalloc(self->ContextID, (unicodeLength + 1) * sizeof(wchar_t));
    if (UnicodeString == NULL) {
        _cmsFree(self->ContextID, buffer);
        goto Error;
    }

    // Convert the 16-bit characters to wchar_t
    for (j = 0; j < unicodeLength; j++)
         UnicodeString[j] = (wchar_t) buffer[j];
    UnicodeString[unicodeLength] = 0;
    _cmsFree(self->ContextID, buffer);

    // Set the Unicode entry into the MLU structure
    if (!cmsMLUsetWChar(mlu, cmsNoLanguage, cmsNoCountry, UnicodeString)) {
         _cmsFree(self->ContextID, UnicodeString);
         goto Error;
    }
    _cmsFree(self->ContextID, UnicodeString);
    UnicodeString = NULL;

    // Check for optional ScriptCode data: require at least 1 byte (count) + 2*2 bytes (ScriptCodeCode and Dummy)
    if (SizeOfTag >= (sizeof(cmsUInt8Number) + 2 * sizeof(cmsUInt16Number))) {

         if (io->Read(io, &ScriptCodeCount, sizeof(cmsUInt8Number), 1) != 1)
              goto Error;
         SizeOfTag -= sizeof(cmsUInt8Number);

         if (!_cmsReadUInt16Number(io, &ScriptCodeCode))
              goto Error;
         if (!_cmsReadUInt16Number(io, &Dummy))
              goto Error;
         SizeOfTag -= 2 * sizeof(cmsUInt16Number);

         // If ScriptCodeCount indicates extra data, skip the remaining bytes
         if (ScriptCodeCount > 1) {
              cmsUInt32Number extra = (ScriptCodeCount - 1) * 4;  // each extra entry is 4 bytes
              cmsUInt8Number dummy;
              while (extra--) {
                  if (io->Read(io, &dummy, sizeof(cmsUInt8Number), 1) != 1)
                      goto Error;
              }
              SizeOfTag -= (ScriptCodeCount - 1) * 4;
         }
    }

    *nItems = 1;
    return mlu;
}