u32 res_size = buffer_length;
	u8 *dst = (u8 *)data;

	// Strip leading whitespace characters
	while (res_size && ((*dst == ' ') || (*dst == '\n') || (*dst == '\t'))) {
		dst++;
		res_size--;
	}

	#define PROBE_OK(_score, _mime) { \
		*score = _score; \
		if (dst) gf_free(dst); \
		return _mime; \
	}