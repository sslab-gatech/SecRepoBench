char *dst=NULL, *line;
	u32 res_size;
	s32 uni_type;
	FILE *test;

	if (buffer_length<10) return NULL;

	test = gf_file_temp(NULL);
	if (!test) return NULL;
	gf_fwrite(data, buffer_length, test);
	gf_fseek(test, 0, SEEK_SET);
	uni_type = gf_text_get_utf_type(NULL, test);
	gf_fseek(test, 0, SEEK_SET);

	if (uni_type>1) {
		const u16 *sptr;
		char szUTF[1024];
		u32 read = (u32) gf_fread(szUTF, 1023, test);
		szUTF[read]=0;
		sptr = (u16*)szUTF;
		dst = (char*)gf_malloc(sizeof(char) * (read+1) );
		/*read = (u32) */gf_utf8_wcstombs(dst, read, &sptr);
		res_size = read;
	} else {
		dst = (char*)gf_malloc(sizeof(char) * (buffer_length+1) );
		res_size = (u32) gf_fread(dst, buffer_length, test);
		dst[res_size]=0;
	}
	gf_fclose(test);
	REM_TRAIL_MARKS(dst, "\r\n\t ")

	line = dst;
	while (line[0] && strchr("\n\r\t ", (char) line[0]))
		line ++;

#define PROBE_OK(_score, _mime) {*score = _score; if (dst) gf_free(dst); return _mime;}