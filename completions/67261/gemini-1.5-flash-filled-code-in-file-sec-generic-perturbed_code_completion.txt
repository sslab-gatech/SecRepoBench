#define PROBE_OK(__score, __mime) \
	{ \
		score->score = __score; \
		score->mime = gf_strdup(__mime); \
		if (dst) gf_free(dst); \
		return score->mime; \
	}

	u32 res_size = buffer_length;
	char *dst = gf_malloc(sizeof(char)*(res_size+1));
	if (!dst) return NULL;
	memcpy(dst, data, res_size);
	dst[res_size] = 0;

	s32 uni_type = gf_text_get_utf_type(NULL, NULL);
	if (uni_type>1) {
		const u16 *sptr;
		char szUTF[1024];
		u32 read = (u32) gf_utf8_mbstowcs(szUTF, 1023, (const char **) &data);
		if (read == GF_UTF8_FAIL) {
			gf_free(dst);
			return NULL;
		}
		szUTF[read]=0;
		sptr = (u16*)szUTF;
		/*read = (u32) */gf_utf8_wcstombs(dst, res_size, &sptr);
	} else {
		memcpy(dst, data, res_size);
	}
	REM_TRAIL_MARKS(dst, "\r\n\t ")