u32 res_size = buffer_length;
	char *dst = NULL;
	const u8 *data_without_bom = gf_utf8_bom_skip(data, &res_size);

	if (!data_without_bom || !res_size) return NULL;

	data = data_without_bom;

	dst = gf_malloc(sizeof(char) * (res_size+1));
	memcpy(dst, data, res_size);
	dst[res_size] = 0;

	while (strchr(" \t\r\n", dst[0])) {
		memmove(dst, dst+1, res_size);
		res_size--;
		if (!res_size) {
			gf_free(dst);
			return NULL;
		}
	}

#define PROBE_OK(score_val, mime_type) { score->score = score_val; score->mime = mime_type; if (dst) gf_free(dst); return mime_type; }