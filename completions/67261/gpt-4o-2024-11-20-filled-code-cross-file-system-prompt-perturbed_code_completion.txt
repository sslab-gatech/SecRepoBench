u32 res_size = 0;
	char *dst = NULL;

	// Convert input data to UTF-8 string, handling BOM if present
	dst = gf_text_get_utf8(data, buffer_length, &res_size);
	if (!dst) {
		return NULL;
	}

	// Strip leading whitespace characters
	while (res_size && ((*dst == ' ') || (*dst == '\n') || (*dst == '\t'))) {
		dst++;
		res_size--;
	}

	// Define macro for returning MIME type and freeing memory
	#define PROBE_OK(_score, _mime) \
		do { \
			if (score) *score = _score; \
			if (dst) gf_free(dst); \
			return _mime; \
		} while (0)