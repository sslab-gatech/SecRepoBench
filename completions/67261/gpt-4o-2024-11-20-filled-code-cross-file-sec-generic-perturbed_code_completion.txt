// Define a macro for returning MIME type and freeing allocated memory
	#define PROBE_OK(probe_score, mime_type) \
		do { \
			if (dst) gf_free(dst); \
			if (score) *score = probe_score; \
			return mime_type; \
		} while (0)

	// Ensure the input data and buffer length are valid
	if (!data || buffer_length == 0) {
		if (score) *score = GF_FPROBE_NOT_SUPPORTED;
		return NULL;
	}

	// Allocate memory for processing the data
	char *dst = (char *)gf_malloc(buffer_length + 1);
	if (!dst) {
		if (score) *score = GF_FPROBE_NOT_SUPPORTED;
		return NULL;
	}

	// Copy the input data to the allocated buffer and null-terminate it
	memcpy(dst, data, buffer_length);
	dst[buffer_length] = '\0';

	// Strip leading whitespace characters
	char *processed_data = dst;
	while (*processed_data == ' ' || *processed_data == '\n' || *processed_data == '\t') {
		processed_data++;
	}

	// Update the size of the remaining data
	u32 res_size = (u32)(buffer_length - (processed_data - dst));