// Allocate memory for the processed data buffer
res_size = buffer_length;
dst = (char *) gf_malloc(sizeof(char) * (res_size + 1));
memcpy(dst, data, res_size);
dst[res_size] = 0;

// Strip leading whitespace characters
char *start = dst;
while ((*start == ' ') || (*start == '\t') || (*start == '\n') || (*start == '\r')) start++;
if (start != dst) {
    res_size -= (u32)(start - dst);
    memmove(dst, start, res_size + 1);
}

// Check for various subtitle and other formats
if (!strncmp(dst, "WEBVTT", 6)) {
    PROBE_OK(GF_FPROBE_SUPPORTED, "subtitle/vtt")
} else if (gf_strmemstr(dst, res_size, " --> ")) {
    PROBE_OK(GF_FPROBE_MAYBE_SUPPORTED, "subtitle/srt")
} else if (!strncmp(dst, "FWS", 3) || !strncmp(dst, "CWS", 3)) {
    PROBE_OK(GF_FPROBE_MAYBE_SUPPORTED, "application/x-shockwave-flash")
} else if (!strncmp(dst, "[Script Info", 12)) {
    PROBE_OK(GF_FPROBE_MAYBE_SUPPORTED, "subtitle/ssa")
} else if ((dst[0]=='{') && gf_strmemstr(dst, res_size, "}{")) {
    PROBE_OK(GF_FPROBE_MAYBE_SUPPORTED, "subtitle/sub")
} else if (!gf_strmemstr(dst, res_size, "?>")) {
    gf_free(dst);
    return NULL;
} else if (gf_strmemstr(dst, res_size, "<x-quicktime-tx3g") || gf_strmemstr(dst, res_size, "<text3GTrack")) {
    PROBE_OK(GF_FPROBE_MAYBE_SUPPORTED, "quicktime/text")
} else if (gf_strmemstr(dst, res_size, "TextStream")) {
    PROBE_OK(GF_FPROBE_MAYBE_SUPPORTED, "subtitle/ttxt")
} else if (gf_strmemstr(dst, res_size, "<tt ") || gf_strmemstr(dst, res_size, ":tt ")) {
    PROBE_OK(GF_FPROBE_MAYBE_SUPPORTED, "subtitle/ttml")
}

gf_free(dst);
return NULL;