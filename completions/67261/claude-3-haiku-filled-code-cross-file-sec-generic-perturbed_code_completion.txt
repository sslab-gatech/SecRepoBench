// <MASK>
// Allocate memory for the processed data
dst = (char *)gf_malloc(sizeof(char) * (res_size + 1));
memcpy(dst, data, res_size);
dst[res_size] = 0;

// Strip leading whitespace characters
char *start = dst;
while (isspace(*start)) start++;

// Check for various subtitle and other formats
if (!strncmp(start, "WEBVTT", 6)) {
    PROBE_OK(GF_FPROBE_SUPPORTED, "subtitle/vtt")
} else if (gf_strmemstr(start, res_size, " --> ")) {
    PROBE_OK(GF_FPROBE_MAYBE_SUPPORTED, "subtitle/srt")
} else if (!strncmp(start, "FWS", 3) || !strncmp(start, "CWS", 3)) {
    PROBE_OK(GF_FPROBE_MAYBE_SUPPORTED, "application/x-shockwave-flash")
} else if (!strncmp(start, "[Script Info", 12)) {
    PROBE_OK(GF_FPROBE_MAYBE_SUPPORTED, "subtitle/ssa")
} else if ((start[0]=='{') && gf_strmemstr(start, res_size, "}{")) {
    PROBE_OK(GF_FPROBE_MAYBE_SUPPORTED, "subtitle/sub")
} else if (!gf_strmemstr(start, res_size, "?>")) {
    // XML formats
    if (dst) gf_free(dst);
    return NULL;
} else if (gf_strmemstr(start, res_size, "<x-quicktime-tx3g") || gf_strmemstr(start, res_size, "<text3GTrack")) {
    PROBE_OK(GF_FPROBE_MAYBE_SUPPORTED, "quicktime/text")
} else if (gf_strmemstr(start, res_size, "TextStream")) {
    PROBE_OK(GF_FPROBE_MAYBE_SUPPORTED, "subtitle/ttxt")
} else if (gf_strmemstr(start, res_size, "<tt ") || gf_strmemstr(start, res_size, ":tt ")) {
    PROBE_OK(GF_FPROBE_MAYBE_SUPPORTED, "subtitle/ttml")
}

if (dst) gf_free(dst);
return NULL;