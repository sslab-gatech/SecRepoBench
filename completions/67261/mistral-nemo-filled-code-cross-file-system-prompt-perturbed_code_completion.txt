// Convert the input data into a UTF string using its byte order mark (BOM).
	u32 res_size = buffer_length;
	u8 *res = gf_malloc(res_size);
	memcpy(res, data, res_size);

	// Strip leading whitespace characters, including spaces, newlines, and tabs, from the processed data.
	u32 i = 0;
	while (i < res_size && (res[i] == ' ' || res[i] == '\n' || res[i] == '\t')) i++;
	if (i > 0) {
		memmove(res, res + i, res_size - i);
		res_size -= i;
	}

	// Define a macro to facilitate returning a MIME type and freeing allocated memory when a format is identified.
#define PROBE_OK(score, mime) do { \
	if (score == GF_FPROBE_SUPPORTED) { \
		*score = score; \
		*score = score; \
		return mime; \
	} \
} while(0)

	// Rest of the code...