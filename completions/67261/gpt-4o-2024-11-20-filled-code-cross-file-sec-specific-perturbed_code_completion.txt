// Ensure the input data and buffer length are valid
    if (!data || buffer_length == 0) {
        return NULL;
    }

    // Allocate memory for processing the data
    char *dst = (char *)gf_malloc(buffer_length + 1);
    if (!dst) {
        return NULL; // Memory allocation failed
    }

    // Copy the input data into the allocated buffer and null-terminate it
    memcpy(dst, data, buffer_length);
    dst[buffer_length] = '\0';

    // Strip leading whitespace characters
    char *processed_data = dst;
    while (*processed_data == ' ' || *processed_data == '\n' || *processed_data == '\t') {
        processed_data++;
    }

    // Define the macro for returning MIME type and freeing memory
    #define PROBE_OK(probe_score, mime_type) \
        do { \
            *score = probe_score; \
            if (dst) gf_free(dst); \
            return mime_type; \
        } while (0)