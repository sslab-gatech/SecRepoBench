u32 res_size = buffer_length;
	u8 *dst = NULL;
	char *mime = NULL;
	if (res_size > 1024 * 1024) res_size = 1024 * 1024;
	dst = (u8 *)gf_malloc(res_size + 1);
	if (!dst) return NULL;
	memcpy(dst, data, res_size);
	dst[res_size] = 0;

#define PROBE_OK(a, b) {mime = (char *)gf_strdup(b); score->score = a; goto probe_ok;}
	score->score = GF_FPROBE_UNSUPPORTED;

	// Convert the input data to lowercase for case-insensitive matching.
	gf_lowercase(dst, res_size);