u32 res_size = buffer_length;
	u8 *dst = NULL;
	char *mime = NULL;
	// Convert the input data to UTF-8.  The BOM is used to determine the encoding.
	dst = gf_utf8_convert((char *)data, &res_size, GF_FALSE);
	if (!dst) return NULL;

	// Strip leading whitespace from the converted UTF-8 string.
	while (res_size && (dst[0] == ' ' || dst[0] == '\t' || dst[0] == '\n' || dst[0] == '\r')) {
		dst++;
		res_size--;
	}

	#define PROBE_OK(a,b) { score->score = a; mime = (char *)b; goto probe_ok;}
	#define PROBE_ERR {if (dst) gf_free(dst); return NULL;}