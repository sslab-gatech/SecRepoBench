u32 res_size = buffer_length;
	char *dst = NULL;

#define PROBE_OK(score_val, mime_type) \
{ \
	if (score) score->value = score_val; \
	if (dst) gf_free(dst); \
	return mime_type; \
}

	dst = gf_strdup((char*)data);
	if (!dst) return NULL;

	/*strip leading spaces*/
	char *ptr = dst;
	while (*ptr == ' ' || *ptr == '\r' || *ptr == '\n' || *ptr == '\t') ptr++;
	res_size -= (ptr - dst);
	if (ptr != dst) {
		memmove(dst, ptr, res_size + 1);
	}
	data = (u8 *)dst;