char *dst = NULL, *szLine;
u32 res_size;

if (!buffer_length)
	return NULL;

dst = gf_malloc(buffer_length+1);
if (!dst) return NULL;
memcpy(dst, data, buffer_length);
dst[buffer_length] = 0;
szLine = dst;
res_size = buffer_length;

while (szLine[0] && strchr("\n\r\t ", szLine[0]))
	szLine++;

#define PROBE_OK(_score, _mime)	\
	if (dst && (dst != szLine)) gf_free(dst);	\
	*score = _score;	\
	return _mime;	\