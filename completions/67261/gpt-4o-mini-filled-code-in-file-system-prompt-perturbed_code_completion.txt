// Check for empty data
	if (buffer_length == 0) {
		return NULL;
	}

	// Check for UTF-8 BOM
	if (buffer_length >= 3 && data[0] == 0xEF && data[1] == 0xBB && data[2] == 0xBF) {
		PROBE_OK(GF_FPROBE_SUPPORTED, "text/utf-8")
	}

	// Check for UTF-16 BOM
	if (buffer_length >= 2 && ((data[0] == 0xFF && data[1] == 0xFE) || (data[0] == 0xFE && data[1] == 0xFF))) {
		PROBE_OK(GF_FPROBE_SUPPORTED, "text/utf-16")
	}

	// Check for SRT format
	if (buffer_length >= 4 && memcmp(data, "{", 1) == 0 && memcmp(data + buffer_length - 1, "}", 1) == 0) {
		PROBE_OK(GF_FPROBE_MAYBE_SUPPORTED, "subtitle/srt")
	}

	// Check for WebVTT format
	if (buffer_length >= 6 && memcmp(data, "WEBVTT", 6) == 0) {
		PROBE_OK(GF_FPROBE_MAYBE_SUPPORTED, "subtitle/vtt")
	}

	// Check for TTML format
	if (buffer_length >= 5 && memcmp(data, "<tt>", 4) == 0) {
		PROBE_OK(GF_FPROBE_MAYBE_SUPPORTED, "subtitle/ttml")
	}

	// Check for TTXT format
	if (buffer_length >= 10 && memcmp(data, "TextStream", 10) == 0) {
		PROBE_OK(GF_FPROBE_MAYBE_SUPPORTED, "subtitle/ttxt")
	}

	// Check for SUB format
	if (buffer_length >= 4 && memcmp(data, "{", 1) == 0 && memcmp(data + buffer_length - 1, "}", 1) == 0) {
		PROBE_OK(GF_FPROBE_MAYBE_SUPPORTED, "subtitle/sub")
	}

	// Check for SSA format
	if (buffer_length >= 13 && memcmp(data, "[Script Info]", 13) == 0) {
		PROBE_OK(GF_FPROBE_MAYBE_SUPPORTED, "subtitle/ssa")
	}

	return NULL;