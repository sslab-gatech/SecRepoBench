struct ndpi_packet_struct *packet = &detectionmodulestruct->packet;
  char buffer[256];
  char rdnSeqBuf[512];
  u_int16_t rdn_len = 0;
  u_int16_t i;
  u_int8_t num_found = 0;

  // Ensure certificate_len is within bounds to prevent buffer overflows
  if (certificate_len > packet->payload_packet_len) {
    certificate_len = packet->payload_packet_len;
  }