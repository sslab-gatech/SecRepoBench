struct ndpi_packet_struct *packet = &detectionmodulestruct->packet;
  u_int8_t buffer[256];
  char rdnSeqBuf[1024];
  u_int rdn_len = 0;
  u_int num_found = 0;
  SHA1_CTX sha1_ctx;

  if(p_offset + certificate_len > packet->payload_packet_len) {
    return; // Ensure we do not read beyond the payload length
  }

  SHA1Init(&sha1_ctx);
  SHA1Update(&sha1_ctx, &packet->payload[p_offset], certificate_len);
  SHA1Final(flow->protos.tls_quic.sha1_certificate_fingerprint, &sha1_ctx);

  flow->protos.tls_quic.fingerprint_set = 1;