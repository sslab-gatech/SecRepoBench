struct ndpi_packet_struct *packet = &detectionmodulestruct->packet;
  char buffer[256], rdnSeqBuf[512];
  u_int rdn_len = 0, num_found = 0;
  SHA1_CTX sha1_ctx;

  SHA1Init(&sha1_ctx);
  SHA1Update(&sha1_ctx, &packet->payload[p_offset], certificate_len);
  SHA1Final(flow->protos.tls_quic.sha1_certificate_fingerprint, &sha1_ctx);

  flow->protos.tls_quic.fingerprint_set = 1;

  if(flow->protos.tls_quic.sha1_certificate_fingerprint[0] != '\0') {
    char sha1_str[41];
    for(i = 0; i < 20; i++) {
      snprintf(&sha1_str[i*2], 3, "%02x", flow->protos.tls_quic.sha1_certificate_fingerprint[i]);
    }
    sha1_str[40] = '\0';

    if(detectionmodulestruct->malicious_sha1_hashmap != NULL) {
      u_int16_t rc = ndpi_hash_find_entry(detectionmodulestruct->malicious_sha1_hashmap, sha1_str, 40, NULL);
      if(rc == 0) {
        ndpi_set_risk(detectionmodulestruct, flow, NDPI_MALICIOUS_SHA1_CERTIFICATE, sha1_str);
      }
    }
  }