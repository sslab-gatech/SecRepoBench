if (cmsPipelineCheckAndRetreiveStages(Src, 3,
         cmsSigCurveSetElemType, cmsSigMatrixElemType, cmsSigCurveSetElemType,
         &Curve1, &Matrix1, &Curve2)) {

    _cmsStageMatrixData* Data = (_cmsStageMatrixData*)cmsStageData(Matrix1);

    // Copy the matrix to our result
    memcpy(&res, Data->Double, sizeof(res));

    // Preserve the Odffset (may be NULL as a zero offset)
    Offset = Data->Offset;

    if (_cmsMAT3isIdentity(&res) && Offset == NULL) {

        // We can get rid of full matrix
        isIdentityMatrix = TRUE;
    }
}
else
    return FALSE; // Not optimizeable this time