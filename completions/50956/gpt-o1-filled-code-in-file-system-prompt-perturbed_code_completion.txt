{
    _cmsStageMatrixData* m1 = (_cmsStageMatrixData*)cmsStageData(Matrix1);
    _cmsStageMatrixData* m2 = (_cmsStageMatrixData*)cmsStageData(Matrix2);
    cmsMAT3 M1, M2;

    // The offset on the first matrix must be zero to combine both into one
    if (m1->Offset != NULL) return FALSE;

    // Only handle 3x3 matrices
    if (cmsStageInputChannels(Matrix1) != 3 || cmsStageOutputChannels(Matrix1) != 3 ||
        cmsStageInputChannels(Matrix2) != 3 || cmsStageOutputChannels(Matrix2) != 3)
        return FALSE;

    // Copy the matrices
    memcpy(&M1, m1->Double, sizeof(M1));
    memcpy(&M2, m2->Double, sizeof(M2));

    // Multiply them: res = M2 * M1
    _cmsMAT3per(&res, &M2, &M1);

    // Keep offset from second matrix
    Offset = m2->Offset;

    // If both offset and matrix are identity, we can skip the matrix entirely
    if (_cmsMAT3isIdentity(&res) && Offset == NULL) {
        isIdentityMatrix = TRUE;
    }
}