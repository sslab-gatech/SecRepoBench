_cmsStageMatrixData* Data1 = (_cmsStageMatrixData*)cmsStageData(Matrix1);
                     _cmsStageMatrixData* Data2 = (_cmsStageMatrixData*)cmsStageData(Matrix2);

                     // Input offset and output offset should be zero to use this optimization
                     if (Data1->Offset != NULL || Data2->Offset != NULL ||
                         cmsStageInputChannels(Matrix1) != 3 || cmsStageOutputChannels(Matrix1) != 3 ||
                         cmsStageInputChannels(Matrix2) != 3 || cmsStageOutputChannels(Matrix2) != 3)
                         return FALSE;

                     // Multiply both matrices to get the result
                     _cmsMAT3per(&res, (cmsMAT3*)Data2->Double, (cmsMAT3*)Data1->Double);

                     // Preserve the Odffset (may be NULL as a zero offset)
                     Offset = Data1->Offset;

                     if (_cmsMAT3isIdentity(&res) && Offset == NULL) {

                         // We can get rid of full matrix
                         isIdentityMatrix = TRUE;
                     }