_cmsStageMatrixData* Data = (_cmsStageMatrixData*)cmsStageData(Matrix1);

                     // Copy the matrix to our result
                     memcpy(&res, Data->Double, sizeof(res));

                     // Preserve the Offset (may be NULL as a zero offset)
                     Offset = Data->Offset;

                     if (_cmsMAT3isIdentity(&res) && Offset == NULL) {
                            // We can get rid of full matrix
                            isIdentityMatrix = TRUE;
                     }
                     else {
                            // If the matrix is not identity, we need to optimize it
                            // Set the optimization parameters for the matrix
                            SetMatShaper(Dest, 
                                         (_cmsStageToneCurvesData*)cmsStageData(Curve1)->TheCurves, 
                                         &res, 
                                         (cmsVEC3*)Offset, 
                                         (_cmsStageToneCurvesData*)cmsStageData(Curve2)->TheCurves, 
                                         OutputFormat);
                     }