// Multiply both matrices to get the result
_cmsMAT3per(&res, (cmsMAT3*)m2->Double, (cmsMAT3*)m1->Double);

// Get the next in chain after the matrices
chain = (*pt2)->Next;

// Remove both matrices
_RemoveElement(pt2);
_RemoveElement(pt1);

// Now what if the result is a plain identity?                     
if (!isFloatMatrixIdentity(&res)) {

       // We can not get rid of full matrix                            
       cmsStage* Multmat = cmsStageAllocMatrix(Lut->ContextID, 3, 3, (const cmsFloat64Number*) &res, NULL);
       if (Multmat == NULL) return FALSE;  // Should never happen

       // Recover the chain
       Multmat->Next = chain;
       *pt1 = Multmat;
}

AnyOpt = TRUE;