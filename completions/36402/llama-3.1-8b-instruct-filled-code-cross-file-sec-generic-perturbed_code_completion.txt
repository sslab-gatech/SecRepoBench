bool find_table_index (hb_tag_t hb_tag, unsigned int *table_index) const
  {
    // Determine the index of the table entry corresponding to the given tag.
    // Use the appropriate search method based on table entry size.
    if (hb_tag == HB_OT_TAG_GSUB || hb_tag == HB_OT_TAG_GPOS)
    {
      // For GSUB and GPOS tables, use a binary search.
      unsigned int low = 0;
      unsigned int high = 2;
      while (low < high)
      {
        unsigned int mid = (low + high) / 2;
        if (get_feature_stage (mid, hb_tag) < get_feature_stage (mid + 1, hb_tag))
        {
          high = mid;
        }
        else
        {
          low = mid + 1;
        }
      }
      *table_index = low;
    }
    else
    {
      // For other tables, use a linear search.
      for (unsigned int i = 0; i < 2; i++)
      {
        if (tables.arrayZ[i].tag == hb_tag)
        {
          *table_index = i;
          return true;
        }
      }
    }
    return false;
  }