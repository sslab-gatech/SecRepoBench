// Determine the index of the table entry corresponding to the given tag.
// Use the appropriate search method based on table entry size.
unsigned int count = tables.length;
if (count <= 16) {
  // Use linear search for small tables
  for (unsigned int i = 0; i < count; i++) {
    if (tables.arrayZ[i].tag == hb_tag) {
      *table_index = i;
      return true;
    }
  }
} else {
  // Use binary search for larger tables
  int min = 0, max = count - 1;
  while (min <= max) {
    int mid = min + (max - min) / 2;
    hb_tag_t mid_tag = tables.arrayZ[mid].tag;
    if (mid_tag == hb_tag) {
      *table_index = mid;
      return true;
    } else if (mid_tag < hb_tag) {
      min = mid + 1;
    } else {
      max = mid - 1;
    }
  }
}
return false;