if (sizeof(table_entry) == 1) {
      // table_entry is a single byte, so we can use a direct lookup.
      unsigned char index = tag_to_index(hb_tag);
      if (index < table_size) {
        *table_index = index;
        return true;
      } else {
        return false;
      }
    } else {
      // table_entry is larger than a single byte, so we need to use a binary search.
      unsigned int low = 0;
      unsigned int high = table_size - 1;
      while (low <= high) {
        unsigned int mid = low + (high - low) / 2;
        int cmp = compare_tags(hb_tag, table[mid].tag);
        if (cmp == 0) {
          *table_index = mid;
          return true;
        } else if (cmp < 0) {
          high = mid - 1;
        } else {
          low = mid + 1;
        }
      }
      return false;
    }