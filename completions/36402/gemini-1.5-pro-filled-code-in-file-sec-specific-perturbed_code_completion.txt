unsigned int i = 0;
    if (tables.len > 16) {
        // For large number of table entries, use binary search.
        i = tables.bsearch(tag);
    } else {
        // For small number of table entries, use linear search.
        for (; i < tables.len; ++i) {
            if (tables[i].tag == tag) break;
        }
    }

    if (i < tables.len) {
        if (table_index) *table_index = i;
        return true;
    } else {
        if (table_index) *table_index = 0;  // Or some other default value
        return false;
    }