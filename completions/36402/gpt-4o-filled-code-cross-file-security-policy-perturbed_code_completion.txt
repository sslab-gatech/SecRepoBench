unsigned int num_tables = tables.len;
    if (num_tables < 10) // Arbitrary threshold for small collections
    {
      // Use linear search for small collections
      for (unsigned int i = 0; i < num_tables; i++)
      {
        if (tables.arrayZ[i].tag == hb_tag)
        {
          *table_index = i;
          return true;
        }
      }
    }
    else
    {
      // Use binary search for larger collections
      unsigned int low = 0, high = num_tables;
      while (low < high)
      {
        unsigned int mid = (low + high) / 2;
        if (tables.arrayZ[mid].tag < hb_tag)
          low = mid + 1;
        else if (tables.arrayZ[mid].tag > hb_tag)
          high = mid;
        else
        {
          *table_index = mid;
          return true;
        }
      }
    }
    return false;