if (unlikely (hb_tag > HB_OT_TAG_MAX))
      return false;

    if (tables.len <= 16)
    {
      /* Linear search.  Small enough. */
      for (unsigned int i = 0; i < tables.len; i++)
        if (tables[i].tag == hb_tag) {
          *table_index = i;
          return true;
        }
      return false;
    }

    /* Binary search. */
    unsigned int min = 0;
    unsigned int max = tables.len - 1;
    do
    {
      unsigned int mid = (min + max) / 2;
      if (tables[mid].tag < hb_tag)
        min = mid + 1;
      else if (tables[mid].tag > hb_tag)
        max = mid - 1;
      else {
        *table_index = mid;
        return true;
      }
    } while (min <= max);

    return false;