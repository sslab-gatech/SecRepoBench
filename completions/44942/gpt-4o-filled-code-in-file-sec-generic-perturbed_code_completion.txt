struct ndpi_iphdr iph;
  memset(&iph, 0, sizeof(iph));

  // Extract source and destination addresses from the IPv6 header
  memcpy(&iph.saddr, &ipv6_header->ip6_src, sizeof(iph.saddr));
  memcpy(&iph.daddr, &ipv6_header->ip6_dst, sizeof(iph.daddr));

  // Retrieve the protocol type and payload length from the IPv6 header
  u_int8_t l4proto = proto;
  u_int16_t ip_len = ntohs(ipv6_header->ip6_hdr.ip6_un1_plen);

  // Determine the pointer to the layer 4 protocol data by offsetting from the start of the IPv6 header
  const u_int8_t *l4ptr = ((const u_int8_t *)ipv6_header) + sizeof(struct ndpi_ipv6hdr);

  // Handle IPv6 extension headers, adjusting the protocol data pointer, and update the protocol and payload length accordingly
  if (ndpi_handle_ipv6_extension_headers(ipsize - sizeof(struct ndpi_ipv6hdr), &l4ptr, &ip_len, &l4proto) != 0) {
    return NULL;
  }