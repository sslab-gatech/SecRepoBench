struct ndpi_iphdr iph;
memset(&iph, 0, sizeof(iph));

iph.version = 4;
iph.ihl = sizeof(struct ndpi_iphdr) / 4;
iph.saddr = ntohl(ipv6_header->saddr.s6_addr32[3]);
iph.daddr = ntohl(ipv6_header->daddr.s6_addr32[3]);
iph.protocol = l4proto;
iph.tot_len = htons(ipsize);

return(get_ndpi_flow_info(workflow, 6, vlan_id, tunnel_type,
                          &iph, ipv6_header, ip_offset, ipsize,
                          ip_len, l4ptr - (const u_int8_t *)ipv6_header,
                          tcph, udph, sport, dport,
                          proto, payload,
                          payload_len, src_to_dst_direction, when));