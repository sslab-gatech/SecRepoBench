if (copy == NULL) {
    xmlFreeNode(copyNode);
    return NULL;
}
if (copyNode->children == NULL) {
    copyNode->children = copy;
    copyNode->last = copy;
} else {
    copyNode->last->next = copy;
    copy->prev = copyNode->last;
    copyNode->last = copy;
}