if (copy == NULL) {
                xmlFreeNode(clone);
                goto internal_error;
            }

            if (copy->type == XML_ATTRIBUTE_NODE) {
                if (parentClone->properties == NULL) {
                    parentClone->properties = (xmlAttrPtr)copy;
                } else {
                    xmlAttrPtr attrPtr = parentClone->properties;
                    while (attrPtr->next != NULL) {
                        attrPtr = attrPtr->next;
                    }
                    attrPtr->next = (xmlAttrPtr)copy;
                }
            } else {
                if (insert->children == NULL) {
                    insert->children = copy;
                    insert->last = copy;
                } else {
                    insert->last->next = copy;
                    copy->prev = insert->last;
                    insert->last = copy;
                }
            }