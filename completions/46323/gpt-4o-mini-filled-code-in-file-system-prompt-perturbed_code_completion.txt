if (copy == NULL) {
                xmlFree(node);
                return(NULL);
            }
            insert->children = copy;
            insert->last = copy;
            copy->parent = insert;
            copy->next = NULL;
            copy->prev = NULL;
            copy->doc = doc;
            copy->ns = ns;
            copy->type = node->type;
            if (node->name != NULL) {
                copy->name = xmlStrdup(node->name);
            }
            if (node->content != NULL) {
                copy->content = xmlStrdup(node->content);
            }
            if (node->properties != NULL) {
                copy->properties = xmlCopyPropList(copy, node->properties);
            }
            if (node->children != NULL) {
                copy->children = xmlStaticCopyNodeList(node->children, doc, copy);
            }
            if (copy->children != NULL) {
                copy->last = copy->children;
            }
            return copy;