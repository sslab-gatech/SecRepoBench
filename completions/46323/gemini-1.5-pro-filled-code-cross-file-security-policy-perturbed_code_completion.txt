if (copy == NULL) {
                /*
                 * xmlStaticCopyNode() handles entity references and some other
                 * node types by not actually copying them.  So a null return
                 * does not necessarily indicate an error.
                 */
                goto next_sibling;
            }
            if (copy->type == XML_TEXT_NODE) {
                if (insert->last != NULL && insert->last->type == XML_TEXT_NODE) {
                    // Coalesce with previous text node
                    xmlTextConcat(insert->last, copy->content, xmlStrlen(copy->content));
                    xmlFreeNode(copy);
                    goto next_sibling;
                }
            }
            copy->parent = insert;
            if (insert->children == NULL) {
                insert->children = copy;
                insert->last = copy;
            } else {
                if (insert->last->next != NULL) {
                    /*
                     * When a text node immediately precedes an element node,
                     * and the text node is coalesced into a preceding text
                     * node, the following element node's ->next pointer
                     * must be updated.
                     */
                    if (copy->next != NULL) {
                        xmlGenericError(xmlGenericErrorContext,
                            "xmlStaticCopyNode(): copy->next != NULL\n");
                    }
                    copy->next = insert->last->next;
                    insert->last->next->prev = copy;
                } else {
                    copy->next = NULL;
                }
                insert->last->next = copy;
                copy->prev = insert->last;
                insert->last = copy;
            }


next_sibling:;