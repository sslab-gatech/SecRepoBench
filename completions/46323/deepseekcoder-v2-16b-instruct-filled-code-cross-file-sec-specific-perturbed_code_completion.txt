if (copyNode->children != NULL) {
    cur = copyNode->children;
    insert = cur;
    while (cur != NULL) {
        xmlNodePtr copy = xmlStaticCopyNode(cur, doc, insert, 2);
        if (copy == NULL) {
            // Handle the case where the copied node is null.
            // Otherwise, insert the copied node into the list of children of the parent node.
            while (1) {
                if (cur->next != NULL) {
                    cur = cur->next;
                    insert->next = xmlStaticCopyNode(cur, doc, insert, 2);
                    if (insert->next != NULL) {
                        insert = insert->next;
                    }
                    break;
                }

                cur = cur->parent;
                insert = insert->parent;
                if (cur == node) {
                    cur = NULL;
                    break;
                }
            }
        } else {
            insert = copy;
        }
        cur = cur->children;
    }
}