if (copy == NULL) {
    // Handle the case where the copied node is null.
    // Otherwise, insert the copied node into the list of children of the parent node.
    // <MASK>
    if (cur->next != NULL) {
        cur = cur->next;
        insert = insert->next;
    } else {
        cur = cur->parent;
        insert = insert->parent;
    }
    // </MASK>
} else {
    if (cur->children != NULL) {
        cur = cur->children;
        insert = copy;
        continue;
    }

    while (1) {
        if (cur->next != NULL) {
            cur = cur->next;
            break;
        }

        cur = cur->parent;
        insert = insert->parent;
        if (cur == node) {
            cur = NULL;
            break;
        }
    }
}