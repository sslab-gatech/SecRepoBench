DrawInfo
    **graphic_context;

  double
    angle,
    primitive_extent;

  MagickBooleanType
    status;

  PointInfo
    point;

  PrimitiveInfo
    *primitive_info;

  PrimitiveType
    primitive_type;

  register ssize_t
    i,
    x;

  size_t
    length,
    number_points;

  ssize_t
    n;

  StopInfo
    *stops;

  /*
    Set the image clip mask.
  */
  (void) SetImageClipMask(image,draw_info->clip_mask,exception);
  if (image->debug != MagickFalse)
    (void) LogMagickEvent(DrawEvent,GetMagickModule(),"begin draw-image");
  primitive_info=(PrimitiveInfo *) NULL;
  stops=(StopInfo *) NULL;
  n=0;
  graphic_context=(DrawInfo **) AcquireQuantumMemory(1,sizeof(*graphic_context));
  if (graphic_context == (DrawInfo **) NULL)
    {
      ThrowBinaryException(ResourceLimitError,"MemoryAllocationFailed",
        image->filename);
      return(MagickFalse);
    }
  graphic_context[n]=CloneDrawInfo((ImageInfo *) NULL,draw_info);
  if (graphic_context[n] == (DrawInfo *) NULL)
    {
      graphic_context=(DrawInfo **) RelinquishMagickMemory(graphic_context);
      ThrowBinaryException(ResourceLimitError,"MemoryAllocationFailed",
        image->filename);
      return(MagickFalse);
    }
  GetAffineMatrix(&current);
  token=AcquireString(draw_info->primitive);
  primitive=AcquireString(token);
  if (primitive == (char *) NULL)
    {
      for ( ; n >= 0; n--)
        graphic_context[n]=DestroyDrawInfo(graphic_context[n]);
      graphic_context=(DrawInfo **) RelinquishMagickMemory(graphic_context);
      ThrowBinaryException(ResourceLimitError,"MemoryAllocationFailed",
        image->filename);
      return(MagickFalse);
    }
  (void) SetImageArtifact(image,RenderImageTag,primitive);
  status=MagickTrue;
  for (q=(const char *) primitive; *q != '\0'; )
  {
    /*
      Interpret graphic primitive.
    */
    GetNextToken(q,&q,MagickPathExtent,primitive_name);
    if (*primitive_name == '\0')
      break;
    if (image->debug != MagickFalse)
      (void) LogMagickEvent(DrawEvent,GetMagickModule(),primitive_name);
    if (*primitive_name == '#')
      {
        /*
          Comment.
        */
        while ((*(q) != '\n') && (*(q) != '\0'))
          q++;
        continue;
      }