// Interpret graphic primitive.
GetNextToken(q, &q, MagickPathExtent, keyword);
if (*keyword == '\0')
  break;
if (*keyword == '#')
  {
    // Comment.
    if (active!= MagickFalse)
      {
        AffineToTransform(image, &affine);
        active = MagickFalse;
      }
    (void) WriteBlobString(image, "<desc>");
    (void) WriteBlobString(image, keyword + 1);
    for (; (*q!= '\n') && (*q!= '\0'); q++)
      switch (*q)
      {
        case '<': (void) WriteBlobString(image, "&lt;"); break;
        case '>': (void) WriteBlobString(image, "&gt;"); break;
        case '&': (void) WriteBlobString(image, "&amp;"); break;
        default: (void) WriteBlobByte(image, *q); break;
      }
    (void) WriteBlobString(image, "</desc>\n");
    continue;
  }
primitive_type = UndefinedPrimitive;
switch (*keyword)
{
  case ';':
    break;
  case 'a':
  case 'A':
  {
    if (LocaleCompare("affine", keyword) == 0)
      {
        GetNextToken(q, &q, extent, token);
        affine.sx = StringToDouble(token, &next_token);
        GetNextToken(q, &q, extent, token);
        if (*token == ',')
          GetNextToken(q, &q, extent, token);
        affine.rx = StringToDouble(token, &next_token);
        GetNextToken(q, &q, extent, token);
        if (*token == ',')
          GetNextToken(q, &q, extent, token);
        affine.ry = StringToDouble(token, &next_token);
        GetNextToken(q, &q, extent, token);
        if (*token == ',')
          GetNextToken(q, &q, extent, token);
        affine.sy = StringToDouble(token, &next_token);
        GetNextToken(q, &q, extent, token);
        if (*token == ',')
          GetNextToken(q, &q, extent, token);
        affine.tx = StringToDouble(token, &next_token);
        GetNextToken(q, &q, extent, token);
        if (*token == ',')
          GetNextToken(q, &q, extent, token);
        affine.ty = StringToDouble(token, &next_token);
        break;
      }
    if (LocaleCompare("alpha", keyword) == 0)
      {
        primitive_type = AlphaPrimitive;
        break;
      }
    if (LocaleCompare("angle", keyword) == 0)
      {
        GetNextToken(q, &q, extent, token);
        affine.rx = StringToDouble(token, &next_token);
        affine.ry = StringToDouble(token, &next_token);
        break;
      }
    if (LocaleCompare("arc", keyword) == 0)
      {
        primitive_type = ArcPrimitive;
        break;
      }
    status = MagickFalse;
    break;
  }
  case 'b':
  case 'B':
  {
    if (LocaleCompare("bezier", keyword) == 0)
      {
        primitive_type = BezierPrimitive;
        break;
      }
    status = MagickFalse;
    break;
  }
  case 'c':
  case 'C':
  {
    if (LocaleCompare("clip-path", keyword) == 0)
      {
        GetNextToken(q, &q, extent, token);
        (void) FormatLocaleString(message, MagickPathExtent, "clip-path:url(#%s);", token);
        (void) WriteBlobString(image, message);
        break;
      }
    if (LocaleCompare("clip-rule", keyword) == 0)
      {
        GetNextToken(q, &q, extent, token);
        (void) FormatLocaleString(message, MagickPathExtent, "clip-rule:%s;", token);
        (void) WriteBlobString(image, message);
        break;
      }
    if (LocaleCompare("clip-units", keyword) == 0)
      {
        GetNextToken(q, &q, extent, token);
        (void) FormatLocaleString(message, MagickPathExtent, "clipPathUnits=%s;", token);
        (void) WriteBlobString(image, message);
        break;
      }
    if (LocaleCompare("circle", keyword) == 0)
      {
        primitive_type = CirclePrimitive;
        break;
      }
    if (LocaleCompare("color", keyword) == 0)
      {
        primitive_type = ColorPrimitive;
        break;
      }
    status = MagickFalse;
    break;
  }
  case 'd':
  case 'D':
  {
    if (LocaleCompare("decorate", keyword) == 0)
      {
        GetNextToken(q, &q, extent, token);
        (void) FormatLocaleString(message, MagickPathExtent, "text-decoration:%s;", token);
        (void) WriteBlobString(image, message);
        break;
      }
    status = MagickFalse;
    break;
  }
  case 'e':
  case 'E':
  {
    if (LocaleCompare("ellipse", keyword) == 0)
      {
        primitive_type = EllipsePrimitive;
        break;
      }
    status = MagickFalse;
    break;
  }
  case 'f':
  case 'F':
  {
    if (LocaleCompare("fill", keyword) == 0)
      {
        GetNextToken(q, &q, extent, token);
        (void) FormatLocaleString(message, MagickPathExtent, "fill:%s;", token);
        (void) WriteBlobString(image, message);
        break;
      }
    if (LocaleCompare("fill-rule", keyword) == 0)
      {
        GetNextToken(q, &q, extent, token);
        (void) FormatLocaleString(message, MagickPathExtent, "fill-rule:%s;", token);
        (void) WriteBlobString(image, message);
        break;
      }
    if (LocaleCompare("fill-opacity", keyword) == 0)
      {
        GetNextToken(q, &q, extent, token);
        (void) FormatLocaleString(message, MagickPathExtent, "fill-opacity:%s;", token);
        (void) WriteBlobString(image, message);
        break;
      }
    if (LocaleCompare("font-family", keyword) == 0)
      {
        GetNextToken(q, &q, extent, token);
        (void) FormatLocaleString(message, MagickPathExtent, "font-family:%s;", token);
        (void) WriteBlobString(image, message);
        break;
      }
    if (LocaleCompare("font-stretch", keyword) == 0)
      {
        GetNextToken(q, &q, extent, token);
        (void) FormatLocaleString(message, MagickPathExtent, "font-stretch:%s;", token);
        (void) WriteBlobString(image, message);
        break;
      }
    if (LocaleCompare("font-style", keyword) == 0)
      {
        GetNextToken(q, &q, extent, token);
        (void) FormatLocaleString(message, MagickPathExtent, "font-style:%s;", token);
        (void) WriteBlobString(image, message);
        break;
      }
    if (LocaleCompare("font-size", keyword) == 0)
      {
        GetNextToken(q, &q, extent, token);
        (void) FormatLocaleString(message, MagickPathExtent, "font-size:%s;", token);
        (void) WriteBlobString(image, message);
        break;
      }
    if (LocaleCompare("font-weight", keyword) == 0)
      {
        GetNextToken(q, &q, extent, token);
        (void) FormatLocaleString(message, MagickPathExtent, "font-weight:%s;", token);
        (void) WriteBlobString(image, message);
        break;
      }
    status = MagickFalse;
    break;
  }
  case 'g':
  case 'G':
  {
    if (LocaleCompare("gradient-units", keyword) == 0)
      {
        GetNextToken(q, &q, extent, token);
        break;
      }
    if (LocaleCompare("text-align", keyword) == 0)
      {
        GetNextToken(q, &q, extent, token);
        (void) FormatLocaleString(message, MagickPathExtent, "text-align %s ", token);
        (void) WriteBlobString(image, message);
        break;
      }
    if (LocaleCompare("text-anchor", keyword) == 0)
      {
        GetNextToken(q, &q, extent, token);
        (void) FormatLocaleString(message, MagickPathExtent, "text-anchor %s ", token);
        (void) WriteBlobString(image, message);
        break;
      }
    status = MagickFalse;
    break;
  }
  case 'i':
  case 'I':
  {
    if (LocaleCompare("image", keyword) == 0)
      {
        GetNextToken(q, &q, extent, token);
        primitive_type = ImagePrimitive;
        break;
      }
    status = MagickFalse;
    break;
  }
  case 'l':
  case 'L':
  {
    if (LocaleCompare("line", keyword) == 0)
      {
        primitive_type = LinePrimitive;
        break;
      }
    status = MagickFalse;
    break;
  }
  case 'o':
  case 'O':
  {
    if (LocaleCompare("opacity", keyword) == 0)
      {
        GetNextToken(q, &q, extent, token);
        (void) FormatLocaleString(message, MagickPathExtent, "opacity %s ", token);
        (void) WriteBlobString(image, message);
        break;
      }
    status = MagickFalse;
    break;
  }
  case 'p':
  case 'P':
  {
    if (LocaleCompare("path", keyword) == 0)
      {
        primitive_type = PathPrimitive;
        break;
      }
    if (LocaleCompare("point", keyword) == 0)
      {
        primitive_type = PointPrimitive;
        break;
      }
    if (LocaleCompare("polyline", keyword) == 0)
      {
        primitive_type = PolylinePrimitive;
        break;
      }
    if (LocaleCompare("polygon", keyword) == 0)
      {
        primitive_type = PolygonPrimitive;
        break;
      }
    if (LocaleCompare("pop", keyword) == 0)
      {
        GetNextToken(q, &q, extent, token);
        if (LocaleCompare("clip-path", token) == 0)
          {
            (void) WriteBlobString(image, "</clipPath>\n");
            break;
          }
        if (LocaleCompare("defs", token) == 0)
          {
            (void) WriteBlobString(image, "</defs>\n");
            break;
          }
        if (LocaleCompare("gradient", token) == 0)
          {
            (void) FormatLocaleString(message, MagickPathExtent, "</%sGradient>\n", type);
            (void) WriteBlobString(image, message);
            break;
          }
        if (LocaleCompare("graphic-context", token) == 0)
          {
            n--;
            if (n < 0)
              ThrowWriterException(DrawError, "UnbalancedGraphicContextPushPop");
            (void) WriteBlobString(image, "</g>\n");
          }
        if (LocaleCompare("pattern", token) == 0)
          {
            (void) WriteBlobString(image, "</pattern>\n");
            break;
          }
        if (LocaleCompare("symbol", token) == 0)
          {
            (void) WriteBlobString(image, "</symbol>\n");
            break;
          }
        if ((LocaleCompare("defs", token) == 0) || (LocaleCompare("symbol", token) == 0))
          (void) WriteBlobString(image, "</g>\n");
        break;
      }
    if (LocaleCompare("push", keyword) == 0)
      {
        GetNextToken(q, &q, extent, token);
        if (LocaleCompare("clip-path", token) == 0)
          {
            GetNextToken(q, &q, extent, token);
            (void) FormatLocaleString(message, MagickPathExtent, "<clipPath id=\"%s\">\n", token);
            (void) WriteBlobString(image, message);
            break;
          }
        if (LocaleCompare("defs", token) == 0)
          {
            (void) WriteBlobString(image, "<defs>\n");
            break;
          }
        if (LocaleCompare("gradient", token) == 0)
          {
            GetNextToken(q, &q, extent, token);
            (void) CopyMagickString(name, token, MagickPathExtent);
            GetNextToken(q, &q, extent, token);
            (void) CopyMagickString(type, token, MagickPathExtent);
            GetNextToken(q, &q, extent, token);
            svg_info.segment.x1 = StringToDouble(token, &next_token);
            svg_info.element.cx = StringToDouble(token, &next_token);
            GetNextToken(q, &q, extent, token);
            if (*token == ',')
              GetNextToken(q, &q, extent, token);
            svg_info.segment.y1 = StringToDouble(token, &next_token);
            svg_info.element.cy = StringToDouble(token, &next_token);
            GetNextToken(q, &q, extent, token);
            if (*token == ',')
              GetNextToken(q, &q, extent, token);
            svg_info.segment.x2 = StringToDouble(token, &next_token);
            svg_info.element.major = StringToDouble(token, (char **)NULL);
            GetNextToken(q, &q, extent, token);
            if (*token == ',')
              GetNextToken(q, &q, extent, token);
            svg_info.segment.y2 = StringToDouble(token, &next_token);
            svg_info.element.minor = StringToDouble(token, (char **)NULL);
            (void) FormatLocaleString(message, MagickPathExtent, "<%sGradient id=\"%s\" x1=\"%g\" y1=\"%g\" x2=\"%g\" y2=\"%g\">\n", type, name, svg_info.segment.x1, svg_info.segment.y1, svg_info.segment.x2, svg_info.segment.y2);
            if (LocaleCompare(type, "ra