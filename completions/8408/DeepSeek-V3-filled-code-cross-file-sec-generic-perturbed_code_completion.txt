DrawInfo
    **graphic_context;

  GradientInfo
    *gradient;

  MagickBooleanType
    status;

  PointInfo
    point;

  PolygonInfo
    *polygon_info;

  PrimitiveInfo
    *primitive_info;

  register ssize_t
    n;

  StopInfo
    *stops;

  assert(image != (Image *) NULL);
  assert(image->signature == MagickCoreSignature);
  if (draw_info == (const DrawInfo *) NULL)
    return(MagickFalse);
  assert(draw_info->signature == MagickCoreSignature);
  if (exception != (ExceptionInfo *) NULL)
    assert(exception->signature == MagickCoreSignature);
  if (image->debug != MagickFalse)
    (void) LogMagickEvent(DrawEvent,GetMagickModule(),"begin draw-image");
  status=MagickTrue;
  primitive_info=(PrimitiveInfo *) NULL;
  stops=(StopInfo *) NULL;
  gradient=(GradientInfo *) NULL;
  polygon_info=(PolygonInfo *) NULL;
  graphic_context=(DrawInfo **) AcquireQuantumMemory(MaxGraphicsContext,
    sizeof(*graphic_context));
  if (graphic_context == (DrawInfo **) NULL)
    ThrowBinaryException(ResourceLimitError,"MemoryAllocationFailed",
      primitive_name);
  for (n=0; n < MaxGraphicsContext; n++)
    graphic_context[n]=(DrawInfo *) NULL;
  n=(-1);
  GetAffineMatrix(&affine);
  GetAffineMatrix(&current);
  token=AcquireString(draw_info->primitive);
  primitive=token;
  while ((token != (char *) NULL) && (*token != '\0'))
  {
    GetNextToken(token,&token,MagickPathExtent,primitive_name);
    if (*primitive_name == '\0')
      break;
    if (*primitive_name == '#')
      continue;
    if (LocaleCompare(primitive_name,"pop") == 0)
      {
        if (n < 0)
          {
            status=MagickFalse;
            break;
          }
        graphic_context[n]=DestroyDrawInfo(graphic_context[n]);
        n--;
        continue;
      }
    if (LocaleCompare(primitive_name,"push") == 0)
      {
        n++;
        if (n >= MaxGraphicsContext)
          {
            status=MagickFalse;
            break;
          }
        graphic_context[n]=CloneDrawInfo((ImageInfo *) NULL,draw_info);
        continue;
      }
    if (LocaleCompare(primitive_name,"affine") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        affine.sx=StringToDouble(geometry,&next_token);
        GetNextToken(token,&token,MagickPathExtent,geometry);
        if (*geometry == ',')
          GetNextToken(token,&token,MagickPathExtent,geometry);
        affine.rx=StringToDouble(geometry,&next_token);
        GetNextToken(token,&token,MagickPathExtent,geometry);
        if (*geometry == ',')
          GetNextToken(token,&token,MagickPathExtent,geometry);
        affine.ry=StringToDouble(geometry,&next_token);
        GetNextToken(token,&token,MagickPathExtent,geometry);
        if (*geometry == ',')
          GetNextToken(token,&token,MagickPathExtent,geometry);
        affine.sy=StringToDouble(geometry,&next_token);
        GetNextToken(token,&token,MagickPathExtent,geometry);
        if (*geometry == ',')
          GetNextToken(token,&token,MagickPathExtent,geometry);
        affine.tx=StringToDouble(geometry,&next_token);
        GetNextToken(token,&token,MagickPathExtent,geometry);
        if (*geometry == ',')
          GetNextToken(token,&token,MagickPathExtent,geometry);
        affine.ty=StringToDouble(geometry,&next_token);
        continue;
      }
    if (LocaleCompare(primitive_name,"translate") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        affine.tx=StringToDouble(geometry,&next_token);
        GetNextToken(token,&token,MagickPathExtent,geometry);
        if (*geometry == ',')
          GetNextToken(token,&token,MagickPathExtent,geometry);
        affine.ty=StringToDouble(geometry,&next_token);
        continue;
      }
    if (LocaleCompare(primitive_name,"rotate") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        affine.rx=StringToDouble(geometry,&next_token);
        affine.ry=StringToDouble(geometry,&next_token);
        continue;
      }
    if (LocaleCompare(primitive_name,"scale") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        affine.sx=StringToDouble(geometry,&next_token);
        GetNextToken(token,&token,MagickPathExtent,geometry);
        if (*geometry == ',')
          GetNextToken(token,&token,MagickPathExtent,geometry);
        affine.sy=StringToDouble(geometry,&next_token);
        continue;
      }
    if (LocaleCompare(primitive_name,"skewX") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        affine.rx=StringToDouble(geometry,&next_token);
        continue;
      }
    if (LocaleCompare(primitive_name,"skewY") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        affine.ry=StringToDouble(geometry,&next_token);
        continue;
      }
    if (LocaleCompare(primitive_name,"matrix") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        affine.sx=StringToDouble(geometry,&next_token);
        GetNextToken(token,&token,MagickPathExtent,geometry);
        if (*geometry == ',')
          GetNextToken(token,&token,MagickPathExtent,geometry);
        affine.rx=StringToDouble(geometry,&next_token);
        GetNextToken(token,&token,MagickPathExtent,geometry);
        if (*geometry == ',')
          GetNextToken(token,&token,MagickPathExtent,geometry);
        affine.ry=StringToDouble(geometry,&next_token);
        GetNextToken(token,&token,MagickPathExtent,geometry);
        if (*geometry == ',')
          GetNextToken(token,&token,MagickPathExtent,geometry);
        affine.sy=StringToDouble(geometry,&next_token);
        GetNextToken(token,&token,MagickPathExtent,geometry);
        if (*geometry == ',')
          GetNextToken(token,&token,MagickPathExtent,geometry);
        affine.tx=StringToDouble(geometry,&next_token);
        GetNextToken(token,&token,MagickPathExtent,geometry);
        if (*geometry == ',')
          GetNextToken(token,&token,MagickPathExtent,geometry);
        affine.ty=StringToDouble(geometry,&next_token);
        continue;
      }
    if (LocaleCompare(primitive_name,"color") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        if (IsGeometry(geometry) == MagickFalse)
          {
            status=MagickFalse;
            break;
          }
        GetNextToken(token,&token,MagickPathExtent,pattern);
        if (LocaleCompare(pattern,"point") == 0)
          status=DrawPointPrimitive(image,draw_info,primitive_info,exception);
        else if (LocaleCompare(pattern,"replace") == 0)
          status=DrawPointPrimitive(image,draw_info,primitive_info,exception);
        else if (LocaleCompare(pattern,"floodfill") == 0)
          status=DrawPointPrimitive(image,draw_info,primitive_info,exception);
        else if (LocaleCompare(pattern,"filltoborder") == 0)
          status=DrawPointPrimitive(image,draw_info,primitive_info,exception);
        else if (LocaleCompare(pattern,"reset") == 0)
          status=DrawPointPrimitive(image,draw_info,primitive_info,exception);
        else
          status=DrawPointPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"matte") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        if (IsGeometry(geometry) == MagickFalse)
          {
            status=MagickFalse;
            break;
          }
        GetNextToken(token,&token,MagickPathExtent,pattern);
        if (LocaleCompare(pattern,"point") == 0)
          status=DrawPointPrimitive(image,draw_info,primitive_info,exception);
        else if (LocaleCompare(pattern,"replace") == 0)
          status=DrawPointPrimitive(image,draw_info,primitive_info,exception);
        else if (LocaleCompare(pattern,"floodfill") == 0)
          status=DrawPointPrimitive(image,draw_info,primitive_info,exception);
        else if (LocaleCompare(pattern,"filltoborder") == 0)
          status=DrawPointPrimitive(image,draw_info,primitive_info,exception);
        else if (LocaleCompare(pattern,"reset") == 0)
          status=DrawPointPrimitive(image,draw_info,primitive_info,exception);
        else
          status=DrawPointPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"text") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        if (IsGeometry(geometry) == MagickFalse)
          {
            status=MagickFalse;
            break;
          }
        GetNextToken(token,&token,MagickPathExtent,pattern);
        status=DrawTextPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"image") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        if (IsGeometry(geometry) == MagickFalse)
          {
            status=MagickFalse;
            break;
          }
        GetNextToken(token,&token,MagickPathExtent,pattern);
        status=DrawImagePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"path") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPathPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"polyline") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPolylinePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"polygon") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPolygonPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"point") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPointPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"line") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawLinePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"rectangle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawRectanglePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"roundRectangle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawRoundRectanglePrimitive(image,draw_info,primitive_info,
          exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"arc") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawArcPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"ellipse") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawEllipsePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"circle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawCirclePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"bezier") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawBezierPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"color") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawColorPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"matte") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawMattePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"text") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawTextPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"image") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawImagePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"path") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPathPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"polyline") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPolylinePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"polygon") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPolygonPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"point") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPointPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"line") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawLinePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"rectangle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawRectanglePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"roundRectangle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawRoundRectanglePrimitive(image,draw_info,primitive_info,
          exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"arc") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawArcPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"ellipse") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawEllipsePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"circle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawCirclePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"bezier") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawBezierPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"color") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawColorPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"matte") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawMattePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"text") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawTextPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"image") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawImagePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"path") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPathPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"polyline") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPolylinePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"polygon") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPolygonPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"point") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPointPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"line") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawLinePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"rectangle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawRectanglePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"roundRectangle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawRoundRectanglePrimitive(image,draw_info,primitive_info,
          exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"arc") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawArcPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"ellipse") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawEllipsePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"circle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawCirclePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"bezier") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawBezierPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"color") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawColorPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"matte") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawMattePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"text") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawTextPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"image") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawImagePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"path") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPathPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"polyline") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPolylinePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"polygon") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPolygonPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"point") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPointPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"line") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawLinePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"rectangle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawRectanglePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"roundRectangle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawRoundRectanglePrimitive(image,draw_info,primitive_info,
          exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"arc") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawArcPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"ellipse") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawEllipsePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"circle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawCirclePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"bezier") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawBezierPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"color") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawColorPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"matte") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawMattePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"text") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawTextPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"image") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawImagePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"path") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPathPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"polyline") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPolylinePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"polygon") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPolygonPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"point") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPointPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"line") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawLinePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"rectangle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawRectanglePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"roundRectangle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawRoundRectanglePrimitive(image,draw_info,primitive_info,
          exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"arc") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawArcPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"ellipse") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawEllipsePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"circle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawCirclePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"bezier") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawBezierPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"color") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawColorPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"matte") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawMattePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"text") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawTextPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"image") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawImagePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"path") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPathPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"polyline") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPolylinePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"polygon") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPolygonPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"point") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPointPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"line") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawLinePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"rectangle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawRectanglePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"roundRectangle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawRoundRectanglePrimitive(image,draw_info,primitive_info,
          exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"arc") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawArcPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"ellipse") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawEllipsePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"circle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawCirclePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"bezier") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawBezierPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"color") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawColorPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"matte") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawMattePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"text") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawTextPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"image") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawImagePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"path") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPathPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"polyline") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPolylinePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"polygon") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPolygonPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"point") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPointPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"line") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawLinePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"rectangle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawRectanglePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"roundRectangle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawRoundRectanglePrimitive(image,draw_info,primitive_info,
          exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"arc") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawArcPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"ellipse") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawEllipsePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"circle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawCirclePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"bezier") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawBezierPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"color") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawColorPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"matte") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawMattePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"text") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawTextPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"image") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawImagePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"path") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPathPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"polyline") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPolylinePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"polygon") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPolygonPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"point") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPointPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"line") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawLinePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"rectangle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawRectanglePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"roundRectangle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawRoundRectanglePrimitive(image,draw_info,primitive_info,
          exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"arc") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawArcPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"ellipse") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawEllipsePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"circle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawCirclePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"bezier") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawBezierPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"color") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawColorPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"matte") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawMattePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"text") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawTextPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"image") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawImagePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"path") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPathPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"polyline") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPolylinePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"polygon") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPolygonPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"point") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPointPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"line") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawLinePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"rectangle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawRectanglePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"roundRectangle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawRoundRectanglePrimitive(image,draw_info,primitive_info,
          exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"arc") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawArcPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"ellipse") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawEllipsePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"circle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawCirclePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"bezier") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawBezierPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"color") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawColorPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"matte") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawMattePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"text") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawTextPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"image") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawImagePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"path") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPathPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"polyline") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPolylinePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"polygon") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPolygonPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"point") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPointPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"line") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawLinePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"rectangle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawRectanglePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"roundRectangle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawRoundRectanglePrimitive(image,draw_info,primitive_info,
          exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"arc") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawArcPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"ellipse") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawEllipsePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"circle") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawCirclePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"bezier") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawBezierPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"color") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawColorPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"matte") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawMattePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"text") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawTextPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"image") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawImagePrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"path") == 0)
      {
        GetNextToken(token,&token,MagickPathExtent,geometry);
        status=DrawPathPrimitive(image,draw_info,primitive_info,exception);
        continue;
      }
    if (LocaleCompare(primitive_name,"polyline") == 0)
      {
        GetNextToken(token,&token,MagickPathEx