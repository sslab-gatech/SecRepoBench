for (index = 0; index < ptr->sampleCount; ) {
    if (ptr->sampleSize == 4) {
        // Compact sizes, 2 samples per byte
        u8 byte = gf_bs_read_u8(bs);
        for (u8 i = 0; i < 2; i++) {
            if (index < ptr->sampleCount) {
                ptr->sizes[index] = (byte >> (i * 4)) & 0xF;
                index++;
            }
        }
        // Check if there's a padding byte
        if (index < ptr->sampleCount) {
            gf_bs_read_u8(bs);
            index++;
        }
    } else {
        // Regular sizes
        ptr->sizes[index] = gf_bs_read_u32(bs);
        index++;
    }
}