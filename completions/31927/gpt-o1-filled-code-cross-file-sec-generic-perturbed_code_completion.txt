switch (ptr->sampleSize) {
			case 4:
			{
				u8 data = gf_bs_read_u8(bs);
				u32 valHigh = (data >> 4);
				ptr->sizes[index] = valHigh;
				if (ptr->max_size < valHigh) ptr->max_size = valHigh;
				ptr->total_size += valHigh;
				ptr->total_samples++;
				index++;
				if (index < ptr->sampleCount) {
					u32 valLow = (data & 0x0F);
					ptr->sizes[index] = valLow;
					if (ptr->max_size < valLow) ptr->max_size = valLow;
					ptr->total_size += valLow;
					ptr->total_samples++;
					index++;
				}
			}
			break;

			case 8:
			{
				u32 val = gf_bs_read_u8(bs);
				ptr->sizes[index] = val;
				if (ptr->max_size < val) ptr->max_size = val;
				ptr->total_size += val;
				ptr->total_samples++;
				index++;
			}
			break;

			case 16:
			{
				u32 val = gf_bs_read_u16(bs);
				ptr->sizes[index] = val;
				if (ptr->max_size < val) ptr->max_size = val;
				ptr->total_size += val;
				ptr->total_samples++;
				index++;
			}
			break;

			default:
				/* Unsupported compact size - should not happen given checks above */
				return GF_ISOM_INVALID_FILE;
			}