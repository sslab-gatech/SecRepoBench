{
  size_t bracket_level=0;
  char start_bracket, end_bracket;

  if ((*(p+1) == '[') || (*(p+1) == '{'))
    p++;
  if ((*p == '[') || (*p == '{'))
    {
      start_bracket = *p;
      end_bracket = (start_bracket == '[') ? ']' : '}';
      bracket_level++;
      q=subexpression;
      for (p++; *p != '\0'; p++)
      {
        if (*p == start_bracket)
          bracket_level++;
        else if (*p == end_bracket)
          {
            bracket_level--;
            if (bracket_level == 0)
              break;
          }
        *q++=(*p);
      }
      *q='\0';
      if (*p != '\0')
        p++;
      alpha=FxEvaluateSubexpression(fx_info,pixchannel,x,y,subexpression,&depth,&beta,exception);
      point.x=alpha;
      point.y=beta;
    }
  if (*p == '.')
    p++;
}