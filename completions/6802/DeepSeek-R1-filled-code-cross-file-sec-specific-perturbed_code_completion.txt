p++;
        if ((*p == '{') || (*p == '['))
          {
            char
              closing;

            closing=(*p == '{') ? '}' : ']';
            level=1;
            q=subexpression;
            for (p++; *p != '\0'; )
            {
              if (q >= (subexpression+MagickPathExtent-1))
                break;
              if (*p == *expression)
                level++;
              else if (*p == closing)
                {
                  level--;
                  if (level == 0)
                    break;
                }
              *q++=(*p++);
            }
            *q='\0';
            if (*p == closing)
              p++;
            alpha=FxEvaluateSubexpression(fx_info,pixchannel,x,y,subexpression,
              &depth,&beta,exception);
            point.x=alpha;
            point.y=beta;
            if (*p == '.')
              p++;
          }