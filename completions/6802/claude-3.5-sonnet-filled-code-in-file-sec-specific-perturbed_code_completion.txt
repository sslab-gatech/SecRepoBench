if ((*p == 'p') && (isalpha((int) ((unsigned char) *(p+1))) == 0))
{
  if (*p == '{')
  {
    level++;
    q = subexpression;
    for (p++; *p != '\0'; p++)
    {
      if (*p == '{')
        level++;
      else if (*p == '}')
      {
        level--;
        if (level == 0)
          break;
      }
      *q++ = *p;
    }
    *q = '\0';
  }
  else if (*p == '[')
  {
    level++;
    q = subexpression;
    for (p++; *p != '\0'; p++)
    {
      if (*p == '[')
        level++;
      else if (*p == ']')
      {
        level--;
        if (level == 0)
          break;
      }
      *q++ = *p;
    }
    *q = '\0';
  }
  else
  {
    ThrowMagickException(exception, GetMagickModule(), OptionError,
      "UnableToParseExpression", "`%s'", expression);
    return(0.0);
  }
  alpha = FxEvaluateSubexpression(fx_info, channel, x, y, subexpression,
    depth, beta, exception);
  point.x = alpha;
  point.y = *beta;
  p++;
}