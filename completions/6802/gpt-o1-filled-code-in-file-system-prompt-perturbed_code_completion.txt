{
  /*
    We expect a bracketed or braced pair of expressions after 'p', e.g. p[x,y] or p{x,y}.
    Parse them and assign the two evaluated results to point.x and point.y. 
  */
  if ((*p == '[') || (*p == '{'))
  {
    size_t level = 1;
    char *r = subexpression;
    /* Capture the opening bracket/brace */
    *r++ = *p++;
    /* Gather everything until the matching bracket/brace is closed */
    for ( ; (*p != '\0') && (level > 0); p++)
    {
      if ((*p == '[') || (*p == '{'))
        level++;
      else if ((*p == ']') || (*p == '}'))
        level--;
      *r++ = *p;
    }
    *r = '\0'; /* Null-terminate the subexpression. */

    /* Evaluate the subexpression to get our two coordinate values. */
    {
      /* Evaluate first part (x-coordinate). */
      double gamma;
      point.x = FxEvaluateSubexpression(fx_info,pixchannel,x,y,subexpression,&depth,&gamma,exception);
      /* If a comma remains, parse the second part (y-coordinate). */
      r = strchr(subexpression, ',');
      if ((r != (char *) NULL) && (r < (subexpression + (strlen(subexpression) - 1))))
      {
        /* Shift past the comma and evaluate second expression. */
        point.y = FxEvaluateSubexpression(fx_info,pixchannel,x,y,r + 1,&depth,&gamma,exception);
      }
      else
        /* If no comma found, assume y = x. */
        point.y = point.x;
    }

    /* Move p forward if needed (p was left after a closing bracket/brace). */
    if (*p != '\0')
      p--;
  }
}