level++;
q=subexpression;
if (*p == '{')
{
  for (p++; *p != '\0'; )
  {
    if (*p == '{')
      level++;
    else
      if (*p == '}')
        {
          level--;
          if (level == 0)
            break;
        }
    *q++=(*p++);
  }
}
else
{
  for (p++; *p != '\0'; )
  {
    if (*p == '[')
      level++;
    else
      if (*p == ']')
        {
          level--;
          if (level == 0)
            break;
        }
    *q++=(*p++);
  }
}
*q='\0';
alpha=FxEvaluateSubexpression(fx_info,pixchannel,x,y,subexpression,
  &depth,&beta,exception);
point.x=(double) alpha;
point.y=(double) beta;
p++;