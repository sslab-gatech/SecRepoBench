if (*p == '{')
            {
              level++;
              q=subexpression;
              for (p++; *p != '\0'; )
              {
                if (*p == '{')
                  level++;
                else
                  if (*p == '}')
                    {
                      level--;
                      if (level == 0)
                        break;
                    }
                *q++=(*p++);
              }
              *q='\0';
              if (*p != '}')
                {
                  (void) ThrowMagickException(exception,GetMagickModule(),
                    OptionError,"UnbalancedParenthesis","`%s'",expression);
                  return(0.0);
                }
              p++;
            }
          else
            {
              level++;
              q=subexpression;
              for (p++; *p != '\0'; )
              {
                if (*p == '[')
                  level++;
                else
                  if (*p == ']')
                    {
                      level--;
                      if (level == 0)
                        break;
                    }
                *q++=(*p++);
              }
              *q='\0';
              if (*p != ']')
                {
                  (void) ThrowMagickException(exception,GetMagickModule(),
                    OptionError,"UnbalancedParenthesis","`%s'",expression);
                  return(0.0);
                }
              p++;
            }
          point.x=FxEvaluateSubexpression(fx_info,pixchannel,x,y,
            subexpression,&depth,&beta,exception);
          if (*p == ',')
            {
              p++;
              if (*p == '{')
                {
                  level++;
                  q=subexpression;
                  for (p++; *p != '\0'; )
                  {
                    if (*p == '{')
                      level++;
                    else
                      if (*p == '}')
                        {
                          level--;
                          if (level == 0)
                            break;
                        }
                    *q++=(*p++);
                  }
                  *q='\0';
                  if (*p != '}')
                    {
                      (void) ThrowMagickException(exception,
                        GetMagickModule(),OptionError,"UnbalancedParenthesis",
                        "`%s'",expression);
                      return(0.0);
                    }
                  p++;
                }
              else
                {
                  level++;
                  q=subexpression;
                  for (p++; *p != '\0'; )
                  {
                    if (*p == '[')
                      level++;
                    else
                      if (*p == ']')
                        {
                          level--;
                          if (level == 0)
                            break;
                        }
                    *q++=(*p++);
                  }
                  *q='\0';
                  if (*p != ']')
                    {
                      (void) ThrowMagickException(exception,
                        GetMagickModule(),OptionError,"UnbalancedParenthesis",
                        "`%s'",expression);
                      return(0.0);
                    }
                  p++;
                }
              point.y=FxEvaluateSubexpression(fx_info,pixchannel,x,y,
                subexpression,&depth,&beta,exception);
            }
          else
            point.y=point.x;