if (payload_len < 4) {
    return -1;
  }
  tuple_count = ntohl(*((u_int32_t *)payload));
  if (tuple_count == 0) {
    return -1;
  }
  payload += 4;
  payload_len -= 4;
  u_int8_t *hostname = NULL;
  u_int8_t *fqdn = NULL;
  size_t hostname_len = 0;
  size_t fqdn_len = 0;
  for (u_int32_t i = 0; i < tuple_count; i++) {
    if (payload_len < 4) {
      return -1;
    }
    u_int32_t tuple_len = ntohl(*((u_int32_t *)payload));
    payload += 4;
    payload_len -= 4;
    if (payload_len < tuple_len) {
      return -1;
    }
    u_int8_t *tuple_payload = payload;
    if (tuple_payload[0] == 0x01) { // host_name
      hostname_len = tuple_len - 1;
      hostname = (u_int8_t *)malloc(hostname_len + 1);
      if (hostname == NULL) {
        return -1;
      }
      memcpy(hostname, tuple_payload + 1, hostname_len);
      hostname[hostname_len] = '\0';
    } else if (tuple_payload[0] == 0x02) { // ddns_fqdn
      fqdn_len = tuple_len - 1;
      fqdn = (u_int8_t *)malloc(fqdn_len + 1);
      if (fqdn == NULL) {
        return -1;
      }
      memcpy(fqdn, tuple_payload + 1, fqdn_len);
      fqdn[fqdn_len] = '\0';
    }
    payload += tuple_len;
    payload_len -= tuple_len;
  }
  if (payload_len > 0) {
    return -1;
  }
  if (hostname != NULL) {
    strncpy(ndpiflow->protos.softether.hostname, (char *)hostname, sizeof(ndpiflow->protos.softether.hostname) - 1);
    ndpiflow->protos.softether.hostname[sizeof(ndpiflow->protos.softether.hostname) - 1] = '\0';
    free(hostname);
  }
  if (fqdn != NULL) {
    strncpy(ndpiflow->protos.softether.fqdn, (char *)fqdn, sizeof(ndpiflow->protos.softether.fqdn) - 1);
    ndpiflow->protos.softether.fqdn[sizeof(ndpiflow->protos.softether.fqdn) - 1] = '\0';
    free(fqdn);
  }