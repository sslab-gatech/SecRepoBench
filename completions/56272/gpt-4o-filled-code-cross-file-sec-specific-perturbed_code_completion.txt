if (payload == NULL || ndpiflow == NULL) {
    return -1; // Error: Null pointer detected
  }

  if (payload_len < sizeof(u_int32_t)) {
    return -1; // Error: Payload length is insufficient
  }

  tuple_count = *((u_int32_t *)payload);
  payload += sizeof(u_int32_t);
  payload_len -= sizeof(u_int32_t);

  if (tuple_count == 0 || payload_len == 0) {
    return -1; // Error: Invalid tuple count or payload length
  }

  // Process tuples
  for (u_int32_t i = 0; i < tuple_count; i++) {
    if (payload_len < sizeof(u_int8_t)) {
      return -1; // Error: Insufficient payload length for tuple
    }

    u_int8_t identifier = *payload;
    payload += sizeof(u_int8_t);
    payload_len -= sizeof(u_int8_t);

    // Check for host_name or ddns_fqdn identifiers
    if (identifier == HOST_NAME_IDENTIFIER) {
      if (payload_len < HOST_NAME_LENGTH) {
        return -1; // Error: Insufficient payload length for host name
      }
      memcpy(ndpiflow->protos.softether.hostname, payload, HOST_NAME_LENGTH);
      payload += HOST_NAME_LENGTH;
      payload_len -= HOST_NAME_LENGTH;
    } else if (identifier == DDNS_FQDN_IDENTIFIER) {
      if (payload_len < FQDN_LENGTH) {
        return -1; // Error: Insufficient payload length for FQDN
      }
      memcpy(ndpiflow->protos.softether.fqdn, payload, FQDN_LENGTH);
      payload += FQDN_LENGTH;
      payload_len -= FQDN_LENGTH;
    } else {
      // Skip unknown identifier
      if (payload_len < UNKNOWN_IDENTIFIER_LENGTH) {
        return -1; // Error: Insufficient payload length for unknown identifier
      }
      payload += UNKNOWN_IDENTIFIER_LENGTH;
      payload_len -= UNKNOWN_IDENTIFIER_LENGTH;
    }
  }

  if (payload_len != 0) {
    return -1; // Error: Unprocessed data remains
  }