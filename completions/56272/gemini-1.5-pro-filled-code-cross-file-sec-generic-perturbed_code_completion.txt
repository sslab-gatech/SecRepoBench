if (payload_len < sizeof(u_int32_t)) {
    return 1;
  }
  tuple_count = ntohl(*(u_int32_t const *)payload);
  payload += sizeof(u_int32_t);
  payload_len -= sizeof(u_int32_t);

  if (tuple_count * 2 * sizeof(u_int32_t) > payload_len) {
    return 1;
  }

  for (u_int32_t i = 0; i < tuple_count; i++) {
    if (payload_len < 2 * sizeof(u_int32_t)) {
      return 1;
    }
    u_int32_t type = ntohl(*(u_int32_t const *)payload);
    payload += sizeof(u_int32_t);
    payload_len -= sizeof(u_int32_t);
    u_int32_t len = ntohl(*(u_int32_t const *)payload);
    payload += sizeof(u_int32_t);
    payload_len -= sizeof(u_int32_t);

    if (payload_len < len) {
      return 1;
    }

    if (type == 1) { // host_name
      if (len >= sizeof(ndpiflow->protos.softether.hostname)) {
        return 1;
      }
      memcpy(ndpiflow->protos.softether.hostname, payload, len);
      ndpiflow->protos.softether.hostname[len] = '\0';
    } else if (type == 2) { // ddns_fqdn
      if (len >= sizeof(ndpiflow->protos.softether.fqdn)) {
        return 1;
      }
      memcpy(ndpiflow->protos.softether.fqdn, payload, len);
      ndpiflow->protos.softether.fqdn[len] = '\0';
    }

    payload += len;
    payload_len -= len;
  }

  if (payload_len != 0) {
    return 1;
  }