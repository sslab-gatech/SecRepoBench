static int dissect_softether_host_fqdn(struct ndpi_flow_struct *ndpiflow,
                                       struct ndpi_packet_struct const *packet) {
  u_int8_t const *payload = packet->payload;
  u_int16_t payload_len = packet->payload_packet_len;
  u_int32_t tuple_count;
  struct softether_value first_value, second_value;
  size_t value_siz;
  size_t const tuple_type_len = 8;

  if(payload_len < tuple_type_len)
    return 1;

  if(softether_type_to_enum(ntohl(get_u_int32_t(payload, 0)), &first_value.type)!= 0 ||
     softether_type_to_enum(ntohl(get_u_int32_t(payload, 4)), &second_value.type)!= 0)
    return 1;

  payload += tuple_type_len;
  payload_len -= tuple_type_len;

  value_siz = dissect_softether_type(first_value.type, &first_value, payload, payload_len);

  payload += value_siz;
  payload_len -= value_siz;

  if(first_value.type == VALUE_STR && first_value.value.ptr.value_str!= NULL) {
    if(strncmp(first_value.value.ptr.value_str, "host_name", NDPI_STATICSTRING_LEN("host_name")) == 0) {
      if(payload_len < 4)
        return 1;

      u_int32_t siz = ntohl(get_u_int32_t(payload, 0));
      if(siz == 0 || (u_int64_t)payload_len < (u_int64_t)siz + sizeof(siz))
        return 1;

      if(siz > 0) {
        first_value.value_size = siz;
        strncpy(ndpiflow->protos.softether.hostname, (char const *)payload + 4, siz);
        ndpiflow->protos.softether.hostname[siz] = '\0';
      }
    } else if(strncmp(first_value.value.ptr.value_str, "ddns_fqdn", NDPI_STATICSTRING_LEN("ddns_fqdn")) == 0) {
      if(payload_len < 4)
        return 1;

      u_int32_t siz = ntohl(get_u_int32_t(payload, 0));
      if(siz == 0 || (u_int64_t)payload_len < (u_int64_t)siz + sizeof(siz))
        return 1;

      if(siz > 0) {
        first_value.value_size = siz;
        strncpy(ndpiflow->protos.softether.fqdn, (char const *)payload + 4, siz);
        ndpiflow->protos.softether.fqdn[siz] = '\0';
      }
    }
  }

  value_siz = dissect_softether_type(second_value.type, &second_value, payload, payload_len);

  if(second_value.type == VALUE_STR && second_value.value.ptr.value_str!= NULL) {
    if(strncmp(second_value.value.ptr.value_str, "host_name", NDPI_STATICSTRING_LEN("host_name")) == 0) {
      if(payload_len < 4)
        return 1;

      u_int32_t siz = ntohl(get_u_int32_t(payload, 0));
      if(siz == 0 || (u_int64_t)payload_len < (u_int64_t)siz + sizeof(siz))
        return 1;

      if(siz > 0) {
        second_value.value_size = siz;
        strncpy(ndpiflow->protos.softether.hostname, (char const *)payload + 4, siz);
        ndpiflow->protos.softether.hostname[siz] = '\0';
      }
    } else if(strncmp(second_value.value.ptr.value_str, "ddns_fqdn", NDPI_STATICSTRING_LEN("ddns_fqdn")) == 0) {
      if(payload_len < 4)
        return 1;

      u_int32_t siz = ntohl(get_u_int32_t(payload, 0));
      if(siz == 0 || (u_int64_t)payload_len < (u_int64_t)siz + sizeof(siz))
        return 1;

      if(siz > 0) {
        second_value.value_size = siz;
        strncpy(ndpiflow->protos.softether.fqdn, (char const *)payload + 4, siz);
        ndpiflow->protos.softether.fqdn[siz] = '\0';
      }
    }
  }

  if(payload_len > 0)
    return 1;

  return 0;
}