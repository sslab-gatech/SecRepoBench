if (payload_len < 4) {
    return -1;
  }
  tuple_count = ntohl(*((u_int32_t *)payload));
  if (tuple_count == 0) {
    return -1;
  }
  payload += 4;
  payload_len -= 4;
  u_int8_t identifier;
  u_int16_t value_len;
  u_int8_t *value;
  for (u_int32_t i = 0; i < tuple_count; i++) {
    if (payload_len < 2) {
      return -1;
    }
    identifier = *payload;
    payload++;
    payload_len--;
    value_len = *payload;
    payload++;
    payload_len--;
    if (payload_len < value_len) {
      return -1;
    }
    value = (u_int8_t *)payload;
    payload += value_len;
    payload_len -= value_len;
    if (identifier == 0x01) { // host_name
      if (value_len > sizeof(ndpiflow->protos.softether.hostname) - 1) {
        value_len = sizeof(ndpiflow->protos.softether.hostname) - 1;
      }
      memcpy(ndpiflow->protos.softether.hostname, value, value_len);
      ndpiflow->protos.softether.hostname[value_len] = '\0';
    } else if (identifier == 0x02) { // ddns_fqdn
      if (value_len > sizeof(ndpiflow->protos.softether.fqdn) - 1) {
        value_len = sizeof(ndpiflow->protos.softether.fqdn) - 1;
      }
      memcpy(ndpiflow->protos.softether.fqdn, value, value_len);
      ndpiflow->protos.softether.fqdn[value_len] = '\0';
    }
  }
  if (payload_len > 0) {
    return -1;
  }