static int dissect_softether_host_fqdn(struct ndpi_flow_struct *ndpiflow,
                                       struct ndpi_packet_struct const *packet) {
  u_int8_t const *payload = packet->payload;
  u_int16_t payload_len = packet->payload_packet_len;
  u_int32_t tuple_count;
  struct softether_value first_value, second_value;
  size_t value_siz;
  size_t const tuple_type_len = 8;

  if(payload_len < tuple_type_len)
    return 1;

  if(softether_type_to_enum(ntohl(get_u_int32_t(payload, 0)), &first_value.type)!= 0 ||
     softether_type_to_enum(ntohl(get_u_int32_t(payload, 4)), &second_value.type)!= 0)
    return 1;

  payload += tuple_type_len;
  payload_len -= tuple_type_len;

  value_siz = dissect_softether_type(first_value.type, &first_value, payload, payload_len);

  payload += value_siz;
  payload_len -= value_siz;

  if(first_value.type == VALUE_INT && first_value.value.value_int == 0x00000001) {
    // Check if the first value is a "host_name" identifier
    if(payload_len < 4)
      return 1;

    u_int32_t hostname_len = ntohl(get_u_int32_t(payload, 0));
    if(hostname_len == 0 || (u_int64_t)payload_len < (u_int64_t)hostname_len + sizeof(hostname_len))
      return 1;

    if(hostname_len > NDPI_STATICSTRING_LEN("host_name=") - 1)
      return 1;

    strncpy(ndpiflow->protos.softether.hostname,
	    (char const *)payload + sizeof(hostname_len),
            hostname_len);
    ndpiflow->protos.softether.hostname[hostname_len] = '\0';

    payload += sizeof(hostname_len);
    payload_len -= sizeof(hostname_len);
  }

  value_siz = dissect_softether_type(second_value.type, &second_value, payload, payload_len);

  payload += value_siz;
  payload_len -= value_siz;

  if(second_value.type == VALUE_INT && second_value.value.value_int == 0x00000002) {
    // Check if the second value is a "ddns_fqdn" identifier
    if(payload_len < 4)
      return 1;

    u_int32_t fqdn_len = ntohl(get_u_int32_t(payload, 0));
    if(fqdn_len == 0 || (u_int64_t)payload_len < (u_int64_t)fqdn_len + sizeof(fqdn_len))
      return 1;

    if(fqdn_len > NDPI_STATICSTRING_LEN("ddns_fqdn=") - 1)
      return 1;

    strncpy(ndpiflow->protos.softether.fqdn,
	    (char const *)payload + sizeof(fqdn_len),
            fqdn_len);
    ndpiflow->protos.softether.fqdn[fqdn_len] = '\0';

    payload += sizeof(fqdn_len);
    payload_len -= sizeof(fqdn_len);
  }

  if(payload_len > 0)
    return 1;

  return 0;
}