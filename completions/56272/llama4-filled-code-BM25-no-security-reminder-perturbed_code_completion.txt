static int dissect_softether_host_fqdn(struct ndpi_flow_struct *ndpiflow,
                                       struct ndpi_packet_struct const *packet) {
  u_int8_t const *payload = packet->payload;
  u_int16_t payload_len = packet->payload_packet_len;
  u_int32_t tuple_count;

  // Check if the payload length is sufficient
  if (payload_len < 4) {
    return -1; // or some other error code
  }

  // Retrieve the tuple count from the payload
  tuple_count = ntohl(*(u_int32_t*)payload);
  payload += 4;
  payload_len -= 4;

  // Validate the tuple count
  if (tuple_count > payload_len / 2) {
    return -1; // or some other error code
  }

  int host_name_detected = 0;
  int ddns_fqdn_detected = 0;

  // Iterate over each tuple in the payload
  for (u_int32_t i = 0; i < tuple_count; i++) {
    u_int8_t tuple_type;
    u_int16_t tuple_len;

    // Check if there's enough data left for the tuple type and length
    if (payload_len < 3) {
      return -1; // or some other error code
    }

    tuple_type = *payload++;
    tuple_len = ntohs(*(u_int16_t*)payload);
    payload += 2;
    payload_len -= 3;

    // Check if there's enough data left for the tuple value
    if (payload_len < tuple_len) {
      return -1; // or some other error code
    }

    // Process the tuple value based on its type
    switch (tuple_type) {
      case 0x01: // host_name
        if (!host_name_detected) {
          ndpiflow->protos.softether.hostname = ndpi_strdup((const char*)payload);
          host_name_detected = 1;
        }
        break;
      case 0x02: // ddns_fqdn
        if (!ddns_fqdn_detected) {
          ndpiflow->protos.softether.fqdn = ndpi_strdup((const char*)payload);
          ddns_fqdn_detected = 1;
        }
        break;
      default:
        // Handle other tuple types or ignore
        break;
    }

    payload += tuple_len;
    payload_len -= tuple_len;
  }

  // If any unprocessed data remains or tuple count is not exhausted, return an error code
  if (payload_len > 0) {
    return -1; // or some other error code
  }

  return 0;
}