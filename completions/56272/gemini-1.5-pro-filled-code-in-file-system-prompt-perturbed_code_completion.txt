struct softether_value first_value;
  struct softether_value second_value;
  size_t dissected_size;

  if (payload_len < 4) {
    return 1;
  }

  tuple_count = ntohl(get_u_int32_t(payload, 0));
  if (tuple_count == 0 || tuple_count > 10) {
    return 1;
  }

  payload += 4;
  payload_len -= 4;

  dissected_size = dissect_softether_type(VALUE_STR, &first_value, payload, payload_len);
  if(dissected_size == 0 || first_value.value_size == 0)
    return 1;

  payload += dissected_size;
  payload_len -= dissected_size;

  int host_name_found = 0;
  int ddns_fqdn_found = 0;

  for (u_int32_t i = 0; i < tuple_count; i++) {
    dissected_size = dissect_softether_tuples(payload, payload_len, &first_value, &second_value);
    if (dissected_size == 0) {
      return 1;
    }

    if (first_value.type == VALUE_STR && first_value.value_size > 0) {
      if (strncmp(first_value.value.ptr.value_str, "host_name", first_value.value_size) == 0 &&
          second_value.type == VALUE_STR && second_value.value_size > 0) {
        host_name_found = 1;
        strncpy(ndpiflow->protos.softether.hostname, second_value.value.ptr.value_str,
                ndpi_min(sizeof(ndpiflow->protos.softether.hostname) - 1, second_value.value_size));
        ndpiflow->protos.softether.hostname[ndpi_min(sizeof(ndpiflow->protos.softether.hostname) - 1,
                                                    second_value.value_size)] = '\0';
      } else if (strncmp(first_value.value.ptr.value_str, "ddns_fqdn", first_value.value_size) == 0 &&
                 second_value.type == VALUE_STR && second_value.value_size > 0) {
        ddns_fqdn_found = 1;
        strncpy(ndpiflow->protos.softether.fqdn, second_value.value.ptr.value_str,
                ndpi_min(sizeof(ndpiflow->protos.softether.fqdn) - 1, second_value.value_size));
        ndpiflow->protos.softether.fqdn[ndpi_min(sizeof(ndpiflow->protos.softether.fqdn) - 1,
                                                second_value.value_size)] = '\0';
      }
    }

    payload += dissected_size;
    payload_len -= dissected_size;
  }

  if (payload_len != 0 || (host_name_found == 0 && ddns_fqdn_found == 0)) {
    return 1;
  }