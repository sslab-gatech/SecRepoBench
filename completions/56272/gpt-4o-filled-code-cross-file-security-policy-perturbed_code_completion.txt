// Ensure the payload is not NULL and has a valid length
  if (payload == NULL || payload_len < sizeof(u_int32_t)) {
    return -1; // Error: Invalid payload
  }

  // Extract the tuple count from the payload
  tuple_count = *((u_int32_t *)payload);
  payload += sizeof(u_int32_t);
  payload_len -= sizeof(u_int32_t);

  // Validate the tuple count
  if (tuple_count == 0 || payload_len < tuple_count * sizeof(u_int32_t)) {
    return -1; // Error: Invalid tuple count or insufficient payload length
  }

  // Temporary pointers for hostname and FQDN
  char *temp_hostname = NULL;
  char *temp_fqdn = NULL;

  // Iterate over each tuple
  for (u_int32_t i = 0; i < tuple_count; i++) {
    if (payload_len < sizeof(u_int32_t)) {
      return -1; // Error: Insufficient payload length for tuple
    }

    u_int32_t identifier = *((u_int32_t *)payload);
    payload += sizeof(u_int32_t);
    payload_len -= sizeof(u_int32_t);

    // Check for "host_name" identifier
    if (identifier == HOST_NAME_IDENTIFIER) {
      if (payload_len < HOST_NAME_LENGTH) {
        return -1; // Error: Insufficient payload length for host name
      }
      temp_hostname = (char *)payload;
      payload += HOST_NAME_LENGTH;
      payload_len -= HOST_NAME_LENGTH;
    }
    // Check for "ddns_fqdn" identifier
    else if (identifier == DDNS_FQDN_IDENTIFIER) {
      if (payload_len < FQDN_LENGTH) {
        return -1; // Error: Insufficient payload length for FQDN
      }
      temp_fqdn = (char *)payload;
      payload += FQDN_LENGTH;
      payload_len -= FQDN_LENGTH;
    }
  }

  // Validate and store the hostname and FQDN
  if (temp_hostname != NULL) {
    strncpy(ndpiflow->protos.softether.hostname, temp_hostname, HOST_NAME_LENGTH);
    ndpiflow->protos.softether.hostname[HOST_NAME_LENGTH - 1] = '\0'; // Ensure null-termination
  }
  if (temp_fqdn != NULL) {
    strncpy(ndpiflow->protos.softether.fqdn, temp_fqdn, FQDN_LENGTH);
    ndpiflow->protos.softether.fqdn[FQDN_LENGTH - 1] = '\0'; // Ensure null-termination
  }

  // Check for any unprocessed data
  if (payload_len > 0) {
    return -1; // Error: Unprocessed data remains
  }