struct softether_value first_value, second_value;
  size_t tuple_size;
  int found_host_name = 0, found_ddns_fqdn = 0;

  if(payload_len < 4)
    return 1;

  tuple_count = ntohl(get_u_int32_t(payload, 0));
  payload += 4;
  payload_len -= 4;

  if(tuple_count == 0 || payload_len < 8)
    return 1;

  for(u_int32_t i = 0; i < tuple_count; i++) {
    if(payload_len < 8)
      return 1;

    tuple_size = dissect_softether_tuples(payload, payload_len, &first_value, &second_value);
    if(tuple_size == 0)
      return 1;

    if(first_value.type == VALUE_STR && first_value.value_size == 9 &&
       strncmp(first_value.value.ptr.value_str, "host_name", 9) == 0) {
      if(second_value.type == VALUE_STR && second_value.value_size < sizeof(ndpiflow->protos.softether.hostname)) {
        strncpy(ndpiflow->protos.softether.hostname, second_value.value.ptr.value_str, second_value.value_size);
        ndpiflow->protos.softether.hostname[second_value.value_size] = '\0';
        found_host_name = 1;
      }
    } else if(first_value.type == VALUE_STR && first_value.value_size == 9 &&
              strncmp(first_value.value.ptr.value_str, "ddns_fqdn", 9) == 0) {
      if(second_value.type == VALUE_STR && second_value.value_size < sizeof(ndpiflow->protos.softether.fqdn)) {
        strncpy(ndpiflow->protos.softether.fqdn, second_value.value.ptr.value_str, second_value.value_size);
        ndpiflow->protos.softether.fqdn[second_value.value_size] = '\0';
        found_ddns_fqdn = 1;
      }
    }

    payload += tuple_size;
    payload_len -= tuple_size;
  }

  if(!found_host_name || !found_ddns_fqdn)
    return 1;

  return 0;