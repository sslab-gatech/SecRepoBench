u_int8_t host_name_identifier = 0x01;
  u_int8_t ddns_fqdn_identifier = 0x02;

  tuple_count = EXTRACT_32BIT(payload);
  payload += sizeof(u_int32_t);
  payload_len -= sizeof(u_int32_t);

  while (tuple_count > 0 && payload_len >= 2) {
    u_int8_t identifier = *payload++;
    u_int16_t value_len = EXTRACT_16BIT(payload);
    payload += sizeof(u_int16_t);
    payload_len -= sizeof(u_int16_t);

    if (value_len > payload_len) {
      return NDPI_PROTOCOL_UNKNOWN;
    }

    if (identifier == host_name_identifier) {
      if (value_len < sizeof(flow->protos.softether.hostname)) {
        memcpy(flow->protos.softether.hostname, payload, value_len);
        flow->protos.softether.hostname[value_len] = '\0';
      }
    } else if (identifier == ddns_fqdn_identifier) {
      if (value_len < sizeof(flow->protos.softether.fqdn)) {
        memcpy(flow->protos.softether.fqdn, payload, value_len);
        flow->protos.softether.fqdn[value_len] = '\0';
      }
    }

    payload += value_len;
    payload_len -= value_len;
    tuple_count--;
  }

  if (payload_len > 0 || tuple_count > 0) {
    return NDPI_PROTOCOL_UNKNOWN;
  }

  return 0;