u_int8_t const *tuple_start = payload;
  u_int16_t tuple_len;
  u_int8_t identifier;
  u_int8_t value_len;
  u_int8_t const *value;

  while (payload_len > 0) {
    // Extract the tuple length and identifier
    if (payload_len < 2) {
      return NDPI_PROTOCOL_UNKNOWN;
    }
    tuple_len = ntohs(*(u_int16_t *)payload);
    identifier = payload[2];
    payload += 3;
    payload_len -= 3;

    // Extract the value length and value
    if (payload_len < 1) {
      return NDPI_PROTOCOL_UNKNOWN;
    }
    value_len = *payload++;
    payload_len--;
    if (payload_len < value_len) {
      return NDPI_PROTOCOL_UNKNOWN;
    }
    value = payload;
    payload += value_len;
    payload_len -= value_len;

    // Process the tuple based on the identifier
    switch (identifier) {
    case 0x01: // "host_name"
      ndpi_hostname_len = value_len;
      ndpi_hostname = (char *)value;
      break;
    case 0x02: // "ddns_fqdn"
      ndpi_fqdn_len = value_len;
      ndpi_fqdn = (char *)value;
      break;
    default:
      break;
    }

    tuple_start = payload;
  }

  if (payload_len > 0 || tuple_count > 0) {
    return NDPI_PROTOCOL_UNKNOWN;
  }

  return 0;