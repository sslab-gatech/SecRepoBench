tuple_count = ntohl(*((u_int32_t *)payload));
  if (tuple_count > payload_len || tuple_count == 0) {
    return -1;
  }
  payload += 4;
  payload_len -= 4;
  u_int8_t identifier;
  u_int16_t value_len;
  u_int8_t *hostname = NULL;
  u_int8_t *fqdn = NULL;
  u_int32_t hostname_len = 0;
  u_int32_t fqdn_len = 0;
  for (u_int32_t i = 0; i < tuple_count; i++) {
    identifier = *payload;
    payload++;
    payload_len--;
    value_len = ntohs(*((u_int16_t *)payload));
    payload += 2;
    payload_len -= 2;
    if (value_len > payload_len) {
      return -1;
    }
    if (identifier == 0x01) { // host_name
      hostname = payload;
      hostname_len = value_len;
    } else if (identifier == 0x02) { // ddns_fqdn
      fqdn = payload;
      fqdn_len = value_len;
    }
    payload += value_len;
    payload_len -= value_len;
  }
  if (hostname != NULL && hostname_len > 0) {
    if (hostname_len > sizeof(ndpiflow->protos.softether.hostname) - 1) {
      hostname_len = sizeof(ndpiflow->protos.softether.hostname) - 1;
    }
    memcpy(ndpiflow->protos.softether.hostname, hostname, hostname_len);
    ndpiflow->protos.softether.hostname[hostname_len] = '\0';
  }
  if (fqdn != NULL && fqdn_len > 0) {
    if (fqdn_len > sizeof(ndpiflow->protos.softether.fqdn) - 1) {
      fqdn_len = sizeof(ndpiflow->protos.softether.fqdn) - 1;
    }
    memcpy(ndpiflow->protos.softether.fqdn, fqdn, fqdn_len);
    ndpiflow->protos.softether.fqdn[fqdn_len] = '\0';
  }
  if (payload_len > 0) {
    return -1;
  }