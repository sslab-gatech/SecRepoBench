if(payload_len < 4)
    return 1;

  tuple_count = ntohl(get_u_int32_t(payload, 0));
  if(tuple_count == 0 || tuple_count > 100) // Sanity check on tuple count
    return 1;

  payload += 4;
  payload_len -= 4;

  struct softether_value first_value;
  struct softether_value second_value;
  int found_host_or_fqdn = 0;

  while(tuple_count > 0 && payload_len > 0) {
    size_t processed = dissect_softether_tuples(payload, payload_len, &first_value, &second_value);
    
    if(processed == 0 || (u_int16_t)processed > payload_len)
      return 1;
      
    if(first_value.type == VALUE_STR && first_value.value_size != 0) {
      if(first_value.value_size == NDPI_STATICSTRING_LEN("host_name") &&
         strncmp((char *)first_value.value.ptr.value_str, "host_name", first_value.value_size) == 0) {
        // Found hostname
        if(second_value.type == VALUE_STR && second_value.value_size != 0) {
          size_t hostname_len = ndpi_min(sizeof(ndpiflow->protos.softether.hostname) - 1, 
                                        second_value.value_size);
          strncpy(ndpiflow->protos.softether.hostname, 
                 (char *)second_value.value.ptr.value_str,
                 hostname_len);
          ndpiflow->protos.softether.hostname[hostname_len] = '\0';
          found_host_or_fqdn = 1;
        }
      } else if(first_value.value_size == NDPI_STATICSTRING_LEN("ddns_fqdn") &&
               strncmp((char *)first_value.value.ptr.value_str, "ddns_fqdn", first_value.value_size) == 0) {
        // Found FQDN
        if(second_value.type == VALUE_STR && second_value.value_size != 0) {
          size_t fqdn_len = ndpi_min(sizeof(ndpiflow->protos.softether.fqdn) - 1, 
                                    second_value.value_size);
          strncpy(ndpiflow->protos.softether.fqdn, 
                 (char *)second_value.value.ptr.value_str,
                 fqdn_len);
          ndpiflow->protos.softether.fqdn[fqdn_len] = '\0';
          found_host_or_fqdn = 1;
        }
      }
    }
    
    payload += processed;
    payload_len -= (u_int16_t)processed;
    tuple_count--;
  }
  
  return found_host_or_fqdn ? 0 : 1;