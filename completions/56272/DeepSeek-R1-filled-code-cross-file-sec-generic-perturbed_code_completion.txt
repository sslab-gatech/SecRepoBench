if (payload_len < 4)
    return 1;
  memcpy(&tuple_count, payload, 4);
  tuple_count = ntohl(tuple_count);
  payload += 4;
  payload_len -= 4;

  if (tuple_count == 0 || tuple_count > 1000)
    return 1;

  for (u_int32_t i = 0; i < tuple_count; i++) {
    u_int32_t identifier, value_len;

    if (payload_len < 8)
      return 1;
    memcpy(&identifier, payload, 4);
    identifier = ntohl(identifier);
    payload += 4;
    payload_len -= 4;

    memcpy(&value_len, payload, 4);
    value_len = ntohl(value_len);
    payload += 4;
    payload_len -= 4;

    if (value_len > payload_len)
      return 1;

    if (identifier == 0x686F7374) { // "host"
      size_t copy_len = MIN(value_len, sizeof(ndpiflow->protos.softether.hostname) - 1);
      memcpy(ndpiflow->protos.softether.hostname, payload, copy_len);
      ndpiflow->protos.softether.hostname[copy_len] = '\0';
    } else if (identifier == 0x64646E73) { // "ddns"
      size_t copy_len = MIN(value_len, sizeof(ndpiflow->protos.softether.fqdn) - 1);
      memcpy(ndpiflow->protos.softether.fqdn, payload, copy_len);
      ndpiflow->protos.softether.fqdn[copy_len] = '\0';
    }

    payload += value_len;
    payload_len -= value_len;
  }

  if (payload_len != 0)
    return 1;