// <MASK>
  if (flow->protos.softether.hostname[0] != '\0' && flow->protos.softether.fqdn[0] != '\0') {
    char *hostname = NULL, *fqdn = NULL;
    u_int16_t hostname_len = 0, fqdn_len = 0;

    // Check if hostname and fqdn are valid pointers
    if (flow->protos.softether.hostname != NULL && flow->protos.softether.fqdn != NULL) {
      hostname_len = strlen(flow->protos.softether.hostname);
      fqdn_len = strlen(flow->protos.softether.fqdn);

      // Allocate memory for hostname and fqdn
      hostname = (char *)ndpi_malloc(hostname_len + 1);
      fqdn = (char *)ndpi_malloc(fqdn_len + 1);

      // Copy hostname and fqdn to the allocated memory
      if (hostname != NULL && fqdn != NULL) {
        memcpy(hostname, flow->protos.softether.hostname, hostname_len);
        hostname[hostname_len] = '\0';
        memcpy(fqdn, flow->protos.softether.fqdn, fqdn_len);
        fqdn[fqdn_len] = '\0';

        // Store the hostname and fqdn in the flow structure
        if (flow->protos.softether.hostname != NULL) {
          ndpi_free(flow->protos.softether.hostname);
        }
        flow->protos.softether.hostname = hostname;

        if (flow->protos.softether.fqdn != NULL) {
          ndpi_free(flow->protos.softether.fqdn);
        }
        flow->protos.softether.fqdn = fqdn;
      }
    }
  }
  return 0;