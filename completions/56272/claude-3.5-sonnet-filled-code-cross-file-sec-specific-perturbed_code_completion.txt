if (ndpiflow != NULL && ndpiflow->protos.softether.hostname[0] != '\0') {
  ndpiflow->host_server_name[0] = '\0';
  if (ndpiflow->protos.softether.hostname[0] != '\0') {
    strncpy(ndpiflow->host_server_name, ndpiflow->protos.softether.hostname, sizeof(ndpiflow->host_server_name) - 1);
    ndpiflow->host_server_name[sizeof(ndpiflow->host_server_name) - 1] = '\0';
  }
}
if (ndpiflow != NULL && ndpiflow->protos.softether.fqdn[0] != '\0') {
  ndpiflow->protos.softether.fqdn[sizeof(ndpiflow->protos.softether.fqdn) - 1] = '\0';
}