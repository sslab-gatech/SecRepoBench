// Store hostname and FQDN in temporary pointers
const char *temp_hostname = NULL;
const char *temp_fqdn = NULL;

// Process the extracted hostname and FQDN
if (hostname_detected) {
    temp_hostname = (const char *)hostname_value;
}
if (fqdn_detected) {
    temp_fqdn = (const char *)fqdn_value;
}

// Check if both hostname and FQDN are valid before storing
if (temp_hostname != NULL && temp_fqdn != NULL) {
    strncpy(ndpiflow->protos.softether.hostname, temp_hostname, sizeof(ndpiflow->protos.softether.hostname) - 1);
    ndpiflow->protos.softether.hostname[sizeof(ndpiflow->protos.softether.hostname) - 1] = '\0';

    strncpy(ndpiflow->protos.softether.fqdn, temp_fqdn, sizeof(ndpiflow->protos.softether.fqdn) - 1);
    ndpiflow->protos.softether.fqdn[sizeof(ndpiflow->protos.softether.fqdn) - 1] = '\0';
} else {
    // Handle the case where either hostname or FQDN is NULL
    return -1;
}