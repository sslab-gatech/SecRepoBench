char *temp_hostname = NULL;
  char *temp_fqdn = NULL;

  // Assuming the extraction logic for hostname and fqdn is implemented here
  if (extract_hostname(payload, payload_len, &temp_hostname) == 0) {
    if (temp_hostname != NULL) {
      strncpy(flow->protos.softether.hostname, temp_hostname, sizeof(flow->protos.softether.hostname) - 1);
      flow->protos.softether.hostname[sizeof(flow->protos.softether.hostname) - 1] = '\0'; // Null-terminate
    }
  }

  if (extract_fqdn(payload, payload_len, &temp_fqdn) == 0) {
    if (temp_fqdn != NULL) {
      strncpy(flow->protos.softether.fqdn, temp_fqdn, sizeof(flow->protos.softether.fqdn) - 1);
      flow->protos.softether.fqdn[sizeof(flow->protos.softether.fqdn) - 1] = '\0'; // Null-terminate
    }
  }

  // Free temporary pointers if they were allocated
  free(temp_hostname);
  free(temp_fqdn);