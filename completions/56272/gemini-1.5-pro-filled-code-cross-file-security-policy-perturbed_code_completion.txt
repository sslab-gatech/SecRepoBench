if (ndpiflow->protos.softether.hostname[0] != '\0') {
    const u_int8_t *hostname = ndpiflow->protos.softether.hostname;
    size_t hostname_len = strlen((const char *)hostname);
    if (hostname_len > 0 && hostname_len <= NDPI_FLOW_HOSTNAME_LEN) {
      memcpy(ndpiflow->hostname, hostname, hostname_len);
      ndpiflow->hostname[hostname_len] = '\0';
    }
  }

  if (ndpiflow->protos.softether.fqdn[0] != '\0') {
    const u_int8_t *fqdn = ndpiflow->protos.softether.fqdn;
    size_t fqdn_len = strlen((const char *)fqdn);

    if (fqdn_len > 0 && fqdn_len <= NDPI_FLOW_FQDN_LEN) {
      memcpy(ndpiflow->fqdn, fqdn, fqdn_len);
      ndpiflow->fqdn[fqdn_len] = '\0';
    }
  }