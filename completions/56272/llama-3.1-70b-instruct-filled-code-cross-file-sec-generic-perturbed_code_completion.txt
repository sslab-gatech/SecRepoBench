// Store the extracted hostname and FQDN values in the flow structure.
if (ndpiflow->protos.softether.hostname[0] == '\0' && hostname!= NULL) {
  strncpy(ndpiflow->protos.softether.hostname, hostname, sizeof(ndpiflow->protos.softether.hostname) - 1);
  ndpiflow->protos.softether.hostname[sizeof(ndpiflow->protos.softether.hostname) - 1] = '\0';
}

if (ndpiflow->protos.softether.fqdn[0] == '\0' && fqdn!= NULL) {
  strncpy(ndpiflow->protos.softether.fqdn, fqdn, sizeof(ndpiflow->protos.softether.fqdn) - 1);
  ndpiflow->protos.softether.fqdn[sizeof(ndpiflow->protos.softether.fqdn) - 1] = '\0';
}

// Check if any unprocessed data remains or tuple count is not exhausted.
if (payload_len > 0 || tuple_count > 0) {
  return -1; // Return an error code.
}