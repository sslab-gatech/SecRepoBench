// Initialize variables for processing and flags for hostname and FQDN detection.
  struct softether_value first_value, second_value;
  bool hostname_detected = false, fqdn_detected = false;
  u_int8_t const *payload = packet->payload;
  u_int16_t payload_len = packet->payload_packet_len;
  u_int32_t tuple_count;

  // Check if the payload length is sufficient and retrieve the tuple count from the payload.
  if (payload_len < 8)
    return 1;

  tuple_count = ntohl(get_u_int32_t(payload, 0));
  payload += 4;
  payload_len -= 4;

  // Validate the tuple count and adjust the payload and its length accordingly.
  if (tuple_count == 0 || tuple_count > payload_len / 8)
    return 1;

  payload_len = tuple_count * 8;

  // Extract the first value from the payload to determine if it contains a "host_name" identifier.
  for (u_int32_t i = 0; i < tuple_count; ++i) {
    size_t value_siz = dissect_softether_tuples(payload, payload_len, &first_value, &second_value);
    if (value_siz == 0)
      return 1;

    payload += value_siz;
    payload_len -= value_siz;

    if (first_value.type == VALUE_STR && strncmp(first_value.value.value_str, "host_name", 8) == 0) {
      hostname_detected = true;
      // Prepare to store its value in the flow structure's hostname field.
      strncpy(flow->protos.softether.hostname, first_value.value.value_str, sizeof(flow->protos.softether.hostname) - 1);
      flow->protos.softether.hostname[sizeof(flow->protos.softether.hostname) - 1] = '\0';
    } else if (first_value.type == VALUE_STR && strncmp(first_value.value.value_str, "ddns_fqdn", 9) == 0) {
      fqdn_detected = true;
      // Prepare to store its value in the flow structure's fqdn field.
      strncpy(flow->protos.softether.fqdn, first_value.value.value_str, sizeof(flow->protos.softether.fqdn) - 1);
      flow->protos.softether.fqdn[sizeof(flow->protos.softether.fqdn) - 1] = '\0';
    }
  }

  // If any unprocessed data remains or tuple count is not exhausted, return an error code.
  if (payload_len > 0)
    return 1;

  // If a "host_name" or "ddns_fqdn" is detected, return 0 indicating success.
  if (hostname_detected || fqdn_detected)
    return 0;

  return 1;
}