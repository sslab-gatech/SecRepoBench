flb_sds_t out = flb_sds_create_size(len + 1);
if (!out) {
    return NULL;
}

int end_slash = (len > 0 && pathuri[len - 1] == '/') ? FLB_TRUE : FLB_FALSE;
if (end_slash) {
    len--; // Adjust length if the path ends with a slash
}