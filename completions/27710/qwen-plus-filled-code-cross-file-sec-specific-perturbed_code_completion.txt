// Declare necessary variables for manipulating URI components and lists.
size_t i;
struct mk_list *head, *tmp;
struct flb_split_entry *entry;
flb_sds_t out;

// Create a dynamic string (SDS) from the input URI.
out = flb_sds_create_size(len + 1);
if (!out) {
    return NULL;
}
memcpy(out, pathuri, len);
out[len] = '\0';

// Check if the URI ends with a slash and set a flag accordingly.
int end_slash = FLB_FALSE;
if (len > 0 && pathuri[len - 1] == '/') {
    end_slash = FLB_TRUE;
}

// Allocate memory for split list to hold URI components
struct mk_list *split = flb_malloc(sizeof(struct mk_list));
if (!split) {
    flb_sds_destroy(out);
    return NULL;
}
mk_list_init(split);