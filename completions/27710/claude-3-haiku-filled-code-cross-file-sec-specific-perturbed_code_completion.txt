// <MASK>
// Normalize the path by removing "." and ".." entries
// and concatenating the remaining path components.
flb_sds_t out = flb_sds_create_size(len);
if (!out) {
    return NULL;
}

bool end_slash = false;
if (len > 0 && pathuri[len - 1] == '/') {
    end_slash = true;
}

char *p = out;
struct mk_list *split, *head, *tmp;
struct flb_split_entry *entry;

split = flb_utils_split(pathuri, '/', -1);
if (!split) {
    flb_sds_destroy(out);
    return NULL;
}