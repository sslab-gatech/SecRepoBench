// <MASK>
// Check if the URI ends with a slash and set a flag accordingly.
if (pathuri[len - 1] == '/') {
    end_slash = FLB_TRUE;
}
else {
    end_slash = FLB_FALSE;
}

// Create a dynamic string (SDS) from the input URI.
out = flb_sds_create(len + 1);
if (!out) {
    return NULL;
}

memcpy(out, pathuri, len);
out[len] = '\0';

// Split the URI into components using '/' as the delimiter.
split = flb_utils_split(out, '/', -1);
if (!split) {
    flb_sds_destroy(out);
    return NULL;
}