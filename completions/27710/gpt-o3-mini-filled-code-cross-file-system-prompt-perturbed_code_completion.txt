int end_slash = FLB_FALSE;
if (len > 0 && pathuri[len - 1] == '/') {
    end_slash = FLB_TRUE;
}

flb_sds_t out = flb_sds_create_len(pathuri, len);
if (!out) {
    return NULL;
}

/* Declare variables for URI splitting and manipulation */
struct mk_list *split = NULL;
struct mk_list *head = NULL;
struct mk_list *tmp = NULL;
struct flb_split_entry *entry = NULL;
struct mk_list *prev = NULL;
char *p = NULL;