flb_sds_t out = flb_sds_create_len(pathuri, len);
if (!out) {
    return NULL; // Handle memory allocation failure
}

int end_slash = (len > 0 && pathuri[len - 1] == '/') ? FLB_TRUE : FLB_FALSE;