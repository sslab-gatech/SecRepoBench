// <MASK>
// Allocate memory for the buffer, including space for the null terminator.
char *out = flb_malloc(len + 1);
if (!out) {
    return NULL;
}

// Initialize the buffer with the input URI.
memcpy(out, pathuri, len);
out[len] = '\0';

// Check if the URI ends with a slash and set a flag accordingly.
end_slash = (out[len - 1] == '/');