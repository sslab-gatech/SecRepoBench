// <MASK>
// Check if the input URI is empty
if (len == 0) {
    return NULL;
}

// Create a dynamic string (SDS) from the input URI
out = flb_sds_create_size(len);
if (!out) {
    return NULL;
}

// Check if the URI ends with a slash and set a flag accordingly
end_slash = (pathuri[len - 1] == '/') ? FLB_TRUE : FLB_FALSE;

// Normalize the URI path by removing redundant '.' and '..' segments
flb_utils_path_clean(out, pathuri, len);