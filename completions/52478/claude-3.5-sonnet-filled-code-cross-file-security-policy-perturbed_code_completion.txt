// process pre behavior
switch ((*it).pre) {
    case LWO::PrePostBehaviour_OffsetRepeat:
    case LWO::PrePostBehaviour_Repeat:
    case LWO::PrePostBehaviour_Oscillate:
        if (delta > 0.0) {
            const double value_delta = (*it).keys.back().value - (*it).keys.front().value;
            const size_t old_size = (*it).keys.size();
            
            while ((*it).keys.front().time > first) {
                LWO::Key new_key = (*it).keys.front();
                new_key.time -= delta;
                
                switch ((*it).pre) {
                    case LWO::PrePostBehaviour_OffsetRepeat:
                        new_key.value -= value_delta;
                        break;
                    case LWO::PrePostBehaviour_Repeat:
                        break;
                    case LWO::PrePostBehaviour_Oscillate:
                        new_key.value = (*it).keys.back().value - 
                            (new_key.value - (*it).keys.front().value);
                        break;
                }
                
                (*it).keys.push_front(new_key);
            }
            
            (*it).old_first = (*it).keys.size() - old_size;
        }
        break;
    
    default:
        // No action needed for other pre-behaviors
        break;
}