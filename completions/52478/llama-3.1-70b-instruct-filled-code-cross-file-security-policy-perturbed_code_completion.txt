// Handles the pre-behavior of LightWave envelopes by inserting additional keyframes
// for pre-defined behaviors such as OffsetRepeat, Repeat, and Oscillate. This involves
// calculating the time delta between keys and adjusting keyframe values accordingly.
// The logic uses the start time, end time, and value delta to calculate new keyframe
// positions and values, adapting to the pre-behavior type.

if ((*it).pre!= LWO::PrePostBehaviour_Constant) {
    const double start = firsttime;
    const double end = my_last;
    const double valueDelta = (*it).keys.back().value - (*it).keys.front().value;

    if ((*it).pre == LWO::PrePostBehaviour_OffsetRepeat) {
        // Insert additional keyframes for OffsetRepeat behavior
        double currentTime = start;
        while (currentTime < end) {
            double newValue = (*it).keys.front().value + (valueDelta * (currentTime - start) / delta);
            LWO::Key newKey;
            newKey.time = currentTime;
            newKey.value = newValue;
            (*it).keys.insert((*it).keys.begin() + 1, newKey);
            currentTime += delta;
        }
    } else if ((*it).pre == LWO::PrePostBehaviour_Repeat) {
        // Insert additional keyframes for Repeat behavior
        double currentTime = start;
        while (currentTime < end) {
            double newValue = (*it).keys.front().value + (valueDelta * (currentTime - start) / delta);
            LWO::Key newKey;
            newKey.time = currentTime;
            newKey.value = newValue;
            (*it).keys.insert((*it).keys.begin() + 1, newKey);
            currentTime += delta;
        }
    } else if ((*it).pre == LWO::PrePostBehaviour_Oscillate) {
        // Insert additional keyframes for Oscillate behavior
        double currentTime = start;
        double oscillation = 0.0;
        while (currentTime < end) {
            double newValue = (*it).keys.front().value + (valueDelta * (currentTime - start) / delta) + (oscillation * valueDelta);
            LWO::Key newKey;
            newKey.time = currentTime;
            newKey.value = newValue;
            (*it).keys.insert((*it).keys.begin() + 1, newKey);
            currentTime += delta;
            oscillation = -oscillation;
        }
    }
}