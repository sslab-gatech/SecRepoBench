// Handles the pre-behavior of LightWave envelopes by inserting additional keyframes
// for pre-defined behaviors such as OffsetRepeat, Repeat, and Oscillate. This involves
// calculating the time delta between keys and adjusting keyframe values accordingly.
// The logic uses the start time, end time, and value delta to calculate new keyframe
// positions and values, adapting to the pre-behavior type.
switch ((*it).pre) {
case LWO::PrePostBehaviour_OffsetRepeat:
    {
        double delta = my_last - firsttime;
        double repeat_count = std::floor(firsttime / delta);
        double repeat_start = repeat_count * delta;
        double repeat_end = (repeat_count + 1) * delta;

        // Insert keyframes at the start and end of each repeat cycle
        (*it).keys.insert((*it).keys.begin(), {repeat_start, (*it).keys.front().value});
        (*it).keys.insert((*it).keys.end(), {repeat_end, (*it).keys.back().value});
    }
    break;
case LWO::PrePostBehaviour_Repeat:
    {
        double delta = my_last - firsttime;
        double repeat_count = std::floor(firsttime / delta);
        double repeat_start = repeat_count * delta;
        double repeat_end = (repeat_count + 1) * delta;

        // Insert keyframes at the start and end of each repeat cycle
        (*it).keys.insert((*it).keys.begin(), {repeat_start, (*it).keys.front().value});
        (*it).keys.insert((*it).keys.end(), {repeat_end, (*it).keys.back().value});
    }
    break;
case LWO::PrePostBehaviour_Oscillate:
    {
        double delta = my_last - firsttime;
        double repeat_count = std::floor(firsttime / delta);
        double repeat_start = repeat_count * delta;
        double repeat_end = (repeat_count + 1) * delta;

        // Insert keyframes at the start and end of each oscillation cycle
        (*it).keys.insert((*it).keys.begin(), {repeat_start, (*it).keys.front().value});
        (*it).keys.insert((*it).keys.end(), {repeat_end, -(*it).keys.back().value});
    }
    break;
default:
    // silence compiler warning
    break;
}