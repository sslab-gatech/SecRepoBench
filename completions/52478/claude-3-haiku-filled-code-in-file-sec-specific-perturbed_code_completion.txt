// Handles the pre-behavior of LightWave envelopes by inserting additional keyframes
// for pre-defined behaviors such as OffsetRepeat, Repeat, and Oscillate. This involves
// calculating the time delta between keys and adjusting keyframe values accordingly.
// The logic uses the start time, end time, and value delta to calculate new keyframe
// positions and values, adapting to the pre-behavior type.
switch ((*it).pre) {
case LWO::PrePostBehaviour_OffsetRepeat:
    {
        double value_delta = (*it).keys.back().value - (*it).keys.front().value;
        double time_delta = my_last - firsttime;
        double repeat_count = std::floor(firsttime / time_delta);
        double new_first_time = firsttime + repeat_count * time_delta;
        (*it).keys.insert((*it).keys.begin(), LWO::Key{ new_first_time, (*it).keys.front().value + repeat_count * value_delta });
    }
    break;
case LWO::PrePostBehaviour_Repeat:
    {
        double value_delta = (*it).keys.back().value - (*it).keys.front().value;
        double time_delta = my_last - firsttime;
        double repeat_count = std::floor(firsttime / time_delta);
        double new_first_time = firsttime + repeat_count * time_delta;
        (*it).keys.insert((*it).keys.begin(), LWO::Key{ new_first_time, (*it).keys.front().value });
    }
    break;
case LWO::PrePostBehaviour_Oscillate:
    {
        double value_delta = (*it).keys.back().value - (*it).keys.front().value;
        double time_delta = my_last - firsttime;
        double repeat_count = std::floor(firsttime / time_delta);
        double new_first_time = firsttime + repeat_count * time_delta;
        (*it).keys.insert((*it).keys.begin(), LWO::Key{ new_first_time, (*it).keys.front().value + (repeat_count % 2 == 0 ? value_delta : -value_delta) });
    }
    break;
default:
    // silence compiler warning
    break;
}