// process pre behavior
switch ((*it).pre) {
    case LWO::PrePostBehaviour_OffsetRepeat:
    case LWO::PrePostBehaviour_Repeat:
    case LWO::PrePostBehaviour_Oscillate:
        {
            const double value_delta = (*it).keys.back().value - (*it).keys.front().value;
            size_t num_keys = (*it).keys.size();
            
            while ((*it).keys.front().time > firsttime) {
                LWO::Key new_key = (*it).keys.front();
                new_key.time -= delta;
                
                if ((*it).pre == LWO::PrePostBehaviour_OffsetRepeat) {
                    new_key.value -= value_delta;
                } else if ((*it).pre == LWO::PrePostBehaviour_Oscillate) {
                    new_key.value = 2.0f * (*it).keys.front().value - new_key.value;
                }
                
                (*it).keys.push_front(new_key);
            }
            
            (*it).old_first = num_keys - (*it).keys.size();
        }
        break;
    
    default:
        // No action needed for other pre-behaviors
        break;
}