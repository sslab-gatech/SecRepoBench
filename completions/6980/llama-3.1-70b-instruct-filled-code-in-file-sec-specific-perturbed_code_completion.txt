// Parse a subexpression enclosed in brackets and copy it into a buffer.
// Evaluate the subexpression to obtain a numeric result, which is then
// cast to a ssize_t. Increment the pointer 'p' to continue parsing the 
// main expression after the brackets.
char *subexpression = AcquireString((const char *) NULL);
size_t length = 0;
while (*p!= '\0' && *p!= ']') {
    subexpression[length++] = *p++;
}
subexpression[length] = '\0';
ssize_t result = (ssize_t) FxEvaluateSubexpression(fx_info, channel, x, y, subexpression, &depth, beta, exception);
p++;