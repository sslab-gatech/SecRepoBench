level++;
              q=subexpression;
              for (p++; *p != '\0'; )
              {
                if (*p == '[')
                  level++;
                else if (*p == ']')
                {
                  level--;
                  if (level == 0)
                    break;
                }
                if ((size_t)(q - subexpression) >= MagickPathExtent - 1)
                {
                  (void) ThrowMagickException(exception, GetMagickModule(),
                    OptionError, "SubexpressionTooLarge", "`%s'", expression);
                  return 0.0;
                }
                *q++ = (*p++);
              }
              *q = '\0';
              if (*p == ']')
                p++;
              alpha = FxEvaluateSubexpression(fx_info, channel, x, y, subexpression,
                &depth, &beta, exception);
              imageindex = (ssize_t)alpha;