size_t
  subexpression_length;

subexpression_length = strcspn(p+1, "]");
if (subexpression_length > 0)
{
  char
    *subexpression;

  subexpression = AcquireString(p+1);
  subexpression[subexpression_length] = '\0';
  alpha = FxEvaluateSubexpression(fx_info, channel, x, y, subexpression, depth, beta, exception);
  subexpression = DestroyString(subexpression);
  imageindex = (ssize_t) (alpha + 0.5);
  p += subexpression_length + 2;
}