// Parse a subexpression enclosed in brackets and copy it into a buffer.
// Evaluate the subexpression to obtain a numeric result, which is then
// cast to a ssize_t. Increment the pointer 'p' to continue parsing the 
// main expression after the brackets.
q=subexpression;
level=1;
p++;
while (*p != '\0' && level > 0)
{
  if (*p == '[')
    level++;
  else if (*p == ']')
    level--;
  *q++=(*p++);
}
*q='\0';
alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,&depth,&beta,exception);
imageindex=(ssize_t)alpha;
p++;