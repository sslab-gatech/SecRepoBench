SpeedHQContext *s = codec_context->priv_data;
    const uint8_t *buf = avpkt->data;
    int buf_size = avpkt->size;
    int second_field_offset;
    int ret;

    if (buf_size < 8) {
        return AVERROR_INVALIDDATA;
    }


    if (codec_context->width < 8 || codec_context->height < 8 ||
        codec_context->width % 8 || codec_context->height % 8) {
        return AVERROR_INVALIDDATA;
    }

    s->quality = AV_RL24(buf);
    speedhq_quality_to_qmat(s, s->quality);