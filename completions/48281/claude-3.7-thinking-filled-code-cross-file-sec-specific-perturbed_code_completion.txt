SpeedhqContext *s = codec_context->priv_data;
const uint8_t *buf = avpkt->data;
int buf_size = avpkt->size;
int ret, second_field_offset;

if (!buf || buf_size < 4) {
    return AVERROR_INVALIDDATA;
}

// Extract quality parameter from the packet data
speedhq_calculate_qtable(s, buf[0]);