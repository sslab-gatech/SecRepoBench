// Ensure the width is a multiple of 8 and above a minimum threshold
if (codec_context->width < 16 || codec_context->width % 8 != 0) {
    return AVERROR_INVALIDDATA;
}

// Initialize buffer and size variables
const uint8_t *buf = avpkt->data;
int buf_size = avpkt->size;
int second_field_offset;

// Check if the buffer size is sufficient
if (buf_size < 8) {
    return AVERROR_INVALIDDATA;
}

// Extract the second field offset
second_field_offset = AV_RL24(buf + 1);