SpeedHQContext *s = codec_context->priv_data;
    const uint8_t *buf = avpkt->data;
    int buf_size = avpkt->size;
    int ret;
    int second_field_offset;

    if (buf_size < 8) {
        return AVERROR_INVALIDDATA;
    }

    s->width = AV_RL16(buf);
    if (s->width > 16384) {
        return AVERROR_INVALIDDATA;
    }

    s->height = AV_RL16(buf + 2);
    if (s->height > 16384) {
        return AVERROR_INVALIDDATA;
    }