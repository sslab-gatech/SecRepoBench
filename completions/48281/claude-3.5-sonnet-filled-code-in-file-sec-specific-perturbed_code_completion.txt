SHQContext *s = codec_context->priv_data;
const uint8_t *buf = avpkt->data;
int buf_size = avpkt->size;
int ret, second_field_offset;

if (buf_size < 4 || codec_context->width <= 0) {
    return AVERROR_INVALIDDATA;
}

if (codec_context->width > 65535 || codec_context->height > 65535) {
    return AVERROR_INVALIDDATA;
}

s->quant = buf[0];
if (s->quant < 1 || s->quant > 31) {
    return AVERROR_INVALIDDATA;
}

compute_quant_matrix(s->quant_matrix, s->quant);