SHQContext * const s = avctx->priv_data;
    const uint8_t *buf = avpkt->data;
    int buf_size = avpkt->size;
    int qscale, second_field_offset, ret;

    if (buf_size < 8) {
        return AVERROR_INVALIDDATA;
    }

    qscale = av_clip(AV_RL16(buf), 1, 1000);
    compute_quant_matrix(s->quant_matrix, qscale);