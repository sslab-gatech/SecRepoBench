// Retrieve the length of the serialized content that follows the marker.
uint32_t content_len;
header_pos += sizeof(content_len);
if (header_len < header_pos) {
  return BLOSC2_ERROR_READ_BUFFER;
}
from_big(&content_len, idxp, sizeof(content_len));
idxp += sizeof(content_len);

// Ensure content length is within valid bounds
if (offset + content_len > header_len || content_len < 0) {
  return BLOSC2_ERROR_DATA;
}

// Store the length in the metalayer structure
current_metalayer->content_len = content_len;

// Use the obtained length to correctly position within the header and extract the content
header_pos += content_len;
if (header_len < header_pos) {
  return BLOSC2_ERROR_READ_BUFFER;
}

// Assign the extracted content to the metalayer's content field
current_metalayer->content = malloc(content_len);
memcpy(current_metalayer->content, content_marker + 1 + 4, content_len);