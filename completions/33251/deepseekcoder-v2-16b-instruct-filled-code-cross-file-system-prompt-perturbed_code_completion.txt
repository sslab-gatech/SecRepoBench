int32_t content_len = *idxp & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *idxp & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  char* content_marker = header + offset;
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    return BLOSC2_ERROR_READ_BUFFER;
  }
  int32_t content_len = *content_marker & (uint8_t)0x1F;
  idxp += 1;
  header_pos += content_len;
  if (header_len < header_pos) {
    retur