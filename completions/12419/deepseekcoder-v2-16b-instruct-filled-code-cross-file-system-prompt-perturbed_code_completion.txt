ID = xmlNodeListGetString(doc, attr->children, 1);
    if (ID == NULL) {
        xmlFree(ID);
        return(-1);
    }

    id = xmlHashLookup(table, ID);
    if (id == NULL || id->attr != attr) {
        xmlFree(ID);
        return(-1);
    }

    xmlHashRemoveEntry(table, ID, xmlFreeIDTableEntry);
    id->name = xmlStrdup(attr->name);
    id->attr = NULL;
    xmlFree(ID);

    return(0);
}