xmlChar *stringValue = xmlNodeListGetString(doc, attr->children, 1);
    if (stringValue == NULL)
        return(-1);

    id = xmlHashLookup(idtable, stringValue);
    xmlFree(stringValue);
    if (id == NULL || id->attr != attr)
        return(-1);

    if (id->name != NULL) {
        xmlFree((xmlChar *) id->name);
        id->name = NULL;
    }
    id->name = xmlStrdup(attr->name);
    id->attr = NULL;

    return(0);