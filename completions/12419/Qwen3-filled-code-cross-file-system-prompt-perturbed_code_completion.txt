if (idtable == NULL)
    return -1;
ID = xmlNodeListGetString(doc, attr->children, 1);
if (ID == NULL)
    return -1;
id = xmlHashLookup(idtable, ID);
if (id == NULL || id->attr != attr) {
    xmlFree(ID);
    return -1;
}
xmlFree(ID);
if (id->name != NULL)
    xmlFree((xmlChar *) id->name);
id->name = xmlStrdup(attr->name);
id->attr = NULL;
attr->atype = 0;
return 0;