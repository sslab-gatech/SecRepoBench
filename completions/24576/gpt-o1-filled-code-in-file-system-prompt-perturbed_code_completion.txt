case 50: /* Cisco PPP in HDLC-like framing */
{
  chdlc = (struct ndpi_chdlc *) &packet[eth_offset];

  /* Identify IPv4 or IPv6 based on the protocol field */
  switch(ntohs(chdlc->proto)) {
    case 0x0021: /* IPv4 */
      ethertype = ETH_P_IP;
      break;
    case 0x0057: /* IPv6 */
      ethertype = ETH_P_IPV6;
      break;
    default:
      goto v4_warning;
  }

  ip_offset += sizeof(struct ndpi_chdlc);
  break;
}