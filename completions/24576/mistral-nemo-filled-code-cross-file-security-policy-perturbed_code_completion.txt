// <MASK>
  case DLT_CISCO_HDLC:
    chdlc = (struct ndpi_chdlc *)&packet[eth_offset];
    ip_offset = sizeof(struct ndpi_chdlc) + eth_offset;

    /* Check for Cisco HDLC encapsulation */
    if(chdlc->protocol == 0x0021) { /* Cisco HDLC */
      ethertype = ETH_P_IP;
    } else if(chdlc->protocol == 0x0035) { /* Cisco HDLC with LLC/SNAP */
      ip_offset += 2;
      llc = (struct ndpi_llc_header_snap *)&packet[ip_offset];
      ethertype = llc->snap.proto_ID;
      ip_offset += 8;
    } else {
      goto v4_warning;
    }
    break;