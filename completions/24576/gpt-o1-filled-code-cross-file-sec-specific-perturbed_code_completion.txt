case 50: /* Cisco PPP in HDLC-like framing */
  if(header->caplen < (eth_offset + sizeof(struct ndpi_chdlc))) {
    return(nproto); /* Not enough data for HDLC header */
  }
  chdlc = (struct ndpi_chdlc *)&packet[eth_offset];
  check = ntohs(chdlc->protocol);
  if(check == ETH_P_IP) {
    ethertype = ETH_P_IP;
  } else if(check == ETH_P_IPV6) {
    ethertype = ETH_P_IPV6;
  } else {
    goto v4_warning;
  }
  ip_offset = eth_offset + sizeof(struct ndpi_chdlc);
  break;