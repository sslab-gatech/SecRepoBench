case DLT_C_HDLC:
    chdlc = (struct ndpi_chdlc *)&packet[eth_offset];
    switch(ntohs(chdlc->protocol)) {
    case 0x0021: /* IPv4 */
        ethertype = ETH_P_IP;
        break;
    case 0x0057: /* IPv6 */
        ethertype = ETH_P_IPV6;
        break;
    default:
        return(nproto);
    }
    ip_offset = eth_offset + sizeof(struct ndpi_chdlc);
    break;