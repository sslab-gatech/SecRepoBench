case DLT_PPP_SERIAL:
    chdlc = (struct ndpi_chdlc *)&packet[eth_offset];
    if(chdlc->address == 0xFF && chdlc->control == 0x03) {
      ethertype = ETH_P_IP;
      ip_offset = sizeof(struct ndpi_chdlc) + eth_offset;
    } else {
      goto v4_warning;
    }
    break;

  case DLT_PPP_ETHER:
    chdlc = (struct ndpi_chdlc *)&packet[eth_offset];
    if(chdlc->address == 0xFF && chdlc->control == 0x03) {
      ethertype = ETH_P_IP;
      ip_offset = sizeof(struct ndpi_chdlc) + eth_offset;
    } else {
      goto v4_warning;
    }
    break;

  case DLT_C_HDLC:
    chdlc = (struct ndpi_chdlc *)&packet[eth_offset];
    if(chdlc->address == 0xFF && chdlc->control == 0x03) {
      ethertype = ETH_P_IP;
      ip_offset = sizeof(struct ndpi_chdlc) + eth_offset;
    } else {
      goto v4_warning;
    }
    break;