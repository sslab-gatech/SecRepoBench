case DLT_C_HDLC: /* Cisco HDLC */
    chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
    ethertype = ntohs(chdlc->protocol);
    ip_offset = sizeof(struct ndpi_chdlc) + eth_offset;

    if(ethertype == ETH_P_IP || ethertype == ETH_P_IPV6) {
      /* Valid IP or IPv6 packet */
      break;
    } else {
      /* Unsupported protocol, discard packet */
      workflow->stats.total_discarded_bytes += header->len;
      return(nproto);
    }
    break;

  case DLT_PPP: /* Point-to-Point Protocol */
    if(header->caplen < eth_offset + 4)
      return(nproto); /* Too short for PPP header */

    ethertype = (packet[eth_offset + 2] << 8) + packet[eth_offset + 3];
    ip_offset = eth_offset + 4;

    if(ethertype == ETH_P_IP || ethertype == ETH_P_IPV6) {
      /* Valid IP or IPv6 packet */
      break;
    } else {
      /* Unsupported protocol, discard packet */
      workflow->stats.total_discarded_bytes += header->len;
      return(nproto);
    }
    break;