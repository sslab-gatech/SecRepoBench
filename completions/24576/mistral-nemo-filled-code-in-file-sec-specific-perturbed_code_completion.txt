struct ndpi_flow_info *get_ndpi_flow_info(struct ndpi_workflow * workflow,
					   const u_int64_t time_ms,
					   u_int16_t vlan_id,
					   ndpi_packet_tunnel tunnel_type,
					   const struct ndpi_iphdr *iph,
					   struct ndpi_ipv6hdr *iph6,
					   u_int16_t ip_offset,
					   u_int16_t ipsize,
					   u_int16_t l4_packet_len,
					   struct ndpi_tcphdr **tcph,
					   struct ndpi_udphdr **udph,
					   u_int16_t *sport, u_int16_t *dport,
					   struct ndpi_id_struct **src,
					   struct ndpi_id_struct **dst,
					   u_int8_t *proto,
					   u_int8_t **payload,
					   u_int16_t *payload_len,
					   u_int8_t *src_to_dst_direction,
					   pkt_timeval when) {
  // ... (rest of the function remains unchanged)
}