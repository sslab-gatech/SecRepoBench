case 50: /* Cisco PPP in HDLC-like framing - DLT_C_HDLC */
  if(header->caplen < eth_offset + sizeof(struct ndpi_chdlc))
    return(nproto);

  chdlc = (struct ndpi_chdlc *)&packet[eth_offset];
  switch(ntohs(chdlc->proto)) {
  case ETH_P_IP:
    ethertype = ETH_P_IP;
    break;
  case ETH_P_IPV6:
    ethertype = ETH_P_IPV6;
    break;
  default:
    goto v4_warning;
  }

  ip_offset = eth_offset + sizeof(struct ndpi_chdlc);
  break;