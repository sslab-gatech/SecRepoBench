case DLT_C_HDLC:		// Cisco PPP in HDLC-like framing
      chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
      ip_offset = 4 + eth_offset;

      if(chdlc->protocol == 0x0008) { // IPv4
	ethertype = ETH_P_IP;
      } else if(chdlc->protocol == 0x0086) { // IPv6
	ethertype = ETH_P_IPV6;
      }
      break;

    case DLT_PPP_SERIAL:		// PPP over serial
      ip_offset = 4 + eth_offset;
      if(packet[eth_offset+2] == 0x00 && packet[eth_offset+3] == 0x21) { // IPv4
	ethertype = ETH_P_IP;
      } else if(packet[eth_offset+2] == 0x00 && packet[eth_offset+3] == 0x57) { // IPv6
	ethertype = ETH_P_IPV6;
      }
      break;

    case DLT_PPP_ETHER:		// PPPoE
      ip_offset = 2 + eth_offset;
      if(packet[eth_offset] == 0x88 && packet[eth_offset+1] == 0x64) {
	ethertype = PPPoE;
      }
      break;