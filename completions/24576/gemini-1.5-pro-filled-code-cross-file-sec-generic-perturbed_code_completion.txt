case DLT_C_HDLC:		// Cisco PPP in HDLC-like framing
    chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
    ip_offset = sizeof(struct ndpi_chdlc) + eth_offset;

    if(chdlc->protocol == (0x00 << 8 | 0x21)) // 0x0021
      ethertype = ETH_P_IP;
    else if(chdlc->protocol == (0x80 << 8 | 0x21)) // 0x8021
      ethertype = ETH_P_IP;
    else if(chdlc->protocol == (0x00 << 8 | 0x57)) // 0x0057
      ethertype = ETH_P_IPV6;
    else if(chdlc->protocol == (0x80 << 8 | 0x57)) // 0x8057
      ethertype = ETH_P_IPV6;

    break;

  case DLT_PPP_SERIAL:		// PPP over serial
    ip_offset = 4 + eth_offset;
    if(packet[eth_offset+3] == 0x21)
      ethertype = ETH_P_IP;
    else if(packet[eth_offset+3] == 0x57)
      ethertype = ETH_P_IPV6;
    break;

    /* RFC 1483 LLC/SNAP-encapsulated ATM - 149 */
  case DLT_ATM_RFC1483:
    ip_offset = 0;
    ethertype = (packet[eth_offset+8] << 8) + packet[eth_offset+9];
    ip_offset = 8 + eth_offset;
    break;