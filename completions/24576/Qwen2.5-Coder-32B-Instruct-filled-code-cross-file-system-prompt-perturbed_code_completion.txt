case DLT_C_HDLC:
    chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
    fc = ntohs(chdlc->address_control_field);
    if (fc == 0x0001) { // UI frame
      ethertype = ntohs(chdlc->protocol);
      ip_offset = sizeof(struct ndpi_chdlc) + eth_offset;
    }
    break;