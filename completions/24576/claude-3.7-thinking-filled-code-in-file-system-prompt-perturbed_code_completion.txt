case DLT_PPP_SERIAL:
  chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
  ip_offset = sizeof(struct ndpi_chdlc); /* HDLC header*/
  ip_offset += eth_offset;
  
  if(chdlc->proto_code == 0x0021 /* IP */)
    ethertype = ETH_P_IP;
  else if(chdlc->proto_code == 0x0057 /* IPv6 */)
    ethertype = ETH_P_IPV6;
  break;