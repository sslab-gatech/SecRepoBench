case DLT_CISCO_HDLC:
  if(header->caplen < eth_offset + sizeof(struct ndpi_chdlc))
    return(nproto);
  chdlc = (const struct ndpi_chdlc *)&packet[eth_offset];
  ip_offset = eth_offset + sizeof(struct ndpi_chdlc);
  ethertype = ntohs(chdlc->protocol);
  break;