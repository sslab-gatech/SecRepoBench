case DLT_CISCO_HDLC:
    chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
    ethertype = ntohs(chdlc->protocol);
    ip_offset = sizeof(struct ndpi_chdlc) + eth_offset;
    break;

  case DLT_PPP:
    ethertype = ntohs(*((u_int16_t*)&packet[eth_offset + 2]));
    ip_offset = eth_offset + 4; // Skip PPP header
    break;

  case DLT_PPP_SERIAL:
    ethertype = ntohs(*((u_int16_t*)&packet[eth_offset + 2]));
    ip_offset = eth_offset + 4; // Skip PPP Serial header
    break;

  default:
    return(nproto); // Unsupported datalink type