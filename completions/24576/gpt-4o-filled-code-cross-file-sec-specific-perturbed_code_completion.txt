case DLT_C_HDLC:
    chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
    ethertype = ntohs(chdlc->proto);
    ip_offset = sizeof(struct ndpi_chdlc) + eth_offset;
    break;

  case DLT_PPP_SERIAL:
    if(ntohs(*((u_int16_t*)&packet[eth_offset])) == 0x0021)
      ethertype = ETH_P_IP;
    else if(ntohs(*((u_int16_t*)&packet[eth_offset])) == 0x0057)
      ethertype = ETH_P_IPV6;
    ip_offset = 2 + eth_offset;
    break;

  case DLT_PPP_ETHER:
    ethertype = (packet[eth_offset+6] << 8) + packet[eth_offset+7];
    ip_offset = 8 + eth_offset;
    break;