/* Handle packet processing for different Cisco PPP encapsulations */
  switch(datalink_type) {
  case DLT_EN10MB:
    /* ... (existing code) ... */
    break;

  case DLT_C_HDLC:
    chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
    ip_offset = sizeof(struct ndpi_chdlc) + eth_offset;
    check = ntohs(chdlc->protocol);

    if(check == 0x0021) { /* IP */
      ethertype = ETH_P_IP;
    } else if(check == 0x0035) { /* AppleTalk */
      ethertype = ETH_P_APPLEtalk;
    } else {
      /* Unknown protocol, skip this packet */
      return(nproto);
    }
    break;

  case DLT_C_HDLC_FAST:
    /* Similar to DLT_C_HDLC, but with faster processing */
    /* ... (similar code as DLT_C_HDLC) ... */
    break;

  default:
    /* Unknown datalink type, skip this packet */
    return(nproto);
  }