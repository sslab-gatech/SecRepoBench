case DLT_C_HDLC: // Cisco PPP in HDLC-like framing
    chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
    ip_offset = 4 + eth_offset;

    if (chdlc->protocol == 0x0008) { // IPv4
        ethertype = ETH_P_IP;
    } else if (chdlc->protocol == 0x86DD) { // IPv6
        ethertype = ETH_P_IPV6;
    }
    break;

case DLT_PPP_SERIAL: // PPP over serial
    ip_offset = 4 + eth_offset;
    u_int16_t ppp_proto = ntohs(*(u_int16_t *)&packet[eth_offset + 2]);

    if (ppp_proto == 0x0021) { // IPv4
        ethertype = ETH_P_IP;
    } else if (ppp_proto == 0x0057) { // IPv6
        ethertype = ETH_P_IPV6;
    }
    break;

case DLT_PPP_ETHER: // PPPoE
    ip_offset = eth_offset + 2;
    u_int16_t pppoe_proto = ntohs(*(u_int16_t *)&packet[ip_offset]);
    ip_offset += 2;

    if (pppoe_proto == 0x0008) { // IPv4
        ethertype = ETH_P_IP;
    } else if (pppoe_proto == 0x86DD) { // IPv6
        ethertype = ETH_P_IPV6;
    }
    break;