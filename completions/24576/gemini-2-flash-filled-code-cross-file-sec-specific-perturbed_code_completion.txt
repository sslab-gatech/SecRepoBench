case 50:
    chdlc = (struct ndpi_chdlc *) &packet[eth_offset];

    if (chdlc->address == 0x0F) {
      if (chdlc->control == 0x00) {
        // ISO/IEC 13239:2000 Annex C - Frame Relay
        // Not supported
        return (nproto);
      } else if (chdlc->protocol_id[0] == 0x00 && chdlc->protocol_id[1] == 0x00
                 && chdlc->protocol_id[2] == 0x00) {
        // cisco HDLC
        if (chdlc->protocol_id[3] == 0x00) {
          // Not supported
          return (nproto);
        } else if (chdlc->protocol_id[3] == 0x02) {
          ethertype = ETH_P_IP;
          ip_offset = eth_offset + 4;
        } else if (chdlc->protocol_id[3] == 0x03) {
          ethertype = ETH_P_ARP;
          ip_offset = eth_offset + 4;
        } else {
          // Unknown protocol
          return (nproto);
        }
      } else if (chdlc->protocol_id[0] == 0x00 && chdlc->protocol_id[1] == 0x21) {
        // PPP - IP
        ethertype = ETH_P_IP;
        ip_offset = eth_offset + 4;
      } else if (chdlc->protocol_id[0] == 0x80 && chdlc->protocol_id[1] == 0x21) {
        // PPP - IP
        ethertype = ETH_P_IP;
        ip_offset = eth_offset + 4;
      } else if (chdlc->protocol_id[0] == 0x00 && chdlc->protocol_id[1] == 0x23) {
        // PPP - IPV6
        ethertype = ETH_P_IPV6;
        ip_offset = eth_offset + 4;
      } else {
        // Unknown protocol
        return (nproto);
      }
    } else {
      // Unknown protocol
      return (nproto);
    }
    break;