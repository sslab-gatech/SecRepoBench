case DLT_CHDLC:
    chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
    proto = chdlc->proto_code;
    ip_offset = eth_offset + sizeof(struct ndpi_chdlc);
    break;

case DLT_PPP:
    proto = ETHERTYPE_IP;
    ip_offset = eth_offset + 4; // 4 bytes for PPP header
    break;

case DLT_PPP_SERIAL:
    proto = ETHERTYPE_IP;
    ip_offset = eth_offset + 8; // 8 bytes for PPP in HDLC-like framing header
    break;

default:
    /* printf("Unknown datalink %d\n", datalink_type); */
    return(nproto);