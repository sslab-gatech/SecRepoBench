case DLT_C_HDLC:
    if(header->caplen < eth_offset + 4)
      return(nproto); /* Too short for HDLC header */

    chdlc = (struct ndpi_chdlc *)&packet[eth_offset];
    proto = chdlc->proto;

    if(proto == 0x0000)
      ethertype = ETH_P_IP;
    else if(proto == 0x0001)
      ethertype = ETH_P_IPV6;
    else
      ethertype = proto;

    ip_offset = eth_offset + 4;
    break;