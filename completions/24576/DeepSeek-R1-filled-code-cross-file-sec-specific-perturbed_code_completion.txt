case DLT_PPP_SERIAL: /* Cisco HDLC */
    if(header->caplen < eth_offset + sizeof(struct ndpi_chdlc))
        return(nproto); /* Insufficient data for CHDLC header */

    chdlc = (struct ndpi_chdlc *)&packet[eth_offset];
    switch(ntohs(chdlc->protocol)) {
    case CHDLC_PROTO_IP:
        ethertype = ETH_P_IP;
        break;
    case CHDLC_PROTO_IPV6:
        ethertype = ETH_P_IPV6;
        break;
    default:
        return(nproto); /* Unsupported protocol */
    }
    ip_offset = eth_offset + sizeof(struct ndpi_chdlc);
    break;