case DLT_C_HDLC: {
  chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
  if (header->caplen < eth_offset + sizeof(struct ndpi_chdlc))
    return(nproto); /* Too short for CHDLC header */

  if (chdlc->address == CHDLC_UNICAST) {
    if (chdlc->control == CHDLC_UI) {
      ethertype = ntohs(chdlc->protocol);
      ip_offset = sizeof(struct ndpi_chdlc) + eth_offset;
    } else {
      return(nproto); /* Unsupported control field */
    }
  } else {
    return(nproto); /* Unsupported address field */
  }
  break;
}