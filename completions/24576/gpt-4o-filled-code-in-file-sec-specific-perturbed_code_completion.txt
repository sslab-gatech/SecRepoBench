case DLT_C_HDLC:
    chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
    ip_offset = sizeof(struct ndpi_chdlc) + eth_offset;
    check = ntohs(chdlc->proto_code);

    if(check == CISCO_D_PROTO) {
      ethertype = ETH_P_IP;
    } else if(check == SLARP) {
      goto v4_warning;
    } else {
      ethertype = check;
    }
    break;