case DLT_PPP:
  case DLT_PPP_SERIAL:
    chdlc = (struct ndpi_chdlc *) &packet[eth_offset];

    if(ntohs(chdlc->address) == 0xFF) {
      ethertype = ntohs(chdlc->protocol);
      ip_offset = sizeof(struct ndpi_chdlc) + eth_offset;
    }
    break;