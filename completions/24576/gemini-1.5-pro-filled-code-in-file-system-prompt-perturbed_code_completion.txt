case DLT_C_HDLC:		/* Cisco HDLC - 104 */
    chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
    ip_offset = 4 + eth_offset;
    if(chdlc->protocol == 0x0008) { /* IPv4 */
      ethertype = ETH_P_IP;
    } else if(chdlc->protocol == 0x86DD) { /* IPv6 */
      ethertype = ETH_P_IPV6;
    }
    break;

  case DLT_PPP_SERIAL:		/* PPP over serial - 50 */
    ip_offset = 4 + eth_offset;
    if(packet[eth_offset+3] == 0x21) { /* IPv4 */
      ethertype = ETH_P_IP;
    } else if(packet[eth_offset+3] == 0x57) { /* IPv6 */
      ethertype = ETH_P_IPV6;
    }
    break;

  case DLT_PPP_ETHER:		/* PPPoE discovery messages - 51 */
    ip_offset = 4 + eth_offset;
    if(packet[eth_offset+3] == 0x21) { /* IPv4 */
      ethertype = ETH_P_IP;
    } else if(packet[eth_offset+3] == 0x57) { /* IPv6 */
      ethertype = ETH_P_IPV6;
    }
    break;

  case DLT_HDLC: /* Cisco HDLC - 149 */
    chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
    ip_offset = 4 + eth_offset;
    if(chdlc->protocol == 0x0008) { /* IPv4 */
      ethertype = ETH_P_IP;
    } else if(chdlc->protocol == 0x86DD) { /* IPv6 */
      ethertype = ETH_P_IPV6;
    }
    break;