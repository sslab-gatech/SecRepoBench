case DLT_C_HDLC:
    chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
    if(ntohs(chdlc->proto) == ETH_P_IP) {
      ethertype = ETH_P_IP;
      ip_offset = sizeof(struct ndpi_chdlc) + eth_offset;
    } else if(ntohs(chdlc->proto) == ETH_P_IPV6) {
      ethertype = ETH_P_IPV6;
      ip_offset = sizeof(struct ndpi_chdlc) + eth_offset;
    }
    break;