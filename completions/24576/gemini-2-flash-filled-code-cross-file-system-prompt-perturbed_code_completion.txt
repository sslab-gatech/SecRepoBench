case 50: /* Cisco PPP in HDLC-like framing */
  case 166: /* RFC 2686 - Cisco HDLC */
    chdlc = (struct ndpi_chdlc *) &packet[eth_offset];

    if (chdlc->address == 0x0F) {
      if (chdlc->control == 0x00) {
        ethertype = ntohs(chdlc->protocol_id);
        ip_offset = eth_offset + 4;
      } else {
        goto v4_warning;
      }
    } else {
      goto v4_warning;
    }
    break;