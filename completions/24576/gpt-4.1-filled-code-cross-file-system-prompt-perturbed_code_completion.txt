case DLT_C_HDLC: /* Cisco HDLC */
  chdlc = (struct ndpi_chdlc *)&packet[eth_offset];
  if(header->caplen < eth_offset + sizeof(struct ndpi_chdlc))
    return(nproto); /* Too short for CHDLC header */
  ethertype = ntohs(chdlc->protocol);
  ip_offset = eth_offset + sizeof(struct ndpi_chdlc);
  break;

case DLT_PPP_SERIAL: /* PPP serial */
  /* PPP in HDLC-like framing (RFC 1662) */
  if(header->caplen < eth_offset + 4)
    return(nproto); /* Too short for PPP header */
  /* Protocol field is at offset 2 */
  ethertype = (packet[eth_offset+2] << 8) + packet[eth_offset+3];
  ip_offset = eth_offset + 4;
  break;