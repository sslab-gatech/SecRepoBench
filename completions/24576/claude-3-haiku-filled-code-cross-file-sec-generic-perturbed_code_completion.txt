case DLT_CHDLC:
    chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
    ethertype = ntohs(chdlc->proto_code);
    ip_offset = sizeof(struct ndpi_chdlc) + eth_offset;
    break;

case DLT_PPP:
    ethertype = ETH_P_IP;
    ip_offset = 4 + eth_offset;
    break;

case DLT_PPP_SERIAL:
    ethertype = ETH_P_IP;
    ip_offset = 2 + eth_offset;
    break;

case DLT_PPP_ETHER:
    ethertype = ETH_P_PPP_SES;
    ip_offset = sizeof(struct ndpi_ethhdr) + eth_offset;
    break;

default:
    /* printf("Unknown datalink %d\n", datalink_type); */
    return(nproto);