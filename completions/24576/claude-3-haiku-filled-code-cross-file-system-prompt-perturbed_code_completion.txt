case DLT_CHDLC:
case DLT_PPP:
  chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
  proto = ntohs(chdlc->proto_code);
  ip_offset = eth_offset + sizeof(struct ndpi_chdlc);
  break;

case DLT_LOOP:
  if(ntohl(*((u_int32_t*)&packet[eth_offset])) == 2)
    ethertype = ETH_P_IP;
  else
    ethertype = ETH_P_IPV6;

  ip_offset = 4 + eth_offset;
  break;