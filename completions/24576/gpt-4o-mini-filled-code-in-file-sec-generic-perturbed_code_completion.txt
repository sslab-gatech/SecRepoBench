case DLT_C_HDLC:
    case DLT_PPP:
    case DLT_PPP_ETHER:
      ethertype = ntohs(*((u_int16_t*)&packet[ip_offset + 2]));
      ip_offset += 4; // Skip PPP header
      break;