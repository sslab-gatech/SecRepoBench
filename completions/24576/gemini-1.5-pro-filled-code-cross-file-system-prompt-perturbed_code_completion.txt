case DLT_C_HDLC:            // Cisco PPP Serial
    chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
    if(chdlc->address != 0xFF || chdlc->control != 0x03)
      return(nproto);

    ip_offset = CHDLC_HEADER_LEN + eth_offset;
    ethertype = (packet[ip_offset] << 8) + packet[ip_offset+1];
    ip_offset += 2;
    break;

  case DLT_PPP_SERIAL:       // PPP over serial
    ip_offset = 4 + eth_offset;
    ethertype = (packet[eth_offset] << 8) + packet[eth_offset+1];
    break;

  case DLT_PPP_ETHER:       // PPPoE
    ip_offset = 4 + eth_offset;
    ethertype = ETH_P_PPP_SES;
    break;