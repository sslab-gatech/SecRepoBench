case 50: /* Cisco PPP in HDLC-like framing */
    if (header->caplen < eth_offset + sizeof(struct ndpi_chdlc))
      return(nproto);

    chdlc = (struct ndpi_chdlc *)&packet[eth_offset];
    ip_offset = eth_offset + sizeof(struct ndpi_chdlc);
    check = ntohs(chdlc->proto_code);

    if(check == ETH_P_IP) {
      ethertype = ETH_P_IP;
    } else if(check == ETH_P_IPV6) {
      ethertype = ETH_P_IPV6;
    } else {
      goto v4_warning;
    }
    break;