case DLT_CHDLC: {
    if (header->caplen < eth_offset + sizeof(struct ndpi_chdlc))
        return(nproto); /* Packet too short for Cisco HDLC header */
    chdlc = (const struct ndpi_chdlc *) &packet[eth_offset];
    ethertype = ntohs(chdlc->protocol);
    ip_offset = eth_offset + sizeof(struct ndpi_chdlc);
    break;
}