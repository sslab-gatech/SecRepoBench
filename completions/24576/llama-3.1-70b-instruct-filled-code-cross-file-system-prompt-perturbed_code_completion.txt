case DLT_C_HDLC:
  chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
  if(chdlc->address == 0 && chdlc->control == 0x0F) {
    ip_offset = 4 + eth_offset;
    ethertype = ETH_P_IP;
  } else {
    ip_offset = 4 + eth_offset;
    ethertype = ETH_P_IPV6;
  }
  break;

case DLT_PPP_SERIAL:
  ip_offset = 4 + eth_offset;
  ethertype = ETH_P_IP;
  break;

case DLT_PPP_ETHER:
  ip_offset = 4 + eth_offset;
  ethertype = ETH_P_IPV6;
  break;

case DLT_FDDI:
  ip_offset = 13 + eth_offset;
  ethertype = ETH_P_IP;
  break;

case DLT_ATM_RFC1483:
  ip_offset = 0 + eth_offset;
  ethertype = ETH_P_IP;
  break;

case DLT_RAW:
  ip_offset = 0 + eth_offset;
  ethertype = ETH_P_IP;
  break;

case DLT_C_HDLC:
  chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
  if(chdlc->address == 0 && chdlc->control == 0x0F) {
    ip_offset = 4 + eth_offset;
    ethertype = ETH_P_IP;
  } else {
    ip_offset = 4 + eth_offset;
    ethertype = ETH_P_IPV6;
  }
  break;