case 50 /* Cisco PPP in HDLC-like framing */:
  case 166 /* Cisco PPP in HDLC-like framing with IPv6*/:
    chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
    if (chdlc->address == 0x0F && chdlc->control == 0x00) {
      if (chdlc->protocol_id == 0x0021) {
        ethertype = ETH_P_IP;
        ip_offset = eth_offset + 4;
      } else if (chdlc->protocol_id == 0x0057) {
        ethertype = ETH_P_IPV6;
        ip_offset = eth_offset + 4;
      } else {
        return (nproto);
      }
    } else {
      return(nproto);
    }
    break;