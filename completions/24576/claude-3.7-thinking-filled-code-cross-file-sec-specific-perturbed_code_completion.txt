case DLT_PPP_SERIAL: /* Cisco PPP in HDLC-like framing - 50 */
  if(header->caplen < eth_offset + sizeof(struct ndpi_chdlc))
    return(nproto); /* Too short for HDLC header*/
  chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
  ip_offset = sizeof(struct ndpi_chdlc) + eth_offset;
  ethertype = ntohs(chdlc->proto_code);
  break;

case DLT_C_HDLC: /* Cisco HDLC - 104 */
  if(header->caplen < eth_offset + sizeof(struct ndpi_chdlc))
    return(nproto); /* Too short for HDLC header*/
  chdlc = (struct ndpi_chdlc *) &packet[eth_offset];
  ip_offset = sizeof(struct ndpi_chdlc) + eth_offset;
  ethertype = ntohs(chdlc->proto_code);
  break;