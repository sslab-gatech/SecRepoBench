if (memcmp(tag, "SNI\0", 4) == 0) {
    sni_len = len;
    if (sni_len >= sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name))
        sni_len = sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name) - 1;
    memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
           crypto_data + tag_offset_start + prev_offset,
           sni_len);
    flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[sni_len] = '\0';
#ifdef QUIC_DEBUG
    NDPI_LOG_DBG(detectionmodule, "Extracted SNI: %s", flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
#endif
    sni_found = 1;
} else if (memcmp(tag, "UAID", 4) == 0) {
    uint32_t ua_len = len;
#ifdef QUIC_DEBUG
    NDPI_LOG_DBG(detectionmodule, "Extracted UAID: %.*s", ua_len, crypto_data + tag_offset_start + prev_offset);
#endif
    ndpi_process_http_user_agent(detectionmodule, flow,
                                   crypto_data + tag_offset_start + prev_offset,
                                   ua_len);
    ua_found = 1;
}
if (sni_found && ua_found)
    return;