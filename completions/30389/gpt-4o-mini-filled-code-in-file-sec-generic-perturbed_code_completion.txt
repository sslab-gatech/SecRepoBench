if (memcmp(tag, "SNI\0", 4) == 0) {
        sni_len = le32toh(*((u_int32_t *)&tag[4]));
        if (sni_len > 0 && sni_len + 8 <= crypto_data_len) {
            memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
                   &crypto_data[8 + 8 * num_tags], sni_len);
            flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[sni_len] = '\0';
            NDPI_LOG_DBG(detectionmodule, "SNI found: %s\n", flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
            sni_found = 1;
        }
    } else if (memcmp(tag, "UAID", 4) == 0) {
        ua_found = 1;
        http_process_user_agent(ndpi_struct, flow, &crypto_data[8 + 8 * num_tags], crypto_data_len - (8 + 8 * num_tags));
    }

    if (sni_found && ua_found) {
        return; // Both SNI and UAID processed, exit early
    }