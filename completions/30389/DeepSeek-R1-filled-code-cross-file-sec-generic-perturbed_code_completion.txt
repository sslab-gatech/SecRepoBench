if (memcmp(tag, "SNI\0", 4) == 0) {
        if (tag_offset_start + prev_offset + len > crypto_data_len)
            continue;
        const u_int8_t *sni_data = crypto_data + tag_offset_start + prev_offset;
        ndpi_strncpyn((char*)flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
                     sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name),
                     (const char*)sni_data, len);
#ifdef QUIC_DEBUG
        NDPI_LOG_DBG(detectionmodule, "QUIC SNI: %s\n", flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
#endif
        ndpi_match_host_subprotocol(detectionmodule, flow, (char*)flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
                                   strlen((char*)flow->protos.tls_quic_stun.tls_quic.client_requested_server_name), NDPI_PROTOCOL_QUIC);
        ndpi_check_dga_name(detectionmodule, flow, (char*)flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
        flow->protos.tls_quic_stun.tls_quic.hello_processed = 1;
        sni_found = 1;
    } else if (memcmp(tag, "UAID", 4) == 0) {
        if (tag_offset_start + prev_offset + len > crypto_data_len)
            continue;
        const u_int8_t *ua_data = crypto_data + tag_offset_start + prev_offset;
        char ua_buffer[256];
        ndpi_strncpyn(ua_buffer, sizeof(ua_buffer), (const char*)ua_data, len);
#ifdef QUIC_DEBUG
        NDPI_LOG_DBG(detectionmodule, "QUIC UA: %s\n", ua_buffer);
#endif
        ndpi_process_http_user_agent(detectionmodule, flow, ua_buffer);
        ua_found = 1;
    }

    if (sni_found && ua_found)
        break;