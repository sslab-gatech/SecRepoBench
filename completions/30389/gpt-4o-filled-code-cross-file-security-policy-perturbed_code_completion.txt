if(memcmp(tag, "SNI\0", 4) == 0) {
      if(len < 2 || offset + len > crypto_data_len) {
        break;
      }
      sni_len = le16toh(*(uint16_t *)&crypto_data[offset]);
      if(sni_len + 2 > len) {
        break;
      }
      if(sni_len < sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name)) {
        memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
               &crypto_data[offset + 2], sni_len);
        flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[sni_len] = '\0';
#ifdef QUIC_DEBUG
        NDPI_LOG_DBG(detectionmodule, "SNI: %s\n", flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
#endif
        sni_found = 1;
        ret_match = ndpi_match_subprotocol(detectionmodule, flow, flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
        if(ret_match == NDPI_PROTOCOL_MATCHED) {
          return;
        }
      }
    } else if(memcmp(tag, "UAID", 4) == 0) {
      if(len < 1 || offset + len > crypto_data_len) {
        break;
      }
      if(len < sizeof(flow->protos.tls_quic_stun.tls_quic.user_agent)) {
        memcpy(flow->protos.tls_quic_stun.tls_quic.user_agent, &crypto_data[offset], len);
        flow->protos.tls_quic_stun.tls_quic.user_agent[len] = '\0';
#ifdef QUIC_DEBUG
        NDPI_LOG_DBG(detectionmodule, "User-Agent: %s\n", flow->protos.tls_quic_stun.tls_quic.user_agent);
#endif
        ua_found = 1;
        ndpi_search_http_user_agent(detectionmodule, flow, flow->protos.tls_quic_stun.tls_quic.user_agent);
      }
    }

    if(sni_found && ua_found) {
      return;
    }