if(memcmp(tag, "SNI\0", 4) == 0) {
  sni_len = len > 255 ? 255 : len;
  memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name, &crypto_data[tag_offset_start + offset], sni_len);
  flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[sni_len] = '\0';
  
  NDPI_LOG_DBG2(detectionmodule, "SNI: %s\n", flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
  
  ndpi_match_host_subprotocol(detectionmodule, flow,
                              (char *)flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
                              strlen((const char*)flow->protos.tls_quic_stun.tls_quic.client_requested_server_name),
                              &ret_match, NDPI_PROTOCOL_QUIC);
  
  if(ndpi_is_valid_hostname((char *)flow->protos.tls_quic_stun.tls_quic.client_requested_server_name) == 0) {
    ndpi_set_risk(detectionmodule, flow, NDPI_INVALID_CHARACTERS);
  }
  
  flow->protos.tls_quic_stun.tls_quic.hello_processed = 1;
  sni_found = 1;
} else if(memcmp(tag, "UAID", 4) == 0) {
  if(len <= 255) {
    memcpy(flow->protos.tls_quic_stun.tls_quic.user_agent, &crypto_data[tag_offset_start + offset], len);
    flow->protos.tls_quic_stun.tls_quic.user_agent[len] = '\0';
    
    NDPI_LOG_DBG2(detectionmodule, "User Agent: %s\n", flow->protos.tls_quic_stun.tls_quic.user_agent);
    
    ndpi_match_content_subprotocol(detectionmodule, flow,
                                   (char *)flow->protos.tls_quic_stun.tls_quic.user_agent,
                                   strlen((const char*)flow->protos.tls_quic_stun.tls_quic.user_agent),
                                   &ret_match, NDPI_PROTOCOL_QUIC);
    ua_found = 1;
  }
}

if(sni_found && ua_found) {
  return;
}