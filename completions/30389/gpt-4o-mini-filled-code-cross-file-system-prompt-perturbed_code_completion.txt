if(memcmp(tag, "SNI\0", 4) == 0) {
        sni_len = offset - tag_offset_start;
        if(sni_len > 0 && sni_len < sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name)) {
            memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name, &crypto_data[tag_offset_start], sni_len);
            flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[sni_len] = '\0';
            NDPI_LOG_DBG(detectionmodule, "SNI found: %s\n", flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
            sni_found = 1;
            // Perform matching against known subprotocols and check for DGA here
        }
    } else if(memcmp(tag, "UAID", 4) == 0) {
        // Extract UAID information
        uint32_t uaid_len = offset - tag_offset_start;
        NDPI_LOG_DBG(detectionmodule, "UAID found, length: %u\n", uaid_len);
        // Process UAID as needed
        ua_found = 1;
    }

    if(sni_found && ua_found) {
        return; // Both SNI and UAID processed, exit early
    }