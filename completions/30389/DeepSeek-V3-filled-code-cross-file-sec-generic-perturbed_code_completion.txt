if(memcmp(tag, "SNI\0", 4) == 0) {
      if(offset + len > crypto_data_len)
        break;
      sni_len = len;
      if(sni_len >= sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name))
        sni_len = sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name) - 1;
      memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
             &crypto_data[offset], sni_len);
      flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[sni_len] = '\0';
#ifdef QUIC_DEBUG
      NDPI_LOG_DBG(detectionmodule, "Found SNI: %s\n",
                   flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
#endif
      ndpi_match_host_subprotocol(detectionmodule, flow,
                                 flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
                                 sni_len, &ret_match);
      ndpi_check_dga_name(detectionmodule, flow,
                          flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
      sni_found = 1;
    } else if(memcmp(tag, "UAID", 4) == 0) {
      if(offset + len > crypto_data_len)
        break;
#ifdef QUIC_DEBUG
      NDPI_LOG_DBG(detectionmodule, "Found UAID: %.*s\n", len, &crypto_data[offset]);
#endif
      ndpi_http_process_user_agent(detectionmodule, flow, &crypto_data[offset], len);
      ua_found = 1;
    }
    if(sni_found && ua_found)
      break;