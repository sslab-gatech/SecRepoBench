if(memcmp(tag, "SNI\0", 4) == 0 && !sni_found) {
  if(len > 0 && (tag_offset_start + prev_offset + len) <= crypto_data_len) {
    sni_len = len > (sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name) - 1)
      ? (sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name) - 1)
      : len;
    memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
           &crypto_data[tag_offset_start + prev_offset], sni_len);
    flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[sni_len] = '\0';
#ifdef QUIC_DEBUG
    NDPI_LOG_DBG(detectionmodule, "QUIC SNI: %s\n",
                 flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
#endif
    ret_match = ndpi_match_tls_sni(detectionmodule, flow,
                                   flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
                                   sni_len);
    if(ret_match.dga_match)
      ndpi_set_risk(detectionmodule, flow, NDPI_TLS_DGA_SNI);
    flow->protos.tls_quic_stun.tls_quic.hello_processed = 1;
    sni_found = 1;
  }
} else if(memcmp(tag, "UAID", 4) == 0 && !ua_found) {
  if(len > 0 && (tag_offset_start + prev_offset + len) <= crypto_data_len) {
    char ua[256];
    uint32_t ua_len = len > (sizeof(ua) - 1) ? (sizeof(ua) - 1) : len;
    memcpy(ua, &crypto_data[tag_offset_start + prev_offset], ua_len);
    ua[ua_len] = '\0';
#ifdef QUIC_DEBUG
    NDPI_LOG_DBG(detectionmodule, "QUIC UAID: %s\n", ua);
#endif
    ndpi_process_http_user_agent(detectionmodule, flow, ua, ua_len);
    ua_found = 1;
  }
}
if(sni_found && ua_found)
  return;