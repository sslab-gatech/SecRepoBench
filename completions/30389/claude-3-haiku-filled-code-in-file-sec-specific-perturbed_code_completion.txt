if(strncmp((char *)&clear_payload[counter], "SNI\0", 4) == 0) {
  counter += 4;
  sni_len = gquic_get_u16(&clear_payload[counter], version);
  counter += 2;
  if(sni_len + counter <= clear_payload_len) {
    memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
           &clear_payload[counter], sni_len);
    flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[sni_len] = '\0';
    NDPI_LOG_DBG(detectionmodule, "SNI: [%s]\n", flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
    sni_found = 1;
    ndpi_match_host_subprotocol(detectionmodule, flow,
                                flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
                                strlen(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name),
                                &ret_match);
    ndpi_check_dga_name(detectionmodule, flow,
                        flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
                        strlen(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name));
    flow->protos.tls_quic_stun.tls_quic.hello_processed = 1;
  }
} else if(strncmp((char *)&clear_payload[counter], "UAID", 4) == 0) {
  counter += 4;
  len = gquic_get_u16(&clear_payload[counter], version);
  counter += 2;
  if(len + counter <= clear_payload_len) {
    http_process_user_agent(detectionmodule, flow, &clear_payload[counter], len);
    ua_found = 1;
  }
}

if(sni_found && ua_found)
  return;