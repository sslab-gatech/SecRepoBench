if(memcmp(tag, "SNI\0", 3) == 0) {
      sni_len = tag[3];
      if(offset + sni_len > crypto_data_len)
        break;
      memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name, &crypto_data[offset], sni_len);
      flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[sni_len] = '\0';
      NDPI_LOG_DBG(detectionmodule, "Found SNI: %.*s\n", sni_len, flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
      sni_found = 1;
    } else if(memcmp(tag, "UAID", 4) == 0) {
      if(offset + 16 > crypto_data_len)
        break;
      memcpy(flow->protos.tls_quic_stun.tls_quic.user_agent_id, &crypto_data[offset], 16);
      flow->protos.tls_quic_stun.tls_quic.user_agent_id[16] = '\0';
      NDPI_LOG_DBG(detectionmodule, "Found UAID: %s\n", flow->protos.tls_quic_stun.tls_quic.user_agent_id);
      ua_found = 1;
      // Process the user agent information using the HTTP user agent handling function
      // This is a placeholder for the actual processing function
    }

    if(sni_found && ua_found) {
      NDPI_LOG_DBG(detectionmodule, "Both SNI and UAID found, processing complete\n");
      return;
    }