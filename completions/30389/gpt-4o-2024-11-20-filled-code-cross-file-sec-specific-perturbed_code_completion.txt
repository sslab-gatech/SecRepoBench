if (len > 0 && tag[0] == 'S' && tag[1] == 'N' && tag[2] == 'I' && tag[3] == '\0') {
      if (len >= sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name)) {
        NDPI_LOG_ERR(detectionmodule, "SNI length exceeds buffer size");
        return;
      }
      memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
             &crypto_data[tag_offset_start + prev_offset], len);
      flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[len] = '\0';
      NDPI_LOG_DBG(detectionmodule, "SNI: %s\n",
                   flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
      sni_found = 1;

      ret_match = ndpi_match_subprotocol(detectionmodule, flow,
                                         flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
      if (ret_match.is_dga) {
        ndpi_set_risk(detectionmodule, flow, NDPI_TLS_DGA_DOMAIN);
      }
    } else if (len > 0 && tag[0] == 'U' && tag[1] == 'A' && tag[2] == 'I' && tag[3] == 'D') {
      if (len >= sizeof(flow->protos.tls_quic_stun.tls_quic.user_agent)) {
        NDPI_LOG_ERR(detectionmodule, "UAID length exceeds buffer size");
        return;
      }
      memcpy(flow->protos.tls_quic_stun.tls_quic.user_agent,
             &crypto_data[tag_offset_start + prev_offset], len);
      flow->protos.tls_quic_stun.tls_quic.user_agent[len] = '\0';
      NDPI_LOG_DBG(detectionmodule, "UAID: %s\n",
                   flow->protos.tls_quic_stun.tls_quic.user_agent);
      ua_found = 1;

      ndpi_process_http_user_agent(detectionmodule, flow,
                                   flow->protos.tls_quic_stun.tls_quic.user_agent);
    }

    if (sni_found && ua_found) {
      break;
    }