if (memcmp(tag, "SNI\0", 4) == 0) {
        sni_len = len < sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name) - 1 ? len : sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name) - 1;
        memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name, crypto_data + tag_offset_start + prev_offset, sni_len);
        flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[sni_len] = '\0';
#ifdef QUIC_DEBUG
        NDPI_LOG_DBG(detectionmodule, "Found SNI: %s\n", flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
#endif
        ndpi_match_host_subprotocol(detectionmodule, flow, flow->protos.tls_quic_stun.tls_quic.client_requested_server_name, sni_len, &ret_match, 0);
        if(ret_match.protocol_id != NDPI_PROTOCOL_UNKNOWN) {
            ndpi_set_detected_protocol(detectionmodule, flow, ret_match.protocol_id, NDPI_PROTOCOL_QUIC);
        }
        if(ndpi_check_dga_name(detectionmodule, flow, flow->protos.tls_quic_stun.tls_quic.client_requested_server_name)) {
            ndpi_set_risk(detectionmodule, flow, NDPI_DGA_DOMAIN);
        }
        flow->protos.tls_quic_stun.tls_quic.hello_processed = 1;
        sni_found = 1;
    } else if (memcmp(tag, "UAID", 4) == 0) {
        uint16_t ua_len = len < sizeof(flow->protos.tls_quic_stun.tls_quic.user_agent) - 1 ? len : sizeof(flow->protos.tls_quic_stun.tls_quic.user_agent) - 1;
        memcpy(flow->protos.tls_quic_stun.tls_quic.user_agent, crypto_data + tag_offset_start + prev_offset, ua_len);
        flow->protos.tls_quic_stun.tls_quic.user_agent[ua_len] = '\0';
#ifdef QUIC_DEBUG
        NDPI_LOG_DBG(detectionmodule, "Found UA: %s\n", flow->protos.tls_quic_stun.tls_quic.user_agent);
#endif
        ndpi_http_parse_user_agent(detectionmodule, flow, flow->protos.tls_quic_stun.tls_quic.user_agent, ua_len);
        ua_found = 1;
    }

    if(sni_found && ua_found)
        break;