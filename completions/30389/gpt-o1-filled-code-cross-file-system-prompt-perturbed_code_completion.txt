/* Check for known tags */
    if(!memcmp(tag, "SNI\0", 4)) {
      /* Extract SNI if not yet found */
      if(!sni_found && (len > 0)) {
        sni_len = (len < sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name) - 1)
                    ? len
                    : (sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name) - 1);
        memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
               &crypto_data[tag_offset_start + prev_offset],
               sni_len);
        flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[sni_len] = '\0';
#ifdef QUIC_DEBUG
        NDPI_LOG_DBG(detectionmodule, "QUIC SNI: %s\n",
                     flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
#endif
        /* Here you could invoke additional matching logic for subprotocols or DGA checks */
        sni_found = 1;
        /* Return early if both fields are found */
        if(sni_found && ua_found) return;
      }
    } else if(!memcmp(tag, "UAID", 4)) {
      /* Extract User-Agent if not yet found */
      if(!ua_found && (len > 0)) {
        uint32_t ua_len = (len < sizeof(flow->protos.http.user_agent) - 1)
                            ? len
                            : (sizeof(flow->protos.http.user_agent) - 1);
        memcpy(flow->protos.http.user_agent,
               &crypto_data[tag_offset_start + prev_offset],
               ua_len);
        flow->protos.http.user_agent[ua_len] = '\0';
#ifdef QUIC_DEBUG
        NDPI_LOG_DBG(detectionmodule, "QUIC UAID: %s\n", flow->protos.http.user_agent);
#endif
        /* Process the HTTP user agent if needed */
        ua_found = 1;
        /* Return early if both fields are found */
        if(sni_found && ua_found) return;
      }
    }