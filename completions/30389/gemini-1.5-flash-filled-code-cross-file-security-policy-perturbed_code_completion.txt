if (len > 0) {
      uint8_t *tag_value = (uint8_t *) &crypto_data[tag_offset_start + len];
      uint32_t tag_value_len = 0;
      if (memcmp(tag, "SNI\0", 4) == 0) {
        tag_value_len = le32toh(*((uint32_t *)tag_value));
        if (tag_offset_start + len + 4 + tag_value_len <= crypto_data_len) {
          memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
                 tag_value + 4, tag_value_len);
          flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[tag_value_len] = '\0';
          NDPI_LOG_DBG(detectionmodule, "SNI: %s\n",
                       flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
          ret_match = ndpi_match_subprotocol(detectionmodule, flow,
                                             flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
          if (ret_match == NDPI_PROTOCOL_MATCH_DGA) {
            ndpi_set_risk(detectionmodule, flow, NDPI_DGA);
          }
          sni_found = 1;
        }
      } else if (memcmp(tag, "UAID", 4) == 0) {
        tag_value_len = le32toh(*((uint32_t *)tag_value));
        if (tag_offset_start + len + 4 + tag_value_len <= crypto_data_len) {
          NDPI_LOG_DBG(detectionmodule, "UAID: %.*s\n", tag_value_len, tag_value + 4);
          ndpi_process_http_user_agent(detectionmodule, flow, tag_value + 4, tag_value_len);
          ua_found = 1;
        }
      }
    }
    if (sni_found && ua_found)
      break;