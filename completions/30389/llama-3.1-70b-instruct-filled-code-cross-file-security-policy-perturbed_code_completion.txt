if(memcmp(tag, "SNI\0", 4) == 0) {
  sni_len = len - 4;
  if(sni_len > 0) {
    memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
           &crypto_data[prev_offset + 4], sni_len);
    flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[sni_len] = '\0';
    NDPI_LOG_DBG(detectionmodule, "SNI: %s\n",
                 flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
    ret_match = ndpi_match_subprotocol(detectionmodule,
                                       flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
                                       strlen(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name));
    if(ret_match!= NDPI_PROTOCOL_UNKNOWN) {
      ndpi_int_add_connection(detectionmodule, flow, NDPI_PROTOCOL_TLS_QUIC, ret_match);
    } else {
      ndpi_int_add_connection(detectionmodule, flow, NDPI_PROTOCOL_TLS_QUIC, NDPI_PROTOCOL_UNKNOWN);
    }
    sni_found = 1;
  }
} else if(memcmp(tag, "UAID", 4) == 0) {
  NDPI_LOG_DBG(detectionmodule, "UAID: %.*s\n", len, &crypto_data[prev_offset]);
  ndpi_parse_user_agent(detectionmodule, flow, &crypto_data[prev_offset], len);
  ua_found = 1;
}
if(sni_found && ua_found)
  return;