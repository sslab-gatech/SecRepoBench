if(memcmp(tag, "SNI\0", 4) == 0) {
      if(len > 0 && tag_offset_start + prev_offset + len <= crypto_data_len) {
        sni_len = len < sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name) - 1
                  ? len
                  : sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name) - 1;
        memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
               &crypto_data[tag_offset_start + prev_offset], sni_len);
        flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[sni_len] = '\0';
#ifdef QUIC_DEBUG
        NDPI_LOG_DBG(detectionmodule, "SNI: %s\n", flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
#endif
        ret_match = ndpi_match_subprotocol(detectionmodule, flow, flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
        if(ret_match.is_dga) {
          ndpi_set_risk(detectionmodule, flow, NDPI_TLS_DGA_DOMAIN);
        }
        sni_found = 1;
      }
    } else if(memcmp(tag, "UAID", 4) == 0) {
      if(len > 0 && tag_offset_start + prev_offset + len <= crypto_data_len) {
        char user_agent[256];
        uint32_t ua_len = len < sizeof(user_agent) - 1 ? len : sizeof(user_agent) - 1;
        memcpy(user_agent, &crypto_data[tag_offset_start + prev_offset], ua_len);
        user_agent[ua_len] = '\0';
#ifdef QUIC_DEBUG
        NDPI_LOG_DBG(detectionmodule, "User-Agent: %s\n", user_agent);
#endif
        ndpi_search_http_user_agent(detectionmodule, flow, user_agent, ua_len);
        ua_found = 1;
      }
    }

    if(sni_found && ua_found) {
      break;
    }