if (len + 8 + 8 * i > crypto_data_len) {
      break; // Prevent overflow
    }
    if (memcmp(tag, "SNI\0", 4) == 0) {
      sni_len = len - 4; // Length of SNI
      if (sni_len > sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name) - 1) {
        sni_len = sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name) - 1; // Prevent overflow
      }
      memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name, &tag[4], sni_len);
      flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[sni_len] = '\0'; // Null-terminate
      sni_found = 1;
      NDPI_LOG_DBG(detectionmodule, "SNI found: %s\n", flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
    } else if (memcmp(tag, "UAID", 4) == 0) {
      // Process UAID tag
      ua_found = 1;
      NDPI_LOG_DBG(detectionmodule, "UAID found\n");
    }
    if (sni_found && ua_found) {
      break; // Both tags processed, exit early
    }