if(len > 0 && tag_offset_start + offset + len <= crypto_data_len) {
      if(memcmp(tag, "SNI\0", 4) == 0) {
        const u_int8_t *sni = &crypto_data[tag_offset_start + offset];
        sni_len = len;
        if(sni_len > 0) {
          if(sni_len >= 256)
            sni_len = 255;
          memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name, sni, sni_len);
          flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[sni_len] = '\0';
          NDPI_LOG_DBG(detectionmodule, "Found SNI ([%s])\n", flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
          ret_match = ndpi_match_protocol_from_SNI(detectionmodule, flow,
                                                  flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
                                                  sni_len);
          if(ret_match == NDPI_MATCH_PROTOCOL_DGA) {
            NDPI_LOG_DBG(detectionmodule, "DGA detected\n");
            ndpi_set_risk(detectionmodule, flow, NDPI_DGA);
          }
        }
        sni_found = 1;
        flow->protos.tls_quic_stun.tls_quic.hello_processed = 1;
      } else if(memcmp(tag, "UAID", 4) == 0) {
        const u_int8_t *ua = &crypto_data[tag_offset_start + offset];
        NDPI_LOG_DBG(detectionmodule, "Found UA: [%s]\n", ua);
        http_process_user_agent(detectionmodule, flow, ua, len);
        ua_found = 1;
      }
    }
    if(sni_found && ua_found)
      return;