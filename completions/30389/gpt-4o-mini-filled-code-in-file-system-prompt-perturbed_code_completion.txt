if(memcmp(tag, "SNI\0", 4) == 0) {
      sni_len = le32toh(*((u_int32_t *)&tag[4]));
      if(sni_len > 0 && sni_len + 8 <= crypto_data_len) {
        memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
               &crypto_data[prev_offset], sni_len);
        flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[sni_len] = '\0';
        NDPI_LOG_DBG(detectionmodule, "SNI found: %s\n", flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
        sni_found = 1;
      }
    } else if(memcmp(tag, "UAID", 4) == 0) {
      uint16_t ua_len = le16toh(*(uint16_t *)&tag[4]);
      if(ua_len > 0 && ua_len + 8 <= crypto_data_len) {
        http_process_user_agent(ndpi_struct, flow, &crypto_data[prev_offset], ua_len);
        NDPI_LOG_DBG(detectionmodule, "User Agent found\n");
        ua_found = 1;
      }
    }
    if(sni_found && ua_found) {
      break; // Both SNI and UAID processed, exit early
    }