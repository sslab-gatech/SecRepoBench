if(memcmp(tag, "SNI\0", 4) == 0) {
  sni_len = len - 5;
  if(sni_len > 0) {
    memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
           &crypto_data[prev_offset + 5], sni_len);
    flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[sni_len] = '\0';
    NDPI_LOG_DBG(detectionmodule, "SNI: %s\n",
                 flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
    ret_match = ndpi_match_subprotocol(detectionmodule,
                                       flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
                                       sni_len);
    if(ret_match!= NDPI_NO_MATCH) {
      ndpi_int_add_connection(detectionmodule, flow, NDPI_QUIC, ret_match);
    }
    if(ndpi_is_dga(detectionmodule, flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
                   sni_len)) {
      ndpi_set_risk(detectionmodule, flow, NDPI_DGA);
    }
    sni_found = 1;
  }
} else if(memcmp(tag, "UAID", 4) == 0) {
  NDPI_LOG_DBG(detectionmodule, "UAID: %.*s\n", len - 4, &crypto_data[prev_offset + 4]);
  ndpi_parse_user_agent(detectionmodule, flow, &crypto_data[prev_offset + 4], len - 4);
  ua_found = 1;
}
if(sni_found && ua_found)
  return;