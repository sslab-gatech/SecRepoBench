if(len > 0) {
      if(memcmp(tag, "SNI\0", 4) == 0) {
        if(len > 255)
          len = 255;
        memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
               &crypto_data[tag_offset_start + i * 8], len);
        flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[len] = '\0';
        NDPI_LOG_DBG(detectionmodule, "SNI: [%s]\n",
                     flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
        ndpi_match_sni(detectionmodule, flow,
                       flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
                       &ret_match);
        flow->protos.tls_quic_stun.tls_quic.hello_processed = 1;
        sni_found = 1;
      } else if(memcmp(tag, "UAID", 4) == 0) {
        if(len > 65535)
          len = 65535;
        NDPI_LOG_DBG(detectionmodule, "UAID: [%.*s]\n", len, &crypto_data[tag_offset_start + i * 8]);
        http_process_user_agent(detectionmodule, flow,
                                &crypto_data[tag_offset_start + i * 8], len);
        ua_found = 1;
      }
    }
    if(sni_found && ua_found)
      break;