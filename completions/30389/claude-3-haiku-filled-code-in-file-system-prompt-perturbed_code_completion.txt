offset = tag_offset_start + len;
if(memcmp(tag, "SNI\0", 4) == 0) {
  sni_len = offset - tag_offset_start;
  if(sni_len > 0 && sni_len < sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name)) {
    memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
           &crypto_data[tag_offset_start], sni_len);
    flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[sni_len] = '\0';
    NDPI_LOG_DBG(detectionmodule, "SNI: [%s]\n", flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
    ndpi_match_host_subprotocol(detectionmodule, flow,
                                flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
                                sni_len, &ret_match);
    ndpi_check_dga_name(detectionmodule, flow,
                        flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
                        sni_len);
    sni_found = 1;
  }
} else if(memcmp(tag, "UAID", 4) == 0) {
  http_process_user_agent(detectionmodule, flow,
                          &crypto_data[tag_offset_start], offset - tag_offset_start);
  ua_found = 1;
}
if(sni_found && ua_found)
  return;