if(memcmp(tag, "SNI\0", 4) == 0) {
      /* Handle SNI data */
      if(len > 0) {
        sni_len = MIN(len, (uint32_t)(sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name) - 1));
        memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
               &crypto_data[tag_offset_start + prev_offset], sni_len);
        flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[sni_len] = '\0';
        NDPI_LOG_DBG(detectionmodule, "CHLO SNI: %s\n",
                     flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);

        ret_match = ndpi_check_for_https_subprotocol(detectionmodule, flow,
                    (char *)flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
        ndpi_int_check_dga(detectionmodule, flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);

        sni_found = 1;
        flow->protos.tls_quic_stun.tls_quic.hello_processed = 1;
      }
    } else if(memcmp(tag, "UAID", 4) == 0) {
      /* Handle UA data */
      if(len > 0) {
        uint32_t ua_len = MIN(len, 512U);
        NDPI_LOG_DBG(detectionmodule, "CHLO UAID present, length=%u\n", ua_len);
        http_process_user_agent(detectionmodule, flow,
                                &crypto_data[tag_offset_start + prev_offset],
                                (u_int16_t)ua_len);
        ua_found = 1;
      }
    }

    if(sni_found && ua_found) {
      /* Both fields found, no need to continue */
      NDPI_LOG_DBG(detectionmodule, "CHLO: both SNI and UA found\n");
      return;
    }