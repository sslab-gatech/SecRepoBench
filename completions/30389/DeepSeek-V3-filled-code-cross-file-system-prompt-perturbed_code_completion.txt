if(memcmp(tag, "SNI\0", 4) == 0) {
      sni_len = len;
      if(sni_len > 0 && tag_offset_start + offset + sni_len <= crypto_data_len) {
        const u_int8_t *sni_ptr = &crypto_data[tag_offset_start + offset];
        strncpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
                (const char *)sni_ptr, sni_len);
        flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[sni_len] = '\0';
#ifdef QUIC_DEBUG
        NDPI_LOG_DBG(detectionmodule, "Found SNI: %s\n",
                     flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
#endif
        ndpi_match_host_subprotocol(detectionmodule, flow,
                                   (const char *)sni_ptr, sni_len,
                                   NDPI_PROTOCOL_QUIC, &ret_match);
        ndpi_check_dga_name(detectionmodule, flow,
                            (const char *)sni_ptr, sni_len);
        flow->protos.tls_quic_stun.tls_quic.hello_processed = 1;
        sni_found = 1;
      }
    } else if(memcmp(tag, "UAID", 4) == 0) {
      if(len > 0 && tag_offset_start + offset + len <= crypto_data_len) {
        const u_int8_t *ua_ptr = &crypto_data[tag_offset_start + offset];
#ifdef QUIC_DEBUG
        NDPI_LOG_DBG(detectionmodule, "Found UA: %.*s\n", len, ua_ptr);
#endif
        ndpi_http_process_user_agent(detectionmodule, flow, (const char *)ua_ptr, len);
        ua_found = 1;
      }
    }
    if(sni_found && ua_found)
      return;