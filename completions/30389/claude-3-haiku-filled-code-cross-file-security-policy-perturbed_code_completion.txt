// <MASK>
    if(memcmp(tag, "SNI\0", 4) == 0) {
        sni_len = offset - prev_offset;
        if(sni_len > sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name) - 1) {
            sni_len = sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name) - 1;
        }
        memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
               &crypto_data[tag_offset_start + prev_offset], sni_len);
        flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[sni_len] = '\0';
#ifdef QUIC_DEBUG
        NDPI_LOG_DBG(detectionmodule, "SNI: %s\n", flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
#endif
        ndpi_match_host_subprotocol(detectionmodule, flow,
                                   flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
                                   sni_len, &ret_match);
        ndpi_check_dga_name(detectionmodule, flow,
                            flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
                            sni_len);
        sni_found = 1;
    } else if(memcmp(tag, "UAID", 4) == 0) {
        len = offset - prev_offset;
        if(len > sizeof(flow->http.user_agent) - 1) {
            len = sizeof(flow->http.user_agent) - 1;
        }
        memcpy(flow->http.user_agent, &crypto_data[tag_offset_start + prev_offset], len);
        flow->http.user_agent[len] = '\0';
#ifdef QUIC_DEBUG
        NDPI_LOG_DBG(detectionmodule, "UAID: %s\n", flow->http.user_agent);
#endif
        ndpi_check_http_user_agent(detectionmodule, flow);
        ua_found = 1;
    }

    if(sni_found && ua_found)
        return;