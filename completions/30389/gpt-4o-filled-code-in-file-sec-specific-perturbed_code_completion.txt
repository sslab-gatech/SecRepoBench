if(memcmp(tag, "SNI\0", 4) == 0) {
      if(len > 0 && offset + len <= crypto_data_len) {
        sni_len = len;
        if(sni_len >= sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name))
          sni_len = sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name) - 1;
        memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
               &crypto_data[offset], sni_len);
        flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[sni_len] = '\0';
        NDPI_LOG_DBG(detectionmodule, "SNI: %s\n", flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);

        ret_match = ndpi_check_ndpi_flow_func(detectionmodule, flow, crypto_data, crypto_data_len);
        if(ret_match == NDPI_PROTOCOL_MATCHED) {
          flow->protos.tls_quic_stun.tls_quic.hello_processed = 1;
          return;
        }

        ndpi_check_dga(detectionmodule, flow, flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
        sni_found = 1;
      }
    } else if(memcmp(tag, "UAID", 4) == 0) {
      if(len > 0 && offset + len <= crypto_data_len) {
        NDPI_LOG_DBG(detectionmodule, "UAID: %.*s\n", len, &crypto_data[offset]);
        http_process_user_agent(detectionmodule, flow, &crypto_data[offset], len);
        ua_found = 1;
      }
    }

    if(sni_found && ua_found) {
      return;
    }