if(memcmp(tag, "SNI\0", 4) == 0) {
      if(len < 2 || len > crypto_data_len - tag_offset_start)
        break;
      sni_len = le16toh(*(uint16_t *)&crypto_data[tag_offset_start]);
      if(sni_len > len - 2 || sni_len >= sizeof(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name))
        break;
      memcpy(flow->protos.tls_quic_stun.tls_quic.client_requested_server_name,
             &crypto_data[tag_offset_start + 2], sni_len);
      flow->protos.tls_quic_stun.tls_quic.client_requested_server_name[sni_len] = '\0';
#ifdef QUIC_DEBUG
      NDPI_LOG_DBG(detectionmodule, "SNI: %s\n", flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
#endif
      sni_found = 1;
      ret_match = ndpi_match_host_subprotocol(detectionmodule, flow, flow->protos.tls_quic_stun.tls_quic.client_requested_server_name);
      if(ret_match == NDPI_PROTOCOL_MATCHED)
        return;
    } else if(memcmp(tag, "UAID", 4) == 0) {
      if(len < 1 || len > crypto_data_len - tag_offset_start)
        break;
      uint32_t ua_len = len;
      if(ua_len >= sizeof(flow->protos.tls_quic_stun.tls_quic.user_agent))
        break;
      memcpy(flow->protos.tls_quic_stun.tls_quic.user_agent,
             &crypto_data[tag_offset_start], ua_len);
      flow->protos.tls_quic_stun.tls_quic.user_agent[ua_len] = '\0';
#ifdef QUIC_DEBUG
      NDPI_LOG_DBG(detectionmodule, "User-Agent: %s\n", flow->protos.tls_quic_stun.tls_quic.user_agent);
#endif
      ua_found = 1;
      ndpi_search_http_user_agent(detectionmodule, flow, flow->protos.tls_quic_stun.tls_quic.user_agent);
    }
    if(sni_found && ua_found)
      return;