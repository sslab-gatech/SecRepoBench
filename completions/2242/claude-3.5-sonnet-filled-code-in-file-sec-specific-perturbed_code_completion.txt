const char *buf, *end, *last, *c;
size_t bytecnt = m->str_range;
size_t lines = 0;
size_t linecnt = (m->str_flags & STRING_COMPACT_WHITESPACE) ?
    m->str_range : m->str_range * 2;

if (s == NULL) {
    ms->search.s = NULL;
    ms->search.s_len = 0;
    ms->search.offset = 0;
    ms->search.rm_len = 0;
    return 0;
}