const char *buf, *end, *last, *c;
			size_t bytecnt;
			int lines;

			if (!source)
				return -1;

			if (m->str_range == 0) {
				bytecnt = ms->regex_max;
			} else if ((m->str_flags & STRING_LINE_COUNT) != 0) {
				bytecnt = m->str_range * 256;
			} else {
				bytecnt = m->str_range;
			}