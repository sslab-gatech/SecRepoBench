const char *buf, *end, *last, *c;
			size_t bytecnt, lines, linecnt;

			if (offset >= nbytes) {
				ms->search.s = NULL;
				return 0;
			}

			if (m->str_flags & REGEX_LINE_COUNT) {
				linecnt = m->str_range;
				bytecnt = nbytes - offset;
			} else {
				linecnt = 0;
				bytecnt = m->str_range;
			}