size_t bytecnt = 0;
size_t linecnt = 0;
const char *buf = NULL;
const char *end = NULL;
const char *last = NULL;
const char *b = NULL;
const char *c = NULL;
size_t lines = 0;

if (m->str_flags & STRING_LINE_COUNT) {
    linecnt = m->str_range;
    bytecnt = linecnt * 80; // Approximate line length
} else {
    bytecnt = m->str_range;
}