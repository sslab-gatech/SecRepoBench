size_t bytecnt = m->str_range;
const char *buf, *end, *last, *b, *c;
size_t lines = 0;
size_t linecnt = m->str_flags & STRING_LINE_COUNT;

if (linecnt) {
    bytecnt = linecnt * 80;  /* default line length */
    if (m->str_flags & STRING_LINE_COUNT_WIDTH)
        bytecnt = linecnt * m->str_range;
}