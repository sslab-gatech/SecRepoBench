const char *buf, *end, *last, *c;
size_t lines, bytecnt, linecnt;
int32_t regex_line_count = m->str_range;
int32_t regex_byte_count = m->str_range;

if (m->str_flags & REGEX_LINE_COUNT) {
    linecnt = regex_line_count;
    bytecnt = linecnt * 80; // Assume 80 characters per line
} else {
    linecnt = 0;
    bytecnt = regex_byte_count;
}