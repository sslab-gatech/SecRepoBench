private int
file_signextend(struct magic_set *ms, struct magic *m, uint64_t v)
{
	if (m->flag & UNSIGNED)
		return v;

	switch (m->type) {
	case FILE_BYTE:
		return (int8_t)v;
	case FILE_SHORT:
		return (int16_t)v;
	case FILE_LONG:
		return (int32_t)v;
	case FILE_QUAD:
		return (int64_t)v;
	default:
		file_magerror(ms, "invalid type %d in file_signextend()", m->type);
		return -1;
	}
}