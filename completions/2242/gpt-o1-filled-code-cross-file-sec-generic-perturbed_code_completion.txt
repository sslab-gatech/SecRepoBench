/* Determine linecnt and bytecnt based on flags and range in 'm'. */
{
    static const size_t MAX_LINE_LEN = 80;
    linecnt = 0;

    if ((m->str_flags & REGEX_LINE_COUNT) != 0) {
        /* Interpret m->str_range as the number of lines, then multiply by a constant. */
        size_t tmp = m->str_range;
        /* Prevent potential overflow when multiplying. */
        if (tmp > SIZE_MAX / MAX_LINE_LEN)
            tmp = SIZE_MAX / MAX_LINE_LEN;

        linecnt = tmp;
        bytecnt = tmp * MAX_LINE_LEN;
    } else {
        /* Use m->str_range directly as the byte count. */
        bytecnt = m->str_range;
    }
}