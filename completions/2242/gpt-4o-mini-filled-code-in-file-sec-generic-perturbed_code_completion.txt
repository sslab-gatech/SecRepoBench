size_t bytecnt = m->str_range ? m->str_range : nbytes - offset;
			const unsigned char *buf, *end, *last;
			int lines = 0;

			if (m->str_flags & STRING_LINE_COUNT) {
				lines = m->line_count;
				bytecnt = lines * 80; // Assuming a line length of 80 characters
			}

			if (bytecnt == 0 || bytecnt > nbytes - offset)
				bytecnt = nbytes - offset;