size_t bytecnt = m->str_range ? m->str_range : nbytes - offset;
			size_t linecnt = m->line_range ? m->line_range : SIZE_MAX;
			const unsigned char *buf;
			const unsigned char *end;
			const unsigned char *last;
			const unsigned char *b;
			int lines;

			if (linecnt > 0)
				bytecnt = linecnt * 80; // Assuming 80 characters per line

			if (bytecnt == 0 || bytecnt > nbytes - offset)
				bytecnt = nbytes - offset;