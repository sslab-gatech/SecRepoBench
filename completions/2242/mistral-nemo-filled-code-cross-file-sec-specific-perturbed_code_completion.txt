// <MASK>
	// Initialize bytecnt and linecnt based on the flags and range in 'm'
	if (m->flags & REGEX_LINE_COUNT) {
		linecnt = m->vallen;
		bytecnt = linecnt * ms->regex_line_max;
	} else {
		bytecnt = m->vallen;
	}
	if (bytecnt == 0 || bytecnt > nbytes - offset)
		bytecnt = nbytes - offset;
	if (bytecnt > ms->regex_max)
		bytecnt = ms->regex_max;