// <MASK>
	if (m->flags & REGEX_OFFSET_START)
		bytecnt = ms->search.offset;
	else
		bytecnt = ms->search.offset + ms->search.rm_len;
	if (bytecnt == 0 || bytecnt > nbytes - offset)
		bytecnt = nbytes - offset;
	if (bytecnt > ms->regex_max)
		bytecnt = ms->regex_max;
	// </MASK>