unsigned int region_count = env.get_region_count();
int num_defaults = env.argStack.pop_num ();

if (unlikely (num_defaults < 0 || env.argStack.get_count () < num_defaults * (region_count + 1)))
{
  env.set_error ();
  return;
}

for (int i = 0; i < num_defaults; i++)
{
  BlendArg blend_args;
  blend_args.init ();
  for (unsigned int j = 0; j < region_count; j++)
    blend_args.push (env.argStack.pop_num ());
  Number default_val = env.argStack.pop_num ();
  env.set_blend_args (default_val, blend_args);
  env.argStack.push_num (default_val + env.calculate_blend (region_count));
}
env.clear_args (num_defaults * region_count);