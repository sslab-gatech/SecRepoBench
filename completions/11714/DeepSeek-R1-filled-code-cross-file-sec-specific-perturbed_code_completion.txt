unsigned int nRegions = env.argStack.pop_num ();
unsigned int numValues = env.argStack.pop_num ();
unsigned int blend_count = nRegions * numValues;

if (env.argStack.get_count () < numValues + blend_count)
{
    env.set_error ();
    return;
}

for (unsigned int i = 0; i < numValues; i++)
{
    double& default_val = env.argStack[i];
    for (unsigned int j = 0; j < nRegions; j++)
    {
        double blend_val = env.argStack[numValues + i * nRegions + j];
        default_val += blend_val * env.get_blend_weight (j);
    }
}

env.argStack.pop (blend_count);