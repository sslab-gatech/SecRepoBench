{
  // Retrieve the number of regions from the environment.
  unsigned int region_count = interp_env.get_region_count ();

  // The argument stack should contain n default values plus region_count * n blend deltas.
  unsigned int total_args = interp_env.argStack.get_count ();
  if (!total_args)
    return; // Nothing to do if the stack is empty.

  // Determine the number of default values (n).
  unsigned int n = total_args / (region_count + 1);
  if (n * (region_count + 1) != total_args)
  {
    // If the total arguments don't line up, it's an error.
    interp_env.set_error ();
    return;
  }

  // Merge the region_count deltas into each default value on the stack.
  for (unsigned int i = 0; i < n; i++)
  {
    BlendArg &barg = interp_env.argStack[i];
    barg.numValues = region_count + 1;
    barg.setBlending (true);

    // Copy each of the region_count deltas into the BlendArg.
    for (unsigned int r = 0; r < region_count; r++)
    {
      const BlendArg &delta_arg = interp_env.argStack[(r + 1) * n + i];
      // Store the delta in barg's array of values, index r + 1 reserved for region r.
      barg.values[r + 1] = delta_arg.values[0];
    }
  }

  // Finally, remove the region_count * n blend deltas from the top of the stack.
  interp_env.argStack.shrink (region_count * n);
}