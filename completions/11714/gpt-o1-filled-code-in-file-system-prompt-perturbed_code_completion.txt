{
  // Prepare environment for blending calculations
  interp_env.process_blend ();

  // Pop the number of blend values from the stack
  unsigned int numBlends = interp_env.argStack.pop_uint ();
  if (!numBlends)
  {
    interp_env.set_error ();
    return;
  }

  // Check if enough arguments exist on the stack
  unsigned int rc = interp_env.get_region_count ();
  unsigned int needed = numBlends * (rc + 1);
  if (interp_env.argStack.len () < needed)
  {
    interp_env.set_error ();
    return;
  }

  // Collect all deltas in a temporary array
  hb_vector_t<BlendArg> deltas;
  deltas.resize (numBlends * rc);
  for (int i = numBlends - 1; i >= 0; i--)
  {
    for (int j = rc - 1; j >= 0; j--)
      deltas[i * rc + j] = interp_env.argStack.pop ();
  }

  // Assign deltas to each default value and replace them on the stack
  for (int i = numBlends - 1; i >= 0; i--)
  {
    BlendArg defVal = interp_env.pop_arg ();
    defVal.set_blends (numBlends, i, rc, &deltas[i * rc]);
    interp_env.argStack.push (defVal);
  }
}