unsigned int num_regions = interp_env.get_num_regions ();
unsigned int n = interp_env.argStack.pop_uint ();
if (n == 0 || num_regions == 0)
  return;

unsigned int total = n * (num_regions + 1);
if (interp_env.argStack.size () < total)
  return; // Not enough arguments, bail out

// The stack has: [d0, d1, ..., dn-1, b0_0, ..., b0_r, b1_0, ..., b1_r, ..., bn-1_0, ..., bn-1_r]
// Where d* are default values, b*_r are blend deltas for each region
// We want to blend each default value with its blend deltas and leave only the blended values on the stack

// We'll process from the end to avoid overwriting values we still need
for (int i = n - 1; i >= 0; i--)
{
  float d = interp_env.argStack[interp_env.argStack.size () - total + i];
  float blended = d;
  for (unsigned int r = 0; r < num_regions; r++)
  {
    float b = interp_env.argStack[interp_env.argStack.size () - total + n + i * num_regions + r];
    blended += b * interp_env.get_region_weight (r);
  }
  interp_env.argStack[interp_env.argStack.size () - total + i] = blended;
}

// Remove the blend deltas, leaving only the n blended values
interp_env.argStack.popn (n * num_regions);