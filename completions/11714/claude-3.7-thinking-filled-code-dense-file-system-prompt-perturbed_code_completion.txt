interp_env.process_blend();

unsigned int num_args = interp_env.argStack.get_count();
if (unlikely(num_args < 1))
{
  interp_env.set_error();
  return;
}

unsigned int n_blend_val = interp_env.argStack.pop_uint();
unsigned int num_regions = interp_env.region_count;

if (unlikely((n_blend_val * (1 + num_regions)) > interp_env.argStack.get_count()))
{
  interp_env.set_error();
  return;
}

unsigned int start = interp_env.argStack.get_count() - (n_blend_val * (1 + num_regions));

for (unsigned int i = 0; i < n_blend_val; i++)
{
  unsigned int default_idx = start + i;
  unsigned int delta_idx = start + n_blend_val + (i * num_regions);
  
  if (unlikely(interp_env.argStack[default_idx].blending()))
  {
    interp_env.set_error();
    return;
  }
  
  BlendArg& arg = interp_env.argStack[default_idx];
  arg.set_blending (num_regions);
  
  for (unsigned int j = 0; j < num_regions; j++)
  {
    arg.set_delta (j, interp_env.argStack[delta_idx + j]);
  }
}

interp_env.argStack.pop (n_blend_val * num_regions);