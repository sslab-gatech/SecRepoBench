// Check if the current set of glyphs for the given lookup index has already been processed.
// If not, update the glyph count for this lookup index and ensure the glyph set is initialized
// and cleared as needed. Then, obtain the glyph set associated with the lookup index.
// Determine if the parent active glyphs are a subset of the obtained glyph set.
// If they are a subset, return true to indicate the lookup is done; otherwise, return false.
if (done_lookups_glyph_count->in_error () ||
    done_lookups_glyph_set->in_error ())
  return true;

unsigned int glyph_count = done_lookups_glyph_count->get (indexlookup);
if (glyph_count == 0) {
  glyph_count = face->get_num_glyphs ();
  done_lookups_glyph_count->set (indexlookup, glyph_count);
  done_lookups_glyph_set->set (indexlookup, hb_set_create ());
}

hb_set_t *glyph_set = done_lookups_glyph_set->get (indexlookup);
if (glyph_set->in_error ())
  return true;

glyph_set->clear ();
get_coverage ().collect_coverage (glyphs, glyph_set);

return hb_set_is_subset (parent_active_glyphs (), glyph_set);