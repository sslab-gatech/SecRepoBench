if (done_lookups_glyph_count->has (indexlookup) &&
    done_lookups_glyph_set->has (indexlookup))
{
  hb_set_t *lookup_glyph_set = done_lookups_glyph_set->get (indexlookup);
  
  bool is_subset = true;
  hb_codepoint_t g = HB_SET_VALUE_INVALID;
  while (hb_set_next (parent_active_glyphs (), &g))
  {
    if (!hb_set_has (lookup_glyph_set, g))
    {
      is_subset = false;
      break;
    }
  }
  
  if (is_subset)
    return true;
  
  covered_glyph_set = lookup_glyph_set;
  hb_set_clear (covered_glyph_set);
}
else
{
  unsigned int current_glyph_count = parent_active_glyphs ()->get_population ();
  done_lookups_glyph_count->set (indexlookup, current_glyph_count);
  
  if (!done_lookups_glyph_set->has (indexlookup))
  {
    hb_set_t *new_glyph_set = hb_set_create ();
    done_lookups_glyph_set->set (indexlookup, new_glyph_set);
    covered_glyph_set = new_glyph_set;
  }
  else
  {
    covered_glyph_set = done_lookups_glyph_set->get (indexlookup);
    hb_set_clear (covered_glyph_set);
  }
}