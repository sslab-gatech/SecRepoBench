{
  hb_set_t *lookup_set = done_lookups_glyph_set[indexlookup];
  if (!lookup_set)
  {
    lookup_set = hb_set_create();
    if (unlikely(!lookup_set))
      return true;
    done_lookups_glyph_set[indexlookup] = lookup_set;
  }

  if (hb_set_is_subset(parent_active_glyphs(), lookup_set))
    return true;

  unsigned int current_count = hb_set_get_length(parent_active_glyphs());
  if (done_lookups_glyph_count[indexlookup] != current_count)
  {
    done_lookups_glyph_count[indexlookup] = current_count;
    hb_set_clear(lookup_set);
    hb_set_union(lookup_set, parent_active_glyphs());
  }
}