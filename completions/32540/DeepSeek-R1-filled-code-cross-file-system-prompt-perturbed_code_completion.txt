if (indexlookup >= done_lookups_glyph_count->length)
{
  if (!done_lookups_glyph_count->resize (indexlookup + 1) ||
      !done_lookups_glyph_set->resize (indexlookup + 1))
    return true;
}

unsigned int &count = (*done_lookups_glyph_count)[indexlookup];
hb_set_t* &glyph_set = (*done_lookups_glyph_set)[indexlookup];

if (count == 0)
{
  glyph_set = hb_set_create();
  hb_set_clear (glyph_set);
  count = 1;
}
else if (hb_set_is_subset (parent_active_glyphs (), glyph_set))
  return true;

hb_set_union (glyph_set, parent_active_glyphs ());