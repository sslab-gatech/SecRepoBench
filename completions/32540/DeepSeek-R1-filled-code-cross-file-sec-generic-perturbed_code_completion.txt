unsigned int current_glyph_count = hb_face_get_glyph_count(face);

if (done_lookups_glyph_count->has(indexlookup)) {
    unsigned int stored_count = done_lookups_glyph_count->get(indexlookup);
    if (stored_count != current_glyph_count) {
        done_lookups_glyph_count->set(indexlookup, current_glyph_count);
        hb_set_t* covered = done_lookups_glyph_set->get(indexlookup);
        if (covered)
            hb_set_clear(covered);
        else
            done_lookups_glyph_set->set(indexlookup, hb_set_create());
    }
} else {
    done_lookups_glyph_count->set(indexlookup, current_glyph_count);
    done_lookups_glyph_set->set(indexlookup, hb_set_create());
}

hb_set_t* covered_glyph_set = done_lookups_glyph_set->get(indexlookup);
if (hb_set_is_subset(parent_active_glyphs(), covered_glyph_set))
    return true;