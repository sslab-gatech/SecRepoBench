static MagickBooleanType TraceStrokePolygon(const Image *image,
  const DrawInfo *draw_info,const PrimitiveInfo *primitivedata)
{
  PointInfo
    *path_p,
    *path_q;

  PrimitiveInfo
    *polygon_primitive,
    *stroke_polygon;

  register ssize_t
    i,
    j,
    n;

  ssize_t
    dx,
    dy;

  size_t
    number_vertices;

  ssize_t
    dot_product;

  double
    delta_theta,
    distance,
    mid,
    miterlimit,
    offset,
    slope,
    theta;

  MagickBooleanType
    closed_path;

  MagickStatusType
    status;

  PointInfo
    box_p[5],
    box_q[5];

  PointInfo
    center,
    degrees,
    point,
    segment;

  PrimitiveType
    primitive_type;

  register PrimitiveInfo
    *p;

  register ssize_t
    k;

  ssize_t
    z_count;

  z_count=0;
  closed_path=primitivedata[0].closed_subpath;
  number_vertices=(ssize_t) primitivedata[0].coordinates;
  if (closed_path!= MagickFalse)
    number_vertices++;
  polygon_primitive=(PrimitiveInfo *) AcquireQuantumMemory((size_t)
    (number_vertices+2UL),sizeof(*polygon_primitive));
  if (polygon_primitive == (PrimitiveInfo *) NULL)
    return(MagickFalse);
  (void) memset(polygon_primitive,0,sizeof(*polygon_primitive));
  polygon_primitive[0]=primitivedata[0];
  p=polygon_primitive;
  for (i=1; i < (ssize_t) number_vertices; i++)
  {
    p->point.x=primitivedata[i].point.x;
    p->point.y=primitivedata[i].point.y;
    p->coordinates=1;
    p->closed_subpath=MagickFalse;
    p->primitive=primitivedata[i].primitive;
    p++;
  }
  p->primitive=UndefinedPrimitive;
  if (closed_path!= MagickFalse)
    {
      p->point.x=primitivedata[0].point.x;
      p->point.y=primitivedata[0].point.y;
      p->coordinates=1;
      p->closed_subpath=MagickTrue;
    }
  status=MagickTrue;
  if (number_vertices <= 1)
    return(MagickTrue);
  if (number_vertices == 2)
    return(TraceLine(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point));
  if (number_vertices == 3)
    return(TraceRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point));
  if (number_vertices == 4)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 5)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 6)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 7)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 8)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 9)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 10)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 11)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 12)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 13)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 14)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 15)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 16)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 17)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 18)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 19)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 20)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 21)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 22)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 23)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 24)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 25)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 26)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 27)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 28)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 29)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 30)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 31)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 32)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 33)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 34)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 35)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 36)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 37)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 38)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 39)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 40)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 41)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 42)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 43)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 44)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 45)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 46)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 47)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 48)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 49)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 50)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 51)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 52)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 53)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 54)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 55)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedata[1].point,primitivedata[2].point));
  if (number_vertices == 56)
    return(TraceRoundRectangle(polygon_primitive,primitivedata[0].point,
      primitivedat