if (pfx->usedOprStack && pfx->OperatorStack[pfx->usedOprStack-1] == oQuery) {
    if (ptern->addrQuery != NULL_ADDRESS || ptern->addrColon != NULL_ADDRESS) {
      (void) ThrowMagickException (
        fxinfo->exception, GetMagickModule(), OptionError,
        "Nested ternary operators not supported", "'%s' at '%s'",
        fxinfo->token, SetShortExp(fxinfo));
      return MagickFalse;
    }
    ptern->addrQuery = fxinfo->usedElements;
    fxinfo->usedOprStack--;
    (void) AddAddressingElement (fxinfo, rQuery, NULL_ADDRESS);
  } else if (pfx->usedOprStack && pfx->OperatorStack[pfx->usedOprStack-1] == oColon) {
    if (ptern->addrQuery == NULL_ADDRESS || ptern->addrColon != NULL_ADDRESS) {
      (void) ThrowMagickException (
        fxinfo->exception, GetMagickModule(), OptionError,
        "Ternary operator inconsistency", "'%s' at '%s'",
        fxinfo->token, SetShortExp(fxinfo));
      return MagickFalse;
    }
    ptern->addrColon = fxinfo->usedElements;
    fxinfo->usedOprStack--;
    fxinfo->Elements[fxinfo->usedElements-1].DoPush = MagickTrue;
    (void) AddAddressingElement (fxinfo, rColon, NULL_ADDRESS);
  }