if (pfx->usedOprStack == 0) {
  return MagickTrue;
}

OperatorE op = pfx->OperatorStack[pfx->usedOprStack-1];

if (op == oQuery) {
  if (ptern->addrQuery != NULL_ADDRESS || ptern->addrColon != NULL_ADDRESS) {
    (void) ThrowMagickException (fxinfo->exception, GetMagickModule(), OptionError,
      "Ternary structure is inconsistent", "'%s'",
      fxinfo->token);
    return MagickFalse;
  }
  pfx->usedOprStack--;
  ptern->addrQuery = fxinfo->usedElements;
  (void) AddAddressingElement (fxinfo, rIf, ptern->addrQuery);
} else if (op == oColon) {
  if (ptern->addrQuery == NULL_ADDRESS || ptern->addrColon != NULL_ADDRESS) {
    (void) ThrowMagickException (fxinfo->exception, GetMagickModule(), OptionError,
      "Ternary structure is inconsistent", "'%s'",
      fxinfo->token);
    return MagickFalse;
  }
  pfx->usedOprStack--;
  ptern->addrColon = fxinfo->usedElements;
  fxinfo->Elements[fxinfo->usedElements-1].DoPush = MagickTrue;
  (void) AddAddressingElement (fxinfo, rElse, ptern->addrColon);
}