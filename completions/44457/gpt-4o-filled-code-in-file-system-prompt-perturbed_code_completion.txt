if (pfx->usedOprStack == 0)
    return MagickTrue;

  if (pfx->OperatorStack[pfx->usedOprStack-1] == oQuery)
    {
      if (ptern->addrQuery != NULL_ADDRESS || ptern->addrColon != NULL_ADDRESS)
        {
          (void) ThrowMagickException(
            fxinfo->exception, GetMagickModule(), OptionError,
            "Nested ternary operator", "at '%s'", SetShortExp(fxinfo));
          return MagickFalse;
        }
      pfx->usedOprStack--;
      ptern->addrQuery = pfx->usedElements;
      (void) AddAddressingElement(fxinfo, rIfZeroGoto, NULL_ADDRESS);
    }
  else if (pfx->OperatorStack[pfx->usedOprStack-1] == oColon)
    {
      if (ptern->addrQuery == NULL_ADDRESS || ptern->addrColon != NULL_ADDRESS)
        {
          (void) ThrowMagickException(
            fxinfo->exception, GetMagickModule(), OptionError,
            "Ternary operator without matching '?'", "at '%s'", SetShortExp(fxinfo));
          return MagickFalse;
        }
      pfx->usedOprStack--;
      ptern->addrColon = pfx->usedElements;
      (void) AddAddressingElement(fxinfo, rGoto, NULL_ADDRESS);
    }