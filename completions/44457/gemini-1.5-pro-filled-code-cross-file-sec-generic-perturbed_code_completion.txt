if (ptern->addrQuery == NULL_ADDRESS) {
    if (TopOperator(fxinfo) != oQuery) {
      (void) ThrowMagickException (
        fxinfo->exception, GetMagickModule(), OptionError,
        "Unbalanced ternary operator", "'?' expected at '%s'",
        SetShortExp(fxinfo));
      return MagickFalse;
    }
    fxinfo->usedOprStack--;
    ptern->addrQuery = fxinfo->usedElements;
    (void) AddAddressingElement (fxinfo, rQuery, NULL_ADDRESS);
  } else if (ptern->addrColon == NULL_ADDRESS) {
    if (TopOperator(fxinfo) != oColon) {
      (void) ThrowMagickException (
        fxinfo->exception, GetMagickModule(), OptionError,
        "Unbalanced ternary operator", "':' expected at '%s'",
         SetShortExp(fxinfo));
      return MagickFalse;
    }
    fxinfo->usedOprStack--;
    ptern->addrColon = fxinfo->usedElements;
    fxinfo->Elements[fxinfo->usedElements-1].DoPush = MagickTrue; // push result
    (void) AddAddressingElement (fxinfo, rColon, NULL_ADDRESS);
  } else {
    (void) ThrowMagickException (
      fxinfo->exception, GetMagickModule(), OptionError,
      "Unbalanced ternary operator", "too many ':' at '%s'",
      SetShortExp(fxinfo));
    return MagickFalse;
  }