if (ptern->addrQuery == NULL_ADDRESS) {
    if (TopOperator(fxinfo) != oQuery) {
      (void) ThrowMagickException (
        fxinfo->exception, GetMagickModule(), OptionError,
        "Unbalanced ternary operators", "'?' at '%s'",
        SetShortExp(fxinfo));
      return MagickFalse;
    }
    PopOperator(fxinfo);
    ptern->addrQuery = fxinfo->usedElements;
    (void) AddAddressingElement (fxinfo, rQuery, NULL_ADDRESS);
  } else if (ptern->addrColon == NULL_ADDRESS) {
    if (TopOperator(fxinfo) != oColon) {
      (void) ThrowMagickException (
        fxinfo->exception, GetMagickModule(), OptionError,
        "Unbalanced ternary operators", "':' at '%s'",
        SetShortExp(fxinfo));
      return MagickFalse;
    }
    PopOperator(fxinfo);
    ptern->addrColon = fxinfo->usedElements;
    fxinfo->Elements[fxinfo->usedElements-1].DoPush = MagickTrue;
    (void) AddAddressingElement (fxinfo, rColon, NULL_ADDRESS);
  } else {
    (void) ThrowMagickException (
      fxinfo->exception, GetMagickModule(), OptionError,
      "Ternary operator already defined", "'%c' at '%s'",
      (char) TopOperator(fxinfo), SetShortExp(fxinfo));
    return MagickFalse;
  }