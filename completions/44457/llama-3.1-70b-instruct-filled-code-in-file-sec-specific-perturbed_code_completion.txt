static MagickBooleanType ProcessTernaryOpr (FxInfo * fxinfo, TernaryT * ptern)
{
  OperatorE op = fxinfo->OperatorStack[fxinfo->usedOprStack-1];
  if (op == oQuery) {
    if (ptern->addrQuery!= NULL_ADDRESS) {
      (void) ThrowMagickException (
        fxinfo->exception, GetMagickModule(), OptionError,
        "Ternary query '?' already set at", "'%s'",
        SetShortExp(fxinfo));
      return MagickFalse;
    }
    if (ptern->addrColon!= NULL_ADDRESS) {
      (void) ThrowMagickException (
        fxinfo->exception, GetMagickModule(), OptionError,
        "Ternary colon ':' already set before '?' at", "'%s'",
        SetShortExp(fxinfo));
      return MagickFalse;
    }
    ptern->addrQuery = fxinfo->usedElements;
    fxinfo->usedOprStack--;
    (void) AddAddressingElement (fxinfo, rIfNotZeroGoto, NULL_ADDRESS);
    return MagickTrue;
  } else if (op == oColon) {
    if (ptern->addrColon!= NULL_ADDRESS) {
      (void) ThrowMagickException (
        fxinfo->exception, GetMagickModule(), OptionError,
        "Ternary colon ':' already set at", "'%s'",
        SetShortExp(fxinfo));
      return MagickFalse;
    }
    if (ptern->addrQuery == NULL_ADDRESS) {
      (void) ThrowMagickException (
        fxinfo->exception, GetMagickModule(), OptionError,
        "Ternary colon ':' without preceding '?' at", "'%s'",
        SetShortExp(fxinfo));
      return MagickFalse;
    }
    ptern->addrColon = fxinfo->usedElements;
    fxinfo->usedOprStack--;
    (void) AddElement (fxinfo, (fxFltType) 0, oNull);
    return MagickTrue;
  }
  return MagickTrue;
}