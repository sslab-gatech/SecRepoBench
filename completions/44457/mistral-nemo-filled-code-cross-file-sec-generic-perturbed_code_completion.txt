if (pfx->OperatorStack[pfx->usedOprStack-1] == oQuery) {
    if (ternary.addrQuery != NULL_ADDRESS) {
      (void) ThrowMagickException(
        pfx->exception, GetMagickModule(), OptionError,
        "Duplicate '?' operator", "'%s' at '%s'",
        pfx->token, SetShortExp(pfx));
      return MagickFalse;
    }
    ternary.addrQuery = pfx->usedElements;
    pfx->usedOprStack--;
  } else if (pfx->OperatorStack[pfx->usedOprStack-1] == oColon) {
    if (ternary.addrColon != NULL_ADDRESS) {
      (void) ThrowMagickException(
        pfx->exception, GetMagickModule(), OptionError,
        "Duplicate ':' operator", "'%s' at '%s'",
        pfx->token, SetShortExp(pfx));
      return MagickFalse;
    }
    if (ternary.addrQuery == NULL_ADDRESS) {
      (void) ThrowMagickException(
        pfx->exception, GetMagickModule(), OptionError,
        "'?' operator expected before ':'", "'%s' at '%s'",
        pfx->token, SetShortExp(pfx));
      return MagickFalse;
    }
    ternary.addrColon = pfx->usedElements;
    pfx->usedOprStack--;
    pfx->Elements[pfx->usedElements-1].DoPush = MagickTrue;
  } else {
    (void) ThrowMagickException(
      pfx->exception, GetMagickModule(), OptionError,
      "Invalid operator", "'%s' at '%s'",
      pfx->token, SetShortExp(pfx));
    return MagickFalse;
  }
  return MagickTrue;