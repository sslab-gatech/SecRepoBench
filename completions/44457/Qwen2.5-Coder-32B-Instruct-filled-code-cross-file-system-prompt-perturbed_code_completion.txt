if (ptern->addrQuery == NULL_ADDRESS && ptern->addrColon == NULL_ADDRESS) {
  if (fxinfo->OperatorStack[fxinfo->usedOprStack - 1] == oQuery) {
    fxinfo->usedOprStack--;
    ptern->addrQuery = fxinfo->usedElements - 1;
    (void) AddAddressingElement(fxinfo, rConditionalExec, ptern->addrQuery);
  } else if (fxinfo->OperatorStack[fxinfo->usedOprStack - 1] == oColon) {
    if (ptern->addrQuery == NULL_ADDRESS) {
      (void) ThrowMagickException(
        fxinfo->exception, GetMagickModule(), OptionError,
        "Misplaced ':' in ternary operator", "'%s' at '%s'",
        fxinfo->token, SetShortExp(fxinfo));
      return MagickFalse;
    }
    fxinfo->usedOprStack--;
    ptern->addrColon = fxinfo->usedElements - 1;
    fxinfo->Elements[ptern->addrColon].DoPush = MagickTrue;
    (void) AddAddressingElement(fxinfo, rControlFlow, ptern->addrColon);
  } else {
    return MagickTrue; // Not a ternary operator, continue processing
  }
} else {
  (void) ThrowMagickException(
    fxinfo->exception, GetMagickModule(), OptionError,
    "Nested or misplaced ternary operator", "'%s' at '%s'",
    fxinfo->token, SetShortExp(fxinfo));
  return MagickFalse;
}