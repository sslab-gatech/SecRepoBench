if (fxinfo->usedOprStack > 0)
  {
    OperatorE op = fxinfo->OperatorStack[fxinfo->usedOprStack - 1];
    if (op == oQuery)
    {
      if (ptern->addrQuery != NULL_ADDRESS || ptern->addrColon != NULL_ADDRESS)
      {
        (void)ThrowMagickException(fxinfo->exception, GetMagickModule(), OptionError,
          "Nested ternary operator", "at '%s'", SetShortExp(fxinfo));
        return MagickFalse;
      }
      fxinfo->usedOprStack--;
      ptern->addrQuery = fxinfo->usedElements - 1;
      (void)AddAddressingElement(fxinfo, rIfZeroGoto, NULL_ADDRESS);
    }
    else if (op == oColon)
    {
      if (ptern->addrQuery == NULL_ADDRESS || ptern->addrColon != NULL_ADDRESS)
      {
        (void)ThrowMagickException(fxinfo->exception, GetMagickModule(), OptionError,
          "':' without preceding '?'", "at '%s'", SetShortExp(fxinfo));
        return MagickFalse;
      }
      fxinfo->usedOprStack--;
      ptern->addrColon = fxinfo->usedElements - 1;
      fxinfo->Elements[fxinfo->usedElements - 1].DoPush = MagickTrue;
      (void)AddAddressingElement(fxinfo, rGoto, NULL_ADDRESS);
    }
  }