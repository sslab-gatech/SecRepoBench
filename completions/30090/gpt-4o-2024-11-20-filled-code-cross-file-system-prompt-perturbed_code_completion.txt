if (k && v && v->type == MSGPACK_OBJECT_STR) {
        /* Parse the time string */
        ret = flb_parser_time_lookup(parser, v->via.str.ptr, v->via.str.size,
                                     &tm, &tmfrac);
        if (ret == 0) {
            /* Convert to timestamp */
            time_lookup = flb_parser_tm2time(&tm);
        }
        else {
            /* Log a warning and set timestamp to zero */
            flb_warn("[parser] time resolution failed for key '%s'", time_key);
            time_lookup = 0;
        }
    }
    else {
        /* No valid time field found, set timestamp to zero */
        time_lookup = 0;
    }