// Check if a valid key-value pair exists in the map at the specified index.
if (k != NULL && v != NULL) {
    // Attempt to parse the value as a time string
    len = v->via.str.size;
    memcpy(tmp, v->via.str.ptr, len);
    tmp[len] = '\0';
    if (strptime(tmp, parser->time_fmt, &tm) != NULL) {
        time_lookup = mktime(&tm);
        if (parser->time_frac_digits > 0) {
            // Extract the fractional part of the time
            char *dot = strchr(tmp, '.');
            if (dot != NULL) {
                tmfrac = atof(dot);
            }
        }
    } else {
        // Time parsing failed, log a warning and set the timestamp to zero
        flb_warn("[parser] could not parse time field '%s'", time_key);
        time_lookup = 0;
        tmfrac = 0;
    }
} else {
    // No valid key-value pair found, set the timestamp to zero
    time_lookup = 0;
    tmfrac = 0;
}