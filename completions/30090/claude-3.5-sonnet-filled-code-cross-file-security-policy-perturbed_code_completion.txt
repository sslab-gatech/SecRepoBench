if (k && v && k->type == MSGPACK_OBJECT_STR && v->type == MSGPACK_OBJECT_STR) {
    /* Parse the time */
    ret = flb_parser_time_lookup(v->via.str.ptr, v->via.str.size,
                                 0, parser, &time_lookup, &tmfrac);
    if (ret == -1) {
        flb_warn("[parser] Error parsing time field");
        time_lookup = 0;
        tmfrac = 0;
    }
} else {
    flb_warn("[parser] Invalid time field or value");
    time_lookup = 0;
    tmfrac = 0;
}