if (k && v) {
    /* We have a key-value pair */
    if (v->type == MSGPACK_OBJECT_STR) {
        /* Parse the time string */
        ret = flb_parser_time_lookup(v->via.str.ptr, v->via.str.size,
                                     0, parser, &time_lookup, &tmfrac);
        if (ret == -1) {
            flb_warn("[parser:%s] invalid time format, skipping", parser->name);
            time_lookup = 0;
            tmfrac = 0;
        }
    }
    else {
        flb_warn("[parser:%s] time key is not a string, skipping", parser->name);
        time_lookup = 0;
        tmfrac = 0;
    }
}
else {
    flb_warn("[parser:%s] time key not found, setting to zero", parser->name);
    time_lookup = 0;
    tmfrac = 0;
}