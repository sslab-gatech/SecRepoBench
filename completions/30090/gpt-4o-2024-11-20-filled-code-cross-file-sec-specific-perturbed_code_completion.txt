if (skip < map_size && v != NULL && v->type == MSGPACK_OBJECT_STR) {
        /* Ensure the value pointer is not NULL */
        if (v->via.str.ptr == NULL) {
            flb_free(mp_buf);
            *out_buf = NULL;
            msgpack_unpacked_destroy(&result);
            return -1;
        }

        /* Parse the time string */
        memset(&tm, '\0', sizeof(struct tm));
        ret = flb_parser_time_lookup(v->via.str.ptr, v->via.str.size,
                                     parser->time_fmt, &tm, &tmfrac);
        if (ret == -1) {
            flb_warn("[parser] time resolution failed, setting to 0");
            time_lookup = 0;
        }
        else {
            /* Convert to timestamp */
            time_lookup = flb_parser_tm2time(&tm);
        }
    }
    else {
        time_lookup = 0;
    }