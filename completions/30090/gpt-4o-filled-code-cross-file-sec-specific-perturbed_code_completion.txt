if (k != NULL && v != NULL && v->type == MSGPACK_OBJECT_STR) {
    /* Attempt to parse the time value */
    struct tm tm = {0};
    char *time_str = strndup(v->via.str.ptr, v->via.str.size);
    if (time_str == NULL) {
        flb_free(mp_buf);
        *out_buf = NULL;
        msgpack_unpacked_destroy(&result);
        return -1;
    }

    /* Parse the time string */
    if (strptime(time_str, parser->time_fmt, &tm) == NULL) {
        flb_warn("[parser] could not parse time string '%s'", time_str);
        time_lookup = 0;
    } else {
        time_lookup = mktime(&tm);
    }
    free(time_str);
} else {
    time_lookup = 0;
}