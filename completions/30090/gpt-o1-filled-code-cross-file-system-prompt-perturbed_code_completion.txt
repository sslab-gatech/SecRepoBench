if (skip < map_size && k && v && v->type == MSGPACK_OBJECT_STR) {
    /* Ensure the time string can fit into our temporary buffer */
    if (v->via.str.size < sizeof(tmp)) {
        memcpy(tmp, v->via.str.ptr, v->via.str.size);
        tmp[v->via.str.size] = '\0';

        /* Attempt to parse the time string */
        ret = flb_parser_to_time(parser, tmp, &tm, &tmfrac);
        if (ret == -1) {
            flb_warn("[parser:%s] invalid time format for '%s'",
                     parser->name, tmp);
            time_lookup = 0;
        }
        else {
            /* Convert parsed time to timestamp */
            time_lookup = flb_parser_tm2time(&tm);
        }
    }
    else {
        flb_warn("[parser:%s] time string too long, skipping",
                 parser->name);
        time_lookup = 0;
    }
}
else {
    /* If no valid field or not a string, set timestamp to zero */
    time_lookup = 0;
}