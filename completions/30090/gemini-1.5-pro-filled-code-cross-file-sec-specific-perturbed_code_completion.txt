if (index < map_size && index >= 0) {
        if (v->type == MSGPACK_OBJECT_POSITIVE_INTEGER) {
            time_lookup = v->via.u64;
        }
        else if (v->type == MSGPACK_OBJECT_FLOAT) {
            time_lookup = v->via.f64;
            tmfrac = v->via.f64 - time_lookup;
        }
        else if (v->type == MSGPACK_OBJECT_STR) {
            /* String format: lookup time */
            if (flb_parser_time_lookup(v->via.str.ptr, v->via.str.size,
                                      parser->time_fmt, &tm, &tmfrac) == -1) {
                flb_plg_warn(parser->p, "invalid time format %s, using current time",
                             v->via.str.ptr);
                time_lookup = time(NULL);
            }
            else {
                time_lookup = mktime(&tm);
            }
        }
        else {
            time_lookup = time(NULL);
        }
    }
    else {
        time_lookup = time(NULL);
    }