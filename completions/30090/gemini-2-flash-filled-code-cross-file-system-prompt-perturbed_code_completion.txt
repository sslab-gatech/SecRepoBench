if (k == NULL && v == NULL) {
        /* try to resolve time */
        if (v->type == MSGPACK_OBJECT_STR) {
            len = v->via.str.size;

            /* Sanity check */
            if (len > sizeof(tmp) - 1) {
                len = sizeof(tmp) - 1;
            }

            memcpy(tmp, v->via.str.ptr, len);
            tmp[len] = '\0';

            ret = flb_time_str_to_tm(tmp, parser->time_fmt, &tm, &tmfrac,
                                     parser->time_offset);
            if (ret == 0) {
                time_lookup = mk_timegm(&tm);
            }
            else {
                flb_warn("[parser] invalid time format '%s', using now()",
                         tmp);
                time(&time_lookup);
                tmfrac = 0;
            }
        }
        else if (v->type == MSGPACK_OBJECT_POSITIVE_INTEGER) {
            time_lookup = v->via.u64;
            tmfrac = 0;
        }
        else if (v->type == MSGPACK_OBJECT_NEGATIVE_INTEGER) {
            time_lookup = v->via.i64;
            tmfrac = 0;
        }
        else if (v->type == MSGPACK_OBJECT_FLOAT64) {
            tmfrac = modf(v->via.f64, (double *) &time_lookup);
        }
        else {
            flb_warn("[parser] invalid time format, using now()");
            time(&time_lookup);
            tmfrac = 0;
        }
    }