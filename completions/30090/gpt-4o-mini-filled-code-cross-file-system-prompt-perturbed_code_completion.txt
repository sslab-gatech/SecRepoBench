if (skip == -1) {
        flb_free(mp_buf);
        *out_buf = NULL;
        msgpack_unpacked_destroy(&result);
        return -1;
    }

    /* Check if the value is a string and parse it as a time */
    if (v->type == MSGPACK_OBJECT_STR) {
        char *time_str = v->via.str.ptr;
        size_t time_str_len = v->via.str.size;

        /* Attempt to parse the time string */
        if (strptime(time_str, parser->time_fmt, &tm) != NULL) {
            time_lookup = mktime(&tm);
            tmfrac = 0; // Reset fractional seconds if not needed
        } else {
            flb_warn("[parser] failed to parse time string: %.*s", (int)time_str_len, time_str);
            time_lookup = 0; // Set to zero if parsing fails
        }
    } else {
        flb_free(mp_buf);
        *out_buf = NULL;
        msgpack_unpacked_destroy(&result);
        return -1;
    }