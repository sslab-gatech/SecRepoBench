if (k && v && v->type == MSGPACK_OBJECT_STR) {
    len = v->via.str.size;
    if (len > sizeof(tmp) - 1) {
        len = sizeof(tmp) - 1;
    }
    memcpy(tmp, v->via.str.ptr, len);
    tmp[len] = '\0';

    ret = flb_parser_time_lookup(tmp, len, parser, &tm, &tmfrac);
    if (ret == -1) {
        flb_warn("[parser] time resolution failed, setting time to zero");
        time_lookup = 0;
    }
    else {
        time_lookup = flb_parser_tm2time(&tm);
    }
}
else {
    flb_warn("[parser] time key not found or invalid type, setting time to zero");
    time_lookup = 0;
}