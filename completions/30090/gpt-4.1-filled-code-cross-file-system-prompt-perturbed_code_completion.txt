if (skip == map_size || !v) {
    /* time_key not found, set time to zero */
    time_lookup = 0;
    tmfrac = 0;
}
else {
    /* Try to parse the time value */
    if (v->type == MSGPACK_OBJECT_STR && v->via.str.ptr != NULL) {
        len = v->via.str.size;
        if (len >= sizeof(tmp)) {
            len = sizeof(tmp) - 1;
        }
        memcpy(tmp, v->via.str.ptr, len);
        tmp[len] = '\0';

        ret = flb_parser_time_lookup(tmp, len, parser, &tm, &tmfrac);
        if (ret == 0) {
            time_lookup = mktime(&tm);
        }
        else {
            flb_warn("[parser] JSON time parsing failed, invalid time format: '%s'", tmp);
            time_lookup = 0;
            tmfrac = 0;
        }
    }
    else if (v->type == MSGPACK_OBJECT_POSITIVE_INTEGER) {
        time_lookup = v->via.u64;
        tmfrac = 0;
    }
    else if (v->type == MSGPACK_OBJECT_FLOAT) {
        time_lookup = (time_t)v->via.f64;
        tmfrac = v->via.f64 - (double)time_lookup;
    }
    else {
        /* Unsupported type for time_key */
        time_lookup = 0;
        tmfrac = 0;
    }
}