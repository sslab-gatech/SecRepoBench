if (k && v && v->type == MSGPACK_OBJECT_STR) {
    len = v->via.str.size;
    if (len > sizeof(tmp) - 1) {
        len = sizeof(tmp) - 1;
    }
    memcpy(tmp, v->via.str.ptr, len);
    tmp[len] = '\0';

    ret = flb_parser_time_lookup(tmp, len, parser->time_fmt,
                                 parser->time_fmt_len, parser->time_frac_secs,
                                 &tm, &tmfrac);
    if (ret == -1) {
        flb_warn("[parser] Error parsing time field");
        time_lookup = 0;
    }
    else {
        time_lookup = flb_parser_tm2time(&tm);
    }
}
else {
    flb_warn("[parser] Missing time field in record");
    time_lookup = 0;
}