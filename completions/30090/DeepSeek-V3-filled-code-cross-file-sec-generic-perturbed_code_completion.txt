if (k == NULL || v == NULL) {
        flb_warn("[parser] no time_key field found");
        time_lookup = 0;
    }
    else {
        ret = flb_parser_time_lookup((char *) v->via.str.ptr, v->via.str.size,
                                     parser->time_fmt, &time_lookup, &tmfrac);
        if (ret == -1) {
            flb_warn("[parser] invalid time format %s for value '%s'",
                     parser->time_fmt, (char *) v->via.str.ptr);
            time_lookup = 0;
        }
    }