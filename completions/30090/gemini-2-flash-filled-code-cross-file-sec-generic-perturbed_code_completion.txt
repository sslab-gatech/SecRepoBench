if (k != NULL && v != NULL) {
        /* Parse time */
        len = v->via.str.size;

        /* Ensure the pointer we are about to read is not NULL */
        if (v->via.str.ptr == NULL) {
            flb_free(mp_buf);
            *out_buf = NULL;
            msgpack_unpacked_destroy(&result);
            return -1;
        }

        memset(tmp, '\0', sizeof(tmp));
        if (len > sizeof(tmp) - 1) {
            len = sizeof(tmp) - 1;
        }
        memcpy(tmp, v->via.str.ptr, len);

        ret = flb_time_str_to_tm(tmp, parser->time_fmt, &tm, &tmfrac);
        if (ret == 0) {
            time_lookup = mktime(&tm);
        }
        else {
            flb_warn("[parser] invalid time format found: %s", tmp);
            time_lookup = 0;
            tmfrac = 0;
        }
    }
    else {
        time_lookup = 0;
        tmfrac = 0;
    }