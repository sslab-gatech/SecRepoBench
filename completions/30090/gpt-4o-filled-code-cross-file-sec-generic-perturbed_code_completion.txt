if (k != NULL && v != NULL && v->type == MSGPACK_OBJECT_STR) {
    /* Attempt to parse the time value */
    memset(&tm, 0, sizeof(struct tm));
    ret = strptime(v->via.str.ptr, parser->time_fmt, &tm);
    if (ret == NULL) {
        flb_warn("[parser] could not parse time string '%.*s'",
                 (int) v->via.str.size, v->via.str.ptr);
        time_lookup = 0;
    }
    else {
        time_lookup = mktime(&tm);
        if (time_lookup == -1) {
            flb_warn("[parser] mktime failed for time string '%.*s'",
                     (int) v->via.str.size, v->via.str.ptr);
            time_lookup = 0;
        }
    }
}
else {
    time_lookup = 0;
}