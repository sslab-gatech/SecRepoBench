if (v->via.str.ptr == NULL) {
    flb_free(mp_buf);
    *out_buf = NULL;
    msgpack_unpacked_destroy(&result);
    return -1;
}

char *time_str = (char *)v->via.str.ptr;
struct tm tm_time;
if (strptime(time_str, parser->time_fmt, &tm_time) == NULL) {
    flb_warn("[flb_parser] time parsing failed for key: %.*s", (int)k->via.str.size, k->via.str.ptr);
    time_lookup = 0; // Set to zero if parsing fails
} else {
    time_lookup = mktime(&tm_time);
}