if (k && v && v->type == MSGPACK_OBJECT_STR) {
    len = v->via.str.size;
    if (len > sizeof(tmp) - 1) {
        len = sizeof(tmp) - 1;
    }
    memcpy(tmp, v->via.str.ptr, len);
    tmp[len] = '\0';

    /* Parse the time string */
    ret = flb_parser_time_lookup(tmp, len, 0, parser, &time_lookup, &tmfrac);
    if (ret == -1) {
        flb_warn("[parser] Error parsing time field");
        time_lookup = 0;
        tmfrac = 0;
    }
} else {
    time_lookup = 0;
    tmfrac = 0;
}