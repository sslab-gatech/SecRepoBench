if (k != NULL && v != NULL) {
        if (v->type == MSGPACK_OBJECT_STR) {
            /* Parse the time string */
            ret = flb_parser_time_lookup(parser, v->via.str.ptr, v->via.str.size,
                                         &tm, &tmfrac);
            if (ret == 0) {
                /* Convert to timestamp */
                time_lookup = flb_parser_tm2time(&tm);
            }
            else {
                flb_warn("[parser] time resolution failed for key '%s', setting to 0",
                         time_key);
                time_lookup = 0;
            }
        }
        else if (v->type == MSGPACK_OBJECT_POSITIVE_INTEGER ||
                 v->type == MSGPACK_OBJECT_NEGATIVE_INTEGER) {
            /* Use the integer value as the timestamp */
            time_lookup = (time_t) v->via.i64;
        }
        else {
            flb_warn("[parser] unsupported time format for key '%s', setting to 0",
                     time_key);
            time_lookup = 0;
        }
    }
    else {
        flb_warn("[parser] time key '%s' not found or invalid, setting to 0",
                 time_key);
        time_lookup = 0;
    }