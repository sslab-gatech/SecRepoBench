if (skip == map_size || !v || v->type != MSGPACK_OBJECT_STR || !v->via.str.ptr) {
        /* No valid time key or not a string, set to zero */
        time_lookup = 0;
        tmfrac = 0;
    }
    else {
        /* We have a valid key-value pair, parse as time string */
        if (v->via.str.size < sizeof(tmp)) {
            memcpy(tmp, v->via.str.ptr, v->via.str.size);
            tmp[v->via.str.size] = '\0';

            /* Attempt to parse the time */
            ret = flb_parser_time_lookup(parser, tmp, &tm, &tmfrac, &time_lookup);
            if (ret < 0) {
                flb_warn("[parser] could not parse time; setting to 0.");
                time_lookup = 0;
                tmfrac = 0;
            }
        }
        else {
            flb_warn("[parser] time string too large; setting to 0.");
            time_lookup = 0;
            tmfrac = 0;
        }
    }