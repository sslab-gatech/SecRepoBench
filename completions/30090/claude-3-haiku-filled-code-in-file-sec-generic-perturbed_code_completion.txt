// Check if a valid key-value pair exists in the map at the specified index.
if (k != NULL && v != NULL) {
    // Attempt to parse the value as a time string
    if (strptime(v->via.str.ptr, parser->time_fmt, &tm) != NULL) {
        // Convert the parsed time to a timestamp
        time_lookup = mktime(&tm);
        if (parser->time_frac_digits > 0) {
            // Extract the fractional part of the time
            snprintf(tmp, sizeof(tmp), "%.*f", parser->time_frac_digits, v->via.str.ptr + strlen(parser->time_fmt));
            tmfrac = atof(tmp);
        }
    }
    else {
        // Time parsing failed, log a warning and set the timestamp to zero
        flb_warn("[parser] could not parse time '%.*s' with format '%s'",
                 (int) v->via.str.size, v->via.str.ptr, parser->time_fmt);
        time_lookup = 0;
    }
}
else {
    // No valid key-value pair found, set the timestamp to zero
    time_lookup = 0;
}