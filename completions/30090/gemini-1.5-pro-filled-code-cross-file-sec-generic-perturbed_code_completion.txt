if (k && v) {
    if (v->type == MSGPACK_OBJECT_POSITIVE_INTEGER) {
        time_lookup = v->via.u64;
    }
    else if (v->type == MSGPACK_OBJECT_FLOAT) {
        time_lookup = (time_t)v->via.f64;
        tmfrac = v->via.f64 - time_lookup;
    }
    else if (v->type == MSGPACK_OBJECT_STR) {
        /* String format: try to parse it */
        if (flb_parser_time_lookup(parser, v, &tm, &tmfrac) == -1) {
            flb_plg_warn(ctx->ins, "invalid time format %.*s, using current time",
                         (int) v->via.str.size, v->via.str.ptr);
            time_lookup = time(NULL);
        }
        else {
            time_lookup = mk_gmtime(&tm);
        }
    }
    else {
        time_lookup = time(NULL);
    }
}
else {
    time_lookup = time(NULL);
}