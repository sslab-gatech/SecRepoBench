/* No time_key field found */
if (k != NULL && v != NULL) {
    ret = flb_parser_time_lookup(parser, k->via.str.ptr, k->via.str.size,
                                 v->via.str.ptr, v->via.str.size,
                                 &time_lookup, &tmfrac);
    if (ret == 0) {
        /* Time parsing successful, set the timestamp */
        t = out_time;
        t->tm.tv_sec  = time_lookup;
        t->tm.tv_nsec = (tmfrac * 1000000000);
    }
    else {
        /* Time parsing failed, set timestamp to zero */
        flb_warn("[parser:%s] time field '%.*s' could not be parsed",
                 parser->name, (int) k->via.str.size, k->via.str.ptr);
        t = out_time;
        t->tm.tv_sec  = 0;
        t->tm.tv_nsec = 0;
    }
}
else {
    /* No valid key-value pair found, set timestamp to zero */
    t = out_time;
    t->tm.tv_sec  = 0;
    t->tm.tv_nsec = 0;
}