if (k != NULL && v != NULL) {
    /* We need to validate the value type */
    if (v->type == MSGPACK_OBJECT_STRING) {
        /* Try to parse time */
        ret = flb_parser_time_lookup((const char *) v->via.str.ptr,
                                     v->via.str.size,
                                     0, parser, &tm, &tmfrac);
        if (ret == -1) {
            flb_error("[parser:%s] Invalid time format %s", 
                     parser->name, parser->time_fmt_full);
            time_lookup = 0;
        }
        else {
            time_lookup = flb_parser_tm2time(&tm);
        }
    }
    else {
        time_lookup = 0;
    }
}
else {
    time_lookup = 0;
}