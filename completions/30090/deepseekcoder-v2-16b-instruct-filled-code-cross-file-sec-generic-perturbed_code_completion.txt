/* Check if a valid key-value pair exists in the map at the specified index.
 * If a valid pair is found, attempt to parse the value as a time string.
 * Convert the parsed time to a timestamp. If the time parsing fails, log a warning and set the timestamp to zero.
 */
if (k != NULL && v != NULL && k->type == MSGPACK_OBJECT_STR && v->type == MSGPACK_OBJECT_STR) {
    char time_str[256];
    strncpy(time_str, v->via.str.ptr, v->via.str.size);
    time_str[v->via.str.size] = '\0';

    struct tm tm_time = {0};
    time_t parsed_time = 0;
    char *endptr;

    parsed_time = strtotime(time_str, &endptr, &tm_time);
    if (parsed_time == 0 && endptr == time_str) {
        flb_error("Failed to parse time string: %s", time_str);
    } else {
        time_lookup = parsed_time;
    }
} else {
    flb_error("Invalid key-value pair at index %d", index);
}