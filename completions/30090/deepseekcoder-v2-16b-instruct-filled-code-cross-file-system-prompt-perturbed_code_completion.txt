/* Check if a valid key-value pair exists in the map at the specified index.
 * If a valid pair is found, attempt to parse the value as a time string.
 * Convert the parsed time to a timestamp. If the time parsing fails, log a warning and set the timestamp to zero.
 */
if (k != NULL && v != NULL && k->type == MSGPACK_OBJECT_STR && v->type == MSGPACK_OBJECT_STR) {
    char *time_str = (char *)v->via.str.ptr;
    size_t time_len = v->via.str.size;

    struct tm tm_tmp = {0};
    time_t parsed_time = 0;
    char *endptr;

    // Attempt to parse the time string
    parsed_time = strptime(time_str, parser->time_fmt, &tm_tmp);
    if (parsed_time == 0) {
        // Parsing failed, log a warning and set the timestamp to zero
        flb_error("Failed to parse time string: %s", time_str);
        time_lookup = 0;
    } else {
        // Convert the parsed time to a timestamp
        time_lookup = mktime(&tm_tmp);
        if (time_lookup == -1) {
            // Conversion failed, log a warning and set the timestamp to zero
            flb_error("Failed to convert parsed time to timestamp: %s", time_str);
            time_lookup = 0;
        }
    }
} else {
    // Log a warning if the key-value pair is invalid
    flb_error("Invalid key-value pair found at index %d: key=%.*s, value=%.*s", index, (int)k->via.str.size, k->via.str.ptr, (int)v->via.str.size, v->via.str.ptr);
    time_lookup = 0;
}