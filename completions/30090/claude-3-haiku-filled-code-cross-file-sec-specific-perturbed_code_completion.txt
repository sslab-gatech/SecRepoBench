/* No time_key field found */
if (k != NULL && v != NULL) {
    /* Check if a valid key-value pair exists in the map at the specified index */
    if (parser->time_fmt) {
        /* Attempt to parse the value as a time string */
        if (flb_time_parse(v->via.str.ptr, v->via.str.size, &tm, parser->time_fmt, parser->time_offset) == 0) {
            /* Convert the parsed time to a timestamp */
            time_lookup = mktime(&tm);
        }
        else {
            /* Log a warning and set the timestamp to zero */
            flb_warn("[parser] could not parse time field '%.*s'", (int) v->via.str.size, v->via.str.ptr);
            time_lookup = 0;
        }
    }
    else {
        /* Set the timestamp to zero */
        time_lookup = 0;
    }
}
else {
    /* Set the timestamp to zero */
    time_lookup = 0;
}