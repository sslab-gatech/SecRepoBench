/* Check if the value is a string and if it is, attempt to parse it as a time string */
    if (v->type == MSGPACK_OBJECT_STR) {
        char *time_str = v->via.str.ptr;
        size_t time_str_len = v->via.str.size;
        struct tm tm = {0};
        struct flb_time *t;

        /* Parse the time string */
        if (strptime(time_str, parser->time_fmt, &tm) == NULL) {
            flb_warn("[parser] failed to parse time string '%.*s' using format '%s'",
                     (int) time_str_len, time_str, parser->time_fmt);
            time_lookup = 0;
        }
        else {
            time_lookup = mktime(&tm);
        }

        /* Convert the parsed time to a timestamp */
        t = out_time;
        t->tm.tv_sec  = time_lookup;
        t->tm.tv_nsec = (tmfrac * 1000000000);
    }
    else {
        flb_warn("[parser] time_key field has invalid type, expected string, got %d",
                 v->type);
        time_lookup = 0;
    }