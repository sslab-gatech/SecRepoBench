/* No time_key field found */
if (k != NULL && v != NULL) {
    // Check if a valid key-value pair exists in the map at the specified index.
    if (parser->time_fmt) {
        // Attempt to parse the value as a time string.
        struct tm tm = {0};
        if (strptime(v->via.str.ptr, parser->time_fmt, &tm) != NULL) {
            // Convert the parsed time to a timestamp.
            time_lookup = mktime(&tm);
        } else {
            // If the time parsing fails, log a warning and set the timestamp to zero.
            flb_warn("[parser] failed to parse time field '%.*s'", (int) v->via.str.size, v->via.str.ptr);
            time_lookup = 0;
        }
    } else {
        // If no time format is specified, set the timestamp to zero.
        time_lookup = 0;
    }
} else {
    // If a valid key-value pair does not exist, set the timestamp to zero.
    time_lookup = 0;
}