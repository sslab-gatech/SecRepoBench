if (k && v) {
    if (v->type == MSGPACK_OBJECT_STR) {
        ret = flb_parser_time_lookup(v->via.str.ptr, v->via.str.size,
                                     0, parser, &time_lookup, &tmfrac);
        if (ret == -1) {
            flb_warn("[parser] Error parsing time field, defaulting to zero");
            time_lookup = 0;
            tmfrac = 0;
        }
    }
    else {
        flb_warn("[parser] Time key is not a string, defaulting to zero");
        time_lookup = 0;
        tmfrac = 0;
    }
}
else {
    flb_warn("[parser] Time key not found, defaulting to zero");
    time_lookup = 0;
    tmfrac = 0;
}