if (k == NULL || v == NULL) {
        msgpack_unpacked_destroy(&result);
        return *out_size;
    }

    /* Parse time string */
    if (v->type == MSGPACK_OBJECT_STR) {
        ret = flb_parser_time_lookup((char *) v->via.str.ptr, v->via.str.size,
                                     parser->time_fmt, &time_lookup, &tmfrac, &tm);
        if (ret == -1) {
            flb_warn("[parser] invalid time format %s for value '%s'",
                     parser->time_fmt, v->via.str.ptr);
            time_lookup = 0;
        }
    }
    else if (v->type == MSGPACK_OBJECT_POSITIVE_INTEGER) {
        time_lookup = v->via.u64;
    }
    else if (v->type == MSGPACK_OBJECT_NEGATIVE_INTEGER) {
        time_lookup = v->via.i64;
    }
    else if (v->type == MSGPACK_OBJECT_FLOAT) {
        time_lookup = v->via.f64;
        tmfrac = v->via.f64 - time_lookup;
    }
    else {
        flb_warn("[parser] invalid time value type %d", v->type);
        time_lookup = 0;
    }