if (skip != -1 && skip < map_size) {
        if (v->type == MSGPACK_OBJECT_STR) {
            len = v->via.str.size;
            if (len > 254) {
                len = 254;
            }
            strncpy(tmp, v->via.str.ptr, len);
            tmp[len] = '\0';
            time_lookup = strtol(tmp, NULL, 10);
            if (time_lookup == 0 && errno == ERANGE) {
                flb_plg_error(parser->p, "time value out of range");
                time_lookup = 0;
            }
            else if (time_lookup == 0 && errno != 0) {
                flb_plg_error(parser->p, "invalid time format");
                time_lookup = 0;
            }
        }
        else if (v->type == MSGPACK_OBJECT_POSITIVE_INTEGER) {
            time_lookup = v->via.u64;
        }
        else if (v->type == MSGPACK_OBJECT_FLOAT) {
            tmfrac = v->via.f64;
            time_lookup = (time_t) tmfrac;
        }
        else {
            flb_plg_error(parser->p, "invalid time format");
            time_lookup = 0;
        }
    }
    else {
        time_lookup = time(NULL);
    }