if (skip == map_size) {
    flb_warn("[parser] time key '%s' not found, defaulting to epoch", time_key);
    time_lookup = 0;
}
else {
    v = &map.via.map.ptr[skip].val;
    if (v->type != MSGPACK_OBJECT_STR || v->via.str.ptr == NULL) {
        flb_warn("[parser] invalid time field for key '%s', defaulting to epoch", time_key);
        time_lookup = 0;
    }
    else {
        len = v->via.str.size < sizeof(tmp) - 1 ? v->via.str.size : sizeof(tmp) - 1;
        memcpy(tmp, v->via.str.ptr, len);
        tmp[len] = '\0';
        ret = flb_parser_time(parser->time_fmt, tmp, &time_lookup, &tmfrac);
        if (ret != 0) {
            flb_warn("[parser] failed to parse time string '%s', defaulting to epoch", tmp);
            time_lookup = 0;
        }
    }
}