/* No time_key field found */
if (k != NULL && v != NULL) {
    /* Check if a valid key-value pair exists in the map at the specified index */
    if (msgpack_object_is_str(k) && msgpack_object_is_str(v)) {
        /* Attempt to parse the value as a time string */
        if (parser->time_format_check(parser, v->via.str.ptr, v->via.str.size, &tm, &time_lookup, &tmfrac) == 0) {
            /* Time parsing successful, set the timestamp */
            t = out_time;
            t->tm.tv_sec = time_lookup;
            t->tm.tv_nsec = (tmfrac * 1000000000);
        }
        else {
            /* Time parsing failed, log a warning and set the timestamp to zero */
            flb_warn("[parser:%s] time field '%.*s' not in expected format '%s'",
                     parser->name, (int)v->via.str.size, v->via.str.ptr, parser->time_fmt);
            t = out_time;
            t->tm.tv_sec = 0;
            t->tm.tv_nsec = 0;
        }
    }
    else {
        /* Invalid key-value pair, log a warning and set the timestamp to zero */
        flb_warn("[parser:%s] invalid time field in record", parser->name);
        t = out_time;
        t->tm.tv_sec = 0;
        t->tm.tv_nsec = 0;
    }
}
else {
    /* No valid key-value pair found, set the timestamp to zero */
    t = out_time;
    t->tm.tv_sec = 0;
    t->tm.tv_nsec = 0;
}