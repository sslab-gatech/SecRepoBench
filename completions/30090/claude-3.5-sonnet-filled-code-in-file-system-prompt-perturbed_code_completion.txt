if (k && v) {
    /* We found the time key, parse it */
    if (v->type == MSGPACK_OBJECT_STR) {
        ret = flb_parser_time_lookup(v->via.str.ptr, v->via.str.size,
                                     &time_lookup, &tmfrac,
                                     parser->time_fmt,
                                     parser->time_fmt_len,
                                     parser->time_frac_secs,
                                     &parser->time_lru,
                                     parser->time_zone);
        if (ret == -1) {
            flb_warn("[parser] Error parsing time field");
            time_lookup = 0;
            tmfrac = 0;
        }
    }
    else {
        flb_warn("[parser] Time key is not a string");
        time_lookup = 0;
        tmfrac = 0;
    }
}
else {
    /* No time key found, set time to zero */
    time_lookup = 0;
    tmfrac = 0;
}