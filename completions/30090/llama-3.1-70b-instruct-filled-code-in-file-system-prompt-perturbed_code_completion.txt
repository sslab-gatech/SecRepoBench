if (skip!= map_size) {
    if (v->type == MSGPACK_OBJECT_STR) {
        strncpy(tmp, v->via.str.ptr, v->via.str.size);
        tmp[v->via.str.size] = '\0';

        if (parser->time_fmt) {
            if (strptime(tmp, parser->time_fmt, &tm) == NULL) {
                mk_log(MK_LOG_WARN, "Failed to parse time string: %s", tmp);
                time_lookup = 0;
            }
            else {
                time_lookup = mktime(&tm);
            }
        }
        else {
            time_lookup = atoi(tmp);
        }
    }
    else if (v->type == MSGPACK_OBJECT_POSITIVE_INTEGER) {
        time_lookup = v->via.u64;
    }
    else if (v->type == MSGPACK_OBJECT_NEGATIVE_INTEGER) {
        time_lookup = v->via.i64;
    }
    else {
        mk_log(MK_LOG_WARN, "Invalid time type: %d", v->type);
        time_lookup = 0;
    }
}
else {
    time_lookup = 0;
}