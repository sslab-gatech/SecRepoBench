if (k && v) {
        if (parser->time_lookup == FLB_TRUE) {
            flb_parser_time_lookup(v, &tm, &tmfrac, parser);
            time_lookup = mktime(&tm);

            if (time_lookup == -1) {
                flb_plg_warn(ctx->ins, "invalid time format %s, set time to 0",
                             in_buf);
                time_lookup = 0;
            }
        }
        else {
            if (v->type == MSGPACK_OBJECT_POSITIVE_INTEGER) {
                time_lookup = (time_t) v->via.u64;
            }
            else if (v->type == MSGPACK_OBJECT_FLOAT) {
                time_lookup = (time_t) v->via.f64;
            }
            else {
                flb_plg_warn(ctx->ins, "invalid time format %s, set time to 0",
                             in_buf);
                time_lookup = 0;
            }
        }
    }
    else {
        time_lookup = time(NULL);
    }