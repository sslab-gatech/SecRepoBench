if (k != NULL && v != NULL) {
        // Attempt to parse the value as a time string
        if (v->type == MSGPACK_OBJECT_STR) {
            char *time_str = (char *)v->via.str.ptr;
            if (strptime(time_str, parser->time_fmt, &tm) != NULL) {
                time_lookup = mktime(&tm);
                if (time_lookup == -1) {
                    flb_error("Failed to convert time string to timestamp.");
                    time_lookup = 0;
                }
            } else {
                flb_warn("Failed to parse time string: %s", time_str);
                time_lookup = 0;
            }
        } else {
            flb_warn("Time field is not a string.");
            time_lookup = 0;
        }
    } else {
        flb_warn("Invalid key-value pair found in the map.");
        time_lookup = 0;
    }