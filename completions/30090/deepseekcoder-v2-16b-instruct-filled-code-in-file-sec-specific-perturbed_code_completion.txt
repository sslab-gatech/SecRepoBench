if (k != NULL && v != NULL) {
        // Attempt to parse the value as a time string
        if (v->type == MSGPACK_OBJECT_STR) {
            char *time_str = (char *)v->via.str.ptr;
            if (strptime(time_str, parser->time_fmt, &tm) != NULL) {
                time_lookup = mktime(&tm);
                tmfrac = difftime(mktime(&tm), time_lookup);
            } else {
                // Log a warning and set the timestamp to zero
                flb_error("Failed to parse time string: %s", time_str);
                time_lookup = 0;
                tmfrac = 0;
            }
        } else {
            // Log a warning and set the timestamp to zero
            flb_error("Time field is not a string");
            time_lookup = 0;
            tmfrac = 0;
        }
    } else {
        // Log a warning and set the timestamp to zero
        flb_error("Invalid key-value pair found in the map");
        time_lookup = 0;
        tmfrac = 0;
    }