if (k && v && skip != map_size) {
    if (v->type == MSGPACK_OBJECT_STR) {
        ret = flb_parser_to_time(parser,
                                 v->via.str.ptr,
                                 v->via.str.size,
                                 &tm,
                                 &tmfrac);
        if (ret == 0) {
            time_lookup = timegm(&tm);
        }
        else {
            fprintf(stderr, "[warn] time parsing failed, setting timestamp to 0\n");
            time_lookup = 0;
        }
    }
    else {
        fprintf(stderr, "[warn] time field is not a string, setting timestamp to 0\n");
        time_lookup = 0;
    }
}
else {
    /* No valid time key or invalid key-value pair found */
    time_lookup = 0;
}