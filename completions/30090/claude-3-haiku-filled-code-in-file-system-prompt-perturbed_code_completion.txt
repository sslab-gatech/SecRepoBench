if (k != NULL && v != NULL) {
    if (v->type == MSGPACK_OBJECT_STR) {
        len = v->via.str.size;
        if (len > 0) {
            memcpy(tmp, v->via.str.ptr, len);
            tmp[len] = '\0';
            if (flb_parser_time_lookup(parser, tmp, len, &time_lookup, &tmfrac) == 0) {
                out_time->tm.tv_sec = time_lookup;
                out_time->tm.tv_nsec = (tmfrac * 1000000000);
            }
            else {
                flb_warn("[parser] could not parse time field '%s'", time_key);
                out_time->tm.tv_sec = 0;
                out_time->tm.tv_nsec = 0;
            }
        }
    }
    else if (v->type == MSGPACK_OBJECT_POSITIVE_INTEGER) {
        time_lookup = v->via.u64;
        out_time->tm.tv_sec = time_lookup;
        out_time->tm.tv_nsec = 0;
    }
    else if (v->type == MSGPACK_OBJECT_NEGATIVE_INTEGER) {
        time_lookup = v->via.i64;
        out_time->tm.tv_sec = time_lookup;
        out_time->tm.tv_nsec = 0;
    }
    else {
        flb_warn("[parser] unsupported time field type for '%s'", time_key);
        out_time->tm.tv_sec = 0;
        out_time->tm.tv_nsec = 0;
    }
}
else {
    flb_warn("[parser] no valid key-value pair found for time field '%s'", time_key);
    out_time->tm.tv_sec = 0;
    out_time->tm.tv_nsec = 0;
}