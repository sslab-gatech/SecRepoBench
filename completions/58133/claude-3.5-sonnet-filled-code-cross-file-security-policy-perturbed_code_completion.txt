int index = 0;
while (*src) {
  char* endptr;
  long num = strtol(src, &endptr, 10);
  if (endptr == src) {
    break;  // No valid number found
  }
  if (num <= 0 || num >= DEFAULTFLAGS) {
    if (af != NULL) {
      HUNSPELL_WARNING(stderr,
                       "error: line %d: flag id %ld is out of range (1-%d)\n",
                       af->getlinenum(), num, DEFAULTFLAGS - 1);
    }
    num = 0;  // Set to 0 if out of range
  }
  if (index < len) {
    dest[index] = (unsigned short)num;
    index++;
  } else {
    break;  // Prevent buffer overflow
  }
  src = (*endptr == ',') ? endptr + 1 : endptr;
}
len = index;  // Update len to actual number of flags parsed