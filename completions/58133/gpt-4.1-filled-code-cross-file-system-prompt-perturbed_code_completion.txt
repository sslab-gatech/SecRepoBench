int idx = 0;
while (*src) {
  // Find the end of the current number (either ',' or end of string)
  const char* end = src;
  while (*end && *end != ',') ++end;

  // Extract the number as a substring
  std::string numstr(src, end - src);
  int val = atoi(numstr.c_str());
  if (val >= DEFAULTFLAGS && af != NULL) {
    HUNSPELL_WARNING(stderr,
                     "error: line %d: flag id %d is too large (max: %d)\n",
                     af->getlinenum(), val, DEFAULTFLAGS - 1);
    val = 0;
  }
  if (val == 0 && af != NULL) {
    HUNSPELL_WARNING(stderr, "error: line %d: 0 is wrong flag id\n",
                     af->getlinenum());
  }
  dest[idx++] = (unsigned short)val;

  // Move to the next number if any
  src = end;
  if (*src == ',') ++src;
}
break;