{
  unsigned short* dest_ptr = *result;
  const char* start = src;
  for (const char* p = start; *p; ++p) {
    if (*p == ',') {
      int val = atoi(start);
      if (val >= DEFAULTFLAGS && af != NULL) {
        HUNSPELL_WARNING(stderr,
                         "error: line %d: flag id %d is too large (max: %d)\n",
                         af->getlinenum(), val, DEFAULTFLAGS - 1);
        val = 0;
      }
      *dest_ptr++ = (unsigned short)val;
      if (val == 0 && af != NULL) {
        HUNSPELL_WARNING(stderr,
                         "error: line %d: 0 is wrong flag id\n",
                         af->getlinenum());
      }
      start = p + 1;
    }
  }
  int val = atoi(start);
  if (val >= DEFAULTFLAGS && af != NULL) {
    HUNSPELL_WARNING(stderr,
                     "error: line %d: flag id %d is too large (max: %d)\n",
                     af->getlinenum(), val, DEFAULTFLAGS - 1);
    val = 0;
  }
  *dest_ptr++ = (unsigned short)val;
  if (val == 0 && af != NULL) {
    HUNSPELL_WARNING(stderr,
                     "error: line %d: 0 is wrong flag id\n",
                     af->getlinenum());
  }
}