int index = 0;
      while (*src) {
        char* endptr;
        long value = strtol(src, &endptr, 10);

        if (endptr == src) {
          HUNSPELL_WARNING(stderr, "error: invalid number in flagvector\n");
          delete[] *result;
          *result = NULL;
          return 0;
        }

        if (value < 0 || value >= DEFAULTFLAGS) {
          HUNSPELL_WARNING(stderr,
                           "error: flag id %ld is out of range (max: %d)\n",
                           value, DEFAULTFLAGS - 1);
          value = 0;
        }

        dest[index++] = (unsigned short)value;

        if (*endptr == ',') {
          src = endptr + 1;
        } else {
          src = endptr;
          break;
        }
      }

      if (index != len) {
        HUNSPELL_WARNING(stderr, "error: mismatch in expected and actual flag count\n");
        delete[] *result;
        *result = NULL;
        return 0;
      }