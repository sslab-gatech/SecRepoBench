unsigned short* dest = *result;
const char* src = flags.c_str();
const char* start = src;
while (*src!= '\0') {
  if (*src == ',') {
    std::string numstr(start, src);
    int num = atoi(numstr.c_str());
    if (num >= DEFAULTFLAGS) {
      HUNSPELL_WARNING(stderr, "error: flag id %d is too large (max: %d)\n",
                       num, DEFAULTFLAGS - 1);
      num = 0;
    }
    if (num == 0)
      HUNSPELL_WARNING(stderr, "error: 0 is wrong flag id\n");
    *dest = (unsigned short)num;
    dest++;
    src++;
    start = src;
  } else {
    src++;
  }
}
if (src > start) {
  std::string numstr(start, src);
  int num = atoi(numstr.c_str());
  if (num >= DEFAULTFLAGS) {
    HUNSPELL_WARNING(stderr, "error: flag id %d is too large (max: %d)\n",
                     num, DEFAULTFLAGS - 1);
    num = 0;
  }
  if (num == 0)
    HUNSPELL_WARNING(stderr, "error: 0 is wrong flag id\n");
  *dest = (unsigned short)num;
}