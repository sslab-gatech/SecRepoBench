{
    ssize_t avail;
    const void *p = __archive_read_ahead(a, 9, &avail);
    if (avail < 9) {
        archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
            "Truncated zipx lzma header");
        return ARCHIVE_FATAL;
    }
    const uint8_t *ptr = (const uint8_t *)p;
    if (ptr[0] != 0x09 || ptr[1] != 0x14 ||
        ptr[2] != 0x05 || ptr[3] != 0x00) {
        archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
            "Invalid zipx lzma header magic");
        return ARCHIVE_FATAL;
    }
    lzma_stream_pointer = ptr;
}