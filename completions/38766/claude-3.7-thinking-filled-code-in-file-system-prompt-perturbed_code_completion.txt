// Read the initial part of the ZIPX stream
p = __archive_read_ahead(a, 9, NULL);
if (p == NULL) {
	archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
	    "Truncated ZIP file header");
	return (ARCHIVE_FATAL);
}
lzma_stream_pointer = (const uint8_t *)p;

// Verify the ZIPX LZMA header signature
// First four bytes should be 0x0914 0500 (according to the comment)
if (lzma_stream_pointer[0] != 0x09 || lzma_stream_pointer[1] != 0x14 ||
    lzma_stream_pointer[2] != 0x05 || lzma_stream_pointer[3] != 0x00) {
	archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
	    "Invalid LZMA header in ZIPX file");
	return (ARCHIVE_FATAL);
}

// Copy the LZMA parameters (5 bytes) from the ZIPX stream to the alone header