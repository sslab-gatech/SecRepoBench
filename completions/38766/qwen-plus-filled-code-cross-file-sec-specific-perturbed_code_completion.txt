// Validate the magic numbers in the ZIPX stream
if (zip->entry_bytes_remaining < 9) {
	archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
	    "Truncated ZIPX LZMA file data");
	return (ARCHIVE_FATAL);
}

// Ensure lzma_stream_pointer points to valid data
if (lzma_stream_pointer == NULL) {
	archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
	    "Invalid ZIPX LZMA stream pointer");
	return (ARCHIVE_FATAL);
}

// Verify specific byte values for the magic numbers
if (memcmp(lzma_stream_pointer, "\x09\x14\x05\x00", 4) != 0) {
	archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
	    "Invalid magic numbers in ZIPX LZMA stream");
	return (ARCHIVE_FAILED);
}

// Prepare the LZMA 'alone' header by copying LZMA parameters
memcpy(&alone_header.bytes[0], lzma_stream_pointer + 4, 5);