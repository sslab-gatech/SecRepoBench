{
	const uint8_t* p;
	ssize_t bytes_avail;

	/* Read 9 bytes from the stream (magic1 + magic2 + 5-byte LZMA params). */
	p = __archive_read_ahead(a, 9, &bytes_avail);
	if (p == NULL || bytes_avail < 9) {
		archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
		    "Truncated ZIPX LZMA stream");
		return (ARCHIVE_FATAL);
	}

	/* Validate expected magic bytes. This example checks for the typical
	 * 09 14 for magic1 and 05 00 for magic2, but adjust checks if needed. */
	if (p[0] != 0x09 || p[1] != 0x14) {
		archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
		    "Invalid magic bytes in ZIPX LZMA stream");
		return (ARCHIVE_FAILED);
	}
	if (p[2] != 0x05 || p[3] != 0x00) {
		archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
		    "Invalid block header in ZIPX LZMA stream");
		return (ARCHIVE_FAILED);
	}

	/* Assign pointer to parsed data. */
	lzma_stream_pointer = p;
}