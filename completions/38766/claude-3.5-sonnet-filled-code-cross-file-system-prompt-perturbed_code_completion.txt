uint8_t zipx_header[9];
if (__archive_read_consume(a, 9) < 9 || 
    __archive_read_read(a, zipx_header, 9) != 9) {
    archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
        "Truncated ZIPX LZMA header");
    return (ARCHIVE_FATAL);
}

if (zipx_header[0] != 0x09 || zipx_header[1] != 0x14 || 
    zipx_header[2] != 0x05 || zipx_header[3] != 0x00) {
    archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
        "Invalid ZIPX LZMA header");
    return (ARCHIVE_FATAL);
}

lzma_stream_pointer = zipx_header;