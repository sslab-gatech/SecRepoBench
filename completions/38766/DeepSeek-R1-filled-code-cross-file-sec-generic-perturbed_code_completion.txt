const void *p = __archive_read_ahead(a, 9, NULL);
	if (p == NULL) {
		archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
		    "Truncated ZIPX LZMA stream");
		return ARCHIVE_FATAL;
	}

	lzma_stream_pointer = (const uint8_t *)p;

	if (lzma_stream_pointer[0] != 0x09 || lzma_stream_pointer[1] != 0x14 ||
	    lzma_stream_pointer[2] != 0x05 || lzma_stream_pointer[3] != 0x00) {
		archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
		    "Invalid ZIPX LZMA magic");
		return ARCHIVE_FATAL;
	}