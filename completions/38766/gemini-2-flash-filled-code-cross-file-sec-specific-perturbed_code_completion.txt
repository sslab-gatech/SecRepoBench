const void* stream_start = __archive_read_ahead(a, 9, NULL);
	if (stream_start == NULL) {
		archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
		    "Truncated lzma stream in zipx");
		return ARCHIVE_FAILED;
	}

	lzma_stream_pointer = (const uint8_t*)stream_start;

	/* Check the magic bytes */
	if (lzma_stream_pointer[0] != 0x09 || lzma_stream_pointer[1] != 0x14) {
		archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
		    "Invalid lzma stream header in zipx");
		return ARCHIVE_FAILED;
	}

	/* Copy the LZMA properties, skipping the magic bytes */
	/* lzma_stream_pointer + 2 is skipped because it contains the version
	 * and flags, which are not used in the lzma alone header. */