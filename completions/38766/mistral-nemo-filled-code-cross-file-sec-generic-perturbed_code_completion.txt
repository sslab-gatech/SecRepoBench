// Read the initial part of the ZIPX stream to extract the magic numbers
	// and LZMA parameters. Ensure that the data format is as expected by
	// validating specific byte values. If the format is incorrect or the data
	// is truncated, set an appropriate error and return a failure code.
	// Prepare an LZMA 'alone' header by copying the LZMA parameters from
	// the ZIPX stream to the appropriate location in the header.
	lzma_stream_pointer = zip->zipx_lzma_stream.next_in;
	if (lzma_stream_pointer[0] != 0x09 || lzma_stream_pointer[1] != 0x14) {
		archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
		    "Invalid ZIPX LZMA stream format");
		return (ARCHIVE_FAILED);
	}

	memcpy(&alone_header.bytes[0], lzma_stream_pointer + 2, 5);

	// Validate the LZMA parameters
	if (alone_header.bytes[0] != 0x5d || alone_header.bytes[1] != 0x00 ||
	    alone_header.bytes[2] != 0x80 || alone_header.bytes[3] != 0xff ||
	    alone_header.bytes[4] != 0xff) {
		archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
		    "Invalid LZMA parameters in ZIPX stream");
		return (ARCHIVE_FAILED);
	}

	// Consume the 2 bytes of magic numbers
	__archive_read_consume(a, 2);
	zip->entry_bytes_remaining -= 2;
	zip->entry_compressed_bytes_read += 2;