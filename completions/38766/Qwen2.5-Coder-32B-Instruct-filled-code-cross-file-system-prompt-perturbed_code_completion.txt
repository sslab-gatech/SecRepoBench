lzma_stream_pointer = __archive_read_ahead(a, 9, NULL);
if (lzma_stream_pointer == NULL) {
    archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
        "Truncated file data in LZMA stream");
    return (ARCHIVE_FATAL);
}

if (lzma_stream_pointer[0] != 0x09 || lzma_stream_pointer[1] != 0x14) {
    archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
        "Invalid magic numbers in LZMA stream");
    return (ARCHIVE_FATAL);
}