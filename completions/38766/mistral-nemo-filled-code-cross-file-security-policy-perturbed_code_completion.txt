if (lzma_stream_pointer + 5 > zip->entry->compressed_size) {
		archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
		    "Truncated LZMA stream");
		return (ARCHIVE_FATAL);
	}

	// Read the initial part of the ZIPX stream to extract the magic numbers
	// and LZMA parameters. Ensure that the data format is as expected by
	// validating specific byte values. If the format is incorrect or the data
	// is truncated, set an appropriate error and return a failure code.
	// Prepare an LZMA 'alone' header by copying the LZMA parameters from
	// the ZIPX stream to the appropriate location in the header.
	// <MASK>
	memcpy(&alone_header.bytes[0], lzma_stream_pointer + 4, 5);
	if (memcmp(alone_header.bytes, "\x5d\x00\x00\x80\x00", 5) != 0) {
		archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
		    "Invalid LZMA stream format");
		return (ARCHIVE_FATAL);
	}