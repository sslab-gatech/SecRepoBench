/* To unpack ZIPX's "LZMA" (id 14) stream we can use standard liblzma
	 * that is a part of XZ Utils. The stream format stored inside ZIPX
	 * file is a modified "lzma alone" file format, that was used by the
	 * `lzma` utility which was later deprecated in favour of `xz` utility.
	 * Since those formats are nearly the same, we can use a standard
	 * "lzma alone" decoder from XZ Utils. */

	// Read the initial part of the ZIPX stream to extract the magic numbers
	// and LZMA parameters. Ensure that the data format is as expected by
	// validating specific byte values. If the format is incorrect or the data
	// is truncated, set an appropriate error and return a failure code.
	// Prepare an LZMA 'alone' header by copying the LZMA parameters from
	// the ZIPX stream to the appropriate location in the header.
	if (archive_read_ahead(a, 9, NULL) == NULL) {
		archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
		    "Truncated ZIPX LZMA stream");
		return ARCHIVE_FATAL;
	}
	memcpy(&alone_header.bytes[0], lzma_stream_pointer + 4, 5);