/* Read the header (9 bytes = 2 byte magic1 + 2 byte magic2 + 5 bytes lzma_params) */
const size_t header_size = 9;
lzma_stream_pointer = __archive_read_ahead(a, header_size, NULL);
if (lzma_stream_pointer == NULL) {
    archive_set_error(&(a->archive), ARCHIVE_ERRNO_FILE_FORMAT,
        "Truncated zipx lzma stream");
    return (ARCHIVE_FATAL);
}

/* Check the magic numbers and ensure the format is as expected */
if (lzma_stream_pointer[0] != 0x09 || lzma_stream_pointer[1] != 0x14 ||
    lzma_stream_pointer[2] != 0x05 || lzma_stream_pointer[3] != 0x00) {
    archive_set_error(&(a->archive), ARCHIVE_ERRNO_FILE_FORMAT,
        "Invalid zipx lzma stream header");
    return (ARCHIVE_FATAL);
}