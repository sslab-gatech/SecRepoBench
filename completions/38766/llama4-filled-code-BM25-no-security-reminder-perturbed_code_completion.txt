const void* p;
ssize_t bytes_avail;

p = __archive_read_ahead(a, 9, &bytes_avail);
if (bytes_avail < 9) {
    archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
        "Truncated LZMA file body");
    return (ARCHIVE_FATAL);
}

lzma_stream_pointer = p;

if (archive_le16dec(p) != 0x1400) {
    archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
        "Invalid LZMA stream header");
    return (ARCHIVE_FAILED);
}

if (((const uint8_t*)p)[4] != 0x05) {
    archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
        "Unsupported LZMA stream properties");
    return (ARCHIVE_FAILED);
}

memcpy(&alone_header.bytes[0], lzma_stream_pointer + 4, 5);