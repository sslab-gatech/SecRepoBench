{
	ssize_t avail;
	const uint8_t *header = __archive_read_ahead(a, 9, &avail);
	if (avail < 9) {
		archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
		    "Truncated ZIPX lzma header");
		return (ARCHIVE_FATAL);
	}
	/* Verify the expected magic numbers.
	 * Expected: magic1 = {0x09, 0x14} and magic2 = {0x05, 0x00} */
	if (header[0] != 0x09 || header[1] != 0x14) {
		archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
		    "Invalid ZIPX lzma magic numbers (magic1)");
		return (ARCHIVE_FATAL);
	}
	if (header[2] != 0x05 || header[3] != 0x00) {
		archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
		    "Invalid ZIPX lzma magic numbers (magic2)");
		return (ARCHIVE_FATAL);
	}
	lzma_stream_pointer = header;
}