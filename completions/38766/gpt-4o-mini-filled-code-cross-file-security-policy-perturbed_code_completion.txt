lzma_stream_pointer = __archive_read_ahead(a, 9, NULL);
	if (lzma_stream_pointer == NULL) {
		archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
		    "Truncated ZIPX LZMA stream");
		return (ARCHIVE_FATAL);
	}

	if (zip->entry_bytes_remaining < 9) {
		archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
		    "Insufficient data for ZIPX LZMA header");
		return (ARCHIVE_FATAL);
	}

	if (lzma_stream_pointer[0] != 0x5d || lzma_stream_pointer[1] != 0x00) {
		archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
		    "Invalid magic numbers in ZIPX LZMA stream");
		return (ARCHIVE_FAILED);
	}