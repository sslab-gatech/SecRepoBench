uint8_t header[9];
if (__archive_read_full(a, header, 9) != 9) {
    archive_set_error(&(a->archive), ARCHIVE_ERRNO_FILE_FORMAT,
        "Truncated ZIPX LZMA header");
    return (ARCHIVE_FATAL);
}

if (header[0] != 0x09 || header[1] != 0x14 || header[2] != 0x05 || header[3] != 0x00) {
    archive_set_error(&(a->archive), ARCHIVE_ERRNO_FILE_FORMAT,
        "Invalid ZIPX LZMA header");
    return (ARCHIVE_FATAL);
}

lzma_stream_pointer = header + 4;