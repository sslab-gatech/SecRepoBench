lzma_stream_pointer = __archive_read_ahead(a, 9, NULL);
	if(!lzma_stream_pointer) {
		archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
		    "Truncated file data in LZMA stream");
		return (ARCHIVE_FATAL);
	}

	/* Check if the stream starts with expected magic numbers. */
	if(lzma_stream_pointer[0] != 0x09 || lzma_stream_pointer[1] != 0x14) {
		archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
		    "Invalid magic numbers in LZMA stream");
		return (ARCHIVE_FAILED);
	}

	/* Check if the stream has expected version number. */
	if(lzma_stream_pointer[2] != 0x05 || lzma_stream_pointer[3] != 0x00) {
		archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
		    "Invalid version number in LZMA stream");
		return (ARCHIVE_FAILED);
	}

	/* Prepare the header. */