const char *p;
ssize_t bytes_avail;

p = __archive_read_ahead(a, 9, &bytes_avail);
if (p == NULL || bytes_avail < 9) {
    archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
        "Truncated ZIP file header");
    return ARCHIVE_FATAL;
}

if (memcmp(p, "\x09\x14\x05\x00", 4) != 0) {
    archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
        "Invalid ZIPX LZMA header");
    return ARCHIVE_FATAL;
}

lzma_stream_pointer = p + 4;