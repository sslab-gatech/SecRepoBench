const void *p = __archive_read_ahead(a, 9, NULL);
if (p == NULL) {
    archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
        "Truncated ZIPX LZMA stream");
    return (ARCHIVE_FATAL);
}

lzma_stream_pointer = p;

if (memcmp(lzma_stream_pointer, "\x09\x14\x05\x00", 4) != 0) {
    archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
        "Invalid ZIPX LZMA stream header");
    return (ARCHIVE_FATAL);
}