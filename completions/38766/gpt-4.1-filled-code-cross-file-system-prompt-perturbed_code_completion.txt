lzma_stream_pointer = __archive_read_ahead(a, 9, NULL);
if (!lzma_stream_pointer) {
	archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
	    "Truncated file data in LZMA stream");
	return (ARCHIVE_FATAL);
}

/* Validate the magic numbers. ZIPX LZMA stream should start with 0x09 0x14 0x05 0x00. */
if (lzma_stream_pointer[0] != 0x09 || lzma_stream_pointer[1] != 0x14 ||
    lzma_stream_pointer[2] != 0x05 || lzma_stream_pointer[3] != 0x00) {
	archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
	    "Invalid LZMA stream header in ZIPX file");
	return (ARCHIVE_FAILED);
}