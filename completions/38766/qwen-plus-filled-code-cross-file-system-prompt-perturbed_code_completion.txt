/* Read the first 9 bytes of the ZIPX stream. */
lzma_stream_pointer = __archive_read_ahead(a, 9, NULL);
if (!lzma_stream_pointer) {
	archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
	    "Truncated file data in LZMA alone stream");
	return (ARCHIVE_FATAL);
}

/* Validate magic1 and magic2 headers. */
if ((lzma_stream_pointer[0] != 0x09 || lzma_stream_pointer[1] != 0x14 ||
     lzma_stream_pointer[2] != 0x05 || lzma_stream_pointer[3] != 0x00)) {
	archive_set_error(&a->archive, ARCHIVE_ERRNO_FILE_FORMAT,
	    "Invalid magic numbers in LZMA alone stream");
	return (ARCHIVE_FAILED);
}

/* Consume the already-read header bytes from the input stream. */
__archive_read_consume(a, 9);

/* Copy the LZMA parameters into the alone_header structure. */
memcpy(&alone_header.bytes[0], lzma_stream_pointer + 4, 5);

/* Ensure uncompressed size is set to UINT64_MAX as the ZIPX format lacks it. */
alone_header.uncompressed_size = UINT64_MAX;