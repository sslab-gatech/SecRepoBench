if (!urlString) return;

// Check for "file:///" prefix (common for local files)
const char *prefix1 = "file:///";
const char *prefix2 = "file://";
size_t len1 = strlen(prefix1);
size_t len2 = strlen(prefix2);

if (!strncmp(urlString, prefix1, len1)) {
	// On Windows, after "file:///", there may be a drive letter (e.g., "file:///C:/path")
	// Remove "file:///" prefix
	memmove(urlString, urlString + len1, strlen(urlString + len1) + 1);
} else if (!strncmp(urlString, prefix2, len2)) {
	// Remove "file://" prefix
	memmove(urlString, urlString + len2, strlen(urlString + len2) + 1);
}

// Replace "%20" with space
char *p = urlString;
while ((p = strstr(p, "%20")) != NULL) {
	*p = ' ';
	memmove(p + 1, p + 3, strlen(p + 3) + 1);
	p++;
}