#define MAX_URL_LENGTH 2048
char fsPath[MAX_URL_LENGTH];

// Check if the URL starts with "file://"
if (strncmp(urlString, "file://", 7) == 0) {
    // Adjust for "file:///" prefix with a drive letter
    if (strncmp(urlString, "file:///", 8) == 0) {
        snprintf(fsPath, MAX_URL_LENGTH, "%s", urlString + 7); // Skip "file:///"
    } else {
        snprintf(fsPath, MAX_URL_LENGTH, "%s", urlString + 7); // Skip "file://"
    }
} else {
    snprintf(fsPath, MAX_URL_LENGTH, "%s", urlString); // Copy the URL as is
}

// Replace "%20" with spaces
char *pos = fsPath;
while ((pos = strstr(pos, "%20")) != NULL) {
    strncpy(pos, " ", 1);
    memmove(pos + 1, pos + 3, strlen(pos + 3) + 1); // Shift the rest of the string left
}

// Ensure the final path is null-terminated and safe
fsPath[MAX_URL_LENGTH - 1] = '\0';