if (urlString && strlen(urlString) > 7 && strncmp(urlString, "file://", 7) == 0) {
    size_t len = strlen(urlString);
    if (len > 8 && urlString[7] == '/') {
        memmove(urlString, urlString + 8, len - 7);
    } else if (len > 1 && urlString[1] == ':') {
        memmove(urlString, urlString + 1, len - 1);
    }
}

for (char *p = urlString; *p; p++) {
    if (*p == '%' && *(p + 1) == '2' && *(p + 2) == '0') {
        *p = ' ';
        memmove(p + 1, p + 3, strlen(p + 3) + 1);
    }
}