if (!urlString) return;

// Check for file:// prefix
if (!strncmp(urlString, "file://", 7)) {
    if (urlString[7] == '/' && urlString[8] && urlString[9] == ':') {
        // This is a file:///C:/ style URL with a drive letter
        // We want to remove "file:///" to get "C:/..."
        memmove(urlString, urlString + 8, strlen(urlString + 8) + 1);
    } else {
        // This is a regular file:// URL
        // We want to remove "file://" to get the path
        memmove(urlString, urlString + 7, strlen(urlString + 7) + 1);
    }
}

// Replace %20 with spaces
size_t len = strlen(urlString);
size_t i = 0, j = 0;

while (i < len) {
    if (i + 2 < len && urlString[i] == '%' && urlString[i+1] == '2' && urlString[i+2] == '0') {
        urlString[j++] = ' ';
        i += 3;
    } else {
        urlString[j++] = urlString[i++];
    }
}
urlString[j] = '\0';