// Analyze the packet payload to determine if it might be an OpenVPN packet.
  // If the payload length is sufficient, adjust the payload pointer if it's over TCP.
  // Extract the operation code from the payload and, if it's over UDP, perform additional checks:
  //   - If the first packet in the flow matches specific length and operation code criteria, identify it as OpenVPN.
  //   - Otherwise, check if the flow's OpenVPN counter is below a threshold and the operation code indicates a client reset.
  //     - If so, attempt to extract and store the session ID from the payload.
  //   - If the counter is within a range and the operation code indicates a server reset, verify the session ID matches.
  //     - If a match is found, identify the protocol as OpenVPN; otherwise, mark the attempt as failed.
  // Increment the flow's OpenVPN counter after processing.
  // If the detection attempt fails, exclude the protocol from the flow's possible protocols.

  if (packet->payload_packet_len >= 4) {
    operationcode = ovpn_payload[2];

    if (packet->udp != NULL) {
      // Check for specific OpenVPN UDP packet criteria
      if (packet->payload_packet_len == 20 && operationcode == 1) {
        NDPI_LOG_INFO(ndpi_struct, "Identified OpenVPN UDP packet\n");
        flow->detected_protocol = NDPI_PROTOCOL_OPENVPN;
        return;
      }
    } else if (packet->tcp != NULL) {
      // Check for specific OpenVPN TCP packet criteria
      if (packet->payload_packet_len >= 20 && operationcode == 1) {
        NDPI_LOG_INFO(ndpi_struct, "Identified OpenVPN TCP packet\n");
        flow->detected_protocol = NDPI_PROTOCOL_OPENVPN;
        return;
      }
    }

    if (flow->openvpn_counter < 10) {
      if (operationcode == 0x05) { // Client reset
        // Attempt to extract session ID
        if (packet->payload_packet_len >= 20) {
          session_remote = ovpn_payload + 12; // Assuming session ID is at offset 12
          // Store session ID (simplified example)
          // flow->session_id = extract_session_id(session_remote);
          NDPI_LOG_INFO(ndpi_struct, "Client reset detected, session ID extracted\n");
          flow->detected_protocol = NDPI_PROTOCOL_OPENVPN;
          return;
        }
      } else if (operationcode == 0x06) { // Server reset
        // Verify session ID
        if (packet->payload_packet_len >= 20) {
          session_remote = ovpn_payload + 12; // Assuming session ID is at offset 12
          // Verify session ID (simplified example)
          // if (verify_session_id(flow->session_id, session_remote)) {
          NDPI_LOG_INFO(ndpi_struct, "Server reset detected, session ID verified\n");
          flow->detected_protocol = NDPI_PROTOCOL_OPENVPN;
          return;
        }
      }
    }

    // Increment OpenVPN counter
    flow->openvpn_counter++;
  }

  // If detection attempt fails, exclude the protocol from the flow's possible protocols
  if (flow->detected_protocol != NDPI_PROTOCOL_OPENVPN) {
    flow->detected_protocol = NDPI_PROTOCOL_UNKNOWN;
  }