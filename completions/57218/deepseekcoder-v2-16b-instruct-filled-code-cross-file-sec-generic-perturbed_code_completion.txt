unsigned int boneIndex;
if (!ParseUnsignedInt(szCurrent, &szCurrent, boneIndex)) {
    LogErrorNoThrow("Failed to parse bone index");
    SMDI_PARSE_RETURN;
}

if (boneIndex >= bones.size()) {
    bones.resize(boneIndex + 1);
}

bone.mName = std::string(szCurrent, boneNameLength);
szCurrent += boneNameLength;

// Skip any spaces or line endings after the bone name
while (IsSpaceOrNewLine(*szCurrent)) {
    ++szCurrent;
}

int parentIndex;
if (!ParseSignedInt(szCurrent, &szCurrent, parentIndex)) {
    LogErrorNoThrow("Failed to parse bone parent index. Assuming -1");
    bone.iParent = -1;
} else {
    bone.iParent = parentIndex;
}

// Skip any remaining spaces or line endings
while (IsSpaceOrNewLine(*szCurrent)) {
    ++szCurrent;
}

if (*szCurrent != '\"') {
    LogWarning("Bone name is expected to be enclosed in double quotation marks.");
    bQuota = false;
} else {
    ++szCurrent;
}

const char* szEnd = szCurrent;
for (;;) {
    if (bQuota && *szEnd == '\"') {
        boneNameLength = (unsigned int)(szEnd - szCurrent);
        ++szEnd;
        break;
    } else if (!bQuota && IsSpaceOrNewLine(*szEnd)) {
        boneNameLength = (unsigned int)(szEnd - szCurrent);
        break;
    } else if (!(*szEnd)) {
        LogErrorNoThrow("Unexpected EOF/EOL while parsing bone name");
        SMDI_PARSE_RETURN;
    }
    ++szEnd;
}

bone.mName = std::string(szCurrent, boneNameLength);
szCurrent = szEnd;

if (!ParseSignedInt(szCurrent, &szCurrent, (int&)bone.iParent)) {
    LogErrorNoThrow("Unexpected EOF/EOL while parsing bone parent index. Assuming -1");
    SMDI_PARSE_RETURN;
}

// go to the beginning of the next line
SMDI_PARSE_RETURN;