if (dimensions == NULL || b == 0) {
    return 0;
}

cmsUInt32Number product = 1;
cmsUInt32Number maxAllowed = ((cmsUInt32Number) -1) / b; // Prevent overflow when multiplying by 'b'

for (cmsUInt32Number i = 0; i < b; ++i) {
    if (dimensions[i] > maxAllowed / product) {
        // Potential overflow detected
        return 0;
    }
    product *= dimensions[i];
}

product *= b;

if (product > maxAllowed) {
    return 0;
}

return product;