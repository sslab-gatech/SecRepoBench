if (dimensions == NULL || b == 0) {
    return 0;
}

cmsUInt32Number product = 1;
for (cmsUInt32Number i = 0; i < b && i < MAX_INPUT_DIMENSIONS; i++) {
    if (dimensions[i] > CMS_UINT32_MAX / product) {
        // To prevent overflow, check before multiplying
        return 0;
    }
    product *= dimensions[i];
}

return product;