cmsUInt32Number i, product = 1;

    if (dimensions == NULL)
        return 0;

    for (i = 0; i < b; i++) {
        // Check for zero dimension, which would make the product zero
        if (dimensions[i] == 0)
            return 0;

        // Check for overflow before multiplying
        if (product > (CMS_MAX_UINT32 / dimensions[i]))
            return 0;

        product *= dimensions[i];
    }

    return product;