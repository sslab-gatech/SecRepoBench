if (bitrateIdx == 0 || bitrateIdx == 15) {
		fprintf(stderr, "Error: invalid bitrate index %u in header 0x%08X\n", bitrateIdx, hdr);
		return 0;
	}

	if (version == 3) { /* MPEG-1 */
		if (layer == 3)       /* Layer I */
			lidx = 0;
		else if (layer == 2)  /* Layer II */
			lidx = 1;
		else if (layer == 1)  /* Layer III */
			lidx = 2;
		else {
			fprintf(stderr, "Error: invalid layer value %u in header 0x%08X\n", layer, hdr);
			return 0;
		}
		return mpeg1_bitrate_table[lidx][bitrateIdx];
	} else { /* MPEG-2 or MPEG-2.5 */
		if (layer == 3) { /* Layer I */
			lidx = 0;
		} else if (layer == 2 || layer == 1) { /* Layers II and III share the same table */
			lidx = 1;
		} else {
			fprintf(stderr, "Error: invalid layer value %u in header 0x%08X\n", layer, hdr);
			return 0;
		}
		return mpeg2_bitrate_table[lidx][bitrateIdx];
	}