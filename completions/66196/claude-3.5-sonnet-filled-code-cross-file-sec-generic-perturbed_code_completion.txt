u32 lidx;
if (version == 3) {
    lidx = 3 - layer;
} else {
    lidx = 3;
}

if (lidx > 3) {
    GF_LOG(GF_LOG_ERROR, GF_LOG_CODING, ("[MP3] Invalid layer index %d\n", lidx));
    return 0;
}

static const u16 bitrate_table[5][16] = {
    {0, 32, 64, 96, 128, 160, 192, 224, 256, 288, 320, 352, 384, 416, 448, 0},
    {0, 32, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, 384, 0},
    {0, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, 0},
    {0, 32, 48, 56, 64, 80, 96, 112, 128, 144, 160, 176, 192, 224, 256, 0},
    {0, 8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160, 0}
};

if (bitrateIdx > 15) {
    GF_LOG(GF_LOG_ERROR, GF_LOG_CODING, ("[MP3] Invalid bitrate index %d\n", bitrateIdx));
    return 0;
}

return bitrate_table[lidx][bitrateIdx];