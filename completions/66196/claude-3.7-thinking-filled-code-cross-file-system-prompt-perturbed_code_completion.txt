/*MPEG-1*/
// Calculate the layer index for different MPEG versions
u32 lidx;
if (version == 3) { // MPEG-1
    lidx = 3 - layer;
} else { // MPEG-2 or MPEG-2.5
    if (layer == 3) lidx = 3; // Layer I
    else lidx = 4; // Layer II or III
}

// Validate the calculated layer index
if (layer < 1 || layer > 3) {
    GF_LOG(GF_LOG_ERROR, GF_LOG_MEDIA, ("[MP3 Parsing] Invalid layer %d\n", layer));
    return 0;
}
if (bitrateIdx == 15) {
    GF_LOG(GF_LOG_ERROR, GF_LOG_MEDIA, ("[MP3 Parsing] Invalid bitrate index %d\n", bitrateIdx));
    return 0;
}

// Bitrate tables (kbps)
static const u32 mp3_bitrates[5][16] = {
    // MPEG-1, Layer I
    {0, 32, 64, 96, 128, 160, 192, 224, 256, 288, 320, 352, 384, 416, 448, 0},
    // MPEG-1, Layer II
    {0, 32, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, 384, 0},
    // MPEG-1, Layer III
    {0, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, 0},
    // MPEG-2/2.5, Layer I
    {0, 32, 48, 56, 64, 80, 96, 112, 128, 144, 160, 176, 192, 224, 256, 0},
    // MPEG-2/2.5, Layer II & III
    {0, 8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160, 0}
};

return mp3_bitrates[lidx][bitrateIdx] * 1000; // Convert to bits per second