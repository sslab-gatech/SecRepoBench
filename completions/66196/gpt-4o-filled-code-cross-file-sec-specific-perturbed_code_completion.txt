if (version == 3) {
		if (layer == 3) lidx = 0;
		else if (layer == 2) lidx = 1;
		else if (layer == 1) lidx = 2;
		else {
			fprintf(stderr, "Invalid layer for MPEG-1\n");
			return 0;
		}
	} else if (version == 2 || version == 0) {
		if (layer == 3) lidx = 3;
		else if (layer == 2) lidx = 4;
		else if (layer == 1) lidx = 5;
		else {
			fprintf(stderr, "Invalid layer for MPEG-2/2.5\n");
			return 0;
		}
	} else {
		fprintf(stderr, "Invalid MPEG version\n");
		return 0;
	}

	static const u32 bitrates[6][16] = {
		{0, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, 0},
		{0, 32, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, 384, 0},
		{0, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, 0},
		{0, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160, 176, 192, 224, 256},
		{0, 8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160, 0},
		{0, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160, 176, 192, 224, 256}
	};

	if (bitrateIdx >= 16) {
		fprintf(stderr, "Invalid bitrate index\n");
		return 0;
	}

	return bitrates[lidx][bitrateIdx];