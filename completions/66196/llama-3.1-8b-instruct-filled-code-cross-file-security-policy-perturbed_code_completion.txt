u32 gf_mp3_bit_rate(u32 hdr)
{
	u8 version = gf_mp3_version(hdr);
	u8 layer = gf_mp3_layer(hdr);
	u8 bitrateIdx = (hdr >> 12) & 0xF;
	u32 lidx;

	// Determine the appropriate layer index based on the MPEG version and layer information.
	if (version == 3) {
		if (layer == 3) lidx = 0;
		else if (layer == 2) lidx = 1;
		else if (layer == 1) lidx = 2;
		else lidx = 3;
	}
	else {
		if (layer == 3) lidx = 0;
		else if (layer == 2) lidx = 1;
		else lidx = 2;
	}

	// Validate the calculated layer index, logging an error and returning 0 if invalid.
	if (lidx >= 4) {
		gf_log_error("Invalid layer index: %d", lidx);
		return 0;
	}

	// Calculate the bitrate value from a pre-defined bitrate table using the layer and bitrate index.
	u32 bitrate = gf_mp3_bitrate_table[lidx][bitrateIdx];

	// Return the bitrate value.
	return bitrate;
}