{
	static const u32 mp3_mpeg1_bitrate_table[4][16] = {
		/* Layer I (layer=1 => index=0) */
		{ 0, 32, 64, 96, 128, 160, 192, 224, 256, 288, 320, 352, 384, 416, 448, 0 },
		/* Layer II (layer=2 => index=1) */
		{ 0, 32, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, 384, 0 },
		/* Layer III (layer=3 => index=2) */
		{ 0, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, 0 },
		/* padding */
		{ 0 }
	};

	static const u32 mp3_mpeg2_bitrate_table[4][16] = {
		/* Layer I (layer=1 => index=0) */
		{ 0, 32, 48, 56, 64, 80, 96, 112, 128, 144, 160, 176, 192, 224, 256, 0 },
		/* Layer II (layer=2 => index=1) */
		{ 0, 8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160, 0 },
		/* Layer III (layer=3 => index=2) */
		{ 0, 8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160, 0 },
		/* padding */
		{ 0 }
	};

	/* check bitrate index validity */
	if (bitrateIdx == 0 || bitrateIdx == 0xF) {
		GF_LOG(GF_LOG_ERROR, GF_LOG_CODING, ("Invalid MP3 bitrate index %d\n", bitrateIdx));
		return 0;
	}

	/* check layer validity */
	if (layer < 1 || layer > 3) {
		GF_LOG(GF_LOG_ERROR, GF_LOG_CODING, ("Invalid MP3 layer %d\n", layer));
		return 0;
	}

	/* check version validity */
	if (version != 3 && version != 2 && version != 0) {
		GF_LOG(GF_LOG_ERROR, GF_LOG_CODING, ("Invalid MP3 version %d\n", version));
		return 0;
	}

	/* map layer to table row index */
	lidx = layer - 1;

	/* return bitrate */
	if (version == 3) {
		return mp3_mpeg1_bitrate_table[lidx][bitrateIdx];
	} else {
		return mp3_mpeg2_bitrate_table[lidx][bitrateIdx];
	}
}