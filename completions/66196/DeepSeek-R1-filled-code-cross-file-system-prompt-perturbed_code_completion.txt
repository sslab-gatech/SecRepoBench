u32 lidx;
if (version == 3) {
    lidx = 3 - layer;
} else {
    lidx = 3 + (3 - layer);
}

if (lidx >= 6) {
    GF_LOG(GF_LOG_ERROR, GF_PARSER, ("Invalid layer index %u\n", lidx));
    return 0;
}

static const u32 bitrate_table[6][16] = {
    {0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,0},
    {0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,0},
    {0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,0},
    {0,32,48,56,64,80,96,112,128,144,160,176,192,224,256,0},
    {0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,0},
    {0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,0},
};

u32 bitrate = bitrate_table[lidx][bitrateIdx];
if (bitrate == 0) {
    GF_LOG(GF_LOG_ERROR, GF_PARSER, ("Invalid bitrate index %u\n", bitrateIdx));
    return 0;
}

return bitrate * 1000;