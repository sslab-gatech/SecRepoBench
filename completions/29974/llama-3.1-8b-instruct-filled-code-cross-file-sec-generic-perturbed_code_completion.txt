if (tcph!= NULL && (tcph->num_sack_ranges < MAX_TCP_SACK_RANGES)) {
    tcph->sack_left_edge[tcph->num_sack_ranges] = leftedge;
    tcph->sack_right_edge[tcph->num_sack_ranges] = rightedge;
    tcph->num_sack_ranges++;
    if (tcp_track_bytes_in_flight && tcpd->fwd->tcp_analyze_seq_info) {
        tcpd->fwd->tcp_analyze_seq_info->num_sack_ranges = tcph->num_sack_ranges;
        tcpd->fwd->tcp_analyze_seq_info->sack_left_edge[tcph->num_sack_ranges - 1] = leftedge;
        tcpd->fwd->tcp_analyze_seq_info->sack_right_edge[tcph->num_sack_ranges - 1] = rightedge;
    }
}