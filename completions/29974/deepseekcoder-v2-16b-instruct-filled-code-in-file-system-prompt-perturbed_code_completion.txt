guint8 *p = tlv_buffer;
    guint8 version = EXP_PDU_TCP_INFO_VERSION;
    guint8 magic_number = 0x12;
    guint8 data_len = EXP_PDU_TCP_INFO_DATA_LEN;
    guint8 *payload = (guint8 *)data;

    *p++ = version;
    *p++ = magic_number;
    *p++ = data_len;
    memcpy(p, payload, EXP_PDU_TCP_INFO_DATA_LEN);
    return EXP_PDU_TCP_INFO_DATA_LEN+4;
}

static int exp_pdu_tcp_dissector_data_populate_tlv(packet_info *pinfo _U_, void* data, guint8 *tlv_buffer, guint32 buffer_size _U_)
{
    guint8 *p = tlv_buffer;
    guint8 version = EXP_PDU_TCP_INFO_VERSION;
    guint8 magic_number = 0x12;
    guint8 data_len = EXP_PDU_TCP_INFO_DATA_LEN;
    guint8 *payload = (guint8 *)data;

    *p++ = version;
    *p++ = magic_number;
    *p++ = data_len;
    memcpy(p, payload, EXP_PDU_TCP_INFO_DATA_LEN);
    return EXP_PDU_TCP_INFO_DATA_LEN+4;
}

static int exp_pdu_tcp_dissector_data_dissect(packet_info *pinfo, proto_tree *tree, tvbuff_t *tvb, int offset, void* data _U_)
{
    proto_item *ti;
    ti = proto_tree_add_item(tree, proto_tcp, tvb, offset, -1, ENC_NA);
    dissect_tcp(pinfo, tree, tvb, offset, &ti);
    return offset + tvb_captured_length(tvb);
}

static const dissector_table_t exp_pdu_tcp_dissector_table = {
    "tcp.exp",
    exp_pdu_tcp_dissector_data_size,
    exp_pdu_tcp_dissector_data_populate_data,
    exp_pdu_tcp_dissector_data_populate_tlv,
    exp_pdu_tcp_dissector_data_dissect,
    NULL,
    NULL
};

static void
tcp_register_dissectors(void)
{
    dissector_add_uint("tcp.port", TCP_PORT_ANY, tcp_handle);
    dissector_add_uint("tcp.port", TCP_PORT_ANY, sport_handle);
    dissector_add_uint("tcp.port", TCP_PORT_ANY, data_handle);
    dissector_add_uint("tcp.port", TCP_PORT_ANY, tcp_opt_unknown_handle);
    dissector_add_uint("tcp.port", TCP_PORT_ANY, tcp_tap);
    dissector_add_uint("tcp.port", TCP_PORT_ANY, tcp_follow_tap);
    dissector_add_uint("tcp.port", TCP_PORT_ANY, mptcp_tap);
    dissector_add_uint("tcp.port", TCP_PORT_ANY, exported_pdu_tap);

    dissector_table_add_uint(&subdissector_table, proto_tcp, tcp_handle);
    dissector_table_add_uint(&tcp_option_table, proto_tcp, tcp_handle);
    heur_dissector_list_add(&heur_subdissector_list, tcp_handle, "tcp");

    register_dissector("tcp", tcp_handle, proto_tcp);
    register_heur_dissector("tcp", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.unknown", tcp_opt_unknown_handle, proto_tcp);
    register_heur_dissector("tcp.options.unknown", tcp_opt_unknown_handle, &heur_subdissector_list);

    register_dissector("tcp.options.timestamp", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.timestamp", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.mss", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.mss", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.window", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.window", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.sack_perm", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.sack_perm", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.sack", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.sack", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.echo", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.echo", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.echoreply", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.echoreply", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.cc", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.cc", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.ccnew", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.ccnew", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.ccecho", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.ccecho", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.md5", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.md5", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.scps", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.scps", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.snack", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.snack", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.recbound", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.recbound", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.correxp", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.correxp", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.qs", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.qs", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.user_to", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.user_to", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.ao", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.ao", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.mptcp", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.mptcp", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.tfo", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.tfo", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.rvbd_probe", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.rvbd_probe", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.rvbd_trpy", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.rvbd_trpy", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.exp", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.exp", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.unknown", tcp_opt_unknown_handle, proto_tcp);
    register_heur_dissector("tcp.options.unknown", tcp_opt_unknown_handle, &heur_subdissector_list);

    register_dissector("tcp.options.mptcp.mp_capable", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.mptcp.mp_capable", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.mptcp.mp_join", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.mptcp.mp_join", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.mptcp.dss", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.mptcp.dss", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.mptcp.add_addr", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.mptcp.add_addr", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.mptcp.remove_addr", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.mptcp.remove_addr", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.mptcp.mp_prio", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.mptcp.mp_prio", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.mptcp.mp_fail", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.mptcp.mp_fail", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.mptcp.mp_fastclose", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.mptcp.mp_fastclose", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.fast_open_cookie_request", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.fast_open_cookie_request", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.fast_open_cookie", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.fast_open_cookie", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.scps_vector", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.scps_vector", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.scps_binding", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.scps_binding", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.options.scps_binding_len", tcp_handle, proto_tcp);
    register_heur_dissector("tcp.options.scps_binding_len", tcp_handle, &heur_subdissector_list);

    register_dissector("tcp.