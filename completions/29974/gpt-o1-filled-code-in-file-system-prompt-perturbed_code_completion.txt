proto_tree_add_uint_format(field_tree, hf_tcp_option_sack_sre, tvb,
                           offset + 4, 4, rightedge,
                           "right edge = %u%s", rightedge,
                           (tcp_analyze_seq && tcp_relative_seq) ? " (relative)" : "");
proto_item_append_text(field_tree, " %u-%u", leftedge, rightedge);

/* Append the left edge and right edge values to the packet info for future analysis */
if (tcph != NULL && (tcph->num_sack_ranges < MAX_TCP_SACK_RANGES)) {
    tcph->sack_left_edge[tcph->num_sack_ranges] = leftedge;
    tcph->sack_right_edge[tcph->num_sack_ranges] = rightedge;
    tcph->num_sack_ranges++;
}

/* If TCP sequence analysis is enabled and the forward sequence info is available,
   store the left and right edges in that sequence info for bytes-in-flight analysis.
   Update the total number of SACK ranges in this segment. */
if (tcpd && tcpd->fwd->tcp_analyze_seq_info) {
    if (tcpd->fwd->tcp_analyze_seq_info->num_sack_ranges < MAX_TCP_SACK_RANGES) {
        tcpd->fwd->tcp_analyze_seq_info->sack_left_edge[tcpd->fwd->tcp_analyze_seq_info->num_sack_ranges] = leftedge;
        tcpd->fwd->tcp_analyze_seq_info->sack_right_edge[tcpd->fwd->tcp_analyze_seq_info->num_sack_ranges] = rightedge;
        tcpd->fwd->tcp_analyze_seq_info->num_sack_ranges++;
    }
}

offset += 8;