// Validate the offset to ensure it does not exceed the buffer length
        if (offset + 8 > tvb_reported_length(tvb)) {
            proto_tree_add_expert(field_tree, pinfo, &ei_tcp_suboption_malformed, tvb, offset, optlen);
            break;
        }

        // Add the right edge to the protocol tree
        proto_tree_add_uint_format(field_tree, hf_tcp_option_sack_sre, tvb,
                                   offset + 4, 4, rightedge,
                                   "right edge = %u%s", rightedge,
                                   (tcp_analyze_seq && tcp_relative_seq) ? " (relative)" : "");

        // Append the left and right edge values to the packet info for further analysis
        if (tcp_analyze_seq && tcp_track_bytes_in_flight && tcpd && tcpd->fwd->tcp_analyze_seq_info) {
            if (tcpd->fwd->tcp_analyze_seq_info->num_sack_ranges < MAX_TCP_SACK_RANGES) {
                tcpd->fwd->tcp_analyze_seq_info->sack_left_edge[tcpd->fwd->tcp_analyze_seq_info->num_sack_ranges] = leftedge;
                tcpd->fwd->tcp_analyze_seq_info->sack_right_edge[tcpd->fwd->tcp_analyze_seq_info->num_sack_ranges] = rightedge;
                tcpd->fwd->tcp_analyze_seq_info->num_sack_ranges++;
            }
        }

        // Increment the counter of SACK ranges
        sack_range_count++;