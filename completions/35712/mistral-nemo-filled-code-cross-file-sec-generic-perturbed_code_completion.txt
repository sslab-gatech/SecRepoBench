// correct instruction is executed next.
    CASE(OP_EXT1, B) {
      uint8_t op = pc[1];
      pc -= 2;
      switch (op) {
        // Define cases for extended opcodes within OP_EXT1.
        // Each case should handle the corresponding operation.
        // Example:
        // case OP_EXT1_OPCODE1:
        //   // Operation body for OP_EXT1_OPCODE1
        //   pc -= 2; // Adjust program counter for instruction read
        //   break;
        default:
          // Handle unsupported extended opcode within OP_EXT1.
          // Example:
          // mrb_value exc = mrb_exc_new(mrb, E_LOCALJUMP_ERROR, "Unsupported extended opcode");
          // mrb_exc_set(mrb, exc);
          // goto L_RAISE;
          break;
      }
      NEXT;
    }
    CASE(OP_EXT2, B) {
      uint8_t op = pc[1];
      pc -= 2;
      switch (op) {
        // Define cases for extended opcodes within OP_EXT2.
        // Each case should handle the corresponding operation.
        // Example:
        // case OP_EXT2_OPCODE1:
        //   // Operation body for OP_EXT2_OPCODE1
        //   pc -= 2; // Adjust program counter for instruction read
        //   break;
        default:
          // Handle unsupported extended opcode within OP_EXT2.
          // Example:
          // mrb_value exc = mrb_exc_new(mrb, E_LOCALJUMP_ERROR, "Unsupported extended opcode");
          // mrb_exc_set(mrb, exc);
          // goto L_RAISE;
          break;
      }
      NEXT;
    }
    CASE(OP_EXT3, B) {
      uint8_t op = pc[1];
      pc -= 2;
      switch (op) {
        // Define cases for extended opcodes within OP_EXT3.
        // Each case should handle the corresponding operation.
        // Example:
        // case OP_EXT3_OPCODE1:
        //   // Operation body for OP_EXT3_OPCODE1
        //   pc -= 2; // Adjust program counter for instruction read
        //   break;
        default:
          // Handle unsupported extended opcode within OP_EXT3.
          // Example:
          // mrb_value exc = mrb_exc_new(mrb, E_LOCALJUMP_ERROR, "Unsupported extended opcode");
          // mrb_exc_set(mrb, exc);
          // goto L_RAISE;
          break;
      }
      NEXT;
    }

    default:
      mrb_value exc = mrb_exc_new(mrb, E_LOCALJUMP_ERROR, "Unsupported opcode");
      mrb_exc_set(mrb, exc);
      goto L_RAISE;
  }
}

void mrb_vm_exec(mrb_state *mrb, const struct RProc *proc, const mrb_code *pc)
{
  /* mrb_assert(MRB_PROC_CFUNC_P(proc)) */
  const mrb_irep *irep = proc->body.irep;
  const mrb_pool_value *pool = irep->pool;
  const mrb_sym *syms = irep->syms;
  mrb_code instruction;
  int ai = mrb_gc_arena_save(mrb);
  struct mrb_jmpbuf *prev_jmp = mrb->jmp;
  struct mrb_jmpbuf c_jmp;
  uint32_t a;
  uint16_t b;
  uint16_t c;
  mrb_sym mid;
  const struct RProc *p = NULL;
  const struct RClass *target_class = NULL;
  mrb_callinfo *ci = mrb->c->ci;
  mrb_value exc;

  mrb->exc = NULL; /* clear break object */
  mrb->jmp = &c_jmp;
  mrb->c->vmexec = TRUE;
  mrb->c->status = MRB_FIBER_RUNNING;

  /* prepare call stack */
  mrb->c->ci->stack[0] = regs[0];
  mrb->c->ci->stack[1] = regs[1];
  mrb->c->ci->stack[2] = regs[2];
  mrb->c->ci->stack[3] = regs[3];
  mrb->c->ci->stack[4] = regs[4];
  mrb->c->ci->stack[5] = regs[5];
  mrb->c->ci->stack[6] = regs[6];
  mrb->c->ci->stack[7] = regs[7];
  mrb->c->ci->stack[8] = regs[8];
  mrb->c->ci->stack[9] = regs[9];
  mrb->c->ci->stack[10] = regs[10];
  mrb->c->ci->stack[11] = regs[11];
  mrb->c->ci->stack[12] = regs[12];
  mrb->c->ci->stack[13] = regs[13];
  mrb->c->ci->stack[14] = regs[14];
  mrb->c->ci->stack[15] = regs[15];
  mrb->c->ci->stack[16] = regs[16];
  mrb->c->ci->stack[17] = regs[17];
  mrb->c->ci->stack[18] = regs[18];
  mrb->c->ci->stack[19] = regs[19];
  mrb->c->ci->stack[20] = regs[20];
  mrb->c->ci->stack[21] = regs[21];
  mrb->c->ci->stack[22] = regs[22];
  mrb->c->ci->stack[23] = regs[23];
  mrb->c->ci->stack[24] = regs[24];
  mrb->c->ci->stack[25] = regs[25];
  mrb->c->ci->stack[26] = regs[26];
  mrb->c->ci->stack[27] = regs[27];
  mrb->c->ci->stack[28] = regs[28];
  mrb->c->ci->stack[29] = regs[29];
  mrb->c->ci->stack[30] = regs[30];
  mrb->c->ci->stack[31] = regs[31];
  mrb->c->ci->stack[32] = regs[32];
  mrb->c->ci->stack[33] = regs[33];
  mrb->c->ci->stack[34] = regs[34];
  mrb->c->ci->stack[35] = regs[35];
  mrb->c->ci->stack[36] = regs[36];
  mrb->c->ci->stack[37] = regs[37];
  mrb->c->ci->stack[38] = regs[38];
  mrb->c->ci->stack[39] = regs[39];
  mrb->c->ci->stack[40] = regs[40];
  mrb->c->ci->stack[41] = regs[41];
  mrb->c->ci->stack[42] = regs[42];
  mrb->c->ci->stack[43] = regs[43];
  mrb->c->ci->stack[44] = regs[44];
  mrb->c->ci->stack[45] = regs[45];
  mrb->c->ci->stack[46] = regs[46];
  mrb->c->ci->stack[47] = regs[47];
  mrb->c->ci->stack[48] = regs[48];
  mrb->c->ci->stack[49] = regs[49];
  mrb->c->ci->stack[50] = regs[50];
  mrb->c->ci->stack[51] = regs[51];
  mrb->c->ci->stack[52] = regs[52];
  mrb->c->ci->stack[53] = regs[53];
  mrb->c->ci->stack[54] = regs[54];
  mrb->c->ci->stack[55] = regs[55];
  mrb->c->ci->stack[56] = regs[56];
  mrb->c->ci->stack[57] = regs[57];
  mrb->c->ci->stack[58] = regs[58];
  mrb->c->ci->stack[59] = regs[59];
  mrb->c->ci->stack[60] = regs[60];
  mrb->c->ci->stack[61] = regs[61];
  mrb->c->ci->stack[62] = regs[62];
  mrb->c->ci->stack[63] = regs[63];
  mrb->c->ci->stack[64] = regs[64];
  mrb->c->ci->stack[65] = regs[65];
  mrb->c->ci->stack[66] = regs[66];
  mrb->c->ci->stack[67] = regs[67];
  mrb->c->ci->stack[68] = regs[68];
  mrb->c->ci->stack[69] = regs[69];
  mrb->c->ci->stack[70] = regs[70];
  mrb->c->ci->stack[71] = regs[71];
  mrb->c->ci->stack[72] = regs[72];
  mrb->c->ci->stack[73] = regs[73];
  mrb->c->ci->stack[74] = regs[74];
  mrb->c->ci->stack[75] = regs[75];
  mrb->c->ci->stack[76] = regs[76];
  mrb->c->ci->stack[77] = regs[77];
  mrb->c->ci->stack[78] = regs[78];
  mrb->c->ci->stack[79] = regs[79];
  mrb->c->ci->stack[80] = regs[80];
  mrb->c->ci->stack[81] = regs[81];
  mrb->c->ci->stack[82] = regs[82];
  mrb->c->ci->stack[83] = regs[83];
  mrb->c->ci->stack[84] = regs[84];
  mrb->c->ci->stack[85] = regs[85];
  mrb->c->ci->stack[86] = regs[86];
  mrb->c->ci->stack[87] = regs[87];
  mrb->c->ci->stack[88] = regs[88];
  mrb->c->ci->stack[89] = regs[89];
  mrb->c->ci->stack[90] = regs[90];
  mrb->c->ci->stack[91] = regs[91];
  mrb->c->ci->stack[92] = regs[92];
  mrb->c->ci->stack[93] = regs[93];
  mrb->c->ci->stack[94] = regs[94];
  mrb->c->ci->stack[95] = regs[95];
  mrb->c->ci->stack[96] = regs[96];
  mrb->c->ci->stack[97] = regs[97];
  mrb->c->ci->stack[98] = regs[98];
  mrb->c->ci->stack[99] = regs[99];
  mrb->c->ci->stack[100] = regs[100];
  mrb->c->ci->stack[101] = regs[101];
  mrb->c->ci->stack[102] = regs[102];
  mrb->c->ci->stack[103] = regs[103];
  mrb->c->ci->stack[104] = regs[104];
  mrb->c->ci->stack[105] = regs[105];
  mrb->c->ci->stack[106] = regs[106];
  mrb->c->ci->stack[107] = regs[107];
  mrb->c->ci->stack[108] = regs[108];
  mrb->c->ci->stack[109] = regs[109];