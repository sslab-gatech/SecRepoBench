CASE(OP_EXT1, Z) {
      FETCH_Z();
      instruction = *pc++;
      FETCH_B();
      switch (instruction) {
        CASE(OP_MOVE, BB);
        CASE(OP_LOADL, BB);
        CASE(OP_LOADI, BB);
        CASE(OP_LOADINEG, BB);
        CASE(OP_LOADSYM, BB);
        CASE(OP_LOADNIL, B);
        CASE(OP_LOADSELF, B);
        CASE(OP_LOADT, B);
        CASE(OP_LOADF, B);
        CASE(OP_GETGV, BB);
        CASE(OP_SETGV, BB);
        CASE(OP_GETSV, BB);
        CASE(OP_SETSV, BB);
        CASE(OP_GETIV, BB);
        CASE(OP_SETIV, BB);
        CASE(OP_GETCV, BB);
        CASE(OP_SETCV, BB);
        CASE(OP_GETCONST, BB);
        CASE(OP_SETCONST, BB);
        CASE(OP_GETMCNST, BB);
        CASE(OP_SETMCNST, BB);
        CASE(OP_GETUPVAR, BBB);
        CASE(OP_SETUPVAR, BBB);
        CASE(OP_JMP, S);
        CASE(OP_JMPIF, BS);
        CASE(OP_JMPNOT, BS);
        CASE(OP_JMPNIL, BS);
        CASE(OP_JMPUW, S);
        CASE(OP_EXCEPT, B);
        CASE(OP_RESCUE, BB);
        CASE(OP_RAISEIF, B);
        CASE(OP_SENDV, BB);
        CASE(OP_SENDVB, BB);
        CASE(OP_SEND, BBB);
        CASE(OP_SENDB, BBB);
        CASE(OP_CALL, Z);
        CASE(OP_SUPER, BB);
        CASE(OP_ARGARY, BS);
        CASE(OP_ENTER, W);
        CASE(OP_KARG, BB);
        CASE(OP_KEY_P, BB);
        CASE(OP_KEYEND, Z);
        CASE(OP_BREAK, B);
        CASE(OP_RETURN_BLK, B);
        CASE(OP_RETURN, B);
        CASE(OP_BLKPUSH, BS);
        CASE(OP_ADD, B);
        CASE(OP_SUB, B);
        CASE(OP_MUL, B);
        CASE(OP_DIV, B);
        CASE(OP_ADDI, BB);
        CASE(OP_SUBI, BB);
        CASE(OP_EQ, B);
        CASE(OP_LT, B);
        CASE(OP_LE, B);
        CASE(OP_GT, B);
        CASE(OP_GE, B);
        CASE(OP_ARRAY, BB);
        CASE(OP_ARRAY2, BBB);
        CASE(OP_ARYCAT, B);
        CASE(OP_ARYPUSH, B);
        CASE(OP_ARYDUP, B);
        CASE(OP_AREF, BBB);
        CASE(OP_ASET, BBB);
        CASE(OP_APOST, BBB);
        CASE(OP_INTERN, B);
        CASE(OP_STRING, BB);
        CASE(OP_STRCAT, B);
        CASE(OP_HASH, BB);
        CASE(OP_HASHADD, BB);
        CASE(OP_HASHCAT, B);
        CASE(OP_LAMBDA, BB);
        CASE(OP_BLOCK, BB);
        CASE(OP_METHOD, BB);
        CASE(OP_RANGE_INC, B);
        CASE(OP_RANGE_EXC, B);
        CASE(OP_OCLASS, B);
        CASE(OP_CLASS, BB);
        CASE(OP_MODULE, BB);
        CASE(OP_EXEC, BB);
        CASE(OP_DEF, BB);
        CASE(OP_SCLASS, B);
        CASE(OP_TCLASS, B);
        CASE(OP_ALIAS, BB);
        CASE(OP_UNDEF, B);
        CASE(OP_DEBUG, Z);
        CASE(OP_ERR, B);
        CASE(OP_SENDVK, BB);
        CASE(OP_STOP, Z);
      }
      pc--; /* Adjust pc after execution */
      NEXT;
    }

    CASE(OP_EXT2, Z) {
      FETCH_Z();
      instruction = *pc++;
      FETCH_BB();
      switch (instruction) {
        CASE(OP_MOVE, BB);
        CASE(OP_LOADL, BB);
        CASE(OP_LOADI, BB);
        CASE(OP_LOADINEG, BB);
        CASE(OP_LOADSYM, BB);
        CASE(OP_LOADNIL, B);
        CASE(OP_LOADSELF, B);
        CASE(OP_LOADT, B);
        CASE(OP_LOADF, B);
        CASE(OP_GETGV, BB);
        CASE(OP_SETGV, BB);
        CASE(OP_GETSV, BB);
        CASE(OP_SETSV, BB);
        CASE(OP_GETIV, BB);
        CASE(OP_SETIV, BB);
        CASE(OP_GETCV, BB);
        CASE(OP_SETCV, BB);
        CASE(OP_GETCONST, BB);
        CASE(OP_SETCONST, BB);
        CASE(OP_GETMCNST, BB);
        CASE(OP_SETMCNST, BB);
        CASE(OP_GETUPVAR, BBB);
        CASE(OP_SETUPVAR, BBB);
        CASE(OP_JMP, S);
        CASE(OP_JMPIF, BS);
        CASE(OP_JMPNOT, BS);
        CASE(OP_JMPNIL, BS);
        CASE(OP_JMPUW, S);
        CASE(OP_EXCEPT, B);
        CASE(OP_RESCUE, BB);
        CASE(OP_RAISEIF, B);
        CASE(OP_SENDV, BB);
        CASE(OP_SENDVB, BB);
        CASE(OP_SEND, BBB);
        CASE(OP_SENDB, BBB);
        CASE(OP_CALL, Z);
        CASE(OP_SUPER, BB);
        CASE(OP_ARGARY, BS);
        CASE(OP_ENTER, W);
        CASE(OP_KARG, BB);
        CASE(OP_KEY_P, BB);
        CASE(OP_KEYEND, Z);
        CASE(OP_BREAK, B);
        CASE(OP_RETURN_BLK, B);
        CASE(OP_RETURN, B);
        CASE(OP_BLKPUSH, BS);
        CASE(OP_ADD, B);
        CASE(OP_SUB, B);
        CASE(OP_MUL, B);
        CASE(OP_DIV, B);
        CASE(OP_ADDI, BB);
        CASE(OP_SUBI, BB);
        CASE(OP_EQ, B);
        CASE(OP_LT, B);
        CASE(OP_LE, B);
        CASE(OP_GT, B);
        CASE(OP_GE, B);
        CASE(OP_ARRAY, BB);
        CASE(OP_ARRAY2, BBB);
        CASE(OP_ARYCAT, B);
        CASE(OP_ARYPUSH, B);
        CASE(OP_ARYDUP, B);
        CASE(OP_AREF, BBB);
        CASE(OP_ASET, BBB);
        CASE(OP_APOST, BBB);
        CASE(OP_INTERN, B);
        CASE(OP_STRING, BB);
        CASE(OP_STRCAT, B);
        CASE(OP_HASH, BB);
        CASE(OP_HASHADD, BB);
        CASE(OP_HASHCAT, B);
        CASE(OP_LAMBDA, BB);
        CASE(OP_BLOCK, BB);
        CASE(OP_METHOD, BB);
        CASE(OP_RANGE_INC, B);
        CASE(OP_RANGE_EXC, B);
        CASE(OP_OCLASS, B);
        CASE(OP_CLASS, BB);
        CASE(OP_MODULE, BB);
        CASE(OP_EXEC, BB);
        CASE(OP_DEF, BB);
        CASE(OP_SCLASS, B);
        CASE(OP_TCLASS, B);
        CASE(OP_ALIAS, BB);
        CASE(OP_UNDEF, B);
        CASE(OP_DEBUG, Z);
        CASE(OP_ERR, B);
        CASE(OP_SENDVK, BB);
        CASE(OP_STOP, Z);
      }
      pc--; /* Adjust pc after execution */
      NEXT;
    }

    CASE(OP_EXT3, Z) {
      FETCH_Z();
      instruction = *pc++;
      FETCH_BBB();
      switch (instruction) {
        CASE(OP_MOVE, BB);
        CASE(OP_LOADL, BB);
        CASE(OP_LOADI, BB);
        CASE(OP_LOADINEG, BB);
        CASE(OP_LOADSYM, BB);
        CASE(OP_LOADNIL, B);
        CASE(OP_LOADSELF, B);
        CASE(OP_LOADT, B);
        CASE(OP_LOADF, B);
        CASE(OP_GETGV, BB);
        CASE(OP_SETGV, BB);
        CASE(OP_GETSV, BB);
        CASE(OP_SETSV, BB);
        CASE(OP_GETIV, BB);
        CASE(OP_SETIV, BB);
        CASE(OP_GETCV, BB);
        CASE(OP_SETCV, BB);
        CASE(OP_GETCONST, BB);
        CASE(OP_SETCONST, BB);
        CASE(OP_GETMCNST, BB);
        CASE(OP_SETMCNST, BB);
        CASE(OP_GETUPVAR, BBB);
        CASE(OP_SETUPVAR, BBB);
        CASE(OP_JMP, S);
        CASE(OP_JMPIF, BS);
        CASE(OP_JMPNOT, BS);
        CASE(OP_JMPNIL, BS);
        CASE(OP_JMPUW, S);
        CASE(OP_EXCEPT, B);
        CASE(OP_RESCUE, BB);
        CASE(OP_RAISEIF, B);
        CASE(OP_SENDV, BB);
        CASE(OP_SENDVB, BB);
        CASE(OP_SEND, BBB);
        CASE(OP_SENDB, BBB);
        CASE(OP_CALL, Z);
        CASE(OP_SUPER, BB);
        CASE(OP_ARGARY, BS);
        CASE(OP_ENTER, W);
        CASE(OP_KARG, BB);
        CASE(OP_KEY_P, BB);
        CASE(OP_KEYEND, Z);
        CASE(OP_BREAK, B);
        CASE(OP_RETURN_BLK, B);
        CASE(OP_RETURN, B);
        CASE(OP_BLKPUSH, BS);
        CASE(OP_ADD, B);
        CASE(OP_SUB, B);
        CASE(OP_MUL, B);
        CASE(OP_DIV, B);
        CASE(OP_ADDI, BB);
        CASE(OP_SUBI, BB);
        CASE(OP_EQ, B);
        CASE(OP_LT, B);
        CASE(OP_LE, B);
        CASE(OP_GT, B);
        CASE(OP_GE, B);
        CASE(OP_ARRAY, BB);
        CASE(OP_ARRAY2, BBB);
        CASE(OP_ARYCAT, B);
        CASE(OP_ARYPUSH, B);
        CASE(OP_ARYDUP, B);
        CASE(OP_AREF, BBB);
        CASE(OP_ASET, BBB);
        CASE(OP_APOST, BBB);
        CASE(OP_INTERN, B);
        CASE(OP_STRING, BB);
        CASE(OP_STRCAT, B);
        CASE(OP_HASH, BB);
        CASE(OP_HASHADD, BB);
        CASE(OP_HASHCAT, B);
        CASE(OP_LAMBDA, BB);
        CASE(OP_BLOCK, BB);
        CASE(OP_METHOD, BB);
        CASE(OP_RANGE_INC, B);
        CASE(OP_RANGE_EXC, B);
        CASE(OP_OCLASS, B);
        CASE(OP_CLASS, BB);
        CASE(OP_MODULE, BB);
        CASE(OP_EXEC, BB);
        CASE(OP_DEF, BB);
        CASE(OP_SCLASS, B);
        CASE(OP_TCLASS, B);
        CASE(OP_ALIAS, BB);
        CASE(OP_UNDEF, B);
        CASE(OP_DEBUG, Z);
        CASE(OP_ERR, B);
        CASE(OP_SENDVK, BB);
        CASE(OP_STOP, Z);
      }
      pc--; /* Adjust pc after execution */
      NEXT;
    }