CASE(OP_EXT1, Z) {
      uint8_t ext_opcode = *pc++;
      switch (ext_opcode) {
        case OP_MOVE: {
          FETCH_BB();
          regs[a] = regs[b];
          break;
        }
        case OP_LOADI: {
          FETCH_BB();
          SET_FIXNUM_VALUE(regs[a], b);
          break;
        }
        /* add further EXT1 opcode implementations as needed */
        default: {
          mrb_value exc = mrb_exc_new_lit(mrb, E_VMOP_ERROR, "unknown EXT1 opcode");
          mrb_exc_set(mrb, exc);
          goto L_RAISE;
        }
      }
      pc--; /* adjust for the extra byte read */
      NEXT;
    }
    CASE(OP_EXT2, Z) {
      uint8_t ext_opcode = *pc++;
      switch (ext_opcode) {
        case OP_LOADL: {
          FETCH_BB();
          /* Mimic behavior of OP_LOADL from main loop */
          switch (pool[b].tt) {
            case IREP_TT_INT32:
              regs[a] = mrb_int_value(mrb, (mrb_int)pool[b].u.i32);
              break;
            case IREP_TT_INT64:
  #if defined(MRB_INT64)
              regs[a] = mrb_int_value(mrb, (mrb_int)pool[b].u.i64);
              break;
  #else
              goto L_INT_OVERFLOW;
  #endif
            case IREP_TT_BIGINT:
              goto L_INT_OVERFLOW;
  #ifndef MRB_NO_FLOAT
            case IREP_TT_FLOAT:
              regs[a] = mrb_float_value(mrb, pool[b].u.f);
              break;
  #endif
            default:
              regs[a] = mrb_nil_value();
              break;
          }
          break;
        }
        /* add further EXT2 opcode implementations as needed */
        default: {
          mrb_value exc = mrb_exc_new_lit(mrb, E_VMOP_ERROR, "unknown EXT2 opcode");
          mrb_exc_set(mrb, exc);
          goto L_RAISE;
        }
      }
      pc--; /* adjust for the extra byte read */
      NEXT;
    }
    CASE(OP_EXT3, Z) {
      uint8_t ext_opcode = *pc++;
      switch (ext_opcode) {
        case OP_STRING: {
          FETCH_BB();
          size_t len = pool[b].tt >> 2;
          if (pool[b].tt & IREP_TT_SFLAG) {
            regs[a] = mrb_str_new_static(mrb, pool[b].u.str, len);
          }
          else {
            regs[a] = mrb_str_new(mrb, pool[b].u.str, len);
          }
          mrb_gc_arena_restore(mrb, ai);
          break;
        }
        /* add further EXT3 opcode implementations as needed */
        default: {
          mrb_value exc = mrb_exc_new_lit(mrb, E_VMOP_ERROR, "unknown EXT3 opcode");
          mrb_exc_set(mrb, exc);
          goto L_RAISE;
        }
      }
      pc--; /* adjust for the extra byte read */
      NEXT;
    }