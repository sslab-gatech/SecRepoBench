{
    // Clean up all loop variables and reset loop depth to zero.
    for (int i = 0; i < compiler->loop_depth; i++)
    {
      loop_vars_cleanup(i);
    }
    compiler->loop_depth = 0;

    // If we are inside a for-of loop, reset the for-of var index.
    compiler->loop_for_of_var_index = -1;

    // If we are in a loop context, initialize the frame for local variables.
    if (compiler->loop_depth < YR_MAX_LOOP_NESTING)
    {
      YR_LOOP_CONTEXT* loop_ctx = &compiler->loop[compiler->loop_depth];
      loop_ctx->vars_count = 0;
      loop_ctx->vars_internal_count = 0;
      loop_ctx->addr = NULL;
    }
}