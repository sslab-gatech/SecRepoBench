{
  /*
   * Clean up any existing loop variables from inner to outer loops
   * and reset the loop depth to zero. This ensures that if an error
   * occurs in a nested loop, all resources associated with those loops
   * are released. Also reset the special variable tracking for "for of"
   * loops.
   */
  while (compiler->loop_depth > 0)
  {
    loop_vars_cleanup(--compiler->loop_depth);
  }
  compiler->loop_for_of_var_index = -1;

  /*
   * Initialize (or re-initialize) the local variable frame if needed.
   * This helps ensure we don't leave stale loop-related variables around
   * after error recovery. Depending on the compiler's design, this might
   * mean clearing specific memory slots, resetting counters, etc.
   *
   * For example, you might clear memory used by loop counters:
   *
   * int var_frame = _yr_compiler_get_var_frame(compiler);
   * yr_parser_emit_with_arg(yyscanner, OP_CLEAR_M, var_frame + 0, NULL, NULL);
   * yr_parser_emit_with_arg(yyscanner, OP_CLEAR_M, var_frame + 1, NULL, NULL);
   * yr_parser_emit_with_arg(yyscanner, OP_CLEAR_M, var_frame + 2, NULL, NULL);
   *
   * Adjust or remove the above example if your compiler design is different.
   */
}