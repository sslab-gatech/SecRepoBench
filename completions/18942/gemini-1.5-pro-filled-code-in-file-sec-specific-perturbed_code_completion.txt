int parseresult = ERROR_SUCCESS;
        YR_LOOP_CONTEXT* loop_ctx = &compiler->loop[compiler->loop_depth];

        if (compiler->loop_depth == YR_MAX_LOOP_NESTING)
        {
          parseresult = ERROR_LOOP_NESTING_LIMIT_EXCEEDED;
        }
        else if (compiler->loop_for_of_var_index != -1)
        {
          parseresult = ERROR_NESTED_FOR_OF_LOOP;
        }

        fail_if_error(parseresult);

        compiler->loop[compiler->loop_depth].vars_internal_count = 0;
        compiler->loop[compiler->loop_depth].vars_count = 0;

        // Initialize the frame for local variables in the current loop context.
        _yr_compiler_push_frame(compiler);
      }