{
    // Clean up loop variables and reset loop depth
    for (int i = 0; i < compiler->loop_depth; i++)
    {
        for (int j = 0; j < compiler->loop[i].vars_count; j++)
        {
            yr_free(compiler->loop[i].vars[j].identifier);
            compiler->loop[i].vars[j].identifier = NULL;
        }
        compiler->loop[i].vars_count = 0;
    }
    compiler->loop_depth = 0;

    // Initialize the frame for local variables in the current loop context
    int var_frame = _yr_compiler_get_var_frame(compiler);

    // Ensure that loop nesting limits are respected
    if (compiler->loop_depth >= YR_MAX_LOOP_NESTING)
    {
        yr_compiler_set_error_extra_info(compiler, "loop nesting limit exceeded");
        fail_if_error(ERROR_LOOP_NESTING_LIMIT_EXCEEDED);
    }

    // Set up necessary variables for the loop
    compiler->loop[compiler->loop_depth].vars_internal_count = 3;
    compiler->loop[compiler->loop_depth].vars_count = 0;
    compiler->loop[compiler->loop_depth].addr = NULL;
}