yyscanner, OP_INT_GE, NULL);

        // If the number of expressions is greater or equal to
        // the loop quantifier, jump to the end of the loop.
        yr_parser_emit_with_arg_reloc(
            yyscanner,
            OP_JTRUE,
            compiler->loop[compiler->loop_depth].addr,
            NULL,
            NULL);

        // Pop the quantifier.
        yr_parser_emit(yyscanner, OP_POP, NULL);

        // If the quantifier was "all" we need to jump to the
        // end of the loop.
        yr_parser_emit_with_arg_reloc(
            yyscanner,
            OP_JUNDEF,
            compiler->loop[compiler->loop_depth].addr,
            NULL,
            NULL);

        // Pop the end-of-list marker.
        yr_parser_emit(yyscanner, OP_POP, NULL);
      }
#line 3111 "grammar.c" /* yacc.c:1663  */
    break;

  case 84:
#line 1518 "grammar.y" /* yacc.c:1663  */
    {
        int parseresult = ERROR_SUCCESS;
        int var_frame = _yr_compiler_get_var_frame(compiler);
        uint8_t* addr;

        if (compiler->loop_depth == YR_MAX_LOOP_NESTING)
          parseresult = ERROR_LOOP_NESTING_LIMIT_EXCEEDED;

        if (compiler->loop_for_of_var_index != -1)
          parseresult = ERROR_NESTED_FOR_OF_LOOP;

        fail_if_error(parseresult);

        yr_parser_emit_with_arg(
            yyscanner, OP_CLEAR_M, var_frame + 1, NULL, NULL);

        yr_parser_emit_with_arg(
            yyscanner, OP_CLEAR_M, var_frame + 2, NULL, NULL);

        // Pop the first string.
        yr_parser_emit_with_arg(
            yyscanner, OP_POP_M, var_frame, &addr, NULL);

        compiler->loop_for_of_var_index = var_frame;
        compiler->loop[compiler->loop_depth].vars_internal_count = 3;
        compiler->loop[compiler->loop_depth].vars_count = 0;
        compiler->loop[compiler->loop_depth].addr = addr;
        compiler->loop_depth++;
      }
#line 3154 "grammar.c" /* yacc.c:1663  */
    break;

  case 85:
#line 1548 "grammar.y" /* yacc.c:1663  */
    {
        int var_frame = 0;

        compiler->loop_depth--;
        compiler->loop_for_of_var_index = -1;

        loop_vars_cleanup(compiler->loop_depth);

        var_frame = _yr_compiler_get_var_frame(compiler);

        // Increment counter by the value returned by the
        // boolean expression (0 or 1). If the boolean expression
        // returned UNDEFINED the OP_ADD_M won't do anything.

        yr_parser_emit_with_arg(
            yyscanner, OP_ADD_M, var_frame + 1, NULL, NULL);

        // Increment iterations counter.
        yr_parser_emit_with_arg(
            yyscanner, OP_INCR_M, var_frame + 2, NULL, NULL);

        // If next string is not undefined, go back to the
        // beginning of the loop.
        yr_parser_emit_with_arg_reloc(
            yyscanner,
            OP_JNUNDEF,
            compiler->loop[compiler->loop_depth].addr,
            NULL,
            NULL);

        // Pop end-of-list marker.
        yr_parser_emit(yyscanner, OP_POP, NULL);

        // At this point the loop quantifier (any, all, 1, 2,..)
        // is at top of the stack. Check if the quantifier is
        // undefined (meaning "all") and replace it with the
        // iterations counter in that case.
        yr_parser_emit_with_arg(
            yyscanner, OP_SWAPUNDEF, var_frame + 2, NULL, NULL);

        // Compare the loop quantifier with the number of
        // expressions evaluating to true.
        yr_parser_emit_with_arg(
            yyscanner, OP_PUSH_M, var_frame + 1, NULL, NULL);

        yr_parser_emit(yyscanner, OP_INT_GE, NULL);

        // If the number of expressions is greater or equal to
        // the loop quantifier, jump to the end of the loop.
        yr_parser_emit_with_arg_reloc(
            yyscanner,
            OP_JTRUE,
            compiler->loop[compiler->loop_depth].addr,
            NULL,
            NULL);

        // Pop the quantifier.
        yr_parser_emit(yyscanner, OP_POP, NULL);

        // If the quantifier was "all" we need to jump to the
        // end of the loop.
        yr_parser_emit_with_arg_reloc(
            yyscanner,
            OP_JUNDEF,
            compiler->loop[compiler->loop_depth].addr,
            NULL,
            NULL);

        // Pop the end-of-list marker.
        yr_parser_emit(yyscanner, OP_POP, NULL);
      }
#line 3213 "grammar.c" /* yacc.c:1663  */
    break;

  case 86:
#line 1609 "grammar.y" /* yacc.c:1663  */
    {
        int parseresult = ERROR_SUCCESS;
        int var_frame = _yr_compiler_get_var_frame(compiler);
        uint8_t* addr;

        if (compiler->loop_depth == YR_MAX_LOOP_NESTING)
          parseresult = ERROR_LOOP_NESTING_LIMIT_EXCEEDED;

        if (compiler->loop_for_of_var_index != -1)
          parseresult = ERROR_NESTED_FOR_OF_LOOP;

        fail_if_error(parseresult);

        yr_parser_emit_with_arg(
            yyscanner, OP_CLEAR_M, var_frame + 1, NULL, NULL);

        yr_parser_emit_with_arg(
            yyscanner, OP_CLEAR_M, var_frame + 2, NULL, NULL);

        // Pop the first string.
        yr_parser_emit_with_arg(
            yyscanner, OP_POP_M, var_frame, &addr, NULL);

        compiler->loop_for_of_var_index = var_frame;
        compiler->loop[compiler->loop_depth].vars_internal_count = 3;
        compiler->loop[compiler->loop_depth].vars_count = 0;
        compiler->loop[compiler->loop_depth].addr = addr;
        compiler->loop_depth++;
      }
#line 3256 "grammar.c" /* yacc.c:1663  */
    break;

  case 87:
#line 1639 "grammar.y" /* yacc.c:1663  */
    {
        int var_frame = 0;

        compiler->loop_depth--;
        compiler->loop_for_of_var_index = -1;

        loop_vars_cleanup(compiler->loop_depth);

        var_frame = _yr_compiler_get_var_frame(compiler);

        // Increment counter by the value returned by the
        // boolean expression (0 or 1). If the boolean expression
        // returned UNDEFINED the OP_ADD_M won't do anything.

        yr_parser_emit_with_arg(
            yyscanner, OP_ADD_M, var_frame + 1, NULL, NULL);

        // Increment iterations counter.
        yr_parser_emit_with_arg(
            yyscanner, OP_INCR_M, var_frame + 2, NULL, NULL);

        // If next string is not undefined, go back to the
        // beginning of the loop.
        yr_parser_emit_with_arg_reloc(
            yyscanner,
            OP_JNUNDEF,
            compiler->loop[compiler->loop_depth].addr,
            NULL,
            NULL);

        // Pop end-of-list marker.
        yr_parser_emit(yyscanner, OP_POP, NULL);

        // At this point the loop quantifier (any, all, 1, 2,..)
        // is at top of the stack. Check if the quantifier is
        // undefined (meaning "all") and replace it with the
        // iterations counter in that case.
        yr_parser_emit_with_arg(
            yyscanner, OP_SWAPUNDEF, var_frame + 2, NULL, NULL);

        // Compare the loop quantifier with the number of
        // expressions evaluating to true.
        yr_parser_emit_with_arg(
            yyscanner, OP_PUSH_M, var_frame + 1, NULL, NULL);

        yr_parser_emit(yyscanner, OP_INT_GE, NULL);

        // If the number of expressions is greater or equal to
        // the loop quantifier, jump to the end of the loop.
        yr_parser_emit_with_arg_reloc(
            yyscanner,
            OP_JTRUE,
            compiler->loop[compiler->loop_depth].addr,
            NULL,
            NULL);

        // Pop the quantifier.
        yr_parser_emit(yyscanner, OP_POP, NULL);

        // If the quantifier was "all" we need to jump to the
        // end of the loop.
        yr_parser_emit_with_arg_reloc(
            yyscanner,
            OP_JUNDEF,
            compiler->loop[compiler->loop_depth].addr,
            NULL,
            NULL);

        // Pop the end-of-list marker.
        yr_parser_emit(yyscanner, OP_POP, NULL);
      }
#line 3315 "grammar.c" /* yacc.c:1663  */
    break;

  case 88:
#line 1698 "grammar.y" /* yacc.c:1663  */
    {
        int parseresult = ERROR_SUCCESS;
        int var_frame = _yr_compiler_get_var_frame(compiler);
        uint8_t* addr;

        if (compiler->loop_depth == YR_MAX_LOOP_NESTING)
          parseresult = ERROR_LOOP_NESTING_LIMIT_EXCEEDED;

        if (compiler->loop_for_of_var_index != -1)
          parseresult = ERROR_NESTED_FOR_OF_LOOP;

        fail_if_error(parseresult);

        yr_parser_emit_with_arg(
            yyscanner, OP_CLEAR_M, var_frame + 1, NULL, NULL);

        yr_parser_emit_with_arg(
            yyscanner, OP_CLEAR_M, var_frame + 2, NULL, NULL);

        // Pop the first string.
        yr_parser_emit_with_arg(
            yyscanner, OP_POP_M, var_frame, &addr, NULL);

        compiler->loop_for_of_var_index = var_frame;
        compiler->loop[compiler->loop_depth].vars_internal_count = 3;
        compiler->loop[compiler->loop_depth].vars_count = 0;
        compiler->loop[compiler->loop_depth].addr = addr;
        compiler->loop_depth++;
      }
#line 3358 "grammar.c" /* yacc.c:1663  */
    break;

  case 89:
#line 1728 "grammar.y" /* yacc.c:1663  */
    {
        int var_frame = 0;

        compiler->loop_depth--;
        compiler->loop_for_of_var_index = -1;

        loop_vars_cleanup(compiler->loop_depth);

        var_frame = _yr_compiler_get_var_frame(compiler);

        // Increment counter by the value returned by the
        // boolean expression (0 or 1). If the boolean expression
        // returned UNDEFINED the OP