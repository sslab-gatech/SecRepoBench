static void loop_vars_cleanup(int loop_depth, YR_COMPILER* compiler)
{
    /* Sanity check: ensure the loop depth is within valid bounds */
    if (loop_depth < 0 || loop_depth >= YR_MAX_LOOP_NESTING)
        return;

    YR_LOOP_CONTEXT* ctx = &compiler->loop[loop_depth];

    /* Free any dynamically allocated identifiers for loop variables */
    for (int i = 0; i < ctx->vars_count; i++)
    {
        if (ctx->vars[i].identifier != NULL)
        {
            yr_free(ctx->vars[i].identifier);
            ctx->vars[i].identifier = NULL;
        }
        /* If other resources are associated with the variable, clean them here */
    }

    /* Reset the count for variables in this loop context */
    ctx->vars_count = 0;
}