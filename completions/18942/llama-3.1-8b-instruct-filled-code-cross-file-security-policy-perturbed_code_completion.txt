// <MASK>
static void
loop_vars_cleanup(int loop_depth)
{
  YR_LOOP_CONTEXT* loop_ctx = &compiler->loop[loop_depth];

  for (int i = 0; i < loop_ctx->vars_count; i++)
  {
    YR_VAR* var = &loop_ctx->vars[i];

    if (var->type == EXPRESSION_TYPE_OBJECT)
    {
      yr_object_release(var->value.object);
    }
    else if (var->type == EXPRESSION_TYPE_STRING)
    {
      yr_free(var->value.sized_string);
    }
  }

  loop_ctx->vars_count = 0;
}
// </MASK>