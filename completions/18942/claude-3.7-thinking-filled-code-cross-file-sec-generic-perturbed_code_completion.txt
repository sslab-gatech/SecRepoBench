{
    // Handle error recovery for loops by cleaning up loop variables
    // and resetting the loop depth to zero. If an error occurs while
    // parsing an inner loop, the cleanup will propagate to the outer
    // loops. This ensures that all resources associated with loop
    // variables are properly released before handling the error.
    
    // Initialize the frame for local variables in the current loop context
    int var_frame = _yr_compiler_get_var_frame(compiler);
    
    // Ensure that loop nesting limits are respected
    if (compiler->loop_depth >= YR_MAX_LOOP_NESTING)
        fail_if_error(ERROR_LOOP_NESTING_LIMIT_EXCEEDED);
    
    // Check for nested for-of loops
    if (compiler->loop_for_of_var_index != -1)
        fail_if_error(ERROR_NESTED_FOR_OF_LOOP);
    
    // Setup necessary variables for the loop context
    YR_LOOP_CONTEXT* loop_ctx = &compiler->loop[compiler->loop_depth];
    loop_ctx->vars_internal_count = 3;
    loop_ctx->vars_count = 0;
}