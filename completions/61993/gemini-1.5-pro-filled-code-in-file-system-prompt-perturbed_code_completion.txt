if (csv_stream == NULL) {
	php_error_docref(NULL, E_WARNING, "Unterminated enclosure at end of line");
	bptr = limit + (bptr == limit ? 0 : 1); // unterminated enclosure is an error, ignore the terminating NULL byte if present.
	break;
}

size_t new_len;
char *new_buf = php_stream_get_line(csv_stream, NULL, 0, &new_len);
if (new_buf == NULL) {
	php_error_docref(NULL, E_WARNING, "Unterminated enclosure at end of file");
	break;
}