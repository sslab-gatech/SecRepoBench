char *new_buf;
				size_t new_len;
				if (php_stream_get_line(csv_stream, NULL, 0, &new_len) == NULL) {
					/* unterminated enclosure */
					if (hunk_begin != line_end) {
						memcpy(tptr, hunk_begin, bptr - hunk_begin);
						tptr += (bptr - hunk_begin);
						hunk_begin = bptr;
					}
					break;
				}
				new_buf = emalloc(new_len + 1);
				if (php_stream_get_line(csv_stream, new_buf, new_len + 1, &new_len) == NULL) {
					/* unterminated enclosure */
					if (hunk_begin != line_end) {
						memcpy(tptr, hunk_begin, bptr - hunk_begin);
						tptr += (bptr - hunk_begin);
						hunk_begin = bptr;
					}
					efree(new_buf);
					break;
				}