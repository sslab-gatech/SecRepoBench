if (!csv_stream) {
    /* Unterminated enclosure in str_getcsv() (no stream) */
    if (hunk_begin != line_end) {
        memcpy(tptr, hunk_begin, bptr - hunk_begin);
        tptr += (bptr - hunk_begin);
        hunk_begin = bptr;
    }
    goto quit_loop_2;
}
size_t new_len;
char *new_buf = php_stream_get_line(csv_stream, NULL, 0, &new_len);
if (!new_buf) {
    /* Unterminated enclosure at EOF */
    if (hunk_begin != line_end) {
        memcpy(tptr, hunk_begin, bptr - hunk_begin);
        tptr += (bptr - hunk_begin);
        hunk_begin = bptr;
    }
    goto quit_loop_2;
}