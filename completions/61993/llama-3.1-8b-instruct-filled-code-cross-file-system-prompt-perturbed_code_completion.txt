if (stream == NULL) {
    /* nothing can be fetched if stream is NULL (e.g. str_getcsv()) */
    /* Check if the stream is NULL. If so, handle the case of an unterminated enclosure,
     * potentially adjusting the position pointer to exclude the null character if needed,
     * and then exit the loop. Otherwise, read the next line from the stream.
     * If reading fails, handle the unterminated enclosure similarly and exit the loop.
     * If reading succeeds, update the buffer and related state variables for the new line. */
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bptr < limit && *bptr == '\0') {
        bptr++;
    }
    if (bpt