if (!csv_stream) {
    goto quit_loop_2;
}
size_t new_len;
char *new_buf = php_stream_get_line(csv_stream, NULL, 0, &new_len);
if (!new_buf) {
    goto quit_loop_2;
}
if (SIZE_MAX - temp_len < new_len) {
    php_error_docref(NULL, E_WARNING, "CSV field size is too large");
    efree(new_buf);
    goto quit_loop_2;
}