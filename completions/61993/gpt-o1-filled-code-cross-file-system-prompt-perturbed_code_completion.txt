if (!csv_stream) {
	/* Stream is NULL: no more lines to read, handle unterminated enclosure. */
	bptr--;
	break;
} else {
	size_t new_len;
	char *new_buf = php_stream_get_line(csv_stream, NULL, 0, &new_len);

	/* If reading fails, handle unterminated enclosure and exit the loop. */
	if (!new_buf) {
		bptr--;
		break;
	}

	/* If reading succeeds, update buffer and related state. */