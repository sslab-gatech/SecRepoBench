if (ISDIGIT(ch)) {
  mrb_int val = 0;
  while (tmpl->idx < tlen && ISDIGIT(tptr[tmpl->idx])) {
    val = val * 10 + (tptr[tmpl->idx++] - '0');
  }
  if (val > INT_MAX) {
    mrb_raisef(mrb, E_RUNTIME_ERROR, "template length is too large");
  }
  repeatcount = (int)val;
}