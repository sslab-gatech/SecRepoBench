mrb_int value;
mrb_bool overflow;

value = mrb_int_read(mrb, tptr + tmpl->idx, tlen - tmpl->idx, &overflow);
if (overflow) {
  mrb_raise(mrb, E_RUNTIME_ERROR, "template length too large");
}
tmpl->idx += mrb_int_strlen(value);
repeatcount = (int)value;