int ch, value = 0;
while (ISDIGIT(tptr[tmpl->idx])) {
  ch = tptr[tmpl->idx++];
  value = value * 10 + (ch - '0');
}
if (value > INT_MAX) {
  mrb_raisef(mrb, E_RUNTIME_ERROR, "template length %d is too large", value);
}
repeatcount = value;