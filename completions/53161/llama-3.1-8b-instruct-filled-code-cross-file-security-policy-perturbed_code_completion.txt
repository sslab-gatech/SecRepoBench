if (ISDIGIT(ch)) {
  // Check if the current character is a digit.
  // If so, read an integer value from the template string.
  // Update the template index to point after the read integer value.
  // If reading fails raise a runtime error indicating the template length is too large.
  if (tmpl->idx + 1 >= tlen) {
    mrb_raisef(mrb, E_RUNTIME_ERROR, "Template length is too large");
  }
  repeatcount = mrb_int_to_int(mrb, tptr + tmpl->idx, tlen - tmpl->idx);
  if (repeatcount < 0) {
    mrb_raisef(mrb, E_RUNTIME_ERROR, "Invalid repeat count");
  }
  tmpl->idx += mrb_sprintf(mrb, "%d", repeatcount).len;
}