int n = 0;
      for (;;) {
        int prev_n = n;
        n = n * 10 + (ch - '0');
        if (n < prev_n) {
          mrb_raise(mrb, E_RUNTIME_ERROR, "template length too big");
        }
        tmpl->idx++;
        if (tmpl->idx >= tlen) break;
        ch = tptr[tmpl->idx];
        if (!ISDIGIT(ch)) break;
      }
      repeatcount = n;