mrb_int num = 0;
while (ISDIGIT(ch)) {
  if (num > (INT_MAX - (ch - '0')) / 10) {
    mrb_raisef(mrb, E_RUNTIME_ERROR, "template length too large");
  }
  num = num * 10 + (ch - '0');
  tmpl->idx++;
  if (tmpl->idx >= tlen) break;
  ch = tptr[tmpl->idx];
}
repeatcount = num;