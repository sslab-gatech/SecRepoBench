if (ch == '0') {
  if (tmpl->idx + 1 >= tlen) {
    mrb_raisef(mrb, E_RUNTIME_ERROR, "template length too large");
  }
  tmpl->idx++; // Skip leading zero
  ch = tptr[tmpl->idx];
}
if (ISDIGIT(ch)) {
  int num = 0;
  while (tmpl->idx < tlen && ISDIGIT(tptr[tmpl->idx])) {
    num = num * 10 + (tptr[tmpl->idx] - '0');
    tmpl->idx++;
  }
  repeatcount = num;
}