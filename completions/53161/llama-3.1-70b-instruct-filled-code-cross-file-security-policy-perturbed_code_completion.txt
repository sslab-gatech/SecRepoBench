mrb_int n = 0;
while (tmpl->idx < tlen && ISDIGIT(tptr[tmpl->idx])) {
  n = n * 10 + (tptr[tmpl->idx++] - '0');
  if (n > INT_MAX / 10) {
    mrb_raisef(mrb, E_RUNTIME_ERROR, "template length is too large");
  }
}
if (n == 0) {
  n = 1;
}
repeatcount = n;