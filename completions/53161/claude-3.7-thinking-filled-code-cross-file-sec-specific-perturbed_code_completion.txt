repeatcount = ch - '0';
tmpl->idx++;
while (tmpl->idx < tlen && ISDIGIT(tptr[tmpl->idx])) {
  if (repeatcount > INT_MAX / 10 || (repeatcount == INT_MAX / 10 && tptr[tmpl->idx] - '0' > INT_MAX % 10)) {
    mrb_raise(mrb, E_RUNTIME_ERROR, "too big template length");
  }
  repeatcount = repeatcount * 10 + (tptr[tmpl->idx] - '0');
  tmpl->idx++;
}