if (ISDIGIT(ch)) {
  mrb_int n = 0;
  while (tmpl->idx < tlen && ISDIGIT(tptr[tmpl->idx])) {
    n = n * 10 + (mrb_int)(tptr[tmpl->idx++] - '0');
  }
  if (n > INT_MAX) {
    mrb_raisef(mrb, E_RUNTIME_ERROR, "template length is too large");
  }
  count = (int)n;
}