{
  mrb_int n = 0;
  while (tmpl->idx < tlen && ISDIGIT(tptr[tmpl->idx])) {
    int digit = tptr[tmpl->idx] - '0';
    if (n > (MRB_INT_MAX - digit) / 10) {
      mrb_raisef(mrb, E_RUNTIME_ERROR, "template length is too large: %S", tmpl->str);
    }
    n = n * 10 + digit;
    tmpl->idx++;
  }
  repeatcount = (int)n;
  continue;
}