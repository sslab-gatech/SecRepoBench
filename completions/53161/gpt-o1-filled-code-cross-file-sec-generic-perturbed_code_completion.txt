{
  mrb_int val = ch - '0';
  while ((tmpl->idx + 1) < tlen && ISDIGIT(tptr[tmpl->idx + 1])) {
    if (val > (INT_MAX - (tptr[tmpl->idx + 1] - '0')) / 10) {
      mrb_raise(mrb, E_RUNTIME_ERROR, "template length too large");
    }
    val = val * 10 + (tptr[tmpl->idx + 1] - '0');
    tmpl->idx++;
  }
  repeatcount = (int)val;
}