tmpl->idx++;
      if (tmpl->idx >= tlen || !ISDIGIT(tptr[tmpl->idx])) {
        mrb_raisef(mrb, E_ARGUMENT_ERROR, "invalid template length");
      }
      repeatcount = 0;
      while (tmpl->idx < tlen && ISDIGIT(tptr[tmpl->idx])) {
        repeatcount = repeatcount * 10 + (tptr[tmpl->idx] - '0');
        tmpl->idx++;
      }
      if (repeatcount <= 0) {
        mrb_raisef(mrb, E_ARGUMENT_ERROR, "invalid repeat count");
      }