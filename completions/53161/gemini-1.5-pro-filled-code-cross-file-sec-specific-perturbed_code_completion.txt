int i = 0;
      repeatcount = 0;
      for (;;) {
        if (tmpl->idx >= tlen) {
          mrb_raisef(mrb, E_RUNTIME_ERROR, "too large pack length %d", i);
        }
        ch = tptr[tmpl->idx++];
        if (!ISDIGIT(ch)) {
          tmpl->idx--;
          break;
        }
        repeatcount = repeatcount * 10 + (ch - '0');
        i++;
      }
      if (i == 0) {
        repeatcount = 1;
      }