else if (ISDIGIT(ch)) {
    // Check if the current character is a digit.
    // If so, read an integer value from the template string.
    // Update the template index to point after the read integer value.
    // If reading fails raise a runtime error indicating the template length is too large.
    if (tmpl->idx + 1 >= tlen) {
      mrb_raisef(mrb, E_RUNTIME_ERROR, "template length is too large");
    }
    size = 0;
    while (tmpl->idx < tlen && ISDIGIT(tptr[tmpl->idx])) {
      size = size * 10 + (tptr[tmpl->idx++] - '0');
    }
    if (tmpl->idx >= tlen) {
      mrb_raisef(mrb, E_RUNTIME_ERROR, "template length is too large");
    }
    if (size == 0) {
      mrb_raisef(mrb, E_RUNTIME_ERROR, "template length is too large");
    }
    if (size < 0) {
      mrb_raisef(mrb, E_RUNTIME_ERROR, "template length is too large");
    }
  }