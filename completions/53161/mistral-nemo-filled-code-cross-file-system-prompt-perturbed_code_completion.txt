if (ISDIGIT(ch)) {
    int value = 0;
    while (tmpl->idx < tlen && ISDIGIT(tptr[tmpl->idx])) {
      value = value * 10 + (tptr[tmpl->idx] - '0');
      tmpl->idx++;
    }
    if (value == 0) {
      mrb_raisef(mrb, E_RUNTIME_ERROR, "template length is too large");
    }
    if (value > tlen - tmpl->idx) {
      mrb_raisef(mrb, E_RUNTIME_ERROR, "template length is too large");
    }
    repeatcount = value;
  }