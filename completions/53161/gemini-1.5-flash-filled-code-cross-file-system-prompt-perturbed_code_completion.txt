long val;
      char *endp;
      val = strtol(tptr + tmpl->idx, &endp, 10);
      if (endp == tptr + tmpl->idx) {
        mrb_raise(mrb, E_RUNTIME_ERROR, "invalid template");
      }
      tmpl->idx = endp - tptr;
      if (tmpl->idx - (tptr - tptr) > tlen) {
        mrb_raise(mrb, E_RUNTIME_ERROR, "template length is too large");
      }
      if (type == PACK_TYPE_STRING) {
        repeatcount = val;
      } else {
        repeatcount = val;
      }