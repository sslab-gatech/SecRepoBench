mrb_int val = 0;
      while (tmpl->idx < tlen && ISDIGIT(tptr[tmpl->idx])) {
        int digit = tptr[tmpl->idx] - '0';
        if (val > (MRB_INT_MAX - digit) / 10) {
          mrb_raise(mrb, E_RUNTIME_ERROR, "template length too large");
        }
        val = val * 10 + digit;
        tmpl->idx++;
      }
      repeatcount = (int)val;