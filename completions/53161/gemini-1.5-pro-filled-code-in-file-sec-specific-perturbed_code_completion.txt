int i = tmpl->idx;
      long v = 0;
      for (; i < tlen; i++) {
        if (ISDIGIT(tptr[i])) {
          if (v > (LONG_MAX - (tptr[i] - '0')) / 10) {
            mrb_raise(mrb, E_RUNTIME_ERROR, "too big template length");
          }
          v = v * 10 + (tptr[i] - '0');
        }
        else {
          break;
        }
      }
      if (i > tmpl->idx) {
        tmpl->idx = i;
        repeatcount = (int)v;
      }