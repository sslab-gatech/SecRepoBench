int n = 0;
      while (tmpl->idx < tlen && ISDIGIT(ch)) {
        if (n > INT_MAX / 10) {
          mrb_raisef(mrb, E_RUNTIME_ERROR, "too big template length");
        }
        n = n * 10 + (ch - '0');
        ch = tptr[++tmpl->idx];
      }
      repeatcount = n;
      tmpl->idx--; // Rewind to the last digit