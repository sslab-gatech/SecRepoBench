{
    // Compare the first part of the compound word with the current segment.
    // If they match, it indicates a repeated pattern; mark the compound as invalid.
    std::string firstSegment = st.substr(0, i);
    std::string secondSegment = st.substr(i);
    if (firstSegment == secondSegment) {
        return NULL;
    }

    // Temporarily modify st[i] to check for repeated or forbidden patterns.
    char savedCh = st[i];
    st[i] = '\0';

    // Check repeated patterns if checkcompoundrep is set.
    if (checkcompoundrep && cpdrep_check(st.c_str(), i)) {
        st[i] = savedCh;
        return NULL;
    }

    // Check for forbidden words if forbiddenword is set.
    if (forbiddenword) {
        struct hentry* xrv = lookup(st.c_str(), i);
        while (xrv) {
            if (xrv->astr && TESTAFF(xrv->astr, forbiddenword, xrv->alen)) {
                st[i] = savedCh;
                return NULL;
            }
            xrv = xrv->next_homonym;
        }
    }

    // Restore the modified character before continuing.
    st[i] = savedCh;
}