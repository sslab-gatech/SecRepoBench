if ((i > 0) && (i <= st.size()) && (i <= compound_word.size()) &&
    (st.compare(0, i, compound_word, 0, i) == 0)) {
  // Temporarily modify the string to detect repeated or forbidden patterns
  char savedChar = st[i - 1];
  st[i - 1] = '-';

  // If a repeated pattern is found, return NULL to indicate an invalid compound
  if (checkcompoundrep && cpdrep_check(st.c_str(), st.size())) {
    st[i - 1] = savedChar;
    return NULL;
  }

  // Check for forbidden word or pattern
  struct hentry* tmp = lookup(st.c_str(), st.size());
  if (tmp && tmp->astr && TESTAFF(tmp->astr, forbiddenword, tmp->alen)) {
    st[i - 1] = savedChar;
    continue;
  }

  // Restore the modified character if no issues are detected
  st[i - 1] = savedChar;
}