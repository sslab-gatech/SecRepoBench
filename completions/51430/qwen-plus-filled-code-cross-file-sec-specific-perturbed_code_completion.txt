if (checkcompoundrep) {
    // Temporarily modify the string to check for repetitions
    char temp = st[i];
    st[i] = '\0';
    if (cpdrep_check(st.c_str(), len)) {
        st[i] = temp;  // Restore the modified character
        return NULL;   // Repetition found, invalid compound word
    }
    st[i] = temp;  // Restore the modified character regardless of the check result
}

if (forbiddenword) {
    // Check for forbidden word patterns in the current segment
    struct hentry* rv_forbidden = lookup(st.c_str() + i, st.size() - i);
    if (rv_forbidden && rv_forbidden->astr &&
        TESTAFF(rv_forbidden->astr, forbiddenword, rv_forbidden->alen)) {
        return NULL;  // Forbidden word pattern detected, invalid compound word
    }
}