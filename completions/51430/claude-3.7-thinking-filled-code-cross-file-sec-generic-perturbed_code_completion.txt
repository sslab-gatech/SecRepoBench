if (checkcompoundrep || forbiddenword) {
  // Store the original character
  char orig_char = st[i];
  
  // Temporarily modify the string
  st[i] = '\0';
  
  // Check for repetition patterns in the first part of the compound word
  if (checkcompoundrep && cpdrep_check(st.c_str(), i)) {
    st[i] = orig_char;  // Restore the original character
    return NULL;
  }
  
  // Check if the first part of the compound word is a forbidden word
  if (forbiddenword) {
    struct hentry* rv_forb = NULL;
    
    if ((rv_forb = lookup(st.c_str(), i)) && 
        rv_forb->astr && 
        TESTAFF(rv_forb->astr, forbiddenword, rv_forb->alen)) {
      st[i] = orig_char;  // Restore the original character
      return NULL;
    }
    
    // Check if the first part with prefix or suffix is a forbidden word
    if ((rv_forb = prefix_check(st, 0, i, FLAG_NULL, forbiddenword)) ||
        (rv_forb = suffix_check(st, 0, i, 0, NULL, FLAG_NULL, forbiddenword, FLAG_NULL))) {
      st[i] = orig_char;  // Restore the original character
      return NULL;
    }
  }
  
  // Restore the original character
  st[i] = orig_char;
}