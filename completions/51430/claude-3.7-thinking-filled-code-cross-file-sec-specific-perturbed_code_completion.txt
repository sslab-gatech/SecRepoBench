if (checkcompoundrep || forbiddenword) {
  // Make a C-style string copy of the compound word
  char* tempWord = new char[len + 1];
  if (tempWord) {
    strncpy(tempWord, compound_word.c_str(), len);
    tempWord[len] = '\0';  // Ensure null-termination
    
    // Temporarily modify the string at position i
    char savedChar = tempWord[i];
    tempWord[i] = '\0';
    
    // Check for repetitions or forbidden words
    if (checkcompoundrep && cpdrep_check(tempWord, i)) {
      tempWord[i] = savedChar;  // Restore the character
      delete[] tempWord;
      return NULL;
    }
    
    if (forbiddenword) {
      struct hentry* rv = lookup(tempWord, i);
      if (rv && rv->astr && TESTAFF(rv->astr, forbiddenword, rv->alen)) {
        tempWord[i] = savedChar;  // Restore the character
        delete[] tempWord;
        return NULL;
      }
    }
    
    // Restore the character and free memory
    tempWord[i] = savedChar;
    delete[] tempWord;
  }
}