if (checkcompoundrep && cpdrep_check(compound_word.c_str(), len))
    return NULL;

struct hentry* fwd = lookup(compound_word.c_str(), compound_word.size());
if (fwd && TESTAFF(fwd->astr, forbiddenword, fwd->alen))
    return NULL;

std::string first_part = compound_word.substr(0, i);
std::string second_part = compound_word.substr(i);
if (first_part == second_part) {
    return NULL;
}

st[i] = ch;