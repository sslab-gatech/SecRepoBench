if (checkcompoundrep) {
    // Check if the compound word has a repeated pattern (e.g. "foofoo")
    if (i > 0 && len == 2 * i && 
        compound_word.compare(0, i, compound_word, i, i) == 0) {
        return NULL;
    }
}

// Check if the entire compound is a forbidden word
struct hentry* fentry = lookup(compound_word.c_str(), len);
if (fentry && fentry->astr && TESTAFF(fentry->astr, forbiddenword, fentry->alen)) {
    return NULL;
}