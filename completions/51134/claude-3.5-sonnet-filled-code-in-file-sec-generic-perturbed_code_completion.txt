if (pos != std::string::npos) {
  if (*p == *st) {
    if (neg) {
      return 0;
    } else if (st == pos) {
      ingroup = true;
    }
  } else {
    if (!neg && st == pos) {
      return 0;
    }
  }
  p = nextchar(p);
} else {
  if (*p != *st) {
    return 0;
  }
  p = nextchar(p);
  --st;
  while ((opts & aeUTF8) && st >= beg && (*st & 0xc0) == 0x80) {
    --st;
  }
}