if (pos == std::string::npos) {
          if (st < str.size() && str[st] == *p) {
            ingroup = true;
            ++st;
            while ((opts & aeUTF8) && st < str.size() && (str[st] & 0xc0) == 0x80)
              ++st;
          } else if (p[1] != ']') {
            return 0;
          }
        } else {
          if (st < str.size() && str[st] == *p) {
            ingroup = true;
            ++st;
            while ((opts & aeUTF8) && st < str.size() && (str[st] & 0xc0) == 0x80)
              ++st;
          }
        }
        p = nextchar(p);
        break;
      }
    }