default: {
        if (ingroup) {
          if (*p == str[st]) {
            ingroup = true;
          } else {
            if (neg) {
              ingroup = true;
            } else {
              return 0;
            }
          }
        } else {
          if (*p == str[st]) {
            ++st;
            while ((opts & aeUTF8) && st < str.size() && (str[st] & 0xc0) == 0x80)
              ++st;
            if (st == str.size() && p)
              return 0;  // word <= condition
            p = nextchar(p);
          } else {
            if (neg) {
              p = nextchar(p);
            } else {
              return 0;
            }
          }
        }
        break;
      }