if (pos == std::string::npos) {
  if (str[st] == *p) {
    ++st;
    while ((opts & aeUTF8) && st < str.size() && (str[st] & 0xc0) == 0x80)
      ++st;
  } else {
    return 0;
  }
} else {
  if (str[st] == *p) {
    ingroup = true;
  }
  ++st;
  while ((opts & aeUTF8) && st < str.size() && (str[st] & 0xc0) == 0x80)
    ++st;
}
p = nextchar(p);