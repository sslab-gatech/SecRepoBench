// <MASK>
// Compare the current character in the input string with the current condition character.
// If they match, increment the position in the input string and advance to the next condition character.
// Handle multibyte UTF-8 characters if the option is set, ensuring the entire character sequence matches.
// If the input character matches within a group, mark that the character was found in the group.
// If the character does not match and is not within a group, return 0 to indicate the condition failed.
// Continue processing the condition string or group until the end of the string or group.
if (*p == *st) {
    ++st;
    if ((opts & aeUTF8) && (*st & 0x80)) {
        // Advance to the next UTF-8 character
        while ((st < str.size()) && (str[st] & 0xc0) == 0x80) {
            ++st;
        }
    }
    p = nextchar(p);
    if (pos != std::string::npos) {
        ingroup = true;
    } else {
        ++pos;
    }
} else if (pos != std::string::npos) {
    if (neg) {
        return 0;
    } else if (pos == st - word) {
        ingroup = true;
    } else {
        p = nextchar(p);
    }
} else {
    return 0;
}