char ctmp = *p;
        p = nextchar(p);
        char stmp = str[st];
        if ((opts & aeUTF8) && stmp & 0x80) {
          if (!utf8_seq_eq(str, st, p - 1)) {
            if (!ingroup)
              return 0;
          } else {
            ingroup = true;
            while ((opts & aeUTF8) && st < str.size() && (str[st] & 0xc0) == 0x80)
              ++st;
            break;
          }
        } else if (ctmp == stmp) {
          ingroup = true;
          ++st;
          break;
        } else if (!ingroup) {
          return 0;
        }