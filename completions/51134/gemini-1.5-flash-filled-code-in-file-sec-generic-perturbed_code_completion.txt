if (*st == *p) {
          if (pos)
            ingroup = true;
          p = nextchar(p);
          if ((opts & aeUTF8) && (*st & 0x80)) {
            st++;
            while (p && (st < str.size())) {
              if (*p != *st) {
                if (!pos)
                  return 0;
                break;
              }
              // first byte of the UTF-8 multibyte character
              if ((*p & 0xc0) != 0x80)
                break;
              p = nextchar(p);
              st++;
            }
          } else if (pos) {
            while (p && *p != ']' && ((p = nextchar(p)) != NULL)) {
            }
          }
          if (!pos)
            st++;
          if (st == str.size() && p)
            return 0;  // word <= condition
        } else if (pos) {
          p = nextchar(p);
        } else
          return 0;