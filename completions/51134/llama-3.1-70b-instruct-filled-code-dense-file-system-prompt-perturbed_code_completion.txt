if (*st == *p) {
  p = nextchar(p);
  if ((opts & aeUTF8) && (str[st] & 0x80)) {
    while ((opts & aeUTF8) && st < str.size() && (str[st] & 0xc0) == 0x80)
      ++st;
    if (pos) {
      if (neg)
        return 0;
      else if (i == numconds)
        return 1;
      ingroup = true;
      while (p && *p!= ']' && ((p = nextchar(p))!= NULL)) {
      }
      st--;
    }
  } else if (pos) {
    if (neg)
      return 0;
    else if (i == numconds)
      return 1;
    ingroup = true;
    while (p && *p!= ']' && ((p = nextchar(p))!= NULL)) {
    }
    st--;
  }
  ++st;
  if (!pos) {
    i++;
  }
  if (st == str.size() && p)
    return 0;  // word <= condition
} else if (pos) {  // group
  p = nextchar(p);
} else
  return 0;