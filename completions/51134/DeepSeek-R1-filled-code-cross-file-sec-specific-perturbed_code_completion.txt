if (pos == std::string::npos) {
    if (st >= str.size() || str[st] != *p)
        return 0;
    ++st;
    while ((opts & aeUTF8) && st < str.size() && (str[st] & 0xc0) == 0x80)
        ++st;
} else {
    if (pos < str.size() && str[pos] == *p)
        ingroup = true;
}
p = nextchar(p);