case '.':
        if (pos == std::string::npos) {  // dots are not metacharacters in groups: [.]
          p = nextchar(p);
          // skip the next character
          ++st;
          while ((opts & aeUTF8) && st < str.size() && (str[st] & 0xc0) == 0x80)
            ++st;
          if (st == str.size() && p)
            return 0;  // word <= condition
          break;
        }
      /* FALLTHROUGH */
      default: {
        // Compare the current character in the input string with the current condition character.
        // If they match, increment the position in the input string and advance to the next condition character.
        // Handle multibyte UTF-8 characters if the option is set, ensuring the entire character sequence matches.
        // If the input character matches within a group, mark that the character was found in the group.
        // If the character does not match and is not within a group, return 0 to indicate the condition failed.
        // Continue processing the condition string or group until the end of the string or group.
        if (st < str.size() && (str[st] == *p || (opts & aeUTF8) && (str[st] & 0xc0) == 0x80)) {
          ++st;
          while ((opts & aeUTF8) && st < str.size() && (str[st] & 0xc0) == 0x80)
            ++st;
          if (pos == std::string::npos) {
            ingroup = true;
          }
          p = nextchar(p);
          if (p == nullptr) {
            return 1;
          }
        } else {
          if (pos == std::string::npos) {
            return 0;
          }
          if (ingroup) {
            ingroup = false;
          } else {
            return 0;
          }
        }
      }
    }
    if (!p)
      return 1;
  }
}