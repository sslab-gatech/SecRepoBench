if (pos == std::string::npos) {
  if (st >= str.size())
    return 0;
  if (*p != str[st])
    return 0;
  p = nextchar(p);
  ++st;
  while ((opts & aeUTF8) && st < str.size() && (str[st] & 0xc0) == 0x80)
    ++st;
} else {
  if (st == str.size())
    return 0;
  if (*p == str[st])
    ingroup = true;
  p = nextchar(p);
  ++st;
  while ((opts & aeUTF8) && st < str.size() && (str[st] & 0xc0) == 0x80)
    ++st;
}