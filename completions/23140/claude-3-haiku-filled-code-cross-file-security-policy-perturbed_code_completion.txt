// Set the attribute name by either copying or duplicating the given name based on persistence.
if (persistent) {
    attr->lcname = zend_string_dup(attribute, 1);
} else {
    attr->lcname = zend_string_copy(attribute);
}
zend_str_tolower_copy(ZSTR_VAL(attr->lcname), ZSTR_VAL(attribute), ZSTR_LEN(attribute));

// Assign the offset and argument count to the attribute structure.
attr->offset = offset;
attr->argc = argc;

// Insert the new attribute into the attributes hash table and return a pointer to it.
zend_hash_add_ptr(*attributes, attr->lcname, attr);
return attr;