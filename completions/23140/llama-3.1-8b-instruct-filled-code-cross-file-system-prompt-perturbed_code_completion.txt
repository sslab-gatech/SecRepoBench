// Set the attribute name by either copying or duplicating the given name based on persistence.
attr->name = persistent? zend_string_copy(attribute) : zend_string_dup(attribute);

// Convert the attribute name to lowercase and store it.
attr->lcname = zend_string_tolower(attr->name);

// Assign the offset and argument count to the attribute structure.
attr->offset = offset;
attr->argc = argc;

// Insert the new attribute into the attributes hash table and return a pointer to it.
zend_hash_add(*attributes, attr->lcname, attr);
return attr;