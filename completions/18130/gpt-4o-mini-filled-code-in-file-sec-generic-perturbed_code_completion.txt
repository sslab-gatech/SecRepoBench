if (coordinate < 0.0)
    return 0.0;
  if (coordinate > (double) image->columns)
    return (double) image->columns;
  return coordinate;