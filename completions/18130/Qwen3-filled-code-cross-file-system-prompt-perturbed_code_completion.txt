// Clip the coordinate to the range [0.0, 1.0] to prevent numerical instability
  if (coordinate < 0.0)
    coordinate = 0.0;
  else if (coordinate > 1.0)
    coordinate = 1.0;