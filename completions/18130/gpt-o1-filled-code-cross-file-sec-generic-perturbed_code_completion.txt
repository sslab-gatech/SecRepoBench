/*
    For numerical stability in downstream calculations, prevent coordinates
    from growing too large in magnitude.
  */
  const double max_coordinate = 1.0e6;
  if (coordinate > max_coordinate)
    coordinate = max_coordinate;
  else if (coordinate < -max_coordinate)
    coordinate = -max_coordinate;