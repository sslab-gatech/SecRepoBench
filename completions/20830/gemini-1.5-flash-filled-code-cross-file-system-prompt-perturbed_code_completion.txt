char *login_command = (char *)malloc(flow_packet->payload_packet_len + 1);
  if (login_command == NULL) {
    return; // Handle memory allocation failure
  }
  memcpy(login_command, flow_packet->payload + command_start, flow_packet->payload_packet_len - command_start);
  login_command[flow_packet->payload_packet_len - command_start] = '\0';

  char *username_start = strchr(login_command, '"');
  if (username_start == NULL) {
    free(login_command);
    return; // Username not found
  }
  username_start++; // Skip the double quote

  char *username_end = strchr(username_start, '"');
  if (username_end == NULL) {
    free(login_command);
    return; // Username end not found
  }
  *username_end = '\0'; // Null-terminate the username

  char *password_start = strchr(username_end + 1, '"');
  if (password_start == NULL) {
    free(login_command);
    return; // Password start not found
  }
  password_start++; // Skip the double quote

  char *password_end = strchr(password_start, '"');
  if (password_end == NULL) {
    free(login_command);
    return; // Password end not found
  }
  *password_end = '\0'; // Null-terminate the password

  strncpy(flow->protos.ftp_imap_pop_smtp.username, username_start, sizeof(flow->protos.ftp_imap_pop_smtp.username) - 1);
  flow->protos.ftp_imap_pop_smtp.username[sizeof(flow->protos.ftp_imap_pop_smtp.username) - 1] = '\0';

  strncpy(flow->protos.ftp_imap_pop_smtp.password, password_start, sizeof(flow->protos.ftp_imap_pop_smtp.password) - 1);
  flow->protos.ftp_imap_pop_smtp.password[sizeof(flow->protos.ftp_imap_pop_smtp.password) - 1] = '\0';

  free(login_command);