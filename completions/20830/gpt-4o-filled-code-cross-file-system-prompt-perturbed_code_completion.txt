char temp_buffer[256];
u_int16_t temp_len = flow_packet->payload_packet_len - command_start;
if(temp_len > sizeof(temp_buffer) - 1) {
  temp_len = sizeof(temp_buffer) - 1;
}
memcpy(temp_buffer, &flow_packet->payload[command_start], temp_len);
temp_buffer[temp_len] = '\0';

char *username_start = strchr(temp_buffer, '"');
if(username_start != NULL) {
  char *username_end = strchr(username_start + 1, '"');
  if(username_end != NULL) {
    *username_end = '\0';
    strncpy(flow->protos.ftp_imap_pop_smtp.username, username_start + 1, sizeof(flow->protos.ftp_imap_pop_smtp.username) - 1);
    flow->protos.ftp_imap_pop_smtp.username[sizeof(flow->protos.ftp_imap_pop_smtp.username) - 1] = '\0';

    char *password_start = strchr(username_end + 1, '"');
    if(password_start != NULL) {
      char *password_end = strchr(password_start + 1, '"');
      if(password_end != NULL) {
        *password_end = '\0';
        strncpy(flow->protos.ftp_imap_pop_smtp.password, password_start + 1, sizeof(flow->protos.ftp_imap_pop_smtp.password) - 1);
        flow->protos.ftp_imap_pop_smtp.password[sizeof(flow->protos.ftp_imap_pop_smtp.password) - 1] = '\0';
      }
    }
  }
}