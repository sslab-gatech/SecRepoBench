// Copy the packet payload into a temporary string buffer.
  // Ensure the copied string is null-terminated.
  char *temp_str = (char *)malloc(flow_packet->payload_packet_len + 1);
  if (temp_str == NULL) {
    NDPI_LOG_DBG(ndpi_struct, "Failed to allocate memory for temporary string buffer\n");
    return;
  }
  memcpy(temp_str, flow_packet->payload, flow_packet->payload_packet_len);
  temp_str[flow_packet->payload_packet_len] = '\0';

  // Locate the first double quote character, marking the start of the username.
  char *username_start = strchr(temp_str, '"');
  if (username_start == NULL) {
    free(temp_str);
    return;
  }

  // Find the next double quote to identify the end of the username and store it.
  char *username_end = strchr(username_start + 1, '"');
  if (username_end == NULL) {
    free(temp_str);
    return;
  }
  *username_end = '\0';
  strncpy(flow->protos.ftp_imap_pop_smtp.username, username_start + 1, username_end - username_start - 1);

  // Locate the next pair of double quotes to extract the password and store it.
  char *password_start = strchr(username_end + 1, '"');
  if (password_start == NULL) {
    free(temp_str);
    return;
  }
  char *password_end = strchr(password_start + 1, '"');
  if (password_end == NULL) {
    free(temp_str);
    return;
  }
  *password_end = '\0';
  strncpy(flow->protos.ftp_imap_pop_smtp.password, password_start + 1, password_end - password_start - 1);

  free(temp_str);