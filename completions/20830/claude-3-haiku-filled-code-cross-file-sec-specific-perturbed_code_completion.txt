// Extract and store the "username" and "password" from the IMAP LOGIN command.
char temp_buffer[256];
strncpy(temp_buffer, (const char*)flow_packet->payload + command_start, sizeof(temp_buffer) - 1);
temp_buffer[sizeof(temp_buffer) - 1] = '\0'; // Ensure null termination

char *username_start = strchr(temp_buffer, '"');
if (username_start != NULL) {
    username_start++;
    char *username_end = strchr(username_start, '"');
    if (username_end != NULL) {
        *username_end = '\0';
        strncpy(flow->protos.ftp_imap_pop_smtp.username, username_start, sizeof(flow->protos.ftp_imap_pop_smtp.username) - 1);
        flow->protos.ftp_imap_pop_smtp.username[sizeof(flow->protos.ftp_imap_pop_smtp.username) - 1] = '\0';

        char *password_start = strchr(username_end + 1, '"');
        if (password_start != NULL) {
            password_start++;
            char *password_end = strchr(password_start, '"');
            if (password_end != NULL) {
                *password_end = '\0';
                strncpy(flow->protos.ftp_imap_pop_smtp.password, password_start, sizeof(flow->protos.ftp_imap_pop_smtp.password) - 1);
                flow->protos.ftp_imap_pop_smtp.password[sizeof(flow->protos.ftp_imap_pop_smtp.password) - 1] = '\0';
            }
        }
    }
}