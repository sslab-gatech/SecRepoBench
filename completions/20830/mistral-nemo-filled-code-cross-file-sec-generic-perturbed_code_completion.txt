// Extract the username and password from the IMAP LOGIN command
char *username = strndup(&flow_packet->payload[command_start + 4], &flow_packet->payload[command_start + 4] - strchr(&flow_packet->payload[command_start + 4], '"'));
char *password = strndup(strchr(&flow_packet->payload[command_start + 4], '"') + 1, strchr(strchr(&flow_packet->payload[command_start + 4], '"') + 1, '"') - strchr(&flow_packet->payload[command_start + 4], '"') - 1);

// Store the extracted username and password within the flow structure
strncpy(flow->protos.ftp_imap_pop_smtp.username, username, sizeof(flow->protos.ftp_imap_pop_smtp.username));
strncpy(flow->protos.ftp_imap_pop_smtp.password, password, sizeof(flow->protos.ftp_imap_pop_smtp.password));

// Free the allocated memory for the username and password strings
free(username);
free(password);