if((flow_packet->payload[command_start] == 'L' || flow_packet->payload[command_start] == 'l')
    && (flow_packet->payload[command_start + 1] == 'O' || flow_packet->payload[command_start + 1] == 'o')
    && (flow_packet->payload[command_start + 2] == 'G' || flow_packet->payload[command_start + 2] == 'g')
    && (flow_packet->payload[command_start + 3] == 'I' || flow_packet->payload[command_start + 3] == 'i')
    && (flow_packet->payload[command_start + 4] == 'N' || flow_packet->payload[command_start + 4] == 'n')) {
  // Extract and store the "username" and "password" from the IMAP LOGIN command.
  // Copy the packet payload into a temporary string buffer.
  // Ensure the copied string is null-terminated.
  // Locate the first double quote character, marking the start of the username.
  // Find the next double quote to identify the end of the username and store it.
  // Locate the next pair of double quotes to extract the password and store it.
  // The extracted username and password are stored within the flow structure.
  char *username = NULL;
  char *password = NULL;
  char temp_buffer[flow_packet->payload_packet_len + 1];
  memcpy(temp_buffer, flow_packet->payload, flow_packet->payload_packet_len);
  temp_buffer[flow_packet->payload_packet_len] = '\0';
  char *start_quote = strstr(temp_buffer, "\"");
  if (start_quote!= NULL) {
    char *end_quote = strstr(start_quote + 1, "\"");
    if (end_quote!= NULL) {
      username = malloc(end_quote - start_quote + 1);
      memcpy(username, start_quote + 1, end_quote - start_quote);
      username[end_quote - start_quote] = '\0';
      password = malloc(flow_packet->payload_packet_len - (end_quote - start_quote + 1) - strlen(username) - 2);
      memcpy(password, end_quote + 1, flow_packet->payload_packet_len - (end_quote - start_quote + 1) - strlen(username) - 2);
      password[flow_packet->payload_packet_len - (end_quote - start_quote + 1) - strlen(username) - 2] = '\0';
    }
  }
  if (username!= NULL && password!= NULL) {
    flow->l4.tcp.mail_imap_username = malloc(strlen(username) + 1);
    strcpy(flow->l4.tcp.mail_imap_username, username);
    flow->l4.tcp.mail_imap_password = malloc(strlen(password) + 1);
    strcpy(flow->l4.tcp.mail_imap_password, password);
  }
  free(username);
  free(password);
  flow->l4.tcp.mail_imap_stage += 1;
  saw_command = 1;
}