char temp_buffer[256];
size_t payload_len = flow_packet->payload_packet_len;
size_t copy_len = payload_len < sizeof(temp_buffer) - 1 ? payload_len : sizeof(temp_buffer) - 1;

memcpy(temp_buffer, flow_packet->payload, copy_len);
temp_buffer[copy_len] = '\0';

char *username_start = strchr(temp_buffer, '"');
if (username_start) {
  username_start++;
  char *username_end = strchr(username_start, '"');
  if (username_end) {
    size_t username_len = username_end - username_start;
    if (username_len < sizeof(flow->protos.ftp_imap_pop_smtp.username)) {
      memcpy(flow->protos.ftp_imap_pop_smtp.username, username_start, username_len);
      flow->protos.ftp_imap_pop_smtp.username[username_len] = '\0';

      char *password_start = strchr(username_end + 1, '"');
      if (password_start) {
        password_start++;
        char *password_end = strchr(password_start, '"');
        if (password_end) {
          size_t password_len = password_end - password_start;
          if (password_len < sizeof(flow->protos.ftp_imap_pop_smtp.password)) {
            memcpy(flow->protos.ftp_imap_pop_smtp.password, password_start, password_len);
            flow->protos.ftp_imap_pop_smtp.password[password_len] = '\0';
          }
        }
      }
    }
  }
}