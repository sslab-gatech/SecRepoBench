size_t payload_len = flow_packet->payload_packet_len;
  char *temp_buffer = (char *)malloc(payload_len + 1);
  if (temp_buffer == NULL) {
    return;
  }
  memcpy(temp_buffer, flow_packet->payload, payload_len);
  temp_buffer[payload_len] = '\0';

  char *username_start = strchr(temp_buffer, '"');
  if (username_start != NULL) {
    char *username_end = strchr(username_start + 1, '"');
    if (username_end != NULL) {
      size_t username_len = username_end - username_start - 1;
      strncpy(flow->protos.ftp_imap_pop_smtp.username, username_start + 1, username_len);
      flow->protos.ftp_imap_pop_smtp.username[username_len] = '\0';

      char *password_start = strchr(username_end + 1, '"');
      if (password_start != NULL) {
        char *password_end = strchr(password_start + 1, '"');
        if (password_end != NULL) {
          size_t password_len = password_end - password_start - 1;
          strncpy(flow->protos.ftp_imap_pop_smtp.password, password_start + 1, password_len);
          flow->protos.ftp_imap_pop_smtp.password[password_len] = '\0';
        }
      }
    }
  }
  free(temp_buffer);