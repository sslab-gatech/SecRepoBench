char tmp_payload[NDPI_PAYLOAD_MAX_LEN];
	  u_int16_t username_start = 0, username_end = 0, password_start = 0, password_end = 0;
	  size_t payload_len = flow_packet->payload_packet_len;

	  if (payload_len >= NDPI_PAYLOAD_MAX_LEN)
	    payload_len = NDPI_PAYLOAD_MAX_LEN - 1;

	  memcpy(tmp_payload, flow_packet->payload, payload_len);
	  tmp_payload[payload_len] = '\0';

	  // Find the first double quote (start of username)
	  char *username_start_ptr = strchr(tmp_payload, '"');
	  if (username_start_ptr != NULL) {
	    username_start = username_start_ptr - tmp_payload + 1;

	    // Find the second double quote (end of username)
	    char *username_end_ptr = strchr(username_start_ptr + 1, '"');
	    if (username_end_ptr != NULL) {
	      username_end = username_end_ptr - tmp_payload;

	      // Find the third double quote (start of password)
	      char *password_start_ptr = strchr(username_end_ptr + 1, '"');
	      if (password_start_ptr != NULL) {
		password_start = password_start_ptr - tmp_payload + 1;

		// Find the fourth double quote (end of password)
		char *password_end_ptr = strchr(password_start_ptr + 1, '"');
		if (password_end_ptr != NULL) {
		  password_end = password_end_ptr - tmp_payload;

		  // Extract username
		  size_t username_len = username_end - username_start;
		  if (username_len < sizeof(flow->protos.ftp_imap_pop_smtp.username)) {
		    strncpy(flow->protos.ftp_imap_pop_smtp.username, tmp_payload + username_start, username_len);
		    flow->protos.ftp_imap_pop_smtp.username[username_len] = '\0';
		  }

		  // Extract password
		  size_t password_len = password_end - password_start;
		  if (password_len < sizeof(flow->protos.ftp_imap_pop_smtp.password)) {
		    strncpy(flow->protos.ftp_imap_pop_smtp.password, tmp_payload + password_start, password_len);
		    flow->protos.ftp_imap_pop_smtp.password[password_len] = '\0';
		  }
		}
	      }
	    }
	  }