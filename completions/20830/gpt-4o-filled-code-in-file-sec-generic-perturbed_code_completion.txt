// Extract and store the "username" and "password" from the IMAP LOGIN command.
          char temp_buffer[256];
          size_t payload_len = flow_packet->payload_packet_len;

          // Ensure the payload length is within bounds to prevent buffer overflow
          if (payload_len >= sizeof(temp_buffer)) {
            goto imap_excluded;
          }

          // Copy the packet payload into a temporary string buffer.
          memcpy(temp_buffer, flow_packet->payload, payload_len);
          // Ensure the copied string is null-terminated.
          temp_buffer[payload_len] = '\0';

          // Locate the first double quote character, marking the start of the username.
          char *username_start = strchr(temp_buffer + command_start, '"');
          if (username_start == NULL) {
            goto imap_excluded;
          }

          // Find the next double quote to identify the end of the username and store it.
          char *username_end = strchr(username_start + 1, '"');
          if (username_end == NULL || username_end - username_start - 1 >= sizeof(flow->protos.ftp_imap_pop_smtp.username)) {
            goto imap_excluded;
          }

          // Copy the username into the flow structure.
          strncpy(flow->protos.ftp_imap_pop_smtp.username, username_start + 1, username_end - username_start - 1);
          flow->protos.ftp_imap_pop_smtp.username[username_end - username_start - 1] = '\0';

          // Locate the next pair of double quotes to extract the password and store it.
          char *password_start = strchr(username_end + 1, '"');
          if (password_start == NULL) {
            goto imap_excluded;
          }

          char *password_end = strchr(password_start + 1, '"');
          if (password_end == NULL || password_end - password_start - 1 >= sizeof(flow->protos.ftp_imap_pop_smtp.password)) {
            goto imap_excluded;
          }

          // Copy the password into the flow structure.
          strncpy(flow->protos.ftp_imap_pop_smtp.password, password_start + 1, password_end - password_start - 1);
          flow->protos.ftp_imap_pop_smtp.password[password_end - password_start - 1] = '\0';