{
  char *tmp = (char *)malloc(flow_packet->payload_packet_len + 1);
  if(tmp != NULL) {
    memcpy(tmp, flow_packet->payload, flow_packet->payload_packet_len);
    tmp[flow_packet->payload_packet_len] = '\0';

    /* Locate the first pair of double quotes for the username */
    char *start_username = strchr(tmp, '\"');
    if(start_username != NULL) {
      char *end_username = strchr(start_username + 1, '\"');
      if(end_username != NULL) {
        size_t username_len = end_username - start_username - 1;
        if(username_len >= sizeof(flow->protos.ftp_imap_pop_smtp.username))
          username_len = sizeof(flow->protos.ftp_imap_pop_smtp.username) - 1;
        memcpy(flow->protos.ftp_imap_pop_smtp.username, start_username + 1, username_len);
        flow->protos.ftp_imap_pop_smtp.username[username_len] = '\0';

        /* Locate the next pair of double quotes for the password */
        char *start_password = strchr(end_username + 1, '\"');
        if(start_password != NULL) {
          char *end_password = strchr(start_password + 1, '\"');
          if(end_password != NULL) {
            size_t password_len = end_password - start_password - 1;
            if(password_len >= sizeof(flow->protos.ftp_imap_pop_smtp.password))
              password_len = sizeof(flow->protos.ftp_imap_pop_smtp.password) - 1;
            memcpy(flow->protos.ftp_imap_pop_smtp.password, start_password + 1, password_len);
            flow->protos.ftp_imap_pop_smtp.password[password_len] = '\0';
          }
        }
      }
    }
    free(tmp);
  }
}