const u_int8_t *username_start = NULL;
      const u_int8_t *username_end = NULL;
      const u_int8_t *password_start = NULL;
      const u_int8_t *password_end = NULL;
      u_int16_t len = flow_packet->payload_packet_len;

      // Locate the first double quote for the username
      for (i = command_start; i < len; i++) {
          if (flow_packet->payload[i] == '"') {
              username_start = &flow_packet->payload[i + 1];
              break;
          }
      }

      // Locate the second double quote for the username
      for (; i < len; i++) {
          if (flow_packet->payload[i] == '"') {
              username_end = &flow_packet->payload[i];
              break;
          }
      }

      // Locate the first double quote for the password
      for (i = (username_end - flow_packet->payload) + 1; i < len; i++) {
          if (flow_packet->payload[i] == '"') {
              password_start = &flow_packet->payload[i + 1];
              break;
          }
      }

      // Locate the second double quote for the password
      for (; i < len; i++) {
          if (flow_packet->payload[i] == '"') {
              password_end = &flow_packet->payload[i];
              break;
          }
      }

      // Ensure we have valid pointers before copying
      if (username_start && username_end && password_start && password_end) {
          // Null-terminate the username and password
          flow->protos.ftp_imap_pop_smtp.username[username_end - username_start] = '\0';
          flow->protos.ftp_imap_pop_smtp.password[password_end - password_start] = '\0';

          // Copy the username and password
          strncpy((char *)flow->protos.ftp_imap_pop_smtp.username, (const char *)username_start, username_end - username_start);
          strncpy((char *)flow->protos.ftp_imap_pop_smtp.password, (const char *)password_start, password_end - password_start);
      }