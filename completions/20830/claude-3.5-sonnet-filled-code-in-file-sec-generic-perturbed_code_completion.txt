char temp_buffer[256];
size_t payload_len = flow_packet->payload_packet_len;
if (payload_len >= sizeof(temp_buffer)) {
  payload_len = sizeof(temp_buffer) - 1;
}
memcpy(temp_buffer, flow_packet->payload, payload_len);
temp_buffer[payload_len] = '\0';

char *username_start = strchr(temp_buffer, '"');
if (username_start) {
  char *username_end = strchr(username_start + 1, '"');
  if (username_end) {
    size_t username_len = username_end - username_start - 1;
    if (username_len < sizeof(flow->protos.ftp_imap_pop_smtp.username)) {
      memcpy(flow->protos.ftp_imap_pop_smtp.username, username_start + 1, username_len);
      flow->protos.ftp_imap_pop_smtp.username[username_len] = '\0';
    }

    char *password_start = strchr(username_end + 1, '"');
    if (password_start) {
      char *password_end = strchr(password_start + 1, '"');
      if (password_end) {
        size_t password_len = password_end - password_start - 1;
        if (password_len < sizeof(flow->protos.ftp_imap_pop_smtp.password)) {
          memcpy(flow->protos.ftp_imap_pop_smtp.password, password_start + 1, password_len);
          flow->protos.ftp_imap_pop_smtp.password[password_len] = '\0';
        }
      }
    }
  }
}