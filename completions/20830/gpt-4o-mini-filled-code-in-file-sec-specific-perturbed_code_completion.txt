const u_int8_t *username_start = NULL;
      const u_int8_t *username_end = NULL;
      const u_int8_t *password_start = NULL;
      const u_int8_t *password_end = NULL;

      // Locate the first double quote for the username
      for (i = command_start; i < flow_packet->payload_packet_len; i++) {
          if (flow_packet->payload[i] == '"') {
              username_start = &flow_packet->payload[i + 1];
              break;
          }
      }

      // Locate the second double quote for the username
      if (username_start) {
          for (i = username_start - flow_packet->payload; i < flow_packet->payload_packet_len; i++) {
              if (flow_packet->payload[i] == '"') {
                  username_end = &flow_packet->payload[i];
                  break;
              }
          }
      }

      // Locate the first double quote for the password
      if (username_end) {
          for (i = username_end - flow_packet->payload + 1; i < flow_packet->payload_packet_len; i++) {
              if (flow_packet->payload[i] == '"') {
                  password_start = &flow_packet->payload[i + 1];
                  break;
              }
          }
      }

      // Locate the second double quote for the password
      if (password_start) {
          for (i = password_start - flow_packet->payload; i < flow_packet->payload_packet_len; i++) {
              if (flow_packet->payload[i] == '"') {
                  password_end = &flow_packet->payload[i];
                  break;
              }
          }
      }

      // Ensure we have valid pointers and lengths before copying
      if (username_start && username_end && password_start && password_end) {
          size_t username_length = username_end - username_start;
          size_t password_length = password_end - password_start;

          if (username_length < sizeof(flow->protos.ftp_imap_pop_smtp.username) &&
              password_length < sizeof(flow->protos.ftp_imap_pop_smtp.password)) {
              memcpy(flow->protos.ftp_imap_pop_smtp.username, username_start, username_length);
              flow->protos.ftp_imap_pop_smtp.username[username_length] = '\0'; // Null-terminate
              memcpy(flow->protos.ftp_imap_pop_smtp.password, password_start, password_length);
              flow->protos.ftp_imap_pop_smtp.password[password_length] = '\0'; // Null-terminate
          }
      }