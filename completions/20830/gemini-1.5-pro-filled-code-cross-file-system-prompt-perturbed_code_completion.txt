char buf[flow_packet->payload_packet_len + 1];
  char *user, *pwd, *pwd_end;

  strncpy(buf, (const char *)flow_packet->payload, flow_packet->payload_packet_len);
  buf[flow_packet->payload_packet_len] = '\0';

  user = strchr(buf, '"');
  if (!user) {
    goto imap_excluded;
  }
  user++;
  pwd = strchr(user, '"');
  if (!pwd) {
    goto imap_excluded;
  }
  *pwd = '\0';
  strncpy(flow->protos.ftp_imap_pop_smtp.username, user, MAX_USER_PWD_LEN);
  pwd++;
  pwd = strchr(pwd, '"');
  if (!pwd) {
    goto imap_excluded;
  }
  pwd++;
  pwd_end = strchr(pwd, '"');
  if (!pwd_end) {
    goto imap_excluded;
  }
  *pwd_end = '\0';
  strncpy(flow->protos.ftp_imap_pop_smtp.password, pwd, MAX_USER_PWD_LEN);

#ifdef IMAP_DEBUG
  printf("IMAP LOGIN username = %s, password = %s\n", flow->protos.ftp_imap_pop_smtp.username, flow->protos.ftp_imap_pop_smtp.password);
#endif