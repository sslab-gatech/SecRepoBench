// Extract and store the "username" and "password" from the IMAP LOGIN command.
// Copy the packet payload into a temporary string buffer.
// Ensure the copied string is null-terminated.
// Locate the first double quote character, marking the start of the username.
// Find the next double quote to identify the end of the username and store it.
// Locate the next pair of double quotes to extract the password and store it.
// The extracted username and password are stored within the flow structure.
if (command_start + 6 < flow_packet->payload_packet_len) {
    // Find the first quote after "LOGIN "
    u_int16_t username_start = command_start + 6;
    while (username_start < flow_packet->payload_packet_len && flow_packet->payload[username_start] != '"') {
        username_start++;
    }
    
    if (username_start < flow_packet->payload_packet_len) {
        username_start++; // Move past the quote
        u_int16_t username_end = username_start;
        while (username_end < flow_packet->payload_packet_len && flow_packet->payload[username_end] != '"') {
            username_end++;
        }
        
        if (username_end < flow_packet->payload_packet_len) {
            // Copy username
            u_int16_t username_len = username_end - username_start;
            if (username_len > 0 && username_len < sizeof(flow->protos.ftp_imap_pop_smtp.username)) {
                strncpy(flow->protos.ftp_imap_pop_smtp.username, 
                       (char*)&flow_packet->payload[username_start], 
                       username_len);
                flow->protos.ftp_imap_pop_smtp.username[username_len] = '\0';
            }
            
            // Find password start after next quote
            u_int16_t password_start = username_end + 1;
            while (password_start < flow_packet->payload_packet_len && flow_packet->payload[password_start] != '"') {
                password_start++;
            }
            
            if (password_start < flow_packet->payload_packet_len) {
                password_start++; // Move past the quote
                u_int16_t password_end = password_start;
                while (password_end < flow_packet->payload_packet_len && flow_packet->payload[password_end] != '"') {
                    password_end++;
                }
                
                if (password_end < flow_packet->payload_packet_len) {
                    // Copy password
                    u_int16_t password_len = password_end - password_start;
                    if (password_len > 0 && password_len < sizeof(flow->protos.ftp_imap_pop_smtp.password)) {
                        strncpy(flow->protos.ftp_imap_pop_smtp.password, 
                               (char*)&flow_packet->payload[password_start], 
                               password_len);
                        flow->protos.ftp_imap_pop_smtp.password[password_len] = '\0';
                    }
                }
            }
        }
    }
}