char login_buffer[MAX_LOGIN_BUFFER_SIZE];
            int login_len = flow_packet->payload_packet_len - command_start;

            if (login_len > 0) {
                login_len = MIN(login_len, MAX_LOGIN_BUFFER_SIZE - 1);
                strncpy(login_buffer, (const char *)(flow_packet->payload + command_start), login_len);
                login_buffer[login_len] = '\0';

                char *username_start = strchr(login_buffer, '"');
                if (username_start != NULL) {
                    username_start++; // Move past the first quote
                    char *username_end = strchr(username_start, '"');
                    if (username_end != NULL) {
                        int username_len = username_end - username_start;
                        if (username_len > 0) {
                            username_len = MIN(username_len, MAX_USERNAME_SIZE - 1);
                            strncpy((char *)flow->protos.ftp_imap_pop_smtp.username, (const char *)username_start, username_len);
                            flow->protos.ftp_imap_pop_smtp.username[username_len] = '\0';

                            char *password_start = strchr(username_end + 1, '"');
                            if (password_start != NULL) {
                                password_start++; // Move past the first quote
                                char *password_end = strchr(password_start, '"');
                                if (password_end != NULL) {
                                    int password_len = password_end - password_start;
                                    if (password_len > 0) {
                                        password_len = MIN(password_len, MAX_PASSWORD_SIZE - 1);
                                        strncpy((char *)flow->protos.ftp_imap_pop_smtp.password, (const char *)password_start, password_len);
                                        flow->protos.ftp_imap_pop_smtp.password[password_len] = '\0';
                                    }
                                }
                            }
                        }
                    }
                }
            }