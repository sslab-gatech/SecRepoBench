size_t payload_len = flow_packet->payload_packet_len;
  char *temp_buffer = (char *)malloc(payload_len);
  if (temp_buffer == NULL) {
    return; // Handle memory allocation failure
  }
  strncpy(temp_buffer, (const char *)flow_packet->payload, payload_len - 1);
  temp_buffer[payload_len - 1] = '\0';

  size_t first_quote = strchr(temp_buffer, '"') - temp_buffer;
  size_t second_quote = strchr(temp_buffer + first_quote + 1, '"') - temp_buffer;
  size_t third_quote = strchr(temp_buffer + second_quote + 1, '"') - temp_buffer;
  size_t fourth_quote = strchr(temp_buffer + third_quote + 1, '"') - temp_buffer;

  if (first_quote != (size_t)-1 && second_quote != (size_t)-1 && third_quote != (size_t)-1 && fourth_quote != (size_t)-1) {
    size_t username_len = second_quote - first_quote - 1;
    size_t password_len = fourth_quote - third_quote - 1;

    strncpy(flow->protos.ftp_imap_pop_smtp.username, temp_buffer + first_quote + 1, username_len);
    flow->protos.ftp_imap_pop_smtp.username[username_len] = '\0';

    strncpy(flow->protos.ftp_imap_pop_smtp.password, temp_buffer + third_quote + 1, password_len);
    flow->protos.ftp_imap_pop_smtp.password[password_len] = '\0';
  }
  free(temp_buffer);