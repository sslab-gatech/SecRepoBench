// Copy the packet payload into a temporary string buffer.
char temp_buffer[flow_packet->payload_packet_len + 1];
memcpy(temp_buffer, flow_packet->payload, flow_packet->payload_packet_len);
temp_buffer[flow_packet->payload_packet_len] = '\0';

// Ensure the copied string is null-terminated.
if (temp_buffer[flow_packet->payload_packet_len - 1]!= '\r' && temp_buffer[flow_packet->payload_packet_len - 1]!= '\n') {
  temp_buffer[flow_packet->payload_packet_len] = '\0';
}

// Locate the first double quote character, marking the start of the username.
char *username_start = strchr(temp_buffer, '"');
if (username_start == NULL) {
  return;
}

// Find the next double quote to identify the end of the username and store it.
char *username_end = strchr(username_start + 1, '"');
if (username_end == NULL) {
  return;
}

// Extract the username.
size_t username_len = username_end - username_start - 1;
if (username_len > 0) {
  memcpy(flow->protos.ftp_imap_pop_smtp.username, username_start + 1, username_len);
  flow->protos.ftp_imap_pop_smtp.username[username_len] = '\0';
}

// Locate the next pair of double quotes to extract the password and store it.
char *password_start = strchr(username_end + 1, '"');
if (password_start == NULL) {
  return;
}

char *password_end = strchr(password_start + 1, '"');
if (password_end == NULL) {
  return;
}

// Extract the password.
size_t password_len = password_end - password_start - 1;
if (password_len > 0) {
  memcpy(flow->protos.ftp_imap_pop_smtp.password, password_start + 1, password_len);
  flow->protos.ftp_imap_pop_smtp.password[password_len] = '\0';
}