size_t payload_len = flow_packet->payload_packet_len;
  char *payload_copy = (char *)malloc(payload_len + 1);
  if (payload_copy == NULL) {
    return; // Handle memory allocation failure
  }
  memcpy(payload_copy, flow_packet->payload, payload_len);
  payload_copy[payload_len] = '\0';

  char *username_start = strchr(payload_copy, '"');
  if (username_start == NULL) {
    free(payload_copy);
    return;
  }
  username_start++;

  char *username_end = strchr(username_start, '"');
  if (username_end == NULL) {
    free(payload_copy);
    return;
  }
  size_t username_len = username_end - username_start;
  strncpy(flow->protos.ftp_imap_pop_smtp.username, username_start, username_len);
  flow->protos.ftp_imap_pop_smtp.username[username_len] = '\0';


  char *password_start = strchr(username_end + 1, '"');
  if (password_start == NULL) {
    free(payload_copy);
    return;
  }
  password_start++;

  char *password_end = strchr(password_start, '"');
  if (password_end == NULL) {
    free(payload_copy);
    return;
  }
  size_t password_len = password_end - password_start;
  strncpy(flow->protos.ftp_imap_pop_smtp.password, password_start, password_len);
  flow->protos.ftp_imap_pop_smtp.password[password_len] = '\0';

  free(payload_copy);