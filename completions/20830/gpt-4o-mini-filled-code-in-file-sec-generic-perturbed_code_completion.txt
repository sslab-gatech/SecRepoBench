const u_int8_t *username_start = NULL;
      const u_int8_t *username_end = NULL;
      const u_int8_t *password_start = NULL;
      const u_int8_t *password_end = NULL;
      u_int16_t username_len = 0;
      u_int16_t password_len = 0;

      // Find the first double quote for the username
      username_start = (const u_int8_t *)memchr(&flow_packet->payload[command_start], '"', flow_packet->payload_packet_len - command_start);
      if (username_start) {
          username_start++; // Move past the opening quote
          username_end = (const u_int8_t *)memchr(username_start, '"', flow_packet->payload_packet_len - (username_start - flow_packet->payload));
          if (username_end) {
              username_len = username_end - username_start;
              if (username_len < sizeof(flow->protos.ftp_imap_pop_smtp.username)) {
                  memcpy(flow->protos.ftp_imap_pop_smtp.username, username_start, username_len);
                  flow->protos.ftp_imap_pop_smtp.username[username_len] = '\0'; // Null-terminate
              }
          }

          // Find the password, which is expected to be after the username
          password_start = (const u_int8_t *)memchr(username_end + 1, '"', flow_packet->payload_packet_len - (username_end - flow_packet->payload + 1));
          if (password_start) {
              password_start++; // Move past the opening quote
              password_end = (const u_int8_t *)memchr(password_start, '"', flow_packet->payload_packet_len - (password_start - flow_packet->payload));
              if (password_end) {
                  password_len = password_end - password_start;
                  if (password_len < sizeof(flow->protos.ftp_imap_pop_smtp.password)) {
                      memcpy(flow->protos.ftp_imap_pop_smtp.password, password_start, password_len);
                      flow->protos.ftp_imap_pop_smtp.password[password_len] = '\0'; // Null-terminate
                  }
              }
          }