char temp_buffer[256];
u_int16_t temp_len = MIN(flow_packet->payload_packet_len - command_start, sizeof(temp_buffer) - 1);
memcpy(temp_buffer, &flow_packet->payload[command_start], temp_len);
temp_buffer[temp_len] = '\0';

char *username_start = strchr(temp_buffer, '"');
if (username_start != NULL) {
  username_start++; // Move past the first double quote
  char *username_end = strchr(username_start, '"');
  if (username_end != NULL) {
    size_t username_length = username_end - username_start;
    strncpy(flow->protos.ftp_imap_pop_smtp.username, username_start, MIN(username_length, sizeof(flow->protos.ftp_imap_pop_smtp.username) - 1));
    flow->protos.ftp_imap_pop_smtp.username[MIN(username_length, sizeof(flow->protos.ftp_imap_pop_smtp.username) - 1)] = '\0';

    char *password_start = strchr(username_end + 1, '"');
    if (password_start != NULL) {
      password_start++; // Move past the second double quote
      char *password_end = strchr(password_start, '"');
      if (password_end != NULL) {
        size_t password_length = password_end - password_start;
        strncpy(flow->protos.ftp_imap_pop_smtp.password, password_start, MIN(password_length, sizeof(flow->protos.ftp_imap_pop_smtp.password) - 1));
        flow->protos.ftp_imap_pop_smtp.password[MIN(password_length, sizeof(flow->protos.ftp_imap_pop_smtp.password) - 1)] = '\0';
      }
    }
  }
}