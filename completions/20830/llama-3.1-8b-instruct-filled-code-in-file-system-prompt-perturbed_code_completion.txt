// Extract and store the "username" and "password" from the IMAP LOGIN command.
// Copy the packet payload into a temporary string buffer.
// Ensure the copied string is null-terminated.
// Locate the first double quote character, marking the start of the username.
// Find the next double quote to identify the end of the username and store it.
// Locate the next pair of double quotes to extract the password and store it.
// The extracted username and password are stored within the flow structure.
char *username = NULL;
char *password = NULL;
char temp_buffer[1024];
memcpy(temp_buffer, flow_packet->payload, flow_packet->payload_packet_len);
temp_buffer[flow_packet->payload_packet_len] = '\0';
char *start_username = strstr(temp_buffer, "\"");
if (start_username!= NULL) {
  char *end_username = strstr(start_username + 1, "\"");
  if (end_username!= NULL) {
    username = malloc(end_username - start_username - 1);
    memcpy(username, start_username + 1, end_username - start_username - 1);
    username[end_username - start_username - 1] = '\0';
  }
}
char *start_password = strstr(end_username + 1, "\"");
if (start_password!= NULL) {
  char *end_password = strstr(start_password + 1, "\"");
  if (end_password!= NULL) {
    password = malloc(end_password - start_password - 1);
    memcpy(password, start_password + 1, end_password - start_password - 1);
    password[end_password - start_password - 1] = '\0';
  }
}
if (username!= NULL && password!= NULL) {
  flow->l4.tcp.mail_imap_username = malloc(strlen(username) + 1);
  strcpy(flow->l4.tcp.mail_imap_username, username);
  flow->l4.tcp.mail_imap_password = malloc(strlen(password) + 1);
  strcpy(flow->l4.tcp.mail_imap_password, password);
}