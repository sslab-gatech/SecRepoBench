char username[256] = {0};
      char password[256] = {0};
      u_int16_t username_start = 0;
      u_int16_t username_end = 0;
      u_int16_t password_start = 0;
      u_int16_t password_end = 0;
      u_int16_t j = command_start + 6; // Start after "LOGIN "

      // Find the start of the username
      while (j < flow_packet->payload_packet_len && flow_packet->payload[j] != '"') {
          j++;
      }
      username_start = ++j; // Move past the opening quote

      // Find the end of the username
      while (j < flow_packet->payload_packet_len && flow_packet->payload[j] != '"') {
          j++;
      }
      username_end = j;

      // Copy the username
      if (username_end > username_start) {
          strncpy(username, (const char *)&flow_packet->payload[username_start], username_end - username_start);
          username[username_end - username_start] = '\0'; // Null-terminate
      }

      // Find the start of the password
      j++; // Move past the closing quote of the username
      while (j < flow_packet->payload_packet_len && flow_packet->payload[j] != '"') {
          j++;
      }
      password_start = ++j; // Move past the opening quote of the password

      // Find the end of the password
      while (j < flow_packet->payload_packet_len && flow_packet->payload[j] != '"') {
          j++;
      }
      password_end = j;

      // Copy the password
      if (password_end > password_start) {
          strncpy(password, (const char *)&flow_packet->payload[password_start], password_end - password_start);
          password[password_end - password_start] = '\0'; // Null-terminate
      }

      // Store the extracted username and password in the flow structure
      strncpy(flow->protos.ftp_imap_pop_smtp.username, username, sizeof(flow->protos.ftp_imap_pop_smtp.username) - 1);
      strncpy(flow->protos.ftp_imap_pop_smtp.password, password, sizeof(flow->protos.ftp_imap_pop_smtp.password) - 1);