// Extract and store the "username" and "password" from the IMAP LOGIN command.
char temp_buffer[256];
strncpy(temp_buffer, (char*)flow_packet->payload + command_start, sizeof(temp_buffer) - 1);
temp_buffer[sizeof(temp_buffer) - 1] = '\0';

char *username_start = strchr(temp_buffer, '"');
if (username_start) {
    char *username_end = strchr(username_start + 1, '"');
    if (username_end) {
        *username_end = '\0';
        strncpy(flow->protos.ftp_imap_pop_smtp.username, username_start + 1, sizeof(flow->protos.ftp_imap_pop_smtp.username) - 1);
        flow->protos.ftp_imap_pop_smtp.username[sizeof(flow->protos.ftp_imap_pop_smtp.username) - 1] = '\0';

        char *password_start = strchr(username_end + 1, '"');
        if (password_start) {
            char *password_end = strchr(password_start + 1, '"');
            if (password_end) {
                *password_end = '\0';
                strncpy(flow->protos.ftp_imap_pop_smtp.password, password_start + 1, sizeof(flow->protos.ftp_imap_pop_smtp.password) - 1);
                flow->protos.ftp_imap_pop_smtp.password[sizeof(flow->protos.ftp_imap_pop_smtp.password) - 1] = '\0';
            }
        }
    }
}