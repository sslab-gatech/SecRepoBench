if((flow_packet->payload[command_start] == 'L' || flow_packet->payload[command_start] == 'l')
    && (flow_packet->payload[command_start + 1] == 'O' || flow_packet->payload[command_start + 1] == 'o')
    && (flow_packet->payload[command_start + 2] == 'G' || flow_packet->payload[command_start + 2] == 'g')
    && (flow_packet->payload[command_start + 3] == 'I' || flow_packet->payload[command_start + 3] == 'i')
    && (flow_packet->payload[command_start + 4] == 'N' || flow_packet->payload[command_start + 4] == 'n')) {
  // Extract and store the "username" and "password" from the IMAP LOGIN command.
  // Copy the packet payload into a temporary string buffer.
  // Ensure the copied string is null-terminated.
  // Locate the first double quote character, marking the start of the username.
  // Find the next double quote to identify the end of the username and store it.
  // Locate the next pair of double quotes to extract the password and store it.
  // The extracted username and password are stored within the flow structure.
  u_int16_t username_start = 0;
  u_int16_t username_end = 0;
  u_int16_t password_start = 0;
  u_int16_t password_end = 0;
  u_int16_t i = 0;
  char temp_username[256] = {0};
  char temp_password[256] = {0};

  // Locate the first double quote character, marking the start of the username.
  for (i = command_start + 4; i < flow_packet->payload_packet_len; i++) {
    if (flow_packet->payload[i] == '"') {
      username_start = i;
      break;
    }
  }

  // Find the next double quote to identify the end of the username and store it.
  for (i = username_start + 1; i < flow_packet->payload_packet_len; i++) {
    if (flow_packet->payload[i] == '"') {
      username_end = i;
      break;
    }
  }

  // Locate the next pair of double quotes to extract the password and store it.
  for (i = username_end + 1; i < flow_packet->payload_packet_len; i++) {
    if (flow_packet->payload[i] == '"') {
      password_start = i;
      break;
    }
  }

  for (i = password_start + 1; i < flow_packet->payload_packet_len; i++) {
    if (flow_packet->payload[i] == '"') {
      password_end = i;
      break;
    }
  }

  // Copy the username and password into the temporary buffers.
  strncpy(temp_username, &(flow_packet->payload[username_start + 1]), username_end - username_start - 1);
  strncpy(temp_password, &(flow_packet->payload[password_start + 1]), password_end - password_start - 1);

  // Store the extracted username and password within the flow structure.
  strncpy(flow->l4.tcp.mail_imap_username, temp_username, 256);
  strncpy(flow->l4.tcp.mail_imap_password, temp_password, 256);

  flow->l4.tcp.mail_imap_stage += 1;
  saw_command = 1;
}