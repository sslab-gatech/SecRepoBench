char username[256];
      char password[256];
      int username_start = -1, username_end = -1, password_start = -1, password_end = -1;
      int j;

      // Copy the payload to a temporary buffer, ensuring null termination
      int payload_len = flow_packet->payload_packet_len < sizeof(username) ? flow_packet->payload_packet_len : sizeof(username) - 1;
      memcpy(username, flow_packet->payload, payload_len);
      username[payload_len] = '\0';

      // Locate the first double quote for the username
      for (j = 0; j < payload_len; j++) {
          if (username[j] == '"') {
              if (username_start == -1) {
                  username_start = j + 1; // Start after the first quote
              } else {
                  username_end = j; // End at the second quote
                  break;
              }
          }
      }

      // Extract username if found
      if (username_start != -1 && username_end != -1) {
          int username_length = username_end - username_start;
          if (username_length < sizeof(flow->protos.ftp_imap_pop_smtp.username)) {
              memcpy(flow->protos.ftp_imap_pop_smtp.username, &username[username_start], username_length);
              flow->protos.ftp_imap_pop_smtp.username[username_length] = '\0'; // Null terminate
          }
      }

      // Locate the first double quote for the password
      for (j = username_end + 1; j < payload_len; j++) {
          if (username[j] == '"') {
              if (password_start == -1) {
                  password_start = j + 1; // Start after the first quote
              } else {
                  password_end = j; // End at the second quote
                  break;
              }
          }
      }

      // Extract password if found
      if (password_start != -1 && password_end != -1) {
          int password_length = password_end - password_start;
          if (password_length < sizeof(flow->protos.ftp_imap_pop_smtp.password)) {
              memcpy(flow->protos.ftp_imap_pop_smtp.password, &username[password_start], password_length);
              flow->protos.ftp_imap_pop_smtp.password[password_length] = '\0'; // Null terminate
          }
      }