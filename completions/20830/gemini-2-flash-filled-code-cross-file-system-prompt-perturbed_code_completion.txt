char tmp_payload[NDPI_PAYLOAD_MAX_LENGTH];
	  u_int16_t username_start = 0, username_end = 0, password_start = 0, password_end = 0;

	  strncpy(tmp_payload, (char*)flow_packet->payload, MIN(flow_packet->payload_packet_len, NDPI_PAYLOAD_MAX_LENGTH - 1));
	  tmp_payload[MIN(flow_packet->payload_packet_len, NDPI_PAYLOAD_MAX_LENGTH - 1)] = '\0';

	  char *username_start_ptr = strchr(tmp_payload, '"');
	  if (username_start_ptr != NULL) {
	    username_start = username_start_ptr - tmp_payload + 1;

	    char *username_end_ptr = strchr(username_start_ptr + 1, '"');
	    if (username_end_ptr != NULL) {
	      username_end = username_end_ptr - tmp_payload;

	      char *password_start_ptr = strchr(username_end_ptr + 1, '"');
	      if (password_start_ptr != NULL) {
		password_start = password_start_ptr - tmp_payload + 1;

		char *password_end_ptr = strchr(password_start_ptr + 1, '"');
		if (password_end_ptr != NULL) {
		  password_end = password_end_ptr - tmp_payload;

		  if ((username_end > username_start) && (password_end > password_start)) {
		    // Extract username
		    memset(flow->protos.ftp_imap_pop_smtp.username, 0, sizeof(flow->protos.ftp_imap_pop_smtp.username));
		    strncpy(flow->protos.ftp_imap_pop_smtp.username, tmp_payload + username_start, MIN(username_end - username_start, sizeof(flow->protos.ftp_imap_pop_smtp.username) - 1));

		    // Extract password
		    memset(flow->protos.ftp_imap_pop_smtp.password, 0, sizeof(flow->protos.ftp_imap_pop_smtp.password));
		    strncpy(flow->protos.ftp_imap_pop_smtp.password, tmp_payload + password_start, MIN(password_end - password_start, sizeof(flow->protos.ftp_imap_pop_smtp.password) - 1));
		  }
		}
	      }
	    }
	  }