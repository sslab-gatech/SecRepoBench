line_state(dbg, &regs, &mb);
            _dwarf_printf(dbg,dwarfstring_string(&mb));
            dwarfstring_destructor(&mb);
            }
#endif /* PRINTING_DETAILS */
        } else if (type == LOP_ADVANCE_PC) {
            int ocres = 0;
            /*  Read the operand of the fixed_advance_pc extended
                opcode. */
            Dwarf_Unsigned advance_pc = 0;

            ocres =  read_uword_de( &line_ptr,&advance_pc,
                dbg,error,line_ptr_end);
            if (ocres == DW_DLV_ERROR) {
                _dwarf_free_chain_entries(dbg,head_chain,
                    line_count);
                if (curr_line) {
                    dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                    curr_line = 0;
                }
                return DW_DLV_ERROR;
            }
            regs.lr_address = regs.lr_address + advance_pc;
#ifdef PRINTING_DETAILS
            {
            dwarfstring ma;
            dwarfstring_constructor(&ma);
            dwarfstring_append_printf_u(&ma,"Advance_pc %u",
                advance_pc);
            _dwarf_printf(dbg,dwarfstring_string(&ma));
            dwarfstring_destructor(&ma);
            }
#endif /* PRINTING_DETAILS */
        } else if (type == LOP_SET_FILE) {
            int ocres = 0;
            Dwarf_Unsigned file_index = 0;

            ocres =  read_uword_de( &line_ptr,&file_index,
                dbg,error,line_ptr_end);
            if (ocres == DW_DLV_ERROR) {
                _dwarf_free_chain_entries(dbg,head_chain,
                    line_count);
                if (curr_line) {
                    dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                    curr_line = 0;
                }
                return DW_DLV_ERROR;
            }
            if (file_index >= line_context->lc_file_count) {
                _dwarf_error_string(dbg, error,
                    DW_DLE_FILE_INDEX_BAD,
                    "DW_DLE_FILE_INDEX_BAD: "
                    "The file index is out of range.");
                _dwarf_free_chain_entries(dbg,head_chain,
                    line_count);
                if (curr_line) {
                    dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                    curr_line = 0;
                }
                return DW_DLV_ERROR;
            }
            cur_file_entry = line_context->lc_file_entries[file_index];
#ifdef PRINTING_DETAILS
            {
            dwarfstring ma;
            dwarfstring_constructor(&ma);
            dwarfstring_append_printf_u(&ma,"Set_file %u",
                file_index);
            _dwarf_printf(dbg,dwarfstring_string(&ma));
            dwarfstring_destructor(&ma);
            }
#endif /* PRINTING_DETAILS */
        } else if (type == LOP_SET_COLUMN) {
            int ocres = 0;
            Dwarf_Unsigned column = 0;

            ocres =  read_uword_de( &line_ptr,&column,
                dbg,error,line_ptr_end);
            if (ocres == DW_DLV_ERROR) {
                _dwarf_free_chain_entries(dbg,head_chain,
                    line_count);
                if (curr_line) {
                    dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                    curr_line = 0;
                }
                return DW_DLV_ERROR;
            }
            regs.lr_column = column;
#ifdef PRINTING_DETAILS
            {
            dwarfstring ma;
            dwarfstring_constructor(&ma);
            dwarfstring_append_printf_u(&ma,"Set_column %u",
                column);
            _dwarf_printf(dbg,dwarfstring_string(&ma));
            dwarfstring_destructor(&ma);
            }
#endif /* PRINTING_DETAILS */
        } else if (type == LOP_SET_ADDRESS) {
            int ocres = 0;
            Dwarf_Unsigned addr_size = 0;
            Dwarf_Unsigned addr = 0;

            if (doaddrs) {
                addr_size = address_size;
            } else {
                addr_size = 0;
            }
            if (addr_size == 0) {
                addr_size = line_context->lc_address_size;
            }
            if (line_ptr + addr_size > line_ptr_end) {
                _dwarf_error(dbg, error, DW_DLE_LINE_TABLE_BAD);
                _dwarf_free_chain_entries(dbg,head_chain,
                    line_count);
                if (curr_line) {
                    dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                    curr_line = 0;
                }
                return DW_DLV_ERROR;
            }
            addr = 0;
            for (i = 0; i < addr_size; i++) {
                addr = (addr << 8) | line_ptr[i];
            }
            line_ptr += addr_size;
            regs.lr_address = addr;
            is_addr_set = true;
#ifdef PRINTING_DETAILS
            {
            dwarfstring ma;
            dwarfstring_constructor(&ma);
            dwarfstring_append_printf_u(&ma,"Set_address 0x%"
                DW_PR_DUx, addr);
            _dwarf_printf(dbg,dwarfstring_string(&ma));
            dwarfstring_destructor(&ma);
            }
#endif /* PRINTING_DETAILS */
        } else if (type == LOP_DEFINE_FILE) {
            int ocres = 0;
            Dwarf_Unsigned file_name_index = 0;
            Dwarf_Unsigned dir_index = 0;
            Dwarf_Unsigned time = 0;
            Dwarf_Unsigned length = 0;

            ocres =  read_uword_de( &line_ptr,&file_name_index,
                dbg,error,line_ptr_end);
            if (ocres == DW_DLV_ERROR) {
                _dwarf_free_chain_entries(dbg,head_chain,
                    line_count);
                if (curr_line) {
                    dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                    curr_line = 0;
                }
                return DW_DLV_ERROR;
            }
            ocres =  read_uword_de( &line_ptr,&dir_index,
                dbg,error,line_ptr_end);
            if (ocres == DW_DLV_ERROR) {
                _dwarf_free_chain_entries(dbg,head_chain,
                    line_count);
                if (curr_line) {
                    dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                    curr_line = 0;
                }
                return DW_DLV_ERROR;
            }
            ocres =  read_uword_de( &line_ptr,&time,
                dbg,error,line_ptr_end);
            if (ocres == DW_DLV_ERROR) {
                _dwarf_free_chain_entries(dbg,head_chain,
                    line_count);
                if (curr_line) {
                    dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                    curr_line = 0;
                }
                return DW_DLV_ERROR;
            }
            ocres =  read_uword_de( &line_ptr,&length,
                dbg,error,line_ptr_end);
            if (ocres == DW_DLV_ERROR) {
                _dwarf_free_chain_entries(dbg,head_chain,
                    line_count);
                if (curr_line) {
                    dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                    curr_line = 0;
                }
                return DW_DLV_ERROR;
            }
            if (file_name_index >= line_context->lc_file_count) {
                _dwarf_error_string(dbg, error,
                    DW_DLE_FILE_INDEX_BAD,
                    "DW_DLE_FILE_INDEX_BAD: "
                    "The file index is out of range.");
                _dwarf_free_chain_entries(dbg,head_chain,
                    line_count);
                if (curr_line) {
                    dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                    curr_line = 0;
                }
                return DW_DLV_ERROR;
            }
            if (dir_index >= line_context->lc_include_directories_count) {
                _dwarf_error_string(dbg, error,
                    DW_DLE_DIR_INDEX_BAD,
                    "DW_DLE_DIR_INDEX_BAD: "
                    "The directory index is out of range.");
                _dwarf_free_chain_entries(dbg,head_chain,
                    line_count);
                if (curr_line) {
                    dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                    curr_line = 0;
                }
                return DW_DLV_ERROR;
            }
            cur_file_entry = line_context->lc_file_entries[file_name_index];
            cur_file_entry->fi_dir_index = dir_index;
            cur_file_entry->fi_dir_index_present = TRUE;
            cur_file_entry->fi_time_last_mod = time;
            cur_file_entry->fi_time_last_mod_present = TRUE;
            cur_file_entry->fi_file_length = length;
            cur_file_entry->fi_file_length_present = TRUE;
#ifdef PRINTING_DETAILS
            {
            dwarfstring ma;
            dwarfstring_constructor(&ma);
            dwarfstring_append_printf_u(&ma,"Define_file %u %u %u %u",
                file_name_index,dir_index,time,length);
            _dwarf_printf(dbg,dwarfstring_string(&ma));
            dwarfstring_destructor(&ma);
            }
#endif /* PRINTING_DETAILS */
        } else if (type == LOP_SET_PROLOGUE_END) {
            /*  This is the end of the prologue. */
            line_context->lc_line_ptr_end = line_ptr;
#ifdef PRINTING_DETAILS
            {
            dwarfstring ma;
            dwarfstring_constructor(&ma);
            _dwarf_printf(dbg,dwarfstring_string(&ma));
            dwarfstring_destructor(&ma);
            }
#endif /* PRINTING_DETAILS */
        } else if (type == LOP_SET_EPILOGUE_BEGIN) {
            /*  This is the beginning of the epilogue. */
#ifdef PRINTING_DETAILS
            {
            dwarfstring ma;
            dwarfstring_constructor(&ma);
            _dwarf_printf(dbg,dwarfstring_string(&ma));
            dwarfstring_destructor(&ma);
            }
#endif /* PRINTING_DETAILS */
        } else if (type == LOP_SET_ISA) {
            int ocres = 0;
            Dwarf_Unsigned isa = 0;

            ocres =  read_uword_de( &line_ptr,&isa,
                dbg,error,line_ptr_end);
            if (ocres == DW_DLV_ERROR) {
                _dwarf_free_chain_entries(dbg,head_chain,
                    line_count);
                if (curr_line) {
                    dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                    curr_line = 0;
                }
                return DW_DLV_ERROR;
            }
            regs.lr_isa = isa;
#ifdef PRINTING_DETAILS
            {
            dwarfstring ma;
            dwarfstring_constructor(&ma);
            dwarfstring_append_printf_u(&ma,"Set_isa %u",
                isa);
            _dwarf_printf(dbg,dwarfstring_string(&ma));
            dwarfstring_destructor(&ma);
            }
#endif /* PRINTING_DETAILS */
        } else