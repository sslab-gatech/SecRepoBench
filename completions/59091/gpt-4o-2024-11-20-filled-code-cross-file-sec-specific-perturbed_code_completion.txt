Dwarf_Unsigned subprog_format_count = 0;
        Dwarf_Unsigned *subprog_entry_types = NULL;
        Dwarf_Unsigned *subprog_entry_forms = NULL;
        Dwarf_Unsigned subprogs_count = 0;

        if (line_ptr >= line_ptr_end) {
            _dwarf_error(dbg, err, DW_DLE_LINE_NUMBER_HEADER_ERROR);
            return DW_DLV_ERROR;
        }

        /* Read the subprogram format count */
        subprog_format_count = *(unsigned char *)line_ptr;
        line_ptr += sizeof(Dwarf_Small);

        if (subprog_format_count > total_length) {
            _dwarf_error_string(dbg, err, DW_DLE_LINE_NUMBER_HEADER_ERROR,
                "Subprogram format count exceeds total length");
            return DW_DLV_ERROR;
        }

        /* Allocate memory for subprogram entry types and forms */
        subprog_entry_types = malloc(sizeof(Dwarf_Unsigned) * subprog_format_count);
        if (!subprog_entry_types) {
            _dwarf_error_string(dbg, err, DW_DLE_ALLOC_FAIL,
                "Failed to allocate memory for subprogram entry types");
            return DW_DLV_ERROR;
        }

        subprog_entry_forms = malloc(sizeof(Dwarf_Unsigned) * subprog_format_count);
        if (!subprog_entry_forms) {
            free(subprog_entry_types);
            _dwarf_error_string(dbg, err, DW_DLE_ALLOC_FAIL,
                "Failed to allocate memory for subprogram entry forms");
            return DW_DLV_ERROR;
        }

        /* Read the subprogram entry types and forms */
        for (index = 0; index < subprog_format_count; index++) {
            res = read_uword_de(&line_ptr, &subprog_entry_types[index], dbg, err, line_ptr_end);
            if (res != DW_DLV_OK) {
                free(subprog_entry_types);
                free(subprog_entry_forms);
                return res;
            }

            res = read_uword_de(&line_ptr, &subprog_entry_forms[index], dbg, err, line_ptr_end);
            if (res != DW_DLV_OK) {
                free(subprog_entry_types);
                free(subprog_entry_forms);
                return res;
            }
        }

        /* Read the subprograms count */
        res = read_uword_de(&line_ptr, &subprogs_count, dbg, err, line_ptr_end);
        if (res != DW_DLV_OK) {
            free(subprog_entry_types);
            free(subprog_entry_forms);
            return res;
        }

        if (subprogs_count > total_length) {
            _dwarf_error_string(dbg, err, DW_DLE_LINE_NUMBER_HEADER_ERROR,
                "Subprograms count exceeds total length");
            free(subprog_entry_types);
            free(subprog_entry_forms);
            return DW_DLV_ERROR;
        }