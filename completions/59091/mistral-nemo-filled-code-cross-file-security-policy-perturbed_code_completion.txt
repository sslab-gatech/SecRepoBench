static int
_dwarf_read_line_table_header(Dwarf_Debug dbg,
    Dwarf_CU_Context cu_context,
    Dwarf_Small * section_start,
    Dwarf_Small * data_start,
    Dwarf_Unsigned section_length,
    Dwarf_Small ** updated_data_start_out,
    Dwarf_Line_Context  line_context,
    Dwarf_Error * err,
    int *err_count_out)
{
    // ... (previous code)

    // Masked region
    Dwarf_Unsigned directories_count = 0;
    Dwarf_Unsigned index = 0;
    Dwarf_Unsigned j = 0;
    int dres = 0;

    if (line_ptr >= line_ptr_end) {
        _dwarf_error_string(dbg, err,
            DW_DLE_LINE_NUMBER_HEADER_ERROR,
            "DW_DLE_LINE_NUMBER_HEADER_ERROR:"
            "we run off the end of the .debug_line section "
            "reading a line table header");
        return DW_DLV_ERROR;
    }

    dres=read_uword_de(&line_ptr,&directories_count,
        dbg,err,line_ptr_end);
    if (dres != DW_DLV_OK) {
        return dres;
    }
    if (directories_count > total_length) {
        IssueExpError(dbg,err,
            "Directories Count too large to be real",
            directories_count);
        return DW_DLV_ERROR;
    }

    line_context->lc_include_directories =
        malloc(sizeof(Dwarf_Small *) * directories_count);
    if (line_context->lc_include_directories == NULL) {
        _dwarf_error(dbg, err, DW_DLE_ALLOC_FAIL);
        return DW_DLV_ERROR;
    }
    memset(line_context->lc_include_directories, 0,
        sizeof(Dwarf_Small *) * directories_count);

    for (index = 0; index < directories_count; index++) {
        // ... (rest of the code)
    }

    // ... (rest of the code)
}