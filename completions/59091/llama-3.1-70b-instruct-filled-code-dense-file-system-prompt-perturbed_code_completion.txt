break;
            case DW_LNS_set_discriminator:{
                Dwarf_Unsigned utmp2 = 0;
                int sdres = 0;

                sdres =  read_uword_de( &line_ptr,&utmp2,
                    dbg,error,line_ptr_end);
                if (sdres == DW_DLV_ERROR) {
                    _dwarf_free_chain_entries(dbg,head_chain,
                        line_count);
                    if (curr_line) {
                        dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                    }
                    return DW_DLV_ERROR;
                }
                regs.lr_discriminator = utmp2;
#ifdef PRINTING_DETAILS
                dwarfstring_constructor(&mb);
                dwarfstring_append_printf_i(&mb,
                    "DW_LNS_set_discriminator "
                    "%" DW_PR_DSd,
                    utmp2);
                dwarfstring_append_printf_u(&mb,
                    " 0x%" DW_PR_XZEROS DW_PR_DSx "\n",
                    utmp2);
                _dwarf_printf(dbg,
                    dwarfstring_string(&mb));
                dwarfstring_destructor(&mb);
#endif /* PRINTING_DETAILS */
                }
                break;
            default:
                {
                dwarfstring m;

                dwarfstring_constructor(&m);
                dwarfstring_append_printf_i(&m,
                    "\nERROR: DW_DLE_LINE_TABLE_BAD "
                    "The line table opcode %d "
                    "is not understood.",
                    opcode);
                _dwarf_error_string(dbg, error,
                    DW_DLE_LINE_TABLE_BAD,
                    dwarfstring_string(&m));
                dwarfstring_destructor(&m);
                _dwarf_free_chain_entries(dbg,head_chain,
                    line_count);
                if (curr_line) {
                    dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                }
                return DW_DLV_ERROR;
                }
            }
            }
        } else {
            {
            dwarfstring m;

            dwarfstring_constructor(&m);
            dwarfstring_append_printf_i(&m,
                "\nERROR: DW_DLE_LINE_TABLE_BAD "
                "The line table opcode %d "
                "is not understood.",
                opcode);
            _dwarf_error_string(dbg, error,
                DW_DLE_LINE_TABLE_BAD,
                dwarfstring_string(&m));
            dwarfstring_destructor(&m);
            _dwarf_free_chain_entries(dbg,head_chain,
                line_count);
            if (curr_line) {
                dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
            }
            return DW_DLV_ERROR;
            }
        }
        if (line_ptr > line_ptr_end) {
            dwarfstring g;
            /*  ptrdiff_t is generated but not named */
            Dwarf_Unsigned localoff =
                (line_ptr >= section_start)?
                (line_ptr - section_start):0xfffffff;

            dwarfstring_constructor(&g);
            dwarfstring_append_printf_u(&g,
                "DW_DLE_LINE_TABLE_BAD reading "
                "line table we are "
                "off this line table at section "
                "offset. 0x%x.",
                localoff);
            _dwarf_error_string(dbg, error,
                DW_DLE_LINE_TABLE_BAD,
                dwarfstring_string(&g));
            dwarfstring_destructor(&g);
            _dwarf_free_chain_entries(dbg,head_chain,
                line_ptr);
            if (curr_line) {
                dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
            }
            return DW_DLV_ERROR;
        }
    }
    if (regs.lr_end_sequence) {
        if (regs.lr_address!= 0) {
            dwarfstring m;

            dwarfstring_constructor(&m);
            dwarfstring_append_printf_i(&m,
                "\nERROR: DW_DLE_LINE_TABLE_BAD "
                "The line table opcode %d "
                "is not understood.",
                opcode);
            _dwarf_error_string(dbg, error,
                DW_DLE_LINE_TABLE_BAD,
                dwarfstring_string(&m));
            dwarfstring_destructor(&m);
            _dwarf_free_chain_entries(dbg,head_chain,
                line_count);
            if (curr_line) {
                dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
            }
            return DW_DLV_ERROR;
        }
    }
    if (regs.lr_end_sequence) {
        if (regs.lr_address!= 0) {
            dwarfstring m;

            dwarfstring_constructor(&m);
            dwarfstring_append_printf_i(&m,
                "\nERROR: DW_DLE_LINE_TABLE_BAD "
                "The line table opcode %d "
                "is not understood.",
                opcode);
            _dwarf_error_string(dbg, error,
                DW_DLE_LINE_TABLE_BAD,
                dwarfstring_string(&m));
            dwarfstring_destructor(&m);
            _dwarf_free_chain_entries(dbg,head_chain,
                line_count);
            if (curr_line) {
                dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
            }
            return DW_DLV_ERROR;
        }
    }
    if (regs.lr_end_sequence) {
        if (regs.lr_address!= 0) {
            dwarfstring m;

            dwarfstring_constructor(&m);
            dwarfstring_append_printf_i(&m,
                "\nERROR: DW_DLE_LINE_TABLE_BAD "
                "The line table opcode %d "
                "is not understood.",
                opcode);
            _dwarf_error_string(dbg, error,
                DW_DLE_LINE_TABLE_BAD,
                dwarfstring_string(&m));
            dwarfstring_destructor(&m);
            _dwarf_free_chain_entries(dbg,head_chain,
                line_count);
            if (curr_line) {
                dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
            }
            return DW_DLV_ERROR;
        }
    }
    if (regs.lr_end_sequence) {
        if (regs.lr_address!= 0) {
            dwarfstring m;

            dwarfstring_constructor(&m);
            dwarfstring_append_printf_i(&m,
                "\nERROR: DW_DLE_LINE_TABLE_BAD "
                "The line table opcode %d "
                "is not understood.",
                opcode);
            _dwarf_error_string(dbg, error,
                DW_DLE_LINE_TABLE_BAD,
                dwarfstring_string(&m));
            dwarfstring_destructor(&m);
            _dwarf_free_chain_entries(dbg,head_chain,
                line_count);
            if (curr_line) {
                dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
            }
            return DW_DLV_ERROR;
        }
    }
    if (regs.lr_end_sequence) {
        if (regs.lr_address!= 0) {
            dwarfstring m;

            dwarfstring_constructor(&m);
            dwarfstring_append_printf_i(&m,
                "\nERROR: DW_DLE_LINE_TABLE_BAD "
                "The line table opcode %d "
                "is not understood.",
                opcode);
            _dwarf_error_string(dbg, error,
                DW_DLE_LINE_TABLE_BAD,
                dwarfstring_string(&m));
            dwarfstring_destructor(&m);
            _dwarf_free_chain_entries(dbg,head_chain,
                line_count);
            if (curr_line) {
                dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
            }
            return DW_DLV_ERROR;
        }
    }
    if (regs.lr_end_sequence) {
        if (regs.lr_address!= 0) {
            dwarfstring m;

            dwarfstring_constructor(&m);
            dwarfstring_append_printf_i(&m,
                "\nERROR: DW_DLE_LINE_TABLE_BAD "
                "The line table opcode %d "
                "is not understood.",
                opcode);
            _dwarf_error_string(dbg, error,
                DW_DLE_LINE_TABLE_BAD,
                dwarfstring_string(&m));
            dwarfstring_destructor(&m);
            _dwarf_free_chain_entries(dbg,head_chain,
                line_count);
            if (curr_line) {
                dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
            }
            return DW_DLV_ERROR;
        }
    }
    if (regs.lr_end_sequence) {
        if (regs.lr_address!= 0) {
            dwarfstring m;

            dwarfstring_constructor(&m);
            dwarfstring_append_printf_i(&m,
                "\nERROR: DW_DLE_LINE_TABLE_BAD "
                "The line table opcode %d "
                "is not understood.",
                opcode);
            _dwarf_error_string(dbg, error,
                DW_DLE_LINE_TABLE_BAD,
                dwarfstring_string(&m));
            dwarfstring_destructor(&m);
            _dwarf_free_chain_entries(dbg,head_chain,
                line_count);
            if (curr_line) {
                dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
            }
            return DW_DLV_ERROR;
        }
    }
    if (regs.lr_end_sequence) {
        if (regs.lr_address!= 0) {
            dwarfstring m;

            dwarfstring_constructor(&m);
            dwarfstring_append_printf_i(&m,
                "\nERROR: DW_DLE_LINE_TABLE_BAD "
                "The line table opcode %d "
                "is not understood.",
                opcode);
            _dwarf_error_string(dbg, error,
                DW_DLE_LINE_TABLE_BAD,
                dwarfstring_string(&m));
            dwarfstring_destructor(&m);
            _dwarf_free_chain_entries(dbg,head_chain,
                line_count);
            if (curr_line) {
                dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
            }
            return DW_DLV_ERROR;
        }
    }
    if (regs.lr_end_sequence) {
        if (regs.lr_address!= 0) {
            dwarfstring m;

            dwarfstring_constructor(&m);
            dwarfstring_append_printf_i(&m,
                "\nERROR: DW_DLE_LINE_TABLE_BAD "
                "The line table opcode %d "
                "is not understood.",
                opcode);
            _dwarf_error_string(dbg, error,
                DW_DLE_LINE_TABLE_BAD,
                dwarfstring_string(&m));
            dwarfstring_destructor(&m);
            _dwarf_free_chain_entries(dbg,head_chain,
                line_count);
            if (curr_line) {
                dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
            }
            return DW_DLV_ERROR;
        }
    }
    if (regs.lr_end_sequence) {
        if (regs.lr_address!= 0) {
            dwarfstring m;

            dwarfstring_constructor(&m);
            dwarfstring_append_printf_i(&m,
                "\nERROR: DW_DLE_LINE_TABLE_BAD "
                "The line table opcode %d "
                "is not understood.",
                opcode);
            _dwarf_error_string(dbg, error,
                DW_DLE_LINE_TABLE_BAD,
                dwarfstring_string(&m));
            dwarfstring_destructor(&m);
            _dwarf_free_chain_entries(dbg,head_chain,
                line_count);
            if (curr_line) {
                dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
            }
            return DW_DLV_ERROR;
        }
    }
    if (regs.lr_end_sequence) {
        if (regs.lr_address!= 0) {
            dwarfstring m;

            dwarfstring_constructor(&m);
            dwarfstring_append_printf_i(&m,
                "\nERROR: DW_DLE_LINE_TABLE_BAD "
                "The line table opcode %d "
                "is not understood.",
                opcode);
            _dwarf_error_string(dbg, error,
                DW_DLE_LINE_TABLE_BAD,
                dwarfstring_string(&m));
            dwarfstring_destructor(&m);
            _dwarf_free_chain_entries(dbg,head_chain,
                line_count);
            if (curr_line) {
                dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
            }
            return DW_DLV_ERROR;
        }
    }
    if (regs.lr_end_sequence) {
        if (regs.lr_address!= 0) {
            dwarfstring m;

            dwarfstring_constructor(&m);
            dwarfstring_append_printf_i(&m,
                "\nERROR: DW_DLE_LINE_TABLE_BAD "
                "The line table opcode %d "
                "is not understood.",
                opcode);
            _dwarf_error_string(dbg, error,
                DW_DLE_LINE_TABLE_BAD,
                dwarfstring_string(&m));
            dwarfstring_destructor(&m);
            _dwarf_free_chain_entries(dbg,head_chain,
                line_count);
            if (curr_line) {
                dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
            }
            return DW_DLV_ERROR;
        }
    }
    if (regs.lr_end_sequence) {
        if (regs.lr_address!= 0) {
            dwarfstring m;

            dwarfstring_constructor(&m);
            dwarfstring_append_printf_i(&m,
                "\nERROR: DW_DLE_LINE_TABLE_BAD "
                "The line table opcode %d "
                "is not understood.",
                opcode);
            _dwarf_error_string(dbg, error,
                DW_DLE_LINE_TABLE_BAD,
                dwarfstring_string(&m));
            dwarfstring_destructor(&m);
            _dwarf_free_chain_entries(dbg,head_chain,
                line_count);
            if (curr_line) {
                dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
            }
            return DW_DLV_ERROR;
        }
    }
    if (regs.lr_end_sequence) {
        if (regs.lr_address!= 0) {
            dwarfstring m;

            dwarfstring_constructor(&m);
            dwarfstring_append_printf_i(&m,
                "\nERROR: DW_DLE_LINE_TABLE_BAD "
                "The line table opcode %d "
                "is not understood.",
                opcode);
            _dwarf_error_string(dbg, error,
                DW_DLE_LINE_TABLE_BAD,
                dwarfstring_string(&m));
            dwarfstring_destructor(&m);
            _dwarf_free_chain_entries(dbg,head_chain,
                line_count);
            if (curr_line) {
                dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
            }
            return DW_DLV_ERROR;
        }
    }
    if (regs.lr_end_sequence) {
        if (regs.lr_address!= 0) {
            dwarfstring m;

            dwarfstring_constructor(&m);
            dwarfstring_append_printf_i(&m,
                "\nERROR: DW_DLE_LINE_TABLE_BAD "
                "The line table opcode %d "
                "is not understood.",
                opcode);
            _dwarf_error_string(dbg, error,
                DW_DLE_LINE_TABLE_BAD,
                dwarfstring_string(&m));
            dwarfstring_destructor(&m);
            _dwarf_free_chain_entries(dbg,head_chain,
                line_count);
            if (curr_line) {
                dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
            }
            return DW_DLV_ERROR;