) {
                        dwarfstring m;

                        dwarfstring_constructor(&m);
                        dwarfstring_append_printf_i(&m,
                            "\nERROR: DW_DLE_LINE_TABLE_LINENO_ERROR"
                            " The line number is %d "
                            "and negative line numbers after "
                            "DW_LNS_ADVANCE_LINE ",
                            (Dwarf_Signed)regs.lr_line);
                        dwarfstring_append_printf_i(&m,
                            " of %d "
                            "are not correct.",stmp);
                        _dwarf_error_string(dbg, error,
                            DW_DLE_LINE_TABLE_LINENO_ERROR,
                            dwarfstring_string(&m));
                        dwarfstring_destructor(&m);
                        regs.lr_line = 0;
                        if (curr_line) {
                            dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                        }
                        _dwarf_free_chain_entries(dbg,head_chain,
                            line_count);
                        return DW_DLV_ERROR;
                    }
                } else {
                    /* DW_LNS_set_subprogram */
                    Dwarf_Unsigned utmp2 = 0;
                    int sires = 0;

                    sires =  read_uword_de( &line_ptr,&utmp2,
                        dbg,error,line_ptr_end);
                    if (sires == DW_DLV_ERROR) {
                        _dwarf_free_chain_entries(dbg,head_chain,
                            line_count);
                        if (curr_line) {
                            dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                        }
                        return DW_DLV_ERROR;
                    }

                    regs.lr_subprogram = utmp2;

#ifdef PRINTING_DETAILS
                    dwarfstring_constructor(&mb);
                    dwarfstring_append_printf_u(&mb,
                        "DW_LNS_set_subprogram new value 0x%"
                        DW_PR_XZEROS DW_PR_DUx ".\n",
                        utmp2);
                    _dwarf_printf(dbg,dwarfstring_string(&mb));
                    dwarfstring_destructor(&mb);
#endif /* PRINTING_DETAILS */
                }
                break;

                /*  Experimental two-level line tables */
            case DW_LNS_set_discriminator:{
                Dwarf_Unsigned utmp2 = 0;
                int sires = 0;

                sires =  read_uword_de( &line_ptr,&utmp2,
                    dbg,error,line_ptr_end);
                if (sires == DW_DLV_ERROR) {
                    _dwarf_free_chain_entries(dbg,head_chain,
                        line_count);
                    if (curr_line) {
                        dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                    }
                    return DW_DLV_ERROR;
                }

                regs.lr_discriminator = utmp2;

#ifdef PRINTING_DETAILS
                dwarfstring_constructor(&mb);
                dwarfstring_append_printf_u(&mb,
                    "DW_LNS_set_discriminator new value 0x%"
                    DW_PR_XZEROS DW_PR_DUx ".\n",
                    utmp2);
                _dwarf_printf(dbg,dwarfstring_string(&mb));
                dwarfstring_destructor(&mb);
#endif /* PRINTING_DETAILS */
                }
                break;

                /*  Experimental two-level line tables */
            case DW_LNS_set_call_context:{
                Dwarf_Unsigned utmp2 = 0;
                int sires = 0;

                sires =  read_uword_de( &line_ptr,&utmp2,
                    dbg,error,line_ptr_end);
                if (sires == DW_DLV_ERROR) {
                    _dwarf_free_chain_entries(dbg,head_chain,
                        line_count);
                    if (curr_line) {
                        dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                    }
                    return DW_DLV_ERROR;
                }

                regs.lr_call_context = utmp2;

#ifdef PRINTING_DETAILS
                dwarfstring_constructor(&mb);
                dwarfstring_append_printf_u(&mb,
                    "DW_LNS_set_call_context new value 0x%"
                    DW_PR_XZEROS DW_PR_DUx ".\n",
                    utmp2);
                _dwarf_printf(dbg,dwarfstring_string(&mb));
                dwarfstring_destructor(&mb);
#endif /* PRINTING_DETAILS */
                }
                break;

                /*  Experimental two-level line tables */
            case DW_LNS_set_address:{
                Dwarf_Unsigned utmp2 = 0;
                int sires = 0;

                sires =  read_uword_de( &line_ptr,&utmp2,
                    dbg,error,line_ptr_end);
                if (sires == DW_DLV_ERROR) {
                    _dwarf_free_chain_entries(dbg,head_chain,
                        line_count);
                    if (curr_line) {
                        dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                    }
                    return DW_DLV_ERROR;
                }

                regs.lr_address = utmp2;
                is_addr_set = true;

#ifdef PRINTING_DETAILS
                dwarfstring_constructor(&mb);
                dwarfstring_append_printf_u(&mb,
                    "DW_LNS_set_address new value 0x%"
                    DW_PR_XZEROS DW_PR_DUx ".\n",
                    utmp2);
                _dwarf_printf(dbg,dwarfstring_string(&mb));
                dwarfstring_destructor(&mb);
#endif /* PRINTING_DETAILS */
                }
                break;

            default:
                dwarfstring m;

                dwarfstring_constructor(&m);
                dwarfstring_append_printf_i(&m,
                    "DW_DLE_LINE_TABLE_BAD "
                    " opcode %d is not recognized.",
                    opcode);
                _dwarf_error_string(dbg, error,
                    DW_DLE_LINE_TABLE_BAD,
                    dwarfstring_string(&m));
                dwarfstring_destructor(&m);
                if (curr_line) {
                    dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                }
                _dwarf_free_chain_entries(dbg,head_chain,
                    line_count);
                return DW_DLV_ERROR;
            }
        } else if (type == LOP_EXTENDED) {
            Dwarf_Unsigned extopcode = 0;
            Dwarf_Unsigned extoplength = 0;
            Dwarf_Unsigned extopcount = 0;

            int extres = 0;

            extres =  read_uword_de( &line_ptr, &extopcode,
                dbg,error,line_ptr_end);
            if (extres == DW_DLV_ERROR) {
                _dwarf_free_chain_entries(dbg,head_chain,
                    line_count);
                if (curr_line) {
                    dwarf_dealloc(dbg,curr_line,DW_DLA_LINE);
                }
                return DW_DLV_ERROR;
            }

            extoplength = 1; /* the extopcode is 1 byte */
            extopcount = 0;

            switch (extopcode) {
            case DW_LNE_end_sequence:
                extopcount = 0;
                break;
            case DW_LNE_set_address:
                extopcount = 1;
                break;
            case DW_LNE_define_file:
                extopcount = 3;
                break;
            case DW_LNE_set_discriminator:
                extopcount = 1;
                break;
            case DW_LNE_set_call_context:
                extopcount = 1;
                break;
            case DW_LNE_negate_all_columns:
                extopcount = 0;
                break;
            case DW_LNE_set_all_columns:
                extopcount = 1;
                break;
            case DW_LNE_set_column:
                extopcount = 1;
                break;
            case DW_LNE_set_isa:
                extopcount = 1;
                break;
            case DW_LNE_set_segment:
                extopcount = 1;
                break;
            case DW_LNE_set_line_base:
                extopcount = 1;
                break;
            case DW_LNE_set_line_range:
                extopcount = 1;
                break;
            case DW_LNE_set_offset:
                extopcount = 1;
                break;
            case DW_LNE_set_prologue_end:
                extopcount = 0;
                break;
            case DW_LNE_set_epilogue_begin:
                extopcount = 0;
                break;
            case DW_LNE_set_ranges_base:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_2:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_4:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_8:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_16:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_32:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_64:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_128:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_256:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_512:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_1024:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_2048:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_4096:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_8192:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_16384:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_32768:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_65536:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_131072:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_262144:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_524288:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_1048576:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_2097152:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_4194304:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_8388608:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_16777216:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_33554432:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_67108864:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_134217728:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_268435456:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_536870912:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_1073741824:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_2147483648:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_4294967296:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_8589934592:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_17179869184:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_34359738368:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_68719476736:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_137438953472:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_274877906944:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_549755813888:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_1099511627776:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_2199023255552:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_4398046511104:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_8796093022208:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_17592186044416:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_35184372088832:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_70368744177664:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_140737488355328:
                extopcount = 1;
                break;
            case DW_LNE_set_ranges_base_28147497671065