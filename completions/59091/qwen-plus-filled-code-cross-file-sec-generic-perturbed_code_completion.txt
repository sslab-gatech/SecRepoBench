// Initialize variables to store the format count, entry types, and entry forms for subprograms.
Dwarf_Unsigned subprog_format_count = 0;
Dwarf_Unsigned *subprog_entry_types = NULL;
Dwarf_Unsigned *subprog_entry_forms = NULL;
Dwarf_Unsigned subprogs_count = 0;

// Check if the current pointer position is within the valid range of the data section.
if (line_ptr >= line_ptr_end) {
    _dwarf_error(dbg, err, DW_DLE_LINE_NUMBER_HEADER_ERROR);
    return DW_DLV_ERROR;
}

// Retrieve the subprogram format count from the current position of the data pointer.
subprog_format_count = *(unsigned char *) line_ptr;
line_context->lc_subprogram_format_count = subprog_format_count;
line_ptr = line_ptr + sizeof(Dwarf_Small);

if (subprog_format_count > total_length) {
    dwarfstring m;
    dwarfstring_constructor(&m);
    dwarfstring_append_printf_u(&m,
        "DW_DLE_DEBUG_LINE_LENGTH_BAD "
        "the subprogram format count of "
        "this line table is too large at %" DW_PR_DUu " bytes",
        subprog_format_count);
    _dwarf_error_string(dbg, err, DW_DLE_DEBUG_LINE_LENGTH_BAD,
        dwarfstring_string(&m));
    dwarfstring_destructor(&m);
    return DW_DLV_ERROR;
}