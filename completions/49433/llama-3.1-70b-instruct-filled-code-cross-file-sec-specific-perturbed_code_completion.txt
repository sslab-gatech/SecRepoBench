for (j = 0; j < TagCount; j++) {
    if (io -> Read(io, &Tag, sizeof(cmsTagEntry), 1)!= 1) {
        return FALSE;
    }

    Tag.offset = _cmsAdjustEndianess32(Tag.offset);
    Tag.size   = _cmsAdjustEndianess32(Tag.size);

    // Check if the tag offset and size are valid and within the profile's header size
    if (Tag.offset + Tag.size > HeaderSize) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Invalid tag offset or size");
        return FALSE;
    }

    // Check for existing tags with matching offsets and sizes to establish links between them
    int existingTagIndex = -1;
    for (int k = 0; k < Icc -> TagCount; k++) {
        if (Icc ->TagOffsets[k] == Tag.offset && Icc ->TagSizes[k] == Tag.size) {
            existingTagIndex = k;
            break;
        }
    }

    if (existingTagIndex!= -1) {
        Icc ->TagLinked[Icc -> TagCount] = Icc ->TagSignature[existingTagIndex];
    } else {
        Icc ->TagLinked[Icc -> TagCount] = (cmsTagSignature) 0;
    }

    Icc ->TagSignature[Icc -> TagCount] = (cmsTagSignature) _cmsAdjustEndianess32(Tag.signature);
    Icc ->TagOffsets[Icc -> TagCount]   = Tag.offset;
    Icc ->TagSizes[Icc -> TagCount]     = Tag.size;

    Icc -> TagCount++;
}