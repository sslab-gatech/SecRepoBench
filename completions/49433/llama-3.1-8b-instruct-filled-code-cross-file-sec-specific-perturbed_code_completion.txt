// Read tag directory
Icc -> TagCount = 0;
for (tagIndex = 0; tagIndex < TagCount; tagIndex++) {
    if (!_cmsReadUInt32Number(io, &Tag.tagSignature)) return FALSE;
    if (!_cmsReadUInt32Number(io, &Tag.offset)) return FALSE;
    if (!_cmsReadUInt32Number(io, &Tag.size)) return FALSE;

    if (Tag.offset + Tag.size > HeaderSize) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Invalid tag offset or size");
        return FALSE;
    }

    if (IsTypeSupported(&TagDescriptor, Tag.type)) {
        Icc -> TagCount++;
        Icc -> TagSignatures[Icc -> TagCount - 1] = Tag.tagSignature;
        Icc -> TagOffsets[Icc -> TagCount - 1] = Tag.offset;
        Icc -> TagSizes[Icc -> TagCount - 1] = Tag.size;
    }

    // Check for existing tags with matching offsets and sizes to establish links between them.
    for (j = 0; j < Icc -> TagCount; j++) {
        if (Tag.offset == Icc -> TagOffsets[j] && Tag.size == Icc -> TagSizes[j]) {
            Icc -> TagLinked[j] = Tag.tagSignature;
            break;
        }
    }
}

// Call SetLinks to update the tag offsets and sizes for linked tags
SetLinks(Icc);