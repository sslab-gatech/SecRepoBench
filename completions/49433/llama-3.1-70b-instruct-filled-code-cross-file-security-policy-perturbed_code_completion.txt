for (tagIndex = 0; tagIndex < TagCount; tagIndex++) {
    if (!_cmsReadTagEntry(io, &Tag)) return FALSE;

    // Validate tag offset and size
    if (_cmsAdjustEndianess32(Tag.offset) + _cmsAdjustEndianess32(Tag.size) > HeaderSize) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Invalid tag offset or size");
        return FALSE;
    }

    // Check if tag already exists
    for (j = 0; j < Icc -> TagCount; j++) {
        if (Icc -> TagOffsets[j] == _cmsAdjustEndianess32(Tag.offset) &&
            Icc -> TagSizes[j] == _cmsAdjustEndianess32(Tag.size)) {
            // Tag already exists, establish link
            Icc -> TagLinked[j] = Tag.tag;
            break;
        }
    }

    // Store tag information
    if (Icc -> TagCount < MAX_TABLE_TAG) {
        Icc -> TagOffsets[Icc -> TagCount] = _cmsAdjustEndianess32(Tag.offset);
        Icc -> TagSizes[Icc -> TagCount] = _cmsAdjustEndianess32(Tag.size);
        Icc -> TagLinked[Icc -> TagCount] = (cmsTagSignature) 0; // Initialize linked tag to 0
        Icc -> TagCount++;
    } else {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Too many tags");
        return FALSE;
    }
}