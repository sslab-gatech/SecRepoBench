for (j = 0; j < TagCount; j++) {
    if (!_cmsReadTagEntry(io, &Tag)) return FALSE;

    // Check if the tag offset and size are valid and within the profile's header size
    if (Tag.offset + Tag.size > HeaderSize) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Invalid tag offset or size");
        return FALSE;
    }

    // Check for existing tags with matching offsets and sizes to establish links between them
    int existingTagIndex = -1;
    for (tagIndex = 0; tagIndex < Icc -> TagCount; tagIndex++) {
        if (Icc ->TagOffsets[tagIndex] == Tag.offset && Icc ->TagSizes[tagIndex] == Tag.size) {
            existingTagIndex = tagIndex;
            break;
        }
    }

    // Store the tag's signature, offset, and size in the profile structure
    Icc ->TagSignatures[Icc -> TagCount] = Tag.signature;
    Icc ->TagOffsets[Icc -> TagCount] = Tag.offset;
    Icc ->TagSizes[Icc -> TagCount] = Tag.size;

    // If a link is found, store the linked tag signature in the profile structure
    if (existingTagIndex!= -1) {
        Icc ->TagLinked[Icc -> TagCount] = Icc ->TagSignatures[existingTagIndex];
    } else {
        Icc ->TagLinked[Icc -> TagCount] = (cmsTagSignature) 0;
    }

    // Increment the tag count in the profile structure
    Icc -> TagCount++;
}