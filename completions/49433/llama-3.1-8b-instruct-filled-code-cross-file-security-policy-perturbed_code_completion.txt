// For each tag, cerify that the offset and size are valid and within the profile's header size.
// If valid, store the tag's signature, offset, and size in the profile structure.
// Check for existing tags with matching offsets and sizes to establish links between them.
// If a link is found, store the linked tag signature in the profile structure.
// Increment the tag count in the profile structure for each successfully processed tag.
for (tagIndex = 0; tagIndex < TagCount; tagIndex++) {
    cmsUInt32Number offset, size;
    cmsTagSignature signature;
    cmsUInt32Number j;

    if (!_cmsReadUInt32Number(io, &offset)) return FALSE;
    if (!_cmsReadUInt32Number(io, &size)) return FALSE;
    if (!_cmsReadUInt32Number(io, &signature)) return FALSE;

    // Validate file as an ICC profile
    if (offset + size > HeaderSize) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Invalid tag size (%d) at offset (%d)", size, offset);
        return FALSE;
    }

    // Check if tag already exists
    for (j = 0; j < Icc -> TagCount; j++) {
        if (Icc -> TagOffsets[j] == offset && Icc -> TagSizes[j] == size) {
            Icc -> TagLinked[tagIndex] = Icc -> TagSignatures[j];
            break;
        }
    }

    // Check if tag type is supported
    if (!IsTypeSupported(&TagDescriptor, signature)) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Unsupported tag type (%d) at offset (%d)", signature, offset);
        return FALSE;
    }

    // Store the tag's signature, offset, and size in the profile structure
    Icc -> TagSignatures[Icc -> TagCount] = signature;
    Icc -> TagOffsets[Icc -> TagCount] = offset;
    Icc -> TagSizes[Icc -> TagCount] = size;
    Icc -> TagLinked[Icc -> TagCount] = 0;

    // Increment the tag count in the profile structure
    Icc -> TagCount++;
}

// Establish links between tags
SetLinks(Icc);