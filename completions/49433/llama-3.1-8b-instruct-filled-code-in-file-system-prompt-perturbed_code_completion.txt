// For each tag, cerify that the offset and size are valid and within the profile's header size.
// If valid, store the tag's signature, offset, and size in the profile structure.
// Check for existing tags with matching offsets and sizes to establish links between them.
// If a link is found, store the linked tag signature in the profile structure.
// Increment the tag count in the profile structure for each successfully processed tag.
for (i=0; i < TagCount; i++) {
    cmsTagEntry Tag;
    cmsUInt32Number Offset, Size;
    cmsTagSignature Sig;

    if (!io -> Read(io, &Tag, sizeof(cmsTagEntry), 1)) return FALSE;

    Sig = _cmsAdjustEndianess32(Tag.sig);
    Offset = _cmsAdjustEndianess32(Tag.offset);
    Size = _cmsAdjustEndianess32(Tag.size);

    if (Offset + Size > HeaderSize) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Tag %d out of range", i);
        continue;
    }

    // Check for existing tags with matching offsets and sizes
    n = _cmsSearchTag(Icc, Sig, FALSE);
    if (n >= 0) {
        // Link to existing tag
        Icc ->TagLinked[i] = Icc ->TagNames[n];
        continue;
    }

    // Store the tag's signature, offset, and size in the profile structure
    Icc ->TagNames[i] = Sig;
    Icc ->TagOffsets[i] = Offset;
    Icc ->TagSizes[i] = Size;
    Icc ->TagCount++;
}