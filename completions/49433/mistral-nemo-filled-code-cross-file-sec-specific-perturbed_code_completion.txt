for (tagIndex = 0; tagIndex < TagCount; tagIndex++) {
    if (!_cmsReadTagEntry(io, &Tag)) return FALSE;
    if (Tag.offset >= HeaderSize) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Tag offset out of range");
        return FALSE;
    }
    if (Tag.size > (HeaderSize - Tag.offset)) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Tag size out of range");
        return FALSE;
    }
    if (_cmsSearchTag(Icc, Tag.signature, TRUE) >= 0) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Duplicate tag signature");
        return FALSE;
    }
    Icc ->TagSignatures[Icc ->TagCount] = Tag.signature;
    Icc ->TagOffsets[Icc ->TagCount] = Tag.offset;
    Icc ->TagSizes[Icc ->TagCount] = Tag.size;
    Icc ->TagLinked[Icc ->TagCount] = 0;
    Icc ->TagCount++;
}
SetLinks(Icc);