for (tagIndex = 0; tagIndex < TagCount; tagIndex++) {

    if (!_cmsReadUInt32Number(io, &Tag.Signature)) return FALSE;
    if (!_cmsReadUInt32Number(io, &Tag.Offset))    return FALSE;
    if (!_cmsReadUInt32Number(io, &Tag.Size))      return FALSE;

    Tag.Signature = _cmsAdjustEndianess32(Tag.Signature);
    Tag.Offset    = _cmsAdjustEndianess32(Tag.Offset);
    Tag.Size      = _cmsAdjustEndianess32(Tag.Size);

    // Ensure offset and size are valid within the profile header size
    if ((Tag.Offset > HeaderSize) ||
        (Tag.Size > HeaderSize)   ||
        (Tag.Offset + Tag.Size > HeaderSize) ||
        (Tag.Offset + Tag.Size < Tag.Offset)) {
        // Not valid, skip this tag
        continue;
    }

    // Store the tag data
    Icc->TagNames[Icc->TagCount]   = (cmsTagSignature) Tag.Signature;
    Icc->TagOffsets[Icc->TagCount] = Tag.Offset;
    Icc->TagSizes[Icc->TagCount]   = Tag.Size;
    Icc->TagLinked[Icc->TagCount]  = 0;

    // Check for existing tags with same offset and size to establish a link
    for (j = 0; j < Icc->TagCount; j++) {
        if (Icc->TagOffsets[j] == Tag.Offset &&
            Icc->TagSizes[j]   == Tag.Size) {
            Icc->TagLinked[Icc->TagCount] = Icc->TagNames[j];
            break;
        }
    }

    Icc->TagCount++;
}