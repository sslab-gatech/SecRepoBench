for (tagIndex = 0; tagIndex < TagCount; tagIndex++) {
    cmsUInt32Number offset, size;
    cmsTagSignature signature;

    if (!_cmsReadUInt32Number(io, &signature)) return FALSE;
    if (!_cmsReadUInt32Number(io, &offset)) return FALSE;
    if (!_cmsReadUInt32Number(io, &size)) return FALSE;

    // Ensure the offset and size are within the profile's header size
    if ((offset + size) > HeaderSize) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Tag %d has invalid offset or size", tagIndex);
        return FALSE;
    }

    // Store the tag's signature, offset, and size in the profile structure
    Icc ->TagSignatures[Icc ->TagCount] = signature;
    Icc ->TagOffsets[Icc ->TagCount] = offset;
    Icc ->TagSizes[Icc ->TagCount] = size;

    // Check for existing tags with matching offsets and sizes to establish links between them
    for (j = 0; j < Icc ->TagCount; j++) {
        if ((Icc ->TagOffsets[j] == offset) && (Icc ->TagSizes[j] == size)) {
            Icc ->TagLinked[Icc ->TagCount] = Icc ->TagSignatures[j];
            break;
        }
    }

    Icc ->TagCount++;
}

// Set links between tags
if (!SetLinks(Icc)) return FALSE;