for (j = 0; j < TagCount; j++) {
        cmsTagEntry TagEntry;

        // Read the tag entry
        if (!_cmsReadTagEntry(io, &TagEntry)) return FALSE;

        // Validate the tag entry
        if (TagEntry.offset + TagEntry.size > HeaderSize) {
            cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Invalid tag offset/size");
            return FALSE;
        }

        // Store the tag information in the profile structure
        Icc->TagSignature[Icc->TagCount] = TagEntry.sig;
        Icc->TagOffsets[Icc->TagCount] = TagEntry.offset;
        Icc->TagSizes[Icc->TagCount] = TagEntry.size;

        // Check for linked tags
        if (TagEntry.linkedSig != 0) {
            Icc->TagLinked[Icc->TagCount] = TagEntry.linkedSig;
        } else {
            Icc->TagLinked[Icc->TagCount] = 0;
        }

        Icc->TagCount++;
    }