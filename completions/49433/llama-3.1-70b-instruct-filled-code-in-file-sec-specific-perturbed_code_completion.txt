for (i=0; i < TagCount; i++) {

    if (!_cmsReadUInt32Number(io, &Icc -> TagNames[i])) return FALSE;
    if (!_cmsReadUInt32Number(io, &Icc -> TagOffsets[i])) return FALSE;
    if (!_cmsReadUInt32Number(io, &Icc -> TagSizes[i])) return FALSE;

    // Check for valid offset and size
    if (Icc -> TagOffsets[i] + Icc -> TagSizes[i] > HeaderSize) {
        cmsSignalError(Icc ->ContextID, cmsERROR_FILE, "Corrupted profile. Tag %d out of range", i);
        return FALSE;
    }

    // Check for existing tags with matching offsets and sizes to establish links between them.
    for (j=0; j < i; j++) {

        if (Icc -> TagOffsets[i] == Icc -> TagOffsets[j] &&
            Icc -> TagSizes[i] == Icc -> TagSizes[j]) {

            Icc -> TagLinked[i] = Icc -> TagNames[j];
            break;
        }
    }

    // If no link is found, store the tag's signature, offset, and size in the profile structure.
    if (j == i) {
        Icc -> TagLinked[i] = (cmsTagSignature) 0;
    }
}