for (tagIndex = 0; tagIndex < TagCount; tagIndex++) {
        cmsUInt32Number offset, size;
        cmsTagSignature sig;

        if (!_cmsReadUInt32Number(io, &offset)) return FALSE;
        if (!_cmsReadUInt32Number(io, &size)) return FALSE;
        if (!_cmsReadUInt32Number(io, (cmsUInt32Number*)&sig)) return FALSE;

        // Validate offset and size
        if (offset + size > HeaderSize) {
            cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Invalid tag offset or size");
            return FALSE;
        }

        // Store the tag information
        Icc->TagNames[Icc->TagCount] = sig;
        Icc->TagOffsets[Icc->TagCount] = offset;
        Icc->TagSizes[Icc->TagCount] = size;
        Icc->TagCount++;
    }