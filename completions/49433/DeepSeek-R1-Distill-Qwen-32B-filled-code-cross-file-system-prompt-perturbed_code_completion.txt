for (j=0; j < TagCount; j++) {

    if (!io -> Read(io, &Tag, sizeof(cmsTagEntry), 1)) {
        return FALSE;
    }

    Tag.signature = _cmsAdjustEndianess32(Tag.signature);
    Tag.offset    = _cmsAdjustEndianess32(Tag.offset);
    Tag.size      = _cmsAdjustEndianess32(Tag.size);

    if (Tag.offset >= HeaderSize || Tag.offset + Tag.size > HeaderSize) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Invalid tag offset/size");
        return FALSE;
    }

    Icc ->TagSignatures[Icc ->TagCount] = Tag.signature;
    Icc ->TagOffsets[Icc ->TagCount]    = Tag.offset;
    Icc ->TagSizes[Icc ->TagCount]      = Tag.size;

    // Check for existing tags with same offset and size
    int link = _cmsSearchTag(Icc, Tag.signature, TRUE);
    if (link >= 0) {
        Icc ->TagLinked[Icc ->TagCount] = Icc ->TagSignatures[link];
    }

    Icc ->TagCount++;
}