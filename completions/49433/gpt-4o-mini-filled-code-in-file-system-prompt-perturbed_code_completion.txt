for (tagIndex = 0; tagIndex < TagCount; tagIndex++) {
        cmsTagEntry Tag;

        if (!_cmsReadUInt32Number(io, &Tag.sig)) return FALSE;
        if (!_cmsReadUInt32Number(io, &Tag.offset)) return FALSE;
        if (!_cmsReadUInt32Number(io, &Tag.size)) return FALSE;

        // Validate the tag's offset and size
        if (Tag.offset + Tag.size > HeaderSize) {
            cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Invalid tag offset/size");
            return FALSE;
        }

        // Store the tag information in the profile structure
        Icc->TagNames[Icc->TagCount] = (cmsTagSignature) _cmsAdjustEndianess32((cmsUInt32Number) Tag.sig);
        Icc->TagOffsets[Icc->TagCount] = _cmsAdjustEndianess32((cmsUInt32Number) Tag.offset);
        Icc->TagSizes[Icc->TagCount] = _cmsAdjustEndianess32((cmsUInt32Number) Tag.size);
        Icc->TagCount++;
    }