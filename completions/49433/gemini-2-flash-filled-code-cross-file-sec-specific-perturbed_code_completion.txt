for (tagIndex = 0; tagIndex < TagCount; tagIndex++) {

        if (io -> Read(io, &Tag, sizeof(cmsTagEntry), 1) != 1) return FALSE;

        cmsTagSignature sig     = (cmsTagSignature) _cmsAdjustEndianess32(Tag.sig);
        cmsUInt32Number offset  = _cmsAdjustEndianess32(Tag.offset);
        cmsUInt32Number size    = _cmsAdjustEndianess32(Tag.size);
        cmsTagSignature Link    = (cmsTagSignature) 0;

        // Check for valid offset and size
        if (offset > HeaderSize || (offset + size) > HeaderSize) {
                cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Tag %x out of profile bounds (%d,%d)", (unsigned int) sig, (int) offset, (int) size);
                continue;
        }

        // Check for zero sizes
        if (size == 0)
        {
             cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Tag %x has zero size, ignored.", (unsigned int) sig);
             continue;
        }


        // Check for duplicated tags, establish links
        for (j=0; j < Icc -> TagCount; j++) {

            if (Icc ->TagOffsets[j] == offset && Icc ->TagSizes[j] == size) {

                Link = Icc -> TagSignatures[j];
                break;
            }
        }

        Icc ->TagSignatures[Icc ->TagCount] = sig;
        Icc ->TagOffsets[Icc ->TagCount]  = offset;
        Icc ->TagSizes[Icc ->TagCount]    = size;
        Icc ->TagLinked[Icc ->TagCount]   = Link;

        Icc -> TagCount++;
    }

    SetLinks(Icc);