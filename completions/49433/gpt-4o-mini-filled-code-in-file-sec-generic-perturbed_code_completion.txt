for (tagIndex = 0; tagIndex < TagCount; tagIndex++) {
        cmsTagEntry tag;

        if (!_cmsReadUInt32Number(io, &tag.sig)) return FALSE;
        if (!_cmsReadUInt32Number(io, &tag.offset)) return FALSE;
        if (!_cmsReadUInt32Number(io, &tag.size)) return FALSE;

        // Validate the tag's offset and size
        if (tag.offset + tag.size > HeaderSize) {
            cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Invalid tag offset/size");
            return FALSE;
        }

        // Store the tag information in the profile structure
        Icc->TagNames[Icc->TagCount] = (cmsTagSignature) _cmsAdjustEndianess32((cmsUInt32Number) tag.sig);
        Icc->TagOffsets[Icc->TagCount] = _cmsAdjustEndianess32((cmsUInt32Number) tag.offset);
        Icc->TagSizes[Icc->TagCount] = _cmsAdjustEndianess32((cmsUInt32Number) tag.size);
        Icc->TagCount++;
    }