for (j=0; j < TagCount; j++) {
        cmsUInt32Number  offset, size;

        if (!_cmsReadUInt32Number(io, &offset)) return FALSE;
        if (!_cmsReadUInt32Number(io, &size)) return FALSE;

        if (offset >= HeaderSize || (offset + size) > HeaderSize) {
            cmsSignalError(Icc ->ContextID, cmsERROR_BAD_TAG, "Tag offset or size is invalid");
            return FALSE;
        }

        if (!_cmsReadTagEntry(io, &Tag)) return FALSE;

        Icc ->TagSignatures[Icc ->TagCount] = Tag.sig;
        Icc ->TagOffsets[Icc ->TagCount]   = offset;
        Icc ->TagSizes[Icc ->TagCount]     = size;
        Icc ->TagLinked[Icc ->TagCount]   = 0;

        Icc ->TagCount++;
    }

    // Set links between tags
    SetLinks(Icc);