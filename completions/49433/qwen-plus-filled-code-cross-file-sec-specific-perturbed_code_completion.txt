for (tagIndex = 0; tagIndex < TagCount; tagIndex++) {
    cmsUInt32Number offset, size;
    cmsTagSignature signature;

    // Read the tag entry
    if (!_cmsReadUInt32Number(io, &signature)) return FALSE;
    if (!_cmsReadUInt32Number(io, &offset)) return FALSE;
    if (!_cmsReadUInt32Number(io, &size)) return FALSE;

    // Validate that the offset and size are within the profile's header size
    if ((offset > HeaderSize) || (size > HeaderSize - offset)) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Invalid tag offset or size");
        return FALSE;
    }

    // Store the tag's signature, offset, and size in the profile structure
    Icc -> Tags[Icc -> TagCount].Signature = signature;
    Icc -> Tags[Icc -> TagCount].Offset = offset;
    Icc -> Tags[Icc -> TagCount].Size = size;

    // Check for existing tags with matching offsets and sizes to establish links between them
    for (j = 0; j < Icc -> TagCount; j++) {
        if ((Icc -> Tags[j].Offset == offset) && (Icc -> Tags[j].Size == size)) {
            Icc -> Tags[Icc -> TagCount].Linked = Icc -> Tags[j].Signature;
            break;
        }
    }

    // Increment the tag count in the profile structure for each successfully processed tag
    Icc -> TagCount++;
}

// Set links between tags
if (!SetLinks(Icc)) {
    cmsSignalError(Icc ->ContextID, cmsERROR_INTERNAL, "Failed to set tag links");
    return FALSE;
}