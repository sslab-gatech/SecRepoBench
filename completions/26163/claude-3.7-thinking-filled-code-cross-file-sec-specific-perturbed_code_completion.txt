int y;
if (ch >= '0' && ch <= '9') {
    y = ch - '0';
} else if (ch >= 'A' && ch <= 'F') {
    y = ch - 'A' + 10;
} else if (ch >= 'a' && ch <= 'f') {
    y = ch - 'a' + 10;
} else {
    return FP_VAL; // Invalid character
}

// Check if we're about to exceed the array size
if (k >= FP_SIZE) {
    return FP_VAL; // Array would overflow
}

// Each digit is 4 bits. We're adding to the array in chunks of 4 bits.
fpnumber->dp[k] |= ((fp_digit)y << j);
j += 4; // Move to the next 4 bits

// If j exceeds the bit size of a digit, move to the next digit
if (j >= DIGIT_BIT) {
    j = 0;
    k++;
}