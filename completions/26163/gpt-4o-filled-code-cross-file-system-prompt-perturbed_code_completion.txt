if (ch >= '0' && ch <= '9') {
          j = ch - '0';
      } else if (ch >= 'A' && ch <= 'F') {
          j = ch - 'A' + 10;
      } else if (ch >= 'a' && ch <= 'f') {
          j = ch - 'a' + 10;
      } else {
          return FP_VAL; // Invalid character for radix 16
      }

      if (k >= FP_SIZE) {
          return FP_VAL; // Exceeds maximum size
      }

      // Shift the current digits left by 4 (equivalent to multiplying by 16)
      for (int n = 0; n <= k; n++) {
          fpnumber->dp[n] <<= 4;
      }

      // Add the new digit
      fpnumber->dp[0] |= j;

      // Propagate carry if necessary
      for (int n = 0; n <= k; n++) {
          if (fpnumber->dp[n] >= (1 << DIGIT_BIT)) {
              if (n + 1 > k) {
                  k++;
              }
              fpnumber->dp[n + 1] += fpnumber->dp[n] >> DIGIT_BIT;
              fpnumber->dp[n] &= ((1 << DIGIT_BIT) - 1);
          }
      }