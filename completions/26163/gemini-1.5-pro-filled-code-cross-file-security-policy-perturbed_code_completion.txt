if (ch >= '0' && ch <= '9') {
        ch -= '0';
      } else if (ch >= 'A' && ch <= 'F') {
        ch -= 'A' - 10;
      } else if (ch >= 'a' && ch <= 'f') {
        ch -= 'a' - 10;
      } else {
        return FP_VAL;
      }

      if (k == 0) {
          fpnumber->dp[0] = ch;
          k = 1;
      } else {
          int idx;
          fp_mul_d(fpnumber, 16, fpnumber);

          idx = 0;
          if (idx < FP_SIZE) {
              fpnumber->dp[idx] += ch;
          } else {
              return FP_VAL;
          }

          if (fpnumber->used < k + 1)
             fpnumber->used = k + 1;
      }