if ((ch >= '0') && (ch <= '9')) {
    ch = ch - '0';
} else if ((ch >= 'A') && (ch <= 'F')) {
    ch = ch - 'A' + 10;
} else if ((ch >= 'a') && (ch <= 'f')) {
    ch = ch - 'a' + 10;
} else {
    return FP_VAL;
}

if (j >= FP_SIZE) {
    return FP_VAL;
}

fpnumber->dp[j] = (fpnumber->dp[j] << 4) | (fp_digit)ch;
j++;
if (j >= FP_SIZE) {
    return FP_VAL;
}
k++;