ch = str[i];
if (ch >= '0' && ch <= '9')
    ch -= '0';
else if (ch >= 'A' && ch <= 'F')
    ch -= 'A' - 10;
else if (ch >= 'a' && ch <= 'f')
    ch -= 'a' - 10;
else
    return FP_VAL;

j = ((DIGIT_BIT >> 2) * i) / (DIGIT_BIT >> 2);
k = ((DIGIT_BIT >> 2) * i) % (DIGIT_BIT >> 2);

fpnumber->dp[j] |= ((fp_digit)ch) << (k * 4);

if (j + 1 >= FP_SIZE)
    return FP_VAL;