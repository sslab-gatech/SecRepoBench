if (ch >= '0' && ch <= '9') {
    ch -= '0';
} else if (ch >= 'A' && ch <= 'F') {
    ch -= 'A' - 10;
} else if (ch >= 'a' && ch <= 'f') {
    ch -= 'a' - 10;
} else {
    return FP_VAL;  // Invalid character
}

// Place the numerical value in the appropriate position
fpnumber->dp[k] |= ((fp_digit)ch) << j;
j += 4;  // Each hex digit occupies 4 bits

// If we've filled the current digit, move to the next
if (j == DIGIT_BIT) {
    // Make sure we don't exceed the maximum number of digits
    if (k >= FP_SIZE - 1) {
        return FP_VAL;  // Overflow
    }
    j = 0;
    k++;
    fpnumber->dp[k] = 0;
}