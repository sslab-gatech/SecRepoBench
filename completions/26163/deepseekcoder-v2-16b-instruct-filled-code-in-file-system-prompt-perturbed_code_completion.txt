_TIME_LIMIT macro.
   */
  #ifndef FP_EXPTMOD_TIME_LIMIT
    #define FP_EXPTMOD_TIME_LIMIT 1000000
  #endif

  /* d = a^b (mod c) - constant time (a < c and b < c and positive) */
  int fp_exptmod_ct(fp_int *a, fp_int *b, fp_int *c, fp_int *d)
  {
    int ret = FP_OKAY;
    int bits = fp_count_bits(b);
    int i, j, k;
    fp_int x[1], y[1], z[1];
    fp_int *x_ptr = NULL, *y_ptr = NULL, *z_ptr = NULL;
    fp_int *tmp_ptr = NULL;

    if (bits > FP_EXPTMOD_TIME_LIMIT) {
      return FP_VAL;
    }

    fp_init(x);
    fp_init(y);
    fp_init(z);

    fp_copy(a, x);
    fp_set_d(y, 1);
    fp_copy(c, z);

    x_ptr = x;
    y_ptr = y;
    z_ptr = z;

    for (i = bits - 2; i >= 0; i--) {
      fp_sqr(x_ptr, x_ptr);
      fp_mod(x_ptr, z_ptr, x_ptr);

      if (fp_is_bit_set(b, i)) {
        fp_mul(x_ptr, a, x_ptr);
        fp_mod(x_ptr, z_ptr, x_ptr);
      }
    }

    fp_copy(y_ptr, d);

    return ret;
  }
#endif

#endif

#endif

#ifdef WOLFSSL_SP_MATH

#ifdef WOLFSSL_HAVE_SP_RSA

#ifdef __cplusplus
extern "C" {
#endif

#ifdef WOLFSSL_SP_MATH_INLINES

#ifdef WOLFSSL_SP_MATH_INLINE
  #define WOLFSSL_SP_MATH_INLINE
#endif

#ifdef WOLFSSL_SP_MATH_INLINE_ALL
  #define WOLFSSL_SP_MATH_INLINE_ALL
#endif

#endif

#ifdef WOLFSSL_SP_MATH_INLINES

#ifdef WOLFSSL_SP_MATH_INLINE

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_MATH_INLINE_ALL

#ifdef WOLFSSL_SP_