{
      fp_digit d;
      if (ch >= '0' && ch <= '9') {
         d = ch - '0';
      }
      else if (ch >= 'A' && ch <= 'F') {
         d = ch - 'A' + 10;
      }
      else if (ch >= 'a' && ch <= 'f') {
         d = ch - 'a' + 10;
      }
      else {
         return FP_VAL;
      }

      if (k >= FP_SIZE) {
         return FP_MEM;
      }

      fpnumber->dp[k] |= ((fp_digit)d << j);
      j += 4;
      if (j >= DIGIT_BIT) {
         j -= DIGIT_BIT;
         k++;
         if (k < FP_SIZE)
            fpnumber->dp[k] = 0;
      }
   }