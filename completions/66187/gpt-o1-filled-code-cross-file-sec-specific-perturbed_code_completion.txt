{
	if ((i + 2 < len)) {
		/* Safely copy the three bytes */
		if (j >= GF_ARRAY_LENGTH(szLineConv)) break;
		szLineConv[j++] = linebuffer[i++];

		if (j >= GF_ARRAY_LENGTH(szLineConv)) break;
		szLineConv[j++] = linebuffer[i++];

		if (j >= GF_ARRAY_LENGTH(szLineConv)) break;
		szLineConv[j++] = linebuffer[i];
	} else {
		/* Not enough data for a 3-byte character, stop parsing */
		break;
	}
}
else if ((linebuffer[i] & 0xf8) == 0xf0)
{
	/* UTF8 4 bytes char */
	if ((i + 3 < len)) {
		/* Safely copy the four bytes */
		if (j >= GF_ARRAY_LENGTH(szLineConv)) break;
		szLineConv[j++] = linebuffer[i++];

		if (j >= GF_ARRAY_LENGTH(szLineConv)) break;
		szLineConv[j++] = linebuffer[i++];

		if (j >= GF_ARRAY_LENGTH(szLineConv)) break;
		szLineConv[j++] = linebuffer[i++];

		if (j >= GF_ARRAY_LENGTH(szLineConv)) break;
		szLineConv[j++] = linebuffer[i];
	} else {
		/* Not enough data for a 4-byte character, stop parsing */
		break;
	}
}