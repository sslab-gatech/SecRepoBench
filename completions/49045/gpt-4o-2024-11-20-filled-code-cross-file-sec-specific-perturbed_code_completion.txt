mrb_int base = 10;
  char buf[65]; // Enough to hold binary representation of a 64-bit integer plus null terminator
  mrb_int len;
  mrb_int num;

  // Get the integer value and optional base argument
  mrb_get_args(mrb, "|i", &base);

  // Validate the base
  if (base < 2 || base > 36) {
    mrb_raise(mrb, E_ARGUMENT_ERROR, "base must be between 2 and 36");
  }

  // Retrieve the integer value from the mrb_value object
  num = mrb_integer(obj);

  // Convert the integer to a string representation in the specified base
  len = snprintf(buf, sizeof(buf), "%lld", (long long)num);
  if (len < 0 || len >= (mrb_int)sizeof(buf)) {
    mrb_raise(mrb, E_RUNTIME_ERROR, "integer to string conversion failed");
  }

  // Return the string as a Ruby object
  return mrb_str_new_cstr(mrb, buf);