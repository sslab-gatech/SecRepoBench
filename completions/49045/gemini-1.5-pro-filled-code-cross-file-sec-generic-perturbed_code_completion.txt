mrb_int base = 10;
  mrb_int value;

  mrb_get_args(mrb, "i|i", &value, &base);

  if (base < 2 || base > 36) {
    mrb_raisef(mrb, E_ARGUMENT_ERROR, "invalid radix %S", mrb_fixnum_value(base));
  }

  char buf[MRB_INT_BIT + 1];
  char *p = &buf[sizeof(buf) - 1];
  *p = '\0';

  if (value == 0) {
    *--p = '0';
  } else {
    while (value != 0) {
      mrb_int digit = value % base;
      value /= base;
      if (digit < 10) {
        *--p = '0' + digit;
      } else {
        *--p = 'a' + (digit - 10);
      }
    }
  }
  return mrb_str_new_cstr(mrb, p);
}