mrb_int base = 10;
mrb_int val;
char *buf;
size_t len;
mrb_value str;

mrb_get_args(mrb, "|i", &base);
if (base < 2 || base > 36) {
  mrb_raisef(mrb, E_ARGUMENT_ERROR, "invalid radix %S", mrb_fixnum_value(base));
}

val = mrb_integer(obj);
buf = mrb_malloc(mrb, 64);
len = mrb_int_to_cstr(buf, 64, val, base);
str = mrb_str_new(mrb, buf, len);
mrb_free(mrb, buf);

return str;