mrb_int base = 10;
  mrb_int i;
  char buf[sizeof(mrb_int) * 3 + 1];
  char *s = buf + sizeof(buf) - 1;
  mrb_value arg;

  mrb_get_args(mrb, "|i", &base);
  if (base < 2 || base > 36) {
    mrb_raise(mrb, E_ARGUMENT_ERROR, "invalid radix");
  }

  i = mrb_integer(obj);
  *s = 0;
  mrb_bool neg = FALSE;
  if (i < 0) {
    neg = TRUE;
    if (i == MRB_INT_MIN) {
      i = -(MRB_INT_MAX + 1);
    } else {
      i = -i;
    }
  }
  if (i == 0) {
    *--s = '0';
  } else {
    while (i > 0) {
      int digit = i % base;
      *--s = (digit < 10) ? '0' + digit : 'a' + digit - 10;
      i /= base;
    }
  }
  if (neg) {
    *--s = '-';
  }

  arg = mrb_str_new_cstr(mrb, s);
  return arg;