char *buf = NULL;
int base = 10;
mrb_get_args(mrb, "|i", &base);
if (base < 2 || base > 36) {
  mrb_raisef(mrb, E_ARGUMENT_ERROR, "invalid radix %S", mrb_fixnum_value(base));
}
buf = (char *)mrb_malloc(mrb, 65); // Allocate a buffer of size 65 to handle the maximum length of a 64-bit integer in base 2
int len = snprintf(buf, 65, "%.*" PRId64, (int)sizeof(mrb_int) * 8 / 3 + 1, (mrb_int)mrb_fixnum(obj));
if (len < 0 || len >= 65) {
  mrb_free(mrb, buf);
  mrb_raise(mrb, E_RUNTIME_ERROR, "integer to string conversion error");
}
mrb_value str = mrb_str_new(mrb, buf, len);
mrb_free(mrb, buf);
return str;