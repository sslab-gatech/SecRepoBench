char *username = NULL;
	size_t username_len = 0;
	int offset = 5;
	if (memcmp(packet->payload, "USER ", 5) == 0) {
	  username_len = strcspn((char *)&packet->payload[offset], " ") - 1;
	  username = (char *)malloc(username_len + 1);
	  if (username == NULL) {
	    NDPI_LOG_ERR(ndpi_struct, "Memory allocation failed\n");
	    return;
	  }
	  strncpy(username, (char *)&packet->payload[offset], username_len);
	  username[username_len] = '\0';
	  NDPI_LOG_INFO(ndpi_struct, "Found IRC username: %s\n", username);
	  free(username);
	  flow->risk_level = NDPI_RISK_LEVEL_HIGH;
	}
	NDPI_LOG_INFO(ndpi_struct, "IRC-related keywords detected\n");