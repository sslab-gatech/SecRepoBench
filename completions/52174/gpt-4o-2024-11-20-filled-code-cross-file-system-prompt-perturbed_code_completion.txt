char username[256] = {0};
if (memcmp(packet->payload, "USER ", 5) == 0) {
  const char *user_start = (const char *)packet->payload + 5;
  size_t user_len = 0;

  while (user_len < sizeof(username) - 1 && user_start[user_len] != ' ' && user_start[user_len] != '\r' && user_start[user_len] != '\n') {
    username[user_len] = user_start[user_len];
    user_len++;
  }
  username[user_len] = '\0';

  NDPI_LOG_INFO(detection_module, "Found IRC username: %s", username);
  flow->risk |= NDPI_FLOW_RISK_CREDENTIALS_LEAKED;
}

NDPI_LOG_INFO(detection_module, "Identified IRC-related keywords (e.g., USER, NICK, PASS, NOTICE, PRIVMSG) at least once.");