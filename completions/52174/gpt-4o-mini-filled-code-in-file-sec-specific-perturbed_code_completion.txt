// Allocate a buffer to hold the username, ensuring it does not exceed the payload length
      char username[256]; // Adjust size as necessary for expected username length
      size_t username_len = 0;

      // Check for "USER " in the payload and extract the username
      if (memcmp(packet->payload, "USER ", 5) == 0) {
        username_len = packet->payload_packet_len - 5; // Length after "USER "
        if (username_len > sizeof(username) - 1) {
          username_len = sizeof(username) - 1; // Prevent overflow
        }
        memcpy(username, packet->payload + 5, username_len);
        username[username_len] = '\0'; // Null-terminate the username
        NDPI_LOG_INFO(detection_module, "Found IRC username: %s", username);
        // Set risk level for the flow
        flow->risk_level = HIGH_RISK; // Define HIGH_RISK appropriately
      }