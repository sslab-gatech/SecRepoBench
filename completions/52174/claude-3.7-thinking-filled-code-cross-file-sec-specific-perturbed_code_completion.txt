if (memcmp(packet->payload, "USER ", 5) == 0) {
  char username[128] = {0}; // Use a reasonably sized buffer
  u_int16_t username_len = 0;
  
  // Extract username (stop at space or end of packet)
  for (i = 5; i < packet->payload_packet_len && packet->payload[i] != ' ' && username_len < sizeof(username) - 1; i++) {
    username[username_len++] = packet->payload[i];
  }
  
  // Ensure null termination
  username[username_len] = '\0';
  
  if (username_len > 0) {
    NDPI_LOG_INFO(detection_module, "found IRC username: %s", username);
    // Set risk for cleartext credentials
    ndpi_set_risk(flow, NDPI_CLEAR_TEXT_CREDENTIALS);
  }
}

NDPI_LOG_DBG2(detection_module, "IRC related keywords (USER, NICK, PASS, NOTICE, PRIVMSG) detected");