if (memcmp(packet->payload, "USER ", 5) == 0) {
  u_int16_t username_len = 0;
  const u_int16_t max_username_len = 32;  // Adjust as needed
  char username[max_username_len + 1];  // +1 for null terminator

  // Find the end of the username (space or newline)
  for (i = 5; i < packet->payload_packet_len && packet->payload[i] != ' ' && packet->payload[i] != '\n'; i++) {
    if (username_len < max_username_len) {
      username[username_len++] = packet->payload[i];
    }
  }

  // Null-terminate the username
  username[username_len] = '\0';

  NDPI_LOG_INFO(detection_module, "Found IRC username: %s", username);
  flow->risk |= NDPI_CLEAR_TEXT_CREDENTIALS;
}

NDPI_LOG_DBG2(detection_module, "IRC-related keywords identified");