// Search for the "USER " string within the packet payload to identify potential IRC usernames.
char *username_start = memmem(packet->payload, packet->payload_packet_len, "USER ", 5);
if (username_start != NULL) {
    username_start += 5; // Skip the "USER " prefix
    char *username_end = strchr(username_start, ' ');
    if (username_end != NULL) {
        size_t username_len = username_end - username_start;
        char username[username_len + 1];
        memcpy(username, username_start, username_len);
        username[username_len] = '\0'; // Null-terminate the username
        NDPI_LOG_INFO(detection_module, "Found IRC username: %s", username);
        flow->risk_level |= NDPI_RISK_CLEAR_TEXT_CREDENTIALS;
        NDPI_LOG_INFO(detection_module, "Found IRC-related keywords (USER, NICK, PASS, NOTICE, PRIVMSG)");
    }
}