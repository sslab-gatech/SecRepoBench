{
  /* Check if the payload starts with "USER " to extract the username */
  if(packet->payload_packet_len > 5 && memcmp(packet->payload, "USER ", 5) == 0) {
    /* Allocate a buffer to store the username, plus one byte for the null terminator */
    char username[128];
    memset(username, 0, sizeof(username));

    /* Parse characters after "USER " until a space or line break */
    size_t start = 5, idx = 0;
    while((start + idx) < packet->payload_packet_len && idx < (sizeof(username) - 1)) {
      char c = packet->payload[start + idx];
      /* Stop if we hit whitespace or a control character */
      if(c == '\r' || c == '\n' || c == ' ' || c == '\t') {
        break;
      }
      username[idx++] = c;
    }
    username[idx] = '\0';

    /* If a username was found, log it and mark the flow as containing clear text credentials */
    if(idx > 0) {
      NDPI_LOG_INFO(detection_module, "Found IRC username: %s", username);
      /* Mark flow risk for containing clear text credentials (symbolic example) */
      flow->risk |= NDPI_FLOW_RISK_CREDENTIALS;
      NDPI_LOG_INFO(detection_module, "Set risk to indicate detection of clear text credentials.");
    }
  }

  /* Log that IRC-related keywords like USER, NICK, PASS, NOTICE, PRIVMSG have been identified */
  NDPI_LOG_INFO(detection_module, "Identified IRC-related keyword ('USER', 'NICK', 'PASS', 'NOTICE', or 'PRIVMSG').");
}