// Search for the "USER " string within the packet payload to identify potential IRC usernames.
// Extract the username following the "USER " keyword and store it in a buffer.
// Null-terminate the username.
// Log a message indicating that an IRC username has been found.
// Set the risk level for the flow to indicate that clear text credentials have been detected.
// Log that IRC-related keywords like USER, NICK, PASS, NOTICE, and PRIVMSG were identified at least once.

u_int16_t username_len = 0;
u_int8_t *username_ptr = NULL;

if (memcmp(packet->payload, "USER ", 5) == 0) {
  username_ptr = packet->payload + 5;
  username_len = packet->payload_packet_len - 5;
  while (username_len > 0 && username_ptr[username_len - 1]!= '\r' && username_ptr[username_len - 1]!= '\n') {
    username_len--;
  }
  username_ptr[username_len] = '\0'; // Null-terminate the username

  NDPI_LOG_INFO(detection_module, "found IRC username: %s", username_ptr);
  flow->risk_level = NDPI_RISK_LEVEL_CLEAR_TEXT_CREDENTIALS;
}

NDPI_LOG_INFO(detection_module, "found IRC-related keywords: USER, NICK, PASS, NOTICE, PRIVMSG");