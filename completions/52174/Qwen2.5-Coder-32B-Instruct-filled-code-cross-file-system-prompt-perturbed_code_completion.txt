if (memcmp(packet->payload, "USER ", 5) == 0) {
  char username[256];
  size_t len = strcspn(packet->payload + 5, " \r\n");
  if (len < sizeof(username)) {
    memcpy(username, packet->payload + 5, len);
    username[len] = '\0';
    NDPI_LOG_INFO(detection_module, "Found IRC username: %s", username);
    flow->risk |= NDPI_CLEAR_TEXT_CREDENTIALS;
  }
}