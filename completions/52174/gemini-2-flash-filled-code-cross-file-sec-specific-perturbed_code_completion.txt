u_int32_t user_offset = 0;
	u_int32_t user_len = 0;
	char username[64] = { 0 };

	if (memcmp(packet->payload, "USER ", 5) == 0) {
	  user_offset = 5;
	  for (i = user_offset; i < packet->payload_packet_len; i++) {
	    if (packet->payload[i] == ' ' || packet->payload[i] == '\r' || packet->payload[i] == '\n') {
	      break;
	    }
	    user_len++;
	  }
	  if (user_len > 0 && user_len < sizeof(username) - 1) {
	    memcpy(username, &packet->payload[user_offset], user_len);
	    username[user_len] = '\0';
	    NDPI_LOG_INFO(detection_module, "Found IRC username: %s", username);
	    NDPI_SET_FLOW_RISK(flow, NDPI_RISK_CLEAR_TEXT_CREDENTIALS);
	  }
	}
	NDPI_LOG_INFO(detection_module, "Identified IRC keywords (USER, NICK, PASS, NOTICE, PRIVMSG) at least once.");