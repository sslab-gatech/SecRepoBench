// Search for the "USER " string within the packet payload to identify potential IRC usernames.
char username[64];
int username_len = 0;
if (memcmp(packet->payload, "USER ", 5) == 0) {
    username_len = ndpi_min(sizeof(username) - 1, packet->payload_packet_len - 5);
    memcpy(username, packet->payload + 5, username_len);
    username[username_len] = '\0';
    NDPI_LOG_INFO(detection_module, "Found IRC username: %s", username);
    flow->risk_level |= NDPI_RISK_CLEAR_TEXT_CREDENTIALS;
}

// Log that IRC-related keywords like USER, NICK, PASS, NOTICE, and PRIVMSG were identified at least once.
flow->l4.tcp.irc_stage = 1;