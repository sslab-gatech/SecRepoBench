{
  char irc_username[128] = {0};

  /* If the payload starts with "USER ", extract the username */
  if(!memcmp(packet->payload, "USER ", 5) && (packet->payload_packet_len > 5)) {
    u_int16_t offset = 5, pos = 0;
    /* Copy characters until encountering space, newline, carriage return, or end of buffer */
    while(offset < packet->payload_packet_len &&
          pos < (sizeof(irc_username) - 1) &&
          packet->payload[offset] != ' ' &&
          packet->payload[offset] != '\r' &&
          packet->payload[offset] != '\n') {
      irc_username[pos++] = packet->payload[offset++];
    }
    irc_username[pos] = '\0';

    /* If a username was found, log it and mark this flow as containing clear text credentials */
    if(pos > 0) {
      NDPI_LOG_INFO(detection_module, "IRC: found username '%s'\n", irc_username);
      flow->risk |= NDPI_CLEAR_TEXT_CREDENTIALS;
    }
  }

  /* Log detection of IRC-related keywords at least once */
  NDPI_LOG_INFO(detection_module,
                "IRC: identified keyword among USER, NICK, PASS, NOTICE, PRIVMSG.\n");
}