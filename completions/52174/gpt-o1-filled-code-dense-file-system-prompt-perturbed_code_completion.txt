{
  #define IRC_MAX_USERNAME_LEN 64

  /* Search for "USER " in the packet payload */
  if(memcmp(packet->payload, "USER ", 5) == 0) {
    char username[IRC_MAX_USERNAME_LEN];
    u_int16_t pos = 5, u_len = 0;

    /* Extract the username until the next space, carriage return, or newline */
    while(pos < packet->payload_packet_len && u_len < (IRC_MAX_USERNAME_LEN - 1) &&
          packet->payload[pos] != ' ' && packet->payload[pos] != '\r' && packet->payload[pos] != '\n') {
      username[u_len++] = packet->payload[pos++];
    }
    username[u_len] = '\0';

    /* If we found a username, log it and set the risk level for clear text credentials */
    if(u_len > 0) {
      NDPI_LOG_INFO(detection_module, "found IRC username: %s", username);
      ndpi_set_risk(detection_module, flow, NDPI_CLEAR_TEXT_CREDENTIALS, "Found IRC username in clear text");
    }
  }

  /* Log that these IRC keywords (USER, NICK, PASS, NOTICE, PRIVMSG, etc.) were identified at least once */
  NDPI_LOG_INFO(detection_module, "found IRC keyword match (e.g., USER, NICK, PASS, NOTICE, PRIVMSG)");
}