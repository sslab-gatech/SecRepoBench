u_int8_t username_len = 0;
u_int8_t *username_ptr = NULL;

if (memcmp(packet->payload, "USER ", 5) == 0) {
  username_ptr = packet->payload + 5;
  username_len = packet->payload_packet_len - 5;
  while (username_len > 0 && *username_ptr =='') {
    username_ptr++;
    username_len--;
  }
  if (username_len > 0) {
    NDPI_LOG_DBG2(detection_module, "found IRC username: %s", username_ptr);
    username_len = (u_int8_t)strnlen(username_ptr, username_len);
    username_ptr[username_len] = '\0';
    NDPI_LOG_INFO(detection_module, "found IRC username: %s", username_ptr);
    flow->risk_level += 1;
    NDPI_LOG_INFO(detection_module, "found irc keywords like USER, NICK, PASS, NOTICE, PRIVMSG at least once.");
  }
}