if (strstr(packet->payload, "USER ") != NULL) {
  char *username_ptr = strstr(packet->payload, "USER ") + 5;
  u_int16_t username_len = packet->payload_packet_len - (username_ptr - packet->payload);
  char username[username_len + 1];
  
  memcpy(username, username_ptr, username_len);
  username[username_len] = '\0';
  
  NDPI_LOG_INFO(detection_module, "Found IRC username: %s", username);
  flow->risk_level |= NDPI_RISK_CLEARTEXT_CREDENTIALS;
  NDPI_LOG_INFO(detection_module, "Detected IRC-related keywords in packet");
}