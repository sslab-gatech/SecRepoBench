char *username = NULL;
	size_t username_len = 0;
	int username_index = 0;

	if (memcmp(packet->payload, "USER ", 5) == 0) {
	  username_index = 5;
	  while (username_index < packet->payload_packet_len && packet->payload[username_index] != ' ') {
	    username_len++;
	    username_index++;
	  }
	  username = (char *)malloc(username_len + 1);
	  if (username == NULL) {
	    NDPI_LOG_ERR(ndpi_struct, "Memory allocation failed\n");
	    return;
	  }
	  memcpy(username, &packet->payload[5], username_len);
	  username[username_len] = '\0';
	  NDPI_LOG_INFO(ndpi_struct, "Found IRC username: %s\n", username);
	  flow->risk_level = NDPI_RISK_HIGH;
	  free(username);
	}
	NDPI_LOG_INFO(ndpi_struct, "IRC-related keywords detected\n");