char username[256];
if (memcmp(packet->payload, "USER ", 5) == 0) {
  const char *user_start = packet->payload + 5;
  size_t user_len = 0;
  while (user_len < sizeof(username) - 1 && user_start[user_len] != ' ' && user_start[user_len] != '\r' && user_start[user_len] != '\n') {
    user_len++;
  }
  memcpy(username, user_start, user_len);
  username[user_len] = '\0';
  NDPI_LOG_INFO(detection_module, "IRC username found: %s", username);
  flow->risk |= NDPI_PROTOCOL_RISK_CREDENTIALS_LEAKED;
  NDPI_LOG_INFO(detection_module, "IRC-related keywords detected: USER, NICK, PASS, NOTICE, PRIVMSG");
}