if (memcmp(packet->payload, "USER ", 5) == 0) {
  char username[32] = {0};
  int username_len = 0;
  
  for (i = 5; i < packet->payload_packet_len - 1 && i < 36; i++) {
    if (packet->payload[i] == ' ' || packet->payload[i] == '\r' || packet->payload[i] == '\n')
      break;
    username[username_len++] = packet->payload[i];
  }
  
  if (username_len > 0) {
    NDPI_LOG_INFO(detection_module, "Found IRC username: %s", username);
    ndpi_set_risk(flow, NDPI_CLEAR_TEXT_CREDENTIALS);
  }
}

NDPI_LOG_DBG2(detection_module, "IRC-related keywords identified");