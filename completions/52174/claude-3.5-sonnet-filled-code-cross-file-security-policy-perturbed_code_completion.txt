if (memcmp(packet->payload, "USER ", 5) == 0) {
  char username[64];
  u_int16_t username_len = ndpi_min(packet->payload_packet_len - 5, sizeof(username) - 1);
  
  strncpy(username, (const char *)&packet->payload[5], username_len);
  username[username_len] = '\0';
  
  NDPI_LOG_INFO(detection_module, "Found IRC username: %s", username);
  flow->risk |= NDPI_CLEAR_TEXT_CREDENTIALS;
}

NDPI_LOG_DBG2(detection_module, "IRC-related keywords detected");