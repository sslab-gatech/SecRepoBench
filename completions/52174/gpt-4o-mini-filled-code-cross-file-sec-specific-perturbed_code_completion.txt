#define MAX_USERNAME_LENGTH 64
char username[MAX_USERNAME_LENGTH] = {0};
size_t username_length = 0;

// Check for "USER " command and extract the username
if (memcmp(packet->payload, "USER ", 5) == 0) {
    username_length = packet->line[0].len - 5; // Length of the username
    if (username_length < MAX_USERNAME_LENGTH) {
        memcpy(username, packet->payload + 5, username_length);
        username[username_length] = '\0'; // Null-terminate the username
        NDPI_LOG_INFO(detection_module, "IRC username found: %s", username);
        flow->risk_level = HIGH_RISK; // Set risk level for clear text credentials
    } else {
        NDPI_LOG_WARN(detection_module, "Username too long, potential overflow risk.");
    }
}