// Search for the "USER " string within the packet payload to identify potential IRC usernames
if (memcmp(packet->payload, "USER ", 5) == 0) {
  u_int16_t userlen = 0;
  
  // Extract the username following the "USER " keyword
  for (i = 5; i < packet->payload_packet_len; i++) {
    if (packet->payload[i] == ' ' || packet->payload[i] == '\r' || packet->payload[i] == '\n') {
      userlen = i - 5;
      break;
    }
  }
  
  if (userlen > 0) {
    // Create a null-terminated username
    char username[256]; // Using a fixed buffer for simplicity
    size_t copy_len = userlen < 255 ? userlen : 255;
    
    strncpy(username, (const char*)&packet->payload[5], copy_len);
    username[copy_len] = '\0';
    
    // Log a message indicating that an IRC username has been found
    NDPI_LOG_INFO(detection_module, "found IRC username: %s", username);
    
    // Set the risk level for the flow to indicate that clear text credentials have been detected
    ndpi_set_risk(detection_module, flow, NDPI_CLEAR_TEXT_CREDENTIALS, "IRC username in clear text");
  }
}
// Check for PASS command which contains password
else if (memcmp(packet->payload, "PASS ", 5) == 0) {
  // Set risk for clear text password
  ndpi_set_risk(detection_module, flow, NDPI_CLEAR_TEXT_CREDENTIALS, "IRC password in clear text");
}

// Log that IRC-related keywords like USER, NICK, PASS, NOTICE, and PRIVMSG were identified at least once
NDPI_LOG_DBG2(detection_module, "found IRC-related keywords");