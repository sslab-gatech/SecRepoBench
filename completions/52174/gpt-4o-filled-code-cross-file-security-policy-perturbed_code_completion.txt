char username[256]; // Buffer to store the username
if (memcmp(packet->payload, "USER ", 5) == 0) {
  // Extract the username following the "USER " keyword
  const char *user_start = packet->payload + 5;
  size_t user_len = 0;
  
  // Calculate the length of the username
  while (user_len < sizeof(username) - 1 && user_start[user_len] != ' ' && user_start[user_len] != '\0') {
    user_len++;
  }
  
  // Copy the username into the buffer and null-terminate it
  strncpy(username, user_start, user_len);
  username[user_len] = '\0';
  
  // Log a message indicating that an IRC username has been found
  NDPI_LOG_INFO(detection_module, "IRC username found: %s", username);
  
  // Set the risk level for the flow to indicate that clear text credentials have been detected
  flow->risk |= NDPI_RISK_CREDENTIALS_LEAKED;
  
  // Log that IRC-related keywords like USER, NICK, PASS, NOTICE, and PRIVMSG were identified at least once
  NDPI_LOG_INFO(detection_module, "IRC-related keywords identified.");
}