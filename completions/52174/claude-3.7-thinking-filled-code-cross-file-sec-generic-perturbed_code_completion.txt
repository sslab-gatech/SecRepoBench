// Handle USER command to extract potential IRC usernames
if (memcmp(packet->payload, "USER ", 5) == 0) {
  char username[128]; // Temporary buffer for username
  u_int16_t username_len = 0;
  
  // Extract username (starting after "USER ")
  for (i = 5; i < packet->payload_packet_len && i - 5 < sizeof(username) - 1; i++) {
    if (packet->payload[i] == ' ' || packet->payload[i] == '\r' || packet->payload[i] == '\n') {
      break;
    }
    username[i - 5] = packet->payload[i];
    username_len++;
  }
  
  if (username_len > 0) {
    username[username_len] = '\0'; // Null-terminate
    NDPI_LOG_INFO(detection_module, "Found IRC username: %s", username);
    // Set risk for clear text credentials
    ndpi_set_risk(flow, NDPI_CLEAR_TEXT_CREDENTIALS, NULL);
  }
}

// Check for password in clear text (PASS command)
if (memcmp(packet->payload, "PASS ", 5) == 0) {
  NDPI_LOG_INFO(detection_module, "Found IRC password in clear text");
  ndpi_set_risk(flow, NDPI_CLEAR_TEXT_CREDENTIALS, NULL);
}

NDPI_LOG_DBG2(detection_module, "IRC related keyword found at least once");