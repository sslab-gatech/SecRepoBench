if ((memcmp(packet->payload, "USER ", 5) == 0)
    || (memcmp(packet->payload, "NICK ", 5) == 0)
    || (memcmp(packet->payload, "PASS ", 5) == 0)
    || (memcmp(packet->payload, ":", 1) == 0 && ndpi_check_for_NOTICE_or_PRIVMSG(detection_module, flow)!= 0)
    || (memcmp(packet->payload, "PONG ", 5) == 0)
    || (memcmp(packet->payload, "PING ", 5) == 0)
    || (memcmp(packet->payload, "JOIN ", 5) == 0)
    || (memcmp(packet->payload, "MODE ", 5) == 0)
    || (memcmp(packet->payload, "NOTICE ", 7) == 0)
    || (memcmp(packet->payload, "PRIVMSG ", 8) == 0)
    || (memcmp(packet->payload, "VERSION ", 8) == 0)) {
  // Search for the "USER " string within the packet payload to identify potential IRC usernames.
  // Extract the username following the "USER " keyword and store it in a buffer.
  // Null-terminate the username.
  // Log a message indicating that an IRC username has been found.
  // Set the risk level for the flow to indicate that clear text credentials have been detected.
  // Log that IRC-related keywords like USER, NICK, PASS, NOTICE, and PRIVMSG were identified at least once.
  char username[256];
  username[0] = '\0';
  for (i = 5; i < packet->payload_packet_len; i++) {
    if (packet->payload[i] =='' || packet->payload[i] == '\n' || packet->payload[i] == '\r') {
      break;
    }
    if (strlen(username) < 255) {
      username[strlen(username)] = packet->payload[i];
      username[strlen(username) + 1] = '\0';
    }
  }
  NDPI_LOG_INFO(detection_module, "found IRC username: %s", username);
  flow->l4.tcp.irc_username = strdup(username);
  flow->risk_level |= NDPI_RISK_CLEARTEXT_CREDENTIALS;
  flow->irc_keywords_identified = 1;
  if (flow->l4.tcp.irc_stage == 0) {
    flow->l4.tcp.irc_stage = 1;
  }
  if (flow->l4.tcp.irc_stage == 1) {
    flow->l4.tcp.irc_stage = 2;
  }
  if (flow->l4.tcp.irc_stage == 2) {
    flow->l4.tcp.irc_stage = 3;
  }
  if (flow->l4.tcp.irc_stage == 3) {
    flow->l4.tcp.irc_stage = 4;
  }
  if (flow->l4.tcp.irc_stage == 4) {
    flow->l4.tcp.irc_stage = 5;
  }
  if (flow->l4.tcp.irc_stage == 5) {
    flow->l4.tcp.irc_stage = 6;
  }
  if (flow->l4.tcp.irc_stage == 6) {
    flow->l4.tcp.irc_stage = 7;
  }
  if (flow->l4.tcp.irc_stage == 7) {
    flow->l4.tcp.irc_stage = 8;
  }
  if (flow->l4.tcp.irc_stage == 8) {
    flow->l4.tcp.irc_stage = 9;
  }
  if (flow->l4.tcp.irc_stage == 9) {
    flow->l4.tcp.irc_stage = 10;
  }
  if (flow->l4.tcp.irc_stage == 10) {
    flow->l4.tcp.irc_stage = 11;
  }
  if (flow->l4.tcp.irc_stage == 11) {
    flow->l4.tcp.irc_stage = 12;
  }
  if (flow->l4.tcp.irc_stage == 12) {
    flow->l4.tcp.irc_stage = 13;
  }
  if (flow->l4.tcp.irc_stage == 13) {
    flow->l4.tcp.irc_stage = 14;
  }
  if (flow->l4.tcp.irc_stage == 14) {
    flow->l4.tcp.irc_stage = 15;
  }
  if (flow->l4.tcp.irc_stage == 15) {
    flow->l4.tcp.irc_stage = 16;
  }
  if (flow->l4.tcp.irc_stage == 16) {
    flow->l4.tcp.irc_stage = 17;
  }
  if (flow->l4.tcp.irc_stage == 17) {
    flow->l4.tcp.irc_stage = 18;
  }
  if (flow->l4.tcp.irc_stage == 18) {
    flow->l4.tcp.irc_stage = 19;
  }
  if (flow->l4.tcp.irc_stage == 19) {
    flow->l4.tcp.irc_stage = 20;
  }
  if (flow->l4.tcp.irc_stage == 20) {
    flow->l4.tcp.irc_stage = 21;
  }
  if (flow->l4.tcp.irc_stage == 21) {
    flow->l4.tcp.irc_stage = 22;
  }
  if (flow->l4.tcp.irc_stage == 22) {
    flow->l4.tcp.irc_stage = 23;
  }
  if (flow->l4.tcp.irc_stage == 23) {
    flow->l4.tcp.irc_stage = 24;
  }
  if (flow->l4.tcp.irc_stage == 24) {
    flow->l4.tcp.irc_stage = 25;
  }
  if (flow->l4.tcp.irc_stage == 25) {
    flow->l4.tcp.irc_stage = 26;
  }
  if (flow->l4.tcp.irc_stage == 26) {
    flow->l4.tcp.irc_stage = 27;
  }
  if (flow->l4.tcp.irc_stage == 27) {
    flow->l4.tcp.irc_stage = 28;
  }
  if (flow->l4.tcp.irc_stage == 28) {
    flow->l4.tcp.irc_stage = 29;
  }
  if (flow->l4.tcp.irc_stage == 29) {
    flow->l4.tcp.irc_stage = 30;
  }
  if (flow->l4.tcp.irc_stage == 30) {
    flow->l4.tcp.irc_stage = 31;
  }
  if (flow->l4.tcp.irc_stage == 31) {
    flow->l4.tcp.irc_stage = 32;
  }
  if (flow->l4.tcp.irc_stage == 32) {
    flow->l4.tcp.irc_stage = 33;
  }
  if (flow->l4.tcp.irc_stage == 33) {
    flow->l4.tcp.irc_stage = 34;
  }
  if (flow->l4.tcp.irc_stage == 34) {
    flow->l4.tcp.irc_stage = 35;
  }
  if (flow->l4.tcp.irc_stage == 35) {
    flow->l4.tcp.irc_stage = 36;
  }
  if (flow->l4.tcp.irc_stage == 36) {
    flow->l4.tcp.irc_stage = 37;
  }
  if (flow->l4.tcp.irc_stage == 37) {
    flow->l4.tcp.irc_stage = 38;
  }
  if (flow->l4.tcp.irc_stage == 38) {
    flow->l4.tcp.irc_stage = 39;
  }
  if (flow->l4.tcp.irc_stage == 39) {
    flow->l4.tcp.irc_stage = 40;
  }
  if (flow->l4.tcp.irc_stage == 40) {
    flow->l4.tcp.irc_stage = 41;
  }
  if (flow->l4.tcp.irc_stage == 41) {
    flow->l4.tcp.irc_stage = 42;
  }
  if (flow->l4.tcp.irc_stage == 42) {
    flow->l4.tcp.irc_stage = 43;
  }
  if (flow->l4.tcp.irc_stage == 43) {
    flow->l4.tcp.irc_stage = 44;
  }
  if (flow->l4.tcp.irc_stage == 44) {
    flow->l4.tcp.irc_stage = 45;
  }
  if (flow->l4.tcp.irc_stage == 45) {
    flow->l4.tcp.irc_stage = 46;
  }
  if (flow->l4.tcp.irc_stage == 46) {
    flow->l4.tcp.irc_stage = 47;
  }
  if (flow->l4.tcp.irc_stage == 47) {
    flow->l4.tcp.irc_stage = 48;
  }
  if (flow->l4.tcp.irc_stage == 48) {
    flow->l4.tcp.irc_stage = 49;
  }
  if (flow->l4.tcp.irc_stage == 49) {
    flow->l4.tcp.irc_stage = 50;
  }
  if (flow->l4.tcp.irc_stage == 50) {
    flow->l4.tcp.irc_stage = 51;
  }
  if (flow->l4.tcp.irc_stage == 51) {
    flow->l4.tcp.irc_stage = 52;
  }
  if (flow->l4.tcp.irc_stage == 52) {
    flow->l4.tcp.irc_stage = 53;
  }
  if (flow->l4.tcp.irc_stage == 53) {
    flow->l4.tcp.irc_stage = 54;
  }
  if (flow->l4.tcp.irc_stage == 54) {
    flow->l4.tcp.irc_stage = 55;
  }
  if (flow->l4.tcp.irc_stage == 55) {
    flow->l4.tcp.irc_stage = 56;
  }
  if (flow->l4.tcp.irc_stage == 56) {
    flow->l4.tcp.irc_stage = 57;
  }
  if (flow->l4.tcp.irc_stage == 57) {
    flow->l4.tcp.irc_stage = 58;
  }
  if (flow->l4.tcp.irc_stage == 58) {
    flow->l4.tcp.irc_stage = 59;
  }
  if (flow->l4.tcp.irc_stage == 59) {
    flow->l4.tcp.irc_stage = 60;
  }
  if (flow->l4.tcp.irc_stage == 60) {
    flow->l4.tcp.irc_stage = 61;
  }
  if (flow->l4.tcp.irc_stage == 61) {
    flow->l4.tcp.irc_stage = 62;
  }
  if (flow->l4.tcp.irc_stage == 62) {
    flow->l4.tcp.irc_stage = 63;
  }
  if (flow->l4.tcp.irc_stage == 63) {
    flow->l4.tcp.irc_stage = 64;
  }
  if (flow->l4.tcp.irc_stage == 64) {
    flow->l4.tcp.irc_stage = 65;
  }
  if (flow->l4.tcp.irc_stage == 65) {
    flow->l4.tcp.irc_stage = 66;
  }
  if (flow->l4.tcp.irc_stage == 66) {
    flow->l4.tcp.irc_stage = 67;
  }
  if (flow->l4.tcp.irc_stage == 67) {
    flow->l4.tcp.irc_stage = 68;
  }
  if (flow->l4.tcp.irc_stage == 68) {
    flow->l4.tcp.irc_stage = 69;
  }
  if (flow->l4.tcp.irc_stage == 69) {
    flow->l4.tcp.irc_stage = 70;
  }
  if (flow->l4.tcp.irc_stage == 70) {
    flow->l4.tcp.irc_stage = 71;
  }
  if (flow->l4.tcp.irc_stage == 71) {
    flow->l4.tcp.irc_stage = 72;
  }
  if (flow->l4.tcp.irc_stage == 72) {
    flow->l4.tcp.irc_stage = 73;
  }
  if (flow->l4.tcp.irc_stage == 73) {
    flow->l4.tcp.irc_stage = 74;
  }
  if (flow->l4.tcp.irc_stage == 74) {
    flow->l4.tcp.irc_stage = 75;
  }
  if (flow->l4.tcp.irc_stage == 75) {
    flow->l4.tcp.irc_stage = 76;
  }
  if (flow->l4.tcp.irc_stage == 76) {
    flow->l4.tcp.irc_stage = 77;
  }
  if (flow->l4.tcp.irc_stage == 77) {
    flow->l4.tcp.irc_stage = 78;
  }
  if (flow->l4.tcp.irc_stage == 78) {
    flow->l4.tcp.irc_stage = 79;
  }
  if (flow->l4.tcp.irc_stage == 79) {
    flow->l4.tcp.irc_stage = 80;
  }
  if (flow->l4.tcp.irc_stage == 80) {
    flow->l4.tcp.irc_stage = 81;
  }
  if (flow->l4.tcp.irc_stage == 81) {
    flow->l4.tcp.irc_stage = 82;
  }
  if (flow->l4.tcp.irc_stage == 82) {
    flow->l4.tcp.irc_stage = 83;
  }
  if