// Buffer to hold the username
      char username[64] = {0}; // Ensure the buffer is large enough
      size_t username_len = 0;

      // Check for "USER " command and extract the username
      if (memcmp(packet->payload, "USER ", 5) == 0) {
        username_len = packet->line[0].len - 5; // Length of the username
        if (username_len < sizeof(username)) {
          memcpy(username, packet->payload + 5, username_len);
          username[username_len] = '\0'; // Null-terminate the username
          NDPI_LOG_INFO(detection_module, "IRC username found: %s", username);
          flow->risk_level = HIGH_RISK; // Set risk level for clear text credentials
        }
      }

      // Log the detection of IRC-related keywords
      NDPI_LOG_INFO(detection_module, "IRC-related keywords detected in packet.");