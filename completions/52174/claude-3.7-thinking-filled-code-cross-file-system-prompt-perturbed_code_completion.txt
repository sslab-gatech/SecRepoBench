if (memcmp(packet->payload, "USER ", 5) == 0) {
  // Extract username
  char username[32] = { 0 };
  u_int16_t username_len = 0;
  
  // Start after "USER " (5 chars)
  i = 5;
  
  // Extract username until space or end of payload
  while (i < packet->payload_packet_len && 
         packet->payload[i] != ' ' && 
         username_len < sizeof(username) - 1) {
    username[username_len++] = packet->payload[i++];
  }
  
  // Null-terminate the username
  username[username_len] = '\0';
  
  NDPI_LOG_INFO(detection_module, "found IRC username: %s", username);
  
  // Set risk for clear text credentials
  ndpi_set_risk(flow, NDPI_CLEAR_TEXT_CREDENTIALS, "IRC username");
}

NDPI_LOG_DBG2(detection_module, "IRC related keyword detected at least once");