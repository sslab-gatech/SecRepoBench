{
  /* Search for username if the packet starts with "USER " */
  if(memcmp(packet->payload, "USER ", 5) == 0) {
    char username[128] = {0};
    u_int16_t idx = 5, pos = 0;
    
    /* Extract the username up to the next space or a newline */
    while(idx < packet->payload_packet_len && pos < (sizeof(username) - 1) &&
          packet->payload[idx] != ' ' && packet->payload[idx] != '\r' && packet->payload[idx] != '\n') {
      username[pos++] = packet->payload[idx++];
    }
    username[pos] = '\0'; /* Null-terminate the username */
    
    if(pos > 0) {
      NDPI_LOG_INFO(detection_module, "Found IRC username: %s", username);
      /* Indicate clear text credentials have been detected (example risk flag) */
      flow->risk |= NDPI_FLOW_RISK_CREDENTIALS;
    }
  }
  NDPI_LOG_INFO(detection_module, "Identified IRC keyword (USER, NICK, PASS, NOTICE, or PRIVMSG).");
}