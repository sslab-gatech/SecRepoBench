if (flow->l4.tcp.irc_stage == 2) {
  NDPI_LOG_INFO(detection_module, "found irc");
  ndpi_int_irc_add_connection(detection_module, flow, NDPI_CONFIDENCE_DPI);
  flow->l4.tcp.irc_stage = 3;
}
if (flow->l4.tcp.irc_stage == 1) {
  NDPI_LOG_DBG2(detection_module, "second time, stage=2");
  flow->l4.tcp.irc_stage = 2;
}
if (flow->l4.tcp.irc_stage == 0) {
  NDPI_LOG_DBG2(detection_module, "first time, stage=1");
  flow->l4.tcp.irc_stage = 1;
}