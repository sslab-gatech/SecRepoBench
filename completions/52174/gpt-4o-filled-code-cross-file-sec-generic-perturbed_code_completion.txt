// Extract the username following the "USER " keyword
        char username[256] = {0}; // Buffer to store the username
        const char *user_ptr = (const char *)packet->payload + 5; // Skip "USER "
        size_t user_len = 0;

        // Copy the username until a space or end of line is encountered
        while (user_len < sizeof(username) - 1 && user_ptr[user_len] != ' ' && user_ptr[user_len] != '\r' && user_ptr[user_len] != '\n') {
          username[user_len] = user_ptr[user_len];
          user_len++;
        }
        username[user_len] = '\0'; // Null-terminate the username

        // Log a message indicating that an IRC username has been found
        NDPI_LOG_INFO(detection_module, "IRC username found: %s", username);

        // Set the risk level for the flow to indicate that clear text credentials have been detected
        flow->risk |= NDPI_RISK_CREDENTIALS_LEAKED;

        // Log that IRC-related keywords like USER, NICK, PASS, NOTICE, and PRIVMSG were identified at least once
        NDPI_LOG_INFO(detection_module, "IRC-related keywords identified in the packet.");