.ptr);

    if(packet->host_line.len > 0) {
      if(packet->host_line.ptr[0] == '[') {
	/* IPv6 address */
	len = packet->host_line.len - 1;
      } else {
	len = packet->host_line.len;
      }

      if(packet->host_line.ptr[len - 1] == ']') {
	/* IPv6 address */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1] == ':') {
	/* Port number */
	len--;
      }

      if(packet->host_line.ptr[len - 1]