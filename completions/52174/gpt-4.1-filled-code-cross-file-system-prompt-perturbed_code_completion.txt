char irc_username[128] = {0};
const char *user_ptr = NULL;
size_t user_len = 0;
if(memcmp(packet->payload, "USER ", 5) == 0) {
  user_ptr = (const char *)packet->payload + 5;
  user_len = 0;
  // Username is up to the next space or end of payload
  while((5 + user_len) < packet->payload_packet_len && user_len < (sizeof(irc_username)-1) && user_ptr[user_len] != ' ' && user_ptr[user_len] != '\r' && user_ptr[user_len] != '\n')
    user_len++;
  memcpy(irc_username, user_ptr, user_len);
  irc_username[user_len] = '\0';
  NDPI_LOG_INFO(detection_module, "IRC username found: %s", irc_username);
  flow->risk |= NDPI_CLEAR_TEXT_CREDENTIALS;
}
NDPI_LOG_INFO(detection_module, "found IRC: USER, NICK, PASS, NOTICE, PRIVMSG at least once");