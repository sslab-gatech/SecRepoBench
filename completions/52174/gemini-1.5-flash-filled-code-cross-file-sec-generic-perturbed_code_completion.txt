u_int8_t *username = NULL;
	size_t username_len = 0;
	int user_found = 0;

	if (memcmp(packet->payload, "USER ", 5) == 0) {
	  username = packet->payload + 5;
	  username_len = strcspn((char *)username, " \r\n");
	  if (username_len > 0) {
	    char username_buffer[256];
	    strncpy(username_buffer, (char *)username, username_len);
	    username_buffer[username_len] = '\0';
	    NDPI_LOG_INFO(detection_module, "Found IRC username: %s", username_buffer);
	    ndpi_set_flow_risk_level(detection_module, flow, NDPI_RISK_LEVEL_CREDENTIALS_DETECTED);
	    user_found = 1;
	  }
	}

	if (user_found ||
	    (memcmp(packet->payload, "NICK ", 5) == 0) ||
	    (memcmp(packet->payload, "PASS ", 5) == 0) ||
	    (memcmp(packet->payload, ":", 1) == 0 && ndpi_check_for_NOTICE_or_PRIVMSG(detection_module, flow) != 0) ||
	    (memcmp(packet->payload, "PONG ", 5) == 0) ||
	    (memcmp(packet->payload, "PING ", 5) == 0) ||
	    (memcmp(packet->payload, "JOIN ", 5) == 0) ||
	    (memcmp(packet->payload, "MODE ", 5) == 0) ||
	    (memcmp(packet->payload, "NOTICE ", 7) == 0) ||
	    (memcmp(packet->payload, "PRIVMSG ", 8) == 0) ||
	    (memcmp(packet->payload, "VERSION ", 8) == 0)) {
	  NDPI_LOG_INFO(detection_module, "IRC-related keywords (USER, NICK, PASS, NOTICE, PRIVMSG, etc.) identified.");
	}