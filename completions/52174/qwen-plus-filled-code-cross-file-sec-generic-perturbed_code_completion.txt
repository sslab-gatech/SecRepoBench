u_int8_t username_found = 0;
u_int8_t username_buffer[128] = {0}; // Assuming a max username length of 128 characters for safety
u_int8_t *username_ptr = packet->payload + 5; // Start after "USER " keyword
u_int16_t username_len = packet->payload_packet_len - 5;

// Ensure we don't exceed the payload bounds
if(username_len > sizeof(username_buffer) - 1) {
  username_len = sizeof(username_buffer) - 1;
}

// Copy the potential username into the buffer and null-terminate it
memcpy(username_buffer, username_ptr, username_len);
username_buffer[username_len] = '\0';

// Log a message indicating that an IRC username has been found
NDPI_LOG_INFO(detection_module, "IRC username detected: %s", username_buffer);

// Set the risk level for the flow to indicate that clear text credentials have been detected
NDPI_SET_RISK(flow, NDPI_CLEAR_TEXT_CREDENTIALS);

// Log that IRC-related keywords like USER, NICK, PASS, NOTICE, and PRIVMSG were identified at least once
NDPI_LOG_INFO(detection_module, "IRC-related keywords (USER, NICK, PASS, NOTICE, PRIVMSG) identified in the packet.");