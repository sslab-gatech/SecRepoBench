{
  #define IRC_USERNAME_MAX 63
  char username[IRC_USERNAME_MAX + 1];
  u_int16_t k = 0;
  if (packet->payload_packet_len > 5) {
    const u_int8_t *p = packet->payload + 5;
    u_int16_t remaining = packet->payload_packet_len - 5;
    /* Copy characters until a delimiter is found or max length is reached */
    while (k < IRC_USERNAME_MAX && remaining > 0 &&
           p[0] != ' ' && p[0] != '\r' && p[0] != '\n') {
      username[k++] = p[0];
      p++;
      remaining--;
    }
    username[k] = '\0';
    NDPI_LOG_INFO(detection_module, "Found IRC username: %s", username);
    /* Set the risk level to indicate clear text IRC credentials were detected.
       (Assuming a field named `irc_risk_level` exists in the tcp sub-structure.) */
    flow->l4.tcp.irc_risk_level = NDPI_CONFIDENCE_DPI;
    NDPI_LOG_INFO(detection_module, "IRC-related keywords (USER, NICK, PASS, NOTICE, PRIVMSG) identified.");
  }
}