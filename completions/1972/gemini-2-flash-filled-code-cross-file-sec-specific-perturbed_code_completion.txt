switch (content->type) {
        case XML_ELEMENT_CONTENT_PCDATA:
            strcat(buf, "#PCDATA");
            break;
        case XML_ELEMENT_CONTENT_ELEMENT:
            if ((content->prefix != NULL) && (content->name != NULL)) {
                int total_len = strlen(content->prefix) + strlen(content->name) + 2;
                if (capacity - len < total_len) {
                    if ((capacity - len > 4) && (buf[len - 1] != '.'))
                        strcat(buf, " ...");
                    if (englob)
                        strcat(buf, ")");
                    goto end_content;
                }
                strcat(buf, content->prefix);
                strcat(buf, ":");
                strcat(buf, content->name);

            } else if (content->name != NULL) {
                int name_len = strlen(content->name) + 1;
                if (capacity - len < name_len) {
                    if ((capacity - len > 4) && (buf[len - 1] != '.'))
                        strcat(buf, " ...");
                    if (englob)
                        strcat(buf, ")");
                    goto end_content;
                }
                strcat(buf, content->name);
            }
            break;
        case XML_ELEMENT_CONTENT_SEQ:
            xmlSnprintfElementContent(buf, capacity, content->c1, 1);
            len = strlen(buf);
            if (capacity - len < 5) {
                if ((capacity - len > 4) && (buf[len - 1] != '.'))
                    strcat(buf, " ...");
                if (englob)
                    strcat(buf, ")");
                goto end_content;
            }
            strcat(buf, ", ");
            xmlSnprintfElementContent(buf, capacity, content->c2, 1);
            break;
        case XML_ELEMENT_CONTENT_OR:
            xmlSnprintfElementContent(buf, capacity, content->c1, 1);
            len = strlen(buf);
            if (capacity - len < 5) {
                if ((capacity - len > 4) && (buf[len - 1] != '.'))
                    strcat(buf, " ...");
                if (englob)
                    strcat(buf, ")");
                goto end_content;
            }
            strcat(buf, " | ");
            xmlSnprintfElementContent(buf, capacity, content->c2, 1);
            break;
        default:
            break;
    }
end_content: