{
    int curr_len = strlen(buf);
    int avail = capacity - curr_len;

    switch (content->type) {
        case XML_ELEMENT_CONTENT_PCDATA:
            /* Append literal "#PCDATA" */
            snprintf(buf + curr_len, avail, "#PCDATA");
            break;
        case XML_ELEMENT_CONTENT_ELEMENT:
            /* Append the element name, optionally with namespace prefix */
            if (content->prefix && content->prefix[0] != '\0')
                snprintf(buf + curr_len, avail, "%s:%s", content->prefix, content->name);
            else
                snprintf(buf + curr_len, avail, "%s", content->name);
            break;
        case XML_ELEMENT_CONTENT_SEQ:
            /* Process both sub-elements with a comma delimiter */
            xmlSnprintfElementContent(buf, capacity, content->c1, 1);
            curr_len = strlen(buf);
            avail = capacity - curr_len;
            strncat(buf, ",", avail - 1);
            xmlSnprintfElementContent(buf, capacity, content->c2, 1);
            break;
        case XML_ELEMENT_CONTENT_OR:
            /* Process both sub-elements with a pipe delimiter */
            xmlSnprintfElementContent(buf, capacity, content->c1, 1);
            curr_len = strlen(buf);
            avail = capacity - curr_len;
            strncat(buf, "|", avail - 1);
            xmlSnprintfElementContent(buf, capacity, content->c2, 1);
            break;
        default:
            /* Do nothing for unknown types */
            break;
    }
}