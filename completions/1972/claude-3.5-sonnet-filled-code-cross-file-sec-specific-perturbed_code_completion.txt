switch (content->type) {
    case XML_ELEMENT_CONTENT_PCDATA:
        if (capacity - len > 7) {
            strncat(buf, "#PCDATA", capacity - len - 1);
            buf[capacity - 1] = '\0';
        }
        break;
    case XML_ELEMENT_CONTENT_ELEMENT:
        if (content->prefix != NULL && capacity - len > 3) {
            strncat(buf, content->prefix, capacity - len - 1);
            strncat(buf, ":", capacity - len - 1);
        }
        if (content->name != NULL) {
            strncat(buf, content->name, capacity - len - 1);
        }
        buf[capacity - 1] = '\0';
        break;
    case XML_ELEMENT_CONTENT_SEQ:
    case XML_ELEMENT_CONTENT_OR:
        if (content->c1 != NULL) {
            xmlSnprintfElementContent(buf, capacity, content->c1, 1);
        }
        if (content->c2 != NULL) {
            len = strlen(buf);
            if (capacity - len > 2) {
                strncat(buf, (content->type == XML_ELEMENT_CONTENT_SEQ) ? "," : "|", capacity - len - 1);
                xmlSnprintfElementContent(buf, capacity, content->c2, 1);
            }
        }
        break;
}