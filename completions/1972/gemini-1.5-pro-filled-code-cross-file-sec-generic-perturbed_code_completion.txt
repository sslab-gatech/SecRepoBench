switch (content->type) {
    case XML_ELEMENT_CONTENT_PCDATA:
        if (len + 8 > capacity) {
            if ((capacity - len > 4) && (buf[len - 1] != '.'))
                strcat(buf, " ...");
            return;
        }
	strcat(buf, "#PCDATA");
	break;
    case XML_ELEMENT_CONTENT_ELEMENT:
        if (content->name != NULL) {
            int qnameLen;
            if (content->prefix != NULL) {
                qnameLen = strlen((const char *)content->prefix) + 1 + strlen((const char *)content->name) + 1;
                if (len + qnameLen > capacity) {
                    if ((capacity - len > 4) && (buf[len - 1] != '.'))
                        strcat(buf, " ...");
                    return;
                }
                strcat(buf, (const char *)content->prefix);
                strcat(buf, ":");
                strcat(buf, (const char *)content->name);
            } else {
                qnameLen = strlen((const char *)content->name) + 1;
                if (len + qnameLen > capacity) {
                    if ((capacity - len > 4) && (buf[len - 1] != '.'))
                        strcat(buf, " ...");
                    return;
                }
                strcat(buf, (const char *)content->name);
            }
        }
	break;
    case XML_ELEMENT_CONTENT_SEQ:
	xmlSnprintfElementContent(buf, capacity, content->c1, 1);
        if (len + 3 > capacity) {
            if ((capacity - len > 4) && (buf[len - 1] != '.'))
                strcat(buf, " ...");
            return;
        }
	strcat(buf, ", ");
	xmlSnprintfElementContent(buf, capacity, content->c2, 1);
	break;
    case XML_ELEMENT_CONTENT_OR:
	xmlSnprintfElementContent(buf, capacity, content->c1, 1);
        if (len + 3 > capacity) {
            if ((capacity - len > 4) && (buf[len - 1] != '.'))
                strcat(buf, " ...");
            return;
        }
	strcat(buf, " | ");
	xmlSnprintfElementContent(buf, capacity, content->c2, 1);
	break;
    }