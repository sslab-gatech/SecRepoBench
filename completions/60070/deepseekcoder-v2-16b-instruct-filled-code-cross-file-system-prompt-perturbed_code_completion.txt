if (methodlen > 0 && methodlen <= NDPI_MAX_METHOD_LEN) {
    memcpy(flow->method, method, methodlen);
    flow->method_len = methodlen;
    flow->risk |= NDPI_BITMASK_RISK_PROTOCOL;
  } else {
    flow->risk |= NDPI_BITMASK_RISK_PROTOCOL;
    flow->method[0] = '\0';
    flow->method_len = 0;
  }