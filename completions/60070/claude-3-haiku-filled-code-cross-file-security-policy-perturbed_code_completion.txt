if (methodlen > 0 && methodlen < sizeof(flow->method)) {
    strncpy(flow->method, method, methodlen);
    flow->method[methodlen] = '\0'; // Ensure null termination
} else {
    flow->method[0] = '\0'; // Clear the method field
    NDPI_SET_BIT(flow->risk, NDPI_FLOW_RISK_INVALID_THRIFT_METHOD);
}