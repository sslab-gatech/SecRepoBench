if (method != NULL && methodlen > 0 && methodlen < sizeof(flow->thrift.method)) {
    memcpy(flow->thrift.method, method, methodlen);
    flow->thrift.method[methodlen] = '\0';
  } else {
    NDPI_LOG_DBG(ndpi_struct, "Invalid Thrift method, setting risk flag.\n");
    NDPI_ADD_RISK(ndpi_struct, flow, NDPI_PROTOCOL_THRIFT, NDPI_SEVERITY_LOW, "Invalid Thrift method");
    flow->thrift.method[0] = '\0';
  }