static void thrift_set_method(struct ndpi_detection_module_struct *ndpi_struct,
                              struct ndpi_flow_struct *flow,
                              char const * const method, size_t methodlen)
{
  if (thrift_validate_method(method, methodlen) == 0) {
    ndpi_set_risk(ndpi_struct, flow, NDPI_MALFORMED_PACKET, "Invalid method");
    flow->protos.thrift.method = NULL;
  } else {
    flow->protos.thrift.method = ndpi_strdup(ndpi_struct, method, methodlen);
  }
}