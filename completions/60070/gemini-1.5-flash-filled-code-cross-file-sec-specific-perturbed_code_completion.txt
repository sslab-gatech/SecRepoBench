if (methodlen > NDPI_FLOW_METHOD_MAXLEN) {
    ndpi_set_risk_flag(ndpi_struct, flow, NDPI_RISK_FLAG_INVALID_METHOD);
    flow->method[0] = '\0';
  } else {
    memcpy(flow->method, method, methodlen);
    flow->method[methodlen] = '\0';
  }