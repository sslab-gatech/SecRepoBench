if (method != NULL && methodlen > 0 && methodlen < sizeof(flow->method)) {
    memcpy(flow->method, method, methodlen);
    flow->method[methodlen] = '\0';
} else {
    flow->risk = 1;  /* mark the flow as risky */
    flow->method[0] = '\0';
}