// Copy the method name into the flow's method field if the method is valid.
// If the method is invalid, set a risk flag and clear the flow->protos.thrift.method field.
if (thrift_validate_method(method, methodlen)) {
    ndpi_strlcpy(flow->protos.thrift.method, method, sizeof(flow->protos.thrift.method));
} else {
    ndpi_set_risk(ndpi_struct, flow, NDPI_MALFORMED_PACKET, "Invalid Thrift method name");
    flow->protos.thrift.method[0] = '\0';
}