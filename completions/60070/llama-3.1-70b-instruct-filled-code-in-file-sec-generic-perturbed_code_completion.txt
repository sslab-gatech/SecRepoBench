if (thrift_validate_method(method, methodlen) == 1) {
  if (methodlen > 0) {
    strncpy(flow->protos.thrift.method, method, sizeof(flow->protos.thrift.method) - 1);
    flow->protos.thrift.method[sizeof(flow->protos.thrift.method) - 1] = '\0';
  } else {
    flow->protos.thrift.method[0] = '\0';
  }
} else {
  ndpi_set_risk(ndpi_struct, flow, NDPI_MALFORMED_PACKET, "Invalid method name");
  flow->protos.thrift.method[0] = '\0';
}