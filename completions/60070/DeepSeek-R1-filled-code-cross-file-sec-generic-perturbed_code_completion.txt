if (method && methodlen > 0 && methodlen <= 256) {
    size_t len = methodlen < sizeof(flow->method) ? methodlen : sizeof(flow->method) - 1;
    memcpy(flow->method, method, len);
    flow->method[len] = '\0';
} else {
    flow->risk |= NDPI_RISK_INVALID_THRIFT_METHOD;
    flow->method[0] = '\0';
}