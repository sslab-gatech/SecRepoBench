if (method && (methodlen > 0) && (methodlen < sizeof(flow->thrift_method))) {
    memcpy(flow->thrift_method, method, methodlen);
    flow->thrift_method[methodlen] = '\0';
} else {
    flow->risk |= NDPI_THRIFT_INVALID_METHOD;
    flow->thrift_method[0] = '\0';
}