if(method != NULL && methodlen > 0 && methodlen < sizeof(flow->thrift_method)) {
    memcpy(flow->thrift_method, method, methodlen);
    flow->thrift_method[methodlen] = '\0';
} else {
    /* Invalid method: set the risk flag and clear the method string */
    flow->risk_flags |= NDPI_RISK_INVALID_METHOD;
    memset(flow->thrift_method, 0, sizeof(flow->thrift_method));
}