if (method != NULL && methodlen > 0 && methodlen <= sizeof(flow->thrift_method) - 1) {
    strncpy(flow->thrift_method, method, sizeof(flow->thrift_method) - 1);
    flow->thrift_method[sizeof(flow->thrift_method) - 1] = '\0';
  } else {
    flow->risk_flags |= NDPI_RISK_FLAG_INVALID_THRIFT_METHOD;
    flow->thrift_method[0] = '\0';
  }