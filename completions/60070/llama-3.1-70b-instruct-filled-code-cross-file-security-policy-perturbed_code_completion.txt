if (methodlen > 0 && methodlen <= sizeof(flow->thrift_method)) {
  size_t copy_len = methodlen < sizeof(flow->thrift_method) - 1? methodlen : sizeof(flow->thrift_method) - 1;
  strncpy(flow->thrift_method, method, copy_len);
  flow->thrift_method[copy_len] = '\0';
} else {
  flow->thrift_method[0] = '\0';
  ndpi_set_protocol_detected_bit(&ndpi_struct->detection_bitmask, NDPI_PROTOCOL_UNKNOWN);
}