// Copy the method name into the flow's method field if the method is valid.
  // If the method is invalid, set a risk flag and clear the flow's method field.
  if (thrift_validate_method(method, methodlen)) {
    ndpi_set_flow_payload(ndpi_struct, flow, method, methodlen);
  } else {
    ndpi_set_risk(ndpi_struct, flow, NDPI_MALFORMED_PACKET, "Invalid method name");
    flow->protos.thrift.method = NULL;
  }