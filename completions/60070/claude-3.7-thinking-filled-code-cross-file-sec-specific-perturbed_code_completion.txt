if (method != NULL && methodlen > 0 && methodlen < sizeof(flow->protos.thrift.method)) {
  // Method is valid, copy it into the flow
  memset(flow->protos.thrift.method, 0, sizeof(flow->protos.thrift.method));
  memcpy(flow->protos.thrift.method, method, methodlen);
} else {
  // Method is invalid, set risk flag and clear the method field
  memset(flow->protos.thrift.method, 0, sizeof(flow->protos.thrift.method));
  ndpi_set_risk(ndpi_struct, flow, NDPI_MALFORMED_PACKET);
}