if (methodlen > 0 && methodlen <= NDPI_MAX_METHOD_LEN) {
    memcpy(flow->thrift_method, method, methodlen);
    flow->thrift_method[methodlen] = '\0';
} else {
    ndpi_set_risk(ndpi_struct, flow, NDPI_RISK_INVALID_THRIFT_METHOD);
    flow->thrift_method[0] = '\0';
}