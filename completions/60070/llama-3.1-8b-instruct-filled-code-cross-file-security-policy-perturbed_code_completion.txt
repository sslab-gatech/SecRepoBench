static void thrift_set_method(struct ndpi_detection_module_struct *ndpi_struct,
                              struct ndpi_flow_struct *flow,
                              char const * const method, size_t methodlen)
{
  if (methodlen > NDPI_MAX_METHOD_NAME_LENGTH) {
    methodlen = NDPI_MAX_METHOD_NAME_LENGTH;
  }

  strncpy(flow->method, method, methodlen);
  flow->method[methodlen] = '\0';

  if (methodlen == 0 || methodlen > NDPI_MAX_METHOD_NAME_LENGTH) {
    flow->risk = 1;
    memset(flow->method, 0, NDPI_MAX_METHOD_NAME_LENGTH);
  }
}