if (methodlen > 0 && methodlen < sizeof(flow->method)) {
    memcpy(flow->method, method, methodlen);
    flow->method[methodlen] = '\0'; // Null-terminate the string
  } else {
    flow->risk |= NDPI_THREAT_INVALID_METHOD;
    memset(flow->method, 0, sizeof(flow->method));
  }