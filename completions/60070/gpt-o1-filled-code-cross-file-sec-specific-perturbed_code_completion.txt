{
  if (method == NULL || methodlen == 0 || methodlen >= sizeof(flow->method)) {
    NDPI_SET_FLOW_RISK(ndpi_struct, flow, NDPI_FLOW_RISK_APACHE_THRIFT);
    flow->method[0] = '\0';
  } else {
    memcpy(flow->method, method, methodlen);
    flow->method[methodlen] = '\0';
  }
}