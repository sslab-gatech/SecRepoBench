if (method != NULL && methodlen > 0 && methodlen <= NDPI_FLOW_METHOD_MAXLEN) {
    memcpy(flow->method, method, methodlen);
    flow->method[methodlen] = '\0';
  } else {
    flow->risk_flags |= NDPI_RISK_INVALID_METHOD;
    flow->method[0] = '\0';
  }