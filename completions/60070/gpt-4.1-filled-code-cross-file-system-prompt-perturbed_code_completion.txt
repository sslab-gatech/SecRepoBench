if(method != NULL && methodlen > 0 && methodlen < sizeof(flow->thrift.method)) {
    memcpy(flow->thrift.method, method, methodlen);
    flow->thrift.method[methodlen] = '\0';
} else {
    flow->thrift.risk |= NDPI_THIFT_RISK_INVALID_METHOD;
    flow->thrift.method[0] = '\0';
}