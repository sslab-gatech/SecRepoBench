if (method == NULL || methodlen == 0 || methodlen >= sizeof(flow->method)) {
    flow->method[0] = '\0';
    ndpi_set_risk(ndpi_struct, flow, NDPI_INVALID_CHARACTERS);
} else {
    memcpy(flow->method, method, methodlen);
    flow->method[methodlen] = '\0';
}