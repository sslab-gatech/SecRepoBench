if (methodlen > 0 && methodlen < sizeof(flow->method)) {
  memcpy(flow->method, method, methodlen);
  flow->method[methodlen] = '\0';
} else {
  flow->method[0] = '\0';
  NDPI_SET_RISK(flow, NDPI_RISK_INVALID_THRIFT_METHOD);
}