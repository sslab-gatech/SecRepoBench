if (thrift_validate_method(method, methodlen) == 0) {
  ndpi_set_risk(ndpi_struct, flow, NDPI_MALFORMED_PACKET, "Invalid method name");
  flow->protos.thrift.method[0] = '\0';
} else {
  size_t method_copy_len = methodlen < sizeof(flow->protos.thrift.method) - 1? methodlen : sizeof(flow->protos.thrift.method) - 1;
  strncpy(flow->protos.thrift.method, method, method_copy_len);
  flow->protos.thrift.method[method_copy_len] = '\0';
}