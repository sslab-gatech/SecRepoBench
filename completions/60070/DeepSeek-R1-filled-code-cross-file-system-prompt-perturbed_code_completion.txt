if (methodlen == 0 || methodlen >= sizeof(flow->protos.thrift.method)) {
    flow->risk |= NDPI_ILLEGAL_PROTOCOL;
    flow->protos.thrift.method[0] = '\0';
    flow->protos.thrift.method_len = 0;
} else {
    memcpy(flow->protos.thrift.method, method, methodlen);
    flow->protos.thrift.method[methodlen] = '\0';
    flow->protos.thrift.method_len = methodlen;
}