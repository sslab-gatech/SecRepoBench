static void thrift_set_method(struct ndpi_detection_module_struct *ndpi_struct,
                              struct ndpi_flow_struct *flow,
                              char const * const method, size_t methodlen)
{
  if (methodlen > NDPI_MAX_METHOD_LENGTH) {
    NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
    return;
  }

  if (methodlen > 0) {
    memcpy(flow->method, method, methodlen);
    flow->method[methodlen] = '\0';
  } else {
    memset(flow->method, 0, NDPI_MAX_METHOD_LENGTH);
  }
}