if (thrift_validate_method(method, methodlen)) {
    if (methodlen >= sizeof(flow->protos.thrift.method))
        methodlen = sizeof(flow->protos.thrift.method) - 1;
    memcpy(flow->protos.thrift.method, method, methodlen);
    flow->protos.thrift.method[methodlen] = '\0';
} else {
    ndpi_set_risk(ndpi_struct, flow, NDPI_MALFORMED_PACKET, "Invalid method name");
    memset(flow->protos.thrift.method, 0, sizeof(flow->protos.thrift.method));
}