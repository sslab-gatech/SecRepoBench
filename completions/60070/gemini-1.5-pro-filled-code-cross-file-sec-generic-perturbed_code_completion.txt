if (method != NULL && methodlen > 0 && methodlen <= MAX_METHOD_LEN) {
    memcpy(flow->thrift_method, method, methodlen);
    flow->thrift_method[methodlen] = '\0';
  } else {
    flow->detected_protocol_risk |= NDPI_PROTOCOL_RISK_INVALID_DATA;
    memset(flow->thrift_method, 0, sizeof(flow->thrift_method));
  }