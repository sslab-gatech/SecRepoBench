if(method == NULL || methodlen == 0 || methodlen >= sizeof(flow->protos.thrift.method)) {
    NDPI_SET_BIT(flow->risk, NDPI_MALFORMED_PACKET);
    memset(flow->protos.thrift.method, 0, sizeof(flow->protos.thrift.method));
  } else {
    strncpy(flow->protos.thrift.method, method, methodlen);
    flow->protos.thrift.method[methodlen] = '\0';
  }