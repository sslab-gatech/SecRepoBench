if (method != NULL && methodlen > 0 && methodlen < sizeof(flow->thrift_method)) {
    memcpy(flow->thrift_method, method, methodlen);
    flow->thrift_method[methodlen] = '\0';
  } else {
    NDPI_ADD_PROTOCOL_TO_BITMASK(flow->risk_flags, NDPI_RISK_MALFORMED_THRIFT_METHOD);
    flow->thrift_method[0] = '\0';
  }