if (methodlen > 0 && method != NULL) {
  strncpy(flow->method, method, sizeof(flow->method) - 1);
  flow->method[sizeof(flow->method) - 1] = '\0'; // Ensure null-termination
} else {
  flow->risk |= NDPI_FLOW_RISK_INVALID_METHOD;
  memset(flow->method, 0, sizeof(flow->method));
}