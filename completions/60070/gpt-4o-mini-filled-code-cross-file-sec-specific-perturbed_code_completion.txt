if (methodlen > MAX_METHOD_LENGTH) {
    // Set risk flag for invalid method length
    flow->risk_flag = 1;
    flow->method[0] = '\0'; // Clear the method field
} else {
    // Safely copy the method into the flow's method field
    memcpy(flow->method, method, methodlen);
    flow->method[methodlen] = '\0'; // Null-terminate the string
}