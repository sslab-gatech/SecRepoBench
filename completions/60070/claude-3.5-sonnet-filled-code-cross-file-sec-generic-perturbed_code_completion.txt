if (method && methodlen > 0 && methodlen <= sizeof(flow->protos.thrift.method) - 1) {
    memcpy(flow->protos.thrift.method, method, methodlen);
    flow->protos.thrift.method[methodlen] = '\0';
} else {
    flow->risk |= NDPI_MALFORMED_PACKET;
    memset(flow->protos.thrift.method, 0, sizeof(flow->protos.thrift.method));
}