if (method_length > 0 && thrift_validate_method(method, method_length)) {
    if (method_length <= sizeof(flow->protos.thrift.method)) {
      memcpy(flow->protos.thrift.method, method, method_length);
      flow->protos.thrift.method[method_length] = '\0';
    } else {
      ndpi_set_risk(ndpi_struct, flow, NDPI_APPLICATION_RISK, "Apache Thrift method name too long");
      memset(flow->protos.thrift.method, 0, sizeof(flow->protos.thrift.method));
    }
  } else {
    ndpi_set_risk(ndpi_struct, flow, NDPI_MALFORMED_PACKET, "Invalid method characters");
    memset(flow->protos.thrift.method, 0, sizeof(flow->protos.thrift.method));
  }