if (thrift_validate_method(method, methodlen)) {
    strncpy(flow->protos.thrift.method, method, methodlen);
    flow->protos.thrift.method[methodlen] = '\0'; // Ensure null-termination
  } else {
    ndpi_set_risk(ndpi_struct, flow, NDPI_MALFORMED_PACKET, "Invalid method name");
    flow->protos.thrift.method[0] = '\0'; // Clear the method field
  }