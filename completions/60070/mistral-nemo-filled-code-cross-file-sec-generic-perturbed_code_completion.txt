if (methodlen > NDPI_MAX_METHOD_LENGTH) {
    NDPI_LOG_WARNING(ndpi_struct, "Method length exceeds maximum allowed length. Potential risk of buffer overflow.\n");
    flow->risk = 1;
    flow->method[0] = '\0';
  } else {
    memcpy(flow->method, method, methodlen);
    flow->method[methodlen] = '\0';
  }