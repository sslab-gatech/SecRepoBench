if (method != NULL && methodlen > 0) {
    size_t copy_length = (methodlen < sizeof(flow->method) - 1) ? methodlen : sizeof(flow->method) - 1;
    strncpy(flow->method, method, copy_length);
    flow->method[copy_length] = '\0'; // Null-terminate the string
} else {
    flow->method[0] = '\0'; // Clear the method field
    flow->risk_flag = 1; // Set risk flag
}