if (thrift_validate_method(method, method_length) == 0) {
    ndpi_set_risk(ndpi_struct, flow, NDPI_MALFORMED_PACKET, "Invalid method name");
    flow->protos.thrift.method_length = 0;
    memset(flow->protos.thrift.method, 0, sizeof(flow->protos.thrift.method));
  } else {
    flow->protos.thrift.method_length = method_length;
    if (method_length > sizeof(flow->protos.thrift.method)) {
      method_length = sizeof(flow->protos.thrift.method) -1;
    }
    memcpy(flow->protos.thrift.method, method, method_length);
    flow->protos.thrift.method[method_length] = '\0';
  }