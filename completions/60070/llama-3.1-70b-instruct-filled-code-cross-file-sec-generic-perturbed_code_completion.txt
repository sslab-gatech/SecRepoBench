if (methodlen > 0 && methodlen <= sizeof(flow->thrift_method)) {
  memcpy(flow->thrift_method, method, methodlen);
  flow->thrift_method[methodlen] = '\0';
} else {
  flow->risk_flags |= NDPI_RISK_FLAG_INVALID_METHOD;
  flow->thrift_method[0] = '\0';
}