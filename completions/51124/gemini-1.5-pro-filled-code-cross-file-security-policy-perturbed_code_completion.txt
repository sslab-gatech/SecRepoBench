if (cond[cond_index] != ']') {
  if (cond[cond_index] != strip[i]) {
    HUNSPELL_WARNING(stderr,
                     "warning: line %d: incompatible stripping "
                     "characters and condition\n",
                     linenum);
    return 0;
  }
} else {
  if (cond_index <= 0) {
     HUNSPELL_WARNING(stderr,
                         "error: line %d: missing [ in condition:\n%s\n",
                         linenum, cond.c_str());
     return 0;
  }
  neg = (cond[cond_index - 1] == '^') ? 1 : 0;
  in = 0;
  int j = cond_index - 2; // Added initialization for j
  if (j >= 0) { // Security check for j
    do {
      if (strip[i] == cond[j]) {
        in = 1;
        break; // Exit loop once a match is found
      }
    } while (j > 0 && cond[j] != '[' && j-- > 0); // Security check for j in loop condition
  }

  if (j < 0 || cond[j] != '[') { // Check if '[' was found
      HUNSPELL_WARNING(stderr,
                       "error: line %d: missing [ in condition:\n%s\n",
                       linenum, cond.c_str());
      return 0;
  }

  if ((!neg && !in) || (neg && in)) {
    HUNSPELL_WARNING(stderr,
                     "warning: line %d: incompatible stripping "
                     "characters and condition\n",
                     linenum);
    return 0;
  }
}