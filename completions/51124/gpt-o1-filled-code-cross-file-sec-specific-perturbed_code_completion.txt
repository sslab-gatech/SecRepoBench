if (cond[cond_index] != ']') {
          // Simple character comparison
          if (strip[i] != cond[cond_index]) {
            HUNSPELL_WARNING(stderr,
                             "warning: line %d: incompatible stripping "
                             "characters and condition\n",
                             linenum);
            return 0;
          }
        } else {
          // Parse bracket expression in reverse
          int bracket_end = cond_index;
          int bracket_start = bracket_end - 1;
          while (bracket_start >= 0 && cond[bracket_start] != '[') {
            bracket_start--;
          }
          if (bracket_start < 0) {
            HUNSPELL_WARNING(stderr,
                             "error: line %d: missing [ in condition:\n%s\n",
                             linenum, cond.c_str());
            return 0;
          }
          neg = 0;
          // Check for negation
          if ((bracket_start + 1) < bracket_end && cond[bracket_start + 1] == '^') {
            neg = 1;
          }
          in = 0;
          // Check if strip[i] is in the bracket set
          for (int k = bracket_start + 1 + neg; k < bracket_end; k++) {
            if (strip[i] == cond[k]) {
              in = 1;
              break;
            }
          }
          // Evaluate presence vs negation
          if ((!neg && !in) || (neg && in)) {
            HUNSPELL_WARNING(stderr,
                             "warning: line %d: incompatible stripping "
                             "characters and condition\n",
                             linenum);
            return 0;
          }
          // Move cond_index to skip the bracket expression
          cond_index = bracket_start - 1;
        }