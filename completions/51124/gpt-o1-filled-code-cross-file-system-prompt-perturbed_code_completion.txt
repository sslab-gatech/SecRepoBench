if (cond[cond_index] != ']') {
  // Compare characters directly
  if (cond[cond_index] != strip[i]) {
    HUNSPELL_WARNING(stderr,
                     "warning: line %d: incompatible stripping "
                     "characters and condition\n",
                     linenum);
    return 0;
  }
} else {
  // We have a bracket expression to parse
  neg = 0;
  in = 0;
  // Check for negation immediately before ']'
  if ((cond_index > 0) && (cond[cond_index - 1] == '^')) {
    neg = 1;
    cond_index--;
  }
  // Look backwards for matching '['
  int bracket_pos = -1;
  for (int j = cond_index - 1; j >= 0; j--) {
    if (cond[j] == '[') {
      bracket_pos = j;
      break;
    }
    // Check if strip[i] is in the bracketed character set
    if (strip[i] == cond[j]) {
      in = 1;
    }
  }
  // If no '[' found, it's an error
  if (bracket_pos < 0) {
    HUNSPELL_WARNING(stderr,
                     "error: line %d: missing [ in condition:\n%s\n",
                     linenum, cond.c_str());
    return 0;
  }
  // Adjust cond_index to continue parsing after the bracket expression
  cond_index = bracket_pos - 1;
  // Check if presence of strip[i] in set matches negation
  if ((!neg && !in) || (neg && in)) {
    HUNSPELL_WARNING(stderr,
                     "warning: line %d: incompatible stripping "
                     "characters and condition\n",
                     linenum);
    return 0;
  }
}