// If an existing ID is found in the table for the given value, update the
// attribute and its associated ID structure. Ensure that any previous
// association between an attribute and the ID is cleared, and establish
// a new link between the current attribute and the ID. Set the attribute
// type to indicate that it is an ID and return from the function.
{
    // Clear any previous association between the attribute and the ID
    if (ret->attr != NULL) {
        ret->attr->id = NULL;
        ret->attr->atype = XML_ATTRIBUTE_NORMAL;
    }

    // Establish a new link between the current attribute and the ID
    ret->attr = attribute;
    attribute->id = ret;
    attribute->atype = XML_ATTRIBUTE_ID;

    // Update the ID structure
    ret->doc = doc;
    ret->value = xmlStrdup(value);
    if (ret->value == NULL) {
        xmlFreeID(ret);
        return(-1);
    }

    // Update the line number
    ret->lineno = xmlGetLineNo(attribute->parent);

    if (id != NULL)
        *id = ret;

    return(1);
}