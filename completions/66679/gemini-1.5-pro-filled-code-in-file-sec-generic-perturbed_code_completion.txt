{
            if (attr != NULL) {
                xmlErrValidNode(ctxt, attr->parent, XML_DTD_ID_REDEFINED,
                    "ID %s already defined\n", value, NULL, NULL);
                return (0);
            }
	    if (streaming) {
		/*
		 * in streaming mode the attribute will disappear, so
		 * we need to keep a copy of the name
		 */
		if (doc->dict != NULL)
		    ret->name = xmlDictLookup(doc->dict, attribute->name, -1);
		else
		    ret->name = xmlStrdup(attribute->name);
                if (ret->name == NULL) {
                    xmlVErrMemory(ctxt);
                    return(-1);
                }
	    } else {
		ret->attr = attribute;
	    }
            ret->lineno = xmlGetLineNo(attribute->parent);
            if (id != NULL)
                *id = ret;
            attribute->atype = XML_ATTRIBUTE_ID;
            return(1);
        }