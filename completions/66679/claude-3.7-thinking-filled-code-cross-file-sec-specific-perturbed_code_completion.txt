{
    // Update the existing ID to point to the new attribute
    if (streaming) {
        // In streaming mode, update the name
        if (ret->name != NULL) {
            xmlFree(ret->name);
        }
        if (doc->dict != NULL) {
            ret->name = xmlDictLookup(doc->dict, attribute->name, -1);
        } else {
            ret->name = xmlStrdup(attribute->name);
        }
        if (ret->name == NULL) {
            return(-1); // Memory allocation error
        }
        ret->attr = NULL;
    } else {
        // In normal mode, clear any previous association and set the new one
        if (ret->attr != NULL) {
            ret->attr->id = NULL; // Unlink the old attribute from the ID
        }
        if (ret->name != NULL) {
            xmlFree(ret->name);
            ret->name = NULL;
        }
        ret->attr = attribute; // Link to the new attribute
        attribute->id = ret; // Link the attribute to the ID
    }
    
    // Update the line number
    ret->lineno = xmlGetLineNo(attribute->parent);
    
    // Set the attribute type to indicate it's an ID
    attribute->atype = XML_ATTRIBUTE_ID;
    
    // Set the output parameter if provided
    if (id != NULL) {
        *id = ret;
    }
    
    return(1); // Success
}