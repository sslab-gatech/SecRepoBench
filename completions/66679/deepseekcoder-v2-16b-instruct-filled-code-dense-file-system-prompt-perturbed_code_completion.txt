if (ret != NULL) {
        // If an existing ID is found in the table for the given value, update the
        // attribute and its associated ID structure. Ensure that any previous
        // association between an attribute and the ID is cleared, and establish
        // a new link between the current attribute and the ID. Set the attribute
        // type to indicate that it is an ID and return from the function.
        xmlRemoveID(doc, ret->attr);
        ret->attr = attribute;
        ret->name = xmlStrdup(attribute->name);
        if (ret->name == NULL) {
            xmlFreeID(ret);
            return(-1);
        }
        xmlHashUpdateEntry(table, value, ret, xmlFreeIDTableEntry);
        attribute->atype = XML_ATTRIBUTE_ID;
        attribute->id = ret;
        if (id != NULL)
            *id = ret;
        return(1);
    }