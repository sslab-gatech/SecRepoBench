bool result = true;

if (!_populate_subset_glyphs (context->plan, font, glyphs))
  return_trace (false);

bool use_short_loca = true;
for (const auto &g : glyphs)
  use_short_loca &= g.is_short_loca ();

glyf new_glyf;
if (!new_glyf.serialize (context->serializer, glyphs.iter (), use_short_loca, context->plan))
  result = false;

if (font)
  _free_compiled_subset_glyphs (glyphs);

return_trace (result);