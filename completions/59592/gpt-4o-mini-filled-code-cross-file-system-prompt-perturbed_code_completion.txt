hb_glyph_info_t *glyph_info = nullptr;
    hb_glyph_position_t *glyph_position = nullptr;
    unsigned int num_glyphs = 0;

    // Populate the subset glyphs based on the context plan
    if (!context->plan->get_subset_glyphs(&glyph_info, &glyph_position, &num_glyphs)) {
      DEBUG_MSG(SUBSET, nullptr, "failed to get subset glyphs.");
      if (font) hb_font_destroy(font);
      return_trace(false);
    }

    // Create a new glyf object for serialization
    glyf *new_glyf = new glyf();
    if (!new_glyf->initialize(num_glyphs)) {
      DEBUG_MSG(SUBSET, nullptr, "failed to initialize glyf object.");
      if (font) hb_font_destroy(font);
      return_trace(false);
    }

    // Serialize the subset glyphs into the glyf object
    if (!new_glyf->serialize(glyph_info, glyph_position, num_glyphs, context->plan->loca_format)) {
      DEBUG_MSG(SUBSET, nullptr, "failed to serialize glyf object.");
      delete new_glyf;
      if (font) hb_font_destroy(font);
      return_trace(false);
    }

    // Cleanup resources
    delete[] glyph_info;
    delete[] glyph_position;
    if (font) hb_font_destroy(font);

    // Return the result of the serialization process
    result = new_glyf->finalize();