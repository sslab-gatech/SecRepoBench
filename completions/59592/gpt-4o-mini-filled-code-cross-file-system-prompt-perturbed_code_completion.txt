hb_glyph_info_t *subset_glyphs = nullptr;
    unsigned int num_subset_glyphs = 0;

    // Populate the subset glyphs based on the context plan
    if (!populate_subset_glyphs(context, &subset_glyphs, &num_subset_glyphs)) {
      DEBUG_MSG(SUBSET, nullptr, "failed to populate subset glyphs.");
      if (font) _destroy_font(font);
      return_trace(false);
    }

    // Create a new glyf object for serialization
    hb_glyf_t *glyf = new hb_glyf_t();
    if (!glyf) {
      DEBUG_MSG(SUBSET, nullptr, "failed to create glyf object.");
      if (font) _destroy_font(font);
      return_trace(false);
    }

    // Serialize the subset glyphs into the glyf object
    bool result = serialize_subset_glyphs(glyf, subset_glyphs, num_subset_glyphs, context->plan);
    if (!result) {
      DEBUG_MSG(SUBSET, nullptr, "failed to serialize subset glyphs.");
      delete glyf;
      if (font) _destroy_font(font);
      return_trace(false);
    }

    // Cleanup resources
    delete[] subset_glyphs;
    if (font) _destroy_font(font);

    // Return the result of the serialization process
    return result;