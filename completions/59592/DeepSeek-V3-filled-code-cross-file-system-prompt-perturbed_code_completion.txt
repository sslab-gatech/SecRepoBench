hb_vector_t<SubsetGlyph> subset_glyphs;
    if (!_populate_subset_glyphs (context->plan, font, subset_glyphs))
      return_trace (false);

    if (font)
      hb_font_destroy (font);

    bool use_short_loca = _calculate_padded_offsets (subset_glyphs);

    glyf *glyf_prime = context->serializer->start_embed<glyf> ();
    if (unlikely (!glyf_prime)) return_trace (false);

    bool result = _serialize_subset_glyphs (context, subset_glyphs, use_short_loca);

    for (auto &glyph : subset_glyphs)
      glyph.free_compiled_bytes ();