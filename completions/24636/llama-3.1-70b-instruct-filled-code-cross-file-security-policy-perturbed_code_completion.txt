if (decodercontext->has_ppm) {
    if (bytestream2_get_bytes_left(&decodercontext->packed_headers_stream) < 2) {
        av_log(decodercontext->avctx, AV_LOG_ERROR, "Missing PPM data\n");
        return AVERROR_INVALIDDATA;
    }
    bytestream2_init(&decodercontext->packed_headers_stream, decodercontext->packed_headers, decodercontext->packed_headers_size);
}

if (decodercontext->has_ppt && decodercontext->tile[decodercontext->curtileno].tp_idx == 0) {
    if (bytestream2_get_bytes_left(&decodercontext->g) < 2) {
        av_log(decodercontext->avctx, AV_LOG_ERROR, "Missing PPT data\n");
        return AVERROR_INVALIDDATA;
    }
    bytestream2_init(&decodercontext->packed_packet_stream, decodercontext->packed_packets, decodercontext->packed_packets_size);
}

int tp_size = bytestream2_get_be32(&decodercontext->g);
if (bytestream2_get_bytes_left(&decodercontext->g) < tp_size) {
    av_log(decodercontext->avctx, AV_LOG_ERROR, "Invalid tile-part size\n");
    return AVERROR_INVALIDDATA;
}
bytestream2_skip(&decodercontext->g, tp_size);