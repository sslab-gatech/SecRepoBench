if (decodercontext->has_ppm && decodercontext->in_tile_headers) {
                if (bytestream2_get_bytes_left(&decodercontext->packed_headers_stream) < 4) {
                    av_log(decodercontext->avctx, AV_LOG_ERROR, "packed header stream is too short\n");
                    return AVERROR_INVALIDDATA;
                }
                bytestream2_init(&tp->g, tp->data, bytestream2_get_be32u(&decodercontext->packed_headers_stream));
            } else if (decodercontext->has_ppt && tile->tp_idx == 0) {
                if (bytestream2_get_bytes_left(&decodercontext->g) < 4) {
                    av_log(decodercontext->avctx, AV_LOG_ERROR, "Missing packet header size\n");
                    return AVERROR_INVALIDDATA;
                }
                bytestream2_init(&tp->g, tp->data, bytestream2_get_be32u(&decodercontext->g));
            } else {
                bytestream2_init(&tp->g, tp->data, tp->tp_end - tp->data);
            }
            bytestream2_skip(&tp->g, tp->tp_end - decodercontext->g.buffer);
            continue;