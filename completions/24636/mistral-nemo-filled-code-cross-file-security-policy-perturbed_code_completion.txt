if (bytestream2_get_bytes_left(&decodercontext->g) < 2) {
        av_log(decodercontext->avctx, AV_LOG_ERROR, "Insufficient bytes left in the buffer for tile-part headers.\n");
        return AVERROR_INVALIDDATA;
    }

    if (decodercontext->has_ppm) {
        bytestream2_init(&decodercontext->packed_headers_stream, decodercontext->packed_headers, decodercontext->packed_headers_size);
    }

    if (decodercontext->in_tile_headers) {
        Jpeg2000Tile *tile = decodercontext->tile + decodercontext->curtileno;
        Jpeg2000TilePart *tp = tile->tile_part + tile->tp_idx;

        if (tp->tp_end < decodercontext->g.buffer) {
            av_log(decodercontext->avctx, AV_LOG_ERROR, "Invalid tpend for the current tile-part.\n");
            return AVERROR_INVALIDDATA;
        }

        // Calculate the size of the current tile-part and skip to its end in the buffer.
        int tile_part_size = tp->tp_end - decodercontext->g.buffer;
        bytestream2_skip(&decodercontext->g, tile_part_size);
    }