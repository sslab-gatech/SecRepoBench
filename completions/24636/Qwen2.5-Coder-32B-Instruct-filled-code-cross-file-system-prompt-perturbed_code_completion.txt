if (decodercontext->has_ppm) {
    bytestream2_init(&tp->headers, tp->tp_start, tp->tp_end - tp->tp_start);
} else if (decodercontext->has_ppt) {
    bytestream2_init(&tp->headers, decodercontext->packed_headers, decodercontext->packed_headers_size);
} else {
    bytestream2_init(&tp->headers, tp->tp_start, tp->tp_end - tp->tp_start);
}

if ((ret = init_tile(decodercontext, decodercontext->curtileno)) < 0)
    return ret;

ret = jpeg2000_decode_packets_po_iteration(decodercontext, tile, 0, 0,
                                           codsty->nreslevels, codsty->nreslevels,
                                           decodercontext->ncomponents, poc->prog_order, &tp->tp_index);
if (ret < 0)
    return ret;

decodercontext->curtileno++;