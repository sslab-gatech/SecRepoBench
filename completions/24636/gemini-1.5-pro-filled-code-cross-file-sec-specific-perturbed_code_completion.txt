if (decodercontext->has_ppm) {
                bytestream2_init(&tp->tphs_bs, tp->tphs, tp->tphs_len);
            } else if (tile->tp_idx == 0 && decodercontext->has_ppt) {
                bytestream2_init(&tile->pphs_bs, tile->pphs, tile->pphs_len);
            }

            if (tp->tp_end > decodercontext->g.buffer_end) {
                av_log(decodercontext->avctx, AV_LOG_ERROR, "Invalid tpend\n");
                return AVERROR_INVALIDDATA;
            }
            tp->data_len = tp->tp_end - bytestream2_tell(&decodercontext->g);
            bytestream2_skip(&decodercontext->g, tp->data_len);
            continue;