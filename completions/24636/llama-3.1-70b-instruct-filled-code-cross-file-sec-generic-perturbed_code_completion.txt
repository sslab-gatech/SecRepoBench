if (decodercontext->has_ppm) {
    bytestream2_init(&decodercontext->packed_headers_stream, decodercontext->packed_headers, decodercontext->packed_headers_size);
    bytestream2_init(&decodercontext->tile_part_headers_stream, decodercontext->tile_part_headers, decodercontext->tile_part_headers_size);
} else if (decodercontext->has_ppt) {
    bytestream2_init(&decodercontext->packed_packet_headers_stream, decodercontext->packed_packet_headers, decodercontext->packed_packet_headers_size);
}

if (decodercontext->tile_part_headers_size) {
    bytestream2_init(&decodercontext->tile_part_headers_stream, decodercontext->tile_part_headers, decodercontext->tile_part_headers_size);
}

int64_t tile_part_size = bytestream2_get_be64(&decodercontext->g);
if (tile_part_size > INT_MAX || bytestream2_get_bytes_left(&decodercontext->g) < tile_part_size) {
    av_log(decodercontext->avctx, AV_LOG_ERROR, "Invalid tile-part size\n");
    return AVERROR_INVALIDDATA;
}

decodercontext->tile_part_end = decodercontext->g.buffer + tile_part_size;