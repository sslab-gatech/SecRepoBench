if (tile->tp_idx == 0 && decodercontext->has_ppt) {
                if (tp->ppt_data) {
                    bytestream2_init(&decodercontext->packed_headers_stream, tp->ppt_data, tp->ppt_size);
                    decodercontext->has_ppt = 0; // Reset flag after initialization
                } else {
                    av_log(decodercontext->avctx, AV_LOG_ERROR, "Missing PPT data\n");
                    return AVERROR_INVALIDDATA;
                }
            }

            if (bytestream2_get_bytes_left(&decodercontext->g) < (tp->tp_end - bytestream2_tell(&decodercontext->g))) {
                av_log(decodercontext->avctx, AV_LOG_ERROR, "Invalid SOD\n");
                return AVERROR_INVALIDDATA;
            }

            bytestream2_init(&tp->data, tp->tp_start, tp->tp_end - tp->tp_start);
            bytestream2_skip(&decodercontext->g, tp->tp_end - bytestream2_tell(&decodercontext->g));
            continue;