if (decodercontext->has_ppm) {
                if (bytestream2_get_bytes_left(&decodercontext->packed_headers_stream) < 1) {
                    av_log(decodercontext->avctx, AV_LOG_ERROR, "Insufficient PPM data\n");
                    return AVERROR_INVALIDDATA;
                }
                bytestream2_init(&decodercontext->tile_header, decodercontext->packed_headers_stream.buffer, bytestream2_get_bytes_left(&decodercontext->packed_headers_stream));
            } else {
                bytestream2_init(&decodercontext->tile_header, tp->tp_start, tp->tp_end - tp->tp_start);
            }

            if (decodercontext->has_ppt && tile->tp_idx == 0) {
                if (bytestream2_get_bytes_left(&decodercontext->ppt_data) < 1) {
                    av_log(decodercontext->avctx, AV_LOG_ERROR, "Insufficient PPT data\n");
                    return AVERROR_INVALIDDATA;
                }
                bytestream2_init(&decodercontext->packet_header, decodercontext->ppt_data.buffer, bytestream2_get_bytes_left(&decodercontext->ppt_data));
            } else {
                bytestream2_init(&decodercontext->packet_header, tp->tp_start, tp->tp_end - tp->tp_start);
            }

            if (bytestream2_get_bytes_left(&decodercontext->g) < tp->tp_end - tp->tp_start) {
                av_log(decodercontext->avctx, AV_LOG_ERROR, "Insufficient data for tile-part\n");
                return AVERROR_INVALIDDATA;
            }
            bytestream2_skip(&decodercontext->g, tp->tp_end - tp->tp_start);
            continue;