// Initialize the bytestream for tile-part headers using packed header streams if PPM is present.
// Initialize the bytestream for packed packet headers if PPT is present and it's the first tile-part.
// Set up the data stream for the current tile-part by calculating its size and skipping to its end in the buffer.
if (s->has_ppm) {
    Jpeg2000TilePart *tp = tile->tile_part + tile->tp_idx;
    bytestream2_init(&tp->header_tpg, s->packed_headers, s->packed_headers_size);
    bytestream2_init(&tp->tpg, s->g.buffer + bytestream2_tell(&s->g), tp->tp_end - s->g.buffer);
    bytestream2_skip(&s->g, tp->tp_end - s->g.buffer);
} else if (tile->has_ppt && tile->tp_idx == 0) {
    bytestream2_init(&tile->packed_headers_stream, tile->packed_headers, tile->packed_headers_size);
    bytestream2_init(&tile->tile_part[0].tpg, s->g.buffer + bytestream2_tell(&s->g), tile->tile_part[0].tp_end - s->g.buffer);
    bytestream2_skip(&s->g, tile->tile_part[0].tp_end - s->g.buffer);
} else {
    bytestream2_init(&tile->tile_part[tile->tp_idx].tpg, s->g.buffer + bytestream2_tell(&s->g), tile->tile_part[tile->tp_idx].tp_end - s->g.buffer);
    bytestream2_skip(&s->g, tile->tile_part[tile->tp_idx].tp_end - s->g.buffer);
}