next_token[i] = '\0';
if (strncmp(next_token, "url(", 4) == 0)
{
  char *closing = strchr(next_token, ')');
  if (closing != NULL)
  {
    char *source = next_token + 4;
    if (*source == '#')
      source++;
    size_t new_len = closing - source;
    if (new_len >= extent)
      new_len = extent - 1;
    memcpy(next_token, source, new_len);
    next_token[new_len] = '\0';
  }
}