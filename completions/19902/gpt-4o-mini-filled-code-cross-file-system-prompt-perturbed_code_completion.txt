char buf[256]; // Buffer to hold the cleaned string
const char *p = s;
const char *pend = s + len;
char *n = buf;

// Step 1: Trim leading whitespace
while (p < pend && ISSPACE(*p)) p++;

// Step 2: Check for hexadecimal prefixes
if (p + 1 < pend && (*p == '0') && (p[1] == 'x' || p[1] == 'X')) {
    p += 2; // Skip the "0x" or "0X"
}

// Step 3: Prepare buffer and iterate over the string
while (p < pend && (isdigit(*p) || *p == '.' || *p == '-' || *p == '+' || *p == '_')) {
    if (*p != '_') { // Skip underscores
        *n++ = *p; // Copy valid characters
    }
    p++;
}

// Step 4: Null-terminate the buffer
*n = '\0';