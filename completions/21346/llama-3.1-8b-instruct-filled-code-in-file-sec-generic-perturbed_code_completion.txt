if (memcmp(&packet->line[i].ptr[j], "DCC ", 4) == 0) {
  j += 4;
  NDPI_LOG_DBG2(ndpi_struct, "found DCC.");
  // Extract and parse IRC commands from packet lines.
  // Check if the command is one of SEND, CHAT, chat, sslchat, or TSEND.
  // If a command is detected, advance the index to process further.
  // Iterate through the characters in the line to identify spaces and the port number.
  // After the third space, attempt to read the port number from the line.
  // If a valid port is found and the source or destination structure is not NULL, store the port.
  // If the IRC port array is not full, add the new port unless it's a duplicate.
  // If the array is full, replace the least recently used port with the new one if not a duplicate.
  // Update the timestamp of the last IRC activity for source or destination.
  for (k = j + 1; k < packet->line[i].len; k++) {
    if (packet->line[i].ptr[k] =='') {
      if (k - j == 1) {
        // SEND
        if (packet->line[i].ptr[j + 1] == 'S') {
          NDPI_LOG_INFO(ndpi_struct, "found SEND.");
          if (src_id!= NULL) {
            src_id->irc_port[src_id->irc_number_of_port] = ntohs(get_u_int16_t(packet->payload, k + 1));
            src_id->irc_number_of_port++;
            src_id->last_time_port_used[src_id->irc_number_of_port - 1] = packet->tick_timestamp;
          }
          if (dst!= NULL) {
            dst->irc_port[dst->irc_number_of_port] = ntohs(get_u_int16_t(packet->payload, k + 1));
            dst->irc_number_of_port++;
            dst->last_time_port_used[dst->irc_number_of_port - 1] = packet->tick_timestamp;
          }
        }
      } else if (k - j == 2) {
        // CHAT
        if (packet->line[i].ptr[j + 1] == 'C') {
          NDPI_LOG_INFO(ndpi_struct, "found CHAT.");
          if (src_id!= NULL) {
            src_id->irc_port[src_id->irc_number_of_port] = ntohs(get_u_int16_t(packet->payload, k + 1));
            src_id->irc_number_of_port++;
            src_id->last_time_port_used[src_id->irc_number_of_port - 1] = packet->tick_timestamp;
          }
          if (dst!= NULL) {
            dst->irc_port[dst->irc_number_of_port] = ntohs(get_u_int16_t(packet->payload, k + 1));
            dst->irc_number_of_port++;
            dst->last_time_port_used[dst->irc_number_of_port - 1] = packet->tick_timestamp;
          }
        }
      } else if (k - j == 3) {
        // chat
        if (packet->line[i].ptr[j + 1] == 'c') {
          NDPI_LOG_INFO(ndpi_struct, "found chat.");
          if (src_id!= NULL) {
            src_id->irc_port[src_id->irc_number_of_port] = ntohs(get_u_int16_t(packet->payload, k + 1));
            src_id->irc_number_of_port++;
            src_id->last_time_port_used[src_id->irc_number_of_port - 1] = packet->tick_timestamp;
          }
          if (dst!= NULL) {
            dst->irc_port[dst->irc_number_of_port] = ntohs(get_u_int16_t(packet->payload, k + 1));
            dst->irc_number_of_port++;
            dst->last_time_port_used[dst->irc_number_of_port - 1] = packet->tick_timestamp;
          }
        }
      } else if (k - j == 4) {
        // sslchat
        if (packet->line[i].ptr[j + 1] =='s') {
          NDPI_LOG_INFO(ndpi_struct, "found sslchat.");
          if (src_id!= NULL) {
            src_id->irc_port[src_id->irc_number_of_port] = ntohs(get_u_int16_t(packet->payload, k + 1));
            src_id->irc_number_of_port++;
            src_id->last_time_port_used[src_id->irc_number_of_port - 1] = packet->tick_timestamp;
          }
          if (dst!= NULL) {
            dst->irc_port[dst->irc_number_of_port] = ntohs(get_u_int16_t(packet->payload, k + 1));
            dst->irc_number_of_port++;
            dst->last_time_port_used[dst->irc_number_of_port - 1] = packet->tick_timestamp;
          }
        }
      } else if (k - j == 5) {
        // TSEND
        if (packet->line[i].ptr[j + 1] == 'T') {
          NDPI_LOG_INFO(ndpi_struct, "found TSEND.");
          if (src_id!= NULL) {
            src_id->irc_port[src_id->irc_number_of_port] = ntohs(get_u_int16_t(packet->payload, k + 1));
            src_id->irc_number_of_port++;
            src_id->last_time_port_used[src_id->irc_number_of_port - 1] = packet->tick_timestamp;
          }
          if (dst!= NULL) {
            dst->irc_port[dst->irc_number_of_port] = ntohs(get_u_int16_t(packet->payload, k + 1));
            dst->irc_number_of_port++;
            dst->last_time_port_used[dst->irc_number_of_port - 1] = packet->tick_timestamp;
          }
        }
      }
    }
  }
}