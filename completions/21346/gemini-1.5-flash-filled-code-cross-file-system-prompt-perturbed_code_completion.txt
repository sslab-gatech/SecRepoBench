for (k = 0; k < ndpi_struct->max_irc_ports; k++) {
	if (ndpi_struct->irc_ports[k] == ntohs(get_u_int16_t(&packet->line[i].ptr[j]))) {
	  if (dst != NULL) {
	    for (counter = 0; counter < dst->irc_number_of_port; counter++) {
	      if (dst->irc_port[counter] == ntohs(get_u_int16_t(&packet->line[i].ptr[j]))) {
		goto next_line;
	      }
	    }
	    if (dst->irc_number_of_port < ndpi_struct->max_irc_ports) {
	      dst->irc_port[dst->irc_number_of_port] = ntohs(get_u_int16_t(&packet->line[i].ptr[j]));
	      dst->last_time_port_used[dst->irc_number_of_port] = packet->tick_timestamp;
	      dst->irc_number_of_port++;
	    } else {
	      less = dst->last_time_port_used[0];
	      j = 0;
	      for (counter = 1; counter < dst->irc_number_of_port; counter++) {
		if (dst->last_time_port_used[counter] < less) {
		  less = dst->last_time_port_used[counter];
		  j = counter;
		}
	      }
	      dst->irc_port[j] = ntohs(get_u_int16_t(&packet->line[i].ptr[j]));
	      dst->last_time_port_used[j] = packet->tick_timestamp;
	    }
	  } else if (src_id != NULL) {
	    for (counter = 0; counter < src_id->irc_number_of_port; counter++) {
	      if (src_id->irc_port[counter] == ntohs(get_u_int16_t(&packet->line[i].ptr[j]))) {
		goto next_line;
	      }
	    }
	    if (src_id->irc_number_of_port < ndpi_struct->max_irc_ports) {
	      src_id->irc_port[src_id->irc_number_of_port] = ntohs(get_u_int16_t(&packet->line[i].ptr[j]));
	      src_id->last_time_port_used[src_id->irc_number_of_port] = packet->tick_timestamp;
	      src_id->irc_number_of_port++;
	    } else {
	      less = src_id->last_time_port_used[0];
	      j = 0;
	      for (counter = 1; counter < src_id->irc_number_of_port; counter++) {
		if (src_id->last_time_port_used[counter] < less) {
		  less = src_id->last_time_port_used[counter];
		  j = counter;
		}
	      }
	      src_id->irc_port[j] = ntohs(get_u_int16_t(&packet->line[i].ptr[j]));
	      src_id->last_time_port_used[j] = packet->tick_timestamp;
	    }
	  }
	}
      }
      next_line:;
    }
  }