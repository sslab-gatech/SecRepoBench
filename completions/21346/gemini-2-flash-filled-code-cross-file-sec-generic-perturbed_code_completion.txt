if (memcmp(&packet->line[i].ptr[j], "SEND ", 5) == 0) {
		j += 5;
	      } else if (memcmp(&packet->line[i].ptr[j], "CHAT ", 5) == 0
			 || memcmp(&packet->line[i].ptr[j], "chat ", 5) == 0) {
		j += 5;
	      } else if (memcmp(&packet->line[i].ptr[j], "TSEND ", 6) == 0) {
		j += 6;
	      } else if (memcmp(&packet->line[i].ptr[j], "sslchat ", 8) == 0) {
		j += 8;
	      } else
		continue;

	      for (; j < packet->line[i].len; j++) {
		if (packet->line[i].ptr[j] == ' ') {
		  space++;
		  if (space == 3) {
		    j++;
		    if (isdigit(packet->line[i].ptr[j])) {
		      port = 0;
		      while (isdigit(packet->line[i].ptr[j])) {
			port = port * 10 + (packet->line[i].ptr[j] - '0');
			j++;
			if (port > 65535) {
			  port = 0;
			  break;
			}
		      }
		      if (port != 0) {
			NDPI_LOG_DBG2(ndpi_struct, "found port %u", port);
			if (dst != NULL) {
			  less = 1;
			  for (counter = 0; counter < dst->irc_number_of_port;
			       counter++) {
			    if (dst->irc_port[counter] == port) {
			      less = 0;
			      break;
			    }
			  }
			  if (less == 1) {
			    if (dst->irc_number_of_port < 10) {
			      dst->irc_port[dst->irc_number_of_port] = port;
			      dst->last_time_port_used[dst->irc_number_of_port] =
				packet->tick_timestamp;
			      dst->irc_number_of_port++;
			    } else {
			      u_int32_t oldest_time =
				packet->tick_timestamp;
			      u_int8_t oldest_index = 0;

			      for (counter = 0; counter < 10; counter++) {
				if (dst->last_time_port_used[counter] <
				    oldest_time) {
				  oldest_time =
				    dst->last_time_port_used[counter];
				  oldest_index = counter;
				}
			      }
			      dst->irc_port[oldest_index] = port;
			      dst->last_time_port_used[oldest_index] =
				packet->tick_timestamp;
			    }
			  }
			  dst->irc_ts = packet->tick_timestamp;
			} else if (src_id != NULL) {
			  less = 1;
			  for (counter = 0;
			       counter < src_id->irc_number_of_port;
			       counter++) {
			    if (src_id->irc_port[counter] == port) {
			      less = 0;
			      break;
			    }
			  }
			  if (less == 1) {
			    if (src_id->irc_number_of_port < 10) {
			      src_id->irc_port[src_id->irc_number_of_port] =
				port;
			      src_id->last_time_port_used[src_id->
							   irc_number_of_port] =
				packet->tick_timestamp;
			      src_id->irc_number_of_port++;
			    } else {
			      u_int32_t oldest_time =
				packet->tick_timestamp;
			      u_int8_t oldest_index = 0;

			      for (counter = 0; counter < 10; counter++) {
				if (src_id->last_time_port_used[counter] <
				    oldest_time) {
				  oldest_time =
				    src_id->last_time_port_used[counter];
				  oldest_index = counter;
				}
			      }
			      src_id->irc_port[oldest_index] = port;
			      src_id->last_time_port_used[oldest_index] =
				packet->tick_timestamp;
			    }
			  }
			  src_id->irc_ts = packet->tick_timestamp;
			}
		      }
		      break;
		    }
		  }
		}
	      }