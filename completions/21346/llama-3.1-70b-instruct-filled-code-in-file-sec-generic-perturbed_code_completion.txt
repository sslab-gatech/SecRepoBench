if (packet->line[i].ptr[j] == 'D' || packet->line[i].ptr[j] == 'd') {
  j++;
  if (packet->line[i].ptr[j] == 'C' || packet->line[i].ptr[j] == 'c') {
    j++;
    if (packet->line[i].ptr[j] == 'C' || packet->line[i].ptr[j] == 'c') {
      j++;
      if (packet->line[i].ptr[j] =='') {
	j++;
	if (packet->line[i].ptr[j] == 'S' || packet->line[i].ptr[j] =='s') {
	  j++;
	  if (packet->line[i].ptr[j] == 'E' || packet->line[i].ptr[j] == 'e') {
	    j++;
	    if (packet->line[i].ptr[j] == 'N' || packet->line[i].ptr[j] == 'n') {
	      j++;
	      if (packet->line[i].ptr[j] == 'D' || packet->line[i].ptr[j] == 'd') {
		j++;
		if (packet->line[i].ptr[j] =='') {
		  j++;
		  for (k = j; k < packet->line[i].len; k++) {
		    if (packet->line[i].ptr[k] =='') {
		      space++;
		      if (space == 3) {
			if (packet->line[i].ptr[k + 1] >= '0' && packet->line[i].ptr[k + 1] <= '9') {
			  port = 0;
			  for (h = k + 1; h < packet->line[i].len; h++) {
			    if (packet->line[i].ptr[h] >= '0' && packet->line[i].ptr[h] <= '9') {
			      port = port * 10 + (packet->line[i].ptr[h] - '0');
			    } else {
			      break;
			    }
			  }
			  if (port > 0 && port < 65536) {
			    if (src_id!= NULL) {
			      if (src_id->irc_number_of_port < NDPI_PROTOCOL_IRC_MAXPORT) {
				if (!ndpi_is_duplicate(src_id, port)) {
				  src_id->irc_port[src_id->irc_number_of_port] = port;
				  src_id->last_time_port_used[src_id->irc_number_of_port] = packet->tick_timestamp;
				  src_id->irc_number_of_port++;
				}
			      } else {
				NDPI_IRC_FIND_LESS(src_id->last_time_port_used, less);
				if (!ndpi_is_duplicate(src_id, port)) {
				  src_id->irc_port[less] = port;
				  src_id->last_time_port_used[less] = packet->tick_timestamp;
				}
			      }
			    }
			    if (dst!= NULL) {
			      if (dst->irc_number_of_port < NDPI_PROTOCOL_IRC_MAXPORT) {
				if (!ndpi_is_duplicate(dst, port)) {
				  dst->irc_port[dst->irc_number_of_port] = port;
				  dst->last_time_port_used[dst->irc_number_of_port] = packet->tick_timestamp;
				  dst->irc_number_of_port++;
				}
			      } else {
				NDPI_IRC_FIND_LESS(dst->last_time_port_used, less);
				if (!ndpi_is_duplicate(dst, port)) {
				  dst->irc_port[less] = port;
				  dst->last_time_port_used[less] = packet->tick_timestamp;
				}
			      }
			    }
			  }
			}
		      }
		    }
		  }
		}
	      }
	    }
	  }
	}
      }
    }
  }
}
if (packet->line[i].ptr[j] == 'C' || packet->line[i].ptr[j] == 'c') {
  j++;
  if (packet->line[i].ptr[j] == 'H' || packet->line[i].ptr[j] == 'h') {
    j++;
    if (packet->line[i].ptr[j] == 'A' || packet->line[i].ptr[j] == 'a') {
      j++;
      if (packet->line[i].ptr[j] == 'T' || packet->line[i].ptr[j] == 't') {
	j++;
	if (packet->line[i].ptr[j] =='') {
	  j++;
	  for (k = j; k < packet->line[i].len; k++) {
	    if (packet->line[i].ptr[k] =='') {
	      space++;
	      if (space == 3) {
		if (packet->line[i].ptr[k + 1] >= '0' && packet->line[i].ptr[k + 1] <= '9') {
		  port = 0;
		  for (h = k + 1; h < packet->line[i].len; h++) {
		    if (packet->line[i].ptr[h] >= '0' && packet->line[i].ptr[h] <= '9') {
		      port = port * 10 + (packet->line[i].ptr[h] - '0');
		    } else {
		      break;
		    }
		  }
		  if (port > 0 && port < 65536) {
		    if (src_id!= NULL) {
		      if (src_id->irc_number_of_port < NDPI_PROTOCOL_IRC_MAXPORT) {
			if (!ndpi_is_duplicate(src_id, port)) {
			  src_id->irc_port[src_id->irc_number_of_port] = port;
			  src_id->last_time_port_used[src_id->irc_number_of_port] = packet->tick_timestamp;
			  src_id->irc_number_of_port++;
			}
		      } else {
			NDPI_IRC_FIND_LESS(src_id->last_time_port_used, less);
			if (!ndpi_is_duplicate(src_id, port)) {
			  src_id->irc_port[less] = port;
			  src_id->last_time_port_used[less] = packet->tick_timestamp;
			}
		      }
		    }
		    if (dst!= NULL) {
		      if (dst->irc_number_of_port < NDPI_PROTOCOL_IRC_MAXPORT) {
			if (!ndpi_is_duplicate(dst, port)) {
			  dst->irc_port[dst->irc_number_of_port] = port;
			  dst->last_time_port_used[dst->irc_number_of_port] = packet->tick_timestamp;
			  dst->irc_number_of_port++;
			}
		      } else {
			NDPI_IRC_FIND_LESS(dst->last_time_port_used, less);
			if (!ndpi_is_duplicate(dst, port)) {
			  dst->irc_port[less] = port;
			  dst->last_time_port_used[less] = packet->tick_timestamp;
			}
		      }
		    }
		  }
		}
	      }
	    }
	  }
	}
      }
    }
  }
}
if (packet->line[i].ptr[j] =='s' || packet->line[i].ptr[j] == 'S') {
  j++;
  if (packet->line[i].ptr[j] =='s' || packet->line[i].ptr[j] == 'S') {
    j++;
    if (packet->line[i].ptr[j] == 'l' || packet->line[i].ptr[j] == 'L') {
      j++;
      if (packet->line[i].ptr[j] == 'c' || packet->line[i].ptr[j] == 'C') {
	j++;
	if (packet->line[i].ptr[j] == 'h' || packet->line[i].ptr[j] == 'H') {
	  j++;
	  if (packet->line[i].ptr[j] == 'a' || packet->line[i].ptr[j] == 'A') {
	    j++;
	    if (packet->line[i].ptr[j] == 't' || packet->line[i].ptr[j] == 'T') {
	      j++;
	      if (packet->line[i].ptr[j] =='') {
		j++;
		for (k = j; k < packet->line[i].len; k++) {
		  if (packet->line[i].ptr[k] =='') {
		    space++;
		    if (space == 3) {
		      if (packet->line[i].ptr[k + 1] >= '0' && packet->line[i].ptr[k + 1] <= '9') {
			port = 0;
			for (h = k + 1; h < packet->line[i].len; h++) {
			  if (packet->line[i].ptr[h] >= '0' && packet->line[i].ptr[h] <= '9') {
			    port = port * 10 + (packet->line[i].ptr[h] - '0');
			  } else {
			    break;
			  }
			}
			if (port > 0 && port < 65536) {
			  if (src_id!= NULL) {
			    if (src_id->irc_number_of_port < NDPI_PROTOCOL_IRC_MAXPORT) {
			      if (!ndpi_is_duplicate(src_id, port)) {
				src_id->irc_port[src_id->irc_number_of_port] = port;
				src_id->last_time_port_used[src_id->irc_number_of_port] = packet->tick_timestamp;
				src_id->irc_number_of_port++;
			      }
			    } else {
			      NDPI_IRC_FIND_LESS(src_id->last_time_port_used, less);
			      if (!ndpi_is_duplicate(src_id, port)) {
				src_id->irc_port[less] = port;
				src_id->last_time_port_used[less] = packet->tick_timestamp;
			      }
			    }
			  }
			  if (dst!= NULL) {
			    if (dst->irc_number_of_port < NDPI_PROTOCOL_IRC_MAXPORT) {
			      if (!ndpi_is_duplicate(dst, port)) {
				dst->irc_port[dst->irc_number_of_port] = port;
				dst->last_time_port_used[dst->irc_number_of_port] = packet->tick_timestamp;
				dst->irc_number_of_port++;
			      }
			    } else {
			      NDPI_IRC_FIND_LESS(dst->last_time_port_used, less);
			      if (!ndpi_is_duplicate(dst, port)) {
				dst->irc_port[less] = port;
				dst->last_time_port_used[less] = packet->tick_timestamp;
			      }
			    }
			  }
			}
		      }
		    }
		  }
		}
	      }
	    }
	  }
	}
      }
    }
  }
}
if (packet->line[i].ptr[j] == 'T' || packet->line[i].ptr[j] == 't') {
  j++;
  if (packet->line[i].ptr[j] == 'S' || packet->line[i].ptr[j] =='s') {
    j++;
    if (packet->line[i].ptr[j] == 'E' || packet->line[i].ptr[j] == 'e') {
      j++;
      if (packet->line[i].ptr[j] == 'N' || packet->line[i].ptr[j] == 'n') {
	j++;
	if (packet->line[i].ptr[j] == 'D' || packet->line[i].ptr[j] == 'd') {
	  j++;
	  if (packet->line[i].ptr[j] =='') {
	    j++;
	    for (k = j; k < packet->line[i].len; k++) {
	      if (packet->line[i].ptr[k] =='') {
		space++;
		if (space == 3) {
		  if (packet->line[i].ptr[k + 1] >= '0' && packet->line[i].ptr[k + 1] <= '9') {
		    port = 0;
		    for (h = k + 1; h < packet->line[i].len; h++) {
		      if (packet->line[i].ptr[h] >= '0' && packet->line[i].ptr[h] <= '9') {
			port = port * 10 + (packet->line[i].ptr[h] - '0');
		      } else {
			break;
		      }
		    }
		    if (port > 0 && port < 65536) {
		      if (src_id!= NULL) {
			if (src_id->irc_number_of_port < NDPI_PROTOCOL_IRC_MAXPORT) {
			  if (!ndpi_is_duplicate(src_id, port)) {
			    src_id->irc_port[src_id->irc_number_of_port] = port;
			    src_id->last_time_port_used[src_id->irc_number_of_port] = packet->tick_timestamp;
			    src_id->irc_number_of_port++;
			  }
			} else {
			  NDPI_IRC_FIND_LESS(src_id->last_time_port_used, less);
			  if (!ndpi_is_duplicate(src_id, port)) {
			    src_id->irc_port[less] = port;
			    src_id->last_time_port_used[less] = packet->tick_timestamp;
			  }
			}
		      }
		      if (dst!= NULL) {
			if (dst->irc_number_of_port < NDPI_PROTOCOL_IRC_MAXPORT) {
			  if (!ndpi_is_duplicate(dst, port)) {
			    dst->irc_port[dst->irc_number_of_port] = port;
			    dst->last_time_port_used[dst->irc_number_of_port] = packet->tick_timestamp;
			    dst->irc_number_of_port++;
			  }
			} else {
			  NDPI_IRC_FIND_LESS(dst->last_time_port_used, less);
			  if (!ndpi_is_duplicate(dst, port)) {
			    dst->irc_port[less] = port;
			    dst->last_time_port_used[less] = packet->tick_timestamp;
			  }
			}
		      }
		    }
		  }
		}
	      }
	    }
	  }
	}
      }
    }
  }
}