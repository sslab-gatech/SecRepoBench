if (memcmp(&packet->line[i].ptr[j], "SEND ", 5) == 0
		    || memcmp(&packet->line[i].ptr[j], "CHAT ", 5) == 0
		    || memcmp(&packet->line[i].ptr[j], "chat ", 5) == 0
		    || memcmp(&packet->line[i].ptr[j], "sslchat ", 8) == 0
                    || memcmp(&packet->line[i].ptr[j], "TSEND ", 6) == 0) {
		  j += 2;
		  space = 0;
		  while (j < packet->line[i].len) {
		    if (packet->line[i].ptr[j] == ' ') {
		      space++;
		      if (space == 3) {
			j++;
			k = j;
			while (isdigit((int) (packet->line[i].ptr[j])) && j < packet->line[i].len) {
			  j++;
			}
			port = ndpi_strtol((const char *) &packet->line[i].ptr[k], (char **) NULL, 10);
			if (port > 0 && port < 65536) {
			  NDPI_LOG_DBG2(ndpi_struct, "port > 0 && port < 65536");
			  if (src_id != NULL) {
			    NDPI_LOG_DBG2(ndpi_struct, "src_id != NULL");
			    if (src_id->irc_number_of_port < NDPI_PROTOCOL_IRC_MAXPORT) {
			      if (ndpi_is_duplicate(src_id, port) == 0) {
				src_id->irc_port[src_id->irc_number_of_port] = port;
				src_id->last_time_port_used[src_id->irc_number_of_port] = packet->tick_timestamp;
				src_id->irc_number_of_port++;
			      }
			    } else {
			      NDPI_IRC_FIND_LESS(src_id->last_time_port_used, less);
			      if (ndpi_is_duplicate(src_id, port) == 0) {
				src_id->irc_port[less] = port;
				src_id->last_time_port_used[less] = packet->tick_timestamp;
			      }
			    }
			    src_id->irc_ts = packet->tick_timestamp;
			  } else if (dst != NULL) {
			    NDPI_LOG_DBG2(ndpi_struct, "dst != NULL");
			    if (dst->irc_number_of_port < NDPI_PROTOCOL_IRC_MAXPORT) {
			      if (ndpi_is_duplicate(dst, port) == 0) {
				dst->irc_port[dst->irc_number_of_port] = port;
				dst->last_time_port_used[dst->irc_number_of_port] = packet->tick_timestamp;
				dst->irc_number_of_port++;
			      }
			    } else {
			      NDPI_IRC_FIND_LESS(dst->last_time_port_used, less);
			      if (ndpi_is_duplicate(dst, port) == 0) {
				dst->irc_port[less] = port;
				dst->last_time_port_used[less] = packet->tick_timestamp;
			      }
			    }
			    dst->irc_ts = packet->tick_timestamp;
			  }
			}
			break;
		      }
		    }
		    j++;
		  }
		}