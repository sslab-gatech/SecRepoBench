if (memcmp(&packet->line[i].ptr[j], "SEND ", 5) == 0
		    || memcmp(&packet->line[i].ptr[j], "CHAT ", 5) == 0
		    || memcmp(&packet->line[i].ptr[j], "chat ", 5) == 0
                    || memcmp(&packet->line[i].ptr[j], "sslchat ", 8) == 0
		    || memcmp(&packet->line[i].ptr[j], "TSEND ", 6) == 0) {
		  j += 5;
		  for (k = j; k < packet->line[i].len; k++) {
		    if (packet->line[i].ptr[k] == 0x20) { /* 0x20 = space */
		      space++;
		      if (space == 3) {
			k++;
			port = ndpi_parse_port_from_string(ndpi_struct, &packet->line[i].ptr[k], packet->line[i].len - k);
			if (port != 0) {
			  NDPI_LOG_DBG2(ndpi_struct, "port %u", port);
			  goto add_port;
			}
		      }
		    }
		  }
		}
	      }
	    }
	  }
	}
      }
    }
  }
add_port:
  if (src_id != NULL) {
    src_id->irc_ts = packet->tick_timestamp;
    if (src_id->irc_number_of_port < NDPI_PROTOCOL_IRC_MAXPORT) {
      if (ndpi_is_duplicate(src_id, port) == 0) {
	src_id->irc_port[src_id->irc_number_of_port] = port;
	src_id->last_time_port_used[src_id->irc_number_of_port] = packet->tick_timestamp;
	src_id->irc_number_of_port++;
      }
    } else {
      NDPI_IRC_FIND_LESS(src_id->last_time_port_used, less);
      if (ndpi_is_duplicate(src_id, port) == 0) {
	src_id->irc_port[less] = port;
	src_id->last_time_port_used[less] = packet->tick_timestamp;
      }
    }
  } else if (dst != NULL) {
    dst->irc_ts = packet->tick_timestamp;
    if (dst->irc_number_of_port < NDPI_PROTOCOL_IRC_MAXPORT) {
      if (ndpi_is_duplicate(dst, port) == 0) {
	dst->irc_port[dst->irc_number_of_port] = port;
	dst->last_time_port_used[dst->irc_number_of_port] = packet->tick_timestamp;
	dst->irc_number_of_port++;
      }
    } else {
      NDPI_IRC_FIND_LESS(dst->last_time_port_used, less);
      if (ndpi_is_duplicate(dst, port) == 0) {
	dst->irc_port[less] = port;
	dst->last_time_port_used[less] = packet->tick_timestamp;
      }
    }