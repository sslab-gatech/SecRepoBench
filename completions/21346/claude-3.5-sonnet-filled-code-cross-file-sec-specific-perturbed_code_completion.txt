if (memcmp(&packet->line[i].ptr[j], "SEND ", 5) == 0 ||
    memcmp(&packet->line[i].ptr[j], "CHAT ", 5) == 0 ||
    memcmp(&packet->line[i].ptr[j], "chat ", 5) == 0 ||
    memcmp(&packet->line[i].ptr[j], "sslchat ", 8) == 0 ||
    memcmp(&packet->line[i].ptr[j], "TSEND ", 6) == 0) {
  NDPI_LOG_DBG2(ndpi_struct, "found DCC SEND or DCC CHAT.");
  j += 5;
  while (packet->line[i].len > j && packet->line[i].ptr[j] != ' ') {
    j++;
  }
  j++;
  space = 0;
  while (packet->line[i].len > j && space != 3) {
    if (packet->line[i].ptr[j] == ' ') {
      space++;
    }
    j++;
  }
  if (packet->line[i].len > j + 5 && space == 3) {
    port = ntohs_ndpi_bytestream_to_number(&packet->line[i].ptr[j], packet->line[i].len - j, &j);
    if (port != 0) {
      if (src_id != NULL) {
        if (src_id->irc_number_of_port < 16) {
          for (k = 0; k < src_id->irc_number_of_port; k++) {
            if (src_id->irc_port[k] == port) {
              break;
            }
          }
          if (k == src_id->irc_number_of_port) {
            src_id->irc_port[k] = port;
            src_id->irc_number_of_port++;
          }
        }
        src_id->last_time_port_used[k] = packet->tick_timestamp;
        src_id->irc_ts = packet->tick_timestamp;
      }
      if (dst != NULL) {
        if (dst->irc_number_of_port < 16) {
          for (k = 0; k < dst->irc_number_of_port; k++) {
            if (dst->irc_port[k] == port) {
              break;
            }
          }
          if (k == dst->irc_number_of_port) {
            dst->irc_port[k] = port;
            dst->irc_number_of_port++;
          }
        }
        dst->last_time_port_used[k] = packet->tick_timestamp;
        dst->irc_ts = packet->tick_timestamp;
      }
    }
  }
}