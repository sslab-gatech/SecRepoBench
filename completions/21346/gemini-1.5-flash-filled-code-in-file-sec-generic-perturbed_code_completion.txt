space = 0;
	      for (k = 0; k < packet->line[i].len; k++) {
		if (packet->line[i].ptr[k] == ' ') {
		  space++;
		  if (space == 3) {
		    port = (u_int16_t) strtol(&packet->line[i].ptr[k + 1], NULL, 10);
		    if (dst != NULL) {
		      if (dst->irc_number_of_port < NDPI_PROTOCOL_IRC_MAXPORT) {
			if (ndpi_is_duplicate(dst, port) == 0) {
			  dst->irc_port[dst->irc_number_of_port] = port;
			  dst->last_time_port_used[dst->irc_number_of_port] = packet->tick_timestamp;
			  dst->irc_number_of_port++;
			}
		      } else {
			NDPI_IRC_FIND_LESS(dst->last_time_port_used, less);
			if (ndpi_is_duplicate(dst, port) == 0) {
			  dst->irc_port[less] = port;
			  dst->last_time_port_used[less] = packet->tick_timestamp;
			}
		      }
		      dst->irc_ts = packet->tick_timestamp;
		    } else if (src_id != NULL) {
		      if (src_id->irc_number_of_port < NDPI_PROTOCOL_IRC_MAXPORT) {
			if (ndpi_is_duplicate(src_id, port) == 0) {
			  src_id->irc_port[src_id->irc_number_of_port] = port;
			  src_id->last_time_port_used[src_id->irc_number_of_port] = packet->tick_timestamp;
			  src_id->irc_number_of_port++;
			}
		      } else {
			NDPI_IRC_FIND_LESS(src_id->last_time_port_used, less);
			if (ndpi_is_duplicate(src_id, port) == 0) {
			  src_id->irc_port[less] = port;
			  src_id->last_time_port_used[less] = packet->tick_timestamp;
			}
		      }
		      src_id->irc_ts = packet->tick_timestamp;
		    }
		    break;
		  }
		}
	      }
	    }
	  }