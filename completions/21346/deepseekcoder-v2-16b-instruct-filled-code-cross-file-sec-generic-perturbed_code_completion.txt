// Extract and parse IRC commands from packet lines.
  // Check if the command is one of SEND, CHAT, chat, sslchat, or TSEND.
  // If a command is detected, advance the index to process further.
  // Iterate through the characters in the line to identify spaces and the port number.
  // After the third space, attempt to read the port number from the line.
  // If a valid port is found and the source or destination structure is not NULL, store the port.
  // If the IRC port array is not full, add the new port unless it's a duplicate.
  // If the array is full, replace the least recently used port with the new one if not a duplicate.
  // Update the timestamp of the last IRC activity for source or destination.

  // Check for IRC commands and extract port numbers
  char *command_start = NULL;
  char *space_start = NULL;
  u_int16_t port = 0;
  u_int16_t space_count = 0;

  for (j = h; j < packet->line[i].len - 9; j++) {
    if (packet->line[i].ptr[j] == ' ') {
      space_count++;
      if (space_count == 3) {
        space_start = &packet->line[i].ptr[j + 1];
        break;
      }
    }
  }

  if (space_start && sscanf(space_start, "%hu", &port) == 1) {
    if (src_id && dst) {
      if (src_id->irc_port_count < NDPI_MAX_IRC_PORTS) {
        for (k = 0; k < src_id->irc_port_count; k++) {
          if (src_id->irc_port[k] == port) {
            goto update_timestamp;
          }
        }
        src_id->irc_port[src_id->irc_port_count++] = port;
      } else {
        for (k = 0; k < src_id->irc_port_count; k++) {
          if (src_id->irc_port[k] == port) {
            goto update_timestamp;
          }
        }
        src_id->irc_port[src_id->irc_port_count++] = port;
        src_id->irc_port[src_id->irc_port_count - 2] = port;
      }
    }
    if (dst && dst->irc_port_count < NDPI_MAX_IRC_PORTS) {
      for (k = 0; k < dst->irc_port_count; k++) {
        if (dst->irc_port[k] == port) {
          goto update_timestamp;
        }
      }
      dst->irc_port[dst->irc_port_count++] = port;
    } else {
      for (k = 0; k < dst->irc_port_count; k++) {
        if (dst->irc_port[k] == port) {
          goto update_timestamp;
        }
      }
      dst->irc_port[dst->irc_port_count++] = port;
      dst->irc_port[dst->irc_port_count - 2] = port;
    }
  }

update_timestamp:
  if (src_id) {
    src_id->irc_ts = packet->tick_timestamp;
  }
  if (dst) {
    dst->irc_ts = packet->tick_timestamp;
  }