// Check for specific DCC commands and extract port numbers
	      if (memcmp(&packet->line[i].ptr[j], "SEND ", 5) == 0 ||
	          memcmp(&packet->line[i].ptr[j], "CHAT ", 5) == 0 ||
	          memcmp(&packet->line[i].ptr[j], "chat ", 5) == 0 ||
	          memcmp(&packet->line[i].ptr[j], "sslchat ", 8) == 0 ||
	          memcmp(&packet->line[i].ptr[j], "TSEND ", 6) == 0) {
	        j += (packet->line[i].ptr[j + 4] == ' ') ? 5 : 6; // Adjust index based on command length
	        space = 0;
	        while (j < packet->line[i].len && space < 3) {
	          if (packet->line[i].ptr[j] == ' ') {
	            space++;
	          }
	          j++;
	        }
	        if (space == 3) {
	          port = 0;
	          while (j < packet->line[i].len && packet->line[i].ptr[j] >= '0' && packet->line[i].ptr[j] <= '9') {
	            port = (port * 10) + (packet->line[i].ptr[j] - '0');
	            j++;
	          }
	          if (port > 0) {
	            struct ndpi_id_struct *id_struct = (src_id != NULL) ? src_id : dst;
	            if (id_struct != NULL) {
	              less = 1;
	              for (k = 0; k < id_struct->irc_number_of_port; k++) {
	                if (id_struct->irc_port[k] == port) {
	                  id_struct->last_time_port_used[k] = packet->tick_timestamp;
	                  less = 0;
	                  break;
	                }
	              }
	              if (less) {
	                if (id_struct->irc_number_of_port < MAX_IRC_PORTS) {
	                  id_struct->irc_port[id_struct->irc_number_of_port] = port;
	                  id_struct->last_time_port_used[id_struct->irc_number_of_port] = packet->tick_timestamp;
	                  id_struct->irc_number_of_port++;
	                } else {
	                  u_int16_t oldest_index = 0;
	                  for (k = 1; k < MAX_IRC_PORTS; k++) {
	                    if (id_struct->last_time_port_used[k] < id_struct->last_time_port_used[oldest_index]) {
	                      oldest_index = k;
	                    }
	                  }
	                  id_struct->irc_port[oldest_index] = port;
	                  id_struct->last_time_port_used[oldest_index] = packet->tick_timestamp;
	                }
	              }
	            }
	          }
	        }
	      }