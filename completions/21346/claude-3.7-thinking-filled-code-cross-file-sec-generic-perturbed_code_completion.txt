if (memcmp(&packet->line[i].ptr[j], "SEND ", 5) == 0
    || memcmp(&packet->line[i].ptr[j], "CHAT ", 5) == 0
    || memcmp(&packet->line[i].ptr[j], "chat ", 5) == 0
    || memcmp(&packet->line[i].ptr[j], "sslchat ", 8) == 0
    || memcmp(&packet->line[i].ptr[j], "TSEND ", 6) == 0) {
  
  NDPI_LOG_DBG2(ndpi_struct, "SEND, CHAT, chat, sslchat, TSEND found");
  
  u_int16_t endpos = packet->line[i].len;
  u_int16_t k, spaces_count = 0;
  u_int16_t start = 0;
  u_int16_t port = 0;
  
  // Advance j to the end of the command
  if (memcmp(&packet->line[i].ptr[j], "SEND ", 5) == 0) {
    j += 5;
  } else if