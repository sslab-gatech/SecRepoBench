if (packet->line[i].ptr[j] == ':') {
  if (memcmp(&packet->line[i].ptr[j + 1], "DCC SEND ", 9) == 0
      || memcmp(&packet->line[i].ptr[j + 1], "DCC CHAT ", 9) == 0) {
    NDPI_LOG_INFO(ndpi_struct,
                 "found NOTICE and DCC CHAT or DCC SEND.");
    if (src_id != NULL && src_id->irc_number_of_port < NDPI_PROTOCOL_IRC_MAXPORT) {
      if (!ndpi_is_duplicate(src_id, packet->tcp->source)) {
        src_id->irc_port[src_id->irc_number_of_port] = packet->tcp->source;
        src_id->last_time_port_used[src_id->irc_number_of_port] = packet->tick_timestamp;
        src_id->irc_number_of_port++;
      } else {
        NDPI_IRC_FIND_LESS(src_id->last_time_port_used, less);
        src_id->irc_port[less] = packet->tcp->source;
        src_id->last_time_port_used[less] = packet->tick_timestamp;
      }
    } else if (dst != NULL && dst->irc_number_of_port < NDPI_PROTOCOL_IRC_MAXPORT) {
      if (!ndpi_is_duplicate(dst, packet->tcp->dest)) {
        dst->irc_port[dst->irc_number_of_port] = packet->tcp->dest;
        dst->last_time_port_used[dst->irc_number_of_port] = packet->tick_timestamp;
        dst->irc_number_of_port++;
      } else {
        NDPI_IRC_FIND_LESS(dst->last_time_port_used, less);
        dst->irc_port[less] = packet->tcp->dest;
        dst->last_time_port_used[less] = packet->tick_timestamp;
      }
    }
  }
}