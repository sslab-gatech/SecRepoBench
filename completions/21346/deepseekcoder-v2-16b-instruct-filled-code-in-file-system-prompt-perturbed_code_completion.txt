// Extract and parse IRC commands from packet lines.
  // Check if the command is one of SEND, CHAT, chat, sslchat, or TSEND.
  // If a command is detected, advance the index to process further.
  // Iterate through the characters in the line to identify spaces and the port number.
  // After the third space, attempt to read the port number from the line.
  // If a valid port is found and the source or destination structure is not NULL, store the port.
  // If the IRC port array is not full, add the new port unless it's a duplicate.
  // If the array is full, replace the least recently used port with the new one if not a duplicate.
  // Update the timestamp of the last IRC activity for source or destination.

  u_int16_t port;
  u_int8_t found_port = 0;
  u_int8_t space_count = 0;
  u_int8_t digit_count = 0;
  u_int8_t negative = 0;

  for (j = h; j < packet->line[i].len; j++) {
    if (packet->line[i].ptr[j] == ' ') {
      space_count++;
      if (space_count == 3) {
        found_port = 1;
        break;
      }
    } else if (isdigit(packet->line[i].ptr[j])) {
      digit_count++;
    } else if (packet->line[i].ptr[j] == '-') {
      negative = 1;
    }
  }

  if (found_port) {
    j++; // Move past the third space
    port = 0;
    while (j < packet->line[i].len && isdigit(packet->line[i].ptr[j])) {
      port = port * 10 + (packet->line[i].ptr[j] - '0');
      j++;
    }
    if (negative) {
      port = -port;
    }

    if (src_id != NULL && dst != NULL) {
      if (ndpi_is_duplicate(src_id, port) == 0) {
        if (src_id->irc_number_of_port < NDPI_PROTOCOL_IRC_MAXPORT) {
          src_id->irc_port[src_id->irc_number_of_port++] = port;
        } else {
          NDPI_IRC_FIND_LESS(src_id->last_time_port_used, less);
          if (ndpi_is_duplicate(dst, src_id->irc_port[less]) == 0) {
            src_id->irc_port[less] = port;
          }
        }
        src_id->last_time_port_used[less] = packet->tick_timestamp;
      }
      if (ndpi_is_duplicate(dst, port) == 0) {
        if (dst->irc_number_of_port < NDPI_PROTOCOL_IRC_MAXPORT) {
          dst->irc_port[dst->irc_number_of_port++] = port;
        } else {
          NDPI_IRC_FIND_LESS(dst->last_time_port_used, less);
          if (ndpi_is_duplicate(src_id, dst->irc_port[less]) == 0) {
            dst->irc_port[less] = port;
          }
        }
        dst->last_time_port_used[less] = packet->tick_timestamp;
      }
    }
  }