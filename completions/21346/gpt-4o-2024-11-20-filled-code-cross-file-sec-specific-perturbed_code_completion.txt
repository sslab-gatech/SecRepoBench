// Extract and parse IRC commands from packet lines.
	      // Check if the command is one of SEND, CHAT, chat, sslchat, or TSEND.
	      if (memcmp(&packet->line[i].ptr[j], "SEND ", 5) == 0 ||
	          memcmp(&packet->line[i].ptr[j], "CHAT ", 5) == 0 ||
	          memcmp(&packet->line[i].ptr[j], "chat ", 5) == 0 ||
	          memcmp(&packet->line[i].ptr[j], "sslchat ", 8) == 0 ||
	          memcmp(&packet->line[i].ptr[j], "TSEND ", 6) == 0) {
	        j += 5; // Advance index to process further
	        u_int16_t space_count = 0;
	        u_int16_t port = 0;

	        // Iterate through the characters in the line to identify spaces and the port number
	        for (; j < packet->line[i].len; j++) {
	          if (packet->line[i].ptr[j] == ' ') {
	            space_count++;
	            if (space_count == 3) { // After the third space, attempt to read the port number
	              port = atoi(&packet->line[i].ptr[j + 1]);
	              break;
	            }
	          }
	        }

	        // If a valid port is found and the source or destination structure is not NULL
	        if (port > 0 && port <= 65535) {
	          if (src_id != NULL) {
	            // Check if the IRC port array is not full
	            if (src_id->irc_number_of_port < MAX_IRC_PORTS) {
	              // Add the new port unless it's a duplicate
	              int duplicate = 0;
	              for (k = 0; k < src_id->irc_number_of_port; k++) {
	                if (src_id->irc_port[k] == port) {
	                  duplicate = 1;
	                  break;
	                }
	              }
	              if (!duplicate) {
	                src_id->irc_port[src_id->irc_number_of_port] = port;
	                src_id->last_time_port_used[src_id->irc_number_of_port] = packet->tick_timestamp;
	                src_id->irc_number_of_port++;
	              }
	            } else {
	              // If the array is full, replace the least recently used port with the new one if not a duplicate
	              int lru_index = 0;
	              for (k = 1; k < MAX_IRC_PORTS; k++) {
	                if (src_id->last_time_port_used[k] < src_id->last_time_port_used[lru_index]) {
	                  lru_index = k;
	                }
	              }
	              int duplicate = 0;
	              for (k = 0; k < MAX_IRC_PORTS; k++) {
	                if (src_id->irc_port[k] == port) {
	                  duplicate = 1;
	                  break;
	                }
	              }
	              if (!duplicate) {
	                src_id->irc_port[lru_index] = port;
	                src_id->last_time_port_used[lru_index] = packet->tick_timestamp;
	              }
	            }
	          }

	          if (dst != NULL) {
	            // Check if the IRC port array is not full
	            if (dst->irc_number_of_port < MAX_IRC_PORTS) {
	              // Add the new port unless it's a duplicate
	              int duplicate = 0;
	              for (k = 0; k < dst->irc_number_of_port; k++) {
	                if (dst->irc_port[k] == port) {
	                  duplicate = 1;
	                  break;
	                }
	              }
	              if (!duplicate) {
	                dst->irc_port[dst->irc_number_of_port] = port;
	                dst->last_time_port_used[dst->irc_number_of_port] = packet->tick_timestamp;
	                dst->irc_number_of_port++;
	              }
	            } else {
	              // If the array is full, replace the least recently used port with the new one if not a duplicate
	              int lru_index = 0;
	              for (k = 1; k < MAX_IRC_PORTS; k++) {
	                if (dst->last_time_port_used[k] < dst->last_time_port_used[lru_index]) {
	                  lru_index = k;
	                }
	              }
	              int duplicate = 0;
	              for (k = 0; k < MAX_IRC_PORTS; k++) {
	                if (dst->irc_port[k] == port) {
	                  duplicate = 1;
	                  break;
	                }
	              }
	              if (!duplicate) {
	                dst->irc_port[lru_index] = port;
	                dst->last_time_port_used[lru_index] = packet->tick_timestamp;
	              }
	            }
	          }
	        }
	      }