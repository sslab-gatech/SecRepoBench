if (memcmp(&packet->line[i].ptr[j], "SEND ", 5) == 0
		|| memcmp(&packet->line[i].ptr[j], "CHAT ", 5) == 0
		|| memcmp(&packet->line[i].ptr[j], "chat ", 5) == 0
                || memcmp(&packet->line[i].ptr[j], "sslchat ", 8) == 0
		|| memcmp(&packet->line[i].ptr[j], "TSEND ", 6) == 0) {
		  j += 5;
		  for (k = j; k < packet->line[i].len; k++) {
		    if (packet->line[i].ptr[k] == ' ') {
		      space++;
		      if (space == 3) {
			k++;
			port = ndpi_parse_irc_port(ndpi_struct, &packet->line[i].ptr[k]);
			if (port != 0) {
			  if (src_id != NULL) {
			    src_id->irc_ts = packet->tick_timestamp;
			    less = 1;
			    for (counter = 0; counter < src_id->irc_number_of_port; counter++) {
			      if (src_id->irc_port[counter] == port) {
				src_id->last_time_port_used[counter] = packet->tick_timestamp;
				less = 0;
			      }
			    }
			    if (less == 1) {
			      if (src_id->irc_number_of_port < MAX_IRC_PORTS_TRACKED_PER_FLOW) {
				if (src_id->irc_number_of_port > 0) {
				  for (counter = 0; counter < src_id->irc_number_of_port; counter++) {
				    if (src_id->irc_port[counter] == port)
				      goto skip_src_port;
				  }
				}
				src_id->irc_port[src_id->irc_number_of_port] = port;
				src_id->last_time_port_used[src_id->irc_number_of_port] = packet->tick_timestamp;
				src_id->irc_number_of_port++;
			      } else {
				u_int32_t smallest_ts = src_id->last_time_port_used[0];
				u_int16_t smallest_index = 0;
				for (counter = 1; counter < src_id->irc_number_of_port; counter++) {
				  if (src_id->last_time_port_used[counter] < smallest_ts) {
				    smallest_ts = src_id->last_time_port_used[counter];
				    smallest_index = counter;
				  }
				}
				if (src_id->irc_port[smallest_index] != port) {
				  src_id->irc_port[smallest_index] = port;
				  src_id->last_time_port_used[smallest_index] = packet->tick_timestamp;
				}
			      }
			    skip_src_port:;
			  }
			  if (dst != NULL) {
			    less = 1;
			    dst->irc_ts = packet->tick_timestamp;
			    for (counter = 0; counter < dst->irc_number_of_port; counter++) {
			      if (dst->irc_port[counter] == port) {
				dst->last_time_port_used[counter] = packet->tick_timestamp;
				less = 0;
			      }
			    }
			    if (less == 1) {
			      if (dst->irc_number_of_port < MAX_IRC_PORTS_TRACKED_PER_FLOW) {
				if (dst->irc_number_of_port > 0) {
				  for (counter = 0; counter < dst->irc_number_of_port; counter++) {
				    if (dst->irc_port[counter] == port)
				      goto skip_dst_port;
				  }
				}
				dst->irc_port[dst->irc_number_of_port] = port;
				dst->last_time_port_used[dst->irc_number_of_port] = packet->tick_timestamp;
				dst->irc_number_of_port++;
			      } else {
				u_int32_t smallest_ts = dst->last_time_port_used[0];
				u_int16_t smallest_index = 0;
				for (counter = 1; counter < dst->irc_number_of_port; counter++) {
				  if (dst->last_time_port_used[counter] < smallest_ts) {
				    smallest_ts = dst->last_time_port_used[counter];
				    smallest_index = counter;
				  }
				}
				if (dst->irc_port[smallest_index] != port) {
				  dst->irc_port[smallest_index] = port;
				  dst->last_time_port_used[smallest_index] = packet->tick_timestamp;
				}
			      }
			    skip_dst_port:;
			  }
			}
			break;
		      }
		    }
		  }
		}