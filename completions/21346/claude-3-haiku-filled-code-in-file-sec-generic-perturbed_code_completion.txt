// <MASK>
if (memcmp(&packet->line[i].ptr[j], "SEND ", 5) == 0 || memcmp(&packet->line[i].ptr[j], "CHAT ", 5) == 0 ||
    memcmp(&packet->line[i].ptr[j], "chat ", 5) == 0 || memcmp(&packet->line[i].ptr[j], "sslchat ", 8) == 0 ||
    memcmp(&packet->line[i].ptr[j], "TSEND ", 6) == 0) {
  j += 5;
  if (memcmp(&packet->line[i].ptr[j], " ", 1) == 0) {
    j++;
  }
  port = 0;
  space = 0;
  for (; j < packet->line[i].len; j++) {
    if (packet->line[i].ptr[j] == ' ') {
      space++;
      if (space == 3) {
        j++;
        port = atoi(&packet->line[i].ptr[j]);
        if ((src_id != NULL && !ndpi_is_duplicate(src_id, port)) ||
            (dst != NULL && !ndpi_is_duplicate(dst, port))) {
          if (src_id != NULL && src_id->irc_number_of_port < NDPI_PROTOCOL_IRC_MAXPORT) {
            src_id->irc_port[src_id->irc_number_of_port++] = port;
            src_id->last_time_port_used[src_id->irc_number_of_port - 1] = packet->tick_timestamp;
          } else if (dst != NULL && dst->irc_number_of_port < NDPI_PROTOCOL_IRC_MAXPORT) {
            dst->irc_port[dst->irc_number_of_port++] = port;
            dst->last_time_port_used[dst->irc_number_of_port - 1] = packet->tick_timestamp;
          } else if (src_id != NULL) {
            NDPI_IRC_FIND_LESS(src_id->last_time_port_used, less);
            src_id->irc_port[less] = port;
            src_id->last_time_port_used[less] = packet->tick_timestamp;
          } else if (dst != NULL) {
            NDPI_IRC_FIND_LESS(dst->last_time_port_used, less);
            dst->irc_port[less] = port;
            dst->last_time_port_used[less] = packet->tick_timestamp;
          }
        }
        if (src_id != NULL) {
          src_id->irc_ts = packet->tick_timestamp;
        } else if (dst != NULL) {
          dst->irc_ts = packet->tick_timestamp;
        }
        break;
      }
    }
  }
}