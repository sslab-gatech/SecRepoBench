if (memcmp(&packet->line[i].ptr[j], "SEND ", 5) == 0
		|| memcmp(&packet->line[i].ptr[j], "CHAT ", 5) == 0
		|| memcmp(&packet->line[i].ptr[j], "chat ", 5) == 0
        || memcmp(&packet->line[i].ptr[j], "sslchat ", 8) == 0
		|| memcmp(&packet->line[i].ptr[j], "TSEND ", 6) == 0) {
	  j += 5;
	  for (k = j; k < packet->line[i].len; k++) {
	    if (packet->line[i].ptr[k] == ' ') {
	      space++;
	      if (space == 3) {
		k++;
		port = ndpi_strtol(&packet->line[i].ptr[k], 10);
		if (port > 0 && port < 65536) {
		  if (src_id != NULL) {
		    if (src_id->irc_number_of_port < MAX_IRC_PORTS_TRACKED) {
		      less = 1;
		      for (counter = 0; counter < src_id->irc_number_of_port; counter++) {
			if (src_id->irc_port[counter] == port) {
			  less = 0;
			  break;
			}
		      }
		      if (less == 1) {
			src_id->irc_port[src_id->irc_number_of_port] = port;
			src_id->irc_number_of_port++;
		      }
		    } else {
		      for (counter = 0; counter < src_id->irc_number_of_port; counter++) {
			if (src_id->irc_port[counter] == port) {
			  less = 0;
			  break;
			}
		      }
		      if (less == 1) {
			src_id->irc_port[src_id->irc_lru_index] = port;
		      }
		    }
		    src_id->last_time_port_used[src_id->irc_lru_index] = packet->tick_timestamp;
		    src_id->irc_lru_index++;
		    src_id->irc_lru_index %= MAX_IRC_PORTS_TRACKED;
		  } else if (dst != NULL) {
		    if (dst->irc_number_of_port < MAX_IRC_PORTS_TRACKED) {
		      less = 1;
		      for (counter = 0; counter < dst->irc_number_of_port; counter++) {
			if (dst->irc_port[counter] == port) {
			  less = 0;
			  break;
			}
		      }
		      if (less == 1) {
			dst->irc_port[dst->irc_number_of_port] = port;
			dst->irc_number_of_port++;
		      }
		    } else {
		      for (counter = 0; counter < dst->irc_number_of_port; counter++) {
			if (dst->irc_port[counter] == port) {
			  less = 0;
			  break;
			}
		      }
		      if (less == 1) {
			dst->irc_port[dst->irc_lru_index] = port;
		      }
		    }
		    dst->last_time_port_used[dst->irc_lru_index] = packet->tick_timestamp;
		    dst->irc_lru_index++;
		    dst->irc_lru_index %= MAX_IRC_PORTS_TRACKED;
		  }
		}
		break;
	      }
	    }
	  }
	}