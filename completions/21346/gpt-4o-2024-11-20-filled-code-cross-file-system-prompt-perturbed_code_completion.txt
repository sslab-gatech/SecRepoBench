// Extract the port number from the DCC command
	      u_int16_t dcc_port = 0;
	      int space_count = 0;
	      for (; j < packet->line[i].len; j++) {
	        if (packet->line[i].ptr[j] == ' ') {
	          space_count++;
	          if (space_count == 3) { // The port number is after the third space
	            dcc_port = atoi(&packet->line[i].ptr[j + 1]);
	            break;
	          }
	        }
	      }

	      // If a valid port is found, process it
	      if (dcc_port > 0) {
	        struct ndpi_id_struct *target_id = (src_id != NULL) ? src_id : dst;
	        if (target_id != NULL) {
	          int port_found = 0;

	          // Check if the port is already in the IRC port list
	          for (k = 0; k < target_id->irc_number_of_port; k++) {
	            if (target_id->irc_port[k] == dcc_port) {
	              port_found = 1;
	              target_id->last_time_port_used[k] = packet->tick_timestamp;
	              break;
	            }
	          }

	          // If the port is not found, add it to the list
	          if (!port_found) {
	            if (target_id->irc_number_of_port < MAX_IRC_PORTS) {
	              target_id->irc_port[target_id->irc_number_of_port] = dcc_port;
	              target_id->last_time_port_used[target_id->irc_number_of_port] = packet->tick_timestamp;
	              target_id->irc_number_of_port++;
	            } else {
	              // Replace the least recently used port if the list is full
	              u_int16_t oldest_index = 0;
	              for (k = 1; k < target_id->irc_number_of_port; k++) {
	                if (target_id->last_time_port_used[k] < target_id->last_time_port_used[oldest_index]) {
	                  oldest_index = k;
	                }
	              }
	              target_id->irc_port[oldest_index] = dcc_port;
	              target_id->last_time_port_used[oldest_index] = packet->tick_timestamp;
	            }
	          }

	          // Update the IRC timestamp for the target ID
	          if (src_id != NULL) {
	            src_id->irc_ts = packet->tick_timestamp;
	          } else if (dst != NULL) {
	            dst->irc_ts = packet->tick_timestamp;
	          }
	        }
	      }