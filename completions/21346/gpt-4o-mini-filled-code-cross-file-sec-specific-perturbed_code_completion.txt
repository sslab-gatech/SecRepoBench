u_int16_t port_number = 0;
	      u_int8_t found_port = 0;

	      // Extract the port number from the DCC command
	      while (j < packet->line[i].len && packet->line[i].ptr[j] != ' ') {
	        if (packet->line[i].ptr[j] >= '0' && packet->line[i].ptr[j] <= '9') {
	          port_number = port_number * 10 + (packet->line[i].ptr[j] - '0');
	        }
	        j++;
	      }

	      // Check if the port number is valid
	      if (port_number > 0 && port_number <= 65535) {
	        // Check if the source or destination structure is not NULL
	        if (src_id != NULL && src_id->irc_number_of_port < MAX_IRC_PORTS) {
	          // Add the port to the source ID structure
	          src_id->irc_port[src_id->irc_number_of_port++] = port_number;
	          found_port = 1;
	        } else if (dst != NULL && dst->irc_number_of_port < MAX_IRC_PORTS) {
	          // Add the port to the destination structure
	          dst->irc_port[dst->irc_number_of_port++] = port_number;
	          found_port = 1;
	        }
	      }

	      // If a new port was added, update the last time used
	      if (found_port) {
	        if (src_id != NULL) {
	          src_id->last_time_port_used[src_id->irc_number_of_port - 1] = packet->tick_timestamp;
	        } else if (dst != NULL) {
	          dst->last_time_port_used[dst->irc_number_of_port - 1] = packet->tick_timestamp;
	        }
	      }