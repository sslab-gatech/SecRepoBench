if (xml_start == q)
                      {
                        xml_start=(char *) ResizeQuantumMemory(xml_start,extent+1,
                          sizeof(*xml_start));
                        if (xml_start == (char *) NULL)
                          ThrowFatalException(ResourceLimitFatalError,
                            "MemoryAllocationFailed");
                      }
                    else
                      {
                        char
                          *new_xml_start;

                        new_xml_start=(char *) AcquireQuantumMemory(extent+1,
                          sizeof(*new_xml_start));
                        if (new_xml_start == (char *) NULL)
                          ThrowFatalException(ResourceLimitFatalError,
                            "MemoryAllocationFailed");
                        (void) CopyMagickMemory(new_xml_start,xml_start,offset);
                        xml_start=new_xml_start;
                      }
                    xml=xml_start+offset;
                    entity=strchr(xml,';');