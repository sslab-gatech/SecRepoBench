// Adjust the memory allocated for the parsed XML string to accommodate new content,
// ensuring that any necessary memory resizing or reallocation is handled properly.
// If the original memory block is not sufficient, allocate a new one and copy the
// existing content to it. Handle any memory allocation failures by throwing an
// appropriate error. Finally, ensure that the modified string is null-terminated.
extent = (size_t)(offset + length + strlen(entity));
xml_start = (char*)ResizeQuantumMemory(xml_start, extent, sizeof(*xml_start));
if (xml_start == NULL) {
    ThrowFatalException(ResourceLimitFatalError, "MemoryAllocationFailed");
}
xml = xml_start + offset;
entity = strchr(xml, ';');
(void)CopyMagickMemory(xml + length, entity + 1, strlen(entity));
(void)strncpy(xml, entities[i], length);
xml[extent - 1] = '\0'; // Ensure null-termination