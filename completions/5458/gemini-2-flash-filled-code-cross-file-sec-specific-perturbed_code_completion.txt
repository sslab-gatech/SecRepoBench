if (extent > strlen(xml_start))
                      {
                        char *new_xml_start = (char *) AcquireQuantumMemory(extent+1,sizeof(char));
                        if (new_xml_start == (char *) NULL)
                          ThrowFatalException(ResourceLimitFatalError,"MemoryAllocationFailed");
                        (void) strlcpy(new_xml_start,xml_start,(size_t) (offset+1));
                        (void) strlcat(new_xml_start,entities[i],extent+1);
                        (void) strlcat(new_xml_start,entity+1,extent+1);
                        xml_start=new_xml_start;
                        if (q != xml_start)
                          {
                            (void) RelinquishMagickMemory(q);
                            q=xml_start;
                          }
                      }
                    else
                      {
                        (void) memmove(xml+length,entity+1,strlen(entity+1)+1);
                        (void) memmove(xml,entities[i],length);
                        xml[length]='\0';
                      }