size_t new_extent = extent + length + 1;
char *new_xml_start = (char *) ResizeQuantumMemory(xml_start, new_extent, sizeof(*xml_start));
if (new_xml_start == (char *) NULL)
  ThrowFatalException(ResourceLimitFatalError, "MemoryAllocationFailed");
(void) CopyMagickMemory(new_xml_start, xml_start, offset);
(void) CopyMagickString(new_xml_start + offset, entities[i], length);
offset += length;
(void) CopyMagickMemory(new_xml_start + offset, entity + 1, strlen(entity));
new_xml_start[new_extent - 1] = '\0';
xml_start = new_xml_start;