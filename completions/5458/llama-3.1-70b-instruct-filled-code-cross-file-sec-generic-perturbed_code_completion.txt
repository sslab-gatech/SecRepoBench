if (extent < (size_t) (offset+length+strlen(entity)))
  {
    extent=(size_t) (offset+length+strlen(entity))+MagickPathExtent;
    xml_start=(char *) ResizeQuantumMemory(xml_start,extent,sizeof(*xml_start));
    if (xml_start == (char *) NULL)
      ThrowFatalException(ResourceLimitFatalError,"MemoryAllocationFailed");
  }
xml=xml_start+offset;
entity=strchr(xml,';');
if (entity!= (char *) NULL)
  (void) CopyMagickMemory(xml+length,entity+1,strlen(entity));
(void) strncpy(xml,entities[i],length);
xml_start[extent-1]='\0';