char *new_xml = (char *) AcquireQuantumMemory(extent + 1, sizeof(*new_xml));
                    if (new_xml == (char *) NULL)
                      ThrowFatalException(ResourceLimitFatalError, "MemoryAllocationFailed");
                    memcpy(new_xml, xml_start, offset);
                    memcpy(new_xml + offset, entities[i], length);
                    memcpy(new_xml + offset + length, entity + 1, strlen(entity));
                    new_xml[extent] = '\0'; // Ensure null-termination
                    xml_start = new_xml; // Update the pointer to the new memory