while (offset + 4 <= payload_length) {
        u_int16_t attr_type = ntohs(*(u_int16_t*)&payload[offset]);
        u_int16_t attr_length = ntohs(*(u_int16_t*)&payload[offset + 2]);
        u_int16_t total_attr_length = attr_length + 4; // 4 bytes for type and length

        if (offset + total_attr_length > payload_length) {
          break; // Prevent buffer overflow
        }

        // Process the attribute based on its type
        switch (attr_type) {
          case 0x0001: // Mapped-Address
            // Handle Mapped-Address attribute
            break;
          case 0x0002: // Response-Address
            // Handle Response-Address attribute
            break;
          // Add cases for other STUN attribute types as needed
          default:
            break;
        }

        offset += total_attr_length; // Move to the next attribute
      }