u_int16_t attr_type, attr_length;
  u_int offset = 20; // Start after STUN header

  while(offset < payload_length) {
    attr_type = ntohs(*((u_int16_t*)&payload[offset]));
    attr_length = ntohs(*((u_int16_t*)&payload[offset+2]));

    // Check for known application-specific attributes
    if(attr_type == 0x2008) { // WhatsApp specific attribute
      flow->guessed_host_protocol_id = NDPI_PROTOCOL_WHATSAPP_CALL;
      return(NDPI_IS_STUN);
    }

    // Move to next attribute (length is aligned to 4 bytes)
    offset += attr_length + 4; // 4 bytes for type and length

    // Break if offset exceeds payload length
    if(offset > payload_length)
      break;
  }