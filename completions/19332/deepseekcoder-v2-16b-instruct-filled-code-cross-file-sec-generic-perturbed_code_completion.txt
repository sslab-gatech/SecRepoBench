u_int offset = 20;

  /*
   This can either be the standard RTCP or Ms Lync RTCP that
   later will become Ms Lync RTP. In this case we need to
   be careful before deciding about the protocol before dissecting the packet

   MS Lync = Skype
   https://en.wikipedia.org/wiki/Skype_for_Business
   */

  while (offset < payload_length) {
    u_int8_t attribute_type = payload[offset];
    u_int16_t attribute_length = ntohs(*(u_int16_t*)&payload[offset + 2]);

    if (attribute_length % 4 != 0) {
      attribute_length = (attribute_length & 0xFFFC) + 4; // Align to 4-byte boundaries
    }

    switch (attribute_type) {
      case 0x0001: // Username
        // Process Username attribute
        break;
      case 0x0006: // Message-Integrity
        // Process Message-Integrity attribute
        break;
      case 0x0008: // Error-Code
        // Process Error-Code attribute
        break;
      case 0x0009: // Unknown-Attributes
        // Process Unknown-Attributes attribute
        break;
      case 0x000A: // Reflected-From
        // Process Reflected-From attribute
        break;
      case 0x0014: // XOR-Mapped-Address
        // Process XOR-Mapped-Address attribute
        break;
      case 0x0020: // SOFTWARE
        // Process SOFTWARE attribute
        break;
      case 0x0021: // ALTERNATE-SERVER
        // Process ALTERNATE-SERVER attribute
        break;
      case 0x0022: // FINGERPRINT
        // Process FINGERPRINT attribute
        break;
      default:
        // Unknown attribute type
        break;
    }

    offset += attribute_length;
  }

  // After processing all attributes, deduce the application protocol and set the guessed host protocol.
  if (flow->guessed_host_protocol_id == NDPI_PROTOCOL_UNKNOWN) {
    if (is_messenger_ip_address(ntohl(packet->iph->saddr)) || is_messenger_ip_address(ntohl(packet->iph->daddr))) {
      flow->guessed_host_protocol_id = NDPI_PROTOCOL_MESSENGER;
    } else if (is_google_ip_address(ntohl(packet->iph->saddr)) || is_google_ip_address(ntohl(packet->iph->daddr))) {
      flow->guessed_host_protocol_id = NDPI_PROTOCOL_HANGOUT_DUO;
    }
  }

  flow->guessed_protocol_id = NDPI_PROTOCOL_STUN;
  return NDPI_IS_STUN;