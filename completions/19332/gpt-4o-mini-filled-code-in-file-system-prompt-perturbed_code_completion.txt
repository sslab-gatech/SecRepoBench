while (offset < payload_length) {
        u_int16_t attr_type = ntohs(*(u_int16_t*)&payload[offset]);
        u_int16_t attr_length = ntohs(*(u_int16_t*)&payload[offset + 2]);
        offset += 4; // Move past type and length

        // Align to 4-byte boundary
        u_int16_t aligned_length = (attr_length + 3) & ~3;

        // Check for specific STUN attributes
        if (attr_type == 0x0001) { // Mapped-Address
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_WHATSAPP_CALL;
        } else if (attr_type == 0x0002) { // Response-Address
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_SIGNAL;
        } else if (attr_type == 0x0003) { // Change-Request
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_HANGOUT_DUO;
        }

        // Move to the next attribute
        offset += aligned_length;
      }