// Iterate through the payload to process STUN message attributes.
  // For each attribute, determine its type and length and align the length to 4-byte boundaries.
  // Depending on the attribute type, deduce the application protocol and set the guessed host protocol.
  // If specific attributes associated with known protocols are found (like WhatsApp, Skype, Zoom, etc.),
  // update the guessed protocol accordingly and return the result indicating the presence of STUN.
  // <MASK>
  while (offset < payload_length) {
    u_int16_t attr_type = ntohs(get_u_int16_t(payload + offset, 0));
    u_int16_t attr_len = ntohs(get_u_int16_t(payload + offset + 2, 0));
    attr_len = (attr_len + 3) & ~3; // Align length to 4-byte boundaries

    switch (attr_type) {
      case 0x0001: // MAPPED-ADDRESS
        if (attr_len == 12) {
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_WHATSAPP_CALL;
          return NDPI_IS_STUN;
        }
        break;
      case 0x0002: // CHANGE-REQUEST
        if (attr_len == 4) {
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_SKYPE;
          return NDPI_IS_STUN;
        }
        break;
      // Add more attribute type checks for other known protocols here...
      default:
        break;
    }

    offset += attr_len;
  }