while(offset < payload_length) {
        u_int16_t attr_type = ntohs(*((u_int16_t*)&payload[offset]));
        u_int16_t attr_len = ntohs(*((u_int16_t*)&payload[offset+2]));

        if(attr_len % 4 != 0) {
          attr_len += 4 - (attr_len % 4); // Align to 4-byte boundary
        }

        if(attr_type == 0x8022) { // Software attribute
          if(attr_len <= (payload_length - offset - 4)) {
            if(memcmp(&payload[offset+4], "WhatsApp", 8) == 0) {
              flow->guessed_host_protocol_id = NDPI_PROTOCOL_WHATSAPP_CALL;
              return(NDPI_IS_STUN);
            } else if(memcmp(&payload[offset+4], "Skype", 5) == 0) {
              flow->guessed_host_protocol_id = NDPI_PROTOCOL_SKYPE;
              return(NDPI_IS_STUN);
            } else if(memcmp(&payload[offset+4], "Zoom", 4) == 0) {
              flow->guessed_host_protocol_id = NDPI_PROTOCOL_ZOOM;
              return(NDPI_IS_STUN);
            }
          }
        }

        offset += 4 + attr_len;
      }