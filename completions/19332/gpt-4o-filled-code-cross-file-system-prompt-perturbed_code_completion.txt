while(offset < payload_length) {
        u_int16_t attr_type, attr_length;

        if((offset + 4) > payload_length)
          break;

        attr_type = ntohs(*((u_int16_t*)&payload[offset]));
        attr_length = ntohs(*((u_int16_t*)&payload[offset+2]));

        if((offset + 4 + attr_length) > payload_length)
          break;

        switch(attr_type) {
          case 0x0001: /* MAPPED-ADDRESS */
          case 0x0002: /* RESPONSE-ADDRESS */
          case 0x0003: /* CHANGE-REQUEST */
          case 0x0004: /* SOURCE-ADDRESS */
          case 0x0005: /* CHANGED-ADDRESS */
          case 0x0006: /* USERNAME */
          case 0x0007: /* PASSWORD */
          case 0x0008: /* MESSAGE-INTEGRITY */
          case 0x0009: /* ERROR-CODE */
          case 0x000A: /* UNKNOWN-ATTRIBUTES */
          case 0x000B: /* REFLECTED-FROM */
            /* Known STUN attributes */
            break;

          case 0x8022: /* SOFTWARE */
            if(attr_length >= 4 && strncmp((const char*)&payload[offset+4], "Zoom", 4) == 0) {
              flow->guessed_host_protocol_id = NDPI_PROTOCOL_ZOOM;
              return(NDPI_IS_STUN);
            }
            break;

          case 0x8028: /* FINGERPRINT */
            /* Check for specific application fingerprints */
            break;

          default:
            /* Unknown attribute, could be application-specific */
            break;
        }

        /* Align to 4-byte boundary */
        offset += 4 + ((attr_length + 3) & ~3);
      }