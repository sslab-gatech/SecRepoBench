while (offset < payload_length) {
  u_int16_t attr_type = ntohs(get_u_int16_t(payload, offset));
  u_int16_t attr_len = ntohs(get_u_int16_t(payload, offset + 2));
  
  attr_len = (attr_len + 3) & ~0x3;

  switch (attr_type) {
    case 0x8054: /* Candidate Identifier */
      if (attr_len == 4) {
        u_int32_t id = ntohl(get_u_int32_t(payload, offset + 4));
        if (id == 0xffffffff) {
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_WHATSAPP_CALL;
          return(NDPI_IS_STUN);
        }
      }
      break;

    case 0x8070: /* MS Lync/Skype */
      flow->guessed_host_protocol_id = NDPI_PROTOCOL_SKYPE_CALL;
      return(NDPI_IS_STUN);

    case 0x8054: /* Candidate Identifier */
    case 0x8055: /* ChannelNumber */
      flow->guessed_host_protocol_id = NDPI_PROTOCOL_ZOOM;
      return(NDPI_IS_STUN);

    case 0x8056: /* Username */
      if (attr_len >= 20 && memcmp(&payload[offset + 4], "signal.org", 10) == 0) {
        flow->guessed_host_protocol_id = NDPI_PROTOCOL_SIGNAL;
        return(NDPI_IS_STUN);
      }
      break;

    case 0x8058: /* Fingerprint */
      if (attr_len == 4) {
        flow->guessed_host_protocol_id = NDPI_PROTOCOL_WHATSAPP_CALL;
        return(NDPI_IS_STUN);
      }
      break;
  }

  offset += 4 + attr_len;
}