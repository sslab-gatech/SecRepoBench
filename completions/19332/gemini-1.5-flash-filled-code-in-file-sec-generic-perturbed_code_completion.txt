while (offset < messagelength) {
        u_int16_t attribute_type = ntohs(*((u_int16_t*)(payload + offset)));
        u_int16_t attribute_length = ntohs(*((u_int16_t*)(payload + offset + 2)));
        u_int32_t attribute_padding = (attribute_length + 3) & ~3; // Align to 4-byte boundary

        switch (attribute_type) {
          case 0x0001: // MAPPED-ADDRESS
            if (attribute_length >= 8) {
              u_int32_t ip_address = ntohl(*((u_int32_t*)(payload + offset + 4)));
              if (ip_address == 0x0A000000 || ip_address == 0x7F000000) {
                flow->guessed_host_protocol_id = NDPI_PROTOCOL_SKYPE;
              }
            }
            break;
          case 0x0005: // REALM
            // Check for specific realm values associated with known protocols.
            break;
          case 0x0006: // NONCE
            // Check for specific nonce values associated with known protocols.
            break;
          case 0x0008: // USERNAME
            // Check for specific username values associated with known protocols.
            break;
          // Add more cases for other STUN attributes as needed.
        }

        offset += attribute_padding + 4;
      }