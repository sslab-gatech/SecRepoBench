if((msg_type & 0x3EEF) <= 0x000B) /* http://www.3cx.com/blog/voip-howto/stun-details/ */ {
  u_int offset = 20;

  /*
   This can either be the standard RTCP or Ms Lync RTCP that
   later will become Ms Lync RTP. In this case we need to
   be careful before deciding about the protocol before dissecting the packet

   MS Lync = Skype
   https://en.wikipedia.org/wiki/Skype_for_Business
   */

  // Iterate through the payload to process STUN message attributes.
  // For each attribute, determine its type and length and align the length to 4-byte boundaries.
  // Depending on the attribute type, deduce the application protocol and set the guessed host protocol.
  // If specific attributes associated with known protocols are found (like WhatsApp, Skype, Zoom, etc.),
  // update the guessed protocol accordingly and return the result indicating the presence of STUN.
  // <MASK>

  // Check for WhatsApp attributes
  if (payload[offset] == 0x80) {
    // Check for WhatsApp attribute type 0x0001 (XOR-MAPPED-ADDRESS)
    if (payload[offset + 1] == 0x01) {
      // Check if the attribute value is a valid IPv4 address
      if (payload[offset + 2] == 0x00 && payload[offset + 3] == 0x00 && payload[offset + 4] == 0x00 && payload[offset + 5] == 0x00) {
        // Set the guessed host protocol to WhatsApp
        flow->guessed_host_protocol_id = NDPI_PROTOCOL_WHATSAPP;
        return(NDPI_IS_STUN);
      }
    }
  }

  // Check for Skype attributes
  if (payload[offset] == 0x90) {
    // Check for Skype attribute type 0x0001 (XOR-MAPPED-ADDRESS)
    if (payload[offset + 1] == 0x01) {
      // Check if the attribute value is a valid IPv4 address
      if (payload[offset + 2] == 0x00 && payload[offset + 3] == 0x00 && payload[offset + 4] == 0x00 && payload[offset + 5] == 0x00) {
        // Set the guessed host protocol to Skype
        flow->guessed_host_protocol_id = NDPI_PROTOCOL_SKYPE;
        return(NDPI_IS_STUN);
      }
    }
  }

  // Check for Zoom attributes
  if (payload[offset] == 0x80) {
    // Check for Zoom attribute type 0x0001 (XOR-MAPPED-ADDRESS)
    if (payload[offset + 1] == 0x01) {
      // Check if the attribute value is a valid IPv4 address
      if (payload[offset + 2] == 0x00 && payload[offset + 3] == 0x00 && payload[offset + 4] == 0x00 && payload[offset + 5] == 0x00) {
        // Set the guessed host protocol to Zoom
        flow->guessed_host_protocol_id = NDPI_PROTOCOL_ZOOM;
        return(NDPI_IS_STUN);
      }
    }
  }

  // If no specific attributes are found, return NDPI_IS_NOT_STUN
  return(NDPI_IS_NOT_STUN);
}