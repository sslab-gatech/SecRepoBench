u_int offset = 20;

  /*
   This can either be the standard RTCP or Ms Lync RTCP that
   later will become Ms Lync RTP. In this case we need to
   be careful before deciding about the protocol before dissecting the packet

   MS Lync = Skype
   https://en.wikipedia.org/wiki/Skype_for_Business
   */

  // Iterate through the payload to process STUN message attributes.
  // For each attribute, determine its type and length and align the length to 4-byte boundaries.
  // Depending on the attribute type, deduce the application protocol and set the guessed host protocol.
  // If specific attributes associated with known protocols are found (like WhatsApp, Skype, Zoom, etc.),
  // update the guessed protocol accordingly and return the result indicating the presence of STUN.

  while (offset < payload_length) {
    u_int8_t attribute_type = payload[offset];
    u_int16_t attribute_length = ntohs(*((u_int16_t*) &payload[offset + 2]));

    // Ensure attribute length is aligned to 4-byte boundaries
    if (attribute_length % 4 != 0) {
      attribute_length += 4 - (attribute_length % 4);
    }

    // Process the attribute based on its type
    switch (attribute_type) {
      case 0x0001: // Mapped Address
        // Process Mapped Address attribute
        break;
      case 0x0002: // User Name
        // Process User Name attribute
        break;
      case 0x0003: // Password
        // Process Password attribute
        break;
      case 0x0006: // Message Integrity
        // Process Message Integrity attribute
        break;
      case 0x0008: // Error Code
        // Process Error Code attribute
        break;
      case 0x0009: // Unknown Attributes
        // Process Unknown Attributes attribute
        break;
      case 0x000A: // Reflected From
        // Process Reflected From attribute
        break;
      case 0x0014: // XOR Mapped Address
        // Process XOR Mapped Address attribute
        break;
      // Add more cases for other attribute types as needed

      default:
        // Unknown attribute type
        break;
    }

    offset += attribute_length + 4; // Move to the next attribute
  }