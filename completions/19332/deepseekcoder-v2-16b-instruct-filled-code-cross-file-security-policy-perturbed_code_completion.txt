for (u_int offset = 20; offset < payload_length - 4; offset += 4) {
    u_int16_t attr_type = ntohs(*((u_int16_t*) &payload[offset]));
    u_int16_t attr_len = ntohs(*((u_int16_t*) &payload[offset + 2]));

    if (attr_len % 4 != 0) {
      attr_len = (attr_len & 0xFFFC) + 4; // Align to 4-byte boundaries
    }

    if (attr_type == 0x0001) { // Username attribute
      // Extract the username and determine the application protocol
      // For example, if the username matches a known pattern for WhatsApp, set the guessed protocol
      // Similarly, if it matches a pattern for Skype, set the guessed protocol accordingly
      // This part depends on the specific attributes and their values in the STUN message
      // <MASK>
    } else if (attr_type == 0x0006) { // Message Integrity attribute
      // Extract the message integrity value and verify it
      // This can be used to ensure the integrity of the STUN message
    } else if (attr_type == 0x0008) { // XOR-Mapped Address attribute
      // Extract the XOR-Mapped Address and determine the application protocol
      // This can help identify the protocol used by the peer
    }
  }