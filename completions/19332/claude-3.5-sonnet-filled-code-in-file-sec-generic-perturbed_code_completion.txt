while (offset < payload_length) {
  u_int16_t attr_type = ntohs(get_u_int16_t(payload, offset));
  u_int16_t attr_len = ntohs(get_u_int16_t(payload, offset + 2));
  u_int16_t aligned_len = (attr_len + 3) & ~0x3;

  offset += 4;

  if (attr_type == 0x8054) { /* CANDIDATE-IDENTIFIER */
    flow->guessed_host_protocol_id = NDPI_PROTOCOL_WHATSAPP_CALL;
    return NDPI_IS_STUN;
  } else if (attr_type == 0x8070) { /* MS-ALTERNATE-SERVER */
    flow->guessed_host_protocol_id = NDPI_PROTOCOL_SKYPE_TEAMS;
    return NDPI_IS_STUN;
  } else if (attr_type == 0x8090) { /* SOFTWARE */
    if (attr_len >= 4) {
      if (memcmp(&payload[offset], "zoom", 4) == 0) {
        flow->guessed_host_protocol_id = NDPI_PROTOCOL_ZOOM;
        return NDPI_IS_STUN;
      } else if (memcmp(&payload[offset], "coturn", 6) == 0) {
        flow->guessed_host_protocol_id = NDPI_PROTOCOL_WEBRTC;
        return NDPI_IS_STUN;
      }
    }
  }

  offset += aligned_len;
}