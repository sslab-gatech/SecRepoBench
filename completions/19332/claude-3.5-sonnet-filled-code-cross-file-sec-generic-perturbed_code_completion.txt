while (offset < payload_length) {
  u_int16_t attribute_type = ntohs(*((u_int16_t*)&payload[offset]));
  u_int16_t attribute_len = ntohs(*((u_int16_t*)&payload[offset+2]));

  offset += 4;

  if (attribute_len % 4 != 0)
    attribute_len += 4 - (attribute_len % 4);

  if (attribute_type == 0x8054) { // SOFTWARE
    if (attribute_len >= 20 && memcmp(&payload[offset], "Coturn", 6) == 0) {
      flow->guessed_host_protocol_id = NDPI_PROTOCOL_ZOOM;
      return(NDPI_IS_STUN);
    }
  } else if (attribute_type == 0x8070) { // MS_IMPLEMENTATION_VERSION
    flow->guessed_host_protocol_id = NDPI_PROTOCOL_SKYPE_TEAMS;
    return(NDPI_IS_STUN);
  } else if (attribute_type == 0x0024) { // PRIORITY
    if (attribute_len == 4 && payload[offset] == 0x7f) {
      flow->guessed_host_protocol_id = NDPI_PROTOCOL_WHATSAPP_CALL;
      return(NDPI_IS_STUN);
    }
  } else if (attribute_type == 0x8028) { // FINGERPRINT
    if (attribute_len == 4) {
      flow->guessed_host_protocol_id = NDPI_PROTOCOL_ZOOM;
      return(NDPI_IS_STUN);
    }
  }

  offset += attribute_len;

  if (offset >= payload_length)
    break;
}

flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
return(NDPI_IS_STUN);