{
  u_int offset = 20;

  /* Safely parse STUN attributes within payload bounds */
  while((offset + 4) <= (messagelength + 20)) {
    u_int16_t attr_type, attr_len;
    unsigned int aligned_len;

    /* Read attribute type and length */
    attr_type = (payload[offset] << 8) | payload[offset + 1];
    attr_len  = (payload[offset + 2] << 8) | payload[offset + 3];
    offset   += 4;

    /* Check attribute boundaries before reading */
    if((offset + attr_len) > (messagelength + 20)) {
      break;
    }

    /* Example checks based on attribute types; can be extended for more protocol detection */
    switch(attr_type) {
      case 0x0006: /* USERNAME */
        /* Inspect username data if desired, e.g., compare substrings for known patterns */
        break;
      case 0x8022: /* SOFTWARE */
        /* Inspect software attribute for known client identifiers (e.g., 'Zoom', 'Skype', etc.) */
        break;
      default:
        /* Unhandled attribute type - skip */
        break;
    }

    /* Advance offset in multiples of 4 (per STUN alignment rules) */
    aligned_len = (attr_len + 3) & ~3;
    offset += aligned_len;
  }
}