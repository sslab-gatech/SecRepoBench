while (offset < messagelength && offset + 4 <= payload_length) {
    u_int16_t attr_type = ntohs(*(u_int16_t *)(payload + offset));
    u_int16_t attr_len = ntohs(*(u_int16_t *)(payload + offset + 2));

    if (attr_len + offset + 4 > payload_length) {
        // Handle invalid attribute length
        break; 
    }

    switch (attr_type) {
        case 0x0006: // CHANNEL-NUMBER
            flow->guessed_host_protocol_id = NDPI_PROTOCOL_WHATSAPP_CALL;
            return NDPI_IS_STUN;
        case 0x0009: // LIFETIME
            flow->guessed_host_protocol_id = NDPI_PROTOCOL_SKYPE;
            return NDPI_IS_STUN;
        case 0x000C: // BANDWIDTH
            flow->guessed_host_protocol_id = NDPI_PROTOCOL_ZOOM;
            return NDPI_IS_STUN;
        // Add more cases for other protocols as needed
        default:
            break;
    }

    offset += 4 + attr_len;
    if (attr_len % 4 != 0) {
        offset += 4 - (attr_len % 4); // Align to 4-byte boundary
    }
}