while (offset < payload_length) {
        u_int16_t attr_type = ntohs(*(u_int16_t*)&payload[offset]);
        u_int16_t attr_length = ntohs(*(u_int16_t*)&payload[offset + 2]);
        u_int16_t aligned_length = (attr_length + 3) & ~0x03; // Align to 4-byte boundary

        if (offset + 4 + aligned_length > payload_length) {
          // If the attribute exceeds the payload length, break to avoid overflow
          break;
        }

        // Check for specific STUN attribute types and update guessed protocol
        switch (attr_type) {
          case 0x0001: // Mapped Address
            // Handle Mapped Address attribute
            break;
          case 0x0002: // Response Address
            // Handle Response Address attribute
            break;
          case 0x0003: // Change Request
            // Handle Change Request attribute
            break;
          // Add cases for other known STUN attributes as needed
          default:
            break;
        }

        offset += 4 + aligned_length; // Move to the next attribute
      }