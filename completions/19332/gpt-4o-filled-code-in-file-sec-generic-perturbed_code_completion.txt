while(offset < payload_length) {
        u_int16_t attr_type = ntohs(*((u_int16_t*)&payload[offset]));
        u_int16_t attr_length = ntohs(*((u_int16_t*)&payload[offset + 2]));
        u_int16_t aligned_length = (attr_length + 3) & ~3; // Align to 4-byte boundary

        if(attr_type == 0x8022 /* Software */) {
          if(attr_length >= 4 && strncmp((const char*)&payload[offset + 4], "WhatsApp", 8) == 0) {
            flow->guessed_host_protocol_id = NDPI_PROTOCOL_WHATSAPP_CALL;
            return(NDPI_IS_STUN);
          } else if(attr_length >= 4 && strncmp((const char*)&payload[offset + 4], "Skype", 5) == 0) {
            flow->guessed_host_protocol_id = NDPI_PROTOCOL_SKYPE;
            return(NDPI_IS_STUN);
          } else if(attr_length >= 4 && strncmp((const char*)&payload[offset + 4], "Zoom", 4) == 0) {
            flow->guessed_host_protocol_id = NDPI_PROTOCOL_ZOOM;
            return(NDPI_IS_STUN);
          }
        }

        offset += 4 + aligned_length;
      }