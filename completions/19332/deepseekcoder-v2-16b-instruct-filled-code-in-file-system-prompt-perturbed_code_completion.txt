u_int offset = 20;

  /*
   This can either be the standard RTCP or Ms Lync RTCP that
   later will become Ms Lync RTP. In this case we need to
   be careful before deciding about the protocol before dissecting the packet

   MS Lync = Skype
   https://en.wikipedia.org/wiki/Skype_for_Business
   */

  // Iterate through the payload to process STUN message attributes.
  // For each attribute, determine its type and length and align the length to 4-byte boundaries.
  // Depending on the attribute type, deduce the application protocol and set the guessed host protocol.
  // If specific attributes associated with known protocols are found (like WhatsApp, Skype, Zoom, etc.),
  // update the guessed protocol accordingly and return the result indicating the presence of STUN.

  while (offset < payload_length) {
    u_int8_t attribute_type = payload[offset];
    u_int16_t attribute_length = payload[offset + 1];

    // Align attribute_length to 4-byte boundaries
    if (attribute_length % 4 != 0) {
      attribute_length = (attribute_length + 4) & ~3;
    }

    // Process the attribute based on its type
    switch (attribute_type) {
      case 0x0001: // MAPPED-ADDRESS
        // Extract address and port
        // Determine the application protocol based on the address and port
        // Update the guessed host protocol accordingly
        break;
      case 0x0006: // USERNAME
        // Extract username
        // Determine the application protocol based on the username
        // Update the guessed host protocol accordingly
        break;
      case 0x0008: // MESSAGE-INTEGRITY
        // Extract integrity value
        // Determine the application protocol based on the integrity value
        // Update the guessed host protocol accordingly
        break;
      case 0x000A: // ERROR-CODE
        // Extract error code
        // Determine the application protocol based on the error code
        // Update the guessed host protocol accordingly
        break;
      case 0x000C: // UNKNOWN-ATTRIBUTES
        // Extract unknown attributes
        // Determine the application protocol based on the unknown attributes
        // Update the guessed host protocol accordingly
        break;
      // Add more cases for other attribute types as needed
      default:
        // Unknown attribute type
        break;
    }

    // Move to the next attribute
    offset += attribute_length;
  }