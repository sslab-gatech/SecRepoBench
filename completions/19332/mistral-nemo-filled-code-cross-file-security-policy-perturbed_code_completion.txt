// Iterate through the payload to process STUN message attributes.
  for (u_int offset = 20; offset + 4 <= payload_length; offset += 4) {
    u_int16_t attr_type = ntohs(*((u_int16_t*) &payload[offset]));
    u_int16_t attr_length = ntohs(*((u_int16_t*) &payload[offset + 2]));

    // Align attribute length to 4-byte boundaries.
    if (attr_length & 0x01) attr_length++;

    if (attr_type == 0x0001) { // MAPPED-ADDRESS attribute
      flow->guessed_host_protocol_id = NDPI_PROTOCOL_WHATSAPP_CALL;
      return(NDPI_IS_STUN);
    } else if (attr_type == 0x0002) { // CHANGE-REQUEST attribute
      flow->guessed_host_protocol_id = NDPI_PROTOCOL_SKYPE;
      return(NDPI_IS_STUN);
    } // Add more attribute type checks for other protocols as needed.

    // Process other attribute types and update the guessed protocol accordingly.
    // ...
  }

  goto udp_stun_found;