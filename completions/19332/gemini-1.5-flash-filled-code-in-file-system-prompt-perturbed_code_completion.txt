while(offset < messagelength) {
        u_int attr_type = ntohs(get_u_int16_t(payload + offset, 0));
        u_int attr_len = ntohs(get_u_int16_t(payload + offset, 2));
        u_int attr_pad = (attr_len % 4) ? (4 - (attr_len % 4)) : 0;

        switch(attr_type) {
          case 0x0001: /* MAPPED-ADDRESS */
            if(attr_len >= 8) {
              u_int32_t addr = get_u_int32_t(payload + offset, 4);
              if(is_messenger_ip_address(addr))
                flow->guessed_host_protocol_id = NDPI_PROTOCOL_MESSENGER;
              else if(is_google_ip_address(addr))
                flow->guessed_host_protocol_id = NDPI_PROTOCOL_HANGOUT_DUO;
            }
            break;

          case 0x0005: /* UNKNOWN-ATTRIBUTES */
            break;

          case 0x0006: /* REFLECTED-FROM */
            break;

          case 0x0008: /* SOFTWARE */
            break;

          case 0x0009: /* ALTERNATE-SERVER */
            break;

          case 0x000A: /* FINGERPRINT */
            break;

          case 0x000B: /* ICE-CONTROLLED */
            break;

          case 0x8022: /* ICE-CANDIDATE */
            break;

          case 0x8023: /* ICE-OPTIONS */
            break;

          default:
            break;
        }

        offset += attr_len + 4 + attr_pad;
      }