while (offset < messagelength) {
        u_int16_t type = ntohs(*((u_int16_t*)(payload + offset)));
        u_int16_t len = ntohs(*((u_int16_t*)(payload + offset + 2)));
        offset += 4;
        offset += len;
        offset = (offset + 3) & (~3);

        if (type == 0x0001) { // MAPPED-ADDRESS
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x0005) { // XOR-MAPPED-ADDRESS
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x0006) { // REFLECTED-FROM
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x0008) { // USE-CANDIDATE
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x0009) { // ICE-CONTROLLING
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x000A) { // ICE-CONTROLLED
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x000B) { // CHOSEN-ADDRESS
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x0014) { // SOFTWARE
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x0020) { // ALTERNATE-SERVER
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x8022) { // FINGERPRINT
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x8023) { // RESPONSE-ORIGIN
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x8028) { // REALM
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x8029) { // NONCE
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x802A) { // USERNAME
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x802B) { // PASSWORD
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x802C) { // MESSAGE-INTEGRITY
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x802D) { // ERROR-CODE
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x802E) { // UNKNOWN-ATTRIBUTES
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x8034) { // REALM
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x8035) { // NONCE
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x8036) { // USERNAME
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x8037) { // PASSWORD
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x8038) { // MESSAGE-INTEGRITY
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x8039) { // ERROR-CODE
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        } else if (type == 0x803A) { // UNKNOWN-ATTRIBUTES
          flow->guessed_host_protocol_id = NDPI_PROTOCOL_STUN;
        }
      }