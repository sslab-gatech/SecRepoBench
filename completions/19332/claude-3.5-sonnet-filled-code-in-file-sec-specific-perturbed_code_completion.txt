while (offset < payload_length) {
  u_int16_t attr_type = ntohs(get_u_int16_t(payload, offset));
  u_int16_t attr_len = ntohs(get_u_int16_t(payload, offset + 2));
  
  attr_len = (attr_len + 3) & ~0x3;

  if (attr_type == 0x8054) { /* CANDIDATE-IDENTIFIER */
    flow->guessed_host_protocol_id = NDPI_PROTOCOL_WHATSAPP_CALL;
    return(NDPI_IS_STUN);
  } else if (attr_type == 0x8070) { /* MS-ALTERNATE-SERVER */
    flow->guessed_host_protocol_id = NDPI_PROTOCOL_SKYPE_TEAMS;
    return(NDPI_IS_STUN);
  } else if (attr_type == 0x8090) { /* MS-SEQUENCE-NUMBER */
    flow->guessed_host_protocol_id = NDPI_PROTOCOL_SKYPE_TEAMS;
    return(NDPI_IS_STUN);
  } else if (attr_type == 0x8095) { /* ZOOM-IDENTIFIER */
    flow->guessed_host_protocol_id = NDPI_PROTOCOL_ZOOM;
    return(NDPI_IS_STUN);
  }

  offset += 4 + attr_len;

  if (offset >= payload_length)
    break;
}