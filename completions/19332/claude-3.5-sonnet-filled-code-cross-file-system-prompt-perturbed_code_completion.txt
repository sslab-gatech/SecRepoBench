while(offset < payload_length) {
  u_int16_t attribute_type = ntohs(*((u_int16_t*)&payload[offset]));
  u_int16_t attribute_len = ntohs(*((u_int16_t*)&payload[offset+2]));

  offset += 4;

  if(attribute_len % 4 != 0)
    attribute_len += 4 - (attribute_len % 4);

  if(attribute_type == 0x8054 /* CANDIDATE-IDENTIFIER */) {
    flow->guessed_host_protocol_id = NDPI_PROTOCOL_WHATSAPP_CALL;
    return(NDPI_IS_STUN);
  } else if(attribute_type == 0x8070 /* MS_IMPLEMENTATION_VERSION */) {
    if(payload[offset] == 0x01) {
      flow->guessed_host_protocol_id = NDPI_PROTOCOL_SKYPE_CALL;
      return(NDPI_IS_STUN);
    }
  } else if(attribute_type == 0x8090 /* ZOOM_IMPLEMENTATION_VERSION */) {
    flow->guessed_host_protocol_id = NDPI_PROTOCOL_ZOOM;
    return(NDPI_IS_STUN);
  }

  offset += attribute_len;
}

if(msg_type == 0x0001) /* Binding Request */ {
  /* This is a heuristic check for WebRTC */
  if(flow->guessed_host_protocol_id == NDPI_PROTOCOL_UNKNOWN) {
    flow->guessed_host_protocol_id = NDPI_PROTOCOL_WEBRTC;
  }
}