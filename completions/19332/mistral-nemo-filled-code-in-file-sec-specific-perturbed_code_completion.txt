// Iterate through the payload to process STUN message attributes.
for (offset = 20; offset < payload_length; offset += attr_length) {
  u_int16_t attr_type = ntohs(get_u_int16_t(payload, offset));
  u_int16_t attr_length = ntohs(get_u_int16_t(payload, offset + 2));

  // Align attribute length to 4-byte boundaries.
  attr_length = (attr_length + 3) & ~3;

  switch (attr_type) {
    case 0x0001: // MAPPED-ADDRESS
      if (attr_length == 12) {
        flow->guessed_host_protocol_id = NDPI_PROTOCOL_WHATSAPP_CALL;
        return NDPI_IS_STUN;
      }
      break;
    case 0x0005: // CHANGE-REQUEST
      if (attr_length == 4) {
        flow->guessed_host_protocol_id = NDPI_PROTOCOL_SKYPE;
        return NDPI_IS_STUN;
      }
      break;
    case 0x0006: // SOURCE-ADDRESS
      if (attr_length == 8) {
        flow->guessed_host_protocol_id = NDPI_PROTOCOL_ZOOM;
        return NDPI_IS_STUN;
      }
      break;
    // Add more attribute type cases for other known protocols.
    default:
      break;
  }
}

return NDPI_IS_NOT_STUN;