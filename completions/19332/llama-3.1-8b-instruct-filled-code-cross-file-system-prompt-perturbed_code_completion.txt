if((msg_type & 0x3EEF) <= 0x000B) /* http://www.3cx.com/blog/voip-howto/stun-details/ */ {
    u_int offset = 20;

    /*
     This can either be the standard RTCP or Ms Lync RTCP that
     later will become Ms Lync RTP. In this case we need to
     be careful before deciding about the protocol before dissecting the packet

     MS Lync = Skype
     https://en.wikipedia.org/wiki/Skype_for_Business
     */

    // Iterate through the payload to process STUN message attributes.
    // For each attribute, determine its type and length and align the length to 4-byte boundaries.
    // Depending on the attribute type, deduce the application protocol and set the guessed host protocol.
    // If specific attributes associated with known protocols are found (like WhatsApp, Skype, Zoom, etc.),
    // update the guessed protocol accordingly and return the result indicating the presence of STUN.
    // <MASK>

    // Check for WhatsApp attributes
    if (payload[offset] == 0x01 && payload[offset + 1] == 0x01) {
      // WhatsApp attribute type 1, length 1
      offset += 2;
    } else if (payload[offset] == 0x01 && payload[offset + 1] == 0x02) {
      // WhatsApp attribute type 1, length 2
      offset += 3;
    }

    // Check for Skype attributes
    if (payload[offset] == 0x01 && payload[offset + 1] == 0x03) {
      // Skype attribute type 1, length 3
      offset += 4;
    } else if (payload[offset] == 0x01 && payload[offset + 1] == 0x04) {
      // Skype attribute type 1, length 4
      offset += 5;
    }

    // Check for Zoom attributes
    if (payload[offset] == 0x01 && payload[offset + 1] == 0x05) {
      // Zoom attribute type 1, length 5
      offset += 6;
    } else if (payload[offset] == 0x01 && payload[offset + 1] == 0x06) {
      // Zoom attribute type 1, length 6
      offset += 7;
    }

    // If we've reached the end of the payload, it's likely a standard RTCP packet
    if (offset >= payload_length) {
      flow->guessed_host_protocol_id = NDPI_PROTOCOL_RTP;
      return(NDPI_IS_STUN);
    }

    // If we've reached this point, it's likely a Ms Lync RTCP packet
    flow->guessed_host_protocol_id = NDPI_PROTOCOL_MSLYNC_RTCP;
    return(NDPI_IS_STUN);
  } else if(msg_type == 0x0800) {
    flow->guessed_host_protocol_id = NDPI_PROTOCOL_WHATSAPP_CALL;
    return(NDPI_IS_STUN);
  }