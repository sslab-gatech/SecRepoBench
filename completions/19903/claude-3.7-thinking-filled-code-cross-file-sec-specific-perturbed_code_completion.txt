if (*expression == '\0')
    FxReturn(0.0);
  if (*expression == '(')
    {
      char *e;
      size_t parenthesis = 1;
      size_t length;

      e = subexpression;
      expression++;
      while ((*expression != '\0') && (parenthesis > 0))
      {
        if (*expression == '(')
          parenthesis++;
        else if (*expression == ')')
          parenthesis--;
        if ((parenthesis > 0) && (e < subexpression+MagickPathExtent-1))
          *e++ = *expression;
        expression++;
      }
      *e = '\0';
      if (parenthesis != 0)
        {
          (void) ThrowMagickException(exception,GetMagickModule(),
            OptionError,"UnableToParseExpression","`%s'",subexpression);
          FxReturn(0.0);
        }
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,
        depth+1,beta,exception);
      FxReturn(alpha);
    }
  if (strchr("e+-/*%&|^~!<>?:=,;",*expression) != (char *) NULL)
    {
      (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
        "UnableToParseExpression","`%s'",expression);
      FxReturn(0.0);
    }