if (strchr("(",(int) *expression) != (char *) NULL)
  {
    char
      *p;

    size_t
      length;

    length=MagickPathExtent;
    p=expression+1;
    for (q=subexpression; (*p != ')') && (*p != '\0'); p++)
    {
      if ((size_t) (q-subexpression+1) >= length)
        {
          *q='\0';
          length<<=1;
          subexpression=(char *) ResizeQuantumMemory(subexpression,length+
            MagickPathExtent,sizeof(*subexpression));
          if (subexpression == (char *) NULL)
            {
              (void) ThrowMagickException(exception,GetMagickModule(),
                ResourceLimitError,"MemoryAllocationFailed","`%s'",
                expression);
              FxReturn(0.0);
            }
          q=subexpression+strlen(subexpression);
        }
      *q++=(*p);
    }
    *q='\0';
    if (*p != ')')
      {
        (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
          "UnbalancedParenthesis","`%s'",expression);
        FxReturn(0.0);
      }
    alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,depth+1,
      beta,exception);
    expression=p+1;
  }
else
  {
    q=subexpression;
    while ((*expression != '\0') && (isalnum((int) ((unsigned char) *expression)) ||
           (*expression == '_') || (*expression == '.') ||
           (*expression == '[') || (*expression == ']')))
    {
      if ((size_t) (q-subexpression+1) >= MagickPathExtent)
        break;
      *q++=(*expression++);
    }
    *q='\0';
    alpha=FxGetSymbol(fx_info,channel,x,y,subexpression,depth+1,exception);
  }