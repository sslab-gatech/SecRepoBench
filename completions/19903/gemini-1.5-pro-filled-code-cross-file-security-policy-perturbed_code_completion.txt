if (strchr("(",(int) *expression) != (char *) NULL)
    {
      level=0;
      subexpression=AcquireString(expression);
      for (q=(char *) expression; *q != '\0'; q++)
      {
        if (*q == '(')
          {
            level++;
            if (level == 1)
              expression=q+1;
          }
        else
          if (*q == ')')
            {
              level--;
              if (level == 0)
                {
                  size_t length = q - expression;
                  if (length > 0) {
                    (void) CopyMagickString(subexpression, expression, length);
                    subexpression[length] = '\0';
                  } else {
                    subexpression[0] = '\0';
                  }
                  result = FxEvaluateSubexpression(fx_info, channel, x, y,
                                                   subexpression, depth + 1, beta, exception);
                  FxReturn(result);
                }
            }
        if (level < 0)
          break;
      }
      subexpression=DestroyString(subexpression);
      if (level != 0)
        {
          (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
            "UnbalancedParenthesis","`%s'",expression);
          FxReturn(0.0);
        }
    }
   else if (IsFxFunction(expression,"abs",3) != MagickFalse)
     {
       expression+=3;
       result=fabs(FxEvaluateSubexpression(fx_info,channel,x,y,expression,
         depth+1,beta,exception));
       FxReturn(result);
     }