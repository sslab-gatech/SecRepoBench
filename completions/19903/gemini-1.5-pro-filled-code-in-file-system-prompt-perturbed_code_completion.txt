if (strchr("(",(int) *expression) != (char *) NULL)
    {
      level=0;
      p=expression;
      while ((*p != '\0') && ((level != 1) || (strchr(")",(int) *p) == (char *) NULL)))
      {
        if (strchr("(",(int) *p) != (char *) NULL)
          level++;
        else
          if (strchr(")",(int) *p) != (char *) NULL)
            level--;
        p++;
      }
      (void) CopyMagickString(subexpression,expression,(size_t) (p-expression));
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,depth+1,
        beta,exception);
      if (*p != '\0')
        p++;
      expression=p;
      FxReturn(alpha);
    }
  if (IsFxFunction(expression,"abs",3) != MagickFalse)
    FxReturn(fabs(FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,
      depth+1,beta,exception)));
#if defined(MAGICKCORE_HAVE_ACOSH)
  if (IsFxFunction(expression,"acosh",5) != MagickFalse)
    FxReturn(acosh(FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,
      depth+1,beta,exception)));
#endif
  if (IsFxFunction(expression,"acos",4) != MagickFalse)
    FxReturn(acos(FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,
      depth+1,beta,exception)));
#if defined(MAGICKCORE_HAVE_ASINH)
  if (IsFxFunction(expression,"asinh",5) != MagickFalse)
    FxReturn(asinh(FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,
      depth+1,beta,exception)));
#endif
  if (IsFxFunction(expression,"asin",4) != MagickFalse)
    FxReturn(asin(FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,
      depth+1,beta,exception)));
  if (IsFxFunction(expression,"atan",4) != MagickFalse)
    FxReturn(atan(FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,
      depth+1,beta,exception)));
  if (IsFxFunction(expression,"atan2",5) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
        beta,exception);
      FxReturn(atan2(alpha,*beta));
    }
#if defined(MAGICKCORE_HAVE_ATANH)
  if (IsFxFunction(expression,"atanh",5) != MagickFalse)
    FxReturn(atanh(FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,
      depth+1,beta,exception)));
#endif
  if (IsFxFunction(expression,"ceil",4) != MagickFalse)
    FxReturn(ceil(FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,
      depth+1,beta,exception)));
  if (IsFxFunction(expression,"cos",3) != MagickFalse)
    FxReturn(cos(FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,
      depth+1,beta,exception)));
  if (IsFxFunction(expression,"cosh",4) != MagickFalse)
    FxReturn(cosh(FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,
      depth+1,beta,exception)));
  if (IsFxFunction(expression,"debug",5) != MagickFalse)
    {
      char
        message[MagickPathExtent];

      (void) CopyMagickString(subexpression,expression+5,MagickPathExtent);
      (void) FormatLocaleString(message,MagickPathExtent,"%s=%.*g\n",
        subexpression,*beta,alpha);
      (void) (fx_info->file != (FILE *) NULL ? FormatFile(fx_info->file,"%s",
        message) : FormatLocaleFile(stderr,"%s",message));
      FxReturn(alpha);
    }
  if (IsFxFunction(expression,"exp",3) != MagickFalse)
    FxReturn(exp(FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,
      depth+1,beta,exception)));
  if (IsFxFunction(expression,"floor",5) != MagickFalse)
    FxReturn(floor(FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,
      depth+1,beta,exception)));
  if (IsFxFunction(expression,"hypot",5) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
        beta,exception);
      FxReturn(hypot(alpha,*beta));
    }
  if (IsFxFunction(expression,"int",3) != MagickFalse)
    FxReturn(floor(FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,
      depth+1,beta,exception)+0.5));