if (strchr("(",(int) *expression) != (char *) NULL)
    {
      level=0;
      p=expression;
      while ((*p != '\0') && ((level != 1) || (strchr(")",(int) *p) == (char *) NULL)))
      {
        if (strchr("(",(int) *p) != (char *) NULL)
          level++;
        else
          if (strchr(")",(int) *p) != (char *) NULL)
            level--;
        p++;
      }
      (void) CopyMagickString(subexpression,expression,(size_t) (p-expression));
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression+1,depth+1,
        beta,exception);
      if (*p != '\0')
        p++;
      expression=p;
      FxReturn(alpha);
    }
  if (IsFxFunction(expression,"abs",3) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      FxReturn(fabs(alpha));
    }
  if (IsFxFunction(expression,"acos",4) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
        beta,exception);
      FxReturn(acos(alpha));
    }
#if defined(MAGICKCORE_HAVE_ACOSH)
  if (IsFxFunction(expression,"acosh",5) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
        beta,exception);
      FxReturn(acosh(alpha));
    }
#endif
  if (IsFxFunction(expression,"asin",4) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
        beta,exception);
      FxReturn(asin(alpha));
    }
#if defined(MAGICKCORE_HAVE_ASINH)
  if (IsFxFunction(expression,"asinh",5) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
        beta,exception);
      FxReturn(asinh(alpha));
    }
#endif
  if (IsFxFunction(expression,"atan",4) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
        beta,exception);
      FxReturn(atan(alpha));
    }
  if (IsFxFunction(expression,"atan2",5) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
        beta,exception);
      *beta=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
        beta,exception);
      FxReturn(atan2(alpha,*beta));
    }
#if defined(MAGICKCORE_HAVE_ATANH)
  if (IsFxFunction(expression,"atanh",5) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
        beta,exception);
      FxReturn(atanh(alpha));
    }
#endif
  if (IsFxFunction(expression,"ceil",4) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
        beta,exception);
      FxReturn(ceil(alpha));
    }
  if (IsFxFunction(expression,"cos",3) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      FxReturn(cos(alpha));
    }
  if (IsFxFunction(expression,"cosh",4) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
        beta,exception);
      FxReturn(cosh(alpha));
    }
  if (IsFxFunction(expression,"debug",5) != MagickFalse)
    {
      char
        format[MagickPathExtent],
        *message;

      const char
        *arguments;

      double
        gamma;

      gamma=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
        beta,exception);
      arguments=GetMagickArgument(expression+5);
      if (arguments == (const char *) NULL)
        (void) FormatLocaleString(format,MagickPathExtent,"%g",gamma);
      else
        (void) FormatLocaleString(format,MagickPathExtent,"%s",arguments);
      message=GetExceptionMessage(errno);
      if (fx_info->file != (FILE *) NULL)
        (void) FormatLocaleFile(fx_info->file,format,message);
      message=DestroyString(message);
      FxReturn(gamma);
    }

  if (IsFxFunction(expression,"exp",3) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      FxReturn(exp(alpha));
    }
  if (IsFxFunction(expression,"floor",5) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
        beta,exception);
      FxReturn(floor(alpha));
    }
  if (IsFxFunction(expression,"hypot",5) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
        beta,exception);
      *beta=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
        beta,exception);
      FxReturn(hypot(alpha,*beta));
    }
  if ((IsFxFunction(expression,"int",3) != MagickFalse) ||
      (IsFxFunction(expression,"lng",3) != MagickFalse))
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      FxReturn((double) ((ssize_t) (alpha+0.5)));
    }
  if (IsFxFunction(expression,"j0",2) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+2,depth+1,
        beta,exception);
      FxReturn(j0(alpha));
    }
  if (IsFxFunction(expression,"j1",2) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+2,depth+1,
        beta,exception);
      FxReturn(j1(alpha));
    }
  if (IsFxFunction(expression,"log",3) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      FxReturn(log10(alpha));
    }
  if (IsFxFunction(expression,"ln",2) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+2,depth+1,
        beta,exception);
      FxReturn(log(alpha));
    }
  if (IsFxFunction(expression,"max",3) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      *beta=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      FxReturn(alpha > *beta ? alpha : *beta);
    }
  if (IsFxFunction(expression,"min",3) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      *beta=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      FxReturn(alpha < *beta ? alpha : *beta);
    }
  if (IsFxFunction(expression,"mod",3) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      *beta=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      FxReturn((double) ((ssize_t) alpha % (ssize_t) *beta));
    }
  if (IsFxFunction(expression,"pow",3) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      *beta=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      FxReturn(pow(alpha,*beta));
    }
  if (IsFxFunction(expression,"rand",4) != MagickFalse)
    {
      FxReturn(GetPseudoRandomValue(fx_info->random_info));
    }
  if (IsFxFunction(expression,"round",5) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
        beta,exception);
      FxReturn(alpha < 0.0 ? floor(alpha-0.5) : floor(alpha+0.5));
    }
  if (IsFxFunction(expression,"sign",4) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
        beta,exception);
      FxReturn(alpha < 0.0 ? -1.0 : 1.0);
    }
  if (IsFxFunction(expression,"sin",3) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      FxReturn(sin(alpha));
    }
  if (IsFxFunction(expression,"sinh",4) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
        beta,exception);
      FxReturn(sinh(alpha));
    }
  if (IsFxFunction(expression,"sqrt",4) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
        beta,exception);
      FxReturn(sqrt(alpha));
    }
  if (IsFxFunction(expression,"tan",3) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      FxReturn(tan(alpha));
    }
  if (IsFxFunction(expression,"tanh",4) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
        beta,exception);
      FxReturn(tanh(alpha));
    }
  if (IsFxFunction(expression,"trunc",5) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
        beta,exception);
      FxReturn(alpha < 0.0 ? ceil(alpha) : floor(alpha));
    }