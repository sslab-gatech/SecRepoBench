/*
    Mathematical functions.
  */
  if (strchr("(",(int) *expression) != (char *) NULL)
    {
      (void) CopyMagickString(subexpression,expression+1,MagickPathExtent);
      p=FxSubexpression(subexpression,exception);
      if (*p == ',')
        {
          *p='\0';
          gamma=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,
            depth+1,beta,exception);
          (void) CopyMagickString(subexpression,p+1,MagickPathExtent);
          (void) FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,
            depth+1,beta,exception);
        }
      else
        gamma=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,
          depth+1,beta,exception);
      switch (*expression)
      {
        case 'a':
        {
          if (IsFxFunction(expression,"abs",3) != MagickFalse)
            {
              *beta=fabs(gamma);
              FxReturn(*beta);
            }
          if (IsFxFunction(expression,"acos",4) != MagickFalse)
            {
              *beta=acos(gamma);
              FxReturn(*beta);
            }
          if (IsFxFunction(expression,"asin",4) != MagickFalse)
            {
              *beta=asin(gamma);
              FxReturn(*beta);
            }
          if (IsFxFunction(expression,"atan",4) != MagickFalse)
            {
              *beta=atan(gamma);
              FxReturn(*beta);
            }
          if (IsFxFunction(expression,"atan2",5) != MagickFalse)
            {
              *beta=atan2(gamma,*beta);
              FxReturn(*beta);
            }
          break;
        }
        case 'c':
        {
          if (IsFxFunction(expression,"ceil",4) != MagickFalse)
            {
              *beta=ceil(gamma);
              FxReturn(*beta);
            }
          if (IsFxFunction(expression,"cos",3) != MagickFalse)
            {
              *beta=cos(gamma);
              FxReturn(*beta);
            }
          if (IsFxFunction(expression,"cosh",4) != MagickFalse)
            {
              *beta=cosh(gamma);
              FxReturn(*beta);
            }
          break;
        }
        case 'e':
        {
          if (IsFxFunction(expression,"exp",3) != MagickFalse)
            {
              *beta=exp(gamma);
              FxReturn(*beta);
            }
          break;
        }
        case 'f':
        {
          if (IsFxFunction(expression,"floor",5) != MagickFalse)
            {
              *beta=floor(gamma);
              FxReturn(*beta);
            }
          break;
        }
        case 'l':
        {
          if (IsFxFunction(expression,"log",3) != MagickFalse)
            {
              *beta=log(gamma);
              FxReturn(*beta);
            }
          if (IsFxFunction(expression,"log10",5) != MagickFalse)
            {
              *beta=log10(gamma);
              FxReturn(*beta);
            }
          break;
        }
        case 'p':
        {
          if (IsFxFunction(expression,"pow",3) != MagickFalse)
            {
              *beta=pow(gamma,*beta);
              FxReturn(*beta);
            }
          break;
        }
        case 'r':
        {
          if (IsFxFunction(expression,"round",5) != MagickFalse)
            {
              *beta=round(gamma);
              FxReturn(*beta);
            }
          break;
        }
        case 's':
        {
          if (IsFxFunction(expression,"sin",3) != MagickFalse)
            {
              *beta=sin(gamma);
              FxReturn(*beta);
            }
          if (IsFxFunction(expression,"sinh",4) != MagickFalse)
            {
              *beta=sinh(gamma);
              FxReturn(*beta);
            }
          if (IsFxFunction(expression,"sqrt",4) != MagickFalse)
            {
              *beta=sqrt(gamma);
              FxReturn(*beta);
            }
          break;
        }
        case 't':
        {
          if (IsFxFunction(expression,"tan",3) != MagickFalse)
            {
              *beta=tan(gamma);
              FxReturn(*beta);
            }
          if (IsFxFunction(expression,"tanh",4) != MagickFalse)
            {
              *beta=tanh(gamma);
              FxReturn(*beta);
            }
          break;
        }
        default:
          break;
      }
    }