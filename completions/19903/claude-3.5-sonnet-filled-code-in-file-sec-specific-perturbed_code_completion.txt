if (strchr("(",(int) *expression) != (char *) NULL)
  {
    char
      *subexpression;

    subexpression=AcquireString(expression);
    (void) CopyMagickString(subexpression,expression+1,MagickPathExtent);
    subexpression[strlen(subexpression)-1]='\0';
    alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,depth+1,
      &beta,exception);
    subexpression=DestroyString(subexpression);
    FxReturn(alpha);
  }
if (strchr("{",(int) *expression) != (char *) NULL)
  {
    char
      *subexpression;

    subexpression=AcquireString(expression);
    (void) CopyMagickString(subexpression,expression+1,MagickPathExtent);
    subexpression[strlen(subexpression)-1]='\0';
    alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,depth+1,
      &beta,exception);
    subexpression=DestroyString(subexpression);
    FxReturn(alpha);
  }
if (IsFxFunction(expression,"abs",3) != MagickFalse)
  {
    alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
      beta,exception);
    FxReturn(fabs(alpha));
  }
if (IsFxFunction(expression,"acos",4) != MagickFalse)
  {
    alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
      beta,exception);
    FxReturn(acos(alpha));
  }
if (IsFxFunction(expression,"asin",4) != MagickFalse)
  {
    alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
      beta,exception);
    FxReturn(asin(alpha));
  }
if (IsFxFunction(expression,"atan",4) != MagickFalse)
  {
    alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
      beta,exception);
    FxReturn(atan(alpha));
  }
if (IsFxFunction(expression,"ceil",4) != MagickFalse)
  {
    alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
      beta,exception);
    FxReturn(ceil(alpha));
  }
if (IsFxFunction(expression,"cos",3) != MagickFalse)
  {
    alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
      beta,exception);
    FxReturn(cos(alpha));
  }
if (IsFxFunction(expression,"exp",3) != MagickFalse)
  {
    alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
      beta,exception);
    FxReturn(exp(alpha));
  }
if (IsFxFunction(expression,"floor",5) != MagickFalse)
  {
    alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
      beta,exception);
    FxReturn(floor(alpha));
  }
if (IsFxFunction(expression,"log",3) != MagickFalse)
  {
    alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
      beta,exception);
    FxReturn(log(alpha));
  }
if (IsFxFunction(expression,"pow",3) != MagickFalse)
  {
    alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
      beta,exception);
    FxReturn(pow(alpha,*beta));
  }
if (IsFxFunction(expression,"sin",3) != MagickFalse)
  {
    alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
      beta,exception);
    FxReturn(sin(alpha));
  }
if (IsFxFunction(expression,"sqrt",4) != MagickFalse)
  {
    alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
      beta,exception);
    FxReturn(sqrt(alpha));
  }
if (IsFxFunction(expression,"tan",3) != MagickFalse)
  {
    alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
      beta,exception);
    FxReturn(tan(alpha));
  }
if (LocaleCompare(expression,"pi") == 0)
  FxReturn(MagickPI);
if (LocaleCompare(expression,"e") == 0)
  FxReturn(MagickE);
if (LocaleNCompare(expression,"rand",4) == 0)
  {
    if (expression[4] == '(')
      {
        alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
          beta,exception);
        FxReturn(GetPseudoRandomValue(fx_info->random_info)*
          PerceptibleReciprocal(alpha));
      }
    FxReturn(GetPseudoRandomValue(fx_info->random_info));
  }