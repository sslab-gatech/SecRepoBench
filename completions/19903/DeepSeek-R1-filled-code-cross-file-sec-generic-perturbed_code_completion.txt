if (*expression == '(')
    {
      const char
        *end;

      end=FxSubexpression(expression,exception);
      if (end == (const char *) NULL)
        {
          (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
            "UnbalancedParentheses","`%s'",expression);
          FxReturn(0.0);
        }
      (void) CopyMagickString(subexpression,expression+1,(size_t) (end-
        expression-1));
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,depth+1,
        beta,exception);
      expression=end+1;
      FxReturn(alpha);
    }
  if (IsFxFunction(expression,"abs",3) != MagickFalse)
    {
      expression+=3;
      if (*expression != '(')
        {
          (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
            "MissingParenthesis","`%s'",expression-3);
          FxReturn(0.0);
        }
      (void) CopyMagickString(subexpression,expression+1,MagickPathExtent);
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,depth+1,
        beta,exception);
      FxReturn(fabs(alpha));
    }
  if (IsFxFunction(expression,"acos",4) != MagickFalse)
    {
      expression+=4;
      if (*expression != '(')
        {
          (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
            "MissingParenthesis","`%s'",expression-4);
          FxReturn(0.0);
        }
      (void) CopyMagickString(subexpression,expression+1,MagickPathExtent);
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,depth+1,
        beta,exception);
      FxReturn(acos(alpha));
    }
  if (IsFxFunction(expression,"asin",4) != MagickFalse)
    {
      expression+=4;
      if (*expression != '(')
        {
          (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
            "MissingParenthesis","`%s'",expression-4);
          FxReturn(0.0);
        }
      (void) CopyMagickString(subexpression,expression+1,MagickPathExtent);
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,depth+1,
        beta,exception);
      FxReturn(asin(alpha));
    }
  if (IsFxFunction(expression,"atan",4) != MagickFalse)
    {
      expression+=4;
      if (*expression != '(')
        {
          (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
            "MissingParenthesis","`%s'",expression-4);
          FxReturn(0.0);
        }
      (void) CopyMagickString(subexpression,expression+1,MagickPathExtent);
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,depth+1,
        beta,exception);
      FxReturn(atan(alpha));
    }
  if (IsFxFunction(expression,"cos",3) != MagickFalse)
    {
      expression+=3;
      if (*expression != '(')
        {
          (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
            "MissingParenthesis","`%s'",expression-3);
          FxReturn(0.0);
        }
      (void) CopyMagickString(subexpression,expression+1,MagickPathExtent);
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,depth+1,
        beta,exception);
      FxReturn(cos(alpha));
    }
  if (IsFxFunction(expression,"exp",3) != MagickFalse)
    {
      expression+=3;
      if (*expression != '(')
        {
          (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
            "MissingParenthesis","`%s'",expression-3);
          FxReturn(0.0);
        }
      (void) CopyMagickString(subexpression,expression+1,MagickPathExtent);
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,depth+1,
        beta,exception);
      FxReturn(exp(alpha));
    }
  if (IsFxFunction(expression,"log",3) != MagickFalse)
    {
      expression+=3;
      if (*expression != '(')
        {
          (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
            "MissingParenthesis","`%s'",expression-3);
          FxReturn(0.0);
        }
      (void) CopyMagickString(subexpression,expression+1,MagickPathExtent);
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,depth+1,
        beta,exception);
      FxReturn(log(alpha));
    }
  if (IsFxFunction(expression,"sin",3) != MagickFalse)
    {
      expression+=3;
      if (*expression != '(')
        {
          (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
            "MissingParenthesis","`%s'",expression-3);
          FxReturn(0.0);
        }
      (void) CopyMagickString(subexpression,expression+1,MagickPathExtent);
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,depth+1,
        beta,exception);
      FxReturn(sin(alpha));
    }
  if (IsFxFunction(expression,"sqrt",4) != MagickFalse)
    {
      expression+=4;
      if (*expression != '(')
        {
          (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
            "MissingParenthesis","`%s'",expression-4);
          FxReturn(0.0);
        }
      (void) CopyMagickString(subexpression,expression+1,MagickPathExtent);
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,depth+1,
        beta,exception);
      FxReturn(sqrt(alpha));
    }
  if (LocaleNCompare(expression,"pi",2) == 0)
    FxReturn(M_PI);
  if (LocaleNCompare(expression,"e",1) == 0)
    FxReturn(M_E);