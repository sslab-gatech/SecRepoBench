if (strchr("(",(int) *expression) != (char *) NULL)
    {
      level=1;
      q=subexpression;
      for (expression++; *expression != '\0'; )
      {
        if (*expression == '(')
          level++;
        else
          if (*expression == ')')
            {
              level--;
              if (level == 0)
                break;
            }
        *q++=(*expression++);
      }
      *q='\0';
      if (depth > FxMaxParenthesisDepth)
        {
          (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
            "ParenthesisNestedTooDeeply","`%s'",subexpression);
          FxReturn(0.0);
        }
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,depth+1,
        beta,exception);
      FxReturn(alpha);
    }
  if (IsFxFunction(expression,"abs",3) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      FxReturn(fabs(alpha));
    }
  if (IsFxFunction(expression,"acos",4) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
        beta,exception);
      FxReturn(acos(alpha));
    }
#if defined(MAGICKCORE_HAVE_ACOSH)
  if (IsFxFunction(expression,"acosh",5) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
        beta,exception);
      FxReturn(acosh(alpha));
    }
#endif
  if (IsFxFunction(expression,"asin",4) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
        beta,exception);
      FxReturn(asin(alpha));
    }
#if defined(MAGICKCORE_HAVE_ASINH)
  if (IsFxFunction(expression,"asinh",5) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
        beta,exception);
      FxReturn(asinh(alpha));
    }
#endif
  if (IsFxFunction(expression,"atan",4) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
        beta,exception);
      FxReturn(atan(alpha));
    }
  if (IsFxFunction(expression,"atan2",5) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
        beta,exception);
      if (fabs(alpha) < MagickEpsilon)
        {
          (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
            "UnableToParseExpression","`%s'",expression);
          FxReturn(0.0);
        }
      *beta=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
        beta,exception);
      FxReturn(atan2(alpha,*beta));
    }
#if defined(MAGICKCORE_HAVE_ATANH)
  if (IsFxFunction(expression,"atanh",5) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
        beta,exception);
      FxReturn(atanh(alpha));
    }
#endif
  if (IsFxFunction(expression,"ceil",4) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
        beta,exception);
      FxReturn(ceil(alpha));
    }
  if (IsFxFunction(expression,"cos",3) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      FxReturn(cos(alpha));
    }
  if (IsFxFunction(expression,"cosh",4) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
        beta,exception);
      FxReturn(cosh(alpha));
    }
  if (IsFxFunction(expression,"debug",5) != MagickFalse)
    {
      char
        format[MagickPathExtent],
        message[MagickPathExtent];

      const char
        *value;

      (void) CopyMagickString(format,expression+5,MagickPathExtent);
      value=(const char *) NULL;
      (void) FormatLocaleString(message,MagickPathExtent,"%s",
        GetMagickArtifact(fx_info->images,"fx:debug"));
      if (strlen(message) > 0)
        value=message;
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,format,depth+1,beta,
        exception);
      if (value == (const char *) NULL)
        (void) FormatLocaleFile(fx_info->file,format,alpha,*beta);
      else
        (void) FormatLocaleFile(fx_info->file,format,alpha,value);
      FxReturn(*beta);
    }
  if (IsFxFunction(expression,"exp",3) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      FxReturn(exp(alpha));
    }
  if (IsFxFunction(expression,"floor",5) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
        beta,exception);
      FxReturn(floor(alpha));
    }
  if (IsFxFunction(expression,"hypot",5) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
        beta,exception);
      if (fabs(alpha) < MagickEpsilon)
        {
          (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
            "UnableToParseExpression","`%s'",expression);
          FxReturn(0.0);
        }
      *beta=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
        beta,exception);
      FxReturn(hypot(alpha,*beta));
    }
  if ((IsFxFunction(expression,"j0",2) != MagickFalse) ||
      (IsFxFunction(expression,"j1",2) != MagickFalse))
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+2,depth+1,
        beta,exception);
      if (*expression == 'j')
        FxReturn(j0(alpha));
      FxReturn(j1(alpha));
    }
  if (IsFxFunction(expression,"ln",2) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+2,depth+1,
        beta,exception);
      FxReturn(log(alpha));
    }
  if (IsFxFunction(expression,"log",3) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      FxReturn(log10(alpha));
    }
  if (IsFxFunction(expression,"logtwo",6) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+6,depth+1,
        beta,exception);
      FxReturn(log2(alpha));
    }
  if (IsFxFunction(expression,"max",3) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      *beta=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      FxReturn(alpha > *beta ? alpha : *beta);
    }
  if (IsFxFunction(expression,"min",3) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      *beta=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      FxReturn(alpha < *beta ? alpha : *beta);
    }
  if (IsFxFunction(expression,"pow",3) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      if (fabs(alpha) < MagickEpsilon)
        {
          (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
            "UnableToParseExpression","`%s'",expression);
          FxReturn(0.0);
        }
      *beta=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      FxReturn(pow(alpha,*beta));
    }
  if (IsFxFunction(expression,"rand",4) != MagickFalse)
    {
      FxReturn(GetPseudoRandomValue(fx_info->random_info));
    }
  if (IsFxFunction(expression,"round",5) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
        beta,exception);
      FxReturn(round(alpha));
    }
  if (IsFxFunction(expression,"sign",4) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
        beta,exception);
      FxReturn(alpha < 0.0 ? -1.0 : 1.0);
    }
  if (IsFxFunction(expression,"sin",3) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      FxReturn(sin(alpha));
    }
  if (IsFxFunction(expression,"sinh",4) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
        beta,exception);
      FxReturn(sinh(alpha));
    }
  if (IsFxFunction(expression,"sqrt",4) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
        beta,exception);
      FxReturn(sqrt(alpha));
    }
  if (IsFxFunction(expression,"tan",3) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+3,depth+1,
        beta,exception);
      FxReturn(tan(alpha));
    }
  if (IsFxFunction(expression,"tanh",4) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+4,depth+1,
        beta,exception);
      FxReturn(tanh(alpha));
    }
  if (IsFxFunction(expression,"trunc",5) != MagickFalse)
    {
      alpha=FxEvaluateSubexpression(fx_info,channel,x,y,expression+5,depth+1,
        beta,exception);
      FxReturn(trunc(alpha));
    }