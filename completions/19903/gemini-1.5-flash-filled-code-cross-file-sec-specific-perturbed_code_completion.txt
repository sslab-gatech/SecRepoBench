else
    {
      p=expression;
      while (((isspace((int) ((unsigned char) *p)) == 0) && (*p != '\0')) &&
             (strchr("=+-*/%^&|~<>!?:,;()",(int) ((unsigned char) *p)) ==
              (char *) NULL))
        p++;
      if (*p == '(')
        {
          size_t
            depth;

          char
            *subexpression;

          p++;
          depth=0;
          for (q=(char *) p; (*q != ')') && (*q != '\0'); q++)
            if (*q == '(')
              depth++;
            else
              if (*q == ')')
                depth--;
          if (*q == '\0')
            {
              (void) ThrowMagickException(exception,GetMagickModule(),
                OptionError,"UnableToParseExpression","`%s'",expression);
              FxReturn(0.0);
            }
          *q='\0';
          subexpression=AcquireString(p);
          alpha=FxEvaluateSubexpression(fx_info,channel,x,y,subexpression,
            depth+1,beta,exception);
          subexpression=DestroyString(subexpression);
          p=q+1;
        }
      else
        {
          if (*p != '\0')
            {
              (void) CopyMagickString(subexpression,expression,(size_t)
                (p-expression));
              alpha=FxGetSymbol(fx_info,channel,x,y,subexpression,depth+1,
                exception);
            }
        }
    }