static MagickBooleanType FxEvaluateExpression(FxInfo *fx_info, double *alpha, ExceptionInfo *exception)
{
  // ... (existing code)

  // Add a new case for the 'if' keyword to evaluate conditional expressions
  case 'i':
  case 'I':
  {
    const char *p = expression;
    const char *q = FxOperatorPrecedence(expression, exception);
    if (q == (const char *) NULL)
    {
      (void) ThrowMagickException(exception, GetMagickModule(), OptionError,
        "UnableToParseExpression", "`%s'", expression);
      return(MagickFalse);
    }

    // Extract the condition and true/false expressions
    char *condition = AcquireString(p);
    char *true_expr = AcquireString(q);
    char *false_expr = AcquireString(q);
    *condition = '\0';
    *true_expr = '\0';
    *false_expr = '\0';

    p = condition;
    while (*p != '\0' && *p != '?')
      p++;
    if (*p == '\0')
    {
      (void) ThrowMagickException(exception, GetMagickModule(), OptionError,
        "UnableToParseExpression", "`%s'", expression);
      condition = DestroyString(condition);
      true_expr = DestroyString(true_expr);
      false_expr = DestroyString(false_expr);
      return(MagickFalse);
    }
    *p = '\0';
    p++;

    q = true_expr;
    while (*p != '\0' && *p != ':')
      p++;
    if (*p == '\0')
    {
      (void) ThrowMagickException(exception, GetMagickModule(), OptionError,
        "UnableToParseExpression", "`%s'", expression);
      condition = DestroyString(condition);
      true_expr = DestroyString(true_expr);
      false_expr = DestroyString(false_expr);
      return(MagickFalse);
    }
    *p = '\0';
    p++;

    q = false_expr;
    while (*p != '\0')
      p++;
    *p = '\0';

    // Evaluate the condition
    double condition_result = FxEvaluateSubexpression(fx_info, GrayPixelChannel, 0, 0, condition, 0, exception);

    // Evaluate the true or false expression based on the condition result
    if (condition_result != 0.0)
    {
      *alpha = FxEvaluateSubexpression(fx_info, GrayPixelChannel, 0, 0, true_expr, 0, exception);
    }
    else
    {
      *alpha = FxEvaluateSubexpression(fx_info, GrayPixelChannel, 0, 0, false_expr, 0, exception);
    }

    condition = DestroyString(condition);
    true_expr = DestroyString(true_expr);
    false_expr = DestroyString(false_expr);
    return(MagickTrue);
  }

  // ... (existing code)
}