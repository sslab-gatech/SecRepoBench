if (strlen(expression) > 0)
  {
    // Check for parentheses and evaluate enclosed expressions
    if (*expression == '(')
    {
      const char *end = FindMatchingParenthesis(expression);
      if (end == (const char *) NULL)
      {
        (void) ThrowMagickException(exception, GetMagickModule(),
          OptionError, "UnmatchedParenthesis", "`%s'", expression);
        FxReturn(0.0);
      }
      // Recursively evaluate the expression inside the parentheses
      result = FxEvaluateSubexpression(fx_info, channel, x, y, expression + 1, depth, beta, exception);
      expression = end + 1; // Move past the closing parenthesis
    }
    else
    {
      // Handle mathematical functions and constants
      if (IsMathFunction(expression))
      {
        result = EvaluateMathFunction(expression, beta);
        expression += GetFunctionLength(expression);
      }
      else
      {
        // Handle numeric constants or variables
        result = InterpretSiPrefixValue(expression, &expression);
      }
    }
  }