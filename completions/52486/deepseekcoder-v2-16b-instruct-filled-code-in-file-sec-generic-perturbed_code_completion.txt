if (scpd > checkcpdtable.size()) {
            scpd = 0;
            break;
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcompoundrep, words[wordnum]->alen)) {
              if (cpdrep_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompounddup, words[wordnum]->alen)) {
              if (cpdwordpair_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompoundcase, words[wordnum]->alen)) {
              if (cpdcase_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompoundtriple, words[wordnum]->alen)) {
              if (checkedstriple == 0) {
                if (triplet_check(word, i + 1))
                  return NULL;
                checkedstriple = 1;
              }
            }
          }
        }

        if (checked_prefix == 0) {
          checked_prefix = 1;
          rv = prefix_check(word, i + 1, word.size() - i - 1, IN_CPD_MID, needaffix);
          if (rv) {
            if (TESTAFF(rv->astr, forbiddenword, rv->alen))
              return NULL;
            if (TESTAFF(rv->astr, nosuggest, rv->alen))
              return NULL;
            if (TESTAFF(rv->astr, nongramsuggest, rv->alen))
              return NULL;
            if (TESTAFF(rv->astr, needaffix, rv->alen))
              return NULL;
            if (TESTAFF(rv->astr, circumfix, rv->alen))
              return NULL;
            if (TESTAFF(rv->astr, onlyincompound, rv->alen))
              return NULL;
            if (TESTAFF(rv->astr, substandard, rv->alen))
              return NULL;
            if (TESTAFF(rv->astr, lemma_present, rv->alen))
              return NULL;
            if (TESTAFF(rv->astr, checknum, rv->alen))
              return NULL;
            if (TESTAFF(rv->astr, checksharps, rv->alen))
              return NULL;
            if (TESTAFF(rv->astr, forbidwarn, rv->alen))
              return NULL;
            if (TESTAFF(rv->astr, warn, rv->alen))
              return NULL;
            if (TESTAFF(rv->astr, fullstrip, rv->alen))
              return NULL;
            if (TESTAFF(rv->astr, keepcase, rv->alen))
              return NULL;
            if (TESTAFF(rv->astr, forceucase, rv->alen))
              return NULL;
            if (TESTAFF(rv->astr, substandard, rv->alen))
              return NULL;
            if (TESTAFF(rv->astr, checksharps, rv->alen))
              return NULL;
            if (TESTAFF(rv->astr, forbidwarn, rv->alen))
              return NULL;
            if (TESTAFF(rv->astr, warn, rv->alen))
              return NULL;
            if (TESTAFF(rv->astr, fullstrip, rv->alen))
              return NULL;
            if (TESTAFF(rv->astr, keepcase, rv->alen))
              return NULL;
            if (TESTAFF(rv->astr, forceucase, rv->alen))
              return NULL;
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcompoundrep, words[wordnum]->alen)) {
              if (cpdrep_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompounddup, words[wordnum]->alen)) {
              if (cpdwordpair_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompoundcase, words[wordnum]->alen)) {
              if (cpdcase_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompoundtriple, words[wordnum]->alen)) {
              if (checkedstriple == 0) {
                if (triplet_check(word, i + 1))
                  return NULL;
                checkedstriple = 1;
              }
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcompoundrep, words[wordnum]->alen)) {
              if (cpdrep_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompounddup, words[wordnum]->alen)) {
              if (cpdwordpair_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompoundcase, words[wordnum]->alen)) {
              if (cpdcase_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompoundtriple, words[wordnum]->alen)) {
              if (checkedstriple == 0) {
                if (triplet_check(word, i + 1))
                  return NULL;
                checkedstriple = 1;
              }
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcompoundrep, words[wordnum]->alen)) {
              if (cpdrep_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompounddup, words[wordnum]->alen)) {
              if (cpdwordpair_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompoundcase, words[wordnum]->alen)) {
              if (cpdcase_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompoundtriple, words[wordnum]->alen)) {
              if (checkedstriple == 0) {
                if (triplet_check(word, i + 1))
                  return NULL;
                checkedstriple = 1;
              }
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcompoundrep, words[wordnum]->alen)) {
              if (cpdrep_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompounddup, words[wordnum]->alen)) {
              if (cpdwordpair_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompoundcase, words[wordnum]->alen)) {
              if (cpdcase_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompoundtriple, words[wordnum]->alen)) {
              if (checkedstriple == 0) {
                if (triplet_check(word, i + 1))
                  return NULL;
                checkedstriple = 1;
              }
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcompoundrep, words[wordnum]->alen)) {
              if (cpdrep_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompounddup, words[wordnum]->alen)) {
              if (cpdwordpair_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompoundcase, words[wordnum]->alen)) {
              if (cpdcase_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompoundtriple, words[wordnum]->alen)) {
              if (checkedstriple == 0) {
                if (triplet_check(word, i + 1))
                  return NULL;
                checkedstriple = 1;
              }
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcompoundrep, words[wordnum]->alen)) {
              if (cpdrep_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompounddup, words[wordnum]->alen)) {
              if (cpdwordpair_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompoundcase, words[wordnum]->alen)) {
              if (cpdcase_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompoundtriple, words[wordnum]->alen)) {
              if (checkedstriple == 0) {
                if (triplet_check(word, i + 1))
                  return NULL;
                checkedstriple = 1;
              }
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcompoundrep, words[wordnum]->alen)) {
              if (cpdrep_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompounddup, words[wordnum]->alen)) {
              if (cpdwordpair_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompoundcase, words[wordnum]->alen)) {
              if (cpdcase_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompoundtriple, words[wordnum]->alen)) {
              if (checkedstriple == 0) {
                if (triplet_check(word, i + 1))
                  return NULL;
                checkedstriple = 1;
              }
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcompoundrep, words[wordnum]->alen)) {
              if (cpdrep_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompounddup, words[wordnum]->alen)) {
              if (cpdwordpair_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompoundcase, words[wordnum]->alen)) {
              if (cpdcase_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[wordnum]->astr, checkcompoundtriple, words[wordnum]->alen)) {
              if (checkedstriple == 0) {
                if (triplet_check(word, i + 1))
                  return NULL;
                checkedstriple = 1;
              }
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcompoundrep, words[wordnum]->alen)) {
              if (cpdrep_check(word, i + 1))
                return NULL;
            }
            if (TESTAFF(words[