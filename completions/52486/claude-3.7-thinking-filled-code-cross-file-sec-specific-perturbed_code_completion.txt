// Restore character or entire string, depending on whether complex replacements occurred
if (scpd > 0) {
  // Complex replacements occurred, restore entire string
  st.assign(word);
} else if (i < st.size()) {
  // Only simple null-termination, restore just that character
  st[i] = ch;
}

// Reset tracking variables for next iteration
numsyllable = oldnumsyllable;
wordnum = previouswordnum;
scpd = 0;  // Reset compound pattern tracking