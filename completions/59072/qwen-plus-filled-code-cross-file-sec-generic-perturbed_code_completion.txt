result_str = zend_string_extend(op1_string, op2_len + 1, 0);
memcpy(ZSTR_VAL(result_str) + op1_len, ZSTR_VAL(op2_string), op2_len);
ZSTR_VAL(result_str)[result_len] = '\0';
GC_ADD_FLAGS(result_str, flags);

if (shouldfreeopstring) {
    // Transfer ownership of the extended string to result_str
    zend_string_release(op1_string);
    shouldfreeopstring = false;
}

if (op1_string == op2_string) {
    // Prevent double release by transferring ownership if strings are the same
    free_op2_string = false;
}