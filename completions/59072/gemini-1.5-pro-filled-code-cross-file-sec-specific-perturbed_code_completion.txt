if (op1_string == op2_string) {
				/* special case to avoid realloc + memcpy of the same string */
				result_str = zend_string_extend(op1_string, result_len, 0);
				if (UNEXPECTED(!result_str)) {
					zend_throw_error(NULL, "String size overflow");
					if (orig_op1 != result) {
						ZVAL_UNDEF(result);
					}
					return FAILURE;
				}
				op2_string = result_str; /* transfer ownership */
				shouldfreeopstring = false;
			} else {
				result_str = zend_string_extend(op1_string, result_len, 0);
				if (UNEXPECTED(!result_str)) {
					zend_string_release(op2_string);
					zend_throw_error(NULL, "String size overflow");
					if (orig_op1 != result) {
						ZVAL_UNDEF(result);
					}
					return FAILURE;

				}
				shouldfreeopstring = false;
			}