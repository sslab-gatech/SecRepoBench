if (shouldfreeopstring) {
    op1_string = zend_string_extend(op1_string, result_len, 0);
} else {
    op1_string = zend_string_alloc(result_len, 0);
    memcpy(ZSTR_VAL(op1_string), ZSTR_VAL(orig_op1 == op1 ? Z_STR_P(op1) : op1_string), op1_len);
}
memcpy(ZSTR_VAL(op1_string) + op1_len, ZSTR_VAL(op2_string), op2_len);
ZSTR_VAL(op1_string)[result_len] = '\0';
result_str = op1_string;
GC_ADD_FLAGS(result_str, flags);
if (free_op2_string) {
    zend_string_release(op2_string);
}