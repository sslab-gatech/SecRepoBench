encoding_error:
    if (parserContext->input != NULL) {
        xmlChar errorBytes[4];
        int i;
        for (i = 0; i < 4 && parserContext->input->cur + i < parserContext->input->end; i++) {
            errorBytes[i] = parserContext->input->cur[i];
        }
        xmlFatalErrMsgStr(parserContext, XML_ERR_INVALID_ENCODING,
                          "Encoding error detected at bytes: %02x %02x %02x %02x\n",
                          errorBytes[0], errorBytes[1], errorBytes[2], errorBytes[3]);
    } else {
        xmlFatalErr(parserContext, XML_ERR_INVALID_ENCODING, "Encoding error detected\n");
    }
    xmlHaltParser(parserContext);
    return 0;