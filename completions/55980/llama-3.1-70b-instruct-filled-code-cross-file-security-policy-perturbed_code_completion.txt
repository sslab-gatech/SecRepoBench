// Handle encoding errors encountered during XML parsing.
// Check if the input does not conform to UTF-8 encoding.
// Report an encoding error with details about the problematic bytes.
// Terminate the parsing process upon encountering this error.
if ((parserContext->input->cur - parserContext->input->base) < XML_PARSER_BIG_BUFFER_SIZE) {
    int len = parserContext->input->end - parserContext->input->cur;
    if (len < 1) {
        xmlFatalErr(parserContext, XML_ERR_INTERNAL_ERROR,
                    "detected an error in element content\n");
        xmlHaltParser(parserContext);
        if ((parserContext->sax) && (parserContext->sax->endDocument!= NULL))
            parserContext->sax->endDocument(parserContext->userData);
        goto done;
    }
    if (xmlCheckUTF8(parserContext->input->cur, len) < 0) {
        xmlFatalErr(parserContext, XML_ERR_INVALID_ENCODING,
                    "input is not valid in encoding %s\n",
                    xmlCharEncodingName(parserContext->charset));
        xmlHaltParser(parserContext);
        if ((parserContext->sax) && (parserContext->sax->endDocument!= NULL))
            parserContext->sax->endDocument(parserContext->userData);
        goto done;
    }
}