if (ctxt->input->cur >= ctxt->input->end) {
        xmlFatalErr(ctxt, XML_ERR_DOCUMENT_EMPTY, NULL);
        return(XML_ERR_DOCUMENT_EMPTY);
    }

    if (ctxt->input->cur < ctxt->input->base) {
        xmlFatalErr(ctxt, XML_ERR_INTERNAL_ERROR, "Invalid input buffer");
        return(XML_ERR_INTERNAL_ERROR);
    }

    if (ctxt->input->cur - ctxt->input->base > XML_MAX_HUGE_LENGTH) {
        xmlFatalErr(ctxt, XML_ERR_INTERNAL_ERROR, "Input exceeds maximum length");
        return(XML_ERR_INTERNAL_ERROR);
    }

    if (ctxt->input->cur - ctxt->input->base < 4) {
        xmlFatalErr(ctxt, XML_ERR_INTERNAL_ERROR, "Insufficient data for parsing");
        return(XML_ERR_INTERNAL_ERROR);
    }