// Handle encoding errors encountered during XML parsing.
    // Check if the input does not conform to UTF-8 encoding.
    // Report an encoding error with details about the problematic bytes.
    // Terminate the parsing process upon encountering this error.
encoding_error:
    if (ctxt->input != NULL && ctxt->input->cur != NULL) {
        const unsigned char *error_start = ctxt->input->cur;
        const unsigned char *error_end = ctxt->input->cur + 4; // Check up to 4 bytes for context
        char error_bytes[9] = {0}; // To store hex representation of up to 4 bytes

        for (int i = 0; i < 4 && error_start + i < ctxt->input->end; i++) {
            snprintf(&error_bytes[i * 2], 3, "%02X", error_start[i]);
        }

        xmlGenericError(xmlGenericErrorContext,
                        "Encoding error detected at byte offset %ld: %s\n",
                        (long)(error_start - ctxt->input->base),
                        error_bytes);
    } else {
        xmlGenericError(xmlGenericErrorContext,
                        "Encoding error detected, but no context available.\n");
    }

    xmlFatalErr(ctxt, XML_ERR_INVALID_ENCODING, "Invalid encoding detected");
    xmlHaltParser(ctxt);
    return 0;