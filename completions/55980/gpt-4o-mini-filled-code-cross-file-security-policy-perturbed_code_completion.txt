if (ctxt->errNo == XML_ERR_INVALID_ENCODING) {
        xmlFatalErr(ctxt, XML_ERR_INVALID_ENCODING, "Invalid encoding detected");
        xmlHaltParser(ctxt);
        return(XML_ERR_INVALID_ENCODING);
    }