// Handle encoding errors encountered during XML parsing.
// Check if the input does not conform to UTF-8 encoding.
// Report an encoding error with details about the problematic bytes.
// Terminate the parsing process upon encountering this error.
if (ctxt->checkIndex > 0) {
    int i;
    xmlChar *out = xmlBufContent(ctxt->input->buf->buffer);
    xmlChar *msg = xmlStrdup(BAD_CAST "Byte: ");
    for (i = 0; i < ctxt->checkIndex; i++) {
        char tmp[10];
        sprintf(tmp, "%d ", out[i]);
        xmlStrCat(msg, BAD_CAST tmp);
    }
    xmlFatalErr(ctxt, XML_ERR_INVALID_ENCODING, NULL, msg, NULL);
    xmlFree(msg);
    xmlHaltParser(ctxt);
}