static int
xmlParseBalancedChunkMemoryRecover(xmlDocPtr doc, xmlSAXHandlerPtr sax,
                                   void *user_data, int depth,
                                   const xmlChar *string, xmlNodePtr *lst,
                                   int recover) {
    xmlParserCtxtPtr ctxt;
    xmlParserErrors ret;

    if (doc == NULL)
        return(XML_ERR_INTERNAL_ERROR);

    ctxt = xmlCreateMemoryParserCtxt((char *) string, xmlStrlen(string));
    if (ctxt == NULL)
        return(XML_WAR_UNDECLARED_ENTITY);

    ctxt->sax = sax;
    ctxt->userData = user_data;
    ctxt->myDoc = doc;
    ctxt->depth = depth;
    ctxt->recovery = recover;

    ret = xmlParseBalancedChunkMemoryInternal(ctxt, string, user_data, lst);

    ctxt->sax = NULL;
    xmlFreeParserCtxt(ctxt);

    return(ret);
}