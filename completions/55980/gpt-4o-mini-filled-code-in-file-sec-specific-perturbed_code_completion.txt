if (ctxt->input->cur >= ctxt->input->end) {
        xmlFatalErr(ctxt, XML_ERR_DOCUMENT_EMPTY, NULL);
        return(-1);
    }

    if (ctxt->input->buf != NULL) {
        size_t base = xmlBufGetInputBase(ctxt->input->buf->buffer, ctxt->input);
        size_t current = ctxt->input->cur - ctxt->input->base;

        xmlParserInputBufferPush(ctxt->input->buf, 1, "\n");
        xmlBufSetInputBaseCur(ctxt->input->buf->buffer, ctxt->input, base, current);
    }

    if (terminate) {
        if (ctxt->instate != XML_PARSER_EOF) {
            xmlFatalErr(ctxt, XML_ERR_DOCUMENT_END, NULL);
        }
    }