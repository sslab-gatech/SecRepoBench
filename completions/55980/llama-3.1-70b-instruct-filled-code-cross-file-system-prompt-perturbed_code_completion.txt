encoding_error:
    if ((parserContext->input->cur - parserContext->input->base) > 0) {
        xmlChar *str = xmlStrndup(parserContext->input->cur - parserContext->input->base,
                                  parserContext->input->cur);
        if (str!= NULL) {
            xmlFatalErr(parserContext, XML_ERR_INVALID_ENCODING,
                        "input conversion failed in encoding %s at byte %d of sequence %s",
                        parserContext->input->buf->encoder->name,
                        parserContext->input->cur - parserContext->input->base,
                        str);
            xmlFree(str);
        } else {
            xmlFatalErr(parserContext, XML_ERR_INVALID_ENCODING,
                        "input conversion failed in encoding %s at byte %d",
                        parserContext->input->buf->encoder->name,
                        parserContext->input->cur - parserContext->input->base);
        }
    } else {
        xmlFatalErr(parserContext, XML_ERR_INVALID_ENCODING,
                    "input conversion failed in encoding %s",
                    parserContext->input->buf->encoder->name);
    }
    xmlHaltParser(parserContext);
    return;