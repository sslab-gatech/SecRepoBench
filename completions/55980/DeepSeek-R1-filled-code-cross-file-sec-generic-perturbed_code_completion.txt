encoding_error:
    if (ctxt->input->encoding != NULL) {
        if (xmlStrcasecmp(ctxt->input->encoding, BAD_CAST "UTF-8") == 0) {
            xmlFatalErr(ctxt, XML_ERR_INVALID_UTF8,
                        "Invalid UTF-8 bytes: 0x%02X 0x%02X 0x%02X 0x%02X",
                        (unsigned char)ctxt->input->cur[0],
                        (unsigned char)ctxt->input->cur[1],
                        (unsigned char)ctxt->input->cur[2],
                        (unsigned char)ctxt->input->cur[3]);
        } else {
            xmlFatalErr(ctxt, XML_ERR_INVALID_ENCODING,
                        "Invalid byte sequence in detected encoding '%s'",
                        ctxt->input->encoding);
        }
    } else {
        xmlFatalErr(ctxt, XML_ERR_INVALID_ENCODING,
                    "Invalid byte sequence in undetected encoding");
    }
    xmlHaltParser(ctxt);
    return 0;