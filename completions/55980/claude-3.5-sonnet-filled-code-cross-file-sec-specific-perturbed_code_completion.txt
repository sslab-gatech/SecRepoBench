encoding_error:
    if (ctxt->input->cur - ctxt->input->base > 0) {
        xmlFatalErrMsgInt(ctxt, XML_ERR_INVALID_CHAR,
                          "Input is not proper UTF-8, indicate encoding!\n"
                          "Bytes: 0x%02X 0x%02X 0x%02X\n",
                          ctxt->input->cur[-1],
                          ctxt->input->cur[0],
                          ctxt->input->cur[1]);
    } else {
        xmlFatalErrMsgInt(ctxt, XML_ERR_INVALID_CHAR,
                          "Input is not proper UTF-8, indicate encoding!\n"
                          "Bytes: 0x%02X 0x%02X\n",
                          ctxt->input->cur[0],
                          ctxt->input->cur[1]);
    }
    xmlHaltParser(ctxt);
    return(XML_ERR_INVALID_ENCODING);