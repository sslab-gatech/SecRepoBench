if (envvar != NULL) {
    dctx = blosc2_create_dctx(dparams);
    if (dctx == NULL) {
        return -1;  /* Memory allocation error */
    }
    result = blosc2_decompress_ctx(dctx, src, srcsize, outputbuffer, destsize);
    blosc2_free_ctx(dctx);
} else {
    pthread_mutex_lock(&g_global_mutex);
    result = blosc2_decompress_ctx(g_dctx, src, srcsize, outputbuffer, destsize);
    pthread_mutex_unlock(&g_global_mutex);
}
return result;