if (envvar != NULL) {
    // Create a decompression context using default parameters and the global thread count
    blosc2_dparams dparams = BLOSC2_DPARAMS_DEFAULTS;
    dparams.nthreads = g_nthreads;
    blosc2_context* dctx = blosc2_create_dctx(dparams);

    // Decompress the source data into the destination buffer
    result = blosc2_decompress_ctx(dctx, src, srcsize, dest, destsize);

    // Free the decompression context
    blosc2_free_ctx(dctx);
    return result;
}

pthread_mutex_lock(&global_comp_mutex);
result = blosc_run_decompression_with_context(g_global_context, src, srcsize, dest, destsize);
pthread_mutex_unlock(&global_comp_mutex);
return result;