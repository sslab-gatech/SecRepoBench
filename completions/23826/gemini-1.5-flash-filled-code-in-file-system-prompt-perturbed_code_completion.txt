if (envvar != NULL) {
    blosc2_context *cctx;
    blosc2_dparams dparams = BLOSC2_DPARAMS_DEFAULTS;
    dparams.nthreads = g_nthreads;
    cctx = blosc2_create_dctx(dparams);
    result = blosc2_decompress_ctx(cctx, src, srcsize, outputbuffer, destsize);
    blosc2_free_ctx(cctx);
    return result;
  }
  else {
    pthread_mutex_lock(&global_comp_mutex);
    result = blosc2_decompress_ctx(g_global_context, src, srcsize, outputbuffer, destsize);
    pthread_mutex_unlock(&global_comp_mutex);
    return result;
  }