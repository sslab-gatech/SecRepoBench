if (envvar != NULL) {
    dctx = blosc2_create_dctx(dparams);
    result = blosc2_decompress_ctx(dctx, src, srcsize, outputbuffer, destsize);
    blosc2_free_dctx(dctx);
    return result;
  } else {
    // Lock the global mutex for thread safety
    pthread_mutex_lock(&global_mutex);
    dctx = blosc2_create_dctx(dparams);
    result = blosc2_decompress_ctx(dctx, src, srcsize, outputbuffer, destsize);
    blosc2_free_dctx(dctx);
    pthread_mutex_unlock(&global_mutex);
    return result;
  }