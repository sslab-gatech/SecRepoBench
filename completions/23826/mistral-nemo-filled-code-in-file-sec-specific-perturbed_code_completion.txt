import blosc

# Define the compressor and decompression functions
def compress(data):
    return blosc.blosc2_compress_ctx(g_global_context, data, dest, destsize)

def decompress(data):
    return blosc.blosc2_decompress_ctx(g_global_context, data, dest, destsize)

# Create a context for compression
g_global_context = blosc.blosc2_create_cctx(blosc2_cparams(
    compcode=BLOSC_BLOSCLZ,
    clevel=5,
    typesize=1,
    nthreads=1,
    blocksize=32768,
    schunk=None,
    prefilter=None,
    pparams=None
))

# Create a context for decompression
d_global_context = blosc.blosc2_create_dctx(blosc2_dparams(
    nthreads=1,
    schunk=None
))

# Compress the data
compressed_data = compress(data)

# Decompress the data
decompressed_data = decompress(compressed_data)

# Free the contexts
blosc.blosc2_free_ctx(g_global_context)
blosc.blosc2_free_ctx(d_global_context)