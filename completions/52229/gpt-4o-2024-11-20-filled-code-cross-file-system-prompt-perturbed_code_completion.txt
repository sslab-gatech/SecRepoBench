char version[16] = {0};
      int i = 0;

      // Extract version number
      while (off < server_len && i < (sizeof(version) - 1) && isdigit(http_server_name[off])) {
        version[i++] = http_server_name[off++];
        if (http_server_name[off] == '.') {
          version[i++] = http_server_name[off++];
        }
      }
      version[i] = '\0';

      // Convert version string to float for comparison
      float server_version = atof(version);

      if ((strncasecmp(http_server_name, "Apache/", 7) == 0 && server_version < 2.4) ||
          (strncasecmp(http_server_name, "nginx/", 6) == 0 && server_version < 1.18)) {
        char risk_message[64];
        snprintf(risk_message, sizeof(risk_message), "Outdated server version: %s", version);
        ndpi_set_risk(ndpi_struct, flow, NDPI_OUTDATED_SERVER_VERSION, risk_message);
      }