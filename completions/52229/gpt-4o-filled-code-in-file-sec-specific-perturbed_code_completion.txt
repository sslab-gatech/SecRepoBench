const char *version_start = http_server_name + off;
      int major, minor, patch;
      if (sscanf(version_start, "%d.%d.%d", &major, &minor, &patch) == 3) {
        int version_number = major * 1000000 + minor * 1000 + patch;
        if ((strncasecmp(http_server_name, "Apache/", 7) == 0 && version_number < MIN_APACHE_VERSION) ||
            (strncasecmp(http_server_name, "nginx/", 6) == 0 && version_number < MIN_NGINX_VERSION)) {
          char str[64];
          snprintf(str, sizeof(str), "Obsolete server %s", http_server_name);
          ndpi_set_risk(ndpi_struct, flow, NDPI_OBSOLETE_SERVER, str);
        }
      }