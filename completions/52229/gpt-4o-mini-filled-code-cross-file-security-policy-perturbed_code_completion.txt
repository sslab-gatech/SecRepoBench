char version[16];
      u_int version_len = server_len - off - 1; // Calculate length of version string
      if (version_len >= sizeof(version)) version_len = sizeof(version) - 1; // Ensure it fits
      strncpy(version, http_server_name + off, version_len);
      version[version_len] = '\0'; // Null-terminate the version string

      // Check for Apache version
      if (strncasecmp(http_server_name, "Apache/", 7) == 0) {
          // Convert version string to numeric format and check against threshold
          // (Assuming a function `check_apache_version` exists)
          if (check_apache_version(version) < MIN_APACHE_VERSION) {
              ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OBSOLETE_APACHE, version);
          }
      } 
      // Check for nginx version
      else if (strncasecmp(http_server_name, "nginx/", 6) == 0) {
          // Convert version string to numeric format and check against threshold
          // (Assuming a function `check_nginx_version` exists)
          if (check_nginx_version(version) < MIN_NGINX_VERSION) {
              ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OBSOLETE_NGINX, version);
          }
      }