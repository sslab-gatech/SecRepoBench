char version_str[16];
      unsigned int version_num = 0;

      if (server_len > off) {
          int n = snprintf(version_str, sizeof(version_str), "%.*s", server_len - off, http_server_name + off);
          if (n > 0 && n < (int)sizeof(version_str)) {
              char *endptr;
              version_num = strtoul(version_str, &endptr, 10);
              while (*endptr == '.' && isdigit(*(endptr + 1))) {
                  version_num = version_num * 1000 + strtoul(endptr + 1, &endptr, 10);
              }
          }
      }
      

      if (strncasecmp(http_server_name, "Apache/", 7) == 0 && version_num > 0 && version_num < MIN_APACHE_VERSION) {
          char msg[128];
          snprintf(msg, sizeof(msg), "Obsolete Apache server %s", version_str);
          ndpi_set_risk(ndpi_struct, flow, NDPI_OBSOLETE_SERVER, msg);
      } else if (strncasecmp(http_server_name, "nginx/", 6) == 0 && version_num > 0 && version_num < MIN_NGINX_VERSION) {
          char msg[128];
          snprintf(msg, sizeof(msg), "Obsolete nginx server %s", version_str);
          ndpi_set_risk(ndpi_struct, flow, NDPI_OBSOLETE_SERVER, msg);
      }