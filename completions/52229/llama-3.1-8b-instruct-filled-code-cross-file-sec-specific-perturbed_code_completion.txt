// <MASK>
if(strncasecmp(http_server_name, "Apache/", off = 7) == 0) {
  // Extract the version number from the server string after the "Apache/" prefix.
  char *version = http_server_name + 7;
  // Convert the version string into a numeric format.
  int major = atoi(version);
  int minor = atoi(version + 3);
  // Check if the version is below a predefined minimum version threshold for Apache.
  if (major < 2 || (major == 2 && minor < 4)) {
    // If the server version is obsolete, set a risk indicator with a message specifying the outdated server.
    char risk_message[256];
    snprintf(risk_message, sizeof(risk_message), "Apache version %d.%d is outdated", major, minor);
    ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OUTDATED_SERVER, risk_message);
  }
} else if(strncasecmp(http_server_name, "nginx/", off = 6) == 0) {
  // Extract the version number from the server string after the "nginx/" prefix.
  char *version = http_server_name + 6;
  // Convert the version string into a numeric format.
  int major = atoi(version);
  int minor = atoi(version + 3);
  // Check if the version is below a predefined minimum version threshold for nginx.
  if (major < 1 || (major == 1 && minor < 14)) {
    // If the server version is obsolete, set a risk indicator with a message specifying the outdated server.
    char risk_message[256];
    snprintf(risk_message, sizeof(risk_message), "nginx version %d.%d is outdated", major, minor);
    ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OUTDATED_SERVER, risk_message);
  }
}