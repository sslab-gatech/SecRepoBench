if((strncmp((const char *)packet->server_line.ptr, "Apache/", off = 7) == 0) /* X.X.X */
   || (strncmp((const char *)packet->server_line.ptr, "nginx/", off = 6) == 0) /* X.X.X */) {
  // Extract the version number from the server string after the "Apache/" or "nginx/" prefix.
  // Convert the version string into a numeric format.
  // Check if the version is below a predefined minimum version threshold for either Apache or nginx.
  // If the server version is obsolete, set a risk indicator with a message specifying the outdated server.
  char version[32];
  if(strncmp((const char *)packet->server_line.ptr, "Apache/", 7) == 0) {
    strncpy(version, &packet->server_line.ptr[7], 32);
  } else {
    strncpy(version, &packet->server_line.ptr[6], 32);
  }
  version[31] = '\0';
  int version_num = atoi(version);
  if((strncmp((const char *)packet->server_line.ptr, "Apache/", 7) == 0) {
    if(version_num < MIN_APACHE_VERSION) {
      char str[64];
      snprintf(str, sizeof(str), "Outdated Apache version %d", version_num);
      ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OUTDATED_SERVER, str);
    }
  } else {
    if(version_num < MIN_NGINX_VERSION) {
      char str[64];
      snprintf(str, sizeof(str), "Outdated Nginx version %d", version_num);
      ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OUTDATED_SERVER, str);
    }
  }
}