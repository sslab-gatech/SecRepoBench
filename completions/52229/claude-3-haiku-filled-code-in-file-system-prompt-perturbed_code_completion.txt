u_int32_t apache_version = 0, nginx_version = 0;

if(strncasecmp(http_server_name, "Apache/", off) == 0) {
  char *dot = strchr(http_server_name + off, '.');
  if(dot) {
    dot++;
    char *dot2 = strchr(dot, '.');
    if(dot2) {
      dot2[0] = '\0';
      apache_version = atoi(dot) * 1000000 + atoi(dot2 + 1) * 1000;
    }
  }

  if(apache_version < MIN_APACHE_VERSION) {
    char str[64];
    snprintf(str, sizeof(str), "Outdated Apache version %s", http_server_name);
    ndpi_set_risk(ndpi_struct, flow, NDPI_KNOWN_PROTOCOL_ON_NON_STANDARD_PORT, str);
  }
} else if(strncasecmp(http_server_name, "nginx/", off) == 0) {
  char *dot = strchr(http_server_name + off, '.');
  if(dot) {
    dot++;
    char *dot2 = strchr(dot, '.');
    if(dot2) {
      dot2[0] = '\0';
      nginx_version = atoi(dot) * 1000000 + atoi(dot2 + 1) * 1000;
    }
  }

  if(nginx_version < MIN_NGINX_VERSION) {
    char str[64];
    snprintf(str, sizeof(str), "Outdated nginx version %s", http_server_name);
    ndpi_set_risk(ndpi_struct, flow, NDPI_KNOWN_PROTOCOL_ON_NON_STANDARD_PORT, str);
  }
}