char version[16];
      int major, minor, patch;
      if (sscanf(http_server_name + off, "%15s", version) == 1) {
        if (sscanf(version, "%d.%d.%d", &major, &minor, &patch) == 3) {
          // Define minimum version thresholds for Apache and nginx
          const int MIN_APACHE_MAJOR = 2, MIN_APACHE_MINOR = 4, MIN_APACHE_PATCH = 0;
          const int MIN_NGINX_MAJOR = 1, MIN_NGINX_MINOR = 18, MIN_NGINX_PATCH = 0;

          if (strncmp(http_server_name, "Apache/", 7) == 0) {
            if (major < MIN_APACHE_MAJOR || 
                (major == MIN_APACHE_MAJOR && (minor < MIN_APACHE_MINOR || 
                (minor == MIN_APACHE_MINOR && patch < MIN_APACHE_PATCH)))) {
              ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OBSOLETE_APACHE_VERSION, "Outdated Apache version detected");
            }
          } else if (strncmp(http_server_name, "nginx/", 6) == 0) {
            if (major < MIN_NGINX_MAJOR || 
                (major == MIN_NGINX_MAJOR && (minor < MIN_NGINX_MINOR || 
                (minor == MIN_NGINX_MINOR && patch < MIN_NGINX_PATCH)))) {
              ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OBSOLETE_NGINX_VERSION, "Outdated nginx version detected");
            }
          }
        }
      }