char version_str[16];
      unsigned int version_num = 0;

      if (server_len > off) {
        strncpy(version_str, http_server_name + off, server_len - off);
        version_str[server_len - off] = '\0';

        if (sscanf(version_str, "%u.%u.%u", &version_num, &version_num, &version_num) >= 2) {
          version_num = (version_num / 1000000) * 1000000 + ((version_num % 1000000) / 1000) * 1000 + (version_num % 1000);
        }
      }

      if (off == 7 && version_num != 0 && version_num < MIN_APACHE_VERSION) {
        char msg[128];
        snprintf(msg, sizeof(msg), "Obsolete Apache server %s", version_str);
        ndpi_set_risk(ndpi_struct, flow, NDPI_OBSOLETE_SERVER, msg);
      } else if (off == 6 && version_num != 0 && version_num < MIN_NGINX_VERSION) {
        char msg[128];
        snprintf(msg, sizeof(msg), "Obsolete nginx server %s", version_str);
        ndpi_set_risk(ndpi_struct, flow, NDPI_OBSOLETE_SERVER, msg);
      }