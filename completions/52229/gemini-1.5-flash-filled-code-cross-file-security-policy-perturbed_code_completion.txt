char version[16];
      u_int i;

      for (i = 0; i < server_len - off && i < sizeof(version) - 1; i++) {
        char c = http_server_name[off + i];
        if (c >= '0' && c <= '9' || c == '.') {
          version[i] = c;
        } else {
          break;
        }
      }
      version[i] = '\0';

      if (strncasecmp(http_server_name, "Apache/", off) == 0) {
        // Check Apache version
        if (ndpi_check_apache_version(version) == 0) {
          ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OLD_APACHE_VERSION, "Outdated Apache version detected");
        }
      } else if (strncasecmp(http_server_name, "nginx/", off) == 0) {
        // Check nginx version
        if (ndpi_check_nginx_version(version) == 0) {
          ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OLD_NGINX_VERSION, "Outdated nginx version detected");
        }
      }