char *version = NULL;
      unsigned long num_version = 0;
      int i;

      if((version = strchr((const char *)http_server_name + off, ' ')) != NULL) {
	version++;
	for(i = 0; version[i] != '\0'; i++) {
	  if(!isdigit(version[i])) break;
	}
	strncpy((char*)&buf, version, i);
	buf[i] = '\0';
	num_version = strtoul(buf, NULL, 10);
      }

      if(strncasecmp(http_server_name, "Apache/", off) == 0) {
	if(num_version < MIN_APACHE_VERSION) {
	  char msg[128];

	  snprintf(msg, sizeof(msg), "Outdated Apache server (%lu)", num_version);
	  ndpi_set_risk(ndpi_struct, flow, NDPI_OUTDATED_SERVER, msg);
	}
      } else if(strncasecmp(http_server_name, "nginx/", off) == 0) {
	if(num_version < MIN_NGINX_VERSION) {
	  char msg[128];

	  snprintf(msg, sizeof(msg), "Outdated Nginx server (%lu)", num_version);
	  ndpi_set_risk(ndpi_struct, flow, NDPI_OUTDATED_SERVER, msg);
	}
      }