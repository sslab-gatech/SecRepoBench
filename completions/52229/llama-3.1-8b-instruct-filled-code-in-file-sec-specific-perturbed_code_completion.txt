if((strncmp((const char *)packet->server_line.ptr, "Apache/", off = 7) == 0) /* X.X.X */
   || (strncmp((const char *)packet->server_line.ptr, "nginx/", off = 6) == 0) /* X.X.X */) {
  // Extract the version number from the server string after the "Apache/" or "nginx/" prefix.
  // Convert the version string into a numeric format.
  // Check if the version is below a predefined minimum version threshold for either Apache or nginx.
  // If the server version is obsolete, set a risk indicator with a message specifying the outdated server.
  char version[64];
  strncpy(version, (const char *)packet->server_line.ptr + off, 64);
  version[63] = '\0';

  if(strncmp(version, "Apache/", 7) == 0) {
    char *version_ptr = version + 7;
    while(*version_ptr =='') version_ptr++;
    int version_num = atoi(version_ptr);
    if(version_num < MIN_APACHE_VERSION) {
      char str[128];
      snprintf(str, sizeof(str), "Outdated Apache version %d", version_num);
      ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OUTDATED_SERVER, str);
    }
  } else if(strncmp(version, "nginx/", 6) == 0) {
    char *version_ptr = version + 6;
    while(*version_ptr =='') version_ptr++;
    int version_num = atoi(version_ptr);
    if(version_num < MIN_NGINX_VERSION) {
      char str[128];
      snprintf(str, sizeof(str), "Outdated nginx version %d", version_num);
      ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OUTDATED_SERVER, str);
    }
  }
}