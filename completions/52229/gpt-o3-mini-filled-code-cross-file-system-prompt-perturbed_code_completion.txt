{
  unsigned int server_major = 0, server_minor = 0;
  const unsigned int min_apache_major = 2, min_apache_minor = 4;
  const unsigned int min_nginx_major = 1, min_nginx_minor = 10;
  if (sscanf(http_server_name + off, "%u.%u", &server_major, &server_minor) >= 2) {
    if (strncasecmp(http_server_name, "Apache/", 7) == 0) {
      if ((server_major < min_apache_major) ||
	  (server_major == min_apache_major && server_minor < min_apache_minor)) {
	char msg[128];
	snprintf(msg, sizeof(msg), "Obsolete Apache server version %u.%u", server_major, server_minor);
	ndpi_set_risk(ndpi_struct, flow, NDPI_PROTOCOL_HTTP, msg);
      }
    } else if (strncasecmp(http_server_name, "nginx/", 6) == 0) {
      if ((server_major < min_nginx_major) ||
	  (server_major == min_nginx_major && server_minor < min_nginx_minor)) {
	char msg[128];
	snprintf(msg, sizeof(msg), "Obsolete nginx server version %u.%u", server_major, server_minor);
	ndpi_set_risk(ndpi_struct, flow, NDPI_PROTOCOL_HTTP, msg);
      }
    }
  }
}