char version[16];
      int version_major, version_minor, version_patch;

      if (off < server_len) {
        int n = server_len - off;
        if (n >= (int)sizeof(version))
          n = sizeof(version) - 1;
        memcpy(version, http_server_name + off, n);
        version[n] = '\0';

        if (sscanf(version, "%d.%d.%d", &version_major, &version_minor, &version_patch) >= 2) {
          if (strncasecmp(http_server_name, "Apache/", 7) == 0) {
            // Check against a minimum required version for Apache (e.g., 2.4.29)
            if (version_major < 2 || (version_major == 2 && version_minor < 4) || (version_major == 2 && version_minor == 4 && version_patch < 29)) {
              char risk_message[128];
              snprintf(risk_message, sizeof(risk_message), "Obsolete Apache server: %s", version);
              ndpi_set_risk(ndpi_struct, flow, NDPI_OBSOLETE_SERVER, risk_message);
            }
          } else if (strncasecmp(http_server_name, "nginx/", 6) == 0) {
            // Check against a minimum required version for nginx (e.g., 1.18.0)
            if (version_major < 1 || (version_major == 1 && version_minor < 18) || (version_major == 1 && version_minor == 18 && version_patch < 0)) {
              char risk_message[128];
              snprintf(risk_message, sizeof(risk_message), "Obsolete nginx server: %s", version);
              ndpi_set_risk(ndpi_struct, flow, NDPI_OBSOLETE_SERVER, risk_message);
            }
          }
        }
      }