char *version_str = &http_server_name[off];
u_int version_len = server_len - off;
float version;
char str[32];

if((version_str[0] >= '0') && (version_str[0] <= '9')) {
  if(strchr(version_str, '.') != NULL) {
    version = ndpi_strtof(version_str, NULL);
    if(version > 0) {
      if(strncasecmp(http_server_name, "Apache/", off) == 0) {
	if(version < ndpi_struct->http_obsolete_server_threshold.apache_ver) {
	  snprintf(str, sizeof(str), "Outdated Apache version %s", version_str);
	  ndpi_set_risk(ndpi_struct, flow, NDPI_OBSOLETE_SERVER, str);
	}
      } else if(strncasecmp(http_server_name, "nginx/", off) == 0) {
	if(version < ndpi_struct->http_obsolete_server_threshold.nginx_ver) {
	  snprintf(str, sizeof(str), "Outdated nginx version %s", version_str);
	  ndpi_set_risk(ndpi_struct, flow, NDPI_OBSOLETE_SERVER, str);
	}
      }
    }
  }
}