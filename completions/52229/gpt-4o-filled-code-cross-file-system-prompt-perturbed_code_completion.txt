char version_str[16];
      float version;
      const float apache_min_version = 2.4;
      const float nginx_min_version = 1.18;

      // Extract version number
      if (sscanf(http_server_name + off, "%15s", version_str) == 1) {
        version = atof(version_str);

        // Check for Apache version
        if (strncasecmp(http_server_name, "Apache/", 7) == 0 && version < apache_min_version) {
          char risk_message[64];
          snprintf(risk_message, sizeof(risk_message), "Outdated Apache version: %.2f", version);
          ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OBSOLETE_SERVER, risk_message);
        }
        // Check for nginx version
        else if (strncasecmp(http_server_name, "nginx/", 6) == 0 && version < nginx_min_version) {
          char risk_message[64];
          snprintf(risk_message, sizeof(risk_message), "Outdated nginx version: %.2f", version);
          ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OBSOLETE_SERVER, risk_message);
        }
      }