u_int version_off = off;
  char *version = &http_server_name[version_off];

  // Extract the version number from the server string after the "Apache/" or "nginx/" prefix.
  while(version_off < server_len && isdigit((unsigned char)version[version_off])) {
    version_off++;
  }

  // Convert the version string into a numeric format.
  float version_num = atof(version);

  // Check if the version is below a predefined minimum version threshold for either Apache or nginx.
  if(strncmp(http_server_name, "Apache/", 7) == 0) {
    if(version_num < 2.4) {
      // If the server version is obsolete, set a risk indicator with a message specifying the outdated server.
      ndpi_set_risk(ndpi_struct, flow, NDPI_KNOWN_PROTOCOL_ON_NON_STANDARD_PORT, "Outdated Apache server version detected");
    }
  } else if(strncmp(http_server_name, "nginx/", 6) == 0) {
    if(version_num < 1.15) {
      ndpi_set_risk(ndpi_struct, flow, NDPI_KNOWN_PROTOCOL_ON_NON_STANDARD_PORT, "Outdated nginx server version detected");
    }
  }
}