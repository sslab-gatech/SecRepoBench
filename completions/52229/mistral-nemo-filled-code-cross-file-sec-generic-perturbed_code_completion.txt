// Extract the version number from the server string after the "Apache/" or "nginx/" prefix.
char *version_start = http_server_name + off;
char *version_end = strchr(version_start, ' ');

// Convert the version string into a numeric format.
double version = atof(version_end ? version_end - version_start : version_start);

// Check if the version is below a predefined minimum version threshold for either Apache or nginx.
double min_version = (strncmp(http_server_name, "Apache/", off) == 0) ? 2.4 : 1.15;

// If the server version is obsolete, set a risk indicator with a message specifying the outdated server.
if (version < min_version) {
  char risk_msg[128];
  snprintf(risk_msg, sizeof(risk_msg), "Outdated %s server version %s, minimum required version is %s",
           (strncmp(http_server_name, "Apache/", off) == 0) ? "Apache" : "nginx",
           version_start, min_version);
  ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OUTDATED_SERVER, risk_msg);
}