u_int version = 0, major = 0, minor = 0, patch = 0;
      const char *version_str = &http_server_name[off];
      char *endptr;

      major = strtoul(version_str, &endptr, 10);
      if (*endptr == '.') {
        version_str = endptr + 1;
        minor = strtoul(version_str, &endptr, 10);
        if (*endptr == '.') {
          version_str = endptr + 1;
          patch = strtoul(version_str, &endptr, 10);
        }
      }

      version = (major * 1000000) + (minor * 1000) + patch;

      if ((off == 7 && version < MIN_APACHE_VERSION) ||
          (off == 6 && version < MIN_NGINX_VERSION)) {
        char str[64];
        snprintf(str, sizeof(str), "Obsolete server %.*s", server_len, http_server_name);
        ndpi_set_risk(ndpi_struct, flow, NDPI_OBSOLETE_SERVER, str);
      }