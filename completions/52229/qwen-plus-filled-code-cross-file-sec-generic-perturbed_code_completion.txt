char *version_str = http_server_name + off;
double version;

if(sscanf(version_str, "%lf", &version) != 1) {
  NDPI_LOG_INFO(ndpi_struct, "Invalid version format detected.\n");
  return;
}

if(off == 7) { /* Apache */
  if(version < MIN_APACHE_VERSION) {
    char risk_msg[256];
    snprintf(risk_msg, sizeof(risk_msg), "Outdated Apache server version detected: %.2f. Recommended minimum version: %.2f", version, MIN_APACHE_VERSION);
    ndpi_set_risk(ndpi_struct, flow, NDPI_SERVER_VERSION_OUTDATED, risk_msg);
  }
} else if(off == 6) { /* nginx */
  if(version < MIN_NGINX_VERSION) {
    char risk_msg[256];
    snprintf(risk_msg, sizeof(risk_msg), "Outdated nginx server version detected: %.2f. Recommended minimum version: %.2f", version, MIN_NGINX_VERSION);
    ndpi_set_risk(ndpi_struct, flow, NDPI_SERVER_VERSION_OUTDATED, risk_msg);
  }
}