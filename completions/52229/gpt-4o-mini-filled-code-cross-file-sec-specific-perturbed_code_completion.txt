char version[16];
      int version_len = 0;

      // Extract version number
      if (http_server_name[off] != '\0') {
        version_len = strcspn(http_server_name + off, " ");
        if (version_len >= sizeof(version)) {
          version_len = sizeof(version) - 1; // Prevent overflow
        }
        strncpy(version, http_server_name + off, version_len);
        version[version_len] = '\0'; // Null-terminate

        // Convert version string to numeric format (example: "2.4.41" to 20441)
        int major, minor, patch;
        if (sscanf(version, "%d.%d.%d", &major, &minor, &patch) == 3) {
          int numeric_version = major * 10000 + minor * 100 + patch;

          // Check against a predefined minimum version threshold
          if ((strncasecmp(http_server_name, "Apache/", 7) == 0 && numeric_version < 20400) ||
              (strncasecmp(http_server_name, "nginx/", 6) == 0 && numeric_version < 10100)) {
            char risk_message[64];
            snprintf(risk_message, sizeof(risk_message), "Outdated server version: %s", version);
            ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OUTDATED_SERVER, risk_message);
          }
        }
      }