char *version_start;
      char version[16];
      int version_num;

      if (strncasecmp(http_server_name, "Apache/", off) == 0) {
        version_start = (char *)http_server_name + off;
      } else {
        version_start = (char *)http_server_name + off;
      }

      strncpy(version, version_start, sizeof(version) - 1);
      version[strcspn(version, " \t\r\n")] = 0; //remove trailing whitespace

      if (sscanf(version, "%d", &version_num) != 1) {
        version_num = 0; // Handle cases where version parsing fails
      }

      if (strncasecmp(http_server_name, "Apache/", off) == 0 && version_num < 24) {
        ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OBSOLETE_APACHE, "Outdated Apache HTTP Server detected");
      } else if (strncasecmp(http_server_name, "nginx/", off) == 0 && version_num < 110) {
        ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OBSOLETE_NGINX, "Outdated Nginx HTTP Server detected");
      }