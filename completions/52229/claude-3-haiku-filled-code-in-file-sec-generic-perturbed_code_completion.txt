static void ndpi_check_http_server(struct ndpi_detection_module_struct *ndpi_struct,
				   struct ndpi_flow_struct *flow,
				   const char *http_server_name, u_int server_len) {
  if(server_len > 7) {
    u_int off;
  
    if(strncmp((const char *)http_server_name, "ntopng ", 7) == 0) {
      ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_NTOP, NDPI_PROTOCOL_HTTP, NDPI_CONFIDENCE_DPI);
      NDPI_CLR_BIT(flow->risk, NDPI_KNOWN_PROTOCOL_ON_NON_STANDARD_PORT);
    } else if((strncasecmp(http_server_name, "Apache/", off = 7) == 0) /* X.X.X */
	      || (strncasecmp(http_server_name, "nginx/", off = 6) == 0) /* X.X.X */) {
      int version = 0;
      int major = 0, minor = 0, patch = 0;
      int rc = sscanf(http_server_name + off, "%d.%d.%d", &major, &minor, &patch);
      if (rc >= 1) {
        version = major * 1000000 + minor * 1000 + patch;
        if (version < MIN_APACHE_VERSION || version < MIN_NGINX_VERSION) {
          char str[64];
          snprintf(str, sizeof(str), "Outdated %s version %d.%d.%d", 
                   strncasecmp(http_server_name, "Apache/", 7) == 0 ? "Apache" : "Nginx",
                   major, minor, patch);
          ndpi_set_risk(ndpi_struct, flow, NDPI_KNOWN_PROTOCOL_ON_NON_STANDARD_PORT, str);
        }
      }
    }
  }
}