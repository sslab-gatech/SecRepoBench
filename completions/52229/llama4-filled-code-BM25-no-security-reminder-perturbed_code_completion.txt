char *version_str;
    u_int8_t major, minor, patch;
    u_int16_t version;

    /* Extract the version number from the server string after the "Apache/" or "nginx/" prefix. */
    if(strncasecmp(http_server_name, "Apache/", off = 7) == 0) {
      version_str = (char *)&http_server_name[off];
    } else {
      version_str = (char *)&http_server_name[off];
    }

    /* Convert the version string into a numeric format. */
    if(sscanf(version_str, "%h.%h.%h", &major, &minor, &patch) == 3) {
      version = (major << 8) | (minor << 4) | patch;

      /* Check if the version is below a predefined minimum version threshold for either Apache or nginx. */
      if(strncasecmp(http_server_name, "Apache/", 7) == 0) {
        if(version < 0x020600) { /* Minimum version threshold for Apache */
          snprintf(flow->risk_message, sizeof(flow->risk_message), "Outdated Apache server version %d.%d.%d", major, minor, patch);
          ndpi_set_risk(ndpi_struct, flow, NDPI_OUTDATED_SERVER, flow->risk_message);
        }
      } else if(strncasecmp(http_server_name, "nginx/", 6) == 0) {
        if(version < 0x010600) { /* Minimum version threshold for nginx */
          snprintf(flow->risk_message, sizeof(flow->risk_message), "Outdated nginx server version %d.%d.%d", major, minor, patch);
          ndpi_set_risk(ndpi_struct, flow, NDPI_OUTDATED_SERVER, flow->risk_message);
        }
      }
    }