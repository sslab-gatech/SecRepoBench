const char *version = http_server_name + off;
float version_num = atof(version);

if ((strncasecmp(http_server_name, "Apache/", 7) == 0 && version_num < 2.4) ||
    (strncasecmp(http_server_name, "nginx/", 6) == 0 && version_num < 1.18)) {
  char risk_str[128];
  snprintf(risk_str, sizeof(risk_str), "Obsolete %s web server detected (v%.1f)",
           (off == 7) ? "Apache" : "nginx", version_num);
  ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OBSOLETE_SERVER, risk_str);
}