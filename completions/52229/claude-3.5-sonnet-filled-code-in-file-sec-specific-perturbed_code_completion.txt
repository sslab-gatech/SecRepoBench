char version_str[16];
      unsigned int major, minor, patch;
      unsigned int version_num;

      if(sscanf((const char*)http_server_name + off, "%u.%u.%u", &major, &minor, &patch) == 3) {
        version_num = major * 1000000 + minor * 1000 + patch;

        if(strncasecmp(http_server_name, "Apache/", 7) == 0) {
          if(version_num < MIN_APACHE_VERSION) {
            snprintf(version_str, sizeof(version_str), "%u.%u.%u", major, minor, patch);
            ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OBSOLETE_SERVER, "Obsolete Apache server");
          }
        } else if(strncasecmp(http_server_name, "nginx/", 6) == 0) {
          if(version_num < MIN_NGINX_VERSION) {
            snprintf(version_str, sizeof(version_str), "%u.%u.%u", major, minor, patch);
            ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OBSOLETE_SERVER, "Obsolete nginx server");
          }
        }
      }