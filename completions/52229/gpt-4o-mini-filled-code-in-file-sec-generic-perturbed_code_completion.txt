char version[16];
      strncpy(version, &http_server_name[off], server_len - off);
      version[server_len - off] = '\0';

      int major, minor;
      if (sscanf(version, "%d.%d", &major, &minor) == 2) {
        if ((strncasecmp(http_server_name, "Apache/", 7) == 0 && (major * 10000 + minor * 100) < MIN_APACHE_VERSION) ||
            (strncasecmp(http_server_name, "nginx/", 6) == 0 && (major * 10000 + minor * 100) < MIN_NGINX_VERSION)) {
          char str[64];
          snprintf(str, sizeof(str), "Outdated server version: %s", version);
          ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OUTDATED_SERVER, str);
        }
      }