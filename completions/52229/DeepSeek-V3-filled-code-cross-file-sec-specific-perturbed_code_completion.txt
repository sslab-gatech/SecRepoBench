char version_str[16];
      u_int version_len = 0;
      u_int i;
      float version_num = 0.0;
      float min_version = 0.0;
      const char *server_type = NULL;

      /* Extract version string */
      for(i = off; i < server_len && version_len < sizeof(version_str)-1; i++) {
        if(http_server_name[i] == ' ' || http_server_name[i] == '\0')
          break;
        version_str[version_len++] = http_server_name[i];
      }
      version_str[version_len] = '\0';

      /* Convert version string to number */
      if(sscanf(version_str, "%f", &version_num) != 1)
        return;

      /* Set minimum version and server type based on detected server */
      if(strncasecmp(http_server_name, "Apache/", 7) == 0) {
        min_version = 2.4;
        server_type = "Apache";
      } else if(strncasecmp(http_server_name, "nginx/", 6) == 0) {
        min_version = 1.14;
        server_type = "nginx";
      } else {
        return;
      }

      /* Check if version is outdated */
      if(version_num < min_version) {
        char risk_msg[64];
        snprintf(risk_msg, sizeof(risk_msg), "Outdated %s server version %s", server_type, version_str);
        ndpi_set_risk(ndpi_struct, flow, NDPI_OBSOLETE_SERVER, risk_msg);
      }