// Extract the version number from the server string after the "Apache/" or "nginx/" prefix.
char *version_start = http_server_name + off;
char *version_end = strchr(version_start, '/');
if (version_end != NULL) {
    *version_end = '\0';
    float server_version = atof(version_start);

    // Convert the version string into a numeric format.
    // Check if the version is below a predefined minimum version threshold for either Apache or nginx.
    float min_apache_version = 2.4;
    float min_nginx_version = 1.14;
    if ((strncasecmp(http_server_name, "Apache/", off) == 0 && server_version < min_apache_version) ||
        (strncasecmp(http_server_name, "nginx/", off) == 0 && server_version < min_nginx_version)) {
        // If the server version is obsolete, set a risk indicator with a message specifying the outdated server.
        char risk_message[128];
        snprintf(risk_message, sizeof(risk_message), "Outdated %s server version detected: %s", http_server_name, version_start);
        ndpi_set_risk(ndpi_struct, flow, NDPI_KNOWN_PROTOCOL_ON_NON_STANDARD_PORT, risk_message);
    }
}