if(server_len > 7) {
    u_int offset;

    if(strncmp((const char *)http_server_name, "ntopng ", 7) == 0) {
      // ...
    } else if((strncasecmp(http_server_name, "Apache/", offset = 7) == 0) ||
	      (strncasecmp(http_server_name, "nginx/", offset = 6) == 0)) {
      char *version_start = http_server_name + offset;
      char *version_end = strchr(version_start, ' ');
      if(version_end != NULL) {
	*version_end = '\0'; // Null-terminate the version string
	u_int version_len = version_end - version_start;
	char version[version_len + 1];
	strncpy(version, version_start, version_len);
	version[version_len] = '\0';

	// Parse and compare the version number here
	// ...

	// If the server version is obsolete, set a risk indicator
	if(obsolete_version) {
	  char risk_message[128];
	  snprintf(risk_message, sizeof(risk_message), "Outdated %s server version: %s", server_type, version);
	  ndpi_set_risk(ndpi_struct, flow, NDPI_KNOWN_PROTOCOL_ON_NON_STANDARD_PORT, risk_message);
	}
      }
    }
  }