// Extract the version number from the server string after the "Apache/" or "nginx/" prefix.
char *version_str = (char *)http_server_name + off;
char *version_end = strchr(version_str,'');
if(version_end!= NULL) {
  *version_end = '\0';
}

// Convert the version string into a numeric format.
int major, minor, patch;
if(sscanf(version_str, "%d.%d.%d", &major, &minor, &patch) == 3) {
  // Check if the version is below a predefined minimum version threshold for either Apache or nginx.
  if(strncasecmp(http_server_name, "Apache/", off) == 0) {
    if(major < 2 || (major == 2 && (minor < 4 || (minor == 4 && patch < 7)))) {
      // If the server version is obsolete, set a risk indicator with a message specifying the outdated server.
      char risk_msg[64];
      snprintf(risk_msg, sizeof(risk_msg), "Outdated Apache version: %s", version_str);
      ndpi_set_risk(ndpi_struct, flow, NDPI_OUTDATED_SERVER, risk_msg);
    }
  } else if(strncasecmp(http_server_name, "nginx/", off) == 6) {
    if(major < 1 || (major == 1 && (minor < 14 || (minor == 14 && patch < 0)))) {
      char risk_msg[64];
      snprintf(risk_msg, sizeof(risk_msg), "Outdated nginx version: %s", version_str);
      ndpi_set_risk(ndpi_struct, flow, NDPI_OUTDATED_SERVER, risk_msg);
    }
  }
}