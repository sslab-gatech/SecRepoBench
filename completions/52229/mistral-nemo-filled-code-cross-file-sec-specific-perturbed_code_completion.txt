// Extract the version number from the server string after the "Apache/" or "nginx/" prefix.
u_int version_off = off;
char *version = &http_server_name[version_off];
char *end = strchr(version, ' ');

// Convert the version string into a numeric format.
double version_num = atof(version);

// Check if the version is below a predefined minimum version threshold for either Apache or nginx.
double min_version = 0.0; // Set the minimum version threshold here
if (strncmp(http_server_name, "Apache/", off) == 0) {
    min_version = 2.4; // Set the minimum version threshold for Apache here
} else if (strncmp(http_server_name, "nginx/", off) == 0) {
    min_version = 1.15.5; // Set the minimum version threshold for nginx here
}

if (version_num < min_version) {
    // If the server version is obsolete, set a risk indicator with a message specifying the outdated server.
    char risk_msg[128];
    snprintf(risk_msg, sizeof(risk_msg), "Outdated %s server version: %s", (strncmp(http_server_name, "Apache/", off) == 0) ? "Apache" : "nginx", version);
    ndpi_set_risk(ndpi_struct, flow, NDPI_KNOWN_PROTOCOL_ON_NON_STANDARD_PORT, risk_msg);
}