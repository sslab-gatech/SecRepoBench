char version_str[32];
      u_int version_len = 0;
      double version = 0.0;

      /* Extract version string */
      while ((off < server_len) && (version_len < sizeof(version_str) - 1)
	     && (isdigit(http_server_name[off]) || (http_server_name[off] == '.'))) {
	version_str[version_len++] = http_server_name[off];
	off++;
      }
      version_str[version_len] = '\0';

      if (version_len > 0) {
	version = ndpi_atof(version_str);

	if (strncasecmp(http_server_name, "Apache/", 7) == 0) {
	  /* Check for obsolete Apache version */
	  if (version < 2.4) {
	    char str[128];
	    snprintf(str, sizeof(str), "Obsolete Apache version: %s", version_str);
	    ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OBSOLETE_APACHE, str);
	  }
	} else if (strncasecmp(http_server_name, "nginx/", 6) == 0) {
	  /* Check for obsolete Nginx version */
	  if (version < 1.10) {
	    char str[128];
	    snprintf(str, sizeof(str), "Obsolete Nginx version: %s", version_str);
	    ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OBSOLETE_NGINX, str);
	  }
	}
      }