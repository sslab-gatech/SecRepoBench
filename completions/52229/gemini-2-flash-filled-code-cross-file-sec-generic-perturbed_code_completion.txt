char version[32];
      u_int version_len = 0;
      u_int i;

      /* Extract version string */
      for(i = off; i < server_len; i++) {
	if(isdigit(http_server_name[i]) || http_server_name[i] == '.') {
	  version[version_len++] = http_server_name[i];
	  if (version_len >= sizeof(version) - 1)
	    break;
	} else
	  break;
      }
      version[version_len] = '\0';

      if(version_len > 0) {
	double version_num = ndpi_atof(version);

	if(strncasecmp(http_server_name, "Apache/", off) == 0) {
	  /* Check for obsolete Apache version */
	  if(version_num < 2.4) {
	    char str[128];

	    snprintf(str, sizeof(str), "Obsolete Apache version: %s", version);
	    ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OBSOLETE_APACHE, str);
	  }
	} else if(strncasecmp(http_server_name, "nginx/", off) == 0) {
	  /* Check for obsolete Nginx version */
	  if(version_num < 1.10) {
	    char str[128];

	    snprintf(str, sizeof(str), "Obsolete Nginx version: %s", version);
	    ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OBSOLETE_NGINX, str);
	  }
	}
      }