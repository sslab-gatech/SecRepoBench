// Extract the version number from the server string after the "Apache/" or "nginx/" prefix.
      char version[16];
      if (strncasecmp(http_server_name, "Apache/", off) == 0) {
        strncpy(version, http_server_name + off, 5); // Assuming version is at most 5 characters long
        version[5] = '\0';
      } else if (strncasecmp(http_server_name, "nginx/", off) == 0) {
        strncpy(version, http_server_name + off, 4); // Assuming version is at most 4 characters long
        version[4] = '\0';
      }

      // Convert the version string into a numeric format.
      float version_number = atof(version);

      // Check if the version is below a predefined minimum version threshold for either Apache or nginx.
      const float apache_min_version = 2.2; // Example threshold
      const float nginx_min_version = 1.7; // Example threshold

      if ((strncasecmp(http_server_name, "Apache/", off) == 0 && version_number < apache_min_version) ||
          (strncasecmp(http_server_name, "nginx/", off) == 0 && version_number < nginx_min_version)) {
        // If the server version is obsolete, set a risk indicator with a message specifying the outdated server.
        char risk_message[128];
        snprintf(risk_message, sizeof(risk_message), "Obsolete server version detected: %s", version);
        ndpi_set_risk(ndpi_struct, flow, NDPI_RISK_OBSOLETE_VERSION, risk_message);
      }