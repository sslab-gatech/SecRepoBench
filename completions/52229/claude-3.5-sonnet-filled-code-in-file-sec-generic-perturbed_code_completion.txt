// Extract the version number from the server string after the "Apache/" or "nginx/" prefix.
      char version[16] = {0};
      int version_len = ndpi_min(15, packet->server_line.len - off);
      strncpy(version, (const char *)&packet->server_line.ptr[off], version_len);
      version[version_len] = '\0';

      // Convert the version string into a numeric format.
      int major, minor, patch;
      if (sscanf(version, "%d.%d.%d", &major, &minor, &patch) >= 2) {
        int numeric_version = (major * 1000000) + (minor * 1000) + patch;

        // Check if the version is below a predefined minimum version threshold for either Apache or nginx.
        int min_version = (strncasecmp(http_server_name, "Apache/", 7) == 0) ? MIN_APACHE_VERSION : MIN_NGINX_VERSION;

        // If the server version is obsolete, set a risk indicator with a message specifying the outdated server.
        if (numeric_version < min_version) {
          char risk_str[128];
          snprintf(risk_str, sizeof(risk_str), "Outdated %s server version %s",
                   (strncasecmp(http_server_name, "Apache/", 7) == 0) ? "Apache" : "nginx",
                   version);
          ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OBSOLETE_SERVER, risk_str);
        }
      }