// Extract the version number from the server string after the "Apache/" or "nginx/" prefix.
// Convert the version string into a numeric format.
// Check if the version is below a predefined minimum version threshold for either Apache or nginx.
// If the server version is obsolete, set a risk indicator with a message specifying the outdated server.
char *version_str = (char *)http_server_name + off;
char *version_end = strchr(version_str,'');
u_int32_t version = 0;

if (version_end!= NULL) {
    *version_end = '\0';
    version = atoi(version_str);
    *version_end ='';
}

if (version < MIN_APACHE_VERSION && strncmp((const char *)http_server_name, "Apache/", off) == 0) {
    char str[64];

    snprintf(str, sizeof(str), "Outdated Apache version %u", version);
    ndpi_set_risk(ndpi_struct, flow, NDPI_OUTDATED_SERVER, str);
} else if (version < MIN_NGINX_VERSION && strncmp((const char *)http_server_name, "nginx/", off) == 0) {
    char str[64];

    snprintf(str, sizeof(str), "Outdated Nginx version %u", version);
    ndpi_set_risk(ndpi_struct, flow, NDPI_OUTDATED_SERVER, str);
}