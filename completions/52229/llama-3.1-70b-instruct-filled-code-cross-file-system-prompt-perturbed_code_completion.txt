// Extract the version number from the server string after the "Apache/" or "nginx/" prefix.
char *version_str = (char *)http_server_name + off;
char *version_end = strchr(version_str,'');
if(version_end!= NULL) {
  *version_end = '\0';
}

// Convert the version string into a numeric format.
float version = atof(version_str);

// Check if the version is below a predefined minimum version threshold for either Apache or nginx.
if(strncasecmp(http_server_name, "Apache/", off) == 0) {
  // Minimum version threshold for Apache.
  float min_version = 2.4;
  if(version < min_version) {
    // Set a risk indicator with a message specifying the outdated server.
    char str[64];
    snprintf(str, sizeof(str), "Outdated Apache server version %.1f", version);
    ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OUTDATED_SERVER, str);
  }
} else if(strncasecmp(http_server_name, "nginx/", off) == 0) {
  // Minimum version threshold for nginx.
  float min_version = 1.14;
  if(version < min_version) {
    // Set a risk indicator with a message specifying the outdated server.
    char str[64];
    snprintf(str, sizeof(str), "Outdated nginx server version %.1f", version);
    ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OUTDATED_SERVER, str);
  }
}