char server_version[16];
      int version_major, version_minor, version_patch;

      if (server_len - off < sizeof(server_version)) {
        strncpy(server_version, http_server_name + off, server_len - off);
        server_version[server_len - off] = '\0';

        if (sscanf(server_version, "%d.%d.%d", &version_major, &version_minor, &version_patch) == 3) {
          if (strncasecmp(http_server_name, "Apache/", 7) == 0) {
            // Example: Check for Apache versions below 2.4.29
            if (version_major < 2 || (version_major == 2 && version_minor < 4) || (version_major == 2 && version_minor == 4 && version_patch < 29)) {
              ndpi_set_risk(ndpi_struct, flow, NDPI_OBSOLETE_SERVER, "Detected obsolete Apache server");
            }
          } else if (strncasecmp(http_server_name, "nginx/", 6) == 0) {
            // Example: Check for nginx versions below 1.18.0
            if (version_major < 1 || (version_major == 1 && version_minor < 18) || (version_major == 1 && version_minor == 18 && version_patch < 0)) {
              ndpi_set_risk(ndpi_struct, flow, NDPI_OBSOLETE_SERVER, "Detected obsolete nginx server");
            }
          }
        }
      }