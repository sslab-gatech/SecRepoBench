char *version_str = http_server_name + off;
double version_num;

if(sscanf(version_str, "%lf", &version_num) == 1) {
  if(strncasecmp(http_server_name, "Apache/", off) == 0) {
    // Assuming predefined minimum Apache version
    #define MIN_APACHE_VERSION 2.4
    if(version_num < MIN_APACHE_VERSION) {
      char risk_message[256];
      snprintf(risk_message, sizeof(risk_message), "Outdated Apache server version %lf detected", version_num);
      ndpi_set_risk(ndpi_struct, flow, NDPI_RISK_OUTDATED_SERVER, risk_message);
    }
  } else if(strncasecmp(http_server_name, "nginx/", off) == 0) {
    // Assuming predefined minimum nginx version
    #define MIN_NGINX_VERSION 1.18
    if(version_num < MIN_NGINX_VERSION) {
      char risk_message[256];
      snprintf(risk_message, sizeof(risk_message), "Outdated nginx server version %lf detected", version_num);
      ndpi_set_risk(ndpi_struct, flow, NDPI_RISK_OUTDATED_SERVER, risk_message);
    }
  }
}