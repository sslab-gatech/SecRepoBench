const char *version_str = http_server_name + off;
      int major, minor, patch;
      int version_num = 0;

      if (sscanf(version_str, "%d.%d.%d", &major, &minor, &patch) == 3) {
        version_num = major * 1000000 + minor * 1000 + patch;
      } else if (sscanf(version_str, "%d.%d", &major, &minor) == 2) {
        version_num = major * 1000000 + minor * 1000;
      }

      if ((strncasecmp(http_server_name, "Apache/", off) == 0 && version_num < MIN_APACHE_VERSION) ||
          (strncasecmp(http_server_name, "nginx/", off) == 0 && version_num < MIN_NGINX_VERSION)) {
        char str[64];
        snprintf(str, sizeof(str), "Obsolete server %s", http_server_name);
        ndpi_set_risk(ndpi_struct, flow, NDPI_OBSOLETE_SERVER, str);
      }