} else if((strncasecmp(http_server_name, "Apache/", off = 7) == 0) /* X.X.X */
	  || (strncasecmp(http_server_name, "nginx/", off = 6) == 0) /* X.X.X */) {
  // Extract the version number from the server string after the "Apache/" or "nginx/" prefix.
  // Convert the version string into a numeric format.
  // Check if the version is below a predefined minimum version threshold for either Apache or nginx.
  // If the server version is obsolete, set a risk indicator with a message specifying the outdated server.
  char *version = NULL;
  if (strncasecmp(http_server_name, "Apache/", 7) == 0) {
    version = strstr(http_server_name, "Apache/");
    if (version!= NULL) {
      version += 7;
    }
  } else if (strncasecmp(http_server_name, "nginx/", 6) == 0) {
    version = strstr(http_server_name, "nginx/");
    if (version!= NULL) {
      version += 6;
    }
  }

  if (version!= NULL) {
    char *endptr;
    long version_num = strtol(version, &endptr, 10);
    if (endptr!= version && *endptr == '\0') {
      // Check if the version is below a predefined minimum version threshold
      if ((strncasecmp(http_server_name, "Apache/", 7) == 0 && version_num < 2) ||
          (strncasecmp(http_server_name, "nginx/", 6) == 0 && version_num < 1)) {
        // Set a risk indicator with a message specifying the outdated server
        char risk_message[128];
        if (strncasecmp(http_server_name, "Apache/", 7) == 0) {
          snprintf(risk_message, sizeof(risk_message), "Outdated Apache server version %ld", version_num);
        } else {
          snprintf(risk_message, sizeof(risk_message), "Outdated nginx server version %ld", version_num);
        }
        ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OUTDATED_SERVER, risk_message);
      }
    }
  }
}