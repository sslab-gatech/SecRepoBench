char *version_start = (char *)http_server_name + off;
      char *version_end = strchr(version_start, ' ');
      size_t version_len = (version_end != NULL) ? (version_end - version_start) : strlen(version_start);

      if (version_len > 0) {
        char version_str[16]; // Adjust size as needed
        strncpy(version_str, version_start, version_len);
        version_str[version_len] = '\0';

        int major, minor, patch;
        if (sscanf(version_str, "%d.%d.%d", &major, &minor, &patch) >= 2) {
          if (strncmp((const char *)http_server_name, "Apache/", 7) == 0) {
            // Example: Check for Apache version below 2.4.0
            if (major < 2 || (major == 2 && minor < 4)) {
              char risk_message[128];
              snprintf(risk_message, sizeof(risk_message), "Obsolete Apache server: %s", version_str);
              ndpi_set_risk(ndpi_struct, flow, NDPI_OBSOLETE_SERVER, risk_message);
            }
          } else if (strncmp((const char *)http_server_name, "nginx/", 6) == 0) {
            // Example: Check for nginx version below 1.18.0
            if (major < 1 || (major == 1 && minor < 18)) {
              char risk_message[128];
              snprintf(risk_message, sizeof(risk_message), "Obsolete nginx server: %s", version_str);
              ndpi_set_risk(ndpi_struct, flow, NDPI_OBSOLETE_SERVER, risk_message);
            }
          }
        }
      }