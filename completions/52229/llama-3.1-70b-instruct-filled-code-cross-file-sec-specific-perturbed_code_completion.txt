// Extract the version number from the server string after the "Apache/" or "nginx/" prefix.
char version[64];
u_int version_len = server_len - off;
if (version_len > 63) {
    version_len = 63;
}
strncpy(version, http_server_name + off, version_len);
version[version_len] = '\0';

// Convert the version string into a numeric format.
char *dot = strchr(version, '.');
if (dot!= NULL) {
    *dot = '\0';
}
int major_version = atoi(version);
dot = strchr(dot + 1, '.');
if (dot!= NULL) {
    *dot = '\0';
}
int minor_version = atoi(dot + 1);

// Check if the version is below a predefined minimum version threshold for either Apache or nginx.
if (strncmp(http_server_name, "Apache/", 7) == 0) {
    if (major_version < 2 || (major_version == 2 && minor_version < 4)) {
        // If the server version is obsolete, set a risk indicator with a message specifying the outdated server.
        char str[128];
        snprintf(str, sizeof(str), "Outdated Apache server version %d.%d detected", major_version, minor_version);
        ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OUTDATED_SERVER, str);
    }
} else if (strncmp(http_server_name, "nginx/", 6) == 0) {
    if (major_version < 1 || (major_version == 1 && minor_version < 14)) {
        // If the server version is obsolete, set a risk indicator with a message specifying the outdated server.
        char str[128];
        snprintf(str, sizeof(str), "Outdated nginx server version %d.%d detected", major_version, minor_version);
        ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OUTDATED_SERVER, str);
    }
}