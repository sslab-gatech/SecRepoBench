// Extract the version number from the server string after the "Apache/" or "nginx/" prefix.
      char version[16];
      snprintf(version, sizeof(version), "%.*s", (int)(server_len - off), http_server_name + off);

      // Convert the version string into a numeric format.
      float version_number = atof(version);

      // Check if the version is below a predefined minimum version threshold for either Apache or nginx.
      // If the server version is obsolete, set a risk indicator with a message specifying the outdated server.
      const float apache_min_version = 2.2; // Example threshold for Apache
      const float nginx_min_version = 1.6; // Example threshold for nginx

      if ((strncasecmp(http_server_name, "Apache/", off) == 0 && version_number < apache_min_version) ||
          (strncasecmp(http_server_name, "nginx/", off) == 0 && version_number < nginx_min_version)) {
        ndpi_set_risk(ndpi_struct, flow, NDPI_RISK_OBSOLETE_SERVER, "Server version is obsolete");
      }