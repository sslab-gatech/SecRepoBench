char version[16];
      unsigned long num_version;
      int i;

      memset(version, 0, sizeof(version));
      for (i = off; i < server_len; ++i) {
        if (isdigit(http_server_name[i]) || http_server_name[i] == '.') {
          version[i - off] = http_server_name[i];
        } else {
          break;
        }
      }

      if (strlen(version) > 0) {
        num_version = strtoul(version, NULL, 10);
        if (strncasecmp(http_server_name, "Apache/", off) == 0 && num_version < MIN_APACHE_VERSION) {
          char msg[128];
          snprintf(msg, sizeof(msg), "Outdated Apache server version: %s", version);
          ndpi_set_risk(ndpi_struct, flow, NDPI_OUTDATED_SERVER, msg);
        } else if (strncasecmp(http_server_name, "nginx/", off) == 0 && num_version < MIN_NGINX_VERSION) {
          char msg[128];
          snprintf(msg, sizeof(msg), "Outdated nginx server version: %s", version);
          ndpi_set_risk(ndpi_struct, flow, NDPI_OUTDATED_SERVER, msg);
        }
      }