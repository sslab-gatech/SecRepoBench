char version_str[16];
      int major, minor, patch;
      float version;
      
      // Ensure we don't read beyond the buffer
      if (server_len - off < sizeof(version_str) - 1) {
        strncpy(version_str, http_server_name + off, server_len - off);
        version_str[server_len - off] = '\0';
      } else {
        strncpy(version_str, http_server_name + off, sizeof(version_str) - 1);
        version_str[sizeof(version_str) - 1] = '\0';
      }

      // Parse the version number
      if (sscanf(version_str, "%d.%d.%d", &major, &minor, &patch) >= 2) {
        version = major + minor / 10.0 + patch / 100.0;

        // Check for obsolete versions
        if ((strncasecmp(http_server_name, "Apache/", 7) == 0 && version < 2.4) ||
            (strncasecmp(http_server_name, "nginx/", 6) == 0 && version < 1.18)) {
          char risk_message[64];
          snprintf(risk_message, sizeof(risk_message), "Obsolete server version: %s", version_str);
          ndpi_set_risk(ndpi_struct, flow, NDPI_OUTDATED_SERVER_VERSION, risk_message);
        }
      }