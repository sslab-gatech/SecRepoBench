char version[16];
      int version_num = 0;

      // Extract version number
      if (sscanf(http_server_name + off, "%15s", version) == 1) {
        // Convert version string to numeric format
        if (strstr(version, ".") != NULL) {
          int major, minor, patch;
          if (sscanf(version, "%d.%d.%d", &major, &minor, &patch) >= 2) {
            version_num = major * 10000 + minor * 100 + patch; // e.g., 2.4.46 -> 20446
          }
        }

        // Check for minimum version thresholds
        if ((strncasecmp(http_server_name, "Apache/", 7) == 0 && version_num < 20400) || // Apache < 2.4.0
            (strncasecmp(http_server_name, "nginx/", 6) == 0 && version_num < 10100)) { // nginx < 1.10.0
          char risk_message[64];
          snprintf(risk_message, sizeof(risk_message), "Outdated server version: %s", version);
          ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OUTDATED_SERVER, risk_message);
        }
      }