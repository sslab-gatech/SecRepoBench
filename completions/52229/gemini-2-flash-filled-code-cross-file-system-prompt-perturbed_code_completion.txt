char version_str[32];
      u_int version_len = 0;
      double version = 0.0, min_version = 0.0;
      int obsolete = 0;

      /* Extract version string */
      while ((off < server_len) && (version_len < sizeof(version_str) - 1)
	     && (isdigit(http_server_name[off]) || (http_server_name[off] == '.'))) {
	version_str[version_len++] = http_server_name[off++];
      }
      version_str[version_len] = '\0';

      if (version_len > 0) {
	version = ndpi_atof(version_str);

	if (strncasecmp(http_server_name, "Apache/", 7) == 0) {
	  min_version = 2.4; /* Example: Minimum required version for Apache */
	  if (version < min_version) {
	    obsolete = 1;
	  }
	} else if (strncasecmp(http_server_name, "nginx/", 6) == 0) {
	  min_version = 1.15; /* Example: Minimum required version for nginx */
	  if (version < min_version) {
	    obsolete = 1;
	  }
	}

	if (obsolete) {
	  char str[128];
	  snprintf(str, sizeof(str), "Obsolete server: %s version %.2f is less than required %.2f",
		   (strncasecmp(http_server_name, "Apache/", 7) == 0) ? "Apache" : "nginx",
		   version, min_version);
	  ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OBSOLETE_SERVER, str);
	}
      }