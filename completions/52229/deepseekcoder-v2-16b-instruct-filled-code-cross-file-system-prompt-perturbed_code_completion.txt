// Extract the version number from the server string after the "Apache/" or "nginx/" prefix.
// Convert the version string into a numeric format.
// Check if the version is below a predefined minimum version threshold for either Apache or nginx.
// If the server version is obsolete, set a risk indicator with a message specifying the outdated server.

char version[10];
int version_len = server_len - off;
strncpy(version, http_server_name + off, version_len);
version[version_len] = '\0';

// Define the minimum version thresholds
#define MIN_VERSION_APACHE "2.2"
#define MIN_VERSION_NGINX "1.10"

// Check if the server is Apache
if (strncmp(http_server_name, "Apache/", 7) == 0) {
    if (version_len > strlen(MIN_VERSION_APACHE)) {
        if (version < MIN_VERSION_APACHE) {
            ndpi_set_risk(ndpi_struct, flow, NDPI_RISK_OBSOLETE_SERVER, "Apache server version is obsolete");
        }
    }
}

// Check if the server is Nginx
else if (strncmp(http_server_name, "nginx/", 6) == 0) {
    if (version_len > strlen(MIN_VERSION_NGINX)) {
        if (version < MIN_VERSION_NGINX) {
            ndpi_set_risk(ndpi_struct, flow, NDPI_RISK_OBSOLETE_SERVER, "Nginx server version is obsolete");
        }
    }
}