const char *version_start = http_server_name + off;
      char version_str[10];
      float version_num;
      u_int i;

      // Extract version number
      for(i = 0; i < sizeof(version_str) - 1 && version_start[i] != ' ' && version_start[i] != '\0'; i++) {
        version_str[i] = version_start[i];
      }
      version_str[i] = '\0';

      // Convert version string to float
      version_num = strtof(version_str, NULL);

      // Define minimum versions
      float min_apache_version = 2.4;
      float min_nginx_version = 1.18;

      // Check if version is below minimum
      if((strncmp(http_server_name, "Apache/", 7) == 0 && version_num < min_apache_version) ||
         (strncmp(http_server_name, "nginx/", 6) == 0 && version_num < min_nginx_version)) {
        char risk_message[100];
        snprintf(risk_message, sizeof(risk_message), "Outdated %s version detected: %s", 
                 (strncmp(http_server_name, "Apache/", 7) == 0) ? "Apache" : "nginx", version_str);
        ndpi_set_risk(ndpi_struct, flow, NDPI_OUTDATED_SOFTWARE, risk_message);
      }