char version[16];
      u_int vlen = ndpi_min(server_len - off, sizeof(version) - 1);
      strncpy(version, (char *)&http_server_name[off], vlen);
      version[vlen] = '\0';

      u_int vnum = 0;
      for (u_int i = 0; i < strlen(version); ++i) {
        if (isdigit(version[i])) {
          vnum = vnum * 10 + (version[i] - '0');
        }
      }

      if (strncasecmp(http_server_name, "Apache/", off) == 0) {
        if (vnum < MIN_APACHE_VERSION) {
          char msg[128];
          snprintf(msg, sizeof(msg), "Outdated Apache server version: %s", version);
          ndpi_set_risk(ndpi_struct, flow, NDPI_OUTDATED_SERVER, msg);
        }
      } else if (strncasecmp(http_server_name, "nginx/", off) == 0) {
        if (vnum < MIN_NGINX_VERSION) {
          char msg[128];
          snprintf(msg, sizeof(msg), "Outdated Nginx server version: %s", version);
          ndpi_set_risk(ndpi_struct, flow, NDPI_OUTDATED_SERVER, msg);
        }
      }