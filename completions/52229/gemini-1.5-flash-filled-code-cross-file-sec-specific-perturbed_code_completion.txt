char version[16];
      int version_num = 0;
      if (strncasecmp(http_server_name, "Apache/", off) == 0) {
        strncpy(version, http_server_name + off, sizeof(version) - 1);
        version[strcspn(version, " \t\r\n")] = '\0';
        sscanf(version, "%d", &version_num);
        if (version_num < 2022) {
          char message[256];
          snprintf(message, sizeof(message), "Outdated Apache version detected: %s", version);
          ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OBSOLETE_SERVER, message);
        }
      } else if (strncasecmp(http_server_name, "nginx/", off) == 0) {
        strncpy(version, http_server_name + off, sizeof(version) - 1);
        version[strcspn(version, " \t\r\n")] = '\0';
        sscanf(version, "%d", &version_num);
        if (version_num < 1022) {
          char message[256];
          snprintf(message, sizeof(message), "Outdated nginx version detected: %s", version);
          ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OBSOLETE_SERVER, message);
        }
      }