char *version_start = (char *)http_server_name + off;
      char *version_end = strchr(version_start, ' ');
      if (version_end) {
        size_t version_len = version_end - version_start;
        char version_str[16];
        if (version_len < sizeof(version_str)) {
          strncpy(version_str, version_start, version_len);
          version_str[version_len] = '\0';

          unsigned int version_num = 0;
          unsigned int multiplier = 1000000;
          char *token = strtok(version_str, ".");
          while (token != NULL && multiplier > 1) {
            version_num += atoi(token) * multiplier;
            multiplier /= 1000;
            token = strtok(NULL, ".");
          }

          if (off == 7 && version_num < MIN_APACHE_VERSION) {
            ndpi_set_risk(ndpi_struct, flow, NDPI_OBSOLETE_SERVER, "Obsolete Apache server");
          } else if (off == 6 && version_num < MIN_NGINX_VERSION) {
            ndpi_set_risk(ndpi_struct, flow, NDPI_OBSOLETE_SERVER, "Obsolete nginx server");
          }
        }
      }