char version[16];
float version_num;
u_int8_t is_apache = (off == 7);

if (sscanf(http_server_name + off, "%15[0-9.]", version) == 1) {
  version_num = atof(version);
  
  if ((is_apache && version_num < 2.4) || (!is_apache && version_num < 1.18)) {
    char risk_str[128];
    snprintf(risk_str, sizeof(risk_str), "Obsolete %s web server v%s",
             is_apache ? "Apache" : "nginx", version);
    ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OBSOLETE_SERVER, risk_str);
  }
}