char version_str[16];
      float version = 0.0;

      // Extract version string
      if (server_len > off && server_len - off < sizeof(version_str)) {
        strncpy(version_str, http_server_name + off, server_len - off);
        version_str[server_len - off] = '\0';

        // Convert version string to float
        version = atof(version_str);

        // Check for outdated versions
        if ((strncasecmp(http_server_name, "Apache/", 7) == 0 && version < 2.4) ||
            (strncasecmp(http_server_name, "nginx/", 6) == 0 && version < 1.18)) {
          char risk_message[64];
          snprintf(risk_message, sizeof(risk_message), "Outdated server version: %s", version_str);
          ndpi_set_risk(ndpi_struct, flow, NDPI_OUTDATED_SERVER_VERSION, risk_message);
        }
      }