{
  const char *version_start = http_server_name + off;
  char version_buf[32];
  size_t version_len = server_len - off;
  if(version_len >= sizeof(version_buf))
    version_len = sizeof(version_buf) - 1;
  memcpy(version_buf, version_start, version_len);
  version_buf[version_len] = '\0';

  unsigned int major = 0, minor = 0;
  if(sscanf(version_buf, "%u.%u", &major, &minor) != 2) {
    /* If version format is unexpected, do not progress further */
    return;
  }

  unsigned int min_major = 0, min_minor = 0;
  if(strncasecmp(http_server_name, "Apache/", 7) == 0) {
    /* Set thresholds for Apache, e.g., version 2.4 */
    min_major = 2;
    min_minor = 4;
  }
  else if(strncasecmp(http_server_name, "nginx/", 6) == 0) {
    /* Set thresholds for nginx, e.g., version 1.10 */
    min_major = 1;
    min_minor = 10;
  }

  if(major < min_major || (major == min_major && minor < min_minor)) {
    char risk_msg[128];
    snprintf(risk_msg, sizeof(risk_msg), "Outdated HTTP server detected: %s", http_server_name);
    ndpi_set_risk(ndpi_struct, flow, NDPI_HTTP_OBSOLETE_SERVER, risk_msg);
  }
}