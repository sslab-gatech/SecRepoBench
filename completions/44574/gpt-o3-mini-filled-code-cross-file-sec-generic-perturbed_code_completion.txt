if (!strncmp("null", str_val, str_len)) {
    primitive_value = plist_new_null();
} else {
    char *num_str = (char *)malloc(str_len + 1);
    if (!num_str) {
        PLIST_JSON_ERR("%s: Out of memory\n", __func__);
        return NULL;
    }
    memcpy(num_str, str_val, str_len);
    num_str[str_len] = '\0';

    errno = 0;
    char *endptr = NULL;
    double d = strtod(num_str, &endptr);
    if (errno != 0 || endptr == num_str || *endptr != '\0') {
        PLIST_JSON_ERR("%s: Invalid numeric value: %s\n", __func__, num_str);
        free(num_str);
        return NULL;
    }
    if (strchr(num_str, '.') || strchr(num_str, 'e') || strchr(num_str, 'E')) {
        primitive_value = plist_new_real(d);
    } else {
        long l = strtol(num_str, NULL, 10);
        primitive_value = plist_new_integer(l);
    }
    free(num_str);
}