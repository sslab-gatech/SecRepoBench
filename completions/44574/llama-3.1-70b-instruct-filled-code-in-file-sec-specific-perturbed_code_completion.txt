if (!strncmp("null", str_val, str_len)) {
    primitive_value = plist_new_null();
} else {
    char* endp = NULL;
    double realval = 0.0;
    int64_t intval = 0;
    if (str_val[0] == '-') {
        if (str_len > 1 && str_val[1] == '0') {
            PLIST_JSON_ERR("%s: invalid number format '%.*s'\n", __func__, (int)str_len, str_val);
            return NULL;
        }
        if (str_len > 2 && str_val[1] == '-' && str_val[2] == '0') {
            PLIST_JSON_ERR("%s: invalid number format '%.*s'\n", __func__, (int)str_len, str_val);
            return NULL;
        }
    } else if (str_len > 1 && str_val[0] == '0') {
        PLIST_JSON_ERR("%s: invalid number format '%.*s'\n", __func__, (int)str_len, str_val);
        return NULL;
    }
    if (strchr(str_val, '.')!= NULL || strchr(str_val, 'e')!= NULL || strchr(str_val, 'E')!= NULL) {
        realval = strtod(str_val, &endp);
        if (endp == str_val) {
            PLIST_JSON_ERR("%s: invalid number format '%.*s'\n", __func__, (int)str_len, str_val);
            return NULL;
        }
        if (realval == HUGE_VAL || realval == -HUGE_VAL) {
            PLIST_JSON_ERR("%s: number out of range '%.*s'\n", __func__, (int)str_len, str_val);
            return NULL;
        }
        primitive_value = plist_new_real(realval);
    } else {
        intval = parse_decimal(str_val, str_val + str_len, &endp);
        if (endp == str_val) {
            PLIST_JSON_ERR("%s: invalid number format '%.*s'\n", __func__, (int)str_len, str_val);
            return NULL;
        }
        if (intval == INT64_MIN || intval == INT64_MAX) {
            PLIST_JSON_ERR("%s: number out of range '%.*s'\n", __func__, (int)str_len, str_val);
            return NULL;
        }
        primitive_value = plist_new_uint(intval);
    }
}