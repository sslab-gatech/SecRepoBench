((http_flow->detected_protocol_stack[1] == NDPI_PROTOCOL_UNKNOWN) && 
 (http_flow->guessed_host_protocol_id != NDPI_PROTOCOL_UNKNOWN)) {
  NDPI_LOG_DBG2(ndpi_struct, "found HTTP/%s\n", 
		ndpi_get_proto_name(ndpi_struct, http_flow->guessed_host_protocol_id));
  http_flow->detected_protocol_stack[1] = http_flow->guessed_protocol_id;
  http_flow->detected_protocol_stack[0] = http_flow->guessed_host_protocol_id;
} else {
  if(http_flow->detected_protocol_stack[1] != NDPI_PROTOCOL_UNKNOWN) {
    http_flow->guessed_host_protocol_id = http_flow->detected_protocol_stack[0];
    http_flow->guessed_protocol_id = http_flow->detected_protocol_stack[1];
  }
}