if(flow->detected_protocol_stack[1] == NDPI_PROTOCOL_UNKNOWN) {
      flow->detected_protocol_stack[0] = flow->guessed_host_protocol_id;
      flow->detected_protocol_stack[1] = flow->guessed_protocol_id;
    } else {
      if(flow->guessed_protocol_id != flow->detected_protocol_stack[1]) {
	NDPI_LOG_DBG(ndpi_struct, "guessed protocol %u != detected protocol %u\n",
		      flow->guessed_protocol_id, flow->detected_protocol_stack[1]);
      }
      if(flow->guessed_host_protocol_id != flow->detected_protocol_stack[0]) {
	NDPI_LOG_DBG(ndpi_struct, "guessed host protocol %u != detected host protocol %u\n",
		      flow->guessed_host_protocol_id, flow->detected_protocol_stack[0]);
      }
    }