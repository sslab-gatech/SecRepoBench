if(http_flow->detected_protocol_stack[1] == NDPI_PROTOCOL_UNKNOWN) {
    /* No subprotocol detected yet.
       Assume the host protocol is HTTP, and update the detection stack accordingly.
       Set the first (host) protocol to HTTP and the second to the current guessed protocol. */
    http_flow->detected_protocol_stack[0] = NDPI_PROTOCOL_HTTP;
    http_flow->detected_protocol_stack[1] = http_flow->guessed_protocol_id;
} else {
    /* A subprotocol was already detected; ensure consistency by aligning the guessed protocol
       with the already detected host protocol. */
    http_flow->guessed_protocol_id = http_flow->detected_protocol_stack[0];
}