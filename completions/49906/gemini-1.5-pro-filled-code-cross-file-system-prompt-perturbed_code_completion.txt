(http_flow->detected_protocol_stack[1] == NDPI_PROTOCOL_UNKNOWN) {
      if(http_flow->host_protocol_guess.id != NDPI_PROTOCOL_UNKNOWN &&
	 http_flow->host_protocol_guess.sub_id == NDPI_PROTOCOL_UNKNOWN) {
	http_flow->detected_protocol_stack[0] = http_flow->host_protocol_guess.id;
	http_flow->detected_protocol_stack[1] = http_flow->guessed_protocol_id;
      }
    } else {
      if(http_flow->detected_protocol_stack[0] != http_flow->host_protocol_guess.id ||
	 http_flow->detected_protocol_stack[1] != http_flow->guessed_protocol_id) {
	NDPI_LOG_DBG(ndpi_struct, "Host protocol mismatch. Expected %s/%s, got %s/%s\n",
		     ndpi_get_proto_name(ndpi_struct, http_flow->host_protocol_guess.id),
		     ndpi_get_proto_name(ndpi_struct, http_flow->guessed_protocol_id),
		     ndpi_get_proto_name(ndpi_struct, http_flow->detected_protocol_stack[0]),
		     ndpi_get_proto_name(ndpi_struct, http_flow->detected_protocol_stack[1]));
      }
    }