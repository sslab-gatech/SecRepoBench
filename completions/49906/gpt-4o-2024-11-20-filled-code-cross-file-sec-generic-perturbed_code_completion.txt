(http_flow->detected_protocol_stack[1] == NDPI_PROTOCOL_UNKNOWN) {
      if(http_flow->guessed_protocol_id != NDPI_PROTOCOL_UNKNOWN) {
        http_flow->detected_protocol_stack[1] = http_flow->guessed_protocol_id;
        http_flow->detected_protocol_stack[0] = http_flow->guessed_host_protocol_id;
      } else if(http_flow->guessed_host_protocol_id != NDPI_PROTOCOL_UNKNOWN) {
        http_flow->detected_protocol_stack[0] = http_flow->guessed_host_protocol_id;
      }
    } else {
      if(http_flow->guessed_protocol_id != NDPI_PROTOCOL_UNKNOWN &&
         http_flow->guessed_protocol_id != http_flow->detected_protocol_stack[1]) {
        NDPI_LOG_DBG2(ndpi_struct, "Guessed protocol %d does not match detected protocol %d\n",
                      http_flow->guessed_protocol_id, http_flow->detected_protocol_stack[1]);
      }
      if(http_flow->guessed_host_protocol_id != NDPI_PROTOCOL_UNKNOWN &&
         http_flow->guessed_host_protocol_id != http_flow->detected_protocol_stack[0]) {
        NDPI_LOG_DBG2(ndpi_struct, "Guessed host protocol %d does not match detected host protocol %d\n",
                      http_flow->guessed_host_protocol_id, http_flow->detected_protocol_stack[0]);
      }
    }