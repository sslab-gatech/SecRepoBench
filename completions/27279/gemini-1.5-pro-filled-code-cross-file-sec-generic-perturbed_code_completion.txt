flb_http_add_header(c, "Host", 4, host, strlen(host));

    if (body && body_len > 0) {
        char tmp[32];
        int len;

        len = snprintf(tmp, sizeof(tmp) - 1, "%lu", body_len);
        flb_http_add_header(c, "Content-Length", 14, tmp, len);
    }

    if (proxy_address) {
        if (flb_utils_proxy_parse(proxy_address, &c->proxy) != 0) {
            flb_free(buf);
            flb_free(c);
            return NULL;
        }
        flb_debug("[http_client] proxy host: %s port: %i",
                  c->proxy.host, c->proxy.port);
    }

    c->resp.data = flb_malloc(FLB_HTTP_DATA_SIZE_MAX);