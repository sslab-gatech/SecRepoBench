/* Add Host header */
    char host_header[256];
    int len = snprintf(host_header, sizeof(host_header), "%s:%d", host, port);
    if (len < 0 || len >= (int)sizeof(host_header)) {
        flb_error("[http_client] host header too long");
        flb_http_client_destroy(c);
        return NULL;
    }
    flb_http_add_header(c, "Host", 4, host_header, len);

    /* Add Content-Length header if body is present */
    if (body_len > 0) {
        char content_length[32];
        snprintf(content_length, sizeof(content_length), "%zu", body_len);
        flb_http_add_header(c, "Content-Length", 14, content_length, strlen(content_length));
    }

    /* Parse proxy address if specified */
    if (proxy_address) {
        char *colon = strrchr(proxy_address, ':');
        if (colon) {
            c->proxy.host = flb_strndup(proxy_address, colon - proxy_address);
            c->proxy.port = atoi(colon + 1);
            if (c->proxy.port <= 0) {
                flb_error("[http_client] invalid proxy port in address '%s'", proxy_address);
                flb_free((void *)c->proxy.host);
                flb_http_client_destroy(c);
                return NULL;
            }
        }
        else {
            flb_error("[http_client] invalid proxy address '%s'", proxy_address);
            flb_http_client_destroy(c);
            return NULL;
        }
    }

    /* Allocate response data buffer */
    c->resp.data = flb_calloc(1, FLB_HTTP_DATA_SIZE_MAX);