int ret;

    /* Add Host and Content-Length headers */
    if (add_host_and_content_length(c) < 0) {
        flb_http_client_destroy(c);
        return NULL;
    }

    /* If a proxy address is provided, parse and set up the proxy configuration */
    if (proxy_address) {
        ret = proxy_parse(proxy_address, c);
        if (ret < 0) {
            flb_http_client_destroy(c);
            return NULL;
        }
    }

    /* Allocate a buffer for the response data */
    c->resp.data = flb_calloc(1, FLB_HTTP_DATA_SIZE_MAX);