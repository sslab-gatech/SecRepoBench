if (host) {
        flb_http_add_header(c, "Host", 4, host, strlen(host));
    }

    if (body && body_len > 0) {
        flb_http_add_header(c, "Content-Length", 14,
                            flb_i64_to_text(body_len, buf), strlen(buf));
    }

    if (proxy_address) {
        ret = flb_http_proxy_parse(c, proxy_address);
        if (ret == -1) {
            flb_error("[http_client] invalid proxy URI");
            flb_http_client_destroy(c);
            return NULL;
        }
    }

    c->resp.data = flb_malloc(FLB_HTTP_DATA_SIZE_MAX);