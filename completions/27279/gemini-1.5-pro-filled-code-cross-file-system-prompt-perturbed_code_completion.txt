flb_http_add_header(c, "Host", 4, host, strlen(host));

    if (body && body_len > 0) {
        char tmp[32];
        int len;

        len = snprintf(tmp, sizeof(tmp) - 1, "%lu", body_len);
        flb_http_add_header(c, "Content-Length", 14, tmp, len);
    }

    if (proxy_address) {
        if (flb_utils_proxy_parse(proxy_address, &c->proxy) != 0) {
            flb_error("[http_client] could not parse proxy address: %s",
                      proxy_address);
            flb_http_client_destroy(c);
            return NULL;
        }
    }

    c->resp.data = flb_malloc(FLB_HTTP_DATA_SIZE_MAX);