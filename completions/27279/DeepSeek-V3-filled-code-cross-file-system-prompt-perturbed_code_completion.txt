if (host) {
        flb_http_add_header(c, "Host", 4, host, strlen(host));
    }

    if (body && body_len > 0) {
        flb_http_set_content_length(c, body_len);
    }

    if (proxy_address) {
        c->proxy.host = flb_strdup(proxy_address);
        if (!c->proxy.host) {
            flb_errno();
            flb_http_client_destroy(c);
            return NULL;
        }
    }

    c->resp.data = flb_calloc(1, FLB_HTTP_DATA_SIZE_MAX);