/* Add host header */
flb_http_add_header(c, "Host", 4, host, strlen(host));

/* Add Content-Length header */
if (body && body_len > 0) {
    char tmp[32];
    snprintf(tmp, sizeof(tmp) - 1, "%zu", body_len);
    flb_http_add_header(c, "Content-Length", 14, tmp, strlen(tmp));
}

/* Check proxy data if a proxy was specified */
if (proxy_address) {
    ret = proxy_parse(proxy_address, c);
    if (ret != 0) {
        flb_error("[http_client] could not parse proxy: %s", proxy_address);
        flb_http_client_destroy(c);
        return NULL;
    }
}

/* Allocate space for the response */
c->resp.data = flb_calloc(1, FLB_HTTP_DATA_SIZE_MAX);