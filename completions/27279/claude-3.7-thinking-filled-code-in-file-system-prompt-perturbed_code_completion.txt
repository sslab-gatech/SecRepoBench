/* Add Host and Content-Length headers */
ret = add_host_and_content_length(c);
if (ret != 0) {
    flb_errno();
    flb_http_client_destroy(c);
    return NULL;
}

/* Check proxy data if any */
if (proxy_address) {
    ret = proxy_parse(proxy_address, c);
    if (ret != 0) {
        flb_errno();
        flb_http_client_destroy(c);
        return NULL;
    }
}

/* Allocate space for the response */
c->resp.data = flb_calloc(1, FLB_HTTP_DATA_SIZE_MAX);