/* Add the Host header */
    if (proxy_address) {
        ret = flb_http_add_header(c, "Host", 4, proxy_address, strlen(proxy_address));
    }
    else {
        ret = flb_http_add_header(c, "Host", 4, host, strlen(host));
    }

    if (ret != 0) {
        flb_errno();
        flb_http_client_destroy(c);
        return NULL;
    }

    /* Add the Content-Length header if a body is present */
    if (body && body_len > 0) {
        char content_length[32];
        int len = snprintf(content_length, sizeof(content_length), "%zu", body_len);
        if (len < 0 || len >= sizeof(content_length)) {
            flb_errno();
            flb_http_client_destroy(c);
            return NULL;
        }

        ret = flb_http_add_header(c, "Content-Length", 14, content_length, len);
        if (ret != 0) {
            flb_errno();
            flb_http_client_destroy(c);
            return NULL;
        }
    }

    /* Allocate memory for the response data buffer */
    c->resp.data = flb_calloc(1, FLB_HTTP_DATA_SIZE_MAX);