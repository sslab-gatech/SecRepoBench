if (host) {
        flb_http_add_header(c, "Host", 4, host, strlen(host));
    }

    if (body && body_len > 0) {
        char cl[32];

        snprintf(cl, sizeof(cl) - 1, "%lu", (unsigned long) body_len);
        flb_http_add_header(c, "Content-Length", 14, cl, strlen(cl));
    }

    if (proxy_address) {
        /* Parse proxy address */
#ifdef FLB_HAVE_REGEX
        ret = flb_http_proxy_parse(c, proxy_address);
        if (ret == -1) {
            flb_error("[http_client] invalid proxy address: %s", proxy_address);
            flb_http_client_destroy(c);
            return NULL;
        }
#else
        flb_warn("[http_client] proxy address specified but regex support is disabled");
#endif
    }

    c->resp.data = flb_malloc(FLB_HTTP_DATA_SIZE_MAX);