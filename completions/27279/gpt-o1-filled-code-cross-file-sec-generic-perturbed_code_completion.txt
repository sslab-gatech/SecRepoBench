/* Add the host and content length to the HTTP client structure */
    if (body && body_len > 0) {
        c->resp.content_length = (long) body_len;
    }
    else {
        c->resp.content_length = 0;
    }

    /* Check if a proxy is specified and parse its data */
    if (proxy_address) {
        char *tmp = flb_strdup(proxy_address);
        char *colon;

        if (!tmp) {
            flb_errno();
            flb_http_client_destroy(c);
            return NULL;
        }

        colon = strrchr(tmp, ':');
        if (!colon) {
            flb_error("[http_client] invalid proxy address '%s'", proxy_address);
            flb_free(tmp);
            flb_http_client_destroy(c);
            return NULL;
        }

        *colon = '\0';
        c->proxy.port = atoi(colon + 1);
        if (c->proxy.port <= 0) {
            flb_error("[http_client] invalid proxy port in '%s'", proxy_address);
            flb_free(tmp);
            flb_http_client_destroy(c);
            return NULL;
        }

        c->proxy.host = flb_strdup(tmp);
        flb_free(tmp);
        if (!c->proxy.host) {
            flb_errno();
            flb_http_client_destroy(c);
            return NULL;
        }
    }

    /* Allocate memory for the response data buffer */
    c->resp.data = flb_calloc(1, FLB_HTTP_DATA_SIZE_MAX);