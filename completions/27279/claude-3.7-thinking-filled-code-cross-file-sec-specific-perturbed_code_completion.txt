/* Add Host header */
if (host) {
    flb_http_add_header(c, "Host", 4, host, strlen(host));
}

/* Add Content-Length header if body exists */
if (body_len > 0) {
    char tmp[32];
    int len = snprintf(tmp, sizeof(tmp) - 1, "%zu", body_len);
    if (len >= 0) {
        tmp[len] = '\0';
        flb_http_add_header(c, "Content-Length", 14, tmp, len);
    }
}

/* Parse proxy data if specified */
c->proxy.host = NULL;
if (proxy_address) {
    /* Parse and set proxy host/port */
    c->proxy.host = flb_strdup(proxy_address);
    if (!c->proxy.host) {
        flb_errno();
        flb_http_client_destroy(c);
        return NULL;
    }
}

/* Allocate response data buffer */
c->resp.data = flb_calloc(1, FLB_HTTP_DATA_SIZE_MAX);