if (proxy_address) {
        ret = proxy_parse(proxy_address, c);
        if (ret != 0) {
            flb_error("[http_client] error parsing proxy address '%s'",
                      proxy_address);
            flb_free(buf);
            flb_free(c);
            return NULL;
        }
    }

    ret = add_host_and_content_length(c);
    if (ret != 0) {
        flb_http_client_destroy(c);
        return NULL;
    }

    c->resp.data = flb_malloc(c->resp.data_size);