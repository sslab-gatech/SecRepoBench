case VALUE_DATA:
case VALUE_STR:
case VALUE_UNISTR:
  if(payload_len < 4)
    return 0;

  v->value.value_size = ntohl(get_u_int32_t(databuffer, 0));
  
  if(v->value.value_size == 0 || v->value.value_size > payload_len - 4)
    return 0;
  
  v->value.ptr.value_str = (char *)&databuffer[4];
  v->value_size = v->value.value_size;
  
  ret = v->value_size + 4; // 4 bytes for size indicator
  break;