case VALUE_DATA:
    case VALUE_STR:
    case VALUE_UNISTR:
      {
        uint32_t size;

        if(payload_len < 4)
          return 0;

        size = ntohl(get_u_int32_t(databuffer, 0));
        if(size == 0 || size > payload_len - 4)
          return 0;

        v->value.ptr.value_str = (char *)(databuffer + 4);

        /* Adjust size if necessary for DATA type. (No adjustment shown here.) */

        v->value_size = size;
        ret = 4 + size;
      }
      break;