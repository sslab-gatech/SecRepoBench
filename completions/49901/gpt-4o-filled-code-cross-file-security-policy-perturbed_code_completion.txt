case VALUE_UNISTR:
      if(payload_len < 4)
        return 0;

      // Read the size of the UNISTR
      v->value_size = ntohl(get_u_int32_t(databuffer, 0));

      // Check if the size is valid and does not exceed the payload length
      if(v->value_size == 0 || (uint64_t)v->value_size + 4 > (uint64_t)payload_len)
        return 0;

      // Set the pointer to the raw data starting after the size indicator
      v->value.ptr.value_str = (char *)(databuffer + 4);

      // Adjust the size if handling VALUE_DATA type
      if (t == VALUE_DATA) {
        v->value_size = ndpi_min(v->value_size, payload_len - 4);
      }

      ret = v->value_size + 4;
      break;