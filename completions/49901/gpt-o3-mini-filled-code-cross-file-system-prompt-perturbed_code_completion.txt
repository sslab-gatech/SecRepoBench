if (payload_len < 2)
  return 0;

{
  uint16_t size_field = ntohs(*(uint16_t const *)databuffer);

  if (size_field == 0 || size_field > payload_len - 2)
    return 0;

  v->value.ptr.value_str = (char *)(databuffer + 2);
  v->value_size = size_field;
  ret = size_field + 2;
}
break;