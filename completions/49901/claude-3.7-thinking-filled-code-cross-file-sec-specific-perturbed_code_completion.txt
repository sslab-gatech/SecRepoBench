case VALUE_UNISTR:
  if(payload_len < 4)
    return 0;
    
  v->value.ptr.size = ntohl(get_u_int32_t(databuffer, 0));
  
  if(v->value.ptr.size == 0 || v->value.ptr.size > payload_len - 4)
    return 0;
    
  v->value.ptr.value_str = (char *)(databuffer + 4);
  
  v->value_size = v->value.ptr.size;
  
  if(t == VALUE_DATA)
    v->value_size++;
    
  ret = 4 + v->value.ptr.size;
  break;