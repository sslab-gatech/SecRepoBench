case VALUE_UNISTR:
      if(payload_len < 2)
        return 0;

      // Read the length of the unicode string
      u_int16_t str_len = ntohs(get_u_int16_t(databuffer, 0));
      if(str_len == 0 || str_len * 2 + 2 > payload_len)
        return 0;

      v->value.ptr.value_unistr = (char const *)(databuffer + 2);
      v->value_size = str_len * 2 + 2; // Include the length prefix
      ret = v->value_size;
      break;