case VALUE_UNISTR:
      if (payload_len < 4)
        return 0;

      v->value_size = ntohl(get_u_int32_t(databuffer, 0));
      if (v->value_size == 0 || v->value_size + 4 > payload_len)
        return 0;

      v->value.ptr.value_str = (char *)databuffer + 4; // Pointer to the data after the size
      ret = v->value_size + 4; // Total size processed including size indicator
      break;