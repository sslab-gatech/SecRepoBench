VALUE_UNISTR:
      if(payload_len < 4)
        return 0;

      v->value.ptr.len = ntohl(get_u_int32_t(databuffer, 0));
      v->value.ptr.value_str = (char *)databuffer + 4;

      if(v->value.ptr.len == 0 || v->value.ptr.len > payload_len - 4)
        return 0;

      v->value_size = v->value.ptr.len;
      ret = v->value_size + 4;
      break;

    case VALUE_DATA:
    case VALUE_STR:
      if(payload_len < 4)
        return 0;

      v->value.ptr.len = ntohl(get_u_int32_t(databuffer, 0));
      v->value.ptr.value_str = (char *)databuffer + 4;

      if(v->value.ptr.len == 0 || v->value.ptr.len > payload_len - 4)
        return 0;

      v->value_size = v->value.ptr.len;
      if(t == VALUE_DATA)
	; /* nothing to do */
      ret = v->value_size + 4;
      break;