case VALUE_DATA:
    case VALUE_STR:
    case VALUE_UNISTR:
    {
      if(payload_len < 4)
        return 0;

      uint32_t size = ntohl(get_u_int32_t(databuffer, 0));
      if(size == 0 || size > (payload_len - 4))
        return 0;

      v->value.ptr.value_str = (char *)(databuffer + 4);
      v->value_size = size;

      ret = size + 4; /* include the size indicator */
      break;
    }