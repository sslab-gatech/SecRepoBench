case VALUE_UNISTR:
case VALUE_STR:
  {
    u_int32_t value_size = ntohl(get_u_int32_t(databuffer, 0));
    if (payload_len < 4 + value_size)
      return 0;

    if (value_size == 0)
      return 0;

    if (t == VALUE_DATA)
      value_size = ndpi_min(value_size, sizeof(v->value.ptr.value_data) - 1);

    v->value.ptr.value_str = (char const *)databuffer + 4;
    v->value_size = value_size;
    ret = 4 + value_size;
  }
  break;