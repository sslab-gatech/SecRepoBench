case VALUE_UNISTR:
      if (payload_len < 2)
        return 0;

      // Read the size of the UNISTR
      v->value_size = ntohs(get_u_int16_t(databuffer, 0));
      if (v->value_size == 0 || v->value_size > payload_len - 2)
        return 0;

      // Set the pointer to the raw data starting after the size indicator
      v->value.ptr.value_unistr = (u_int8_t *)(databuffer + 2);
      ret = v->value_size + 2;
      break;

    case VALUE_DATA:
      if (payload_len < 2)
        return 0;

      // Read the size of the DATA
      v->value_size = ntohs(get_u_int16_t(databuffer, 0));
      if (v->value_size == 0 || v->value_size > payload_len - 2)
        return 0;

      // Set the pointer to the raw data starting after the size indicator
      v->value.ptr.value_data = (u_int8_t *)(databuffer + 2);
      ret = v->value_size + 2;
      break;

    case VALUE_STR:
      if (payload_len < 2)
        return 0;

      // Read the size of the STR
      v->value_size = ntohs(get_u_int16_t(databuffer, 0));
      if (v->value_size == 0 || v->value_size > payload_len - 2)
        return 0;

      // Set the pointer to the raw data starting after the size indicator
      v->value.ptr.value_str = (char *)(databuffer + 2);
      ret = v->value_size + 2;
      break;