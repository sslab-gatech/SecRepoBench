case VALUE_UNISTR:
  // Check if the payload length is sufficient for the expected data size.
  if(payload_len < 2)
    return 0;

  // Set the pointer to the raw data starting after the size indicator.
  v->value.value_int = get_u_int16_t(databuffer, 0);
  v->value_size = sizeof(v->value.value_int);

  // Verify that the buffer value size is non-zero and does not exceed the payload length.
  if(v->value.value_int == 0 || v->value.value_int * 2 > payload_len)
    return 0;

  // Adjust the size if handling VALUE_DATA type.
  v->value_size = v->value.value_int * 2;

  // Update the value size and return the total size processed, including size indicator.
  ret = v->value_size;
  break;