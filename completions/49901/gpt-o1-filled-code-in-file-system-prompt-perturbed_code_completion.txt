case VALUE_DATA:
case VALUE_STR:
case VALUE_UNISTR:
{
  if(payload_len < 4)
    return 0;

  u_int32_t size = ntohl(get_u_int32_t(databuffer, 0));
  if(size == 0 || size > payload_len - 4)
    return 0;

  v->value.ptr.raw = databuffer + 4;

  /* Adjust size if handling VALUE_DATA type (no special adjustment here) */

  v->value_size = size;
  ret = 4 + size;
  break;
}