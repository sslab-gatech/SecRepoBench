case VALUE_UNISTR:
      if(payload_len < 4)
        return 0;

      // Ensure the buffer has enough data for the size indicator and the string
      if (payload_len < 4 + get_u_int32_t(payload, 0))
        return 0;

      // Set the pointer to the raw data starting after the size indicator
      v->value.ptr.value_unistr = (char const *)(payload + 4);

      // Verify that the buffer value size is non-zero and does not exceed the payload length
      if (get_u_int32_t(payload, 0) == 0 || get_u_int32_t(payload, 0) > payload_len - 4)
        return 0;

      // Update the value size and return the total size processed, including size indicator
      v->value_size = get_u_int32_t(payload, 0);
      ret = v->value_size + 4;
      break;