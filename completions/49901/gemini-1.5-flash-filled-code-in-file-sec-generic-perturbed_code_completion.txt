VALUE_UNISTR:
      {
        u_int32_t size;
        if(payload_len < 4)
          return 0;

        size = ntohl(get_u_int32_t(databuffer, 0));
        if(payload_len < 4 + size)
          return 0;

        v->value.ptr.value_unistr = (char const *)databuffer + 4;
        v->value_size = size;
        ret = v->value_size + 4;
      }
      break;
    case VALUE_DATA:
      {
        u_int32_t size;
        if(payload_len < 4)
          return 0;

        size = ntohl(get_u_int32_t(databuffer, 0));
        if(payload_len < 4 + size)
          return 0;

        v->value.ptr.value_data = databuffer + 4;
        v->value_size = size;
        ret = v->value_size + 4;
      }
      break;
    case VALUE_STR:
      {
        u_int32_t size;
        if(payload_len < 4)
          return 0;

        size = ntohl(get_u_int32_t(databuffer, 0));
        if(payload_len < 4 + size)
          return 0;

        v->value.ptr.value_str = (char const *)databuffer + 4;
        v->value_size = size;
        ret = v->value_size + 4;
      }
      break;