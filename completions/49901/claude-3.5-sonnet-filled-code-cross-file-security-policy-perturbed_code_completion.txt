case VALUE_UNISTR:
  if (payload_len < 4)
    return 0;

  v->value_size = ntohl(get_u_int32_t(databuffer, 0));
  if (v->value_size == 0 || v->value_size > (uint64_t)payload_len - 4)
    return 0;

  v->value.ptr.value_str = (char *)&databuffer[4];
  ret = v->value_size + 4;

  if (t == VALUE_DATA)
    v->value_size *= 2;

  break;