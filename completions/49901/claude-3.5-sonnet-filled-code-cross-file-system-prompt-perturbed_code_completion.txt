VALUE_UNISTR:
      if (payload_len < 4)
        return 0;

      u_int32_t buffer_value_size = ntohl(get_u_int32_t(databuffer, 0));
      v->value.ptr.value_str = (char *)&databuffer[4];

      if (buffer_value_size == 0 || buffer_value_size > payload_len - 4)
        return 0;

      if (t == VALUE_DATA)
        v->value_size = buffer_value_size;
      else
        v->value_size = buffer_value_size * 2;

      ret = v->value_size + 4;
      break;