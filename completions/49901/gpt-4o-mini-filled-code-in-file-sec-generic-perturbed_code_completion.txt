case VALUE_UNISTR:
      if (payload_len < 4)
        return 0;

      // Extract the size of the unicode string
      u_int32_t size = ntohl(get_u_int32_t(databuffer, 0));
      if (size == 0 || size > payload_len - 4)
        return 0;

      // Set the pointer to the unicode string data
      v->value.ptr.value_unistr = (char const *)(databuffer + 4);
      v->value_size = size;
      ret = v->value_size + 4; // Include the size indicator in the total size
      break;