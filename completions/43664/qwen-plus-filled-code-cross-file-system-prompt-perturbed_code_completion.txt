else if(extension_id == 43 /* supported versions */) {
  u_int16_t s_offset = offset+extension_offset;
  u_int16_t tot_versions_len = ntohs(*((u_int16_t*)&packet->payload[s_offset]));
  char supported_versions_str[256];
  u_int8_t supported_versions_str_len = 0, j;

#ifdef DEBUG_TLS
  printf("Client TLS [SUPPORTED_VERSIONS: block_len=%u/len=%u]\n", extension_len, tot_versions_len);
#endif
  s_offset += 2;
  tot_versions_len += s_offset;

  while(s_offset < tot_versions_len && s_offset < total_len) {
    u_int16_t version = ntohs(*((u_int16_t*)&packet->payload[s_offset]));

    if((s_offset + 2) <= tot_versions_len &&
       (s_offset + 2) <= total_len) {
#ifdef DEBUG_TLS
      printf("Client TLS [Supported Version: 0x%04X]\n", version);
#endif

      if(((uint32_t)supported_versions_str_len+5+1) < (sizeof(supported_versions_str)-1)) { // Considering "XXXX," length
        if(supported_versions_str_len > 0) {
          supported_versions_str[supported_versions_str_len] = ',';
          supported_versions_str_len++;
        }

        sprintf(&supported_versions_str[supported_versions_str_len], "%04X", version);
        supported_versions_str_len += 4; // Length of "XXXX"
      } else
        break;
    } else
      break;

    s_offset += 2;
  }

  supported_versions_str[supported_versions_str_len] = '\0';

#ifdef DEBUG_TLS
  printf("Client TLS [SUPPORTED_VERSIONS: %s][len: %u]\n", supported_versions_str, supported_versions_str_len);
#endif

  snprintf(ja3.client.supported_versions, sizeof(ja3.client.supported_versions), "%s", supported_versions_str);

} else if(extension_id == 51 /* encrypted server name */) {
  // Handle Encrypted SNI extension
  u_int16_t sni_list_length = ntohs(*((u_int16_t*)&packet->payload[offset+extension_offset]));

  if(packet->payload_packet_len >= offset + extension_offset + sni_list_length) {
    flow->protos.tls_quic.encrypted_sni.esni = ndpi_strdup("esni_present");
  }

} else if(extension_id == 57 /* QUIC transport parameters */) {
  // Handle QUIC transport parameters
  if(flow->protos.tls_quic.quic_transport_params == NULL) {
    flow->protos.tls_quic.quic_transport_params = ndpi_malloc(extension_len + 1);

    if(flow->protos.tls_quic.quic_transport_params != NULL) {
      memcpy(flow->protos.tls_quic.quic_transport_params, &packet->payload[offset+extension_offset], extension_len);
      flow->protos.tls_quic.quic_transport_params[extension_len] = '\0';

      /* Further processing of QUIC parameters can be done here */
    }
  }
}