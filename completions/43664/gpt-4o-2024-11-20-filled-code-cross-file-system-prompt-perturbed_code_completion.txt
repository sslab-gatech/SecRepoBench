if (extension_id == 43 /* supported versions */) {
	        u_int16_t s_offset = offset + extension_offset;
	        u_int16_t supported_versions_len = ntohs(*((u_int16_t*)&packet->payload[s_offset]));
	        s_offset += 2;

#ifdef DEBUG_TLS
	        printf("Client TLS [Supported Versions: len=%u]\n", supported_versions_len);
#endif

	        if ((s_offset + supported_versions_len) <= total_len) {
	          for (i = 0; i < supported_versions_len && s_offset + i < total_len; i += 2) {
	            u_int16_t version = ntohs(*((u_int16_t*)&packet->payload[s_offset + i]));

#ifdef DEBUG_TLS
	            printf("Client TLS [Supported Version: 0x%04X]\n", version);
#endif

	            if (i == 0) {
	              snprintf(ja3.client.supported_versions, sizeof(ja3.client.supported_versions), "%u", version);
	            } else {
	              snprintf(&ja3.client.supported_versions[strlen(ja3.client.supported_versions)],
	                       sizeof(ja3.client.supported_versions) - strlen(ja3.client.supported_versions),
	                       "-%u", version);
	            }
	          }
	        } else {
	          invalid_ja3 = 1;
#ifdef DEBUG_TLS
	          printf("Client TLS Invalid supported versions length %u vs %u\n", (s_offset + supported_versions_len), total_len);
#endif
	        }
	      } else if (extension_id == 65445 /* encrypted server name */) {
	        u_int16_t s_offset = offset + extension_offset;
	        u_int16_t esni_len = ntohs(*((u_int16_t*)&packet->payload[s_offset]));
	        s_offset += 2;

#ifdef DEBUG_TLS
	        printf("Client TLS [Encrypted SNI: len=%u]\n", esni_len);
#endif

	        if ((s_offset + esni_len) <= total_len) {
	          flow->protos.tls_quic.encrypted_sni.esni = ndpi_malloc(esni_len + 1);
	          if (flow->protos.tls_quic.encrypted_sni.esni != NULL) {
	            memcpy(flow->protos.tls_quic.encrypted_sni.esni, &packet->payload[s_offset], esni_len);
	            flow->protos.tls_quic.encrypted_sni.esni[esni_len] = '\0';
	          }
	        } else {
	          invalid_ja3 = 1;
#ifdef DEBUG_TLS
	          printf("Client TLS Invalid encrypted SNI length %u vs %u\n", (s_offset + esni_len), total_len);
#endif
	        }
	      } else if (extension_id == 57 /* QUIC transport parameters */) {
	        u_int16_t s_offset = offset + extension_offset;
	        u_int16_t quic_params_len = ntohs(*((u_int16_t*)&packet->payload[s_offset]));
	        s_offset += 2;

#ifdef DEBUG_TLS
	        printf("Client TLS [QUIC Transport Parameters: len=%u]\n", quic_params_len);
#endif

	        if ((s_offset + quic_params_len) <= total_len) {
	          processQUICTransportParameters(ndpi_struct, flow, &packet->payload[s_offset], quic_params_len);
	        } else {
	          invalid_ja3 = 1;
#ifdef DEBUG_TLS
	          printf("Client TLS Invalid QUIC transport parameters length %u vs %u\n", (s_offset + quic_params_len), total_len);
#endif
	        }
	      }