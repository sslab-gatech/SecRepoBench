if(extension_id == 43 /* supported_versions */) {
		  u_int16_t s_offset = offset+extension_offset;
		  u_int16_t tot_supported_versions_len = packet->payload[s_offset];

#ifdef DEBUG_TLS
		  printf("Client TLS [supported_versions: block_len=%u/len=%u]\n", extension_len, tot_supported_versions_len);
#endif

		  if(tot_supported_versions_len + 1 == extension_len) {
		    s_offset++;

		    for(i=0; i<tot_supported_versions_len && s_offset + i + 1 < total_len; i+=2) {
		      u_int16_t supported_version = ntohs(*((u_int16_t*)&packet->payload[s_offset+i]));
		      int rc;

#ifdef DEBUG_TLS
		      printf("Client TLS [supported_version: %u/0x%04X]\n", supported_version, supported_version);
#endif

		      rc = snprintf(&ja3.client.supported_versions[i*2], sizeof(ja3.client.supported_versions)-i*2, "%02X", packet->payload[s_offset+i]);
		      if(rc < 0) break;

		      if(supported_version < flow->protos.tls_quic.ssl_version)
			flow->protos.tls_quic.ssl_version = supported_version;
		    }

		    ja3.client.supported_versions[i*2] = '\0';
		  }
		} else if(extension_id == 50 /* encrypted_server_name indication */) {
		  flow->protos.tls_quic.encrypted_sni.esni = 1;
		  flow->protos.tls_quic.encrypted_sni.client_hello_key_share_len = extension_len;
		  memcpy(flow->protos.tls_quic.encrypted_sni.client_hello_key_share,
			 &packet->payload[offset+extension_offset], extension_len);
		} else if(extension_id == 35 /* QUIC transport parameters */) {
		  u_int16_t s_offset = offset+extension_offset;
		  u_int16_t tot_quic_transport_parameters_len = extension_len;

#ifdef DEBUG_TLS
		  printf("Client TLS [QUIC transport parameters: block_len=%u/len=%u]\n", extension_len, tot_quic_transport_parameters_len);
#endif

		  if(tot_quic_transport_parameters_len > 0) {
		    u_int16_t user_agent_id = 0x0017;
		    u_int16_t user_agent_id_len = 0;
		    u_int16_t user_agent_len = 0;
		    u_int16_t user_agent_offset = 0;

		    while(s_offset < total_len && user_agent_offset < tot_quic_transport_parameters_len) {
		      user_agent_id = ntohs(*((u_int16_t*)&packet->payload[s_offset]));
		      user_agent_id_len = ntohs(*((u_int16_t*)&packet->payload[s_offset+2]));

		      if(user_agent_id == 0x0017) {
			user_agent_len = user_agent_id_len;
			user_agent_offset = s_offset + 4;
			break;
		      }

		      s_offset += 4 + user_agent_id_len;
		    }

		    if(user_agent_len > 0 && user_agent_offset + user_agent_len <= total_len) {
		      char user_agent[256];

		      snprintf(user_agent, sizeof(user_agent), "%.*s", user_agent_len, (char*)&packet->payload[user_agent_offset]);

#ifdef DEBUG_TLS
		      printf("Client TLS [QUIC transport parameters: user_agent=%s]\n", user_agent);
#endif

		      if(flow->protos.tls_quic.user_agent == NULL)
			flow->protos.tls_quic.user_agent = ndpi_strdup(user_agent);
		    }
		  }
		}