if(extension_id == 43 /* supported_versions */) {
  u_int16_t s_offset = offset+extension_offset + 1;
  u_int16_t tot_version_len = packet->payload[s_offset];
  char supported_versions[64] = {0};
  u_int8_t version_str_len = 0;

  s_offset++;

  while(s_offset < tot_version_len + offset+extension_offset + 2 && s_offset + 1 < total_len) {
    u_int16_t version = ntohs(*((u_int16_t*)&packet->payload[s_offset]));
    int rc = snprintf(&supported_versions[version_str_len], sizeof(supported_versions)-version_str_len, 
                      "%s%x", (version_str_len > 0) ? "-" : "", version);
    if(rc > 0) version_str_len += rc;
    s_offset += 2;
  }

  snprintf(ja3.client.supported_versions, sizeof(ja3.client.supported_versions), "%s", supported_versions);

} else if(extension_id == 65486 /* encrypted_server_name */) {
  if(extension_len >= 2) {
    u_int16_t esni_len = ntohs(*((u_int16_t*)&packet->payload[offset+extension_offset]));
    if(esni_len > 0 && esni_len <= extension_len - 2) {
      flow->protos.tls_quic.encrypted_sni.esni = ndpi_malloc(esni_len);
      if(flow->protos.tls_quic.encrypted_sni.esni) {
        memcpy(flow->protos.tls_quic.encrypted_sni.esni, &packet->payload[offset+extension_offset+2], esni_len);
        flow->protos.tls_quic.encrypted_sni.esni_len = esni_len;
      }
    }
  }
} else if(extension_id == 0x39 /* QUIC transport parameters */) {
  u_int16_t s_offset = offset+extension_offset;
  u_int16_t tp_len = ntohs(*((u_int16_t*)&packet->payload[s_offset]));
  
  s_offset += 2;
  if(s_offset + tp_len <= total_len) {
    ndpi_parse_quic_transport_params(ndpi_struct, flow, &packet->payload[s_offset], tp_len);
  }
}