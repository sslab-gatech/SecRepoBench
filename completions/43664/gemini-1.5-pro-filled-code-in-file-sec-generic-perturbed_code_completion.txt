if(extension_id == 43 /* supported_versions */) {
          u_int16_t s_offset = offset + extension_offset;
          u_int16_t supported_versions_len = packet->payload[s_offset];

          if(s_offset + 1 + supported_versions_len <= total_len) {
            s_offset++;

            for (i = 0; i < supported_versions_len; i += 2) {
              u_int16_t tls_version = ntohs(*((u_int16_t*)&packet->payload[s_offset + i]));
              int rc = snprintf(&ja3.client.supported_versions[i*2], sizeof(ja3.client.supported_versions) - i*2, "%02X", tls_version);
              if(rc < 0) break;
            }
          }
#ifdef DEBUG_TLS
          printf("Client TLS [supported_versions: %s]\n", ja3.client.supported_versions);
#endif
        } else if (extension_id == 45 /* encrypted_server_name */) {
          flow->protos.tls_quic.encrypted_sni.esni = 1;
#ifdef DEBUG_ENCRYPTED_SNI
          printf("Client TLS [encrypted_sni]\n");
#endif
        } else if(extension_id == 65445 /* QUIC transport parameters */ &&
                  offset + extension_offset + 4 < total_len) {
          u_int16_t s_offset = offset + extension_offset + 4;
          u_int16_t quic_tp_len = ntohs(*((u_int16_t*)&packet->payload[offset + extension_offset + 2]));

          if(s_offset + quic_tp_len <= total_len) {
            while(s_offset < total_len && s_offset < quic_tp_len) {
              u_int8_t quic_tp_id = packet->payload[s_offset];
              u_int64_t quic_tp_value_len;
              u_int8_t bytes_still_required;

              s_offset++;

              if(quic_len(&packet->payload[s_offset], &quic_tp_value_len) == 0) {
                bytes_still_required = quic_len_buffer_still_required((uint8_t)quic_tp_value_len);

                if(s_offset + bytes_still_required <= total_len) {
                  s_offset += bytes_still_required;

                  if(quic_tp_id == 0 /* UA */) {
                    http_process_user_agent(ndpi_struct, flow, &packet->payload[s_offset], (u_int16_t)quic_tp_value_len);
                  }

                  s_offset += (u_int16_t)quic_tp_value_len;
                } else
                  break;
              } else
                break;
            }
          }
        } else