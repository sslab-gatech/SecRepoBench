else if(extension_id == 43 /* supported versions */) {
  u_int16_t s_offset = offset + extension_offset;
  u_int16_t tot_versions_len = ntohs(*((u_int16_t*)&packet->payload[s_offset]));
  s_offset += 2;

  if((s_offset + tot_versions_len) <= total_len) {
    for(i=0; i<tot_versions_len && (s_offset + i + 1) < total_len; i += 2) {
      u_int16_t version = ntohs(*((u_int16_t*)&packet->payload[s_offset + i]));

#ifdef DEBUG_TLS
      printf("Client TLS [Supported Version: %u/0x%04X]\n", version, version);
#endif

      if(ja3.client.num_tls_extension < MAX_NUM_JA3) {
        ja3.client.tls_extension[ja3.client.num_tls_extension++] = version;
      } else {
        invalid_ja3 = 1;
#ifdef DEBUG_TLS
        printf("Client TLS Invalid num extensions %u\n", ja3.client.num_tls_extension);
#endif
      }
    }
  } else {
    invalid_ja3 = 1;
#ifdef DEBUG_TLS
    printf("Client TLS Invalid len %u vs %u\n", (s_offset + tot_versions_len), total_len);
#endif
  }
} else if(extension_id == 51 /* encrypted server name */) {
  // Handle the encrypted SNI details
  u_int16_t esni_len = ntohs(*((u_int16_t*)&packet->payload[offset + extension_offset]));
  flow->protos.tls_quic.encrypted_sni.esni = ndpi_malloc(esni_len);

  if(flow->protos.tls_quic.encrypted_sni.esni != NULL) {
    memcpy(flow->protos.tls_quic.encrypted_sni.esni,
           &packet->payload[offset + extension_offset + 2],
           esni_len);
  }

#ifdef DEBUG_TLS
  printf("Client TLS [ESNI: len=%u]\n", esni_len);
#endif
} else if(extension_id == 57 /* QUIC transport parameters */) {
  u_int16_t quic_params_len = ntohs(*((u_int16_t*)&packet->payload[offset + extension_offset]));
  flow->protos.tls_quic.quic_transport_parameters.len = quic_params_len;
  flow->protos.tls_quic.quic_transport_parameters.params = ndpi_malloc(quic_params_len);

  if(flow->protos.tls_quic.quic_transport_parameters.params != NULL) {
    memcpy(flow->protos.tls_quic.quic_transport_parameters.params,
           &packet->payload[offset + extension_offset + 2],
           quic_params_len);

    processQuicTransportParameters(ndpi_struct, flow,
                                   flow->protos.tls_quic.quic_transport_parameters.params,
                                   quic_params_len);
  }

#ifdef DEBUG_TLS
  printf("Client TLS [QUIC Transport Parameters: len=%u]\n", quic_params_len);
#endif
}