} else if(extension_id == 43 /* supported versions */) {
		u_int16_t s_offset = offset+extension_offset + 1;

#ifdef DEBUG_TLS
		printf("Client TLS [SUPPORTED_VERSIONS: len=%u]\n", extension_len);
#endif
		if((s_offset+extension_len-1) <= total_len) {
		  for(i=0; i<(u_int32_t)extension_len-1 && s_offset+i<total_len; i+=2) {
		    u_int16_t s_version = ntohs(*((u_int16_t*)&packet->payload[s_offset+i]));

#ifdef DEBUG_TLS
		    printf("Client TLS [SUPPORTED_VERSIONS: %u/0x%04X]\n", s_version, s_version);
#endif

		    if(i == 0) {
		      flow->protos.tls_quic.ssl_version = s_version;
		      if(flow->protos.tls_quic.ssl_version < 0x0303) /* < TLSv1.2 */
		        ndpi_set_risk(ndpi_struct, flow, NDPI_TLS_OBSOLETE_VERSION);
		    }

		    if((s_version == 0) || (packet->payload[s_offset+i] != packet->payload[s_offset+i+1])) {
		      /* Skip GREASE */
		      if((strlen(ja3.client.supported_versions) + 6) < sizeof(ja3.client.supported_versions)) {
		        int rc = snprintf(&ja3.client.supported_versions[strlen(ja3.client.supported_versions)],
					  sizeof(ja3.client.supported_versions) - strlen(ja3.client.supported_versions),
					  "%s%u", (i > 0) ? "-" : "", s_version);
		        if(rc < 0) break;
		      }
		    }
		  }
		} else {
		  invalid_ja3 = 1;
#ifdef DEBUG_TLS
		  printf("Client TLS Invalid len %u vs %u\n", s_offset+extension_len, total_len);
#endif
		}
	      } else if(extension_id == 65486 /* encrypted server name */) {
		if(extension_len >= 5) {
		  flow->protos.tls_quic.encrypted_sni.esni = ndpi_malloc(extension_len);
		  if(flow->protos.tls_quic.encrypted_sni.esni) {
		    memcpy(flow->protos.tls_quic.encrypted_sni.esni, &packet->payload[offset+extension_offset], extension_len);
		    flow->protos.tls_quic.encrypted_sni.esni_len = extension_len;
		  }
		}
	      } else if(extension_id == 65445 /* quic transport params */) {
		if(extension_len >= 4) {
		  u_int32_t quic_transport_params = ntohl(*((u_int32_t*)&packet->payload[offset+extension_offset]));
		  if(is_version_with_var_int_transport_params(quic_version)) {
		    u_int64_t quic_user_agent_len;
		    u_int16_t quic_user_agent_offset = extension_offset + 4;
		    if(quic_len(&packet->payload[offset+quic_user_agent_offset], &quic_user_agent_len) == 0) {
		      quic_user_agent_offset += quic_len_buffer_still_required(packet->payload[offset+quic_user_agent_offset]);
		      if(quic_user_agent_offset + quic_user_agent_len <= extension_offset + extension_len) {
		        http_process_user_agent(ndpi_struct, flow, &packet->payload[offset+quic_user_agent_offset], quic_user_agent_len);
		      }
		    }
		  }
		}