if(extension_id == 43 /* supported_versions */) {
  u_int16_t s_offset = offset+extension_offset;
  u_int16_t tot_supported_versions_len = packet->payload[s_offset];

  s_offset++;
  tot_supported_versions_len += s_offset;

  while(s_offset < tot_supported_versions_len && s_offset+1 < total_len) {
    u_int16_t version = ntohs(*((u_int16_t*)&packet->payload[s_offset]));
    
    if(flow->protos.tls_quic.tls_supported_versions_len < MAX_TLS_SUPPORTED_VERSIONS) {
      flow->protos.tls_quic.tls_supported_versions[flow->protos.tls_quic.tls_supported_versions_len++] = version;
    }
    
    snprintf(&ja3.client.supported_versions[strlen(ja3.client.supported_versions)], 
             sizeof(ja3.client.supported_versions) - strlen(ja3.client.supported_versions), 
             "%s%u", (s_offset > offset+extension_offset+1) ? "-" : "", version);
    
    s_offset += 2;
  }
} else if(extension_id == 65486 /* encrypted_server_name */) {
  flow->protos.tls_quic.encrypted_sni.esni = 1;
} else if(extension_id == 0x39 /* QUIC transport parameters */) {
  u_int16_t s_offset = offset+extension_offset;
  u_int16_t tot_quic_params_len = ntohs(*((u_int16_t*)&packet->payload[s_offset]));
  
  s_offset += 2;
  tot_quic_params_len += s_offset;
  
  while(s_offset < tot_quic_params_len && s_offset+4 <= total_len) {
    u_int16_t param_id = ntohs(*((u_int16_t*)&packet->payload[s_offset]));
    u_int16_t param_len = ntohs(*((u_int16_t*)&packet->payload[s_offset+2]));
    
    s_offset += 4;
    
    if(param_id == 0x3129 /* user_agent_id */) {
      if(param_len < sizeof(flow->protos.tls_quic.user_agent)-1 && s_offset+param_len <= total_len) {
        memcpy(flow->protos.tls_quic.user_agent, &packet->payload[s_offset], param_len);
        flow->protos.tls_quic.user_agent[param_len] = '\0';
      }
    }
    
    s_offset += param_len;
  }
}