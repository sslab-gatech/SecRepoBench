else if(extension_id == 43 /* supported versions */) {
  u_int16_t s_offset = offset + extension_offset;
  u_int16_t num_versions = extension_len / 2;
  u_int16_t j;

  for(j=0; j<num_versions; j++) {
    u_int16_t version = ntohs(*((u_int16_t*)&packet->payload[s_offset + 2*j]));
    if(j < (sizeof(ja3.client.supported_versions)-5)/5) { // Format as 4-char hex with hyphens
      snprintf(&ja3.client.supported_versions[j*5], sizeof(ja3.client.supported_versions)-j*5,
               "%s%04X", (j > 0) ? "-" : "", version);
    }
  }
} else if(extension_id == 0xFFCE /* encrypted server name (65486) */) {
  flow->protos.tls_quic.encrypted_sni.esni = 1;
  flow->protos.tls_quic.encrypted_sni.len = ndpi_min(extension_len, sizeof(flow->protos.tls_quic.encrypted_sni.value));
  if(flow->protos.tls_quic.encrypted_sni.len > 0) {
    memcpy(flow->protos.tls_quic.encrypted_sni.value, &packet->payload[offset + extension_offset], 
           flow->protos.tls_quic.encrypted_sni.len);
  }
} else if(extension_id == 57 /* QUIC transport parameters */) {
  u_int32_t param_offset = offset + extension_offset;
  while(param_offset + 4 <= offset + extension_offset + extension_len) {
    u_int16_t param_id = ntohs(*((u_int16_t*)&packet->payload[param_offset]));
    u_int16_t param_len = ntohs(*((u_int16_t*)&packet->payload[param_offset + 2]));
    
    if(param_offset + 4 + param_len > offset + extension_offset + extension_len) break;
    
    if(param_id == 0x4855 /* User Agent ID (0x4855 = 'HU') */ && param_len > 0) {
      u_int16_t copy_len = ndpi_min(param_len, sizeof(flow->protos.tls_quic.h0_user_agent)-1);
      strncpy(flow->protos.tls_quic.h0_user_agent, (char*)&packet->payload[param_offset + 4], copy_len);
      flow->protos.tls_quic.h0_user_agent[copy_len] = '\0';
      break;
    }
    param_offset += 4 + param_len;
  }
}