} else if(extension_id == 43 /* supported versions */) {
  if(extension_len >= 2) {
    u_int16_t tls_version = ntohs(*((u_int16_t*)&packet->payload[offset+4]));

#ifdef DEBUG_TLS
    printf("Client TLS [TLS version: 0x%04X]\n", tls_version);
#endif

    if(ja3.client.num_supported_versions < MAX_NUM_JA3) {
      ja3.client.supported_versions[ja3.client.num_supported_versions++] = tls_version;
    } else {
      invalid_ja3 = 1;
#ifdef DEBUG_TLS
      printf("Client TLS Invalid num supported versions %u\n", ja3.client.num_supported_versions);
#endif
    }
  }
} else if(extension_id == 41 /* encrypted server name */) {
  if(extension_len >= 5) {
    u_int8_t esni_record_len = packet->payload[offset+4];

    if(offset + 5 + esni_record_len <= total_len) {
      u_int8_t *esni_record = &packet->payload[offset+5];

      if(flow->protos.tls_quic.encrypted_sni.esni == NULL) {
        flow->protos.tls_quic.encrypted_sni.esni = ndpi_malloc(sizeof(struct ndpi_encrypted_sni));
      }

      if(flow->protos.tls_quic.encrypted_sni.esni!= NULL) {
        flow->protos.tls_quic.encrypted_sni.esni->record_len = esni_record_len;
        memcpy(flow->protos.tls_quic.encrypted_sni.esni->record, esni_record, esni_record_len);
      }
    }
  }
} else if(extension_id == 0x39a1 /* QUIC transport parameters */) {
  if(extension_len >= 4) {
    u_int16_t quic_transport_params_len = ntohs(*((u_int16_t*)&packet->payload[offset+2]));

    if(offset + 4 + quic_transport_params_len <= total_len) {
      u_int8_t *quic_transport_params = &packet->payload[offset+4];

      if(flow->protos.tls_quic.quic_transport_params == NULL) {
        flow->protos.tls_quic.quic_transport_params = ndpi_malloc(sizeof(struct ndpi_quic_transport_params));
      }

      if(flow->protos.tls_quic.quic_transport_params!= NULL) {
        flow->protos.tls_quic.quic_transport_params->params_len = quic_transport_params_len;
        memcpy(flow->protos.tls_quic.quic_transport_params->params, quic_transport_params, quic_transport_params_len);
      }

      // Process user agent if available
      if(quic_transport_params_len >= 6) {
        u_int16_t user_agent_len = ntohs(*((u_int16_t*)&quic_transport_params[4]));

        if(offset + 6 + user_agent_len <= total_len) {
          u_int8_t *user_agent = &quic_transport_params[6];

          if(flow->protos.tls_quic.user_agent == NULL) {
            flow->protos.tls_quic.user_agent = ndpi_malloc(user_agent_len + 1);
          }

          if(flow->protos.tls_quic.user_agent!= NULL) {
            memcpy(flow->protos.tls_quic.user_agent, user_agent, user_agent_len);
            flow->protos.tls_quic.user_agent[user_agent_len] = '\0';
          }
        }
      }
    }
  }
}