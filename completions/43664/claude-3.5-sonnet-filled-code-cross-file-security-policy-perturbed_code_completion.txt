if(extension_id == 43 /* supported_versions */) {
  u_int16_t s_offset = offset+extension_offset;
  u_int16_t tot_supported_versions_len = packet->payload[s_offset];

  s_offset++;
  for(i=0; i<tot_supported_versions_len-1 && s_offset+1 < total_len; i+=2) {
    u_int16_t version = ntohs(*((u_int16_t*)&packet->payload[s_offset+i]));
    
    if(ja3.client.num_supported_versions < MAX_NUM_TLS_SUPPORTED_VERSIONS) {
      ja3.client.supported_versions[ja3.client.num_supported_versions++] = version;
    }
    
    if(flow->protos.tls_quic.ssl_version < version) {
      flow->protos.tls_quic.ssl_version = version;
    }
  }
} else if(extension_id == 65486 /* encrypted_server_name */) {
  flow->protos.tls_quic.encrypted_sni.esni = 1;
  
  if(extension_len > 4 && offset+extension_offset+4 < total_len) {
    flow->protos.tls_quic.encrypted_sni.cipher_suite = ntohs(*((u_int16_t*)&packet->payload[offset+extension_offset+2]));
  }
} else if(extension_id == 0x39 /* QUIC transport parameters */) {
  u_int16_t s_offset = offset+extension_offset;
  u_int16_t tot_quic_params_len = ntohs(*((u_int16_t*)&packet->payload[s_offset]));
  
  s_offset += 2;
  while(s_offset < tot_quic_params_len && s_offset+4 <= total_len) {
    u_int16_t param_id = ntohs(*((u_int16_t*)&packet->payload[s_offset]));
    u_int16_t param_len = ntohs(*((u_int16_t*)&packet->payload[s_offset+2]));
    
    s_offset += 4;
    
    if(param_id == 0x000c /* user_agent_id */ && param_len > 0 && s_offset+param_len <= total_len) {
      if(flow->protos.tls_quic.user_agent == NULL) {
        flow->protos.tls_quic.user_agent = ndpi_malloc(param_len + 1);
        if(flow->protos.tls_quic.user_agent != NULL) {
          memcpy(flow->protos.tls_quic.user_agent, &packet->payload[s_offset], param_len);
          flow->protos.tls_quic.user_agent[param_len] = '\0';
        }
      }
    }
    
    s_offset += param_len;
  }
}