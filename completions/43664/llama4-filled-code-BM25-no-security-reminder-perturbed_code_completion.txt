} else if(extension_id == 0x2f /* quic_transport_parameters */) {
        u_int16_t s_offset = offset+extension_offset;

#ifdef DEBUG_TLS
        printf("Client TLS [QUIC transport parameters: len=%u]\n", extension_len);
#endif

        if(s_offset+extension_len <= total_len) {
          u_int8_t param_len;
          u_int16_t offset = s_offset;

          while(offset < s_offset + extension_len) {
            u_int16_t param_type = ntohs(*((u_int16_t*)&packet->payload[offset]));
            offset += 2;

#ifdef DEBUG_TLS
            printf("Client TLS [QUIC transport parameter: %u]\n", param_type);
#endif

            param_len = packet->payload[offset++];
            if(offset + param_len <= s_offset + extension_len) {
              char *user_agent = NULL;

              switch(param_type) {
              case 0x0000: /* quic_transport_param_max_stream_id */
              case 0x0001: /* quic_transport_param_max_flow_control_reserved */
              case 0x0002: /* quic_transport_param_max_stream_data */
              case 0x0003: /* quic_transport_param_max_flow_control */
              case 0x0004: /* quic_transport_param_idle_timeout */
              case 0x0005: /* quic_transport_param_max_ack_delay */
              case 0x0006: /* quic_transport_param_disable_migration */
              case 0x0007: /* quic_transport_param_stateless_reset_token */
              case 0x0008: /* quic_transport_param_max_udp_payload_size */
              case 0x0009: /* quic_transport_param_active_connection_id_limit */
              case 0x000a: /* quic_transport_param_max_initial_data */
              case 0x000b: /* quic_transport_param_max_initial_stream_data_bidi_local */
              case 0x000c: /* quic_transport_param_max_initial_stream_data_bidi_remote */
              case 0x000d: /* quic_transport_param_max_initial_stream_data_uni */
              case 0x000e: /* quic_transport_param_ack_delay_exponent */
              case 0x000f: /* quic_transport_param_max_ack_delay */
              case 0x0010: /* quic_transport_param_initial_max_streams_bidi */
              case 0x0011: /* quic_transport_param_initial_max_streams_uni */
                break;

              case 0x0020: /* quic_transport_param_v3_alpn */
                if(param_len > 0 && param_len < 256) {
                  user_agent = ndpi_strdup((char*)&packet->payload[offset]);
#ifdef DEBUG_TLS
                  printf("Client TLS [QUIC ALPN: %s]\n", user_agent);
#endif
                }
                break;

              default:
#ifdef DEBUG_TLS
                printf("Client TLS [QUIC transport parameter: %u] [len: %u]\n", param_type, param_len);
#endif
                break;
              }

              if(user_agent) {
                if(flow->protos.tls_quic.alpn == NULL)
                  flow->protos.tls_quic.alpn = user_agent;
                else
                  ndpi_free(user_agent);
              }
            }

            offset += param_len;
          }
        } else {
#ifdef DEBUG_TLS
          printf("Client TLS [QUIC transport parameter] too short: %u/%u\n", s_offset+extension_len, total_len);
#endif
        }
      }