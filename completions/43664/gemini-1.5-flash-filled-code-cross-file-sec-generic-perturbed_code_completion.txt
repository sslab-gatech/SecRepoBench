if (extension_id == 43 /* supported versions */) {
        if (extension_len >= 2) {
          u_int16_t tls_version = ntohs(*((u_int16_t *)&packet->payload[offset + 4]));
#ifdef DEBUG_TLS
          printf("Client TLS [TLS version: 0x%04X]\n", tls_version);
#endif
          snprintf(ja3.client.supported_versions, sizeof(ja3.client.supported_versions), "%u", tls_version);
          flow->protos.tls_quic.ssl_version = ja3.client.tls_supported_version = tls_version;
        }
      } else if (extension_id == 35 /* encrypted server name */) {
        u_int16_t len;
#ifdef DEBUG_TLS
        printf("[TLS] Extensions: found encrypted server name\n");
#endif
        if ((offset + extension_offset + 4) < packet->payload_packet_len) {
          len = (packet->payload[offset + extension_offset + 3] << 8) + packet->payload[offset + extension_offset + 4];
          if ((offset + extension_offset + 5 + len) <= packet->payload_packet_len) {
            ndpi_hostname_sni_set(flow, &packet->payload[offset + extension_offset + 5], len);
          } else {
#ifdef DEBUG_TLS
            printf("[TLS] Extensions server len too short: %u vs %u\n", (offset + extension_offset + 5 + len), packet->payload_packet_len);
#endif
          }
        }
      } else if (extension_id == 26 /* QUIC transport parameters */) {
        u_int16_t len;
        if ((offset + extension_offset + 4) < packet->payload_packet_len) {
          len = (packet->payload[offset + extension_offset + 3] << 8) + packet->payload[offset + extension_offset + 4];
          if ((offset + extension_offset + 5 + len) <= packet->payload_packet_len) {
            ndpi_quic_process_transport_parameters(ndpi_struct, flow, &packet->payload[offset + extension_offset + 5], len);
          } else {
#ifdef DEBUG_TLS
            printf("[TLS] Extensions server len too short: %u vs %u\n", (offset + extension_offset + 5 + len), packet->payload_packet_len);
#endif
          }
        }
      }