if (extension_id == 43 /* supported versions */) {
        if (extension_len >= 2) {
          u_int16_t tls_version = ntohs(*((u_int16_t*)&packet->payload[offset + extension_offset]));
          flow->protos.tls_quic.ssl_version = ja3.client.tls_supported_version = tls_version;
#ifdef DEBUG_TLS
          printf("Client TLS [TLS version: 0x%04X]\n", tls_version);
#endif
        }
      } else if (extension_id == 35 /* encrypted server name */) {
        u_int16_t len;
        if ((offset + extension_offset + 4) < packet->payload_packet_len) {
          len = (packet->payload[offset + extension_offset + 3] << 8) + packet->payload[offset + extension_offset + 4];
          if ((offset + extension_offset + 5 + len) <= packet->payload_packet_len) {
            ndpi_hostname_sni_set(flow, &packet->payload[offset + extension_offset + 5], len);
          } else {
#ifdef DEBUG_TLS
            printf("[TLS] Extensions server len too short: %u vs %u\n", (offset + extension_offset + 5 + len), packet->payload_packet_len);
#endif
          }
        }
      } else if (extension_id == 26 /* QUIC transport parameters */) {
        u_int16_t len = ntohs(*((u_int16_t*)&packet->payload[offset + extension_offset]));
        if ((offset + extension_offset + 2 + len) <= total_len) {
          u_int8_t *quic_transport_parameters = &packet->payload[offset + extension_offset + 2];
          if (quic_transport_parameters[0] == 0x00 && quic_transport_parameters[1] == 0x00) {
            u_int32_t user_agent_len = ntohl(*((u_int32_t*)&quic_transport_parameters[2]));
            if (user_agent_len > 0 && (offset + extension_offset + 2 + len) >= (offset + extension_offset + 2 + 6 + user_agent_len)) {
              char user_agent[256];
              memcpy(user_agent, &quic_transport_parameters[6], user_agent_len);
              user_agent[user_agent_len] = '\0';
              if (flow->protos.tls_quic.user_agent == NULL) {
                flow->protos.tls_quic.user_agent = ndpi_strdup(user_agent);
              }
            }
          }
        }
      }