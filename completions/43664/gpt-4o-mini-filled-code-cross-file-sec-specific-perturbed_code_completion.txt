if (extension_id == 43 /* supported_versions */) {
	        if (extension_len >= 2) {
	          u_int16_t supported_version = ntohs(*((u_int16_t*)&packet->payload[offset + 4]));
	          if (supported_version >= 0x0301 && supported_version <= 0x0304) { // TLS 1.0 to 1.3
	            ja3.client.supported_versions[ja3.client.num_supported_versions++] = supported_version;
	          }
	        }
	      } else if (extension_id == 0 /* server_name */) {
	        if (offset + 4 < total_len) {
	          u_int16_t sni_length = (packet->payload[offset + 3] << 8) + packet->payload[offset + 4];
	          if (offset + 5 + sni_length <= total_len) {
	            char *sni = ndpi_hostname_sni_set(flow, &packet->payload[offset + 5], sni_length);
	            if (sni != NULL) {
	              int sni_len = strlen(sni);
	              if (ndpi_is_printable_string(sni, sni_len) == 0) {
	                ndpi_set_risk(ndpi_struct, flow, NDPI_INVALID_CHARACTERS);
	              }
	            }
	          }
	        }
	      } else if (extension_id == 0xFF /* quic_transport_parameters */) {
	        // Process QUIC transport parameters if present
	        // Implementation for extracting and processing QUIC parameters goes here
	      }