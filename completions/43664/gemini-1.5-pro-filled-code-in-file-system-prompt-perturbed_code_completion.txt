if(extension_id == 43 /* supported_versions */) {
		  u_int16_t s_offset = offset + extension_offset;
		  u_int16_t tot_supported_versions_len = packet->payload[s_offset];

#ifdef DEBUG_TLS
		  printf("Client TLS [supported_versions: block_len=%u/len=%u]\n", extension_len, tot_supported_versions_len);
#endif

		  if(tot_supported_versions_len > 0) {
		    s_offset++;

		    for(i=0; i<tot_supported_versions_len && s_offset + i + 1 < total_len; i += 2) {
		      u_int16_t supported_version = ntohs(*((u_int16_t*)&packet->payload[s_offset+i]));
		      int rc;

		      if(supported_version == 0 || packet->payload[s_offset+i] != packet->payload[s_offset+i+1]) {
			/* Skip GREASE */
			rc = snprintf(&ja3.client.supported_versions[i*2],
				      sizeof(ja3.client.supported_versions)-i*2, "%04X%s",
				      supported_version, (i > 0) ? "-" : "");

			if(rc > 0) {
#ifdef DEBUG_TLS
			  printf("Client TLS [supported_version: %04X]\n", supported_version);
#endif
			} else
			  break;
		      }
		    }
		  }
		} else if(extension_id == 44 /* encrypted server name indication */) {
		  /* https://tools.ietf.org/html/draft-ietf-tls-esni-02 */
		  flow->protos.tls_quic.encrypted_sni.esni = 1;
#ifdef DEBUG_ENCRYPTED_SNI
		  printf("[TLS] Extensions: found encrypted server name indication\n");
#endif
		} else if(extension_id == 46 /* QUIC transport parameters */) {
		  /* https://datatracker.ietf.org/doc/html/draft-ietf-quic-transport-32#section-17.2.4 */
		  u_int16_t s_offset = offset+extension_offset;
		  u_int16_t tot_quic_transport_parameters_len = ntohs(*((u_int16_t*)&packet->payload[s_offset]));

#ifdef DEBUG_TLS
		  printf("Client TLS [QUIC transport parameters: block_len=%u/len=%u]\n", extension_len, tot_quic_transport_parameters_len);
#endif

		  if(tot_quic_transport_parameters_len > 0) {
		    s_offset += 2;

		    if(is_version_with_var_int_transport_params(quic_version)) {
		      uint64_t param_len;
		      if(quic_len(&packet->payload[s_offset], &param_len) == 0) {
			if(param_len > 0 && param_len < total_len - s_offset) {
			  if(http_process_user_agent(ndpi_struct, flow, &packet->payload[s_offset], param_len) > 0) {
#ifdef DEBUG_TLS
			    printf("Client TLS [QUIC transport parameters: User-Agent found]\n");
#endif
			  }
			}
		      }
		    } else {
		      /* TODO: handle old versions */
		    }
		  }
		} else