if(extension_id == 43 /* supported_versions */) {
  u_int16_t s_offset = offset+extension_offset + 2;
  u_int16_t tot_version_len = packet->payload[s_offset];

  s_offset++;

  for(i=0; i<tot_version_len && s_offset+i+1 < total_len; i+=2) {
    u_int16_t version = ntohs(*((u_int16_t*)&packet->payload[s_offset+i]));
    
    if(ja3.client.supported_versions[0] != '\0')
      strcat(ja3.client.supported_versions, "-");
    
    snprintf(&ja3.client.supported_versions[strlen(ja3.client.supported_versions)], 
             sizeof(ja3.client.supported_versions) - strlen(ja3.client.supported_versions),
             "%u", version);
  }
} else if(extension_id == 65486 /* encrypted_server_name */) {
  flow->protos.tls_quic.encrypted_sni.esni = 1;
} else if(extension_id == 0x39 /* QUIC transport parameters */) {
  if(quic_version && extension_len > 0) {
    u_int16_t s_offset = offset+extension_offset;
    
    if(is_version_with_var_int_transport_params(quic_version)) {
      u_int64_t param_id, param_len;
      
      while(s_offset < total_len) {
        int varint1_len = quic_len(&packet->payload[s_offset], &param_id);
        
        if(varint1_len <= 0 || s_offset + varint1_len >= total_len)
          break;
        
        s_offset += varint1_len;
        
        int varint2_len = quic_len(&packet->payload[s_offset], &param_len);
        
        if(varint2_len <= 0 || s_offset + varint2_len + param_len > total_len)
          break;
        
        s_offset += varint2_len;
        
        if(param_id == 0x100 /* initial_max_data */) {
          flow->protos.tls_quic.u_ap.flow_max_data = param_len;
        }
        
        s_offset += param_len;
      }
    }
    
    if(flow->protos.tls_quic.user_agent == NULL) {
      int rc = http_process_user_agent(ndpi_struct, flow, &packet->payload[s_offset], extension_len);
      
      if(rc == 1) {
        /* User-Agent processed */
      }
    }
  }
}