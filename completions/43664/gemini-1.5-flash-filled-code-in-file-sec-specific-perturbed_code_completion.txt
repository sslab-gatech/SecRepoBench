if(extension_id == 43 /* supported versions */) {
        if(extension_len >= 2) {
          u_int16_t tls_version = ntohs(*((u_int16_t*)&packet->payload[offset+4]));

#ifdef DEBUG_TLS
          printf("Client TLS [TLS version: 0x%04X]\n", tls_version);
#endif

          snprintf(ja3.client.supported_versions, sizeof(ja3.client.supported_versions), "%u", tls_version);
        }
      } else if(extension_id == 65486 /* encrypted server name */) {
        u_int16_t len;

#ifdef DEBUG_ENCRYPTED_SNI
        printf("[TLS] Extensions: found encrypted server name\n");
#endif
        if((offset+extension_offset+4) < packet->payload_packet_len) {
          len = (packet->payload[offset+extension_offset+3] << 8) + packet->payload[offset+extension_offset+4];

          if((offset+extension_offset+5+len) <= packet->payload_packet_len) {
            flow->protos.tls_quic.encrypted_sni.esni = ndpi_strdup((const char*)&packet->payload[offset+extension_offset+5]);
            flow->protos.tls_quic.encrypted_sni.esni_len = len;
          } else {
#ifdef DEBUG_TLS
            printf("[TLS] Extensions server len too short: %u vs %u\n",
                   offset+extension_offset+5+len,
                   packet->payload_packet_len);
#endif
          }
        }
      } else if(extension_id == 65445 /* QUIC transport parameters */) {
        u_int16_t len;
        u_int32_t transport_params_len;

#ifdef DEBUG_TLS
        printf("[TLS] Extensions: found QUIC transport parameters\n");
#endif
        if((offset+extension_offset+4) < packet->payload_packet_len) {
          len = (packet->payload[offset+extension_offset+3] << 8) + packet->payload[offset+extension_offset+4];
          transport_params_len = len;

          if((offset+extension_offset+5+len) <= packet->payload_packet_len) {
            u_int8_t *transport_params = &packet->payload[offset+extension_offset+5];
            u_int16_t ua_len;
            u_int8_t *ua_ptr;

            if(quic_len(transport_params, &transport_params_len) == 0) {
              if(transport_params_len > 0) {
                if(transport_params[0] == 0x00) {
                  ua_ptr = &transport_params[1];
                  ua_len = transport_params_len - 1;
                  http_process_user_agent(ndpi_struct, flow, ua_ptr, ua_len);
                }
              }
            }
          } else {
#ifdef DEBUG_TLS
            printf("[TLS] Extensions server len too short: %u vs %u\n",
                   offset+extension_offset+5+len,
                   packet->payload_packet_len);
#endif
          }
        }
      }