if(extension_id == 43 /* supported versions */) {
		if(extension_len >= 2) {
		  u_int16_t tls_version = ntohs(*((u_int16_t*)&packet->payload[offset+4]));

#ifdef DEBUG_TLS
		  printf("Client TLS [supported versions: 0x%04X]\n", tls_version);
#endif

		  if(tls_version > ja3.client.tls_handshake_version) {
		    ja3.client.tls_handshake_version = tls_version;
		  }
		}
	      } else if(extension_id == 0 /* server name */) {
		u_int16_t len;

#ifdef DEBUG_TLS
		printf("[TLS] Extensions: found server name\n");
#endif
		if((offset+extension_offset+4) < packet->payload_packet_len) {
		  len = (packet->payload[offset+extension_offset+3] << 8) + packet->payload[offset+extension_offset+4];

		  if((offset+extension_offset+5+len) <= packet->payload_packet_len) {
		    char *sni = ndpi_hostname_sni_set(flow, &packet->payload[offset+extension_offset+5], len);
		    int sni_len = strlen(sni);
#ifdef DEBUG_TLS
		    printf("[TLS] SNI: [%s]\n", sni);
#endif
		    if(ndpi_is_printable_string(sni, sni_len) == 0) {
		       ndpi_set_risk(ndpi_struct, flow, NDPI_INVALID_CHARACTERS);
		    }

		    if(!is_quic) {
		      if(ndpi_match_hostname_protocol(ndpi_struct, flow, NDPI_PROTOCOL_TLS, sni, sni_len))
		        flow->protos.tls_quic.subprotocol_detected = 1;
		    } else {
		      if(ndpi_match_hostname_protocol(ndpi_struct, flow, NDPI_PROTOCOL_QUIC, sni, sni_len))
		        flow->protos.tls_quic.subprotocol_detected = 1;
		    }
		  } else {
#ifdef DEBUG_TLS
		    printf("[TLS] Extensions server len too short: %u vs %u\n",
			   offset+extension_offset+5+len,
			   packet->payload_packet_len);
#endif
		  }
		}
	      } else if(extension_id == 65281 /* encrypted server name */) {
		flow->protos.tls_quic.encrypted_sni.esni = 1;
#ifdef DEBUG_TLS
		printf("[TLS] Extensions: found encrypted server name\n");
#endif
	      } else if(extension_id == 65445 /* QUIC transport params */) {
		// Process QUIC transport parameters if present
		// This can include various parameters that are specific to QUIC
		// For example, we can extract the transport parameters and store them
		// in the flow structure for further analysis.
#ifdef DEBUG_TLS
		printf("[TLS] Extensions: found QUIC transport parameters\n");
#endif
	      }