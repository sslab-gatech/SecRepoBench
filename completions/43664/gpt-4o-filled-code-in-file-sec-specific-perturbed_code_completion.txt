if(extension_id == 43 /* supported versions */) {
		u_int16_t s_offset = offset+extension_offset + 1;

#ifdef DEBUG_TLS
		printf("Client TLS [SUPPORTED_VERSIONS: len=%u]\n", extension_len);
#endif
		if((s_offset+extension_len-1) <= total_len) {
		  for(i=0; i<(u_int32_t)extension_len-1 && s_offset+i<total_len; i+=2) {
		    u_int16_t s_version = ntohs(*((u_int16_t*)&packet->payload[s_offset+i]));

#ifdef DEBUG_TLS
		    printf("Client TLS [SUPPORTED_VERSIONS: %u/0x%04X]\n", s_version, s_version);
#endif

		    if(s_version < 0x0303) /* < TLSv1.2 */
		      ndpi_set_risk(ndpi_struct, flow, NDPI_TLS_OBSOLETE_VERSION);

		    if((s_version == 0) || (packet->payload[s_offset+i] != packet->payload[s_offset+i+1])) {
		      /* Skip GREASE */
		      if(ja3.client.supported_versions[0] != '\0')
			strncat(ja3.client.supported_versions, "-", sizeof(ja3.client.supported_versions) - strlen(ja3.client.supported_versions) - 1);

		      char version_str[6];
		      snprintf(version_str, sizeof(version_str), "%u", s_version);
		      strncat(ja3.client.supported_versions, version_str, sizeof(ja3.client.supported_versions) - strlen(ja3.client.supported_versions) - 1);
		    }
		  }
		} else {
		  invalid_ja3 = 1;
#ifdef DEBUG_TLS
		  printf("Client TLS Invalid len %u vs %u\n", s_offset+extension_len, total_len);
#endif
		}
	      } else if(extension_id == 65486 /* encrypted server name */) {
		if(extension_len > 0) {
		  flow->protos.tls_quic.encrypted_sni.esni = ndpi_malloc(extension_len);
		  if(flow->protos.tls_quic.encrypted_sni.esni) {
		    memcpy(flow->protos.tls_quic.encrypted_sni.esni, &packet->payload[offset+extension_offset], extension_len);
		    flow->protos.tls_quic.encrypted_sni.esni_len = extension_len;
#ifdef DEBUG_TLS
		    printf("Client TLS [ESNI: len=%u]\n", extension_len);
#endif
		  }
		}
	      } else if(extension_id == 65445 /* quic transport params */) {
		if(extension_len > 0) {
		  u_int16_t s_offset = offset+extension_offset;
		  u_int16_t ua_len = extension_len;

		  if(ua_len > 0 && s_offset + ua_len <= total_len) {
		    http_process_user_agent(ndpi_struct, flow, &packet->payload[s_offset], ua_len);
#ifdef DEBUG_TLS
		    printf("Client TLS [QUIC Transport Params: len=%u]\n", ua_len);
#endif
		  }
		}
	      }