} else if(extension_id == 43 /* supported versions */) {
  if(extension_len >= 2) {
    u_int16_t tls_version = ntohs(*((u_int16_t*)&packet->payload[offset+4]));

#ifdef DEBUG_TLS
    printf("Client TLS [TLS version: 0x%04X]\n", tls_version);
#endif

    flow->protos.tls_quic.ssl_version = ja3.client.tls_supported_version = tls_version;
  }
} else if(extension_id == 41 /* encrypted server name */) {
  if(extension_len >= 2) {
    u_int16_t esni_len = ntohs(*((u_int16_t*)&packet->payload[offset+4]));

#ifdef DEBUG_TLS
    printf("Client TLS [ESNI: len=%u]\n", esni_len);
#endif

    if(esni_len > 0) {
      flow->protos.tls_quic.encrypted_sni.esni = ndpi_memdup(&packet->payload[offset+6], esni_len, ndpi_struct->mem_pool);
      flow->protos.tls_quic.encrypted_sni.esni_len = esni_len;
    }
  }
} else if(extension_id == 0x39a1 /* QUIC transport parameters */) {
  if(extension_len >= 4) {
    u_int16_t quic_version = ntohs(*((u_int16_t*)&packet->payload[offset+4]));

#ifdef DEBUG_TLS
    printf("Client TLS [QUIC version: 0x%04X]\n", quic_version);
#endif

    if(quic_version > 0) {
      flow->protos.tls_quic.quic_version = quic_version;
      processClientQUIC(ndpi_struct, flow, offset+6, extension_len-4);
    }
  }
}