if (extension_id == 43 /* supported_versions */) {
          u_int16_t s_offset = offset + extension_offset;
          u_int16_t supported_versions_len = packet->payload[s_offset];

#ifdef DEBUG_TLS
          printf("Client TLS [supported_versions: len=%u]\n", supported_versions_len);
#endif
          s_offset++;

          if (s_offset + supported_versions_len <= total_len) {
            for (i = 0; i < supported_versions_len; i += 2) {
              u_int16_t version = ntohs(*((u_int16_t *)&packet->payload[s_offset + i]));
              int rc = snprintf(&ja3.client.supported_versions[i * 2], sizeof(ja3.client.supported_versions) - i * 4, "%04X-", version);
              if (rc < 0) {
                break;
              }
#ifdef DEBUG_TLS
              printf("Client TLS [supported version: %04X]\n", version);
#endif
            }
            ja3.client.supported_versions[i * 2 - 1] = '\0'; // Remove trailing dash

          }
        } else if (extension_id == 50 /* encrypted_server_name */) {
          flow->protos.tls_quic.encrypted_sni.esni = 1;
#ifdef DEBUG_TLS
          printf("Client TLS [encrypted_server_name]\n");
#endif
        } else if (extension_id == 35 /* QUIC transport parameters */) {
          u_int16_t s_offset = offset + extension_offset;
          u_int16_t quic_tp_len = extension_len;

#ifdef DEBUG_TLS
          printf("Client TLS [QUIC transport parameters: len=%u]\n", quic_tp_len);
#endif

          if (s_offset + quic_tp_len <= total_len) {
            processQuicTransportParameters(ndpi_struct, flow, s_offset, quic_tp_len);
          }
        }