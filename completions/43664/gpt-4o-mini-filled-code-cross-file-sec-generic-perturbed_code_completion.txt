if(extension_id == 43 /* supported versions */) {
		if(extension_len >= 2) {
		  u_int16_t supported_tls_version = ntohs(*((u_int16_t*)&packet->payload[offset + 4]));
		  if(supported_tls_version > ja3.client.tls_handshake_version) {
		    ja3.client.tls_handshake_version = supported_tls_version;
		  }
		}
	      } else if(extension_id == 0 /* server name */) {
		u_int16_t len;

		if((offset + extension_offset + 4) < packet->payload_packet_len) {
		  len = (packet->payload[offset + extension_offset + 3] << 8) + packet->payload[offset + extension_offset + 4];

		  if((offset + extension_offset + 5 + len) <= packet->payload_packet_len) {
		    char *sni = ndpi_hostname_sni_set(flow, &packet->payload[offset + extension_offset + 5], len);
		    int sni_len = strlen(sni);
		    if(ndpi_is_printable_string(sni, sni_len) == 0) {
		      ndpi_set_risk(ndpi_struct, flow, NDPI_INVALID_CHARACTERS);
		    }
		    if(!is_quic) {
		      if(ndpi_match_hostname_protocol(ndpi_struct, flow, NDPI_PROTOCOL_TLS, sni, sni_len))
		        flow->protos.tls_quic.subprotocol_detected = 1;
		    } else {
		      if(ndpi_match_hostname_protocol(ndpi_struct, flow, NDPI_PROTOCOL_QUIC, sni, sni_len))
		        flow->protos.tls_quic.subprotocol_detected = 1;
		    }
		  }
		}
	      } else if(extension_id == 0xFF /* QUIC transport parameters */) {
		// Process QUIC transport parameters if present
		// This is a placeholder for actual processing logic
		// Ensure to validate the length and contents of the parameters
	      }