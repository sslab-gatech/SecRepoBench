if (extension_id == 43 /* supported versions */) {
        if (extension_len >= 2) {
          u_int16_t tls_version = ntohs(*((u_int16_t*)&packet->payload[offset + extension_offset]));
#ifdef DEBUG_TLS
          printf("Client TLS [TLS version: 0x%04X]\n", tls_version);
#endif
          snprintf(ja3.client.supported_versions, sizeof(ja3.client.supported_versions), "%u", tls_version);
          flow->protos.tls_quic.ssl_version = ja3.client.tls_supported_version = tls_version;
        }
      } else if (extension_id == 35 /* encrypted server name */) {
        u_int16_t len;
#ifdef DEBUG_TLS
        printf("[TLS] Extensions: found encrypted server name\n");
#endif
        if ((offset + extension_offset + 2) < packet->payload_packet_len) {
          len = ntohs(*((u_int16_t*)&packet->payload[offset + extension_offset]));
          if ((offset + extension_offset + 2 + len) <= packet->payload_packet_len) {
            flow->protos.tls_quic.encrypted_sni.esni = ndpi_malloc(len + 1);
            if (flow->protos.tls_quic.encrypted_sni.esni != NULL) {
              memcpy(flow->protos.tls_quic.encrypted_sni.esni, &packet->payload[offset + extension_offset + 2], len);
              flow->protos.tls_quic.encrypted_sni.esni[len] = '\0';
            }
          } else {
#ifdef DEBUG_TLS
            printf("[TLS] Extensions server len too short: %u vs %u\n", (offset + extension_offset + 2 + len), packet->payload_packet_len);
#endif
          }
        }
      } else if (extension_id == 26 /* QUIC transport parameters */) {
        u_int16_t len;
        if ((offset + extension_offset + 2) < packet->payload_packet_len) {
          len = ntohs(*((u_int16_t*)&packet->payload[offset + extension_offset]));
          if ((offset + extension_offset + 2 + len) <= packet->payload_packet_len) {
            u_int8_t *quic_transport_parameters = &packet->payload[offset + extension_offset + 2];
            if (quic_transport_parameters[0] == 0x00 && quic_transport_parameters[1] == 0x00) {
              // Check for user agent in QUIC transport parameters
              // ... (Your code to extract and process user agent) ...
            }
          } else {
#ifdef DEBUG_TLS
            printf("[TLS] Extensions server len too short: %u vs %u\n", (offset + extension_offset + 2 + len), packet->payload_packet_len);
#endif
          }
        }
      }