else if(extension_id == 43 /* supported versions */) {
  u_int16_t s_offset = offset + extension_offset + 2;
  u_int16_t tot_supported_versions_len = ntohs(*((u_int16_t*)&packet->payload[s_offset]));

#ifdef DEBUG_TLS
  printf("Client TLS [SUPPORTED_VERSIONS: block_len=%u/len=%u]\n", extension_len, tot_supported_versions_len);
#endif

  s_offset += 2;
  tot_supported_versions_len = ndpi_min((sizeof(ja3.client.supported_versions) / 2) - 1, tot_supported_versions_len);

  for(i=0; i<tot_supported_versions_len && s_offset+i<total_len; i+=2) {
    u_int16_t version = ntohs(*((u_int16_t*)&packet->payload[s_offset+i]));

#ifdef DEBUG_TLS
    printf("Client TLS [Supported Version: 0x%04X]\n", version);
#endif

    if(ja3.client.num_supported_versions < MAX_NUM_JA3)
      ja3.client.supported_versions[ja3.client.num_supported_versions++] = version;
    else {
      invalid_ja3 = 1;
#ifdef DEBUG_TLS
      printf("Client TLS Invalid num supported versions %u\n", ja3.client.num_supported_versions);
#endif
    }
  }
} else if(extension_id == 0xFF01 /* encrypted server name */) {
  // Handle encrypted server name indication (ESNI)
  flow->protos.tls_quic.encrypted_sni.esni = 1;
#ifdef DEBUG_TLS
  printf("Client TLS [Encrypted Server Name Indication]\n");
#endif
} else if(extension_id == 0x002b /* QUIC transport parameters */) {
  u_int16_t s_offset = offset + extension_offset + 2;
  u_int16_t tot_quic_params_len = ntohs(*((u_int16_t*)&packet->payload[s_offset]));

#ifdef DEBUG_TLS
  printf("Client TLS [QUIC Transport Parameters: block_len=%u/len=%u]\n", extension_len, tot_quic_params_len);
#endif

  s_offset += 2;
  tot_quic_params_len = ndpi_min((sizeof(flow->protos.tls_quic.quic_transport_params) / 2) - 1, tot_quic_params_len);

  for(i=0; i<tot_quic_params_len && s_offset+i<total_len; i++) {
    // Process each QUIC transport parameter
    // Example: Extract user agent if available
    // This is a placeholder for actual processing logic
#ifdef DEBUG_TLS
    printf("Client TLS [QUIC Transport Parameter: %02X]\n", packet->payload[s_offset+i]);
#endif
  }
}