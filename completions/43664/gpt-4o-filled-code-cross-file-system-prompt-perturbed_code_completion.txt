else if(extension_id == 43 /* supported versions */) {
  u_int16_t s_offset = offset+extension_offset + 2;
  u_int16_t tot_supported_versions_len = ntohs(*((u_int16_t*)&packet->payload[s_offset]));

#ifdef DEBUG_TLS
  printf("Client TLS [SUPPORTED_VERSIONS: block_len=%u/len=%u]\n", extension_len, tot_supported_versions_len);
#endif

  s_offset += 2;
  tot_supported_versions_len = ndpi_min((sizeof(ja3.client.supported_versions) / 2) - 1, tot_supported_versions_len);

  for(i=0; i<tot_supported_versions_len && s_offset+i<total_len; i++) {
    int rc = snprintf(&ja3.client.supported_versions[i*2], sizeof(ja3.client.supported_versions)-i*2, "%02X", packet->payload[s_offset+i]);

    if(rc < 0) break;
  }

  if(i > 0 && i >= tot_supported_versions_len) {
    ja3.client.supported_versions[i*2 - 1] = '\0';
  } else {
    ja3.client.supported_versions[i*2] = '\0';
  }

#ifdef DEBUG_TLS
  printf("Client TLS [SUPPORTED_VERSIONS: %s]\n", ja3.client.supported_versions);
#endif
} else if(extension_id == 0xFF01 /* encrypted server name */) {
  // Handle encrypted server name indication (ESNI)
  flow->protos.tls_quic.encrypted_sni.esni = 1;

#ifdef DEBUG_TLS
  printf("Client TLS [ENCRYPTED_SERVER_NAME]\n");
#endif
} else if(extension_id == 0x002b /* QUIC transport parameters */) {
  u_int16_t s_offset = offset+extension_offset + 2;
  u_int16_t tot_quic_params_len = ntohs(*((u_int16_t*)&packet->payload[s_offset]));

#ifdef DEBUG_TLS
  printf("Client TLS [QUIC_TRANSPORT_PARAMETERS: block_len=%u/len=%u]\n", extension_len, tot_quic_params_len);
#endif

  s_offset += 2;
  tot_quic_params_len = ndpi_min((sizeof(flow->protos.tls_quic.quic_transport_params) / 2) - 1, tot_quic_params_len);

  for(i=0; i<tot_quic_params_len && s_offset+i<total_len; i++) {
    flow->protos.tls_quic.quic_transport_params[i] = packet->payload[s_offset+i];
  }

  flow->protos.tls_quic.quic_transport_params[tot_quic_params_len] = '\0';

#ifdef DEBUG_TLS
  printf("Client TLS [QUIC_TRANSPORT_PARAMETERS: %s]\n", flow->protos.tls_quic.quic_transport_params);
#endif
}