if (extension_id == 43) { /* supported versions */
        if (extension_len >= 2) {
          u_int16_t tls_version = ntohs(*((u_int16_t *)&packet->payload[offset + 4]));
          snprintf(ja3.client.supported_versions, sizeof(ja3.client.supported_versions), "%u", tls_version);
#ifdef DEBUG_TLS
          printf("Client TLS [TLS version: 0x%04X]\n", tls_version);
#endif
        }
      } else if (extension_id == 65486) { /* ESNI */
        if (extension_len >= 2) {
          u_int16_t esni_len = ntohs(*((u_int16_t *)&packet->payload[offset + 4]));
          if (esni_len > 0) {
            flow->protos.tls_quic.encrypted_sni.esni = ndpi_malloc(esni_len + 1);
            memcpy(flow->protos.tls_quic.encrypted_sni.esni, &packet->payload[offset + 6], esni_len);
            flow->protos.tls_quic.encrypted_sni.esni[esni_len] = '\0';
#ifdef DEBUG_ENCRYPTED_SNI
            printf("[TLS] ESNI: %s\n", flow->protos.tls_quic.encrypted_sni.esni);
#endif
          }
        }
      } else if (extension_id == 65445) { /* QUIC transport parameters */
        if (extension_len >= 2) {
          u_int16_t quic_transport_params_len = ntohs(*((u_int16_t *)&packet->payload[offset + 4]));
          if (quic_transport_params_len > 0) {
            u_int8_t *quic_transport_params = ndpi_malloc(quic_transport_params_len + 1);
            memcpy(quic_transport_params, &packet->payload[offset + 6], quic_transport_params_len);
            quic_transport_params[quic_transport_params_len] = '\0';
            if (quic_transport_params_len > 0) {
              u_int8_t *ua_ptr = NULL;
              u_int16_t ua_ptr_len = 0;
              if (quic_find_user_agent(quic_transport_params, quic_transport_params_len, &ua_ptr, &ua_ptr_len) == 0) {
                http_process_user_agent(ndpi_struct, flow, ua_ptr, ua_ptr_len);
              }
            }
            ndpi_free(quic_transport_params);
          }
        }
      }