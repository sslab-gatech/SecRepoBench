if(extension_id == 43 /* supported_versions */) {
          u_int16_t s_offset = offset + extension_offset;
          u_int16_t supported_versions_len = packet->payload[s_offset];

          if(s_offset + 1 + supported_versions_len <= total_len) {
            s_offset++;
            for (i = 0; i < supported_versions_len; i += 2) {
              u_int16_t tls_version = ntohs(*((u_int16_t*)&packet->payload[s_offset + i]));
              int rc = snprintf(&ja3.client.supported_versions[i*2], sizeof(ja3.client.supported_versions) - i*2, "%02X", tls_version);
              if(rc < 0) break;
            }
#ifdef DEBUG_TLS
            printf("Client TLS [supported_versions: %s]\n", ja3.client.supported_versions);
#endif
          }
        } else if(extension_id == 44 /* encrypted server name indication */) {
          flow->protos.tls_quic.encrypted_sni.esni = 1;
#ifdef DEBUG_ENCRYPTED_SNI
          printf("Client TLS [encrypted server name indication]\n");
#endif
        } else if (extension_id == 46 /* QUIC transport parameters */) {
          u_int16_t s_offset = offset + extension_offset;
          u_int16_t quic_tp_len = ntohs(*((u_int16_t*)&packet->payload[s_offset]));
          if (s_offset + 2 + quic_tp_len <= total_len) {
            s_offset += 2;
            if (quic_version == 0x00000001 || quic_version == 0xff000001) {
              u_int16_t ua_len = ntohs(*((u_int16_t*)&packet->payload[s_offset + 4]));
              if (s_offset + 6 + ua_len <= total_len) {
                http_process_user_agent(ndpi_struct, flow, &packet->payload[s_offset + 6], ua_len);
              }
            } else if (is_version_with_var_int_transport_params(quic_version)) {
              u_int64_t ua_len64;
              if (quic_len(&packet->payload[s_offset], &ua_len64) == 0) {
                u_int16_t ua_len = ua_len64;
                u_int16_t bytes_required = quic_len_buffer_still_required(packet->payload[s_offset]);
                if (s_offset + bytes_required + ua_len <= total_len) {
                  http_process_user_agent(ndpi_struct, flow, &packet->payload[s_offset + bytes_required], ua_len);
                }
              }
            }
          }
        }