if(extension_id == 43 /* supported_versions */) {
  u_int16_t s_offset = offset+extension_offset + 1;
  u_int16_t tot_version_len = packet->payload[s_offset];
  char supported_versions[64] = {'\0'};
  u_int8_t version_str_len = 0;

  s_offset++;

  for(i=0; i<tot_version_len && s_offset+1 < total_len; i+=2) {
    u_int16_t version = ntohs(*((u_int16_t*)&packet->payload[s_offset+i]));
    int rc = snprintf(&supported_versions[version_str_len], 
                      sizeof(supported_versions)-version_str_len, 
                      "%s%x", (i > 0) ? "-" : "", version);
    if(rc > 0) version_str_len += rc;
  }

  snprintf(ja3.client.supported_versions, sizeof(ja3.client.supported_versions), "%s", supported_versions);

} else if(extension_id == 65486 /* encrypted_server_name */) {
  flow->protos.tls_quic.encrypted_sni.esni = 1;

} else if(extension_id == 65445 /* QUIC transport parameters */) {
  if(quic_version && extension_len > 0) {
    u_int16_t s_offset = offset+extension_offset;
    
    if(is_version_with_var_int_transport_params(quic_version)) {
      u_int64_t param_id;
      int len = quic_len(&packet->payload[s_offset], &param_id);
      
      s_offset += len;
      
      if(param_id == 0x3F94 /* initial_max_streams_uni */) {
        u_int64_t val;
        quic_len(&packet->payload[s_offset], &val);
        
        if(val == 3) {
          if(http_process_user_agent(ndpi_struct, flow, &packet->payload[s_offset+len], extension_len-len) != 0)
            flow->http.detected_os = ndpi_strdup("iOS");
        }
      }
    }
  }
}