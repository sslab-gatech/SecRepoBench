else if(extension_id == 43 /* supported versions */) {
  u_int16_t s_offset = offset+extension_offset + 1;
  u_int8_t supported_versions_len = 0;
  
  if(s_offset < total_len) {
    supported_versions_len = packet->payload[s_offset];
    s_offset++;
    
#ifdef DEBUG_TLS
    printf("Client TLS [SupportedVersions: block_len=%u/len=%u]\n", extension_len, supported_versions_len);
#endif
    
    if((s_offset + supported_versions_len) <= total_len) {
      for(i=0; i<supported_versions_len; i+=2) {
        if((s_offset+i+1) < total_len) {
          u_int16_t tls_version = ntohs(*((u_int16_t*)&packet->payload[s_offset+i]));
          
#ifdef DEBUG_TLS
          printf("Client TLS [TLS version: 0x%04X]\n", tls_version);
#endif
          
          if(strlen(ja3.client.supported_versions) < (sizeof(ja3.client.supported_versions)-4)) {
            int rc = snprintf(&ja3.client.supported_versions[strlen(ja3.client.supported_versions)], 
                             sizeof(ja3.client.supported_versions) - strlen(ja3.client.supported_versions),
                             "%s%04X", (i > 0) ? "-" : "", tls_version);
            
            if(rc < 0) break;
          }
        }
      }
    }
  }
} else if(extension_id == 65486 /* encrypted_server_name */) {
  if(extension_len > 0) {
    flow->protos.tls_quic.encrypted_sni.esni = 1;
    
#ifdef DEBUG_TLS
    printf("Client TLS [EncryptedServerName: len=%u]\n", extension_len);
#endif
  }
} else if(extension_id == 0x0039 /* QUIC transport parameters */ && 
          (offset+extension_offset+extension_len) <= total_len) {
  /* Used by QUIC to carry parameters */
  u_int16_t s_offset = offset+extension_offset;
  u_int16_t user_agent_len = 0, ua_offset = 0;
  
#ifdef DEBUG_TLS
  printf("Client TLS [QUIC transport parameters: extension_len=%u]\n", extension_len);
#endif
  
  /* Try to detect the User Agent if present */
  for(i=0; i<extension_len-3; i++) {
    if((packet->payload[s_offset+i] == 'U') && 
       (packet->payload[s_offset+i+1] == 'A') &&
       (packet->payload[s_offset+i+2] == '-')) {
      ua_offset = s_offset+i+3;
      
      while((ua_offset < (s_offset+extension_len)) && (packet->payload[ua_offset] != 0x00)) {
        user_agent_len++;
        ua_offset++;
      }
      
      if(user_agent_len > 0) {
        char ua[256];
        
        user_agent_len = ndpi_min(user_agent_len, sizeof(ua)-1);
        strncpy(ua, (const char*)&packet->payload[s_offset+i+3], user_agent_len);
        ua[user_agent_len] = '\0';
        
        if(flow->http.detected_os == NULL) {
          flow->http.detected_os = ndpi_strdup(ua);
#ifdef DEBUG_TLS
          printf("[QUIC] User Agent: %s\n", flow->http.detected_os);
#endif
        }
      }
      
      break;
    }
  }
}