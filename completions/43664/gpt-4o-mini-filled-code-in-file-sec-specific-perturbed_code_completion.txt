if(extension_id == 43 /* supported versions */) {
		if(extension_len >= 2) {
		  u_int16_t tls_version = ntohs(*((u_int16_t*)&packet->payload[offset+4]));

#ifdef DEBUG_TLS
		  printf("Client TLS [supported version: 0x%04X]\n", tls_version);
#endif

		  if(tls_version > flow->protos.tls_quic.ssl_version) {
		    flow->protos.tls_quic.ssl_version = tls_version;
		  }
		}
	      } else if(extension_id == 0 /* server name */) {
		u_int16_t len;

#ifdef DEBUG_TLS
		printf("[TLS] Extensions: found server name\n");
#endif
		if((offset+extension_offset+4) < packet->payload_packet_len) {
		  len = (packet->payload[offset+extension_offset+3] << 8) + packet->payload[offset+extension_offset+4];

		  if((offset+extension_offset+5+len) <= packet->payload_packet_len) {
		    char *sni = ndpi_hostname_sni_set(flow, &packet->payload[offset+extension_offset+5], len);
		    int sni_len = strlen(sni);
#ifdef DEBUG_TLS
		    printf("[TLS] SNI: [%s]\n", sni);
#endif
		    if(ndpi_is_printable_string(sni, sni_len) == 0) {
		      ndpi_set_risk(ndpi_struct, flow, NDPI_INVALID_CHARACTERS);
		    }
		  } else {
#ifdef DEBUG_TLS
		    printf("[TLS] Extensions server len too short: %u vs %u\n",
			   offset+extension_offset+5+len,
			   packet->payload_packet_len);
#endif
		  }
		}
	      } else if(extension_id == 51 /* encrypted server name */) {
		// Handle encrypted server name if present
		// This is a placeholder for future implementation
#ifdef DEBUG_TLS
		printf("[TLS] Found encrypted server name extension\n");
#endif
	      } else if(extension_id == 0xFF /* QUIC transport parameters */) {
		// Handle QUIC transport parameters if present
		// This is a placeholder for future implementation
#ifdef DEBUG_TLS
		printf("[TLS] Found QUIC transport parameters extension\n");
#endif
	      }