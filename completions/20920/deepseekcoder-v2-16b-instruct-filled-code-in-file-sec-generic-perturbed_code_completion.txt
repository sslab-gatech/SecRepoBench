{
            image->chromaticity.white_x=chromaticity[0];
            image->chromaticity.white_y=chromaticity[1];
          }
      }
    if (TIFFGetField(tiff,TIFFTAG_PRIMARYCHROMA,&chromaticity) == 1)
      {
        if (chromaticity != (float *) NULL)
          {
            image->chromaticity.red_x=chromaticity[0];
            image->chromaticity.red_y=chromaticity[1];
          }
      }
    if (TIFFGetField(tiff,TIFFTAG_SECONDPARAMETRIC,&chromaticity) == 1)
      {
        if (chromaticity != (float *) NULL)
          {
            image->chromaticity.green_x=chromaticity[0];
            image->chromaticity.green_y=chromaticity[1];
          }
      }
    if (TIFFGetField(tiff,TIFFTAG_MATRIXROWS,&value) == 1)
      {
        if (value == 3)
          {
            if (TIFFGetField(tiff,TIFFTAG_MATRIXCOLUMNS,&value) == 1)
            {
              if (value == 3)
                {
                  if (TIFFGetField(tiff,TIFFTAG_MATRIX,&chromaticity) == 1)
                  {
                    if (chromaticity != (float *) NULL)
                      {
                        image->chromaticity.blue_x=chromaticity[0];
                        image->chromaticity.blue_y=chromaticity[1];
                        image->chromaticity.matrix[0]=chromaticity[2];
                        image->chromaticity.matrix[1]=chromaticity[3];
                        image->chromaticity.matrix[2]=chromaticity[4];
                        image->chromaticity.matrix[3]=chromaticity[5];
                        image->chromaticity.matrix[4]=chromaticity[6];
                        image->chromaticity.matrix[5]=chromaticity[7];
                      }
                }
              }
            }
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SOFTWARE,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:software",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ARTIST,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:artist",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_COPYRIGHT,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:copyright",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_DATETIME,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:timestamp",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_DOCUMENTNAME,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:document",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_HOSTCOMPUTER,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:hostcomputer",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_IMAGEDESCRIPTION,&value,sans) == 1)
      (void) SetImageProperty(image,"comment",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_MAKE,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:make",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_MODEL,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:model",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_OPIIMAGEID,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:image-id",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PAGENAME,&value,sans) == 1)
      (void) SetImageProperty(image,"label",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SOFTWARE,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:software",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,33423,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:kodak-33423",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,36867,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:kodak-36867",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBFILETYPE,&value) == 1)
      {
        switch (value)
        {
          case 0x01:
            (void) SetImageProperty(image,"tiff:subfiletype","REDUCEDIMAGE",
              exception);
            break;
          case 0x02:
            (void) SetImageProperty(image,"tiff:subfiletype","PAGE",exception);
            break;
          case 0x04:
            (void) SetImageProperty(image,"tiff:subfiletype","MASK",exception);
            break;
          default:
            break;
        }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SOFTWARE,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:software",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ARTIST,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:artist",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_COPYRIGHT,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:copyright",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_DATETIME,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:timestamp",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_DOCUMENTNAME,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:document",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_HOSTCOMPUTER,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:hostcomputer",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_IMAGEDESCRIPTION,&value,sans) == 1)
      (void) SetImageProperty(image,"comment",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_MAKE,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:make",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_MODEL,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:model",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_OPIIMAGEID,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:image-id",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PAGENAME,&value,sans) == 1)
      (void) SetImageProperty(image,"label",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SOFTWARE,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:software",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,33423,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:kodak-33423",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,36867,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:kodak-36867",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBFILETYPE,&value) == 1)
      {
        switch (value)
        {
          case 0x01:
            (void) SetImageProperty(image,"tiff:subfiletype","REDUCEDIMAGE",
              exception);
            break;
          case 0x02:
            (void) SetImageProperty(image,"tiff:subfiletype","PAGE",exception);
            break;
          case 0x04:
            (void) SetImageProperty(image,"tiff:subfiletype","MASK",exception);
            break;
          default:
            break;
        }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SOFTWARE,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:software",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ARTIST,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:artist",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_COPYRIGHT,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:copyright",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_DATETIME,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:timestamp",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_DOCUMENTNAME,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:document",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_HOSTCOMPUTER,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:hostcomputer",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_IMAGEDESCRIPTION,&value,sans) == 1)
      (void) SetImageProperty(image,"comment",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_MAKE,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:make",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_MODEL,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:model",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_OPIIMAGEID,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:image-id",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PAGENAME,&value,sans) == 1)
      (void) SetImageProperty(image,"label",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SOFTWARE,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:software",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,33423,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:kodak-33423",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,36867,&value,sans) == 1)
      (void) SetImageProperty(image,"tiff:kodak-36867",(char *) value,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBFILETYPE,&value) == 1)
      {
        switch (value)
        {
          case 0x01:
            (void) SetImageProperty(image,"tiff:subfiletype","REDUCEDIMAGE",
              exception);
            break;
          case 0x02:
            (void) SetImageProperty(image,"tiff:subfiletype","PAGE",exception);
            break;
          case 0x04:
            (void) SetImageProperty(image,"tiff:subfiletype","MASK",exception);
            break;
          default:
            break;
        }
      }
    if (TIFFGetFieldDefaulted(tiff