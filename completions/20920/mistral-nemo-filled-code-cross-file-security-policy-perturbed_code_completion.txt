if (profile != (unsigned char *) NULL)
    {
      size_t
        length;

      length=TIFFGetField(tiff,TIFFTAG_ICCPROFILE,&length,&profile) == 1 ? length : 0;
      if (length > 0)
        {
          StringInfo
            *profile_info;

          profile_info=BlobToStringInfo(profile,length);
          if (profile_info != (StringInfo *) NULL)
            {
              const char
                *profile_type;

              profile_type=GetImageProfile(image,"icc");
              if (profile_type != (const char *) NULL)
                ConcatenateStringInfo(profile_info,profile_info);
              else
                {
                  status=SetImageProfile(image,"icc",profile_info,exception);
                  if (status == MagickFalse)
                    ThrowTIFFException(ResourceLimitError,"MemoryAllocationFailed");
                }
              profile_info=DestroyStringInfo(profile_info);
            }
        }
    }