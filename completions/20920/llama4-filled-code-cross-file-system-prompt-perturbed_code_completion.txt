uint16
  photoshop;

photoshop=TIFFGetField(tiff,TIFFTAG_RICHTIFFIPTC,&length,&profile) != 0 ? 
  TIFFIsMSBEndian(tiff) : 0;
if ((photoshop != 0) && (profile != (unsigned char *) NULL))
{
  if (photoshop == TIFFIsMSBEndian(tiff))
    status=ReadProfile(img,"iptc",profile,(ssize_t) length,exception);
  else
    {
      /*
        Check if the TIFF file is byte-swapped and, if so, swap the byte order of the IPTC profile data.
      */
      unsigned char
        *swap_profile;

      swap_profile=(unsigned char *) AcquireQuantumMemory(length,
        sizeof(*swap_profile));
      if (swap_profile != (unsigned char *) NULL)
      {
        register ssize_t
          i;

        for (i=0; i < (ssize_t) length; i++)
          swap_profile[i]=profile[length-(i+1)];
        status=ReadProfile(img,"iptc",swap_profile,(ssize_t) length,exception);
        swap_profile=(unsigned char *) RelinquishMagickMemory(swap_profile);
      }
    }
}