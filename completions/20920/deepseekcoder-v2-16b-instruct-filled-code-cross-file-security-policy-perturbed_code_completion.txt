if ((TIFFGetField(tiff,TIFFTAG_RICHTIFFIPTC,&length,&profile) == 1) &&
        (profile != (unsigned char *) NULL))
    {
      // Check if the TIFF file is byte-swapped and, if so, swap the byte order of the IPTC profile data.
      // Read the IPTC profile into the image.
      if (IsBigEndian() != 0) {
        // Swap byte order if necessary
        uint16 *iptc_data = (uint16 *)profile;
        size_t num_elements = length / sizeof(uint16);
        for (size_t i = 0; i < num_elements; ++i) {
          iptc_data[i] = ByteSwap(iptc_data[i]);
        }
      }
      status = ReadProfile(img, "iptc", profile, (ssize_t)length, exception);
    }