def fill_masked_region(image, draw_info, exception):
    """
    Fill in the masked region based on the provided context.

    Args:
        image (Image): The image to be modified.
        draw_info (DrawInfo): The draw info containing the graphic context.
        exception (ExceptionInfo): The exception info.

    Returns:
        MagickBooleanType: MagickTrue if the operation was successful, MagickFalse otherwise.
    """
    assert(image != (Image *) NULL)
    assert(image->signature == MagickCoreSignature)
    assert(draw_info != (DrawInfo *) NULL)
    assert(draw_info->signature == MagickCoreSignature)
    assert(exception != (ExceptionInfo *) NULL)
    assert(exception->signature == MagickCoreSignature)

    if (image->debug != MagickFalse):
        (void) LogMagickEvent(TraceEvent, GetMagickModule(), "%s", image->filename)

    if (draw_info->clip_mask != (char *) NULL):
        if (LocaleCompare(draw_info->clip_mask, draw_info->clip_mask) != 0):
            (void) SetImageMask(image, ReadPixelMask, (Image *) NULL, exception)

    if (draw_info->render != MagickFalse):
        if (draw_info->primitive == (char *) NULL):
            return(MagickFalse)

        primitive = AcquireString(draw_info->primitive)
        extent = strlen(primitive) + MagickPathExtent
        if (SetImageStorageClass(image, DirectClass, exception) == MagickFalse):
            return(MagickFalse)

        n = 0
        j = 0
        number_points = 2047
        primitive_info = AcquireQuantumMemory(number_points, sizeof(*primitive_info))
        if (primitive_info == (PrimitiveInfo *) NULL):
            ThrowBinaryException(ResourceLimitError, "MemoryAllocationFailed",
                                 image->filename)
            return(MagickFalse)

        GetAffineMatrix(&affine)
        token = AcquireString(primitive)
        extent = strlen(token) + MagickPathExtent
        active = MagickFalse
        status = MagickTrue
        for (q = (const char *) primitive; *q != '\0'; ):
            GetNextToken(q, &q, MagickPathExtent, keyword)
            if (*keyword == '\0'):
                break
            if (*keyword == '#'):
                if (active != MagickFalse):
                    AffineToTransform(image, &affine)
                    active = MagickFalse
                (void) WriteBlobString(image, "<desc>")
                (void) WriteBlobString(image, keyword + 1)
                for ( ; (*q != '\n') && (*q != '\0'); q++):
                    switch (*q):
                        case '<': (void) WriteBlobString(image, "&lt;"); break
                        case '>': (void) WriteBlobString(image, "&gt;"); break
                        case '&': (void) WriteBlobString(image, "&amp;"); break
                        default: (void) WriteBlobByte(image, *q); break
                (void) WriteBlobString(image, "</desc>\n")
                continue

            p = q
            primitive_type = UndefinedPrimitive
            current = affine
            GetAffineMatrix(&affine)
            switch (*keyword):
                # ... (rest of the switch statement)
                default:
                    status = MagickFalse
                    break

            if (status == MagickFalse):
                break

            if (primitive_info == (PrimitiveInfo *) NULL):
                break

            primitive_info[j].primitive = primitive_type
            primitive_info[j].coordinates = 0
            primitive_info[j].method = FloodfillMethod
            primitive_info[j].text = (char *) NULL
            i = 0
            j = 0
            for (x = 0; *q != '\0'; x++):
                # ... (rest of the loop)
                primitive_info[i].primitive = primitive_type
                primitive_info[i].point = point
                primitive_info[i].coordinates = 0
                primitive_info[i].method = FloodfillMethod
                i++
                if (i < (ssize_t) (number_points - 6 * BezierQuantum - 360)):
                    continue
                number_points += 6 * BezierQuantum + 360
                primitive_info = ResizeQuantumMemory(primitive_info,
                                                    number_points,
                                                    sizeof(*primitive_info))
                if (primitive_info == (PrimitiveInfo *) NULL):
                    ThrowBinaryException(ResourceLimitError, "MemoryAllocationFailed",
                                         image->filename)
                    break

            primitive_info[j].primitive = primitive_type
            primitive_info[j].coordinates = x
            primitive_info[j].method = FloodfillMethod
            primitive_info[j].text = (char *) NULL
            if (active):
                AffineToTransform(image, &affine)
                active = MagickFalse
            active = MagickFalse
            switch (primitive_type):
                # ... (rest of the switch statement)
                default:
                    break

            if (primitive_info == (PrimitiveInfo *) NULL):
                break

            primitive_info[i].primitive = UndefinedPrimitive
            if (status == 0):
                break

            if (primitive_info->text != (char *) NULL):
                primitive_info->text = (char *) RelinquishMagickMemory(
                    primitive_info->text)

            proceed = SetImageProgress(image, RenderImageTag, q - primitive,
                                      (MagickSizeType) primitive_extent)
            if (proceed == MagickFalse):
                break

            if (status == 0):
                break

            if (primitive_info->primitive == ImagePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == TextPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == AlphaPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == ColorPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == PointPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == LinePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == RectanglePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == RoundRectanglePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == ArcPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == EllipsePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == CirclePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == PolylinePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == PolygonPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == BezierPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == PathPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == TextPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == ImagePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == AlphaPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == ColorPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == PointPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == LinePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == RectanglePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == RoundRectanglePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == ArcPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == EllipsePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == CirclePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == PolylinePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == PolygonPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == BezierPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == PathPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == TextPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == ImagePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == AlphaPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == ColorPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == PointPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == LinePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == RectanglePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == RoundRectanglePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == ArcPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == EllipsePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == CirclePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == PolylinePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == PolygonPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == BezierPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == PathPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == TextPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == ImagePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == AlphaPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == ColorPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == PointPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == LinePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == RectanglePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == RoundRectanglePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == ArcPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == EllipsePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == CirclePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == PolylinePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == PolygonPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == BezierPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == PathPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == TextPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == ImagePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == AlphaPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == ColorPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == PointPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == LinePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == RectanglePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == RoundRectanglePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == ArcPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == EllipsePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == CirclePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == PolylinePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == PolygonPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == BezierPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == PathPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == TextPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == ImagePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == AlphaPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == ColorPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == PointPrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == LinePrimitive):
                # ... (rest of the code)

            if (primitive_info->primitive == RectanglePrimitive):
                # ... (rest of the code)

            if (primitive_info-