int32_t ntbytes = 0;
  int32_t cbytes;
  int32_t last_filter_index = -1;

  for (int j = 0; j < context->nblocks; j++) {
    bsize = context->blocksize;
    leftoverblock = 0;
    if ((j == context->nblocks - 1) && (context->leftover > 0)) {
      bsize = context->leftover;
      leftoverblock = 1;
    }

    cbytes = blosc_d(thread_context, bsize, leftoverblock,
                     src, srcsize, sw32_(context->bstarts + j),
                     dest, destinationoffset + ntbytes, tmp, tmp2);
    if (cbytes < 0) {
      return cbytes;         /* error in blosc_d */
    }
    ntbytes += cbytes;

    // Determine the last filter index used
    if (filters[j] != BLOSC_NOFILTER) {
      last_filter_index = j;
    }
  }