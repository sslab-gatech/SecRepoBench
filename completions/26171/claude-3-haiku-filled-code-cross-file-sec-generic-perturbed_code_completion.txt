for (int j = 0; j < nstreams; j++) {
  int32_t cbytes = sw32_(src + stream_offset);
  stream_offset += 4;
  if (cbytes == 0) {
    /* Uncompressed data */
    memcpy(dest + destinationoffset, src + stream_offset, (unsigned int)bsize);
    stream_offset += bsize;
    ntbytes += bsize;
  }
  else if (cbytes < 0) {
    /* Error in decompression */
    return cbytes;
  }
  else {
    /* Compressed data */
    int32_t outsize = bsize;
    int dres = blosc_decompress_ctx(src + stream_offset, dest + destinationoffset,
                                   (size_t)outsize, context->nthreads);
    if (dres < 0) {
      /* Error in decompression */
      return dres;
    }
    stream_offset += cbytes;
    ntbytes += dres;
  }
  destinationoffset += bsize;
}