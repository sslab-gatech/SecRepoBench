int32_t ntbytes = 0;
  int32_t nstreams = context->nstreams;
  int32_t compressed_size;
  uint8_t* compressed_data;
  
  for (int32_t j = 0; j < nstreams; j++) {
    compressed_size = sw32_(src + src_offset + j * sizeof(int32_t));
    compressed_data = src + src_offset + j * sizeof(int32_t) + sizeof(int32_t);
    
    if (compressed_size < 0) {
      return compressed_size; // Error in compressed size
    }
    
    // Decompress the data based on the compression format
    int32_t result = decompress_data(compformat, compressed_data, compressed_size, dest + ntbytes);
    if (result < 0) {
      return result; // Error during decompression
    }
    
    ntbytes += result; // Accumulate the number of uncompressed bytes
  }