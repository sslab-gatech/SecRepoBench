int32_t ntbytes = 0; // Initialize the number of uncompressed bytes
  int32_t last_filter_index = -1; // Initialize last filter index
  int32_t nstreams = context->nstreams; // Get the number of streams

  for (int32_t j = 0; j < nstreams; j++) {
    // Read the compressed size for the current stream
    int32_t cbytes = sw32_(src + src_offset + j * sizeof(int32_t));
    if (cbytes < 0) {
      return -1; // Error in reading compressed size
    }

    // Decompress the data for the current stream
    int32_t result = blosc_d(thread_context, bsize, leftoverblock,
                             src, srcsize, src_offset + j * cbytes,
                             dest, destinationoffset + ntbytes, tmp, tmp2);
    if (result < 0) {
      return result; // Return error code if decompression fails
    }

    ntbytes += result; // Accumulate the number of uncompressed bytes
  }

  // Check for any filters applied and process them
  if (filters != NULL) {
    last_filter_index = get_last_filter_index(filters);
  }