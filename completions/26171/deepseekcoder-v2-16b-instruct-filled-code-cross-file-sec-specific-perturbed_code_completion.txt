// Iterate over each stream and for each stream, read the compressed size and
  // decompress the data using the appropriate decompression format.
  // Handle cases of runs, uncompressed data, or compressed data based on the
  // compressed byte size.
  // Accumulate the total number of compressed and uncompressed bytes for the block.
  // If successful, the number of uncompressed bytes is returned; otherwise,
  // appropriate error codes are returned to indicate failure.

  for (int32_t i = 0; i < context->nstreams; i++) {
    int32_t compressed_size = read_compressed_size(src, srcsize, src_offset);
    if (compressed_size < 0) {
      return compressed_size; // Return error code if reading compressed size fails
    }

    int32_t decompressed_size = decompress_data(src, srcsize, src_offset, dest, destinationoffset, tmp, tmp2);
    if (decompressed_size < 0) {
      return decompressed_size; // Return error code if decompression fails
    }

    // Accumulate the total number of compressed and uncompressed bytes for the block
    total_compressed_bytes += compressed_size;
    total_uncompressed_bytes += decompressed_size;
  }

  // Return the number of uncompressed bytes
  return (int)total_uncompressed_bytes;