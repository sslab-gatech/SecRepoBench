/* Closes j < nstreams */
  for (j = 0; j < nstreams; j++) {
    int32_t csize = sw32_(src + 12 + j * context->blocksize); /* compressed buffer size */
    if (csize <= 0) {
      return -1; /* error: invalid compressed buffer size */
    }
    if (srcsize < BLOSC_MAX_OVERHEAD + (j * context->blocksize) + csize) {
      /* Not enough input to decompress block */
      return -1;
    }
    int32_t dsize = blosc_d(thread_context, csize, 0, src + BLOSC_MAX_OVERHEAD + j * context->blocksize,
                            csize, 0, dest + j * context->blocksize, 0, tmp, tmp2);
    if (dsize < 0) {
      return dsize; /* error in blosc_d */
    }
    ntbytes += dsize;
  }
  return ntbytes;