int32_t nstreams = context->nstreams;
  int32_t ntbytes = 0;
  int32_t compressed_size;
  uint8_t* src_ptr = (uint8_t*)src + src_offset;

  for (int32_t j = 0; j < nstreams; j++) {
    // Read the compressed size for the current stream
    compressed_size = sw32_(src_ptr);
    src_ptr += sizeof(int32_t); // Move past the size header

    if (compressed_size < 0) {
      return compressed_size; // Error in compressed size
    }

    // Decompress the data for the current stream
    int32_t cbytes = blosc_d(thread_context, bsize, leftoverblock,
                             src_ptr, compressed_size, 0,
                             dest, destinationoffset + ntbytes, tmp, tmp2);
    
    if (cbytes < 0) {
      return cbytes; // Error during decompression
    }

    ntbytes += cbytes; // Accumulate the total uncompressed bytes
    src_ptr += compressed_size; // Move to the next stream
  }