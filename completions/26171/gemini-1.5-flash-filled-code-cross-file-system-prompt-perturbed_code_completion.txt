int32_t j, nstreams, last_filter_index = -1;
  int32_t cbytes;
  int32_t ntbytes = 0;
  int32_t* bstarts = context->bstarts;
  uint8_t* tmp3 = thread_context->tmp4;
  uint8_t* dest_ptr = dest + destinationoffset;
  nstreams = context->nstreams;
  for (j = 0; j < nstreams; j++) {
    int32_t csize = sw32_(context->src + 12 + j * 4); /* compressed buffer size */
    int32_t uncompressed_size = sw32_(context->src + 16 + j * 4); /* uncompressed buffer size */
    int32_t src_offset_j = sw32_(bstarts + j);
    uint8_t* src_ptr = context->src + src_offset_j;
    if (csize == 0) {
      /* uncompressible data */
      if (uncompressed_size > 0) {
        memcpy(dest_ptr, src_ptr, (unsigned int)uncompressed_size);
        ntbytes += uncompressed_size;
      }
      continue;
    }
    if (csize < 0) {
      /* error in blosc_c or blosc_d */
      return csize;
    }
    if (csize == uncompressed_size) {
      /* uncompressed data */
      memcpy(dest_ptr, src_ptr, (unsigned int)uncompressed_size);
      ntbytes += uncompressed_size;
      continue;
    }
    if (get_run(src_ptr, src_ptr + csize)) {
      /* run */
      uint8_t x = *src_ptr;
      memset(dest_ptr, x, (unsigned int)uncompressed_size);
      ntbytes += uncompressed_size;
      continue;
    }
    /* compressed data */
    cbytes = blosc_decompress(context, compformat, uncompressed_size, src_ptr, csize, dest_ptr, tmp, tmp2, tmp3);
    if (cbytes < 0) {
      return cbytes;
    }
    ntbytes += cbytes;
    last_filter_index = context->last_filter_index;
    dest_ptr += cbytes;
  }