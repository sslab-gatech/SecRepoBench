// Validate source pointer position and remaining size
  if (src + src_offset < src_boundary || src_offset + nbytes > srcsize) {
    return BLOSC_ERROR_INVALID_ARGS;
  }

  // Read compressed size
  int32_t csize = sw32_(src + src_offset);
  if (csize < 0 || csize > srcsize - src_offset) {
    return BLOSC_ERROR_INVALID_ARGS;
  }

  // Check if it's a run
  if (get_run(src + src_offset + 4, src + src_offset + csize)) {
    // Copy run data to destination
    memcpy(dest + destinationoffset, src + src_offset + 4, (unsigned int)csize - 4);
    return csize;
  }

  // Decompress data using appropriate decompression format
  int32_t ntbytes = blosc_d_decompress(context, bsize, leftoverblock, src + src_offset + 4, csize - 4, dest, destinationoffset + 4, tmp, tmp2);
  if (ntbytes < 0) {
    return ntbytes;
  }

  // Update remaining size and return total decompressed bytes
  src_offset += csize;
  return ntbytes + 4;
}