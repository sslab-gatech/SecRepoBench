/* Closes j < nblocks */
for (j = 0; j < context->nblocks; j++) {
  bsize = context->blocksize;
  leftoverblock = 0;
  if ((j == context->nblocks - 1) && (context->leftover > 0)) {
    bsize = context->leftover;
    leftoverblock = 1;
  }
  cbytes = blosc_d(thread_context, bsize, leftoverblock,
                   context->src, context->srcsize, sw32_(bstarts + j),
                   dest, destinationoffset + j * context->blocksize, tmp, tmp2);
  if (cbytes < 0) {
    return cbytes;  /* error in blosc_d */
  }
  ntbytes += cbytes;
}