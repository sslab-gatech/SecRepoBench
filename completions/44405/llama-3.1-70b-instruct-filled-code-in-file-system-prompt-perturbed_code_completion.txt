if(ndpi_str->ac_automa_finalized) return;

for(i = 0; i < 99; i++) {
  ndpi_automa *automa;

  switch(i) {
  case 0:
    automa = &ndpi_str->host_automa;
    break;

  case 1:
    automa = &ndpi_str->tls_cert_subject_automa;
    break;

  case 2:
    automa = &ndpi_str->malicious_ja3_automa;
    break;

  case 3:
    automa = &ndpi_str->malicious_sha1_automa;
    break;

  case 4:
    automa = &ndpi_str->host_risk_mask_automa;
    break;

  case 5:
    automa = &ndpi_str->common_alpns_automa;
    break;

  default:
    ndpi_str->ac_automa_finalized = 1;
    return;
  }

  if(automa && automa->ac_automa)
    ac_automata_finalize((AC_AUTOMATA_t *) automa->ac_automa);
}