} else if(network_packet_struct->line[network_packet_struct->parsed_lines].len > 15 &&
          strncasecmp((const char *)network_packet_struct->line[network_packet_struct->parsed_lines].ptr,
                      "Authorization: ", 15) == 0) {
  /* "Authorization:" header line in HTTP */
  if(network_packet_struct->line[network_packet_struct->parsed_lines].ptr[14] == ' ') {
    network_packet_struct->authorization_line.ptr =
      &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[15];
    network_packet_struct->authorization_line.len =
      network_packet_struct->line[network_packet_struct->parsed_lines].len - 15;
  } else {
    network_packet_struct->authorization_line.ptr =
      &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[14];
    network_packet_struct->authorization_line.len =
      network_packet_struct->line[network_packet_struct->parsed_lines].len - 14;
  }
  network_packet_struct->http_num_headers++;
} else if(network_packet_struct->line[network_packet_struct->parsed_lines].len > 7 &&
          strncasecmp((const char *)network_packet_struct->line[network_packet_struct->parsed_lines].ptr,
                      "Accept:", 7) == 0) {
  /* "Accept:" header line */
  if(network_packet_struct->line[network_packet_struct->parsed_lines].ptr[6] == ' ') {
    network_packet_struct->accept_line.ptr =
      &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[7];
    network_packet_struct->accept_line.len =
      network_packet_struct->line[network_packet_struct->parsed_lines].len - 7;
  } else {
    network_packet_struct->accept_line.ptr =
      &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[6];
    network_packet_struct->accept_line.len =
      network_packet_struct->line[network_packet_struct->parsed_lines].len - 6;
  }
  network_packet_struct->http_num_headers++;
} else if(network_packet_struct->line[network_packet_struct->parsed_lines].len > 8 &&
          strncasecmp((const char *)network_packet_struct->line[network_packet_struct->parsed_lines].ptr,
                      "Referer:", 8) == 0) {
  /* "Referer:" header line */
  if(network_packet_struct->line[network_packet_struct->parsed_lines].ptr[7] == ' ') {
    network_packet_struct->referer_line.ptr =
      &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[8];
    network_packet_struct->referer_line.len =
      network_packet_struct->line[network_packet_struct->parsed_lines].len - 8;
  } else {
    network_packet_struct->referer_line.ptr =
      &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[7];
    network_packet_struct->referer_line.len =
      network_packet_struct->line[network_packet_struct->parsed_lines].len - 7;
  }
  network_packet_struct->http_num_headers++;
} else if(network_packet_struct->line[network_packet_struct->parsed_lines].len > 11 &&
          strncasecmp((const char *)network_packet_struct->line[network_packet_struct->parsed_lines].ptr,
                      "User-Agent:", 10) == 0) {
  /* "User-Agent:" header line */
  if(network_packet_struct->line[network_packet_struct->parsed_lines].ptr[10] == ' ') {
    network_packet_struct->user_agent_line.ptr =
      &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[11];
    network_packet_struct->user_agent_line.len =
      network_packet_struct->line[network_packet_struct->parsed_lines].len - 11;
  } else {
    network_packet_struct->user_agent_line.ptr =
      &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[10];
    network_packet_struct->user_agent_line.len =
      network_packet_struct->line[network_packet_struct->parsed_lines].len - 10;
  }
  network_packet_struct->http_num_headers++;
} else if(network_packet_struct->line[network_packet_struct->parsed_lines].len > 17 &&
          strncasecmp((const char *)network_packet_struct->line[network_packet_struct->parsed_lines].ptr,
                      "Content-Encoding:", 17) == 0) {
  /* "Content-Encoding:" header line */
  if(network_packet_struct->line[network_packet_struct->parsed_lines].ptr[17] == ' ') {
    network_packet_struct->http_encoding.ptr =
      &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[18];
    network_packet_struct->http_encoding.len =
      network_packet_struct->line[network_packet_struct->parsed_lines].len - 18;
  } else {
    network_packet_struct->http_encoding.ptr =
      &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[17];
    network_packet_struct->http_encoding.len =
      network_packet_struct->line[network_packet_struct->parsed_lines].len - 17;
  }
  network_packet_struct->http_num_headers++;
} else if(network_packet_struct->line[network_packet_struct->parsed_lines].len > 18 &&
          strncasecmp((const char *)network_packet_struct->line[network_packet_struct->parsed_lines].ptr,
                      "Transfer-Encoding:", 18) == 0) {
  /* "Transfer-Encoding:" header line */
  if(network_packet_struct->line[network_packet_struct->parsed_lines].ptr[18] == ' ') {
    network_packet_struct->http_transfer_encoding.ptr =
      &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[19];
    network_packet_struct->http_transfer_encoding.len =
      network_packet_struct->line[network_packet_struct->parsed_lines].len - 19;
  } else {
    network_packet_struct->http_transfer_encoding.ptr =
      &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[18];
    network_packet_struct->http_transfer_encoding.len =
      network_packet_struct->line[network_packet_struct->parsed_lines].len - 18;
  }
  network_packet_struct->http_num_headers++;
} else if(network_packet_struct->line[network_packet_struct->parsed_lines].len > 15 &&
          strncasecmp((const char *)network_packet_struct->line[network_packet_struct->parsed_lines].ptr,
                      "Content-Length:", 15) == 0) {
  /* "Content-Length:" header line */
  if(network_packet_struct->line[network_packet_struct->parsed_lines].ptr[15] == ' ') {
    network_packet_struct->http_contentlen.ptr =
      &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[16];
    network_packet_struct->http_contentlen.len =
      network_packet_struct->line[network_packet_struct->parsed_lines].len - 16;
  } else {
    network_packet_struct->http_contentlen.ptr =
      &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[15];
    network_packet_struct->http_contentlen.len =
      network_packet_struct->line[network_packet_struct->parsed_lines].len - 15;
  }
  network_packet_struct->http_num_headers++;
} else if(network_packet_struct->line[network_packet_struct->parsed_lines].len > 20 &&
          strncasecmp((const char *)network_packet_struct->line[network_packet_struct->parsed_lines].ptr,
                      "Content-Disposition:", 20) == 0) {
  /* "Content-Disposition:" header line */
  if(network_packet_struct->line[network_packet_struct->parsed_lines].ptr[20] == ' ') {
    network_packet_struct->content_disposition_line.ptr =
      &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[21];
    network_packet_struct->content_disposition_line.len =
      network_packet_struct->line[network_packet_struct->parsed_lines].len - 21;
  } else {
    network_packet_struct->content_disposition_line.ptr =
      &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[20];
    network_packet_struct->content_disposition_line.len =
      network_packet_struct->line[network_packet_struct->parsed_lines].len - 20;
  }
  network_packet_struct->http_num_headers++;
} else if(network_packet_struct->line[network_packet_struct->parsed_lines].len > 7 &&
          strncasecmp((const char *)network_packet_struct->line[network_packet_struct->parsed_lines].ptr,
                      "Cookie:", 7) == 0) {
  /* "Cookie:" header line */
  if(network_packet_struct->line[network_packet_struct->parsed_lines].ptr[6] == ' ') {
    network_packet_struct->http_cookie.ptr =
      &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[7];
    network_packet_struct->http_cookie.len =
      network_packet_struct->line[network_packet_struct->parsed_lines].len - 7;
  } else {
    network_packet_struct->http_cookie.ptr =
      &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[6];
    network_packet_struct->http_cookie.len =
      network_packet_struct->line[network_packet_struct->parsed_lines].len - 6;
  }
  network_packet_struct->http_num_headers++;
} else if(network_packet_struct->line[network_packet_struct->parsed_lines].len > 7 &&
          strncasecmp((const char *)network_packet_struct->line[network_packet_struct->parsed_lines].ptr,
                      "Origin:", 7) == 0) {
  /* "Origin:" header line */
  if(network_packet_struct->line[network_packet_struct->parsed_lines].ptr[6] == ' ') {
    network_packet_struct->http_origin.ptr =
      &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[7];
    network_packet_struct->http_origin.len =
      network_packet_struct->line[network_packet_struct->parsed_lines].len - 7;
  } else {
    network_packet_struct->http_origin.ptr =
      &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[6];
    network_packet_struct->http_origin.len =
      network_packet_struct->line[network_packet_struct->parsed_lines].len - 6;
  }
  network_packet_struct->http_num_headers++;
} else if(network_packet_struct->line[network_packet_struct->parsed_lines].len > 15 &&
          strncasecmp((const char *)network_packet_struct->line[network_packet_struct->parsed_lines].ptr,
                      "X-Session-Type:", 15) == 0) {
  /* "X-Session-Type:" header line */
  if(network_packet_struct->line[network_packet_struct->parsed_lines].ptr[15] == ' ') {
    network_packet_struct->http_x_session_type.ptr =
      &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[16];
    network_packet_struct->http_x_session_type.len =
      network_packet_struct->line[network_packet_struct->parsed_lines].len - 16;
  } else {
    network_packet_struct->http_x_session_type.ptr =
      &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[15];
    network_packet_struct->http_x_session_type.len =
      network_packet_struct->line[network_packet_struct->parsed_lines].len - 15;
  }
  network_packet_struct->http_num_headers++;
} else if(network_packet_struct->line[network_packet_struct->parsed_lines].len >= 12 &&
          strncasecmp((const char *)network_packet_struct->line[network_packet_struct->parsed_lines].ptr,
                      "Content-Type", 11) == 0) {
  /*
   * Handle "Content-Type" header (possibly no space after the colon).
   * We'll check up to 12th char to allow "Content-Type:" or "Content-Type " forms.
   */
  const char *base_ptr = (const char *)network_packet_struct->line[network_packet_struct->parsed_lines].ptr;
  int base_len = network_packet_struct->line[network_packet_struct->parsed_lines].len;
  int offset = 11; // "Content-Type"

  /* Skip optional colon and/or space if present */
  while((offset < base_len) && (base_ptr[offset] == ':' || base_ptr[offset] == ' ')) {
    offset++;
  }
  network_packet_struct->content_line.ptr = &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[offset];
  network_packet_struct->content_line.len = base_len - offset;

  network_packet_struct->http_num_headers++;
} else {
  /* Unrecognized header line; still count it as a header. */
  network_packet_struct->http_num_headers++;
}