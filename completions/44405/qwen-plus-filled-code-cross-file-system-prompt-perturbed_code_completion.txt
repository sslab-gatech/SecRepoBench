{
  // "Authorization" header line in HTTP
  if(network_packet_struct->line[network_packet_struct->parsed_lines].ptr[15] == ' ') {
    network_packet_struct->authorization_line.ptr = &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[16];
    network_packet_struct->authorization_line.len = network_packet_struct->line[network_packet_struct->parsed_lines].len - 16;
  } else {
    network_packet_struct->authorization_line.ptr = &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[15];
    network_packet_struct->authorization_line.len = network_packet_struct->line[network_packet_struct->parsed_lines].len - 15;
  }
  network_packet_struct->http_num_headers++;

  // "Accept" header line in HTTP
  if(network_packet_struct->line[network_packet_struct->parsed_lines].len > 7 &&
     strncasecmp((const char *) network_packet_struct->line[network_packet_struct->parsed_lines].ptr, "Accept:", 7) == 0) {
    if(network_packet_struct->line[network_packet_struct->parsed_lines].ptr[7] == ' ') {
      network_packet_struct->accept_line.ptr = &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[8];
      network_packet_struct->accept_line.len = network_packet_struct->line[network_packet_struct->parsed_lines].len - 8;
    } else {
      network_packet_struct->accept_line.ptr = &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[7];
      network_packet_struct->accept_line.len = network_packet_struct->line[network_packet_struct->parsed_lines].len - 7;
    }
    network_packet_struct->http_num_headers++;
  }

  // Other headers: Referer, User-Agent, Content-Encoding, Transfer-Encoding, etc.
  // Check each header similarly to the examples above and set corresponding fields.

  // "Content-Type" header line in HTTP
  if(network_packet_struct->line[network_packet_struct->parsed_lines].len > 13 &&
     strncasecmp((const char *) network_packet_struct->line[network_packet_struct->parsed_lines].ptr, "Content-Type:", 13) == 0) {
    if(network_packet_struct->line[network_packet_struct->parsed_lines].ptr[13] == ' ') {
      network_packet_struct->content_line.ptr = &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[14];
      network_packet_struct->content_line.len = network_packet_struct->line[network_packet_struct->parsed_lines].len - 14;
    } else {
      network_packet_struct->content_line.ptr = &network_packet_struct->line[network_packet_struct->parsed_lines].ptr[13];
      network_packet_struct->content_line.len = network_packet_struct->line[network_packet_struct->parsed_lines].len - 13;
    }
    network_packet_struct->http_num_headers++;
  }

  // Handle unrecognized headers
  const char *common_headers[] = {"Accept", "Referer", "User-Agent", "Content-Encoding", "Transfer-Encoding", "Content-Length", "Content-Disposition", "Cookie", "Origin", "X-Session-Type", "Content-Type"};
  int is_common_header = 0;

  for(int i = 0; i < sizeof(common_headers)/sizeof(common_headers[0]); i++) {
    if(strncasecmp((const char *) network_packet_struct->line[network_packet_struct->parsed_lines].ptr, common_headers[i], strlen(common_headers[i])) == 0) {
      is_common_header = 1;
      break;
    }
  }

  if(!is_common_header) {
    network_packet_struct->unrecognized_header.ptr = network_packet_struct->line[network_packet_struct->parsed_lines].ptr;
    network_packet_struct->unrecognized_header.len = network_packet_struct->line[network_packet_struct->parsed_lines].len;
    network_packet_struct->http_num_headers++;
  }
}