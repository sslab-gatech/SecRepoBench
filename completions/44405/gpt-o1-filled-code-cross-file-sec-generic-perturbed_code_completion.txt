{
  /* Parse the current line into a header name and value. */
  char *line_ptr = (char *)network_packet_struct->line[network_packet_struct->parsed_lines].ptr;
  u_int16_t line_len = network_packet_struct->line[network_packet_struct->parsed_lines].len;
  char *colon_ptr = (char *)memchr(line_ptr, ':', line_len);

  if(colon_ptr != NULL) {
    /* Calculate header name and value boundaries. */
    u_int16_t header_name_len = (u_int16_t)(colon_ptr - line_ptr);
    char *value_ptr = colon_ptr + 1;
    u_int16_t value_len = (u_int16_t)(line_len - (header_name_len + 1));

    /* Trim leading spaces from header value. */
    while((value_len > 0) && (*value_ptr == ' ' || *value_ptr == '\t')) {
      value_ptr++;
      value_len--;
    }

    /* Helper macro to match known headers (case-insensitive). */
    #define HEADER_MATCH(str) \
      ((header_name_len == (sizeof(str) - 1)) && \
       (strncasecmp(line_ptr, str, (sizeof(str) - 1)) == 0))

    /* Check and store known headers. */
    if(HEADER_MATCH("Authorization")) {
      network_packet_struct->authorization_line.ptr = (u_int8_t *)value_ptr;
      network_packet_struct->authorization_line.len = value_len;
      network_packet_struct->http_num_headers++;
    } else if(HEADER_MATCH("Accept")) {
      network_packet_struct->accept_line.ptr = (u_int8_t *)value_ptr;
      network_packet_struct->accept_line.len = value_len;
      network_packet_struct->http_num_headers++;
    } else if(HEADER_MATCH("Referer")) {
      network_packet_struct->referer_line.ptr = (u_int8_t *)value_ptr;
      network_packet_struct->referer_line.len = value_len;
      network_packet_struct->http_num_headers++;
    } else if(HEADER_MATCH("User-Agent")) {
      network_packet_struct->user_agent_line.ptr = (u_int8_t *)value_ptr;
      network_packet_struct->user_agent_line.len = value_len;
      network_packet_struct->http_num_headers++;
    } else if(HEADER_MATCH("Content-Encoding")) {
      network_packet_struct->content_encoding_line.ptr = (u_int8_t *)value_ptr;
      network_packet_struct->content_encoding_line.len = value_len;
      network_packet_struct->http_num_headers++;
    } else if(HEADER_MATCH("Transfer-Encoding")) {
      network_packet_struct->transfer_encoding_line.ptr = (u_int8_t *)value_ptr;
      network_packet_struct->transfer_encoding_line.len = value_len;
      network_packet_struct->http_num_headers++;
    } else if(HEADER_MATCH("Content-Length")) {
      network_packet_struct->content_length_line.ptr = (u_int8_t *)value_ptr;
      network_packet_struct->content_length_line.len = value_len;
      network_packet_struct->http_num_headers++;
    } else if(HEADER_MATCH("Content-Disposition")) {
      network_packet_struct->content_disposition_line.ptr = (u_int8_t *)value_ptr;
      network_packet_struct->content_disposition_line.len = value_len;
      network_packet_struct->http_num_headers++;
    } else if(HEADER_MATCH("Cookie")) {
      network_packet_struct->cookie_line.ptr = (u_int8_t *)value_ptr;
      network_packet_struct->cookie_line.len = value_len;
      network_packet_struct->http_num_headers++;
    } else if(HEADER_MATCH("Origin")) {
      network_packet_struct->origin_line.ptr = (u_int8_t *)value_ptr;
      network_packet_struct->origin_line.len = value_len;
      network_packet_struct->http_num_headers++;
    } else if(HEADER_MATCH("X-Session-Type")) {
      network_packet_struct->x_session_type_line.ptr = (u_int8_t *)value_ptr;
      network_packet_struct->x_session_type_line.len = value_len;
      network_packet_struct->http_num_headers++;
    } else if(HEADER_MATCH("Content-Type")) {
      /* Handle "Content-Type" even if it lacks a space after the colon. */
      network_packet_struct->content_line.ptr = (u_int8_t *)value_ptr;
      network_packet_struct->content_line.len = value_len;
      network_packet_struct->http_num_headers++;
    } else {
      /* Unrecognized header â€“ still count it. */
      network_packet_struct->http_num_headers++;
    }
  } else {
    /* No colon found, treat as unrecognized header line. */
    network_packet_struct->http_num_headers++;
  }
}