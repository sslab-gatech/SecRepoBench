// Mask sensitive data in log messages
#define MASK_SENSITIVE_DATA(msg, data) do { \
  char *p = strstr(msg, data); \
  if (p) { \
    size_t len = strlen(p); \
    memset(p, '*', len); \
  } \
} while (0)