{
  char *line_ptr = (char *)network_packet_struct->line[network_packet_struct->parsed_lines].ptr;
  u_int16_t line_len = network_packet_struct->line[network_packet_struct->parsed_lines].len;
  char *colon_ptr = memchr(line_ptr, ':', line_len);
  if(colon_ptr != NULL) {
    int key_len = colon_ptr - line_ptr;
    char *value_ptr = colon_ptr + 1;
    u_int16_t value_len = line_len - key_len - 1;
    /* Trim any leading spaces or tabs from the header value */
    while(value_len > 0 && (*value_ptr == ' ' || *value_ptr == '\t')) {
      value_ptr++;
      value_len--;
    }
    /* Determine which header this is and store the trimmed value accordingly */
    if(key_len == 13 && strncasecmp(line_ptr, "Authorization", 13) == 0) {
      network_packet_struct->authorization_line.ptr = value_ptr;
      network_packet_struct->authorization_line.len = value_len;
    } else if(key_len == 6 && strncasecmp(line_ptr, "Accept", 6) == 0) {
      network_packet_struct->accept_line.ptr = value_ptr;
      network_packet_struct->accept_line.len = value_len;
    } else if(key_len == 7 && strncasecmp(line_ptr, "Referer", 7) == 0) {
      network_packet_struct->referer_line.ptr = value_ptr;
      network_packet_struct->referer_line.len = value_len;
    } else if(key_len == 10 && strncasecmp(line_ptr, "User-Agent", 10) == 0) {
      network_packet_struct->user_agent_line.ptr = value_ptr;
      network_packet_struct->user_agent_line.len = value_len;
    } else if(key_len == 15 && strncasecmp(line_ptr, "Content-Encoding", 15) == 0) {
      network_packet_struct->content_encoding_line.ptr = value_ptr;
      network_packet_struct->content_encoding_line.len = value_len;
    } else if(key_len == 17 && strncasecmp(line_ptr, "Transfer-Encoding", 17) == 0) {
      network_packet_struct->transfer_encoding_line.ptr = value_ptr;
      network_packet_struct->transfer_encoding_line.len = value_len;
    } else if(key_len == 14 && strncasecmp(line_ptr, "Content-Length", 14) == 0) {
      network_packet_struct->content_length_line.ptr = value_ptr;
      network_packet_struct->content_length_line.len = value_len;
    } else if(key_len == 19 && strncasecmp(line_ptr, "Content-Disposition", 19) == 0) {
      network_packet_struct->content_disposition_line.ptr = value_ptr;
      network_packet_struct->content_disposition_line.len = value_len;
    } else if(key_len == 6 && strncasecmp(line_ptr, "Cookie", 6) == 0) {
      network_packet_struct->cookie_line.ptr = value_ptr;
      network_packet_struct->cookie_line.len = value_len;
    } else if(key_len == 6 && strncasecmp(line_ptr, "Origin", 6) == 0) {
      network_packet_struct->origin_line.ptr = value_ptr;
      network_packet_struct->origin_line.len = value_len;
    } else if(key_len == 13 && strncasecmp(line_ptr, "X-Session-Type", 13) == 0) {
      network_packet_struct->x_session_type_line.ptr = value_ptr;
      network_packet_struct->x_session_type_line.len = value_len;
    }
    /* Specifically handle "Content-Type" header even if no space follows the colon */
    else if(key_len >= 12 && strncasecmp(line_ptr, "Content-Type", 12) == 0) {
      network_packet_struct->content_line.ptr = value_ptr;
      network_packet_struct->content_line.len = value_len;
    }
  }
  network_packet_struct->http_num_headers++;
}