{
  char *linePtr = (char *)network_packet_struct->line[network_packet_struct->parsed_lines].ptr;
  u_int16_t lineLen = network_packet_struct->line[network_packet_struct->parsed_lines].len;
  u_int16_t offset = NDPI_STATICSTRING_LEN("Authorization:");

  /* Skip any space after "Authorization:" */
  if(offset < lineLen && linePtr[offset] == ' ') offset++;

  /* Store the Authorization header value */
  network_packet_struct->authorization_line.ptr = &linePtr[offset];
  network_packet_struct->authorization_line.len = lineLen - offset;
  network_packet_struct->http_num_headers++;

  /* Recognize and parse other common HTTP headers from this line if needed.
   * Here, each 'else if' checks for a specific header name (case-insensitive).
   * If matched, we set the pointer and length fields, then increment the
   * http_num_headers count. If unrecognized, we also increment the count.
   */

  /* Accept */
  if((lineLen >= NDPI_STATICSTRING_LEN("Accept:") + 1) &&
     (strncasecmp(linePtr, "Accept:", NDPI_STATICSTRING_LEN("Accept:")) == 0)) {
    u_int16_t off = NDPI_STATICSTRING_LEN("Accept:");
    if(off < lineLen && linePtr[off] == ' ') off++;
    network_packet_struct->accept_line.ptr = &linePtr[off];
    network_packet_struct->accept_line.len = lineLen - off;
    network_packet_struct->http_num_headers++;
  }
  /* Referer */
  else if((lineLen >= NDPI_STATICSTRING_LEN("Referer:") + 1) &&
	  (strncasecmp(linePtr, "Referer:", NDPI_STATICSTRING_LEN("Referer:")) == 0)) {
    u_int16_t off = NDPI_STATICSTRING_LEN("Referer:");
    if(off < lineLen && linePtr[off] == ' ') off++;
    network_packet_struct->referer_line.ptr = &linePtr[off];
    network_packet_struct->referer_line.len = lineLen - off;
    network_packet_struct->http_num_headers++;
  }
  /* User-Agent */
  else if((lineLen >= NDPI_STATICSTRING_LEN("User-Agent:") + 1) &&
	  (strncasecmp(linePtr, "User-Agent:", NDPI_STATICSTRING_LEN("User-Agent:")) == 0)) {
    u_int16_t off = NDPI_STATICSTRING_LEN("User-Agent:");
    if(off < lineLen && linePtr[off] == ' ') off++;
    network_packet_struct->user_agent_line.ptr = &linePtr[off];
    network_packet_struct->user_agent_line.len = lineLen - off;
    network_packet_struct->http_num_headers++;
  }
  /* Content-Encoding */
  else if((lineLen >= NDPI_STATICSTRING_LEN("Content-Encoding:") + 1) &&
	  (strncasecmp(linePtr, "Content-Encoding:", NDPI_STATICSTRING_LEN("Content-Encoding:")) == 0)) {
    u_int16_t off = NDPI_STATICSTRING_LEN("Content-Encoding:");
    if(off < lineLen && linePtr[off] == ' ') off++;
    network_packet_struct->content_encoding_line.ptr = &linePtr[off];
    network_packet_struct->content_encoding_line.len = lineLen - off;
    network_packet_struct->http_num_headers++;
  }
  /* Transfer-Encoding */
  else if((lineLen >= NDPI_STATICSTRING_LEN("Transfer-Encoding:") + 1) &&
	  (strncasecmp(linePtr, "Transfer-Encoding:", NDPI_STATICSTRING_LEN("Transfer-Encoding:")) == 0)) {
    u_int16_t off = NDPI_STATICSTRING_LEN("Transfer-Encoding:");
    if(off < lineLen && linePtr[off] == ' ') off++;
    network_packet_struct->transfer_encoding_line.ptr = &linePtr[off];
    network_packet_struct->transfer_encoding_line.len = lineLen - off;
    network_packet_struct->http_num_headers++;
  }
  /* Content-Length */
  else if((lineLen >= NDPI_STATICSTRING_LEN("Content-Length:") + 1) &&
	  (strncasecmp(linePtr, "Content-Length:", NDPI_STATICSTRING_LEN("Content-Length:")) == 0)) {
    u_int16_t off = NDPI_STATICSTRING_LEN("Content-Length:");
    if(off < lineLen && linePtr[off] == ' ') off++;
    network_packet_struct->content_length_line.ptr = &linePtr[off];
    network_packet_struct->content_length_line.len = lineLen - off;
    network_packet_struct->http_num_headers++;
  }
  /* Content-Disposition */
  else if((lineLen >= NDPI_STATICSTRING_LEN("Content-Disposition:") + 1) &&
	  (strncasecmp(linePtr, "Content-Disposition:", NDPI_STATICSTRING_LEN("Content-Disposition:")) == 0)) {
    u_int16_t off = NDPI_STATICSTRING_LEN("Content-Disposition:");
    if(off < lineLen && linePtr[off] == ' ') off++;
    network_packet_struct->content_disposition_line.ptr = &linePtr[off];
    network_packet_struct->content_disposition_line.len = lineLen - off;
    network_packet_struct->http_num_headers++;
  }
  /* Cookie */
  else if((lineLen >= NDPI_STATICSTRING_LEN("Cookie:") + 1) &&
	  (strncasecmp(linePtr, "Cookie:", NDPI_STATICSTRING_LEN("Cookie:")) == 0)) {
    u_int16_t off = NDPI_STATICSTRING_LEN("Cookie:");
    if(off < lineLen && linePtr[off] == ' ') off++;
    network_packet_struct->cookie_line.ptr = &linePtr[off];
    network_packet_struct->cookie_line.len = lineLen - off;
    network_packet_struct->http_num_headers++;
  }
  /* Origin */
  else if((lineLen >= NDPI_STATICSTRING_LEN("Origin:") + 1) &&
	  (strncasecmp(linePtr, "Origin:", NDPI_STATICSTRING_LEN("Origin:")) == 0)) {
    u_int16_t off = NDPI_STATICSTRING_LEN("Origin:");
    if(off < lineLen && linePtr[off] == ' ') off++;
    network_packet_struct->origin_line.ptr = &linePtr[off];
    network_packet_struct->origin_line.len = lineLen - off;
    network_packet_struct->http_num_headers++;
  }
  /* X-Session-Type */
  else if((lineLen >= NDPI_STATICSTRING_LEN("X-Session-Type:") + 1) &&
	  (strncasecmp(linePtr, "X-Session-Type:", NDPI_STATICSTRING_LEN("X-Session-Type:")) == 0)) {
    u_int16_t of