int frame_get_chunk(blosc2_frame_s *frame, int nchunk, uint8_t **chunk, bool *needs_free) {
  // ... (existing code)

  // Masked region
  *chunk = malloc(chunk_cbytes);
  *needs_free = true;

  return chunk_cbytes;
}