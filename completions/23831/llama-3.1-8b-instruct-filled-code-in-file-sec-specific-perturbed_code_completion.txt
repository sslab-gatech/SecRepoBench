// Check if the payload length equals 12, log detection of IAX, and add the connection if true.
// Otherwise, iterate through information elements in the payload.
// For each element, calculate the next element's starting position based on its length.
// If the calculated position equals the total payload length, log detection of IAX and add the connection.
if (packet->payload_packet_len == 12) {
  ndpi_log_detection(ndpi_struct, flow, "IAX");
  ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN);
} else {
  u_int16_t i;
  for (i = 12; i < packet->payload_packet_len; i++) {
    if (packet->payload[i] == 0x00) {
      // Check if the payload length equals the calculated position
      if (i + 1 == packet->payload_packet_len) {
        ndpi_log_detection(ndpi_struct, flow, "IAX");
        ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN);
      }
      // Calculate the next element's starting position
      i += packet->payload[i + 1] + 1;
    }
  }
}