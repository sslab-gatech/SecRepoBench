if (packet->payload_packet_len == 12) {
  ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN);
  ndpi_int_iax_add_connection(ndpi_struct, flow);
} else {
  u_int16_t next_element_pos = 12;
  for (i = 0; i < NDPI_IAX_MAX_INFORMATION_ELEMENTS; i++) {
    u_int16_t element_len = packet->payload[next_element_pos];
    if (next_element_pos + element_len > packet->payload_packet_len) {
      break;
    }
    next_element_pos += element_len;
  }
  if (next_element_pos == packet->payload_packet_len) {
    ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN);
    ndpi_int_iax_add_connection(ndpi_struct, flow);
  }
}