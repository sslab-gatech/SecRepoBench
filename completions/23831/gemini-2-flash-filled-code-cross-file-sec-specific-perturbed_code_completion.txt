{
    if (packet->payload_packet_len == 12) {
      NDPI_LOG_INFO(ndpi_struct, "IAX");
      ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN);
      return;
    } else {
      u_int16_t element_len;
      u_int32_t offset = 12;

      while (offset < packet->payload_packet_len) {
        if (offset + 2 > packet->payload_packet_len) {
          NDPI_LOG_INFO(ndpi_struct, "IAX incomplete element");
          NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
          return;
        }
        element_len = ntohs(get_u_int16_t(packet->payload, offset));
        if (element_len == 0) {
          NDPI_LOG_INFO(ndpi_struct, "IAX zero length element");
          NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
          return;
        }

        if (offset + 2 + element_len > packet->payload_packet_len) {
          NDPI_LOG_INFO(ndpi_struct, "IAX element length exceeds packet length");
          NDPI_EXCLUDE_PROTO(ndpi_struct, flow);
          return;
        }
        offset += 2 + element_len;
      }

      if (offset == packet->payload_packet_len) {
        NDPI_LOG_INFO(ndpi_struct, "IAX");
        ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN);
        return;
      }
    }