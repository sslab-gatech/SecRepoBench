if (packet->payload_packet_len == 12) {
  ndpi_log(ndpi_struct, flow, NDPI_LOG_MAP_NEW_PROTOCOL, packet->payload, packet->payload_packet_len);
  ndpi_int_add_connection(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_REAL_PROTOCOL);
} else {
  u_int16_t pos = 12;
  while (pos < packet->payload_packet_len) {
    u_int16_t len = ntohs(get_u_int16_t(packet->payload, pos + 2));
    if (pos + len + 4 == packet->payload_packet_len) {
      ndpi_log(ndpi_struct, flow, NDPI_LOG_MAP_NEW_PROTOCOL, packet->payload, packet->payload_packet_len);
      ndpi_int_add_connection(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_REAL_PROTOCOL);
      break;
    }
    pos += len + 4;
  }
}