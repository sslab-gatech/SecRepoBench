packetlength = ntohs(packet->udp->len);
    if (packetlength == 12) {
      ndpi_log_detection(ndpi_struct, flow, "IAX detected");
      ndpi_int_iax_add_connection(ndpi_struct, flow);
    } else {
      u_int8_t *ptr = packet->payload + 12;
      u_int16_t len;
      for (i = 0; i < NDPI_IAX_MAX_INFORMATION_ELEMENTS; i++) {
        len = (ptr[0] << 8) | ptr[1];
        if (ptr + len + 2 == packet->payload + packetlength) {
          ndpi_log_detection(ndpi_struct, flow, "IAX detected");
          ndpi_int_iax_add_connection(ndpi_struct, flow);
          break;
        }
        ptr += len + 2;
      }
    }