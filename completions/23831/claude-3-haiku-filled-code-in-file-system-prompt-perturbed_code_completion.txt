// Check if the payload length equals 12, log detection of IAX, and add the connection if true.
if (packet->payload_packet_len == 12) {
    NDPI_LOG_INFO(ndpi_struct, "found IAX connection");
    ndpi_int_iax_add_connection(ndpi_struct, flow);
    return;
}

// Iterate through information elements in the payload.
packetlength = packet->payload_packet_len;
for (i = 12; i < packetlength; ) {
    u_int8_t element_length = packet->payload[i + 1];
    i += element_length + 2;

    // If the calculated position equals the total payload length, log detection of IAX and add the connection.
    if (i == packetlength) {
        NDPI_LOG_INFO(ndpi_struct, "found IAX connection");
        ndpi_int_iax_add_connection(ndpi_struct, flow);
        return;
    }
}