if (packet->payload_packet_len == 12) {
  NDPI_LOG_DBG(ndpi_struct, "IAX detected (payload length = 12)\n");
  ndpi_int_iax_add_connection(ndpi_struct, flow);
  return;
} else {
  u_int16_t offset = 12;
  for(i = 0; i < NDPI_IAX_MAX_INFORMATION_ELEMENTS && offset < packet->payload_packet_len; i++) {
    if(offset + 2 > packet->payload_packet_len)
      break;

    offset += 2 + packet->payload[offset + 1];

    if(offset == packet->payload_packet_len) {
      NDPI_LOG_DBG(ndpi_struct, "IAX detected after parsing information elements\n");
      ndpi_int_iax_add_connection(ndpi_struct, flow);
      return;
    }
  }
}