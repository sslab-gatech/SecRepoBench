if (packet->payload_packet_len == 12) {
    ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN);
    NDPI_LOG_INFO(ndpi_struct, "found IAX\n");
    ndpi_set_risk(ndpi_struct, flow, NDPI_IAX_NO_HANDSHAKE, "Found IAX without handshake");
    return;
} else {
    u_int16_t i;
    for (i = 12; i < packet->payload_packet_len; ) {
        if (i + 1 >= packet->payload_packet_len)
            break;
        u_int8_t len = packet->payload[i + 1];
        i += 2 + len;
    }
    if (i == packet->payload_packet_len) {
        ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN);
        NDPI_LOG_INFO(ndpi_struct, "found IAX\n");
        return;
    }
}