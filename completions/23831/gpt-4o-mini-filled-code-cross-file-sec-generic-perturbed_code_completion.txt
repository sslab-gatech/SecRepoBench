if (packet->payload_packet_len == 12) {
        // Log detection of IAX
        ndpi_log_detection(ndpi_struct, flow, NDPI_PROTOCOL_IAX);
        // Add the connection
        ndpi_add_connection(ndpi_struct, flow);
    } else {
        u_int8_t next_element_start = 12;
        while (next_element_start < packet->payload_packet_len) {
            u_int8_t element_length = packet->payload[next_element_start + 1];
            next_element_start += element_length + 2; // Move to the next element

            if (next_element_start == packet->payload_packet_len) {
                // Log detection of IAX
                ndpi_log_detection(ndpi_struct, flow, NDPI_PROTOCOL_IAX);
                // Add the connection
                ndpi_add_connection(ndpi_struct, flow);
                break;
            }
        }
    }