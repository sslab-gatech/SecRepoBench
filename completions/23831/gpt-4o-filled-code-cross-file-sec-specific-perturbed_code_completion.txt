if (packet->payload_packet_len == 12) {
      NDPI_LOG_INFO(ndpi_struct, "Detected IAX protocol\n");
      ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX);
    } else {
      packetlength = 12;
      for (i = 12; i < packet->payload_packet_len; i += packet->payload[i+1] + 2) {
        if (i + 1 >= packet->payload_packet_len) break;
        packetlength += packet->payload[i+1] + 2;
      }
      if (packetlength == packet->payload_packet_len) {
        NDPI_LOG_INFO(ndpi_struct, "Detected IAX protocol\n");
        ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX);
      }
    }