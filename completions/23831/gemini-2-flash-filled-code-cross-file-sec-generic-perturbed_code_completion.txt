{
      if (packet->payload_packet_len == 12) {
        NDPI_LOG_INFO(ndpi_struct, "IAX");
        ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN);
        return;
      } else {
        packetlength = 12;
        i = 0;

        while (packetlength < packet->payload_packet_len && i < 20) {
          u_int16_t element_len = ntohs(get_u_int16_t(packet->payload, packetlength));

          if (element_len > (packet->payload_packet_len - packetlength - 2)) {
            break;
          }

          packetlength += (element_len + 2);
          i++;
        }

        if (packetlength == packet->payload_packet_len) {
          NDPI_LOG_INFO(ndpi_struct, "IAX");
          ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN);
          return;
        }
      }
    }