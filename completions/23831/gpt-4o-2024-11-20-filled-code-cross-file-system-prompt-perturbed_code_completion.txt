if (packet->payload_packet_len == 12) {
      NDPI_LOG_INFO(ndpi_struct, "Detected IAX protocol.\n");
      ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX);
    } else {
      i = 12;
      packetlength = packet->payload_packet_len;

      while (i < packetlength) {
        u_int8_t ie_length = packet->payload[i + 1] + 2;

        if ((i + ie_length) == packetlength) {
          NDPI_LOG_INFO(ndpi_struct, "Detected IAX protocol.\n");
          ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX);
          break;
        }

        i += ie_length;
      }
    }