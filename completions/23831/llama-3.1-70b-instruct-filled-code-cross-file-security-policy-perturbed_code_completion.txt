if (packet->payload_packet_len == 12) {
  ndpi_log(ndpi_struct, flow, NDPI_LOG_MAP_NEW_PROTOCOL, ndpi_struct->proto_name, packet->payload_packet_len, packet->packet_direction, packet->protocol, packet->src_ip, packet->dst_ip, packet->src_port, packet->dst_port);
  ndpi_add_connection(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_REAL_PROTOCOL);
} else {
  u_int16_t pos = 12;
  while (pos < packet->payload_packet_len) {
    u_int8_t ie_length = packet->payload[pos + 1];
    if (pos + 2 + ie_length > packet->payload_packet_len) {
      break;
    }
    pos += 2 + ie_length;
    if (pos == packet->payload_packet_len) {
      ndpi_log(ndpi_struct, flow, NDPI_LOG_MAP_NEW_PROTOCOL, ndpi_struct->proto_name, packet->payload_packet_len, packet->packet_direction, packet->protocol, packet->src_ip, packet->dst_ip, packet->src_port, packet->dst_port);
      ndpi_add_connection(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_REAL_PROTOCOL);
    }
  }
}