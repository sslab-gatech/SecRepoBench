if (packet->payload_packet_len == 12) {
    ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN);
    ndpi_add_connection(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN);
  } else {
    u_int16_t pos = 12;
    while (pos < packet->payload_packet_len) {
      u_int8_t element_length = packet->payload[pos];
      if (pos + element_length > packet->payload_packet_len) {
        break;
      }
      pos += element_length;
      if (pos == packet->payload_packet_len) {
        ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN);
        ndpi_add_connection(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN);
        break;
      }
    }
  }