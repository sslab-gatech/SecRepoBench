if (packet->payload_len >= 12) {
  if (packet->payload_len == 12) {
    // Log detection of IAX and add the connection
    ndpi_log_detection(ndpi_struct, flow, "IAX");
    ndpi_add_connection(ndpi_struct, flow);
  } else {
    u_int16_t i = 0;
    u_int16_t payload_len = packet->payload_len;
    while (i < payload_len) {
      u_int16_t element_len = get_u_int16_t(packet->payload, i + 2);
      if (i + element_len + 4 == payload_len) {
        // Log detection of IAX and add the connection
        ndpi_log_detection(ndpi_struct, flow, "IAX");
        ndpi_add_connection(ndpi_struct, flow);
        break;
      }
      i += element_len + 4;
    }
  }
}