if (packet->payload_packet_len == 12) {
  NDPI_LOG_INFO(ndpi_struct, "found IAX (len %u)\n", packet->payload_packet_len);
  ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI);
} else {
  packetlength = 12;
  for (i = 0; i < 4; i++) {
    if (packet->payload_packet_len > packetlength && packet->payload[packetlength] != 0x00) {
      packetlength += (packet->payload[packetlength + 1] + 2);
      if (packetlength == packet->payload_packet_len) {
        NDPI_LOG_INFO(ndpi_struct, "found IAX (len %u)\n", packet->payload_packet_len);
        ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI);
        break;
      }
    } else {
      break;
    }
  }
}