packetlength = packet->payload_packet_len;
    if (packetlength == 12) {
      ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX);
      ndpi_add_connection(ndpi_struct, flow);
    } else {
      u_int8_t *ptr = packet->payload;
      while (ptr < packet->payload + packetlength) {
        u_int16_t len = get_u_int16_t(ptr, 0);
        ptr += len;
        if (ptr == packet->payload + packetlength) {
          ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX);
          ndpi_add_connection(ndpi_struct, flow);
          break;
        }
      }
    }