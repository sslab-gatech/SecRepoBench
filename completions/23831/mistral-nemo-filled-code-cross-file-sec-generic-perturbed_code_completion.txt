if (packet->payload_packet_len == 12) {
  ndpi_log_detection(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_LOG_INFO);
  ndpi_add_connection(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_IAX);
} else {
  u_int16_t pos = 12;
  while (pos < packet->payload_packet_len) {
    u_int8_t element_type = packet->payload[pos];
    u_int16_t element_length = get_u_int16_t(packet->payload, pos + 1);
    pos += element_length + 3; // 3 bytes for type + length

    if (pos == packet->payload_packet_len) {
      ndpi_log_detection(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_LOG_INFO);
      ndpi_add_connection(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_IAX);
      break;
    }
  }
}