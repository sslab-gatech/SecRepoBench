packetlength = packet->payload_packet_len;

    if(packetlength == 12) {
      NDPI_LOG_INFO(ndpi_struct, "Detected IAX protocol\n");
      ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX);
    } else {
      for(i = 12; i < packetlength; ) {
        u_int8_t ie_length = packet->payload[i + 1];
        i += 2 + ie_length;

        if(i == packetlength) {
          NDPI_LOG_INFO(ndpi_struct, "Detected IAX protocol\n");
          ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX);
          break;
        }
      }
    }