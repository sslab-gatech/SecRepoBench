if(packet->payload_packet_len == 12) {
    ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX);
} else {
    u_int16_t payload_len = packet->payload_packet_len;
    u_int16_t offset = 12;
    while(offset < payload_len) {
        if(offset + 1 >= payload_len) {
            break;
        }
        u_int8_t element_length = packet->payload[offset + 1];
        if(element_length < 2) {
            break;
        }
        offset += element_length;
    }
    if(offset == payload_len) {
        ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX);
    }
}