if(packet->payload_packet_len == 12) {
    ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX);
} else {
    u_int16_t offset = 12;
    while (offset < packet->payload_packet_len) {
        if (offset + 1 >= packet->payload_packet_len)
            break; // not enough bytes to determine IE length
        u_int8_t ie_length = packet->payload[offset + 1];
        offset += ie_length + 2;
        if (offset == packet->payload_packet_len) {
            ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX);
            return;
        }
    }
}