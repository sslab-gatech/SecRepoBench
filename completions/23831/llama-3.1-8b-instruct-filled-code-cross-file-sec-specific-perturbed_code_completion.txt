// Check if the payload length equals 12, log detection of IAX, and add the connection if true.
// Otherwise, iterate through information elements in the payload.
// For each element, calculate the next element's starting position based on its length.
// If the calculated position equals the total payload length, log detection of IAX and add the connection.
if (packet->payload_len == 12) {
  ndpi_log_detection(ndpi_struct, flow, "IAX");
  ndpi_add_connection(ndpi_struct, flow);
} else {
  u_int16_t i = 12;
  while (i < packet->payload_len) {
    // Check if the current element is a valid IAX information element
    if (packet->payload[i] == 0x06) {
      // Check if the payload length equals the calculated position, log detection of IAX and add the connection if true.
      if (i + 1 == packet->payload_len) {
        ndpi_log_detection(ndpi_struct, flow, "IAX");
        ndpi_add_connection(ndpi_struct, flow);
      }
    }
    // Calculate the next element's starting position based on its length
    i += packet->payload[i + 1] + 1;
  }
}