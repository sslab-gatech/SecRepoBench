if (packet->payload_packet_len == 12) {
  NDPI_LOG_INFO(ndpi_struct, "found IAX\n");
  ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI);
  return;
} else {
  packetlength = 12;
  for (i = 0; i < packet->payload_packet_len - 12; i++) {
    packetlength += 2 + packet->payload[packetlength + 1];
    if (packetlength == packet->payload_packet_len) {
      NDPI_LOG_INFO(ndpi_struct, "found IAX\n");
      ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI);
      return;
    }
  }
}