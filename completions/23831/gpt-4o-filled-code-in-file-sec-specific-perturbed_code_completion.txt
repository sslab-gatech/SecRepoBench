if (packet->payload_packet_len == 12) {
      NDPI_LOG_INFO(ndpi_struct, "Detected IAX protocol\n");
      ndpi_int_iax_add_connection(ndpi_struct, flow);
    } else {
      u_int16_t pos = 12;
      for (i = 0; i < NDPI_IAX_MAX_INFORMATION_ELEMENTS && pos < packet->payload_packet_len; i++) {
        if (pos + 2 > packet->payload_packet_len) break; // Ensure we don't read beyond the payload
        u_int8_t ie_length = packet->payload[pos + 1];
        pos += 2 + ie_length;
        if (pos == packet->payload_packet_len) {
          NDPI_LOG_INFO(ndpi_struct, "Detected IAX protocol with information elements\n");
          ndpi_int_iax_add_connection(ndpi_struct, flow);
          break;
        }
      }
    }