packetlength = packet->payload_packet_len;
    if (packetlength == 12) {
      NDPI_LOG_INFO(ndpi_struct, "found IAX\n");
      ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI);
    } else {
      i = 12; // Start after the fixed header
      while (i < packetlength) {
        u_int8_t element_length = packet->payload[i];
        i += element_length + 1; // Move to the next element
        if (i == packetlength) {
          NDPI_LOG_INFO(ndpi_struct, "found IAX\n");
          ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI);
          break;
        }
      }
    }