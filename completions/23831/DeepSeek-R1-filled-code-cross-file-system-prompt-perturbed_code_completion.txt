if (packet->payload_packet_len == 12) {
    ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN);
    NDPI_LOG_INFO(ndpi_struct, "found IAX\n");
    return;
} else {
    u_int16_t offset = 12;
    while (offset + 2 <= packet->payload_packet_len) {
        u_int8_t elem_len = packet->payload[offset + 1];
        u_int16_t next_offset = offset + 2 + elem_len;
        if (next_offset > packet->payload_packet_len)
            break;
        offset = next_offset;
    }
    if (offset == packet->payload_packet_len) {
        ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN);
        NDPI_LOG_INFO(ndpi_struct, "found IAX\n");
        return;
    }
}