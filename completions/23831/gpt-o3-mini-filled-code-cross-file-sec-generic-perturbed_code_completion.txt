if(packet->payload_packet_len == 12) {
  NDPI_ADD_PROTOCOL_TO_BITMASK(flow->detected_protocol, NDPI_PROTOCOL_IAX);
} else {
  u_int16_t pos = 12;
  while(pos < packet->payload_packet_len) {
    if(pos + 1 >= packet->payload_packet_len)
      break;
    u_int8_t ie_length = packet->payload[pos + 1];
    pos += 2 + ie_length;
    if(pos == packet->payload_packet_len) {
      NDPI_ADD_PROTOCOL_TO_BITMASK(flow->detected_protocol, NDPI_PROTOCOL_IAX);
      break;
    }
  }
}