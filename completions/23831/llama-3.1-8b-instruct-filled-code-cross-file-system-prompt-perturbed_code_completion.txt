if (packet->payload_len == 12) {
  ndpi_log_detection(ndpi_struct, flow, "IAX");
  ndpi_add_connection(ndpi_struct, flow);
} else {
  u_int16_t i = 0;
  u_int16_t payload_len = packet->payload_packet_len;
  while (i < payload_len) {
    u_int16_t element_len = get_u_int16_t(packet->payload, i + 2);
    i += element_len + 2;
    if (i == payload_len) {
      ndpi_log_detection(ndpi_struct, flow, "IAX");
      ndpi_add_connection(ndpi_struct, flow);
      break;
    }
  }
}