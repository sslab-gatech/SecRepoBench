if (packet->payload_packet_len == 12) {
  NDPI_LOG_INFO(ndpi_struct, "detected IAX\n");
  ndpi_int_iax_add_connection(ndpi_struct, flow);
} else {
  u_int16_t offset = 12;
  for (i = 0; i < NDPI_IAX_MAX_INFORMATION_ELEMENTS; i++) {
    if (offset >= packet->payload_packet_len) {
      break;
    }
    u_int8_t type = packet->payload[offset];
    u_int16_t len = ntohs(get_u_int16_t(packet->payload, offset + 1));
    offset += 3 + len;
    if (offset == packet->payload_packet_len) {
      NDPI_LOG_INFO(ndpi_struct, "detected IAX\n");
      ndpi_int_iax_add_connection(ndpi_struct, flow);
      return;
    }
  }
}