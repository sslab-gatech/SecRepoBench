packetlength = packet->payload_packet_len;
    if (packetlength == 12) {
      NDPI_LOG_INFO(ndpi_struct, "IAX");
      NDPI_ADD_PROTOCOL_TO_BITMASK(flow->detected_protocol_stack, NDPI_PROTOCOL_IAX);
    } else {
      u_int16_t elementlength;
      u_int16_t nextelpos = 12;
      u_int8_t *payload = packet->payload;
      for (i = 0; i < 10; i++) {
        if (nextelpos < packetlength) {
          elementlength = payload[nextelpos + 1];
          nextelpos += elementlength + 2;
          if (nextelpos == packetlength) {
            NDPI_LOG_INFO(ndpi_struct, "IAX");
            NDPI_ADD_PROTOCOL_TO_BITMASK(flow->detected_protocol_stack, NDPI_PROTOCOL_IAX);
            break;
          }
        }
      }
    }