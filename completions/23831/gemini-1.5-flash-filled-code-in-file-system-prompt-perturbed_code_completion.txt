packetlength = ntohs(packet->udp->len);
    if (packet->payload_packet_len == 12) {
      ndpi_log_detection(ndpi_struct, flow, "IAX");
      ndpi_int_iax_add_connection(ndpi_struct, flow);
    } else {
      u_int8_t *ptr = packet->payload;
      u_int16_t len;
      for (i = 0; i < NDPI_IAX_MAX_INFORMATION_ELEMENTS; i++) {
        len = ntohs(*((u_int16_t *) ptr));
        ptr += len + 2;
        if (ptr - packet->payload == packet->payload_packet_len) {
          ndpi_log_detection(ndpi_struct, flow, "IAX");
          ndpi_int_iax_add_connection(ndpi_struct, flow);
          break;
        }
      }
    }