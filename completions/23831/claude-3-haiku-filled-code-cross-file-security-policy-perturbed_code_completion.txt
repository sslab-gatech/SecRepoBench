// Check if the payload length equals 12, log detection of IAX, and add the connection if true.
if (packet->payload_packet_len == 12) {
    NDPI_LOG_INFO(ndpi_struct, "Found IAX");
    ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN);
    return;
}

// Otherwise, iterate through information elements in the payload.
packetlength = packet->payload_packet_len;
i = 12;
while (i < packetlength) {
    // Calculate the next element's starting position based on its length.
    u_int16_t element_length = ntohs(get_u_int16_t(packet->payload, i));
    i += 2 + element_length;

    // If the calculated position equals the total payload length, log detection of IAX and add the connection.
    if (i == packetlength) {
        NDPI_LOG_INFO(ndpi_struct, "Found IAX");
        ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN);
        return;
    }
}