if(packet->payload_packet_len == 12) {
  NDPI_LOG_INFO(ndpi_struct, "found IAX\n");
  ndpi_int_iax_add_connection(ndpi_struct, flow);
} else {
  packetlength = 12; /* Start after the IAX header */
  
  while(packetlength < packet->payload_packet_len) {
    i = packet->payload[packetlength + 1]; /* Get element length */
    
    if(i == 0) {
      /* Invalid element length, not IAX */
      break;
    }
    
    packetlength += i + 2; /* Move to next element: add length + 2 bytes for type & length fields */
    
    if(packetlength == packet->payload_packet_len) {
      NDPI_LOG_INFO(ndpi_struct, "found IAX\n");
      ndpi_int_iax_add_connection(ndpi_struct, flow);
      return;
    }
  }
}