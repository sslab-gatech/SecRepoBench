if (packet->payload_packet_len == 12) {
        // Log detection of IAX
        ndpi_log_detection(ndpi_struct, flow, NDPI_PROTOCOL_IAX);
        ndpi_add_connection(ndpi_struct, flow);
    } else {
        u_int8_t element_length;
        u_int16_t current_position = 12; // Start after the fixed header

        while (current_position < packet->payload_packet_len) {
            if (current_position + 1 >= packet->payload_packet_len) {
                break; // Prevent overflow
            }
            element_length = packet->payload[current_position];
            current_position += element_length + 1; // Move to the next element

            if (current_position == packet->payload_packet_len) {
                // Log detection of IAX
                ndpi_log_detection(ndpi_struct, flow, NDPI_PROTOCOL_IAX);
                ndpi_add_connection(ndpi_struct, flow);
                break;
            }
        }
    }