// Check if the payload length equals 12, log detection of IAX, and add the connection if true.
if (packet->payload_packet_len == 12) {
    ndpi_int_iax_add_connection(ndpi_struct, flow);
    return;
}

// Iterate through information elements in the payload.
packetlength = packet->payload_packet_len;
for (i = 12; i < packetlength; ) {
    // Calculate the next element's starting position based on its length.
    u_int16_t element_length = ntohs(get_u_int16_t(packet->payload, i));
    i += element_length + 2;

    // If the calculated position equals the total payload length, log detection of IAX and add the connection.
    if (i == packetlength) {
        ndpi_int_iax_add_connection(ndpi_struct, flow);
        return;
    }
}