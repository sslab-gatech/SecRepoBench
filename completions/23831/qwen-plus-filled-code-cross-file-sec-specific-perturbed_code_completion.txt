if (packet->payload_packet_len == 12) {
    ndpi_int_iax_add_connection(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_REAL_PROTOCOL);
} else {
    u_int8_t *current = packet->payload + 12;
    u_int16_t total_payload_len = packet->payload_packet_len;

    while ((u_int32_t)(current - packet->payload) < total_payload_len) {
        u_int8_t element_length = *current++;
        
        if (((u_int32_t)(current - packet->payload) + element_length) > total_payload_len) {
            /* Invalid length, break out to avoid overflow */
            break;
        }

        current += element_length;

        if ((u_int32_t)(current - packet->payload) == total_payload_len) {
            ndpi_int_iax_add_connection(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_REAL_PROTOCOL);
            break;
        }
    }
}