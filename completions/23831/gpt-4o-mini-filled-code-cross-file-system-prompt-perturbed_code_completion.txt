if (packet->payload_packet_len == 12) {
        // Log detection of IAX
        ndpi_struct->detected_protocol_stack[0] = NDPI_PROTOCOL_IAX;
        ndpi_struct->detected_protocol_stack[1] = NDPI_PROTOCOL_UNKNOWN;
        ndpi_struct->detected_protocol_stack[2] = NDPI_PROTOCOL_UNKNOWN;
        ndpi_struct->detected_protocol_stack[3] = NDPI_PROTOCOL_UNKNOWN;
        ndpi_struct->detected_protocol_stack[4] = NDPI_PROTOCOL_UNKNOWN;
        ndpi_struct->detected_protocol_stack[5] = NDPI_PROTOCOL_UNKNOWN;
        ndpi_struct->detected_protocol_stack[6] = NDPI_PROTOCOL_UNKNOWN;
        ndpi_struct->detected_protocol_stack[7] = NDPI_PROTOCOL_UNKNOWN;
        ndpi_struct->detected_protocol_stack[8] = NDPI_PROTOCOL_UNKNOWN;
        ndpi_struct->detected_protocol_stack[9] = NDPI_PROTOCOL_UNKNOWN;
        ndpi_struct->detected_protocol_stack[10] = NDPI_PROTOCOL_UNKNOWN;
        ndpi_struct->detected_protocol_stack[11] = NDPI_PROTOCOL_UNKNOWN;
        return;
    }

    u_int8_t element_start = 12;
    while (element_start < packet->payload_packet_len) {
        u_int8_t element_length = packet->payload[element_start + 1];
        if (element_start + element_length == packet->payload_packet_len) {
            // Log detection of IAX
            ndpi_struct->detected_protocol_stack[0] = NDPI_PROTOCOL_IAX;
            return;
        }
        element_start += element_length;
    }