if (packet->payload_packet_len == 12) {
  NDPI_LOG_INFO(ndpi_struct, "IAX detected\n");
  ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI);
  return;
} else {
  u_int16_t position = 12;
  while (position < packet->payload_packet_len) {
    u_int8_t element_type = packet->payload[position];
    u_int16_t element_length = ntohs(get_u_int16_t(packet->payload, position + 1));
    
    if (position + 2 + element_length > packet->payload_packet_len) {
      break;
    }
    
    position += 2 + element_length;
    
    if (position == packet->payload_packet_len) {
      NDPI_LOG_INFO(ndpi_struct, "IAX detected\n");
      ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_IAX, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI);
      return;
    }
  }
}