sx,
             sy;

           if ((TIFFGetFieldDefaulted(tiff,TIFFTAG_SAMPLESPERPIXEL,
               &samples_per_pixel) == 1) &&
               (samples_per_pixel == 3) &&
               (TIFFGetFieldDefaulted(tiff,TIFFTAG_YCBCRSUBSAMPLING,
                 &sx,&sy) == 1) &&
               (sx > 0) && (sy > 0))
             {
               (void) FormatLocaleString(sampling_factor,MagickPathExtent,
                 "%lux%lu",(unsigned long) sx,(unsigned long) sy);
               (void) SetImageProperty(image,"tiff:ycbcr-subsampling",
                 sampling_factor,exception);
             }
         }
#endif
         break;
      }
      case COMPRESSION_LZW: image->compression=LZWCompression; break;
      case COMPRESSION_ADOBE_DEFLATE: image->compression=ZipCompression; break;
      case COMPRESSION_ZLIB: image->compression=DeflateCompression; break;
      case COMPRESSION_PACKBITS: image->compression=RLECompression; break;
      case COMPRESSION_THUNDERSCAN: image->compression=RawCompression; break;
      case COMPRESSION_IT8CTPAD: image->compression=IT8CTPADCompression; break;
      case COMPRESSION_IT8LW: image->compression=IT8LWCompression; break;
      case COMPRESSION_IT8MP: image->compression=IT8MPCompression; break;
      case COMPRESSION_IT8BL: image->compression=IT8BLCompression; break;
      case COMPRESSION_PIXARLOG: image->compression=PixarLogCompression; break;
      case COMPRESSION_DEFLATE: image->compression=DeflateCompression; break;
      case COMPRESSION_ADOBE_LZW: image->compression=LZWCompression; break;
      case COMPRESSION_PREDICTOR: image->compression=JPEGCompression; break;
      case COMPRESSION_SGILOG: image->compression=SGILOGCompression; break;
      case COMPRESSION_SGILOG24: image->compression=SGILOG24Compression; break;
      case COMPRESSION_JP2000: image->compression=JPEG2000Compression; break;
      default:
      {
        TIFFClose(tiff);
        ThrowReaderException(CoderError,"UnsupportedCompression");
      }
    }
    if (image->compression == JPEGCompression)
      {
        if (TIFFGetFieldDefaulted(tiff,TIFFTAG_JPEGTABLESMODE,&value) == 1)
          {
            if (value == JPEGTABLESMODE_QUANT)
              (void) SetImageProperty(image,"tiff:jpeg-tables-mode",
                "quant",exception);
            if (value == JPEGTABLESMODE_HUFF)
              (void) SetImageProperty(image,"tiff:jpeg-tables-mode",
                "huff",exception);
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_YCBCRSUBSAMPLING,&sx,&sy) == 1)
      {
        if (sx > 0)
          image->y_sampling=(size_t) sx;
        if (sy > 0)
          image->x_sampling=(size_t) sy;
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_REFERENCEBLACKWHITE,&chromaticity) == 1)
      {
        if (chromaticity != (float *) NULL)
          {
            image->chromaticity.black_point.x=chromaticity[0];
            image->chromaticity.black_point.y=chromaticity[1];
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SOFTWARE,&text) == 1)
      (void) SetImageProperty(image,"tiff:software",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ARTIST,&text) == 1)
      (void) SetImageProperty(image,"tiff:artist",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_HOSTCOMPUTER,&text) == 1)
      (void) SetImageProperty(image,"tiff:hostcomputer",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_DATETIME,&text) == 1)
      (void) SetImageProperty(image,"tiff:timestamp",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_DOCUMENTNAME,&text) == 1)
      (void) SetImageProperty(image,"tiff:document",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PAGENAME,&text) == 1)
      (void) SetImageProperty(image,"label",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_IMAGEDESCRIPTION,&text) == 1)
      (void) SetImageProperty(image,"comment",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_MAKE,&text) == 1)
      (void) SetImageProperty(image,"tiff:make",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_MODEL,&text) == 1)
      (void) SetImageProperty(image,"tiff:model",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ORIENTATION,&value) == 1)
      image->orientation=(OrientationType) value;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SAMPLESPERPIXEL,&samples_per_pixel) == 1)
      image->number_channels=(size_t) samples_per_pixel;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ROWSPERSTRIP,&rows_per_strip) == 1)
      image->rows_per_strip=(size_t) rows_per_strip;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_BITSPERSAMPLE,&bits_per_sample) == 1)
      image->depth=(size_t) bits_per_sample;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PLANARCONFIG,&interlace) == 1)
      image->interlace=(InterlaceType) interlace;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PHOTOMETRIC,&photometric) == 1)
      image->colorspace=(ColorspaceType) photometric;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SAMPLEFORMAT,&sample_format) == 1)
      image->sample_format=(SampleFormat) sample_format;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_MINSAMPLEVALUE,&min_sample_value) == 1)
      image->min_sample_value=(size_t) min_sample_value;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_MAXSAMPLEVALUE,&max_sample_value) == 1)
      image->max_sample_value=(size_t) max_sample_value;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_EXTRASAMPLES,&extra_samples,&sample_info) == 1)
      {
        image->extra_channels=(size_t) extra_samples;
        for (i=0; i < (ssize_t) extra_samples; i++)
          image->colorspace=(ColorspaceType) sample_info[i];
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SUBFILETYPE,&value) == 1)
      {
        if ((value & FILETYPE_REDUCEDIMAGE) != 0)
          (void) SetImageProperty(image,"tiff:subfiletype","REDUCEDIMAGE",
            exception);
        if ((value & FILETYPE_PAGE) != 0)
          (void) SetImageProperty(image,"tiff:subfiletype","PAGE",exception);
        if ((value & FILETYPE_MASK) != 0)
          (void) SetImageProperty(image,"tiff:subfiletype","MASK",exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ORIGIN,&x_position,&y_position) == 1)
      {
        image->page.x=(ssize_t) ceil(x_position*image->resolution.x-0.5);
        image->page.y=(ssize_t) ceil(y_position*image->resolution.y-0.5);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_RESOLUTIONUNIT,&units) == 1)
      {
        if (units == RESUNIT_INCH)
          image->units=PixelsPerInchResolution;
        if (units == RESUNIT_CENTIMETER)
          image->units=PixelsPerCentimeterResolution;
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_XRESOLUTION,&x_resolution) == 1)
      image->resolution.x=x_resolution;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_YRESOLUTION,&y_resolution) == 1)
      image->resolution.y=y_resolution;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PLANARCONFIG,&interlace) == 1)
      image->interlace=(InterlaceType) interlace;
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PREDICTOR,&value) == 1)
      {
        if (value == PREDICTOR_HORIZONTAL)
          (void) SetImageProperty(image,"tiff:predictor","horizontal",
            exception);
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_GRAYRESPONSEUNIT,&units) == 1)
      {
        if (units == RESUNIT_CENTIMETER)
          image->units=PixelsPerCentimeterResolution;
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_GRAYRESPONSECURVE,&chromaticity) == 1)
      {
        if (chromaticity != (float *) NULL)
          {
            image->chromaticity.gray_response[0]=chromaticity[0];
            image->chromaticity.gray_response[1]=chromaticity[1];
            image->chromaticity.gray_response[2]=chromaticity[2];
            image->chromaticity.gray_response[3]=chromaticity[3];
            image->chromaticity.gray_response[4]=chromaticity[4];
            image->chromaticity.gray_response[5]=chromaticity[5];
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_TRANSFERFUNCTION,&chromaticity) == 1)
      {
        if (chromaticity != (float *) NULL)
          {
            image->chromaticity.red_primary.x=chromaticity[0];
            image->chromaticity.red_primary.y=chromaticity[1];
            image->chromaticity.green_primary.x=chromaticity[2];
            image->chromaticity.green_primary.y=chromaticity[3];
            image->chromaticity.blue_primary.x=chromaticity[4];
            image->chromaticity.blue_primary.y=chromaticity[5];
            image->chromaticity.white_point.x=chromaticity[6];
            image->chromaticity.white_point.y=chromaticity[7];
          }
      }
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_SOFTWARE,&text) == 1)
      (void) SetImageProperty(image,"tiff:software",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_ARTIST,&text) == 1)
      (void) SetImageProperty(image,"tiff:artist",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_HOSTCOMPUTER,&text) == 1)
      (void) SetImageProperty(image,"tiff:hostcomputer",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_DATETIME,&text) == 1)
      (void) SetImageProperty(image,"tiff:timestamp",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_DOCUMENTNAME,&text) == 1)
      (void) SetImageProperty(image,"tiff:document",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_PAGENAME,&text) == 1)
      (void) SetImageProperty(image,"label",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_IMAGEDESCRIPTION,&text) == 1)
      (void) SetImageProperty(image,"comment",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_MAKE,&text) == 1)
      (void) SetImageProperty(image,"tiff:make",text,exception);
    if (TIFFGetFieldDefaulted(tiff,TIFFTAG_MODEL,&text)