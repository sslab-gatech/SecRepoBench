MAX;
    }
}

static void MngInfoFreeObject(MngInfo *mng_info,int i)
{
  if (i && (i < MNG_MAX_OBJECTS) && (mng_info != (MngInfo *) NULL) &&
      mng_info->exists[i] && !mng_info->frozen[i])
    {
#ifdef MNG_OBJECT_BUFFERS
      if (mng_info->ob[i] != (MngBuffer *) NULL)
        {
          if (mng_info->ob[i]->reference_count > 0)
            mng_info->ob[i]->reference_count--;

          if (mng_info->ob[i]->reference_count == 0)
            {
              if (mng_info->ob[i]->image != (Image *) NULL)
                mng_info->ob[i]->image=DestroyImage(mng_info->ob[i]->image);

              mng_info->ob[i]=DestroyString(mng_info->ob[i]);
            }
        }
      mng_info->ob[i]=(MngBuffer *) NULL;
#endif
      mng_info->exists[i]=MagickFalse;
      mng_info->invisible[i]=MagickFalse;
      mng_info->viewable[i]=MagickFalse;
      mng_info->frozen[i]=MagickFalse;
      mng_info->x_off[i]=0;
      mng_info->y_off[i]=0;
      mng_info->object_clip[i].left=0;
      mng_info->object_clip[i].right=(ssize_t) PNG_UINT_31_MAX;
      mng_info->object_clip[i].top=0;
      mng_info->object_clip[i].bottom=(ssize_t) PNG_UINT_31_MAX;
    }
}

static void MngInfoFreeObjects(MngInfo *mng_info)
{
  register ssize_t
    i;

  for (i=0; i < MNG_MAX_OBJECTS; i++)
    MngInfoFreeObject(mng_info,i);
}

static void MngInfoFree(MngInfo *mng_info)
{
  if (mng_info != (MngInfo *) NULL)
    {
      if (mng_info->global_plte != (png_colorp) NULL)
        mng_info->global_plte=DestroyString(mng_info->global_plte);

      if (mng_info->global_trns != (png_bytep) NULL)
        mng_info->global_trns=DestroyString(mng_info->global_trns);

      MngInfoFreeObjects(mng_info);

      if (mng_info->image != (Image *) NULL)
        mng_info->image=DestroyImage(mng_info->image);

      mng_info=DestroyString(mng_info);
    }
}

static void MngInfoInit(MngInfo *mng_info)
{
  if (mng_info != (MngInfo *) NULL)
    {
      mng_info->global_plte=NULL;
      mng_info->global_plte_length=0;
      mng_info->global_trns=NULL;
      mng_info->global_trns_length=0;
      mng_info->global_gamma=1.0;
      mng_info->global_x_pixels_per_unit=0;
      mng_info->global_y_pixels_per_unit=0;
      mng_info->global_phys_unit_type=0;
      mng_info->global_srgb_intent=UndefinedIntent;
      mng_info->global_sbit.red=0;
      mng_info->global_sbit.green=0;
      mng_info->global_sbit.blue=0;
      mng_info->global_sbit.gray=0;
      mng_info->global_sbit.alpha=0;
      mng_info->global_chrm.white_x=0;
      mng_info->global_chrm.white_y=0;
      mng_info->global_chrm.red_x=0;
      mng_info->global_chrm.red_y=0;
      mng_info->global_chrm.green_x=0;
      mng_info->global_chrm.green_y=0;
      mng_info->global_chrm.blue_x=0;
      mng_info->global_chrm.blue_y=0;
      mng_info->global_chrm.green_z=0;
      mng_info->global_chrm.blue_z=0;
      mng_info->global_chrm.red_z=0;
      mng_info->global_chrm.white_z=0;
      mng_info->global_chrm.matrix[0]=0;
      mng_info->global_chrm.matrix[1]=0;
      mng_info->global_chrm.matrix[2]=0;
      mng_info->global_chrm.matrix[3]=0;
      mng_info->global_chrm.matrix[4]=0;
      mng_info->global_chrm.matrix[5]=0;
      mng_info->global_chrm.matrix[6]=0;
      mng_info->global_chrm.matrix[7]=0;
      mng_info->global_chrm.matrix[8]=0;
      mng_info->global_chrm.intent=PerceptualIntent;
      mng_info->global_srgb_intent=UndefinedIntent;
      mng_info->have_global_bkgd=MagickFalse;
      mng_info->have_global_chrm=MagickFalse;
      mng_info->have_global_gama=MagickFalse;
      mng_info->have_global_phys=MagickFalse;
      mng_info->have_global_srgb=MagickFalse;
      mng_info->have_write_global_chrm=MagickFalse;
      mng_info->have_write_global_gama=MagickFalse;
      mng_info->have_write_global_plte=MagickFalse;
      mng_info->have_write_global_srgb=MagickFalse;
      mng_info->have_saved_bkgd_index=MagickFalse;
      mng_info->write_mng=MagickFalse;
      mng_info->write_png_colortype=PNG_COLOR_TYPE_RGB;
      mng_info->write_png_depth=8;
      mng_info->write_png_compression_level=Z_DEFAULT_COMPRESSION;
      mng_info->write_png_compression_strategy=Z_DEFAULT_STRATEGY;
      mng_info->write_png_compression_filter=PNG_FILTER_NONE;
      mng_info->write_png8=MagickFalse;
      mng_info->write_png24=MagickFalse;
      mng_info->write_png32=MagickFalse;
      mng_info->write_png48=MagickFalse;
      mng_info->write_png64=MagickFalse;
      mng_info->equal_backgrounds=MagickFalse;
      mng_info->equal_chrms=MagickFalse;
      mng_info->equal_gammas=MagickFalse;
      mng_info->equal_palettes=MagickFalse;
      mng_info->equal_physs=MagickFalse;
      mng_info->equal_srgbs=MagickFalse;
      mng_info->framing_mode=0;
      mng_info->old_framing_mode=0;
      mng_info->need_fram=MagickFalse;
      mng_info->object_id=0;
      mng_info->scenes_found=0;
      mng_info->image_found=0;
      mng_info->clip.left=0;
      mng_info->clip.right=0;
      mng_info->clip.top=0;
      mng_info->clip.bottom=0;
      mng_info->frame.left=0;
      mng_info->frame.right=0;
      mng_info->frame.top=0;
      mng_info->frame.bottom=0;
      mng_info->image_box.left=0;
      mng_info->image_box.right=0;
      mng_info->image_box.top=0;
      mng_info->image_box.bottom=0;
      mng_info->ticks_per_second=0;
      mng_info->delay=0;
      mng_info->global_bkgd.red=0;
      mng_info->global_bkgd.green=0;
      mng_info->global_bkgd.blue=0;
      mng_info->global_bkgd.alpha=QuantumRange;
      mng_info->global_bkgd.opacity=OpaqueOpacity;
      mng_info->global_bkgd.fuzz=0;
      mng_info->global_bkgd.matte=MagickFalse;
      mng_info->global_bkgd.exception=NULL;
      mng_info->global_bkgd.signature=MagickCoreSignature;
      mng_info->global_bkgd.debug=MagickFalse;
      mng_info->global_bkgd.image=NULL;
      mng_info->global_bkgd.columns=0;
      mng_info->global_bkgd.rows=0;
      mng_info->global_bkgd.depth=0;
      mng_info->global_bkgd.colorspace=UndefinedColorspace;
      mng_info->global_bkgd.colormap=NULL;
      mng_info->global_bkgd.storage_class=DirectClass;
      mng_info->global_bkgd.units=PixelsPerInchResolution;
      mng_info->global_bkgd.x=0;
      mng_info->global_bkgd.y=0;
      mng_info->global_bkgd.orientation=UndefinedOrientation;
      mng_info->global_bkgd.description=NULL;
      mng_info->global_bkgd.filename=NULL;
      mng_info->global_bkgd.previous=NULL;
      mng_info->global_bkgd.next=NULL;
      mng_info->global_bkgd.previous_in_gallery=NULL;
      mng_info->global_bkgd.next_in_gallery=NULL;
      mng_info->global_bkgd.thumbnail=NULL;
      mng_info->global_bkgd.properties=NULL;
      mng_info->global_bkgd.view=NULL;
      mng_info->global_bkgd.display_timestamp=0;
      mng_info->global_bkgd.display_delay=0;
      mng_info->global_bkgd.dispose_method=UndefinedDispose;
      mng_info->global_bkgd.blend_method=UndefinedBlend;
      mng_info->global_bkgd.composite_timestamp=0;
      mng_info->global_bkgd.composite_delay=0;
      mng_info->global_bkgd.load_timestamp=0;
      mng_info->global_bkgd.iterations=0;
      mng_info->global_bkgd.scene=0;
      mng_info->global_bkgd.unique_ID=0;
      mng_info->global_bkgd.animation_tick=0;
      mng_info->global_bkgd.delay=0;
      mng_info->global_bkgd.dispose=UndefinedDispose;
      mng_info->global_bkgd.blend=UndefinedBlend;
      mng_info->global_bkgd.timestamp=0;
      mng_info->global_bkgd.duration=0;
      mng_info->global_bkgd.x_resolution=0;
      mng_info->global_bkgd.y_resolution=0;
      mng_info->global_bkgd.units_per_pixel=PixelsPerInchResolution;
      mng_info->global_bkgd