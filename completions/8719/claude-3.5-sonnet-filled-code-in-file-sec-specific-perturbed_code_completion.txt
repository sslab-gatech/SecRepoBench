(void) memset(type,0,4);
length=(size_t) ReadBlobMSBLong(image);
(void) LogMagickEvent(CoderEvent,GetMagickModule(),
  "  Reading PNG chunk type %c%c%c%c, length: %.20g",
  type[0],type[1],type[2],type[3],(double) length);

if (length > PNG_UINT_31_MAX)
  png_error(ping,"chunk length exceeds PNG_UINT_31_MAX");

if (length > GetBlobSize(image))
  png_error(ping,"chunk length exceeds file size");

chunk_data=(unsigned char *) AcquireQuantumMemory(length,sizeof(*chunk_data));

if (chunk_data == (unsigned char *) NULL)
  png_error(ping,"unable to allocate chunk");

for (i=0; i < (ssize_t) length; i++)
{
  int
    c;

  c=ReadBlobByte(image);
  if (c == EOF)
  {
    chunk_data=(unsigned char *) RelinquishMagickMemory(chunk_data);
    png_error(ping,"insufficient image data");
  }
  chunk_data[i]=(unsigned char) c;
}

p=chunk_data;