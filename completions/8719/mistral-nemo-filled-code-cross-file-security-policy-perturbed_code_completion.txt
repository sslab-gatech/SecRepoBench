{
  unsigned char
    *chunk_data;

  // Read the next chunk from the MNG image file.
  // Initialize the chunk type to a default error value and read its length.
  // Log the event if logging is enabled, displaying the chunk type and length.
  // Verify if the length is valid and handle errors accordingly.
  // Prepare for reading the chunk data by initializing necessary pointers.
  // <MASK>

  if (length != 0)
    {
      chunk_data=(unsigned char *) AcquireQuantumMemory(length,sizeof(*chunk_data));

      if (chunk_data == (unsigned char *) NULL)
        ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");

      for (i=0; i < (ssize_t) length; i++)
      {
        int
          c;

        c=ReadBlobByte(image);
        if (c == EOF)
          {
            chunk_data=(unsigned char *) RelinquishMagickMemory(chunk_data);
            ThrowReaderException(CorruptImageError,
              "InsufficientImageDataInFile");
          }
        chunk_data[i]=(unsigned char) c;
      }

      p=chunk_data;
    }

  (void) ReadBlobMSBLong(image);  /* read crc word */

#if !defined(JNG_SUPPORTED)
  if (memcmp(type,mng_JHDR,4) == 0)
    {
      skip_to_iend=MagickTrue;

      if (mng_info->jhdr_warning == 0)
        (void) ThrowMagickException(exception,GetMagickModule(),
          CoderError,"JNGCompressNotSupported","`%s'",image->filename);

      mng_info->jhdr_warning++;
    }
#endif
  if (memcmp(type,mng_DHDR,4) == 0)
    {
      skip_to_iend=MagickTrue;

      if (mng_info->dhdr_warning == 0)
        (void) ThrowMagickException(exception,GetMagickModule(),
          CoderError,"DeltaPNGNotSupported","`%s'",image->filename);

      mng_info->dhdr_warning++;
    }
  if (memcmp(type,mng_MEND,4) == 0)
    {
      chunk_data=(unsigned char *) RelinquishMagickMemory(chunk_data);
      break;
    }

  if (skip_to_iend)
    {
      if (memcmp(type,mng_IEND,4) == 0)
        skip_to_iend=MagickFalse;

      chunk_data=(unsigned char *) RelinquishMagickMemory(chunk_data);

      if (logging != MagickFalse)
        (void) LogMagickEvent(CoderEvent,GetMagickModule(),
          "  Skip to IEND.");

      continue;
    }

  if (memcmp(type,mng_MHDR,4) == 0)
    {
      if (length != 28)
        {
          chunk_data=(unsigned char *) RelinquishMagickMemory(chunk_data);
          ThrowReaderException(CorruptImageError,"CorruptImage");
        }

      mng_info->mng_width=(unsigned long)mng_get_long(p);
      mng_info->mng_height=(unsigned long)mng_get_long(&p[4]);

      if (logging != MagickFalse)
        {
          (void) LogMagickEvent(CoderEvent,GetMagickModule(),
            "  MNG width: %.20g",(double) mng_info->mng_width);
          (void) LogMagickEvent(CoderEvent,GetMagickModule(),
            "  MNG height: %.20g",(double) mng_info->mng_height);
        }

      p+=8;
      mng_info->ticks_per_second=1UL*image->ticks_per_second;
      object_id=0;
      skip_to_iend=MagickFalse;
      term_chunk_found=MagickFalse;
      mng_info->framing_mode=1;
#if defined(MNG_INSERT_LAYERS)
      insert_layers=MagickFalse; /* should be False during convert or mogrify */
#endif
      default_frame_delay=0;
      frame_delay=default_frame_delay;
      mng_info->ticks_per_second=1UL*image->ticks_per_second;
      object_id=0;
      skip_to_iend=MagickFalse;
      term_chunk_found=MagickFalse;
      mng_info->framing_mode=1;
#if defined(MNG_INSERT_LAYERS)
      insert_layers=MagickFalse; /* should be False during convert or mogrify */
#endif
      default_frame_delay=0;
      frame_delay=default_frame_delay;
      mng_info->ticks_per_second=1UL*image->ticks_per_second;
      object_id=0;
      skip_to_iend=MagickFalse;
      term_chunk_found=MagickFalse;
      mng_info->framing_mode=1;
#if defined(MNG_INSERT_LAYERS)
      insert_layers=MagickFalse; /* should be False during convert or mogrify */
#endif
      default_frame_delay=0;
      frame_delay=default_frame_delay;
      mng_info->ticks_per_second=1UL*image->ticks_per_second;
      object_id=0;
      skip_to_iend=MagickFalse;
      term_chunk_found=MagickFalse;
      mng_info->framing_mode=1;
#if defined(MNG_INSERT_LAYERS)
      insert_layers=MagickFalse; /* should be False during convert or mogrify */
#endif
      default_frame_delay=0;
      frame_delay=default_frame_delay;
      mng_info->ticks_per_second=1UL*image->ticks_per_second;
      object_id=0;
      skip_to_iend=MagickFalse;
      term_chunk_found=MagickFalse;
      mng_info->framing_mode=1;
#if defined(MNG_INSERT_LAYERS)
      insert_layers=MagickFalse; /* should be False during convert or mogrify */
#endif
      default_frame_delay=0;
      frame_delay=default_frame_delay;
      mng_info->ticks_per_second=1UL*image->ticks_per_second;
      object_id=0;
      skip_to_iend=MagickFalse;
      term_chunk_found=MagickFalse;
      mng_info->framing_mode=1;
#if defined(MNG_INSERT_LAYERS)
      insert_layers=MagickFalse; /* should be False during convert or mogrify */
#endif
      default_frame_delay=0;
      frame_delay=default_frame_delay;
      mng_info->ticks_per_second=1UL*image->ticks_per_second;
      object_id=0;
      skip_to_iend=MagickFalse;
      term_chunk_found=MagickFalse;
      mng_info->framing_mode=1;
#if defined(MNG_INSERT_LAYERS)
      insert_layers=MagickFalse; /* should be False during convert or mogrify */
#endif
      default_frame_delay=0;
      frame_delay=default_frame_delay;
      mng_info->ticks_per_second=1UL*image->ticks_per_second;
      object_id=0;
      skip_to_iend=MagickFalse;
      term_chunk_found=MagickFalse;
      mng_info->framing_mode=1;
#if defined(MNG_INSERT_LAYERS)
      insert_layers=MagickFalse; /* should be False during convert or mogrify */
#endif
      default_frame_delay=0;
      frame_delay=default_frame_delay;
      mng_info->ticks_per_second=1UL*image->ticks_per_second;
      object_id=0;
      skip_to_iend=MagickFalse;
      term_chunk_found=MagickFalse;
      mng_info->framing_mode=1;
#if defined(MNG_INSERT_LAYERS)
      insert_layers=MagickFalse; /* should be False during convert or mogrify */
#endif
      default_frame_delay=0;
      frame_delay=default_frame_delay;
      mng_info->ticks_per_second=1UL*image->ticks_per_second;
      object_id=0;
      skip_to_iend=MagickFalse;
      term_chunk_found=MagickFalse;
      mng_info->framing_mode=1;
#if defined(MNG_INSERT_LAYERS)
      insert_layers=MagickFalse; /* should be False during convert or mogrify */
#endif
      default_frame_delay=0;
      frame_delay=default_frame_delay;
      mng_info->ticks_per_second=1UL*image->ticks_per_second;
      object_id=0;
      skip_to_iend=MagickFalse;
      term_chunk_found=MagickFalse;
      mng_info->framing_mode=1;
#if defined(MNG_INSERT_LAYERS)
      insert_layers=MagickFalse; /* should be False during convert or mogrify */
#endif
      default_frame_delay=0;
      frame_delay=default_frame_delay;
      mng_info->ticks_per_second=1UL*image->ticks_per_second;
      object_id=0;
      skip_to_iend=MagickFalse;
      term_chunk_found=MagickFalse;
      mng_info->framing_mode=1;
#if defined(MNG_INSERT_LAYERS)
      insert_layers=MagickFalse; /* should be False during convert or mogrify */
#endif
      default_frame_delay=0;
      frame_delay=default_frame_delay;
      mng_info->ticks_per_second=1UL*image->ticks_per_second;
      object_id=0;
      skip_to_iend=MagickFalse;
      term_chunk_found=MagickFalse;
      mng_info->framing_mode=1;
#if defined(MNG_INSERT_LAYERS)
      insert_layers=MagickFalse; /* should be False during convert or mogrify */
#endif
      default_frame_delay=0;
      frame_delay=default_frame_delay;
      mng_info->ticks_per_second=1UL*image->ticks_per_second;
      object_id=0;
      skip_to_iend=MagickFalse;
      term_chunk_found=MagickFalse;
      mng_info->framing_mode=1;
#if defined(MNG_INSERT_LAYERS)
      insert_layers=MagickFalse; /* should be False during convert or mogrify */
#endif
      default_frame_delay=0;
      frame_delay=default_frame_delay;
      mng_info->ticks_per_second=1UL*image->ticks_per_second;
      object_id=0;
      skip_to_iend=MagickFalse;
      term_chunk_found=MagickFalse;
      mng_info->framing_mode=1;
#if defined(MNG_INSERT_LAYERS)
      insert_layers=MagickFalse; /* should be False during convert or mogrify */
#endif
      default_frame_delay=0;
      frame_delay=default_frame_delay;
      mng_info->ticks_per_second=1UL*image->ticks_per_second;
      object_id=0;
      skip_to_iend=MagickFalse;
      term_chunk_found=MagickFalse;
      mng_info->framing_mode=1;
#if defined(MNG_INSERT_LAYERS)
      insert_layers=MagickFalse; /* should be False during convert or mogrify */
#endif
      default_frame_delay=0;
      frame_delay=default_frame_delay;
      mng_info->ticks_per_second=1UL*image->ticks_per_second;
      object_id=0;
      skip_to_iend=MagickFalse;
      term_chunk_found=MagickFalse;
      mng_info->framing_mode=1;
#if defined(MNG_INSERT_LAYERS)
      insert_layers=MagickFalse; /* should be False during convert or mogrify */
#endif
      default_frame_delay=0;
      frame_delay=default_frame_delay;
      mng_info->ticks_per_second=1UL*image->ticks_per_second;
      object_id=0;
      skip_to_iend=MagickFalse;
      term_chunk_found=MagickFalse;
      mng_info->framing_mode=1;
#if defined(MNG_INSERT_LAYERS)
      insert_layers=MagickFalse; /* should be False during convert or mogrify */
#endif
      default_frame_delay=0;
      frame_delay=default_frame_delay;
      mng_info->ticks_per_second=1UL*image->ticks_per_second;
      object_id=0;
      skip_to_iend=MagickFalse;
      term_chunk_found=MagickFalse;
      mng_info->framing_mode=1;
#if defined(MNG_INSERT_LAYERS)
      insert_layers=MagickFalse; /* should be False during convert or mogrify */
#endif
      default_frame_delay=0;
      frame_delay=default_frame_delay;
      mng_info->ticks_per_second=1UL*image->ticks_per_second;
      object_id=0;
      skip_to_iend=MagickFalse;
      term_chunk_found=MagickFalse;
      mng_info->framing_mode=1;
#if defined(MNG_INSERT_LAYERS)
      insert_layers=MagickFalse; /* should be False during convert or mogrify */
#endif
      default_frame_delay=0;
      frame_delay=default_frame_delay;
      mng_info->ticks_per_second=1UL*image->ticks_per_second;
      object_id=0;
      skip_to_iend=MagickFalse;
      term_chunk_found=MagickFalse;
      mng_info->framing_mode=1;
#if defined(MNG_INSERT_LAYERS)
      insert_layers=MagickFalse; /* should be False during convert or mogrify */
#endif
      default_frame_delay=0;
      frame_delay=default_frame_delay;
      mng_info->ticks_per_second=1UL*image->ticks_per_second;
      object_id=0;
      skip_to_iend=MagickFalse;
      term_chunk_found=MagickFalse;
      mng_info->framing_mode=1;
#if defined(MNG_INSERT_LAYERS)
      insert_layers=Ma