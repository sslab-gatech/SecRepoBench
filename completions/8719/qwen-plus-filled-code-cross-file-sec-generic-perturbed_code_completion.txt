length=ReadBlobMSBLong(image);
if (length > PNG_UINT_31_MAX || length < 0)
{
  ThrowReaderException(CorruptImageError,"ImproperImageHeader");
}

/* Read the chunk type */
if (ReadBlobString(image, type) == NULL)
{
  ThrowReaderException(CorruptImageError,"ImproperImageHeader");
}

if (logging != MagickFalse)
{
  (void) LogMagickEvent(CoderEvent,GetMagickModule(),
    "  Reading %c%c%c%c chunk, length: %.20g",
    type[0],type[1],type[2],type[3], (double) length);
}

if (length > (size_t) GetBlobSize(image))
{
  ThrowReaderException(CorruptImageError,"InsufficientImageDataInFile");
}

p = NULL;