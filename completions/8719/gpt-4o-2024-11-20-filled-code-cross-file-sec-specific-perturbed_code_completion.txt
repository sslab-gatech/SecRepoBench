// Initialize the chunk type to a default error value
        (void) memset(type, 0, sizeof(type));

        // Read the chunk length
        length = (size_t) ReadBlobMSBLong(image);

        // Read the chunk type
        count = ReadBlob(image, 4, (unsigned char *) type);
        if (count != 4)
          ThrowReaderException(CorruptImageError, "CorruptImage");

        if (logging != MagickFalse)
          (void) LogMagickEvent(CoderEvent, GetMagickModule(),
            "  Reading %c%c%c%c chunk, length: %.20g", type[0], type[1], type[2], type[3], (double) length);

        // Validate the chunk length
        if (length > PNG_UINT_31_MAX)
          ThrowReaderException(CorruptImageError, "CorruptImage");

        // Prepare to read the chunk data
        chunk_data = (unsigned char *) NULL;
        if (length != 0)
        {
          chunk_data = (unsigned char *) AcquireQuantumMemory(length, sizeof(*chunk_data));
          if (chunk_data == (unsigned char *) NULL)
            ThrowReaderException(ResourceLimitError, "MemoryAllocationFailed");

          count = ReadBlob(image, length, chunk_data);
          if (count != length)
          {
            chunk_data = (unsigned char *) RelinquishMagickMemory(chunk_data);
            ThrowReaderException(CorruptImageError, "InsufficientImageDataInFile");
          }
        }