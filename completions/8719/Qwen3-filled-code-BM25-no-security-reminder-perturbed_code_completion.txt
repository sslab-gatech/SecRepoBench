length = ReadBlobMSBLong(image);
if (length > PNG_UINT_31_MAX)
  ThrowReaderException(CorruptImageError,"CorruptImage");

count = ReadBlob(image, 4, (unsigned char *) type);
if (count != 4)
  ThrowReaderException(CorruptImageError,"ImproperImageHeader");

if (logging != MagickFalse)
  (void) LogMagickEvent(CoderEvent,GetMagickModule(),
    "  Processing %c%c%c%c chunk, length: %zu", type[0], type[1], type[2], type[3], length);

if (length > (MagickSizeType) (GetBlobSize(image) - TellBlob(image)))
  ThrowReaderException(CorruptImageError,"CorruptImage");