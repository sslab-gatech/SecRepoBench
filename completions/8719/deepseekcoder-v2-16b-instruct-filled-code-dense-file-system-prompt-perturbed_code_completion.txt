image,GetPixelGreen(image,pixels),
                            q);
                          SetPixelBlue(large_image,GetPixelBlue(image,pixels),q);
                          SetPixelAlpha(large_image,GetPixelAlpha(image,pixels),q);
                        }

                      else
                        {
                          /* interpolate */
                          if (x == 0)
                            {
                              SetPixelRed(large_image,GetPixelRed(image,pixels),q);
                              SetPixelGreen(large_image,GetPixelGreen(image,pixels),
                                q);
                              SetPixelBlue(large_image,GetPixelBlue(image,pixels),q);
                              SetPixelAlpha(large_image,GetPixelAlpha(image,pixels),q);
                            }

                          else
                            {
                              SetPixelRed(large_image,
                                (MagickRealType) (GetPixelRed(image,pixels) +
                                (MagickRealType) (GetPixelRed(image,n) -
                                GetPixelRed(image,pixels)) *
                                (MagickRealType) (i+1) /
                                (MagickRealType) (mng_info->magn_my)),q);
                              SetPixelGreen(large_image,
                                (MagickRealType) (GetPixelGreen(image,pixels) +
                                (MagickRealType) (GetPixelGreen(image,n) -
                                GetPixelGreen(image,pixels)) *
                                (MagickRealType) (i+1) /
                                (MagickRealType) (mng_info->magn_my)),q);
                              SetPixelBlue(large_image,
                                (MagickRealType) (GetPixelBlue(image,pixels) +
                                (MagickRealType) (GetPixelBlue(image,n) -
                                GetPixelBlue(image,pixels)) *
                                (MagickRealType) (i+1) /
                                (MagickRealType) (mng_info->magn_my)),q);
                              SetPixelAlpha(large_image,
                                (MagickRealType) (GetPixelAlpha(image,pixels) +
                                (MagickRealType) (GetPixelAlpha(image,n) -
                                GetPixelAlpha(image,pixels)) *
                                (MagickRealType) (i+1) /
                                (MagickRealType) (mng_info->magn_my)),q);
                            }
                        }
                      pixels+=GetPixelChannels(image);
                      n+=GetPixelChannels(image);
                      q+=GetPixelChannels(large_image);
                    }
                    if (SyncAuthenticPixels(large_image,exception) == MagickFalse)
                      break;
                  }
                }
                if (prev != (Quantum *) NULL)
                  prev=(Quantum *) RelinquishMagickMemory(prev);
                if (next != (Quantum *) NULL)
                  next=(Quantum *) RelinquishMagickMemory(next);
              }

            if (image->alpha_trait != UndefinedPixelTrait)
              {
                crop_box=mng_info->frame;
                crop_box.left=0;
                crop_box.right=image->columns;
                crop_box.top=0;
                crop_box.bottom=image->rows;
                image=CropImage(image,crop_box.right-crop_box.left,
                  crop_box.bottom-crop_box.top,crop_box.left,crop_box.top,
                  exception);
              }

            if (image->columns == 0 || image->rows == 0)
              {
                image=DestroyImageList(image);
                ThrowReaderException(CorruptImageError,"ImproperImageHeader");
              }

            image=ResizeImage(image,magnified_width,magnified_height,
              LanczosFilter,1.0,exception);

            if (image->columns == 0 || image->rows == 0)
              {
                image=DestroyImageList(image);
                ThrowReaderException(CorruptImageError,"ImproperImageHeader");
              }

            if (image->alpha_trait != UndefinedPixelTrait)
              {
                crop_box=mng_info->frame;
                crop_box.left=0;
                crop_box.right=image->columns;
                crop_box.top=0;
                crop_box.bottom=image->rows;
                image=CropImage(image,crop_box.right-crop_box.left,
                  crop_box.bottom-crop_box.top,crop_box.left,crop_box.top,
                  exception);
              }

            if (image->columns == 0 || image->rows == 0)
              {
                image=DestroyImageList(image);
                ThrowReaderException(CorruptImageError,"ImproperImageHeader");
              }

            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Magnified image to %.20g x %.20g",
                (double) image->columns,(double) image->rows);
          }

        if (mng_info->magn_methx || mng_info->magn_methy)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Processing MNG MAGN chunk");

            if (mng_info->magn_methx == 2)
              {
                png_uint_32
                  magnified_width;

                if (image->columns > 1)
                   magnified_width += mng_info->magn_mr;

                if (image->columns > 2)
                   magnified_width += (png_uint_32)
                      ((image->columns-2)*(mng_info->magn_mx));

                image=ResizeImage(image,magnified_width,image->rows,
                  LanczosFilter,1.0,exception);

                if (image->columns == 0 || image->rows == 0)
                  {
                    image=DestroyImageList(image);
                    ThrowReaderException(CorruptImageError,"ImproperImageHeader");
                  }

                if (logging != MagickFalse)
                  (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                    "  Magnified image to %.20g x %.20g",
                    (double) image->columns,(double) image->rows);
              }

            if (mng_info->magn_methy == 2)
              {
                png_uint_32
                  magnified_height;

                if (image->rows > 1)
                   magnified_height += mng_info->magn_mb;

                if (image->rows > 2)
                   magnified_height += (png_uint_32)
                      ((image->rows-2)*(mng_info->magn_my));

                image=ResizeImage(image,image->columns,magnified_height,
                  LanczosFilter,1.0,exception);

                if (image->columns == 0 || image->rows == 0)
                  {
                    image=DestroyImageList(image);
                    ThrowReaderException(CorruptImageError,"ImproperImageHeader");
                  }

                if (logging != MagickFalse)
                  (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                    "  Magnified image to %.20g x %.20g",
                    (double) image->columns,(double) image->rows);
              }
          }

        if (mng_info->magn_methx || mng_info->magn_methy)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Processing MNG MAGN chunk");

            if (mng_info->magn_methx == 3)
              {
                png_uint_32
                  magnified_width;

                if (image->columns > 1)
                   magnified_width += mng_info->magn_mr;

                if (image->columns > 2)
                   magnified_width += (png_uint_32)
                      ((image->columns-2)*(mng_info->magn_mx));

                image=ResizeImage(image,magnified_width,image->rows,
                  LanczosFilter,1.0,exception);

                if (image->columns == 0 || image->rows == 0)
                  {
                    image=DestroyImageList(image);
                    ThrowReaderException(CorruptImageError,"ImproperImageHeader");
                  }

                if (logging != MagickFalse)
                  (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                    "  Magnified image to %.20g x %.20g",
                    (double) image->columns,(double) image->rows);
              }

            if (mng_info->magn_methy == 3)
              {
                png_uint_32
                  magnified_height;

                if (image->rows > 1)
                   magnified_height += mng_info->magn_mb;

                if (image->rows > 2)
                   magnified_height += (png_uint_32)
                      ((image->rows-2)*(mng_info->magn_my));

                image=ResizeImage(image,image->columns,magnified_height,
                  LanczosFilter,1.0,exception);

                if (image->columns == 0 || image->rows == 0)
                  {
                    image=DestroyImageList(image);
                    ThrowReaderException(CorruptImageError,"ImproperImageHeader");
                  }

                if (logging != MagickFalse)
                  (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                    "  Magnified image to %.20g x %.20g",
                    (double) image->columns,(double) image->rows);
              }
          }

        if (mng_info->magn_methx || mng_info->magn_methy)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Processing MNG MAGN chunk");

            if (mng_info->magn_methx == 4)
              {
                png_uint_32
                  magnified_width;

                if (image->columns > 2)
                   magnified_width += (png_uint_32)
                      ((image->columns-2)*(mng_info->magn_mx));

                image=ResizeImage(image,magnified_width,image->rows,
                  LanczosFilter,1.0,exception);

                if (image->columns == 0 || image->rows == 0)
                  {
                    image=DestroyImageList(image);
                    ThrowReaderException(CorruptImageError,"ImproperImageHeader");
                  }

                if (logging != MagickFalse)
                  (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                    "  Magnified image to %.20g x %.20g",
                    (double) image->columns,(double) image->rows);
              }

            if (mng_info->magn_methy == 4)
              {
                png_uint_32
                  magnified_height;

                if (image->rows > 2)
                   magnified_height += (png_uint_32)
                      ((image->rows-2)*(mng_info->magn_my));

                image=ResizeImage(image,image->columns,magnified_height,
                  LanczosFilter,1.0,exception);

                if (image->columns == 0 || image->rows == 0)
                  {
                    image=DestroyImageList(image);
                    ThrowReaderException(CorruptImageError,"ImproperImageHeader");
                  }

                if (logging != MagickFalse)
                  (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                    "  Magnified image to %.20g x %.20g",
                    (double) image->columns,(double) image->rows);
              }
          }

        if (mng_info->magn_methx || mng_info->magn_methy)
          {
            if (logging != MagickFalse)
              (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                "  Processing MNG MAGN chunk");

            if (mng_info->magn_methx == 5)
              {
                png_uint_32
                  magnified_width;

                if (image->columns > 3)
                   magnified_width += (png_uint_32)
                      ((image->columns-3)*(mng_info->magn_mx));

                image=ResizeImage(image,magnified_width,image->rows,
                  LanczosFilter,1.0,exception);

                if (image->columns == 0 || image->rows == 0)
                  {
                    image=DestroyImageList(image);
                    ThrowReaderException(CorruptImageError,"ImproperImageHeader");
                  }

                if (logging != MagickFalse)
                  (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                    "  Magnified