(void) memset(type,0,MagickPathExtent);
length=(size_t) ReadBlobMSBLong(image);

if (length > PNG_UINT_31_MAX)
  {
    /* Chunk data length exceeds PNG specification */
    status=MagickFalse;
    break;
  }

for (i=0; i < 4; i++)
{
  int
    c;

  c=ReadBlobByte(image);
  if (c == EOF)
    {
      status=MagickFalse;
      break;
    }
  type[i]=(char) c;
}

if (status == MagickFalse)
  break;

if (logging != MagickFalse)
  (void) LogMagickEvent(CoderEvent,GetMagickModule(),
    "  Reading PNG chunk type %c%c%c%c, length: %.20g",
    type[0],type[1],type[2],type[3],(double) length);

if (length > GetBlobSize(image))
  {
    status=MagickFalse;
    break;
  }

chunk_data=(unsigned char *) NULL;