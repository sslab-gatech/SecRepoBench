// Read the next chunk from the MNG image file.
count=(size_t) ReadBlob(image,4,(unsigned char *) type);
if (count < 4)
  ThrowReaderException(CorruptImageError,"InsufficientImageDataInFile");

// Initialize the chunk type to a default error value and read its length.
if (memcmp(type,mng_MEND,4) == 0)
  break;

// Log the event if logging is enabled, displaying the chunk type and length.
if (logging!= MagickFalse)
  (void) LogMagickEvent(CoderEvent,GetMagickModule(),
    "  Processing %c%c%c%c chunk",type[0],type[1],type[2],type[3]);

// Read the length of the chunk.
length=(png_uint_32) mng_get_long(p);

// Verify if the length is valid and handle errors accordingly.
if (length > GetBlobSize(image))
  ThrowReaderException(CorruptImageError,"CorruptImage");

// Prepare for reading the chunk data by initializing necessary pointers.
p=(unsigned char *) AcquireQuantumMemory(length,sizeof(*p));
if (p == (unsigned char *) NULL)
  ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");

// Read the chunk data.
for (i=0; i < (ssize_t) length; i++)
{
  int
    c;

  c=ReadBlobByte(image);
  if (c == EOF)
    {
      p=(unsigned char *) RelinquishMagickMemory(p);
      ThrowReaderException(CorruptImageError,
        "InsufficientImageDataInFile");
    }
  p[i]=(unsigned char) c;
}