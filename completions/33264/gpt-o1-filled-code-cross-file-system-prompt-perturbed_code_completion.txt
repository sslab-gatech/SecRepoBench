/* Initialize variables for tracking uncompressed data */
  int32_t ntbytes = 0;
  int32_t stop = start + nitems;

  /* Check if there are no items to process */
  if (nitems <= 0) {
    return 0;
  }

  /* Validate that the destination buffer is large enough */
  if ((int64_t)nitems * hdr->typesize > destsize) {
    BLOSC_TRACE_ERROR("Destination buffer is not large enough for the requested items.");
    return BLOSC2_ERROR_WRITE_BUFFER;
  }

  /* Make sure requested range is within our data */
  int32_t total_items = (int32_t)(hdr->nbytes / hdr->typesize);
  if (start < 0 || stop > total_items) {
    BLOSC_TRACE_ERROR("Requested range is out of the existing data boundaries.");
    return BLOSC2_ERROR_INVALID_PARAM;
  }

  /* Determine if the chunk is memcpyed based on flags/context */
  bool memcpyed = (context->header_flags & (uint8_t)BLOSC_MEMCPYED) != 0;
  if (!context->do_compress && context->special_type) {
    /* Treat special chunks as memcpyed */
    memcpyed = true;
  }