int32_t j, bsize, bsize2, ebsize, startb, stopb, leftoverblock;
  int32_t ntbytes = 0;
  int32_t stop = start + nitems;
  bool memcpyed = hdr->flags & (uint8_t)BLOSC_MEMCPYED;
  if (nitems <= 0) {
    return 0;
  }
  if (destsize < (size_t)nitems * hdr->typesize) {
    return BLOSC2_ERROR_DEST_BUFFER_TOO_SMALL;
  }
  uint8_t* bstarts = (uint8_t*)(context->bstarts);
  if (context->nblocks <= 0) {
    return 0;
  }
  if (start < 0 || stop > hdr->nblocks * hdr->blocksize / hdr->typesize) {
    return BLOSC2_ERROR_INVALID_RANGE;
  }
  if (memcpyed || context->special_type) {
    size_t nbytes = (size_t)nitems * hdr->typesize;
    memcpy(dest, _src + context->header_overhead + start * hdr->typesize, nbytes);
    return (int32_t)nbytes;
  }