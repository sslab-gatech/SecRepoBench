// Calculate the stopping position based on the start position and number of items.
  int stop = start + nitems;
  if (nitems == 0) {
    return 0;  // No items to process
  }

  // Validate that the destination buffer is large enough for the decompressed data.
  if (destsize < nitems * hdr->typesize) {
    return BLOSC2_ERROR_WRITE_BUFFER;
  }

  // Determine if the data should be treated as memcpyed based on header flags or context type.
  bool memcpyed = (hdr->flags & BLOSC_MEMCPYED) != 0;