int32_t j, bsize, leftoverblock, bsize2, startb, stopb;
  int32_t ntbytes = 0;
  int32_t stop = start + nitems;
  bool memcpyed = hdr->flags & (uint8_t)BLOSC_MEMCPYED;
  if (!context->do_compress && context->special_type) {
    // Fake a runlen as if its a memcpyed chunk
    memcpyed = true;
  }

  if (nitems <= 0) {
    return 0;
  }

  if (destsize < nitems * hdr->typesize) {
    return BLOSC2_ERROR_WRITE_BUFFER;
  }

  if (start < 0 || stop > hdr->nbytes / hdr->typesize) {
    return BLOSC2_ERROR_INVALID_PARAM;
  }