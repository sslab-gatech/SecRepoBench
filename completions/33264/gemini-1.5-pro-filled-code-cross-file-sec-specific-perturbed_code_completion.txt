int32_t ntbytes = 0;                /* Number of transferred bytes */
  int32_t bsize, bsize2, leftoverblock;  /* Current, transferred and leftover block sizes */
  int32_t ebsize;                      /* effective block size */
  int j, startb, stopb;               /* block counters */
  int stop = start + nitems;          /* stopping position */
  bool memcpyed = (hdr->flags & BLOSC_MEMCPYED) || context->special_type;

  if (nitems == 0) {
    return 0;                        /* nothing to do */
  }

  if (destsize < nitems * hdr->typesize) {
    BLOSC_TRACE_ERROR("Destination buffer size too small.");
    return BLOSC2_ERROR_OUTPUT_BUFFER_TOO_SMALL;
  }

  /* Check region boundaries */
  if ((start < 0) || (stop > hdr->nitems)) {
    BLOSC_TRACE_ERROR("Start or stop out of bounds.");
    return BLOSC2_ERROR_ITEM_OUT_OF_BOUNDS;
  }