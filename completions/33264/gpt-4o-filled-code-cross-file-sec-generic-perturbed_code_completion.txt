int32_t j, bsize, leftoverblock;
  int32_t cbytes;
  int32_t ntbytes = 0;
  int32_t startb, stopb, bsize2;
  int32_t ebsize;
  bool memcpyed = hdr->flags & BLOSC_MEMCPYED;

  // Calculate the stopping position
  int stop = start + nitems;

  // Check if there are no items to process
  if (nitems <= 0) {
    return 0;
  }

  // Validate that the destination buffer is large enough
  if (destsize < nitems * hdr->typesize) {
    return BLOSC2_ERROR_WRITE_BUFFER;
  }

  // Verify that the start and stop positions are within valid bounds
  if (start < 0 || stop > hdr->nitems) {
    return BLOSC2_ERROR_INVALID_PARAM;
  }