int32_t total_items = (int32_t)(hdr->nbytes / hdr->typesize);
if (nitems <= 0) {
    return 0;
}
if (start >= total_items) {
    return 0;
}
int32_t stop = start + nitems;
if (stop > total_items) {
    stop = total_items;
    nitems = stop - start;
}
int32_t dest_required = nitems * hdr->typesize;
if (destsize < dest_required) {
    return BLOSC2_ERROR_WRITE_BUFFER;
}
bool memcpyed = (hdr->flags & BLOSC_MEMCPYED) != 0;
if (!context->do_compress && context->special_type) {
    memcpyed = true;
}
int32_t ntbytes = 0;
int32_t j, bsize, leftoverblock, startb, stopb, bsize2, cbytes;