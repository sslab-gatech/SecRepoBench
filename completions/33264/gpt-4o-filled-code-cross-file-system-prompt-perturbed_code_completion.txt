int32_t ntbytes = 0;  // Total number of bytes decompressed
  int32_t stop = start + nitems;  // Calculate the stopping position

  // Check if there are no items to process
  if (nitems <= 0) {
    return 0;
  }

  // Validate that the destination buffer is large enough
  if (destsize < nitems * hdr->typesize) {
    return BLOSC2_ERROR_WRITE_BUFFER;
  }

  // Determine if the data should be treated as memcpyed
  bool memcpyed = context->header_flags & (uint8_t)BLOSC_MEMCPYED;
  if (!context->do_compress && context->special_type) {
    // Fake a runlen as if its a memcpyed chunk
    memcpyed = true;
  }