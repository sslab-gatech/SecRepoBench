int32_t j, bsize, leftoverblock, bsize2, startb, stopb;
  int32_t ntbytes = 0;
  bool memcpyed = hdr->flags & (uint8_t)BLOSC_MEMCPYED;
  int32_t stop = start + nitems;

  /* Check for no items to process */
  if (nitems <= 0) {
    return 0;
  }

  /* Check that dest is large enough */
  if (destsize < nitems * hdr->typesize) {
    return BLOSC2_ERROR_WRITE_BUFFER;
  }

  /* Check bounds */
  if (start < 0 || stop * hdr->typesize > hdr->nbytes) {
    return BLOSC2_ERROR_INVALID_PARAM;
  }

  /* Handle memcpyed case */
  if (memcpyed) {
    memcpy(dest, _src + context->header_overhead + start * hdr->typesize,
           (unsigned int)(nitems * hdr->typesize));
    return nitems * hdr->typesize;
  }