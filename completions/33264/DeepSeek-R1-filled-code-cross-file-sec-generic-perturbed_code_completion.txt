int32_t ntbytes = 0;
if (nitems <= 0) {
    return 0;
}
int32_t stop = start + nitems;
int32_t typesize = hdr->typesize;
int32_t nelems = hdr->nbytes / typesize;

if ((int64_t)nitems * typesize > destsize) {
    return BLOSC2_ERROR_DESTINATION_TOO_SMALL;
}

if (start < 0 || stop > nelems) {
    return BLOSC2_ERROR_INVALID_PARAM;
}

bool memcpyed = (hdr->flags & BLOSC_MEMCPYED) != 0;
if (context->special_type) {
    memcpyed = true;
}