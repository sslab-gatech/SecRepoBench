int32_t ntbytes = 0;  // Total number of decompressed bytes
  int32_t stop = start + nitems;  // Calculate the stopping position

  // Check if there are no items to process
  if (nitems <= 0) {
    return 0;
  }

  // Validate that the destination buffer is large enough
  if (destsize < nitems * hdr->typesize) {
    return BLOSC2_ERROR_WRITE_BUFFER;
  }

  // Determine if the data is memcpyed
  bool memcpyed = hdr->flags & BLOSC_MEMCPYED;

  // Handle special case for memcpyed data
  if (memcpyed) {
    memcpy(dest, _src + context->header_overhead + start * hdr->typesize, nitems * hdr->typesize);
    return nitems * hdr->typesize;
  }