if (context->block_maskout != NULL && context->block_maskout[nblock]) {
        // Skip decompression for this block
        ntbytes += bsize;
        nblock_++;
        continue;
    }

    // Ensure that the destination buffer is large enough
    if (ntbytes + bsize2 > destsize) {
        BLOSC_TRACE_ERROR("Destination buffer is not large enough.");
        return BLOSC2_ERROR_WRITE_BUFFER;
    }

    // Perform the decompression
    cbytes = blosc_d(context->serial_context, bsize, leftoverblock, memcpyed,
                     src, srcsize, src_offset, nblock_,
                     tmp2, 0, scontext->tmp, scontext->tmp3);
    if (cbytes < 0) {
        ntbytes = cbytes;
        break;
    }

    // Copy the decompressed data to the destination
    memcpy((uint8_t *)dest + ntbytes, tmp2 + startb, (unsigned int)bsize2);
    ntbytes += bsize2;