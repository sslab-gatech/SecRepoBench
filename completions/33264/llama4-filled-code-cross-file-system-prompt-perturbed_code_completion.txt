int32_t ntbytes = 0;
int32_t stop = start + nitems;
if (nitems == 0) {
  return 0;
}
if (destsize < (nitems * hdr->typesize)) {
  BLOSC_TRACE_ERROR("Not enough space in dest for data");
  return BLOSC2_ERROR_PARAMS;
}

int32_t ebsize;
int32_t j, bsize, leftoverblock;
int32_t startb, stopb, bsize2;

bool memcpyed = hdr->header_flags & (uint8_t)BLOSC_MEMCPYED;
if (context->do_compress == 0 && context->special_type) {
  // Fake a runlen as if its a memcpyed chunk
  memcpyed = true;
}