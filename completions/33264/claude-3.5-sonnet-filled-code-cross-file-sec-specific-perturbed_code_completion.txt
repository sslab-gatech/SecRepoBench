int32_t j, bsize, leftoverblock;
int32_t startb, stopb, bsize2;
int32_t ntbytes = 0;
int32_t stop = start + nitems;
bool memcpyed = (hdr->flags & BLOSC_MEMCPYED) || (context->special_type != 0);

if (hdr->nbytes > destsize) {
  BLOSC_TRACE_ERROR("Not enough space for the destination buffer");
  return BLOSC2_ERROR_WRITE_BUFFER;
}

if (hdr->blocksize < 0 || hdr->blocksize > destsize) {
  BLOSC_TRACE_ERROR("Invalid blocksize");
  return BLOSC2_ERROR_INVALID_HEADER;
}

int32_t ebsize;