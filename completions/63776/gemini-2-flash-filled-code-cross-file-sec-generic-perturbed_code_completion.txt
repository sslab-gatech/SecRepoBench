if (dat->version < R_11)
                {
                  obj->size = (dat->byte - previous_byte_position) & 0xFFFFFFFF;
                  if (dat->byte > previous_byte_position + obj->size)
                    {
                      obj->size = dat->size - previous_byte_position;
                      LOG_ERROR ("Object size too big, truncated to %u",
                                 obj->size);
                    }
                  if (dat->byte != previous_byte_position + obj->size)
                    {
                      BITCODE_RL offset = previous_byte_position + obj->size
                                           - dat->byte;
                      if (offset > 0)
                        {
                          obj->trailing_unknown_data = (unsigned char *)calloc (
                              offset + 1, sizeof (unsigned char));
                          if (!obj->trailing_unknown_data)
                            {
                              LOG_ERROR ("Out of memory");
                              return DWG_ERR_OUTOFMEM;
                            }
                          memcpy (obj->trailing_unknown_data, &dat->chain[dat->byte],
                                  offset);
                          dat->byte += offset;
                          obj->trailing_unknown_data[offset] = '\0';
                          LOG_WARN ("trailing unknown data offset %u", offset);
                        }
                      else
                        {
                          LOG_ERROR ("offset %d", offset);
                        }
                    }
                }
              else
                {
                  BITCODE_RL crc_size = 0;
                  BITCODE_RL offset = 0;
                  BITCODE_RL expected_size
                      = (dat->byte - previous_byte_position) & 0xFFFFFFFF;
                  if (dat->version >= R_13)
                    crc_size = 2;
                  if (expected_size != obj->size + crc_size)
                    {
                      LOG_WARN ("size mismatch: expected %u, got %u",
                                obj->size + crc_size, expected_size);
                      obj->size = expected_size - crc_size;
                    }
                  if (dat->byte != previous_byte_position + obj->size
                      + crc_size)
                    {
                      offset = previous_byte_position + obj->size + crc_size
                               - dat->byte;
                      if (offset > 0)
                        {
                          obj->trailing_unknown_data = (unsigned char *)calloc (
                              offset + 1, sizeof (unsigned char));
                          if (!obj->trailing_unknown_data)
                            {
                              LOG_ERROR ("Out of memory");
                              return DWG_ERR_OUTOFMEM;
                            }
                          memcpy (obj->trailing_unknown_data, &dat->chain[dat->byte],
                                  offset);
                          dat->byte += offset;
                          obj->trailing_unknown_data[offset] = '\0';
                          LOG_WARN ("trailing unknown data offset %u", offset);
                        }
                      else
                        {
                          LOG_ERROR ("offset %d", offset);
                        }
                    }
                }