PRE (R_11)
{
  obj->size = bit_read_RS (dat);
  LOG_TRACE ("size: " FORMAT_RS " [RS]\n", obj->size);
  if (obj->size > size || obj->size < 2)
    {
      LOG_ERROR ("Invalid object size " FORMAT_RS ", max %u", obj->size, size);
      obj->size = size;
      error |= DWG_ERR_VALUEOUTOFBOUNDS;
    }
}
VERSIONS (R_11, R_2000)
{
  obj->size = bit_read_RL (dat);
  LOG_TRACE ("size: " FORMAT_RL " [RL]\n", obj->size);
  if (obj->size > size || obj->size < 4)
    {
      LOG_ERROR ("Invalid object size " FORMAT_RL ", max %u", obj->size, size);
      obj->size = size;
      error |= DWG_ERR_VALUEOUTOFBOUNDS;
    }
}

if (dat->byte + obj->size > dat->size)
  {
    LOG_ERROR ("Invalid object size " FORMAT_RL ", max %u", obj->size,
               (unsigned)(dat->size - dat->byte));
    error |= DWG_ERR_VALUEOUTOFBOUNDS;
    obj->size = dat->size - dat->byte;
  }

if (obj->size < 2)
  {
    LOG_ERROR ("Invalid object size " FORMAT_RL ", min 2", obj->size);
    error |= DWG_ERR_VALUEOUTOFBOUNDS;
    obj->size = 2;
  }

SINCE (R_11)
{
  BITCODE_RS crc;
  long pos = dat->byte;
  long oldpos = pos - 2;
  long end = pos + obj->size - 2;
  crc = bit_calc_CRC (0xC0C1, &dat->chain[oldpos], obj->size);
  dat->byte = end;
  if (crc != bit_read_RS (dat))
    {
      LOG_ERROR ("Wrong crc " FORMAT_RS ", expected %04X", crc,
                 bit_read_RS (dat));
      error |= DWG_ERR_WRONGCRC;
    }
  dat->byte = pos;
}

if (dat->byte + obj->size != previous_byte_position + size)
  {
    long offset = (previous_byte_position + size) - (dat->byte + obj->size);
    LOG_TRACE ("offset: %ld\n", offset);
    if (offset > 0)
      {
        BITCODE_RC *r = calloc (offset, 1);
        if (r)
          {
            memcpy (r, &dat->chain[dat->byte + obj->size], offset);
            obj->unknown_rest = r;
            obj->unknown_rest_size = offset;
            LOG_TRACE ("unknown_rest[%ld]: ", offset);
            LOG_TRACE_TF (obj->unknown_rest, offset);
            LOG_TRACE ("\n");
          }
      }
    else if (offset < 0)
      {
        LOG_ERROR ("Negative offset %ld", offset);
        error |= DWG_ERR_VALUEOUTOFBOUNDS;
      }
  }