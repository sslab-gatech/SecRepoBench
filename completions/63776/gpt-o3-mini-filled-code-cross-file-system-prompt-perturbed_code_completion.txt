{
  size_t expected_end = obj->address + obj->size;
  if (dat->byte < expected_end)
    {
      size_t extra_bytes = expected_end - dat->byte;
      LOG_WARN("Entity at 0x%x has %zu extra unknown bytes",
               obj->address, extra_bytes);
      obj->unknown_bits = (unsigned char *)malloc(extra_bytes);
      if (!obj->unknown_bits)
        {
          LOG_ERROR("Out of memory while processing unknown trailing data");
          return DWG_ERR_OUTOFMEM;
        }
      memcpy(obj->unknown_bits, dat->chain + dat->byte, extra_bytes);
      obj->num_unknown_bits = extra_bytes * 8;
      dat->byte += extra_bytes;
    }
  else if (dat->byte > expected_end)
    {
      LOG_WARN("Entity at 0x%x over-read by %zu bytes",
               obj->address, dat->byte - expected_end);
      dat->byte = expected_end;
    }
}