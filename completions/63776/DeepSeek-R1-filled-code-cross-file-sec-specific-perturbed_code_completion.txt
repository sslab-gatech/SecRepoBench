if (dat->version < R_11)
            {
              if (obj->size == 0 || obj->size > (BITCODE_RL)(previous_byte_position + size - obj->address))
                {
                  LOG_ERROR("Invalid object size " FORMAT_RL " at 0x%zx. Adjusting to remaining bytes",
                            obj->size, obj->address);
                  obj->size = (BITCODE_RL)(previous_byte_position + size - obj->address);
                  if (obj->size < 0)
                    {
                      LOG_ERROR("Negative adjusted size. Data corruption suspected");
                      return DWG_ERR_CORRUPTEDDATA;
                    }
                }
            }

          BITCODE_RL expected_end = obj->address + obj->size;
          if ((BITCODE_RL)dat->byte != expected_end)
            {
              BITCODE_RL trailing_size = (BITCODE_RL)dat->byte - expected_end;
              if (trailing_size > 0)
                {
                  obj->unknown_data_size = trailing_size;
                  if (!(obj->unknown_data = (BITCODE_TF*)malloc(trailing_size)))
                    {
                      LOG_ERROR("Out of memory allocating unknown_data buffer");
                      return DWG_ERR_OUTOFMEM;
                    }
                  bit_read_TF(dat, obj->unknown_data, trailing_size);
                  LOG_TRACE("Extracted %d bytes of unknown trailing data at 0x%zx\n",
                            trailing_size, expected_end);
                }
              else
                {
                  LOG_ERROR("Data underflow: Current position 0x%zx is before expected end 0x%zx",
                            dat->byte, expected_end);
                  return DWG_ERR_CORRUPTEDDATA;
                }
            }

          SINCE(R_2004)
            {
              BITCODE_RS crc = bit_read_RS(dat);
              BITCODE_RS calculated_crc = calculate_crc(dat, obj->address, obj->size);
              if (crc != calculated_crc)
                {
                  LOG_ERROR("CRC mismatch at 0x%zx: expected 0x%04x, calculated 0x%04x",
                            dat->byte - 2, crc, calculated_crc);
                  return DWG_ERR_CORRUPTEDDATA;
                }
            }