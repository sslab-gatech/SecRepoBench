{
  BITCODE_RL obj_size = bit_read_RL(bit_chain);
  LOG_TRACE("size: " FORMAT_RL "\n", obj_size);
  if (obj_size > size || obj_size > bit_chain->size - bit_chain->byte) {
    LOG_ERROR("Invalid object size: %" PRIu32, obj_size);
    return DWG_ERR_INVALIDDWG;
  }
  obj->size = obj_size;
  if (bit_chain->byte + obj_size > oldpos + size) {
    BITCODE_RL unknown_size = (oldpos + size) - bit_chain->byte;
    if (unknown_size > 0) {
      obj->unknown_bits = (unsigned char *)malloc(unknown_size);
      if (!obj->unknown_bits) {
        LOG_ERROR("Out of memory for unknown bits");
        return DWG_ERR_OUTOFMEM;
      }
      memcpy(obj->unknown_bits, bit_chain->chain + bit_chain->byte, unknown_size);
      bit_chain->byte += unknown_size;
      LOG_TRACE("Extracted unknown data of size: %" PRIu32 "\n", unknown_size);
    }
  } else {
    bit_chain->byte += obj_size;
  }
}