BITCODE_RL obj_size = bit_read_RL (bit_chain);
LOG_TRACE ("size: " FORMAT_RL " [RL]\n", obj_size);
if (obj_size > size)
  {
    LOG_ERROR ("Invalid object size " FORMAT_RL " > " FORMAT_RL, obj_size, size);
    obj_size = size;
    error |= DWG_ERR_VALUEOUTOFBOUNDS;
  }
if (obj_size < 4)
  {
    LOG_ERROR ("Invalid object size " FORMAT_RL " < 4", obj_size);
    obj_size = 4;
    error |= DWG_ERR_VALUEOUTOFBOUNDS;
  }
obj->size = obj_size;

if (bit_chain->byte + obj_size > oldpos + size)
  {
    LOG_ERROR ("Invalid object size " FORMAT_RL " > " FORMAT_RL, obj_size,
               size - (bit_chain->byte - oldpos));
    obj_size = size - (bit_chain->byte - oldpos);
    error |= DWG_ERR_VALUEOUTOFBOUNDS;
  }
if (obj->address + obj_size != (BITCODE_RL)bit_chain->byte)
  {
    BITCODE_RL offset = (BITCODE_RL)bit_chain->byte - obj->address;
    if (offset > obj_size)
      {
        LOG_ERROR ("Invalid object size " FORMAT_RL " < " FORMAT_RL, obj_size,
                   offset);
        obj_size = offset;
        error |= DWG_ERR_VALUEOUTOFBOUNDS;
      }
    else
      {
        obj->unknown_bits = bit_read_TF (bit_chain, obj_size - offset);
        LOG_TRACE ("unknown_bits: %d [TF]\n", obj_size - offset);
      }
  }

SINCE (R_11)
{
  BITCODE_RS crc;
  crc = bit_read_RS (bit_chain);
  LOG_TRACE ("crc: %04X [RS]\n", crc);
  if (crc != bit_calc_CRC (0xC0C1, &bit_chain->chain[obj->address], obj_size - 2))
    {
      LOG_ERROR ("Invalid CRC %04X", crc);
      error |= DWG_ERR_WRONGCRC;
    }
}