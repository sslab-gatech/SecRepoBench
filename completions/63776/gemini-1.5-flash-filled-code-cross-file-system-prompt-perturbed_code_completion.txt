size_t unknown_data_size;
                BITCODE_RL unknown_data_offset;
                unsigned char *unknown_data;

                if (obj->size > (bit_chain->byte - obj->address))
                  {
                    unknown_data_size = obj->size - (bit_chain->byte - obj->address);
                    unknown_data_offset = bit_chain->byte;
                    unknown_data = (unsigned char *)malloc (unknown_data_size);
                    if (!unknown_data)
                      {
                        LOG_ERROR ("Out of memory");
                        return DWG_ERR_OUTOFMEM;
                      }
                    memcpy (unknown_data, bit_chain->byte, unknown_data_size);
                    bit_chain->byte += unknown_data_size;
                    obj->unknown_data = unknown_data;
                    obj->unknown_data_size = unknown_data_size;
                    LOG_WARN ("Found %zu bytes of unknown data after object "
                              "at 0x%zx\n",
                              unknown_data_size, unknown_data_offset);
                  }
                else if (obj->size < (bit_chain->byte - obj->address))
                  {
                    LOG_ERROR ("Object size mismatch: expected %zu bytes, "
                               "but found %zu bytes\n",
                               obj->size, bit_chain->byte - obj->address);
                    return DWG_ERR_INVALIDDWG;
                  }
                else
                  {
                    obj->unknown_data = NULL;
                    obj->unknown_data_size = 0;
                  }
              }
            else
              {
                obj->size = bit_chain->byte - obj->address;
                if (obj->size > (bit_chain->byte - obj->address))
                  {
                    unknown_data_size = obj->size - (bit_chain->byte - obj->address);
                    unknown_data_offset = bit_chain->byte;
                    unknown_data = (unsigned char *)malloc (unknown_data_size);
                    if (!unknown_data)
                      {
                        LOG_ERROR ("Out of memory");
                        return DWG_ERR_OUTOFMEM;
                      }
                    memcpy (unknown_data, bit_chain->byte, unknown_data_size);
                    bit_chain->byte += unknown_data_size;
                    obj->unknown_data = unknown_data;
                    obj->unknown_data_size = unknown_data_size;
                    LOG_WARN ("Found %zu bytes of unknown data after object "
                              "at 0x%zx\n",
                              unknown_data_size, unknown_data_offset);
                  }
                else if (obj->size < (bit_chain->byte - obj->address))
                  {
                    LOG_ERROR ("Object size mismatch: expected %zu bytes, "
                               "but found %zu bytes\n",
                               obj->size, bit_chain->byte - obj->address);
                    return DWG_ERR_INVALIDDWG;
                  }
                else
                  {
                    obj->unknown_data = NULL;
                    obj->unknown_data_size = 0;
                  }
              }