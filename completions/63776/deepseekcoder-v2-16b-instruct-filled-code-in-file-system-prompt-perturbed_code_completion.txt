sum1 += data[i];
          sum2 += sum1;
        }
      data += chunksize;
    }
  return (sum2 << 0x10) | sum1;
}

static int
dwg_sections_init (Dwg_Data *restrict dwg)
{
  BITCODE_RLd num_sections = dwg->header.sections;
  if (num_sections == 0)
    return 0;
  if (num_sections > 0xFFFF)
    {
      LOG_ERROR ("Too many sections: %" PRIu64, num_sections);
      return DWG_ERR_VALUEOUTOFBOUNDS;
    }
  if (add_section (dwg))
    return DWG_ERR_OUTOFMEM;
  dwg->header.section[0].number = 0;
  dwg->header.section[0].address = 0;
  dwg->header.section[0].size = 0;
  strcpy (dwg->header.section[0].name, "HEADER");
  if (add_section (dwg))
    return DWG_ERR_OUTOFMEM;
  dwg->header.section[1].number = 1;
  dwg->header.section[1].address = 0;
  dwg->header.section[1].size = 0;
  strcpy (dwg->header.section[1].name, "CLASSES");
  if (add_section (dwg))
    return DWG_ERR_OUTOFMEM;
  dwg->header.section[2].number = 2;
  dwg->header.section[2].address = 0;
  dwg->header.section[2].size = 0;
  strcpy (dwg->header.section[2].name, "HANDLES");
  if (add_section (dwg))
    return DWG_ERR_OUTOFMEM;
  dwg->header.section[3].number = 3;
  dwg->header.section[3].address = 0;
  dwg->header.section[3].size = 0;
  strcpy (dwg->header.section[3].name, "2NDHEADER");
  if (add_section (dwg))
    return DWG_ERR_OUTOFMEM;
  dwg->header.section[4].number = 4;
  dwg->header.section[4].address = 0;
  dwg->header.section[4].size = 0;
  strcpy (dwg->header.section[4].name, "MEASUREMENT");
  if (add_section (dwg))
    return DWG_ERR_OUTOFMEM;
  dwg->header.section[5].number = 5;
  dwg->header.section[5].address = 0;
  dwg->header.section[5].size = 0;
  strcpy (dwg->header.section[5].name, "AUXHEADER");
  return 0;
}

static int
decode_R2004 (Bit_Chain *restrict dat, Dwg_Data *restrict dwg)
{
  BITCODE_BL i;
  BITCODE_RLd num_sections = dwg->header.sections;
  BITCODE_RLd num_sections_orig = num_sections;
  BITCODE_RLd num_sections_read = 0;
  BITCODE_RLd num_sections_expected = 6;
  BITCODE_RLd num_sections_found = 0;
  BITCODE_RLd num_sections_checked = 0;
  BITCODE_RLd num_sections_crc_checked = 0;
  BITCODE_RLd num_sections_crc_mismatch = 0;
  BITCODE_RLd num_sections_crc_unknown = 0;
  BITCODE_RLd num_sections_crc_ok = 0;
  BITCODE_RLd num_sections_crc_ok_expected = 0;
  BITCODE_RLd num_sections_crc_ok_found = 0;
  BITCODE_RLd num_sections_crc_ok_checked = 0;
  BITCODE_RLd num_sections_crc_ok_mismatch = 0;
  BITCODE_RLd num_sections_crc_ok_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found = 0;
  BITCODE_RLd num_sections_crc_ok_expected_checked = 0;
  BITCODE_RLd num_sections_crc_ok_expected_mismatch = 0;
  BITCODE_RLd num_sections_crc_ok_expected_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_found_checked = 0;
  BITCODE_RLd num_sections_crc_ok_found_mismatch = 0;
  BITCODE_RLd num_sections_crc_ok_found_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_checked_mismatch = 0;
  BITCODE_RLd num_sections_crc_ok_checked_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_mismatch = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_checked_mismatch = 0;
  BITCODE_RLd num_sections_crc_ok_expected_checked_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_found_checked_mismatch = 0;
  BITCODE_RLd num_sections_crc_ok_found_checked_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_found_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_mismatch_unknown = 0;
  BITCODE_RLd num_sections_crc_ok_expected_found_checked_m