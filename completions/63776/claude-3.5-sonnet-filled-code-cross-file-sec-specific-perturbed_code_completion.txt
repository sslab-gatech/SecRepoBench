BITCODE_RL obj_size = bit_read_RL(bit_chain);
LOG_TRACE("size: " FORMAT_RL " [RL]\n", obj_size);
if (obj_size < 2 || obj_size > (BITCODE_RL)size)
  {
    LOG_ERROR("Invalid object size " FORMAT_RL ", max " FORMAT_RL ". Skipping", obj_size, (BITCODE_RL)size);
    obj->size = (BITCODE_RL)size;
    bit_advance_position(bit_chain, (BITCODE_RL)size * 8);
    return DWG_ERR_VALUEOUTOFBOUNDS;
  }
obj->size = obj_size;

if ((obj->size + 2) > (BITCODE_RL)size)
  obj->size = (BITCODE_RL)size - 2;

SINCE (R_11)
{
  BITCODE_RS crc;
  bit_advance_position(bit_chain, obj->size * 8);
  crc = bit_read_RS(bit_chain);
  LOG_TRACE("crc: %04X [RS]\n", crc);
  bit_set_position(bit_chain, oldpos);
}

if ((bit_chain->byte + obj->size) > (oldpos + size))
  {
    BITCODE_RL offset = (BITCODE_RL)((oldpos + size) - bit_chain->byte);
    LOG_WARN("Invalid object size " FORMAT_RL " > " FORMAT_RL ". Fixing to " FORMAT_RL,
             obj->size, (BITCODE_RL)size, offset);
    obj->size = offset;
  }

if (obj->size < 4)
  {
    LOG_ERROR("Invalid object size " FORMAT_RL ". Skipping", obj->size);
    bit_advance_position(bit_chain, obj->size * 8);
    return DWG_ERR_VALUEOUTOFBOUNDS;
  }

if (obj->address + obj->size != (BITCODE_RL)bit_chain->byte)
  {
    BITCODE_RL offset = (BITCODE_RL)(bit_chain->byte - obj->address);
    if (offset > obj->size)
      {
        BITCODE_RL unknown_size = offset - obj->size;
        obj->unknown_pos = bit_chain->byte - unknown_size;
        obj->unknown = (char*)calloc(unknown_size, 1);
        if (obj->unknown)
          {
            memcpy(obj->unknown, &bit_chain->chain[obj->unknown_pos], unknown_size);
            LOG_TRACE("unknown [%d]: ", (int)unknown_size);
            LOG_TRACE_TF(obj->unknown, unknown_size);
            LOG_TRACE("\n");
          }
      }
    LOG_TRACE("-size calc from (" FORMAT_RLx " to " FORMAT_RLx "): " FORMAT_RL "\n",
              obj->address, (BITCODE_RL)bit_chain->byte, offset);
  }