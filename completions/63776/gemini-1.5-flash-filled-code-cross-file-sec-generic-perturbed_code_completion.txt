size_t unknown_data_offset;
                size_t unknown_data_size;
                unsigned char *unknown_data;

                if (dat->version < R_11)
                  {
                    if (obj->size > (dat->byte - obj->address))
                      {
                        LOG_WARN (
                            "Object size mismatch: expected %u, got %zu\n",
                            obj->size, (dat->byte - obj->address));
                        obj->size = (dat->byte - obj->address);
                      }
                    else if (obj->size < (dat->byte - obj->address))
                      {
                        LOG_ERROR (
                            "Object size mismatch: expected %u, got %zu\n",
                            obj->size, (dat->byte - obj->address));
                        return DWG_ERR_INVALIDDWG;
                      }
                  }
                else
                  {
                    if (obj->size > (dat->byte - obj->address))
                      {
                        unknown_data_offset = obj->address + obj->size;
                        unknown_data_size = (dat->byte - unknown_data_offset);
                        unknown_data = (unsigned char *)malloc (unknown_data_size);
                        if (!unknown_data)
                          {
                            LOG_ERROR ("Out of memory");
                            return DWG_ERR_OUTOFMEM;
                          }
                        memcpy (unknown_data, &dat->chain[unknown_data_offset],
                                unknown_data_size);
                        obj->unknown_data = unknown_data;
                        obj->unknown_data_size = unknown_data_size;
                        LOG_WARN (
                            "Object size mismatch: expected %u, got %zu, "
                            "unknown data size: %zu\n",
                            obj->size, (dat->byte - obj->address),
                            unknown_data_size);
                      }
                    else if (obj->size < (dat->byte - obj->address))
                      {
                        LOG_ERROR (
                            "Object size mismatch: expected %u, got %zu\n",
                            obj->size, (dat->byte - obj->address));
                        return DWG_ERR_INVALIDDWG;
                      }
                  }