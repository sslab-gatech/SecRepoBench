{
  BITCODE_RL consumed = (BITCODE_RL)(dat->byte - obj->address);
  if (consumed < obj->size)
    {
      BITCODE_RL leftover = obj->size - consumed;
      LOG_TRACE ("Object type %d has leftover unknown data of %u bytes\n",
                 obj->type, leftover);
      UNKNOWN_UNTIL (dat->byte + leftover);
      if (dat->byte > dat->size)
        {
          LOG_ERROR ("Tried to read beyond buffer\n");
          error |= DWG_ERR_INVALIDDWG;
          break;
        }
    }
  else if (consumed > obj->size)
    {
      BITCODE_RL over = consumed - obj->size;
      LOG_ERROR ("Over-read object type %d by %u bytes\n", obj->type, over);
      error |= DWG_ERR_INVALIDDWG;
      break;
    }
  /* Set bitsize and decode leftover unknown bits, if any. */
  obj->bitsize = (obj->size << 3);
  error |= dwg_decode_unknown_bits (dat, obj);
  /* For later versions, one could do additional checks (e.g. CRC), but not here. */
}