if (dat->version < R_11)
                {
                  if (obj->size > size)
                    {
                      obj->size = size;
                      LOG_WARN ("Object size %u exceeds section size %u, "
                                "truncating\n",
                                obj->size, size);
                    }
                  if (dat->byte > previous_byte_position + obj->size)
                    {
                      LOG_ERROR ("Object size %u too small, current byte "
                                 "position %" PRIuSIZE ", expected %" PRIuSIZE
                                 "\n",
                                 obj->size, dat->byte,
                                 previous_byte_position + obj->size);
                      return DWG_ERR_INVALIDDWG;
                    }
                  if (dat->byte < previous_byte_position + obj->size)
                    {
                      size_t offset = previous_byte_position + obj->size
                                      - dat->byte;
                      if (offset > 0)
                        {
                          LOG_WARN ("Trailing unknown data of size %" PRIuSIZE
                                    " at offset 0x%zx\n",
                                    offset, dat->byte - start);
                          if (offset > DWG_MAX_UNKNOWN_SIZE)
                            {
                              LOG_ERROR ("Too much unknown data: %" PRIuSIZE
                                         " > %d\n",
                                         offset, DWG_MAX_UNKNOWN_SIZE);
                              return DWG_ERR_INVALIDDWG;
                            }
                          obj->unknown_data = (unsigned char *)malloc (offset);
                          if (!obj->unknown_data)
                            {
                              LOG_ERROR ("Out of memory allocating %" PRIuSIZE
                                         " bytes for unknown data\n",
                                         offset);
                              return DWG_ERR_OUTOFMEM;
                            }
                          memcpy (obj->unknown_data, dat->chain + dat->byte,
                                  offset);
                          obj->unknown_size = offset;
                          dat->byte += offset;
                        }
                    }
                }
              else
                {
                  BITCODE_RC crc_check = 0;
                  SINCE (R_11)
                  {
                    crc_check = bit_read_RC (dat);
                    LOG_TRACE ("CRC check: 0x%x\n", crc_check);
                  }
                  obj->size = (dat->byte - previous_byte_position) & 0xFFFFFFFF;
                  if (dat->version >= R_13 && crc_check != 0)
                    {
                      LOG_WARN ("CRC check failed: 0x%x\n", crc_check);
                    }
                  if (dat->byte < previous_byte_position + obj->size)
                    {
                      size_t offset = previous_byte_position + obj->size
                                      - dat->byte;
                      if (offset > 0)
                        {
                          LOG_WARN ("Trailing unknown data of size %" PRIuSIZE
                                    " at offset 0x%zx\n",
                                    offset, dat->byte - start);
                          if (offset > DWG_MAX_UNKNOWN_SIZE)
                            {
                              LOG_ERROR ("Too much unknown data: %" PRIuSIZE
                                         " > %d\n",
                                         offset, DWG_MAX_UNKNOWN_SIZE);
                              return DWG_ERR_INVALIDDWG;
                            }
                          obj->unknown_data = (unsigned char *)malloc (offset);
                          if (!obj->unknown_data)
                            {
                              LOG_ERROR ("Out of memory allocating %" PRIuSIZE
                                         " bytes for unknown data\n",
                                         offset);
                              return DWG_ERR_OUTOFMEM;
                            }
                          memcpy (obj->unknown_data, dat->chain + dat->byte,
                                  offset);
                          obj->unknown_size = offset;
                          dat->byte += offset;
                        }
                    }
                }