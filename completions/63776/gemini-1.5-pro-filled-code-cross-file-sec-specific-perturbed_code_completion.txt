if (bit_chain->version < R_11)
                  {
                    if (obj->size > (BITCODE_RL)(bit_chain->size - bit_chain->byte))
                      {
                        LOG_ERROR ("Invalid object size, too large: %x > %" PRIuSIZE  " - %" PRIuSIZE "\n", obj->size, bit_chain->size, bit_chain->byte);
                        obj->size = (BITCODE_RL)(bit_chain->size - bit_chain->byte);
                      }
                    if (obj->size > 0 && obj->size < (BITCODE_RL)(bit_chain->byte - oldpos)) {
                      LOG_ERROR("Invalid object size, too small: %x < %" PRIuSIZE " - %" PRIuSIZE "\n", obj->size, bit_chain->byte, oldpos);
                      obj->size = (BITCODE_RL)(bit_chain->byte - oldpos);
                    }

                    if (obj->size > 0 && (BITCODE_RL)bit_chain->byte != oldpos + obj->size)
                      {
                        size_t offset = bit_chain->byte - oldpos;
                        if (offset < obj->size)
                          {
                            size_t len = obj->size - offset;
                            obj->unknown = (char *)calloc (1, len);
                            if (obj->unknown)
                              memcpy (obj->unknown, bit_chain->chain + bit_chain->byte, len);
                            bit_chain->byte += len;
                          }
                        else
                          {
                            LOG_ERROR ("object at %zx, size %x, current pos %zx\n", oldpos, obj->size, bit_chain->byte);
                          }
                      }
                  }
                else
                  {
                    if (!obj->crc_good)
                      {
                        if (obj->size > 0 && obj->size != bit_chain->byte - oldpos)
                          {
                            if (obj->size > bit_chain->byte - oldpos)
                              bit_chain->byte = oldpos + obj->size;
                            else
                              obj->size = bit_chain->byte - oldpos;
                          }
                      }
                    else
                      {
                        if (obj->size > 0 && obj->size != bit_chain->byte - oldpos)
                          {
                            LOG_ERROR ("object at %zx, size %x, current pos %zx\n", oldpos, obj->size, bit_chain->byte);
                            if (obj->size > bit_chain->byte - oldpos)
                              {
                                size_t offset = bit_chain->byte - oldpos;
                                size_t len = obj->size - offset;
                                obj->unknown = (char *)calloc (1, len);
                                if (obj->unknown)
                                  memcpy (obj->unknown, bit_chain->chain + bit_chain->byte, len);
                                bit_chain->byte += len;
                              }
                            else
                              obj->size = bit_chain->byte - oldpos;
                          }
                      }
                  }