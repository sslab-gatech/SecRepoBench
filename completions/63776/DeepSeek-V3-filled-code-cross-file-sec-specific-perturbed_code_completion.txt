BITCODE_RL obj_size = bit_chain->byte - obj->address;
if (obj_size > 0 && obj_size <= (BITCODE_RL)(bit_chain->size - obj->address))
  {
    obj->size = obj_size;
    if (bit_chain->byte < oldpos + size)
      {
        BITCODE_RL remaining = (oldpos + size) - bit_chain->byte;
        if (remaining > 0)
          {
            obj->unknown_data = (BITCODE_TF)calloc(1, remaining);
            if (obj->unknown_data)
              {
                memcpy(obj->unknown_data, &bit_chain->chain[bit_chain->byte], remaining);
                obj->unknown_data_size = remaining;
                bit_chain->byte += remaining;
                LOG_TRACE("Unknown remaining data: %d bytes\n", remaining);
              }
            else
              {
                LOG_ERROR("Out of memory for unknown data");
                return DWG_ERR_OUTOFMEM;
              }
          }
      }
  }
else
  {
    LOG_ERROR("Invalid object size %d (max %d)", obj_size, 
              (BITCODE_RL)(bit_chain->size - obj->address));
    return DWG_ERR_INVALIDDWG;
  }