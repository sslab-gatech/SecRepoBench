SINCE (R_11)
{
  BITCODE_RL obj_size = bit_read_RL (dat);
  LOG_TRACE ("object size: " FORMAT_RL "\n", obj_size);
  if (obj_size > size || obj_size < 0)
    {
      LOG_ERROR ("Invalid object size %" FORMAT_RL ", max %" FORMAT_RL,
                 obj_size, size);
      error |= DWG_ERR_VALUEOUTOFBOUNDS;
    }
  else
    {
      size -= obj_size;
      if (size < 0)
        {
          LOG_ERROR ("Remaining size negative %" FORMAT_RL, size);
          error |= DWG_ERR_VALUEOUTOFBOUNDS;
        }
    }
}
else
{
  // Pre R_11 versions don't have explicit sizes, so calculate remaining data
  BITCODE_RL remaining = previous_byte_position + size - dat->byte;
  if (remaining < 0)
    {
      LOG_ERROR ("Negative remaining bytes %" FORMAT_RL, remaining);
      error |= DWG_ERR_VALUEOUTOFBOUNDS;
    }
  else if (remaining > 0)
    {
      LOG_WARN ("Extracting %" FORMAT_RL " unknown bytes\n", remaining);
      obj->unknown_data = malloc (remaining);
      if (!obj->unknown_data)
        {
          LOG_ERROR ("Memory allocation failed");
          error |= DWG_ERR_OUTOFMEM;
        }
      else
        {
          memcpy (obj->unknown_data, &dat->chain[dat->byte], remaining);
          obj->unknown_data_size = remaining;
          dat->byte += remaining;
        }
    }
}

// Perform CRC checks for later versions
IF_LATER (R_13)
{
  uint32_t crc = bit_read_BL (dat);
  uint32_t computed_crc = compute_crc (&dat->chain[previous_byte_position], obj->size);
  if (crc != computed_crc)
    {
      LOG_ERROR ("CRC mismatch: expected %" PRIu32 ", got %" PRIu32, crc, computed_crc);
      error |= DWG_ERR_CRCERROR;
    }
}

// Handle misalignment
if ((BITCODE_RL)dat->byte != previous_byte_position + obj->size)
  {
    BITCODE_RL offset = ((BITCODE_RL)dat->byte) - (previous_byte_position + obj->size);
    LOG_WARN ("Object size misalignment by %" FORMAT_RL " bytes\n", offset);
    if (offset > 0 && offset <= size)
      {
        LOG_TRACE ("Skipping %" FORMAT_RL " unknown bytes\n", offset);
        dat->byte += offset;
      }
    else
      {
        LOG_ERROR ("Misalignment out of bounds %" FORMAT_RL, offset);
        error |= DWG_ERR_VALUEOUTOFBOUNDS;
      }
  }