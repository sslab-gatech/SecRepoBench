SINCE (R_2_0b) // Pre R_2_0 doesn't contain size of entity
{
    // Validate the object's size
    if (obj->size > (end - bit_chain->byte))
    {
        LOG_ERROR("Object size %u exceeds remaining data (%lu)", obj->size, (end - bit_chain->byte));
        obj->size = (end - bit_chain->byte);
    }

    // Extract any unknown remaining data
    if (bit_chain->byte + obj->size < end)
    {
        size_t unknown_size = end - (bit_chain->byte + obj->size);
        obj->unknown_bits = bit_read_bits(bit_chain, unknown_size * 8);
        LOG_TRACE("Unknown data of size %lu bytes", unknown_size);
        LOG_TRACE_TF(obj->unknown_bits, unknown_size);
    }

    // Perform CRC checks
    BITCODE_CRC expected_crc = bit_read_CRC(bit_chain);
    BITCODE_CRC calculated_crc = dwg_crc8(&bit_chain->chain[bit_chain->byte - obj->size], obj->size);
    if (expected_crc != calculated_crc)
    {
        LOG_ERROR("CRC mismatch for object at 0x%lx. Expected 0x%04X, got 0x%04X",
                  obj->address, expected_crc, calculated_crc);
        return DWG_ERR_WRONGCRC;
    }
}