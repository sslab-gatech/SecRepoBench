if (dat->version < R_11)
                  {
                    if (obj->size > (BITCODE_RL)(dat->size - dat->byte))
                      {
                        LOG_ERROR ("size too big: " FORMAT_RL " > " FORMAT_RL
                                   "\n",
                                   obj->size, (BITCODE_RL)(dat->size - dat->byte));
                        obj->size = (BITCODE_RL)(dat->size - dat->byte);
                      }
                    if (obj->size > 0)
                      {
                        size_t remaining_bytes = previous_byte_position + obj->size - dat->byte;
                        if (remaining_bytes > 0)
                          {
                            if (remaining_bytes > obj->size || obj->size == 0)
                              {
                                LOG_ERROR ("invalid remaining_bytes %zu > %u\n", remaining_bytes, obj->size);
                                remaining_bytes = 0;
                              }
                            UNKNOWN ((unsigned)remaining_bytes);
                          }
                      }
                  }
                else
                  {
                    if (obj->crc != dwg_crc32 (dat->chain + previous_byte_position, obj->size))
                      LOG_ERROR ("CRC mismatch\n");
                    if (previous_byte_position + obj->size != dat->byte)
                      {
                        long offset = (long)(previous_byte_position + obj->size - dat->byte);
                        if (offset > 0)
                          {
                            LOG_WARN ("trailing unknown data %ld bytes\n", offset);
                            obj->unknown_data = (char *)calloc (1, offset);
                            if (obj->unknown_data)
                              memcpy (obj->unknown_data, dat->chain + dat->byte, offset);
                            UNKNOWN ((unsigned)offset);
                          }
                        else if (offset < 0)
                          {
                            LOG_ERROR ("missing data %ld bytes\n", -offset);
                          }
                      }
                  }
                previous_byte_position = dat->byte;