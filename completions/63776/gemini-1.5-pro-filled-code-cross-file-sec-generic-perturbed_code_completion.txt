if (bit_chain->version < R_11)
                  {
                    if (obj->size > (BITCODE_RL)(bit_chain->size - oldpos))
                      {
                        LOG_ERROR ("Invalid object size, too large: %x > %" PRIuSIZE
                                   " - %" PRIuSIZE "\n",
                                   obj->size, bit_chain->size, oldpos);
                        obj->size = bit_chain->size - oldpos;
                      }
                    if (obj->size > 0)
                      {
                        size_t remaining = obj->size - (bit_chain->byte - oldpos);
                        if (remaining > 0)
                          {
                            if (remaining > bit_chain->size - bit_chain->byte)
                              remaining = bit_chain->size - bit_chain->byte;
                            UNKNOWN ((remaining), "remaining");
                          }
                        else if (remaining < 0)
                          LOG_ERROR ("Invalid object size, too small: %x < %" PRIuSIZE
                                     " - %" PRIuSIZE "\n",
                                     obj->size, bit_chain->byte, oldpos);
                      }
                  }
                else
                  {
                    BITCODE_32 crc;
                    size_t current_pos = bit_chain->byte;
                    size_t num_bytes = obj->size;
                    if (num_bytes > bit_chain->size - current_pos)
                      num_bytes = bit_chain->size - current_pos;
                    crc = dwg_crc32 (bit_chain->chain + current_pos, num_bytes);
                    bit_chain->byte += num_bytes;
                    if (crc != obj->crc)
                      LOG_ERROR ("CRC mismatch: %x != %x\n", crc, obj->crc);
                    if (obj->address + obj->size != bit_chain->byte)
                      {
                        size_t offset = (obj->address + obj->size) - bit_chain->byte;
                        if (offset > 0 && offset + bit_chain->byte <= bit_chain->size)
                          {
                            obj->unknown_data = malloc(offset);
                            if (obj->unknown_data)
                              {
                                memcpy(obj->unknown_data, bit_chain->chain + bit_chain->byte, offset);
                                bit_chain->byte += offset;
                                obj->unknown_data_size = offset;
                                LOG_TRACE("Trailing unknown data found, size: %" PRIuSIZE "\n", offset);
                              }
                            else
                              {
                                LOG_ERROR ("Out of memory");
                                return DWG_ERR_OUTOFMEM;
                              }
                          }
                        else if (offset < 0)
                          LOG_WARN ("Object size mismatch, expected: %" PRIuSIZE ", actual: %" PRIuSIZE "\n", obj->address + obj->size, bit_chain->byte);
                      }
                  }