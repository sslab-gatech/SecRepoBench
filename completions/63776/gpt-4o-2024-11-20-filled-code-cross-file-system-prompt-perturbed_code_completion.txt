{
  // Validate object size and extract unknown data if necessary
  obj->size = (dat->byte - obj->address) & 0xFFFFFFFF;
  if (obj->size > size || obj->address + obj->size > dat->size)
    {
      LOG_ERROR ("Object size mismatch or out of bounds: obj->size=%u, "
                 "size=%u, dat->size=%" PRIuSIZE "\n",
                 obj->size, size, dat->size);
      return DWG_ERR_INVALIDDWG;
    }

  if (obj->address + obj->size < dat->byte)
    {
      size_t unknown_size = dat->byte - (obj->address + obj->size);
      LOG_WARN ("Unknown trailing data detected: %" PRIuSIZE " bytes\n",
                unknown_size);
      obj->unknown_data = (unsigned char *)malloc (unknown_size);
      if (!obj->unknown_data)
        {
          LOG_ERROR ("Out of memory while allocating unknown data\n");
          return DWG_ERR_OUTOFMEM;
        }
      memcpy (obj->unknown_data, dat->chain + obj->address + obj->size,
              unknown_size);
      obj->unknown_size = unknown_size;
    }
  else
    {
      obj->unknown_data = NULL;
      obj->unknown_size = 0;
    }

  // Perform CRC validation for later versions
  if (dat->version >= R_13)
    {
      uint32_t crc = bit_read_CRC (dat, obj->address, obj->size);
      if (crc != obj->crc)
        {
          LOG_ERROR ("CRC mismatch: calculated=0x%x, expected=0x%x\n", crc,
                     obj->crc);
          return DWG_ERR_CRC;
        }
    }
}