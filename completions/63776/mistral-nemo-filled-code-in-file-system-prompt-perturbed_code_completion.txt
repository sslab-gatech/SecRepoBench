// This code block handles the size validation and unknown data extraction for DWG objects in pre-R13 and later versions.
// For pre-R11 versions, the code checks if the object's size is valid and within the bounds of the data, adjusting it if necessary.
// It extracts any unknown remaining data if the object size doesn't match the current data position and logs errors if issues are found.
// For later versions, additional CRC checks are performed to ensure data integrity, and adjustments are made to account for any size discrepancies.
// If the object's address and size don't align with the data position, the code calculates the offset for any trailing unknown data and allocates memory to store it, logging appropriate messages.
// <MASK>
{
  if (obj->size > (BITCODE_RL)(bit_chain->byte - oldpos))
    {
      LOG_ERROR ("Invalid object size %u > %u", obj->size,
                 (unsigned)(bit_chain->byte - oldpos));
      obj->size = (BITCODE_RL)(bit_chain->byte - oldpos);
    }
  if (obj->size < (BITCODE_RL)(bit_chain->byte - oldpos))
    {
      LOG_WARN ("Invalid object size %u < %u", obj->size,
                 (unsigned)(bit_chain->byte - oldpos));
      obj->size = (BITCODE_RL)(bit_chain->byte - oldpos);
    }
  if (obj->size != (BITCODE_RL)(bit_chain->byte - oldpos))
    {
      size_t unknown_size = obj->size - (bit_chain->byte - oldpos);
      if (unknown_size > 0)
        {
          obj->unknown_rest = dwg_decode_unknown_rest (bit_chain, obj);
          if (obj->unknown_rest)
            {
              LOG_WARN ("Unknown data at %" PRIuSIZE " size %zu",
                         bit_chain->byte, unknown_size);
              LOG_RPOS
              LOG_TRACE_TF (obj->unknown_rest, unknown_size);
            }
        }
    }
}