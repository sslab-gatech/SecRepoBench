PRE (R_2_0b) 
{
  // Pre R_2_0 doesn't contain size of entity
  obj->size = (BITCODE_RL)(dat->byte - previous_byte_position);
  LOG_TRACE ("-size: %u (calc)\n", obj->size);
}
LATER_VERSIONS
{
  BITCODE_RS obj_size;
  obj_size = bit_read_RS (dat);
  LOG_TRACE ("-size: %u [RS] (@%" PRIuSIZE ".%u)\n", obj_size, dat->byte - 2, dat->bit);
  
  if (obj_size > 0x1000) 
  {
    LOG_ERROR ("Invalid object size %u > 0x1000", (unsigned)obj_size);
    error |= DWG_ERR_INVALIDDWG;
  }
  else if (previous_byte_position + obj_size > dat->size) 
  {
    LOG_ERROR ("Invalid object size %u beyond stream", (unsigned)obj_size);
    error |= DWG_ERR_INVALIDDWG;
  }
  else 
  {
    obj->size = obj_size;
    
    if (previous_byte_position + obj_size != dat->byte) 
    {
      if (previous_byte_position + obj_size < dat->byte) 
      {
        LOG_ERROR ("Object went past end %lu > %lu",
                  (unsigned long)dat->byte, 
                  (unsigned long)(previous_byte_position + obj_size));
        error |= DWG_ERR_INVALIDDWG;
      } 
      else 
      {
        // Trailing unknown data to extract
        BITCODE_RL offset = (BITCODE_RL)((previous_byte_position + obj_size) - dat->byte);
        if (offset > 0 && offset < 0x1000) 
        {
          obj->num_unknown_rest = 8 * offset;
          obj->unknown_rest = (BITCODE_TF)calloc (offset, 1);
          if (obj->unknown_rest) 
          {
            memcpy (obj->unknown_rest, &dat->chain[dat->byte], offset);
            LOG_TRACE_TF (obj->unknown_rest, offset);
            dat->byte += offset;
          } 
          else 
          {
            LOG_ERROR ("Out of memory");
            obj->num_unknown_rest = 0;
          }
        }
      }
    }
    
    SINCE (R_11) 
    {
      BITCODE_RS crc, crcc;
      size_t oldpos = dat->byte;
      dat->byte = previous_byte_position + obj_size - 2;
      crc = bit_read_RS (dat);
      LOG_TRACE ("crc: %04X [RSx]\n", crc);
      crcc = bit_calc_CRC (0xC0C1, &dat->chain[previous_byte_position], obj_size - 2);
      if (crc != crcc) 
      {
        LOG_ERROR ("Wrong CRC %04X <=> %04X", crc, crcc);
        error |= DWG_ERR_WRONGCRC;
      }
      dat->byte = oldpos; // Restore position
    }
  }
}