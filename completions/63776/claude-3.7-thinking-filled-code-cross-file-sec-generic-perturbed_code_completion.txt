PRE (R_11)
{
  obj->size = bit_read_RS (dat);
  LOG_TRACE ("size: " FORMAT_RS " [RS]\n", obj->size);
  if (obj->size < 2 || obj->size > 0x1000)
    {
      LOG_ERROR ("Invalid object size " FORMAT_RS, obj->size);
      obj->size = (dat->byte - previous_byte_position) & 0xFFFFFFFF;
    }
  if (obj->size + previous_byte_position > dat->size)
    {
      LOG_ERROR ("Object size overflow " FORMAT_RS " > %" PRIuSIZE,
                 obj->size, dat->size - previous_byte_position);
      obj->size = (dat->size - previous_byte_position) & 0xFFFFFFFF;
    }
  if (obj->size + previous_byte_position != dat->byte)
    {
      BITCODE_RL offset = (obj->size + previous_byte_position) - dat->byte;
      if (offset > 0)
        {
          LOG_TRACE ("Unknown data remaining: " FORMAT_RL " bytes\n", offset);
          obj->unknown_rest = (unsigned char *)calloc (offset, 1);
          if (obj->unknown_rest)
            {
              memcpy (obj->unknown_rest, &dat->chain[dat->byte], offset);
              obj->unknown_rest_size = offset;
              dat->byte += offset;
            }
        }
      else
        {
          LOG_ERROR ("Object size underflow: %ld bytes", (long)offset);
        }
    }
}
LATER_VERSIONS
{
  obj->size = bit_read_RS (dat);
  LOG_TRACE ("size: " FORMAT_RS " [RS]\n", obj->size);
  if (obj->size < 2 || obj->size > 0x1000)
    {
      LOG_ERROR ("Invalid object size " FORMAT_RS, obj->size);
      obj->size = (dat->byte - previous_byte_position) & 0xFFFFFFFF;
    }
  if (obj->size + previous_byte_position > dat->size)
    {
      LOG_ERROR ("Object size overflow " FORMAT_RS " > %" PRIuSIZE,
                 obj->size, dat->size - previous_byte_position);
      obj->size = (dat->size - previous_byte_position) & 0xFFFFFFFF;
    }
  
  BITCODE_RS crc, calc_crc;
  crc = bit_read_RS (dat);
  LOG_TRACE ("crc: " FORMAT_RS " [RS]\n", crc);
  
  if (obj->size + previous_byte_position != dat->byte)
    {
      BITCODE_RL offset = (obj->size + previous_byte_position) - dat->byte;
      if (offset > 0)
        {
          LOG_TRACE ("Unknown data remaining: " FORMAT_RL " bytes\n", offset);
          obj->unknown_rest = (unsigned char *)calloc (offset, 1);
          if (obj->unknown_rest)
            {
              memcpy (obj->unknown_rest, &dat->chain[dat->byte], offset);
              obj->unknown_rest_size = offset;
              dat->byte += offset;
            }
        }
      else
        {
          LOG_ERROR ("Object size underflow: %ld bytes", (long)offset);
        }
    }
}