if (dat->version < R_11)
                  {
                    if (obj->size > (BITCODE_RL)(dat->size - dat->byte))
                      {
                        LOG_ERROR ("size too big: " FORMAT_RL " > " FORMAT_RL
                                   "\n",
                                   obj->size, (BITCODE_RL)(dat->size - dat->byte));
                        obj->size = (BITCODE_RL)(dat->size - dat->byte);
                      }
                    if (obj->size > 0
                        && (BITCODE_RL)dat->byte + obj->size > dat->size)
                      {
                        LOG_ERROR ("size does not fit: " FORMAT_RL " + " FORMAT_RL
                                   " > " FORMAT_RL "\n",
                                   (BITCODE_RL)dat->byte, obj->size, dat->size);
                        obj->size = (BITCODE_RL)(dat->size - dat->byte);
                      }
                    if (obj->size > 0)
                      {
                        previous_byte_position = dat->byte;
                        dat->byte += obj->size;
                        if (dat->byte > previous_byte_position
                            && (BITCODE_RL)dat->byte != end)
                          {
                            size_t unknown_size = 0;
                            if (end > dat->byte)
                              unknown_size = end - dat->byte;
                            LOG_WARN ("Unknown remaining data (%u)\n",
                                      (unsigned)unknown_size);
                            if (unknown_size > 0)
                              UNKNOWN ((unsigned)unknown_size);
                            dat->byte = end;
                          }
                      }
                  }
                else
                  {
                    BITCODE_32B crc;
                    size_t current_byte = dat->byte;
                    previous_byte_position = dat->byte;
                    dat->byte += obj->size;
                    if (dat->byte > dat->size)
                      {
                        LOG_ERROR ("size does not fit: " FORMAT_RL " + " FORMAT_RL
                                   " > " FORMAT_RL "\n",
                                   (BITCODE_RL)current_byte, obj->size,
                                   dat->size);
                        obj->size = (BITCODE_RL)(dat->size - current_byte);
                        dat->byte = dat->size;
                      }
                    crc = bit_read_32B (dat);
                    if (obj->address + obj->size + 4 != dat->byte)
                      {
                        size_t offset = (obj->address + obj->size + 4) - dat->byte;
                        LOG_ERROR ("CRC failed: " FORMAT_32Bx "\n", crc);
                        if (offset > 0)
                          {
                            LOG_WARN ("Unknown trailing data (%u)\n",
                                      (unsigned)offset);
                            obj->unknown_data = malloc (offset);
                            if (obj->unknown_data)
                              memcpy (obj->unknown_data, dat->chain + dat->byte,
                                      offset);
                            dat->byte += offset;
                          }
                      }
                  }