if (packet->payload_length < MIN_MEMCACHED_LENGTH) {
    return; // Exclude the protocol if the packet length is insufficient
  }

  if (stream->l4_proto == IPPROTO_UDP) {
    if (packet->payload_length < UDP_HEADER_LENGTH) {
      return; // Exclude the protocol if the UDP header length is not met
    }
    offset += UDP_HEADER_LENGTH; // Adjust offset for UDP
  } else if (stream->l4_proto == IPPROTO_TCP) {
    if (packet->payload_length < TCP_HEADER_LENGTH) {
      return; // Exclude the protocol if the TCP header length is not met
    }
    offset += TCP_HEADER_LENGTH; // Adjust offset for TCP
  } else {
    return; // Exclude the protocol if neither TCP nor UDP
  }

  // Update matches pointer based on the protocol type
  *matches = 0; // Initialize matches counter