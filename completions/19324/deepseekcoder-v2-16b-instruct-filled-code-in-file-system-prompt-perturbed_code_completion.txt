if (packet->udp != NULL) {
    if (packet->payload_packet_len < MEMCACHED_MIN_UDP_LEN) {
      return;
    }
    offset += MEMCACHED_UDP_HDR_LEN;
    packet->payload_packet_len -= MEMCACHED_UDP_HDR_LEN;
  } else if (packet->tcp != NULL) {
    if (packet->payload_packet_len < MEMCACHED_MIN_LEN) {
      return;
    }
  } else {
    return;
  }

  if (*matches >= MEMCACHED_MIN_MATCH)
    ndpi_int_memcached_add_connection(ndpi_struct, stream);
}