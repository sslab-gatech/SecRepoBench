if (stream->l4_proto == IPPROTO_TCP) {
    if (packet->payload_length < MIN_TCP_MEMCACHED_LENGTH) {
        return; // Exclude protocol
    }
    // Process TCP packet
} else if (stream->l4_proto == IPPROTO_UDP) {
    if (packet->payload_length < MIN_UDP_MEMCACHED_LENGTH) {
        return; // Exclude protocol
    }
    // Adjust offset for UDP header
    offset += UDP_HEADER_LENGTH;
    // Process UDP packet
} else {
    return; // Exclude protocol
}