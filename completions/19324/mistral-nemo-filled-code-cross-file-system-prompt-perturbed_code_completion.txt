if (stream->packet.udp) {
  offset += 8; // Skip UDP header length
  if (packet->size < 16) {
    *matches = 0;
    return;
  }
} else if (stream->packet.tcp) {
  if (packet->size < 16) {
    *matches = 0;
    return;
  }
} else {
  *matches = 0;
  return;
}

*matches = 0;