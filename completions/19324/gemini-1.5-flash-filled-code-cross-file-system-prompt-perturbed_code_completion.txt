u_int8_t *matches = (stream->l4_proto == IPPROTO_TCP) ?
    &stream->tcp.memcached_matches : &stream->udp.memcached_matches;

  if (packet->len < MEMCACHED_MIN_LEN) return;

  if (stream->l4_proto == IPPROTO_UDP) {
    if (packet->len < (MEMCACHED_MIN_LEN + 8)) return;
    offset += 8;
  }