if (packet->udp) {
  offset += sizeof(struct udphdr); // Skip UDP header
  packet->payload_length -= sizeof(struct udphdr); // Adjust length
}