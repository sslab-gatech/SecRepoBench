u_int8_t *matches = NULL;
  if (packet->l4_proto == IPPROTO_TCP) {
    if (packet->payload_len < NDPI_MEMCACHED_MIN_TCP_LEN) return;
    matches = &stream->tcp.memcached_matches;
  } else if (packet->l4_proto == IPPROTO_UDP) {
    if (packet->payload_len < NDPI_MEMCACHED_MIN_UDP_LEN) return;
    offset += 8; // Skip UDP header (8 bytes)
    packet->payload_len -= 8; // Adjust payload length
    matches = &stream->udp.memcached_matches;
    // Check for UDP header conditions (e.g., source/destination ports)
    if (ntohs(packet->udp.source_port) != 11211 && ntohs(packet->udp.dest_port) != 11211) return;
  } else {
    return;
  }