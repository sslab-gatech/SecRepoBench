{
  /* Log that a memcached search is being performed */
  NDPI_LOG_DBG2(ndpi_struct, "ndpi_search_memcached: scanning packet.\n");

  /* Local variables */
  u_int16_t length = packet->payload_packet_len;
  u_int16_t *matches = NULL;

  /* Determine if packet uses TCP or UDP and perform length checks */
  if(stream->l4_proto == IPPROTO_TCP) {
    /* Check if the packet meets the minimum length requirement for TCP */
    if(length < 5) {
      NDPI_LOG_DBG2(ndpi_struct, "ndpi_search_memcached: TCP packet too short.\n");
      NDPI_EXCLUDE_PROTO(ndpi_struct, stream);
      return;
    }
    matches = &stream->l4.tcp.memcached_stage; /* example pointer for TCP */
  } else if(stream->l4_proto == IPPROTO_UDP) {
    /* Check if the packet meets the minimum length requirement for UDP */
    if(length < 13) {
      NDPI_LOG_DBG2(ndpi_struct, "ndpi_search_memcached: UDP packet too short.\n");
      NDPI_EXCLUDE_PROTO(ndpi_struct, stream);
      return;
    }
    /* Skip the UDP header */
    offset += 8;
    length -= 8;
    matches = &stream->l4.udp.memcached_stage; /* example pointer for UDP */
  } else {
    /* Exclude if it's neither TCP nor UDP */
    NDPI_LOG_DBG2(ndpi_struct, "ndpi_search_memcached: not TCP or UDP.\n");
    NDPI_EXCLUDE_PROTO(ndpi_struct, stream);
    return;
  }
}