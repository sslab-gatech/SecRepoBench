u_int16_t length = packet->payload_packet_len;
  u_int16_t *matches = NULL;

  NDPI_LOG_INFO(ndpi_struct, "search memcached\n");

  if (packet->tcp != NULL) {
    if (length < MEMCACHED_MIN_LEN) return;
    matches = &stream->memcached_tcp_matches;
  } else if (packet->udp != NULL) {
    if (length < MEMCACHED_MIN_UDP_LEN) return;
    if (packet->payload[0] != 0 || packet->payload[1] != 0) return;
    offset += MEMCACHED_UDP_HDR_LEN;
    length -= MEMCACHED_UDP_HDR_LEN;
    matches = &stream->memcached_udp_matches;
  } else {
    NDPI_EXCLUDE_PROTO(ndpi_struct, stream);
    return;
  }