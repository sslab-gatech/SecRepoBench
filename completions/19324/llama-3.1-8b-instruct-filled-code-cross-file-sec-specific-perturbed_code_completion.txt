// <MASK>
if (MEMCACHED_MATCH(MCDC_SET)) {
  if (packet->payload_len >= MEMCACHED_MIN_LEN) {
    // Check for the magic number and protocol version
    if (memcmp(offset, MEMCACHED_MAGIC, MEMCACHED_MAGIC_LEN) == 0) {
      // Check for the protocol version
      if (memcmp(offset + MEMCACHED_MAGIC_LEN, MEMCACHED_VERSION, MEMCACHED_VERSION_LEN) == 0) {
        // Check for the opcode
        if (offset[MEMCACHED_VERSION_LEN + MEMCACHED_MAGIC_LEN] == MEMCACHED_OPCODE_SET) {
          // Check for the key and value lengths
          if (offset[MEMCACHED_VERSION_LEN + MEMCACHED_MAGIC_LEN + 1] == MEMCACHED_KEY_LEN &&
              offset[MEMCACHED_VERSION_LEN + MEMCACHED_MAGIC_LEN + 2] == MEMCACHED_VALUE_LEN) {
            // Check for the key and value
            if (memcmp(offset + MEMCACHED_VERSION_LEN + MEMCACHED_MAGIC_LEN + 3, MEMCACHED_KEY, MEMCACHED_KEY_LEN) == 0 &&
                memcmp(offset + MEMCACHED_VERSION_LEN + MEMCACHED_MAGIC_LEN + 3 + MEMCACHED_KEY_LEN, MEMCACHED_VALUE, MEMCACHED_VALUE_LEN) == 0) {
              *matches += 1;
            }
          }
        }
      }
    }
  }
} else if (MEMCACHED_MATCH(MCDC_ADD)) {
  // Add similar checks for the ADD opcode
  //...
} else if (MEMCACHED_MATCH(MCDC_REPLACE)) {
  // Add similar checks for the REPLACE opcode
  //...
} else if (MEMCACHED_MATCH(MCDC_APPEND)) {
  // Add similar checks for the APPEND opcode
  //...
} else if (MEMCACHED_MATCH(MCDC_PREPEND)) {
  // Add similar checks for the PREPEND opcode
  //...
} else if (MEMCACHED_MATCH(MCDC_CAS)) {
  // Add similar checks for the CAS opcode
  //...
} else if (MEMCACHED_MATCH(MCDC_GET)) {
  // Add similar checks for the GET opcode
  //...
} else if (MEMCACHED_MATCH(MCDC_GETS)) {
  // Add similar checks for the GETS opcode
  //...
} else if (MEMCACHED_MATCH(MCDC_DELETE)) {
  // Add similar checks for the DELETE opcode
  //...
} else if (MEMCACHED_MATCH(MCDC_INCR)) {
  // Add similar checks for the INCR opcode
  //...
} else if (MEMCACHED_MATCH(MCDC_DECR)) {
  // Add similar checks for the DECR opcode
  //...
} else if (MEMCACHED_MATCH(MCDC_TOUCH)) {
  // Add similar checks for the TOUCH opcode
  //...
} else if (MEMCACHED_MATCH(MCDC_GAT)) {
  // Add similar checks for the GAT opcode
  //...
} else if (MEMCACHED_MATCH(MCDC_GATS)) {
  // Add similar checks for the GATS opcode
  //...
} else if (MEMCACHED_MATCH(MCDC_STATS)) {
  // Add similar checks for the STATS opcode
  //...
} else if (MEMCACHED_MATCH(MCDR_ERROR)) {
  // Add similar checks for the ERROR opcode
  //...
} else if (MEMCACHED_MATCH(MCDR_CLIENT_ERROR)) {
  // Add similar checks for the CLIENT_ERROR opcode
  //...
} else if (MEMCACHED_MATCH(MCDR_SERVER_ERROR)) {
  // Add similar checks for the SERVER_ERROR opcode
  //...
} else if (MEMCACHED_MATCH(MCDR_STORED)) {
  // Add similar checks for the STORED opcode
  //...
} else if (MEMCACHED_MATCH(MCDR_NOT_STORED)) {
  // Add similar checks for the NOT_STORED opcode
  //...
} else if (MEMCACHED_MATCH(MCDR_EXISTS)) {
  // Add similar checks for the EXISTS opcode
  //...
} else if (MEMCACHED_MATCH(MCDR_NOT_FOUND)) {
  // Add similar checks for the NOT_FOUND opcode
  //...
} else if (MEMCACHED_MATCH(MCDR_END)) {
  // Add similar checks for the END opcode
  //...
} else if (MEMCACHED_MATCH(MCDR_DELETED)) {
  // Add similar checks for the DELETED opcode
  //...
} else if (MEMCACHED_MATCH(MCDR_TOUCHED)) {
  // Add similar checks for the TOUCHED opcode
  //...
} else if (MEMCACHED_MATCH(MCDR_STAT)) {
  // Add similar checks for the STAT opcode
  //...
}