{
  u_int8_t *matches = NULL;

  if(stream->l4_proto == IPPROTO_TCP) {
    // Check if TCP packet length meets minimum requirement (for example, at least 4 bytes for a valid command)
    if(packet->payload_packet_len < 4)
      return;
    matches = &stream->memcached_tcp_matches;
  }
  else if(stream->l4_proto == IPPROTO_UDP) {
    // Check if UDP packet length meets minimum requirement (UDP header + at least 4 bytes for a valid command)
    if(packet->payload_packet_len < 12)
      return;
    // Verify that the packet contains a valid UDP header for memcached.
    // For example, in the binary memcached protocol the request magic is 0x80.
    if(offset[0] != 0x80)
      return;
    // Skip the UDP header (assumed to be 8 bytes long)
    offset += 8;
    packet->payload_packet_len -= 8;
    matches = &stream->memcached_udp_matches;
  }
  else {
    return;
  }
}