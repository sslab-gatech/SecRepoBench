if (utf8) {
  *mincharindex = 0;
  *cmax = len - 1;
  if (*mincharindex + cpdmin <= len - 1) {
    *mincharindex += cpdmin;
  } else {
    *mincharindex = len - 1;
  }
  // Exclude trailing UTF-8 continuation bytes
  while (*cmax > 0 && (word[*cmax] & 0xc0) == 0x80) {
    *cmax -= 1;
  }
} else {
  *mincharindex = cpdmin;
  *cmax = len - 1;
}