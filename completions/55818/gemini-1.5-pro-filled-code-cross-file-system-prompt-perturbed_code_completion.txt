if (utf8) {
    *mincharindex = utf8_mincharindex(word, len);
    *cmax = utf8_maxcharindex(word, len);

    *mincharindex += cpdmin;
    while (*cmax > *mincharindex &&
           ((unsigned char)word[*cmax - 1] & 0xc0) == 0x80)
      (*cmax)--;
  } else {
    *mincharindex += cpdmin;
    *cmax -= cpdmax;
  }