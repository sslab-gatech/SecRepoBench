// If utf8 is set, calculate min char index and max char index based on UTF-8 boundaries
if (utf8) {
    *mincharindex = start;
    *cmax = len;
    for (size_t i = start; i < len && i < start + cpdmin; ++i) {
        for (; (word[i] & 0xc0) == 0x80; ++i)
            ;
        ++(*mincharindex);
    }
    for (size_t i = *cmax - 1; i > *cmax - cpdmin; --i) {
        while (i > 0 && (word[i] & 0xc0) == 0x80)
            --i;
        --(*cmax);
    }
} else {
    // If utf8 is not set, simply adjust min char index and max char index
    *mincharindex = start + cpdmin;
    *cmax = len - cpdmin;
}