if (utf8) {
    size_t min_index = 0;
    size_t max_index = len;

    // Calculate the minimum character index based on UTF-8 character boundaries
    while (min_index < len && (word[min_index] & 0xc0) == 0x80) {
      min_index++;
    }
    *mincharindex = min_index;

    // Calculate the maximum character index, excluding trailing continuation bytes
    while (max_index > 0 && (word[max_index - 1] & 0xc0) == 0x80) {
      max_index--;
    }
    *cmax = max_index;
  } else {
    *mincharindex = 0;
    *cmax = len;
  }