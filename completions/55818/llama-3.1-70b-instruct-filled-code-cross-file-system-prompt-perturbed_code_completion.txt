if (utf8) {
  size_t mincharindex_utf8 = 0;
  size_t cmax_utf8 = 0;
  for (size_t i = 0; i < len; i++) {
    if ((word[i] & 0xc0)!= 0x80) {
      if (mincharindex_utf8 == 0)
        mincharindex_utf8 = i;
      cmax_utf8 = i;
    }
  }
  *mincharindex = mincharindex_utf8 + cpdmin;
  *cmax = cmax_utf8;
} else {
  *mincharindex = cpdmin;
  *cmax = len - 1;
}