table[scpd - 1].pattern.size() - 1;
          if (checkcpdtable[scpd - 1].pattern2.empty()) {
            onlycpdrule = 0;
            break;
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcpdtable[scpd - 1].pattern2, words[wordnum]->alen)) {
              st.replace(i, std::string::npos, checkcpdtable[scpd - 1].pattern);
              soldi = i;
              i += checkcpdtable[scpd - 1].pattern.size() - 1;
              onlycpdrule = 0;
              break;
            }
          }
        }

        if (checked_prefix == 0) {
          checked_prefix = 1;
          rv = prefix_check(st, i, word.size() - i, IN_CPD_MID, FLAG_NULL);
          if (rv) {
            if (TESTAFF(rv->astr, checkcpdtable[scpd - 1].pattern2, rv->alen)) {
              st.replace(i, std::string::npos, checkcpdtable[scpd - 1].pattern);
              soldi = i;
              i += checkcpdtable[scpd - 1].pattern.size() - 1;
              onlycpdrule = 0;
              break;
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcpdtable[scpd - 1].pattern2, words[wordnum]->alen)) {
              st.replace(i, std::string::npos, checkcpdtable[scpd - 1].pattern);
              soldi = i;
              i += checkcpdtable[scpd - 1].pattern.size() - 1;
              onlycpdrule = 0;
              break;
            }
          }
        }

        if (checkedstriple == 0) {
          checkedstriple = 1;
          if (simplifiedtriple && i > 0 && i + 1 < word.size() && word[i - 1] == word[i] && word[i] == word[i + 1]) {
            st[i - 1] = st[i] = st[i + 1] = '.';
            striple = 1;
          }
        }

        if (striple) {
          rv = prefix_check(st, i, word.size() - i, IN_CPD_MID, FLAG_NULL);
          if (rv) {
            if (TESTAFF(rv->astr, checkcpdtable[scpd - 1].pattern2, rv->alen)) {
              st.replace(i, std::string::npos, checkcpdtable[scpd - 1].pattern);
              soldi = i;
              i += checkcpdtable[scpd - 1].pattern.size() - 1;
              onlycpdrule = 0;
              break;
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcpdtable[scpd - 1].pattern2, words[wordnum]->alen)) {
              st.replace(i, std::string::npos, checkcpdtable[scpd - 1].pattern);
              soldi = i;
              i += checkcpdtable[scpd - 1].pattern.size() - 1;
              onlycpdrule = 0;
              break;
            }
          }
        }

        if (checkedstriple) {
          striple = 0;
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcpdtable[scpd - 1].pattern2, words[wordnum]->alen)) {
              st.replace(i, std::string::npos, checkcpdtable[scpd - 1].pattern);
              soldi = i;
              i += checkcpdtable[scpd - 1].pattern.size() - 1;
              onlycpdrule = 0;
              break;
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcpdtable[scpd - 1].pattern2, words[wordnum]->alen)) {
              st.replace(i, std::string::npos, checkcpdtable[scpd - 1].pattern);
              soldi = i;
              i += checkcpdtable[scpd - 1].pattern.size() - 1;
              onlycpdrule = 0;
              break;
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcpdtable[scpd - 1].pattern2, words[wordnum]->alen)) {
              st.replace(i, std::string::npos, checkcpdtable[scpd - 1].pattern);
              soldi = i;
              i += checkcpdtable[scpd - 1].pattern.size() - 1;
              onlycpdrule = 0;
              break;
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcpdtable[scpd - 1].pattern2, words[wordnum]->alen)) {
              st.replace(i, std::string::npos, checkcpdtable[scpd - 1].pattern);
              soldi = i;
              i += checkcpdtable[scpd - 1].pattern.size() - 1;
              onlycpdrule = 0;
              break;
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcpdtable[scpd - 1].pattern2, words[wordnum]->alen)) {
              st.replace(i, std::string::npos, checkcpdtable[scpd - 1].pattern);
              soldi = i;
              i += checkcpdtable[scpd - 1].pattern.size() - 1;
              onlycpdrule = 0;
              break;
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcpdtable[scpd - 1].pattern2, words[wordnum]->alen)) {
              st.replace(i, std::string::npos, checkcpdtable[scpd - 1].pattern);
              soldi = i;
              i += checkcpdtable[scpd - 1].pattern.size() - 1;
              onlycpdrule = 0;
              break;
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcpdtable[scpd - 1].pattern2, words[wordnum]->alen)) {
              st.replace(i, std::string::npos, checkcpdtable[scpd - 1].pattern);
              soldi = i;
              i += checkcpdtable[scpd - 1].pattern.size() - 1;
              onlycpdrule = 0;
              break;
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcpdtable[scpd - 1].pattern2, words[wordnum]->alen)) {
              st.replace(i, std::string::npos, checkcpdtable[scpd - 1].pattern);
              soldi = i;
              i += checkcpdtable[scpd - 1].pattern.size() - 1;
              onlycpdrule = 0;
              break;
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcpdtable[scpd - 1].pattern2, words[wordnum]->alen)) {
              st.replace(i, std::string::npos, checkcpdtable[scpd - 1].pattern);
              soldi = i;
              i += checkcpdtable[scpd - 1].pattern.size() - 1;
              onlycpdrule = 0;
              break;
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcpdtable[scpd - 1].pattern2, words[wordnum]->alen)) {
              st.replace(i, std::string::npos, checkcpdtable[scpd - 1].pattern);
              soldi = i;
              i += checkcpdtable[scpd - 1].pattern.size() - 1;
              onlycpdrule = 0;
              break;
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcpdtable[scpd - 1].pattern2, words[wordnum]->alen)) {
              st.replace(i, std::string::npos, checkcpdtable[scpd - 1].pattern);
              soldi = i;
              i += checkcpdtable[scpd - 1].pattern.size() - 1;
              onlycpdrule = 0;
              break;
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcpdtable[scpd - 1].pattern2, words[wordnum]->alen)) {
              st.replace(i, std::string::npos, checkcpdtable[scpd - 1].pattern);
              soldi = i;
              i += checkcpdtable[scpd - 1].pattern.size() - 1;
              onlycpdrule = 0;
              break;
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcpdtable[scpd - 1].pattern2, words[wordnum]->alen)) {
              st.replace(i, std::string::npos, checkcpdtable[scpd - 1].pattern);
              soldi = i;
              i += checkcpdtable[scpd - 1].pattern.size() - 1;
              onlycpdrule = 0;
              break;
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcpdtable[scpd - 1].pattern2, words[wordnum]->alen)) {
              st.replace(i, std::string::npos, checkcpdtable[scpd - 1].pattern);
              soldi = i;
              i += checkcpdtable[scpd - 1].pattern.size() - 1;
              onlycpdrule = 0;
              break;
            }
          }
        }

        if (onlycpdrule) {
          if (words[wordnum]->astr) {
            if (TESTAFF(words[wordnum]->astr, checkcpdtable[scpd - 1].pattern2, words[wordnum]->alen)) {
              st.replace(i, std::string::npos, checkcpdtable[scpd - 1].pattern);
              soldi = i;
              i += checkcpdtable[scpd - 1].pattern.size() - 1;
              onlycpdrule = 0;
              break;
            }
          }
        }

        if (onlycpdrule) {
          if (