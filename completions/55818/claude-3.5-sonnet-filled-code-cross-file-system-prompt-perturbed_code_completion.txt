if (utf8) {
  *mincharindex = 0;
  *cmax = len;
  for (size_t i = 0; i < cpdmin; ++i) {
    if (*mincharindex < len) {
      (*mincharindex)++;
      while (*mincharindex < len && (word[*mincharindex] & 0xC0) == 0x80) {
        (*mincharindex)++;
      }
    }
  }
  while (*cmax > *mincharindex && (word[*cmax - 1] & 0xC0) == 0x80) {
    (*cmax)--;
  }
} else {
  *mincharindex = cpdmin;
  *cmax = len;
}