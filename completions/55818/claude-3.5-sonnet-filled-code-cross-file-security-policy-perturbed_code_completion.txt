if (utf8) {
  *mincharindex = 0;
  *cmax = len;
  size_t i = 0;
  while (i < len && i < cpdmin) {
    (*mincharindex)++;
    for (i++; i < len && (word[i] & 0xc0) == 0x80; i++)
      ;
  }
  while (*cmax > *mincharindex && (word[*cmax - 1] & 0xc0) == 0x80)
    (*cmax)--;
} else {
  *mincharindex = cpdmin;
  *cmax = len;
}