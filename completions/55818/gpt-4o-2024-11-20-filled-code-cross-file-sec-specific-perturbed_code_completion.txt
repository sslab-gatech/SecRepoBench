if (utf8) {
    // Initialize mincharindex to the start of the word
    *mincharindex = 0;

    // Calculate the minimum character index by skipping `cpdmin` UTF-8 characters
    for (size_t i = 0, char_count = 0; i < len && char_count < cpdmin; ++i) {
        if ((word[i] & 0xC0) != 0x80) { // Check for the start of a UTF-8 character
            ++char_count;
            *mincharindex = i;
        }
    }

    // Initialize cmax to the end of the word
    *cmax = len;

    // Adjust cmax to exclude trailing UTF-8 continuation bytes
    while (*cmax > 0 && (word[*cmax - 1] & 0xC0) == 0x80) {
        --(*cmax);
    }
} else {
    // For non-UTF-8, set mincharindex and cmax directly
    *mincharindex = cpdmin < len ? cpdmin : len;
    *cmax = len;
}