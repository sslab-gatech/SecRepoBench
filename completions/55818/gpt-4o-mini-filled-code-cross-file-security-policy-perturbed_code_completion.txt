if (utf8) {
    *mincharindex = 0;
    *cmax = len;
    const char* p = word + len;
    while (p > word && (*(p - 1) & 0xc0) == 0x80) {
      p--;
      (*cmax)--;
    }
  } else {
    *mincharindex = 0;
    *cmax = len;
  }