if (utf8) {
    const char* p;
    const char* wordp = word.c_str();
    for (p = wordp + len - 1; p > wordp && (*p & 0xc0) == 0x80; p--)
        ;
    *mincharindex = p - wordp;
    *cmax = len;
} else {
    *mincharindex = cpdmin;
    *cmax = len - cpdmin;
}