*mincharindex = 0;
*cmax = len - 1;
if (utf8) {
  const char* p = word;
  const char* endp = word + len;
  while (p < endp && (*p & 0xc0) == 0x80) {
    (*mincharindex)++;
    p++;
  }
  if (cpdmin > 0 && *mincharindex < len) {
    int count = 0;
    while (p < endp && count < cpdmin) {
      if ((*p & 0xc0) != 0x80)
        count++;
      (*mincharindex)++;
      p++;
    }
  }
  p = word + len - 1;
  while (p > word && (*p & 0xc0) == 0x80) {
    (*cmax)--;
    p--;
  }
} else {
  if (cpdmin > 0 && *mincharindex < len)
    (*mincharindex) += cpdmin;
  if (*mincharindex > len - 1)
    *mincharindex = len - 1;
  if (*cmax > len - 1)
    *cmax = len - 1;
}