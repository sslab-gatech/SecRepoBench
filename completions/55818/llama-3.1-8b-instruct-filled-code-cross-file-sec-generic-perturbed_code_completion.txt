void AffixMgr::setcminmax(size_t* mincharindex, size_t* cmax, const char* word, size_t len) {
  // Determine the minimum and maximum character positions in the word.
  // If the `utf8` flag is set, calculate the min char index as the starting position
  // and max char index as the ending position based on UTF-8 character boundaries.
  // Increment min char index by the number of UTF-8 characters specified by `cpdmin`.
  // Exclude trailing UTF-8 continuation bytes while adjusting max char index.
  // If `utf8` is not set, adjust min char index and max char index.
  if (utf8) {
    const char* p;
    const char* wordp = word;
    for (p = wordp; p > wordp && (*p & 0xc0) == 0x80; p--)
      ;
    size_t mincharindex_val = p - word;
    size_t cmax_val = len;
    for (p = word + len - 1; p > word && (*p & 0xc0) == 0x80; p--)
      ;
    cmax_val = p - word;
    if (cpdmin > 0) {
      mincharindex_val += cpdmin;
    }
  } else {
    size_t mincharindex_val = 0;
    size_t cmax_val = len;
    for (size_t i = 0; i < len; i++) {
      if (csconv[word[i]].ccase) {
        mincharindex_val = i;
        break;
      }
    }
    for (size_t i = len - 1; i >= 0; i--) {
      if (csconv[word[i]].ccase) {
        cmax_val = i;
        break;
      }
    }
  }
  *mincharindex = mincharindex_val;
  *cmax = cmax_val;
}