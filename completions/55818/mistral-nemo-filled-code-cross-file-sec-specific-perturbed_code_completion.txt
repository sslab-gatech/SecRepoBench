if (utf8) {
    size_t min = 0, max = len;
    while (min < len && (word[min] & 0xc0) == 0x80) min++; // Skip leading continuation bytes
    while (max > 0 && (word[max - 1] & 0xc0) == 0x80) max--; // Skip trailing continuation bytes
    if (min < len) mincharindex = min;
    if (max > 0) cmax = max - 1;
    if (cpdmin > 0) mincharindex += cpdmin; // Increment min char index by the number of UTF-8 characters specified by cpdmin
  } else {
    size_t min = 0, max = len;
    while (min < len && !isalpha(word[min])) min++; // Skip leading non-alphabetic characters
    while (max > 0 && !isalpha(word[max - 1])) max--; // Skip trailing non-alphabetic characters
    if (min < len) mincharindex = min;
    if (max > 0) cmax = max - 1;
  }