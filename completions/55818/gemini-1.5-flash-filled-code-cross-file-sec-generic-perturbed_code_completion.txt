if (utf8) {
    size_t i = 0;
    *mincharindex = 0;
    *cmax = len;
    for (i = 0; i < len; i++) {
      if ((word[i] & 0xc0) != 0x80) {
        *mincharindex += 1;
      }
    }
    *mincharindex += cpdmin;
    for (i = len - 1; i > 0; i--) {
      if ((word[i] & 0xc0) != 0x80) {
        *cmax = i + 1;
        break;
      }
    }
  } else {
    *mincharindex = cpdmin;
    *cmax = len;
  }

  if (*mincharindex >= len) {
    *mincharindex = len;
  }
  if (*cmax > len) {
    *cmax = len;
  }