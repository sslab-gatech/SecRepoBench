if (utf8) {
    *mincharindex = 0;
    *cmax = len;
    for (size_t i = 0; i < cpdmin; i++) {
      size_t next_char_pos = next_utf8_char_pos(word, *mincharindex, len);
      if (next_char_pos == *mincharindex) {
        break;
      }
      *mincharindex = next_char_pos;
    }
    while (*cmax > *mincharindex && (*(word + *cmax - 1) & 0xc0) == 0x80) {
      (*cmax)--;
    }
  } else {
    *mincharindex = cpdmin;
    *cmax = len - cpdmin;
  }