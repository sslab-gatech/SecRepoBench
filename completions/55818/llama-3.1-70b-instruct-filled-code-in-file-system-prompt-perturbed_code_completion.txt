if (utf8) {
  size_t mincharindex = 0;
  size_t cmax = 0;
  for (size_t i = 0; i < len; i++) {
    if ((word[i] & 0xc0) == 0xc0) {
      mincharindex = i;
      break;
    }
  }
  for (size_t i = len - 1; i >= 0; i--) {
    if ((word[i] & 0xc0) == 0xc0) {
      cmax = i + 1;
      break;
    }
  }
  cmin = mincharindex + cpdmin;
  if (cmin > cmax)
    cmin = cmax;
} else {
  cmin = cpdmin;
  cmax = len;
}