for (i = 0; i < TagCount; i++) {
    cmsUInt32Number sig, offset, size;

    // Read signature, offset, and size for each tag
    if (!_cmsReadUInt32Number(io, &sig) ||
        !_cmsReadUInt32Number(io, &offset) ||
        !_cmsReadUInt32Number(io, &size))
    {
        return FALSE;
    }

    // Adjust endianness
    sig    = _cmsAdjustEndianess32(sig);
    offset = _cmsAdjustEndianess32(offset);
    size   = _cmsAdjustEndianess32(size);

    // Check if tag is within file bounds
    if ((offset + size) > HeaderSize) {
        // Skip invalid tag
        continue;
    }

    // Record tag signature, offset, size
    Icc->TagNames[Icc->TagCount]   = sig;
    Icc->TagOffsets[Icc->TagCount] = offset;
    Icc->TagSizes[Icc->TagCount]   = size;
    Icc->TagLinked[Icc->TagCount]  = 0;

    // Check for links to previously read tags
    for (j = 0; j < Icc->TagCount; j++) {
        if (Icc->TagOffsets[j] == offset && Icc->TagSizes[j] == size) {
            Icc->TagLinked[Icc->TagCount] = Icc->TagNames[j];
            break;
        }
    }

    // Valid tag, increment count
    Icc->TagCount++;
}

return TRUE;