for (i = 0; i < TagCount; i++) {
        if (!_cmsReadUInt32Number(io, &TagEntry.Tag)) return FALSE;
        if (!_cmsReadUInt32Number(io, &TagEntry.Offset)) return FALSE;
        if (!_cmsReadUInt32Number(io, &TagEntry.Size)) return FALSE;

        // Adjust endianness
        TagEntry.Tag = _cmsAdjustEndianess32(TagEntry.Tag);
        TagEntry.Offset = _cmsAdjustEndianess32(TagEntry.Offset);
        TagEntry.Size = _cmsAdjustEndianess32(TagEntry.Size);

        // Sanity check: ensure the tag is within the file bounds
        if (TagEntry.Offset + TagEntry.Size > HeaderSize) {
            cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Tag out of bounds");
            return FALSE;
        }

        // Record the tag entry
        Icc->TagNames[i] = TagEntry.Tag;
        Icc->TagOffsets[i] = TagEntry.Offset;
        Icc->TagSizes[i] = TagEntry.Size;

        // Check for linked tags
        for (j = 0; j < i; j++) {
            if (Icc->TagOffsets[j] == TagEntry.Offset && Icc->TagSizes[j] == TagEntry.Size) {
                Icc->TagLinked[i] = Icc->TagNames[j];
                break;
            }
        }

        Icc->TagCount++;
    }

    // Set links for tags that share the same offset and size
    if (!SetLinks(Icc)) {
        return FALSE;
    }

    return TRUE;