for (i = 0; i < TagCount; i++) {

        if (io -> Read(io, &TagEntry, sizeof(cmsTagEntry), 1) != 1) {
            return FALSE;
        }

        // Copy the tag entry to the profile structure
        Icc -> TagNames[Icc->TagCount] = _cmsAdjustEndianess32(TagEntry.sig);
        Icc -> TagOffsets[Icc->TagCount] = _cmsAdjustEndianess32(TagEntry.offset);
        Icc -> TagSizes[Icc->TagCount] = _cmsAdjustEndianess32(TagEntry.size);

        // Basic sanity checks
        if (Icc -> TagOffsets[Icc->TagCount] + Icc -> TagSizes[Icc->TagCount] > HeaderSize ||
            Icc -> TagSizes[Icc->TagCount] == 0) {

            // If the tag is invalid, log an error and skip it.
            char String[5];
            _cmsTagSignature2String(String, Icc -> TagNames[Icc->TagCount]);
            cmsSignalError(Icc ->ContextID, cmsERROR_BAD_TAG, "Tag '%s' inconsistent. Bad offset/size", String);
            continue;
        }

        // Check for duplicated tags.
        for (j = 0; j < Icc->TagCount; j++) {
            if (Icc->TagOffsets[Icc->TagCount] == Icc->TagOffsets[j] &&
                Icc->TagSizes[Icc->TagCount] == Icc->TagSizes[j]) {

                // Mark as linked.
                Icc->TagLinked[Icc->TagCount] = Icc->TagNames[j];
                break;
            }
        }

        Icc->TagCount++;
        if (Icc->TagCount >= MAX_TABLE_TAG) {
            cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Too many tags (%d)", TagCount);
            return FALSE;
        }
    }

    SetLinks(Icc);
    return TRUE;