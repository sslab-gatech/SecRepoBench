for (i=0; i < TagCount; i++) {

        if (io -> Read(io, &TagEntry, sizeof(cmsTagEntry), 1) != 1) return FALSE;

        Icc ->TagSignatures[Icc ->TagCount] = (cmsTagSignature) _cmsAdjustEndianess32(TagEntry.sig);
        Icc ->TagOffsets[Icc ->TagCount]  = _cmsAdjustEndianess32(TagEntry.offset);
        Icc ->TagSizes[Icc ->TagCount]    = _cmsAdjustEndianess32(TagEntry.size);
        Icc ->TagLinked  [Icc ->TagCount] = (cmsTagSignature) 0;

        // Sanity check
        if (Icc ->TagOffsets[Icc ->TagCount] > HeaderSize) {
            cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Tag %x offset (%x) is beyond profile size (%x)",
                (unsigned int) Icc ->TagSignatures[Icc ->TagCount],
                (unsigned int) Icc ->TagOffsets[Icc ->TagCount],
                (unsigned int) HeaderSize);
            continue;
        }

        if ((Icc ->TagOffsets[Icc ->TagCount] + Icc ->TagSizes[Icc ->TagCount]) < Icc ->TagOffsets[Icc ->TagCount]) {
            cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Overflow in tag size calculation for tag %x", (unsigned int)Icc->TagSignatures[Icc->TagCount]);
            continue;
        }
        
        if ((Icc ->TagOffsets[Icc ->TagCount] + Icc ->TagSizes[Icc ->TagCount]) > HeaderSize) {

            cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Tag %x exceeds profile size (%x)",
                (unsigned int) Icc ->TagSignatures[Icc ->TagCount],
                (unsigned int) HeaderSize);
            continue;
        }

        // Check for links
        for (j=0; j < Icc -> TagCount; j++) {

            if ((Icc ->TagOffsets[Icc ->TagCount] == Icc ->TagOffsets[j]) &&
                (Icc ->TagSizes[Icc ->TagCount]   == Icc ->TagSizes[j])) {

                    Icc ->TagLinked[Icc ->TagCount] = Icc ->TagSignatures[j];
            }
        }

        Icc ->TagCount++;
    }

    SetLinks(Icc);
    return TRUE;