cmsBool CMSEXPORT cmsWriteTag(cmsHPROFILE hProfile, cmsTagSignature sig, const void* data)
{
    // ... (previous code)

    // Check if the tag is already in the profile
    int i = _cmsSearchTag(Icc, sig, FALSE);
    if (i >= 0) {
        // If the tag is already in the profile, delete the previous version
        _cmsDeleteTagByPos(Icc, i);
    }

    // ... (rest of the code)
}