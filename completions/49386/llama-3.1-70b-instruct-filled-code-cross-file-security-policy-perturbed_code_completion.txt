for (i = 0; i < TagCount; i++) {
    if (!_cmsReadTagEntry(io, &TagEntry)) return FALSE;

    // Validate tag offset and size
    if (TagEntry.offset + TagEntry.size > HeaderSize) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Tag offset or size exceeds profile size");
        return FALSE;
    }

    // Record tag signature, offset, and size
    Icc ->TagSignatures[i] = TagEntry.signature;
    Icc ->TagOffsets[i]    = TagEntry.offset;
    Icc ->TagSizes[i]      = TagEntry.size;

    // Search for linked tags
    Icc ->TagLinked[i] = (cmsTagSignature) 0;
    for (j = 0; j < i; j++) {
        if (Icc ->TagOffsets[j] == TagEntry.offset && Icc ->TagSizes[j] == TagEntry.size) {
            Icc ->TagLinked[i] = Icc ->TagSignatures[j];
            break;
        }
    }

    // Increment tag count
    Icc -> TagCount++;
}