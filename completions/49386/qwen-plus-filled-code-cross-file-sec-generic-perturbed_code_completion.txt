for (i = 0; i < TagCount; i++) {
    if (!_cmsReadTagEntry(io, &TagEntry)) return FALSE;

    cmsUInt32Number offset = _cmsAdjustEndianess32(TagEntry.offset);
    cmsUInt32Number size   = _cmsAdjustEndianess32(TagEntry.size);
    cmsTagSignature sig    = (cmsTagSignature) _cmsAdjustEndianess32(TagEntry.signature);

    // Basic sanity checks
    if (offset >= HeaderSize || size > HeaderSize - offset) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Tag out of bounds");
        return FALSE;
    }

    // Record the tag information
    Icc ->TagSignatures[Icc ->TagCount] = sig;
    Icc ->TagOffsets[Icc ->TagCount]    = offset;
    Icc ->TagSizes[Icc ->TagCount]      = size;

    // Check for linked tags
    if (sig == 0) {
        Icc ->TagLinked[Icc ->TagCount] = (cmsTagSignature) _cmsAdjustEndianess32(TagEntry.linkedSignature);
    } else {
        Icc ->TagLinked[Icc ->TagCount] = (cmsTagSignature) 0;
    }

    Icc ->TagCount++;
}

// Set links between tags
if (!SetLinks(Icc)) return FALSE;

return TRUE;