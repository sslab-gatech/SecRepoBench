for (i = 0; i < TagCount; i++) {

    if (!_cmsReadTagEntry(io, &TagEntry)) return FALSE;

    cmsTagSignature sig = _cmsAdjustEndianess32(TagEntry.sig);

    // Check for bounds
    cmsUInt32Number offset = _cmsAdjustEndianess32(TagEntry.offset);
    cmsUInt32Number size   = _cmsAdjustEndianess32(TagEntry.size);

    if (offset > HeaderSize) continue;
    if ((offset + size) > HeaderSize) continue;

    // Store the tag entry in the Icc structure
    Icc ->TagSignatures[Icc ->TagCount] = sig;
    Icc ->TagOffsets[Icc ->TagCount]    = offset;
    Icc ->TagSizes[Icc ->TagCount]      = size;
    Icc ->TagLinked[Icc ->TagCount]     = (cmsTagSignature) 0;

    // Increment the tag count
    Icc ->TagCount++;

    // Look for links between tags that share the same offset and size
    for (j = 0; j < Icc ->TagCount -1; j++) {
        if (Icc ->TagOffsets[j] == offset && Icc ->TagSizes[j] == size) {
            Icc ->TagLinked[Icc ->TagCount -1] = Icc ->TagSignatures[j];
            break;
        }
    }
}

// Set any links found between tags
if (!SetLinks(Icc)) return FALSE;

return TRUE;