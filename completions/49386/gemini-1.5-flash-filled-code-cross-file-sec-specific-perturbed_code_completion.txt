for (i = 0; i < TagCount; i++) {
        cmsUInt32Number size;
        cmsUInt32Number offset;

        if (!_cmsReadUInt32Number(io, &offset) ||
            !_cmsReadUInt32Number(io, &size)) {
            return FALSE;
        }

        if (offset + size > HeaderSize) {
            cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Tag offset out of range");
            return FALSE;
        }

        if (!_cmsReadTagSignature(io, &TagEntry.sig)) return FALSE;

        TagEntry.offset = offset;
        TagEntry.size = size;

        j = _cmsSearchTag(Icc, TagEntry.sig, TRUE);
        if (j >= 0) {
            // This tag already exists, so it's a linked tag.
            Icc->TagLinked[j] = TagEntry.sig;
        } else {
            // Add the new tag to the Icc structure.
            if (Icc->TagCount >= MAX_TABLE_TAG) {
                cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Too many tags");
                return FALSE;
            }
            Icc->TagSignatures[Icc->TagCount] = TagEntry.sig;
            Icc->TagOffsets[Icc->TagCount] = TagEntry.offset;
            Icc->TagSizes[Icc->TagCount] = TagEntry.size;
            Icc->TagLinked[Icc->TagCount] = 0; // Initialize linked tag to 0.
            Icc->TagCount++;
        }
    }

    // Set links between tags.
    if (!SetLinks(Icc)) return FALSE;

    return TRUE;