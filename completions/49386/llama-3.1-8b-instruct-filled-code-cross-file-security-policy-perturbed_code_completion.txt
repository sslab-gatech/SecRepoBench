// Loop through each tag entry in the profile's tag directory, reading the tag signature,
// offset, and size from the IO handler. Perform basic sanity checks to ensure the tag
// falls within the bounds of the file. If a tag passes the checks, record its signature,
// offset, and size in the Icc structure. Additionally, search for and record any links
// between tags that share the same offset and size, indicating they are linked. Finally,
// increment the tag count for each valid tag entry processed. Return TRUE if the tags are successfully read and processed.
for (i = 0; i < TagCount; i++) {
    if (!_cmsReadUInt32Number(io, &TagEntry.signature)) return FALSE;
    if (!_cmsReadUInt32Number(io, &TagEntry.offset)) return FALSE;
    if (!_cmsReadUInt32Number(io, &TagEntry.size)) return FALSE;

    if (TagEntry.size == 0 || TagEntry.offset + TagEntry.size > HeaderSize) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Invalid tag entry at offset %d", TagEntry.offset);
        return FALSE;
    }

    if (TagEntry.size > MAX_TABLE_TAG_SIZE) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Tag size too large (%d)", TagEntry.size);
        return FALSE;
    }

    if (TagEntry.offset + TagEntry.size > Icc ->IOhandler ->ReportedSize) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Tag offset out of bounds (%d)", TagEntry.offset);
        return FALSE;
    }

    if (TagEntry.offset % 4!= 0) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Tag offset not aligned (%d)", TagEntry.offset);
        return FALSE;
    }

    Icc ->TagEntries[Icc ->TagCount].signature = TagEntry.signature;
    Icc ->TagEntries[Icc ->TagCount].offset = TagEntry.offset;
    Icc ->TagEntries[Icc ->TagCount].size = TagEntry.size;

    if (Icc ->TagCount > 0) {
        cmsUInt32Number j;
        for (j = 0; j < Icc ->TagCount; j++) {
            if (Icc ->TagEntries[j].offset == TagEntry.offset && Icc ->TagEntries[j].size == TagEntry.size) {
                Icc ->TagLinked[Icc ->TagCount - 1] = Icc ->TagEntries[j].signature;
                break;
            }
        }
    }

    Icc ->TagCount++;
}

if (Icc ->TagCount == 0) {
    cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "No tags found in profile");
    return FALSE;
}

SetLinks(Icc);