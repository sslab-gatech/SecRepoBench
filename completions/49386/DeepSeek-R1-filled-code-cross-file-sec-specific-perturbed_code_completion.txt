for (i = 0; i < TagCount; i++) {

    if (io -> Read(io, &TagEntry, sizeof(cmsTagEntry), 1) != 1)
        return FALSE;

    TagEntry.sig    = _cmsAdjustEndianess32(TagEntry.sig);
    TagEntry.offset = _cmsAdjustEndianess32(TagEntry.offset);
    TagEntry.size   = _cmsAdjustEndianess32(TagEntry.size);

    if (TagEntry.offset > HeaderSize || TagEntry.size > HeaderSize - TagEntry.offset)
        continue;

    if (Icc -> TagCount >= MAX_TABLE_TAG)
        continue;

    Icc -> TagLinked[Icc -> TagCount] = 0;
    for (j = 0; j < Icc -> TagCount; j++) {
        if (Icc -> TagOffsets[j] == TagEntry.offset && Icc -> TagSizes[j] == TagEntry.size) {
            Icc -> TagLinked[Icc -> TagCount] = Icc -> TagNames[j];
            break;
        }
    }

    Icc -> TagNames[Icc -> TagCount]   = TagEntry.sig;
    Icc -> TagOffsets[Icc -> TagCount] = TagEntry.offset;
    Icc -> TagSizes[Icc -> TagCount]   = TagEntry.size;
    Icc -> TagCount++;
}

if (!SetLinks(Icc)) return FALSE;
return TRUE;