for (i = 0; i < TagCount; i++) {
        if (!_cmsReadUInt32Number(io, &TagEntry.Tag)) return FALSE;
        if (!_cmsReadUInt32Number(io, &TagEntry.Offset)) return FALSE;
        if (!_cmsReadUInt32Number(io, &TagEntry.Size)) return FALSE;

        // Adjust endianness
        TagEntry.Tag = _cmsAdjustEndianess32(TagEntry.Tag);
        TagEntry.Offset = _cmsAdjustEndianess32(TagEntry.Offset);
        TagEntry.Size = _cmsAdjustEndianess32(TagEntry.Size);

        // Sanity checks
        if (TagEntry.Offset + TagEntry.Size > HeaderSize) {
            cmsSignalError(Icc->ContextID, cmsERROR_CORRUPTION_DETECTED, 
                           "Tag %u out of bounds (Offset: %u, Size: %u)", 
                           TagEntry.Tag, TagEntry.Offset, TagEntry.Size);
            return FALSE;
        }

        // Store tag information
        Icc->TagNames[Icc->TagCount] = TagEntry.Tag;
        Icc->TagOffsets[Icc->TagCount] = TagEntry.Offset;
        Icc->TagSizes[Icc->TagCount] = TagEntry.Size;
        Icc->TagLinked[Icc->TagCount] = 0; // No links initially
        Icc->TagCount++;
    }

    // Set links between tags
    if (!SetLinks(Icc)) {
        cmsSignalError(Icc->ContextID, cmsERROR_CORRUPTION_DETECTED, "Error setting tag links");
        return FALSE;
    }

    return TRUE;