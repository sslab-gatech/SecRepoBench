for (i = 0; i < TagCount; i++) {
        if (io->Read(io, &TagEntry, sizeof(cmsTagEntry), 1) != 1) {
            return FALSE;
        }

        TagEntry.size = _cmsAdjustEndianess32(TagEntry.size);
        TagEntry.offset = _cmsAdjustEndianess32(TagEntry.offset);

        // Validate size and offset
        if (TagEntry.size == 0 || TagEntry.offset == 0 || TagEntry.size > HeaderSize) {
            continue; // Skip invalid entries
        }

        // Ensure we do not exceed the allocated size for tags
        if (Icc->TagCount < MAX_TABLE_TAG) {
            Icc->TagSignature[Icc->TagCount] = TagEntry.sig;
            Icc->TagOffsets[Icc->TagCount] = TagEntry.offset;
            Icc->TagSizes[Icc->TagCount] = TagEntry.size;
            Icc->TagCount++;
        } else {
            cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Too many tags (%d)", Icc->TagCount);
            return FALSE;
        }
    }