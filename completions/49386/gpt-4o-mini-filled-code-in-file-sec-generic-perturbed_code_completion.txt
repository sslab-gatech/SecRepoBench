for (i = 0; i < TagCount; i++) {
        cmsTagEntry TagEntry;

        // Read the tag entry
        if (!_cmsReadUInt32Number(io, &TagEntry.sig)) return FALSE;
        TagEntry.sig = _cmsAdjustEndianess32(TagEntry.sig);

        if (TagEntry.sig == 0) continue; // Skip empty entries

        if (!_cmsReadUInt32Number(io, &TagEntry.offset)) return FALSE;
        TagEntry.offset = _cmsAdjustEndianess32(TagEntry.offset);

        if (!_cmsReadUInt32Number(io, &TagEntry.size)) return FALSE;
        TagEntry.size = _cmsAdjustEndianess32(TagEntry.size);

        // Validate tag size
        if (TagEntry.size > Icc->IOhandler->ReportedSize - TagEntry.offset) {
            cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Invalid tag size for tag %x", TagEntry.sig);
            return FALSE;
        }

        // Store the tag information
        Icc->TagNames[Icc->TagCount] = TagEntry.sig;
        Icc->TagOffsets[Icc->TagCount] = TagEntry.offset;
        Icc->TagSizes[Icc->TagCount] = TagEntry.size;
        Icc->TagCount++;
    }

    return TRUE;