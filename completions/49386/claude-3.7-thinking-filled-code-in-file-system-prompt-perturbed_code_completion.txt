for (i=0; i < TagCount; i++) {
    
    // Read the entry
    if (!io->Read(io, &TagEntry, sizeof(cmsTagEntry), 1)) {
        return FALSE;
    }
    
    // Adjust endianness
    TagEntry.sig    = (cmsTagSignature) _cmsAdjustEndianess32((cmsUInt32Number) TagEntry.sig);
    TagEntry.offset = _cmsAdjustEndianess32(TagEntry.offset);
    TagEntry.size   = _cmsAdjustEndianess32(TagEntry.size);
    
    // Perform sanity check - tag should be within profile bounds
    if (TagEntry.offset + TagEntry.size > HeaderSize ||
        TagEntry.offset + TagEntry.size < TagEntry.offset) {
        
        char String[5];
        
        _cmsTagSignature2String(String, TagEntry.sig);
        cmsSignalError(Icc->ContextID, cmsERROR_CORRUPTION_DETECTED, "Tag '%s' is outside profile bounds", String);
        continue;
    }
    
    // Check if the tag is already present
    j = _cmsSearchTag(Icc, TagEntry.sig, FALSE);
    if (j >= 0) {
        
        // Tag is already in profile, this should never happen
        char String[5];
        
        _cmsTagSignature2String(String, TagEntry.sig);
        cmsSignalError(Icc->ContextID, cmsERROR_CORRUPTION_DETECTED, "Duplicate tag '%s'", String);
        continue;
    }
    
    // Check for a possible linked tag
    for (j=0; j < Icc->TagCount; j++) {
        
        if (Icc->TagOffsets[j] == TagEntry.offset && 
            Icc->TagSizes[j] == TagEntry.size) {
            
            // Found! This tag is linked to a previous one
            Icc->TagLinked[Icc->TagCount] = Icc->TagNames[j];
            break;
        }
    }
    
    // Save the entry
    Icc->TagNames[Icc->TagCount]   = TagEntry.sig;
    Icc->TagOffsets[Icc->TagCount] = TagEntry.offset;
    Icc->TagSizes[Icc->TagCount]   = TagEntry.size;
    
    // This is not raw data, so we set it to NULL to indicate it has not been read yet
    Icc->TagPtrs[Icc->TagCount] = NULL;
    Icc->TagSaveAsRaw[Icc->TagCount] = FALSE;
    
    // If it is not a linked tag, set the field to 0
    if (j >= Icc->TagCount)
        Icc->TagLinked[Icc->TagCount] = (cmsTagSignature) 0;
    
    // Increment the tag count
    Icc->TagCount++;
}

return TRUE;