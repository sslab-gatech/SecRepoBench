for (i=0; i < TagCount; i++) {
        if (!_cmsReadTagEntry(io, &TagEntry)) return FALSE;
        if (TagEntry.signature == cmsSigLink) {
            if (TagEntry.offset >= HeaderSize) {
                cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Link tag out of bounds");
                return FALSE;
            }
            if (TagEntry.size >= HeaderSize) {
                cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Link tag size out of bounds");
                return FALSE;
            }
            if (Icc ->TagLinked[i] != (cmsTagSignature) 0) {
                cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Link tag already set");
                return FALSE;
            }
            Icc ->TagLinked[i] = TagEntry.signature;
            Icc ->TagOffsets[i] = TagEntry.offset;
            Icc ->TagSizes[i]   = TagEntry.size;
        } else {
            if (TagEntry.offset >= HeaderSize) {
                cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Tag out of bounds");
                return FALSE;
            }
            if (TagEntry.size >= HeaderSize) {
                cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Tag size out of bounds");
                return FALSE;
            }
            if (_cmsSearchTag(Icc, TagEntry.signature, FALSE) >= 0) {
                cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Tag already set");
                return FALSE;
            }
            Icc ->TagSignatures[i] = TagEntry.signature;
            Icc ->TagOffsets[i] = TagEntry.offset;
            Icc ->TagSizes[i]   = TagEntry.size;
        }
        Icc ->TagCount++;
    }
    return SetLinks(Icc);