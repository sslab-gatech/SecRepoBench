for (i = 0; i < TagCount; i++) {

        if (!io->Read(io, &TagEntry, sizeof(cmsTagEntry), 1)) return FALSE;

        Icc->TagNames[i]   = (cmsTagSignature) _cmsAdjustEndianess32(TagEntry.sig);
        Icc->TagOffsets[i] = _cmsAdjustEndianess32(TagEntry.offset);
        Icc->TagSizes[i]   = _cmsAdjustEndianess32(TagEntry.size);
        Icc->TagPtrs[i]    = NULL;            // No data yet
        Icc->TagTypeHandlers[i] = NULL;
        Icc->TagSaveAsRaw[i] = FALSE;

        // Basic sanity check
        if (Icc->TagOffsets[i] >= HeaderSize ||
            Icc->TagSizes[i] > HeaderSize ||
            (Icc->TagOffsets[i] + Icc->TagSizes[i]) > HeaderSize ||
            Icc->TagSizes[i] < 4) {

            char String[5];
            _cmsTagSignature2String(String, Icc->TagNames[i]);
            cmsSignalError(Icc->ContextID, cmsERROR_BAD_TAG, "Tag '%s' inconsistent. Offset=%x, Size=%x, HeaderSize=%x",
                String, Icc->TagOffsets[i], Icc->TagSizes[i], HeaderSize);

            return FALSE;
        }

        // Check for links
        for (j = 0; j < i; j++) {

            if (Icc->TagOffsets[i] == Icc->TagOffsets[j] &&
                Icc->TagSizes[i] == Icc->TagSizes[j]) {

                Icc->TagLinked[i] = Icc->TagNames[j];
            }
        }

        Icc->TagCount++;
    }

    return TRUE;