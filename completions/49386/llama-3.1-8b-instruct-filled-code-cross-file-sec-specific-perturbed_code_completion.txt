// Read tag directory
Icc -> TagCount = 0;
for (i = 0; i < TagCount; i++) {
    cmsUInt32Number TagSize;
    cmsUInt32Number TagOffset;
    cmsTagSignature TagSignature;
    cmsUInt32Number TagType;
    cmsUInt32Number TagNumber;
    cmsUInt32Number TagDataSize;
    cmsUInt32Number TagDataOffset;
    cmsUInt32Number TagLinked;
    cmsUInt32Number TagLinkedOffset;
    cmsUInt32Number TagLinkedSize;
    cmsUInt32Number TagLinkedCount;
    cmsUInt32Number TagLinkedOffsetCount;
    cmsUInt32Number TagLinkedSizeCount;
    cmsUInt32Number TagLinkedOffsetCount2;
    cmsUInt32Number TagLinkedSizeCount2;
    cmsUInt32Number TagLinkedOffsetCount3;
    cmsUInt32Number TagLinkedSizeCount3;
    cmsUInt32Number TagLinkedOffsetCount4;
    cmsUInt32Number TagLinkedSizeCount4;
    cmsUInt32Number TagLinkedOffsetCount5;
    cmsUInt32Number TagLinkedSizeCount5;
    cmsUInt32Number TagLinkedOffsetCount6;
    cmsUInt32Number TagLinkedSizeCount6;
    cmsUInt32Number TagLinkedOffsetCount7;
    cmsUInt32Number TagLinkedSizeCount7;
    cmsUInt32Number TagLinkedOffsetCount8;
    cmsUInt32Number TagLinkedSizeCount8;
    cmsUInt32Number TagLinkedOffsetCount9;
    cmsUInt32Number TagLinkedSizeCount9;
    cmsUInt32Number TagLinkedOffsetCount10;
    cmsUInt32Number TagLinkedSizeCount10;
    cmsUInt32Number TagLinkedOffsetCount11;
    cmsUInt32Number TagLinkedSizeCount11;
    cmsUInt32Number TagLinkedOffsetCount12;
    cmsUInt32Number TagLinkedSizeCount12;
    cmsUInt32Number TagLinkedOffsetCount13;
    cmsUInt32Number TagLinkedSizeCount13;
    cmsUInt32Number TagLinkedOffsetCount14;
    cmsUInt32Number TagLinkedSizeCount14;
    cmsUInt32Number TagLinkedOffsetCount15;
    cmsUInt32Number TagLinkedSizeCount15;
    cmsUInt32Number TagLinkedOffsetCount16;
    cmsUInt32Number TagLinkedSizeCount16;
    cmsUInt32Number TagLinkedOffsetCount17;
    cmsUInt32Number TagLinkedSizeCount17;
    cmsUInt32Number TagLinkedOffsetCount18;
    cmsUInt32Number TagLinkedSizeCount18;
    cmsUInt32Number TagLinkedOffsetCount19;
    cmsUInt32Number TagLinkedSizeCount19;
    cmsUInt32Number TagLinkedOffsetCount20;
    cmsUInt32Number TagLinkedSizeCount20;
    cmsUInt32Number TagLinkedOffsetCount21;
    cmsUInt32Number TagLinkedSizeCount21;
    cmsUInt32Number TagLinkedOffsetCount22;
    cmsUInt32Number TagLinkedSizeCount22;
    cmsUInt32Number TagLinkedOffsetCount23;
    cmsUInt32Number TagLinkedSizeCount23;
    cmsUInt32Number TagLinkedOffsetCount24;
    cmsUInt32Number TagLinkedSizeCount24;
    cmsUInt32Number TagLinkedOffsetCount25;
    cmsUInt32Number TagLinkedSizeCount25;
    cmsUInt32Number TagLinkedOffsetCount26;
    cmsUInt32Number TagLinkedSizeCount26;
    cmsUInt32Number TagLinkedOffsetCount27;
    cmsUInt32Number TagLinkedSizeCount27;
    cmsUInt32Number TagLinkedOffsetCount28;
    cmsUInt32Number TagLinkedSizeCount28;
    cmsUInt32Number TagLinkedOffsetCount29;
    cmsUInt32Number TagLinkedSizeCount29;
    cmsUInt32Number TagLinkedOffsetCount30;
    cmsUInt32Number TagLinkedSizeCount30;
    cmsUInt32Number TagLinkedOffsetCount31;
    cmsUInt32Number TagLinkedSizeCount31;
    cmsUInt32Number TagLinkedOffsetCount32;
    cmsUInt32Number TagLinkedSizeCount32;
    cmsUInt32Number TagLinkedOffsetCount33;
    cmsUInt32Number TagLinkedSizeCount33;
    cmsUInt32Number TagLinkedOffsetCount34;
    cmsUInt32Number TagLinkedSizeCount34;
    cmsUInt32Number TagLinkedOffsetCount35;
    cmsUInt32Number TagLinkedSizeCount35;
    cmsUInt32Number TagLinkedOffsetCount36;
    cmsUInt32Number TagLinkedSizeCount36;
    cmsUInt32Number TagLinkedOffsetCount37;
    cmsUInt32Number TagLinkedSizeCount37;
    cmsUInt32Number TagLinkedOffsetCount38;
    cmsUInt32Number TagLinkedSizeCount38;
    cmsUInt32Number TagLinkedOffsetCount39;
    cmsUInt32Number TagLinkedSizeCount39;
    cmsUInt32Number TagLinkedOffsetCount40;
    cmsUInt32Number TagLinkedSizeCount40;
    cmsUInt32Number TagLinkedOffsetCount41;
    cmsUInt32Number TagLinkedSizeCount41;
    cmsUInt32Number TagLinkedOffsetCount42;
    cmsUInt32Number TagLinkedSizeCount42;
    cmsUInt32Number TagLinkedOffsetCount43;
    cmsUInt32Number TagLinkedSizeCount43;
    cmsUInt32Number TagLinkedOffsetCount44;
    cmsUInt32Number TagLinkedSizeCount44;
    cmsUInt32Number TagLinkedOffsetCount45;
    cmsUInt32Number TagLinkedSizeCount45;
    cmsUInt32Number TagLinkedOffsetCount46;
    cmsUInt32Number TagLinkedSizeCount46;
    cmsUInt32Number TagLinkedOffsetCount47;
    cmsUInt32Number TagLinkedSizeCount47;
    cmsUInt32Number TagLinkedOffsetCount48;
    cmsUInt32Number TagLinkedSizeCount48;
    cmsUInt32Number TagLinkedOffsetCount49;
    cmsUInt32Number TagLinkedSizeCount49;
    cmsUInt32Number TagLinkedOffsetCount50;
    cmsUInt32Number TagLinkedSizeCount50;
    cmsUInt32Number TagLinkedOffsetCount51;
    cmsUInt32Number TagLinkedSizeCount51;
    cmsUInt32Number TagLinkedOffsetCount52;
    cmsUInt32Number TagLinkedSizeCount52;
    cmsUInt32Number TagLinkedOffsetCount53;
    cmsUInt32Number TagLinkedSizeCount53;
    cmsUInt32Number TagLinkedOffsetCount54;
    cmsUInt32Number TagLinkedSizeCount54;
    cmsUInt32Number TagLinkedOffsetCount55;
    cmsUInt32Number TagLinkedSizeCount55;
    cmsUInt32Number TagLinkedOffsetCount56;
    cmsUInt32Number TagLinkedSizeCount56;
    cmsUInt32Number TagLinkedOffsetCount57;
    cmsUInt32Number TagLinkedSizeCount57;
    cmsUInt32Number TagLinkedOffsetCount58;
    cmsUInt32Number TagLinkedSizeCount58;
    cmsUInt32Number TagLinkedOffsetCount59;
    cmsUInt32Number TagLinkedSizeCount59;
    cmsUInt32Number TagLinkedOffsetCount60;
    cmsUInt32Number TagLinkedSizeCount60;
    cmsUInt32Number TagLinkedOffsetCount61;
    cmsUInt32Number TagLinkedSizeCount61;
    cmsUInt32Number TagLinkedOffsetCount62;
    cmsUInt32Number TagLinkedSizeCount62;
    cmsUInt32Number TagLinkedOffsetCount63;
    cmsUInt32Number TagLinkedSizeCount63;
    cmsUInt32Number TagLinkedOffsetCount64;
    cmsUInt32Number TagLinkedSizeCount64;
    cmsUInt32Number TagLinkedOffsetCount65;
    cmsUInt32Number TagLinkedSizeCount65;
    cmsUInt32Number TagLinkedOffsetCount66;
    cmsUInt32Number TagLinkedSizeCount66;
    cmsUInt32Number TagLinkedOffsetCount67;
    cmsUInt32Number TagLinkedSizeCount67;
    cmsUInt32Number TagLinkedOffsetCount68;
    cmsUInt32Number TagLinkedSizeCount68;
    cmsUInt32Number TagLinkedOffsetCount69;
    cmsUInt32Number TagLinkedSizeCount69;
    cmsUInt32Number TagLinkedOffsetCount70;
    cmsUInt32Number TagLinkedSizeCount70;
    cmsUInt32Number TagLinkedOffsetCount71;
    cmsUInt32Number TagLinkedSizeCount71;
    cmsUInt32Number TagLinkedOffsetCount72;
    cmsUInt32Number TagLinkedSizeCount72;
    cmsUInt32Number TagLinkedOffsetCount73;
    cmsUInt32Number TagLinkedSizeCount73;
    cmsUInt32Number TagLinkedOffsetCount74;
    cmsUInt32Number TagLinkedSizeCount74;
    cmsUInt32Number TagLinkedOffsetCount75;
    cmsUInt32Number TagLinkedSizeCount75;
    cmsUInt32Number TagLinkedOffsetCount76;
    cmsUInt32Number TagLinkedSizeCount76;
    cmsUInt32Number TagLinkedOffsetCount77;
    cmsUInt32Number TagLinkedSizeCount77;
    cmsUInt32Number TagLinkedOffsetCount78;
    cmsUInt32Number TagLinkedSizeCount78;
    cmsUInt32Number TagLinkedOffsetCount79;
    cmsUInt32Number TagLinkedSizeCount79;
    cmsUInt32Number TagLinkedOffsetCount80;
    cmsUInt32Number TagLinkedSizeCount80;
    cmsUInt32Number TagLinkedOffsetCount81;
    cmsUInt32Number TagLinkedSizeCount81;
    cmsUInt32Number TagLinkedOffsetCount82;
    cmsUInt32Number TagLinkedSizeCount82;
    cmsUInt32Number TagLinkedOffsetCount83;
    cmsUInt32Number TagLinkedSizeCount83;
    cmsUInt32Number TagLinkedOffsetCount84;
    cmsUInt32Number TagLinkedSizeCount84;
    cmsUInt32Number TagLinkedOffsetCount85;
    cmsUInt32Number TagLinkedSizeCount85;
    cmsUInt32Number TagLinkedOffsetCount86;
    cmsUInt32Number TagLinkedSizeCount86;
    cmsUInt32Number TagLinkedOffsetCount87;
    cmsUInt32Number TagLinkedSizeCount87;
    cmsUInt32Number TagLinkedOffsetCount88;
    cmsUInt32Number TagLinkedSizeCount88;
    cmsUInt32Number TagLinkedOffsetCount89;
    cmsUInt32Number TagLinkedSizeCount89;
    cmsUInt32Number TagLinkedOffsetCount90;
    cmsUInt32Number TagLinkedSizeCount90;
    cmsUInt32Number TagLinkedOffsetCount91;
    cmsUInt32Number TagLinkedSizeCount91;
    cmsUInt32Number TagLinkedOffsetCount92;
    cmsUInt32Number TagLinkedSizeCount92;
    cmsUInt32Number TagLinkedOffsetCount93;
    cmsUInt32Number TagLinkedSizeCount93;
    cmsUInt32Number TagLinkedOffsetCount94;
    cmsUInt32Number TagLinkedSizeCount94;
    cmsUInt32Number TagLinkedOffsetCount95;
    cmsUInt32Number TagLinkedSizeCount95;
    cmsUInt32Number TagLinkedOffsetCount96;
    cmsUInt32Number TagLinkedSizeCount96;
    cmsUInt32Number TagLinkedOffsetCount97;
    cmsUInt32Number TagLinkedSizeCount97;
    cmsUInt32Number TagLinkedOffsetCount98;
    cmsUInt32Number TagLinkedSizeCount98;
    cmsUInt32Number TagLinkedOffsetCount99;
    cmsUInt32Number TagLinkedSizeCount99;
    cmsUInt32Number TagLinkedOffsetCount100;
    cmsUInt32Number TagLinkedSizeCount100;
    cmsUInt32Number TagLinkedOffsetCount101;
    cmsUInt32Number TagLinkedSizeCount101;
    cmsUInt32Number TagLinkedOffsetCount102;
    cmsUInt32Number TagLinkedSizeCount102;
    cmsUInt32Number TagLinkedOffsetCount103;
    cmsUInt32Number TagLinkedSizeCount103;
    cmsUInt32Number TagLinkedOffsetCount104;
    cmsUInt32Number TagLinkedSizeCount104;
    cmsUInt32Number TagLinkedOffsetCount105;
    cmsUInt32Number TagLinkedSizeCount105;
    cmsUInt32Number TagLinkedOffsetCount106;
    cmsUInt32Number TagLinkedSizeCount106;
    cmsUInt32Number TagLinkedOffsetCount107;
    cmsUInt32Number TagLinkedSizeCount107;
    cmsUInt32Number TagLinkedOffsetCount108;
    cmsUInt32Number TagLinkedSizeCount108;
    cmsUInt32Number TagLinkedOffsetCount109;
    cmsUInt32Number TagLinkedSizeCount109;
    cmsUInt32Number TagLinkedOffsetCount110;
    cmsUInt32Number TagLinkedSizeCount110;
    cmsUInt32Number TagLinkedOffsetCount111;
    cmsUInt32Number TagLinkedSizeCount111;
    cmsUInt32Number TagLinkedOffsetCount112;
    cmsUInt32Number TagLinkedSizeCount112;
    cmsUInt32Number TagLinkedOffsetCount113;
    cmsUInt32Number TagLinkedSizeCount113;
    cmsUInt32Number TagLinkedOffsetCount114;
    cmsUInt32Number TagLinkedSizeCount114;
    cmsUInt32Number TagLinkedOffsetCount115;
    cmsUInt32Number TagLinkedSizeCount115;
    cmsUInt32Number TagLinkedOffsetCount116;
    cmsUInt32Number TagLinkedSizeCount116;
    cmsUInt32Number TagLinkedOffsetCount117;
    cmsUInt32Number TagLinkedSizeCount117;
    cmsUInt32Number TagLinkedOffsetCount118;
    cmsUInt32Number TagLinkedSizeCount118;
    cmsUInt32Number TagLinkedOffsetCount119;
    cmsUInt32Number TagLinkedSizeCount119;
    cmsUInt32Number TagLinkedOffsetCount120;
    cmsUInt32Number TagLinkedSizeCount120;
    cmsUInt32Number TagLinkedOffsetCount121;
    cmsUInt32Number TagLinkedSizeCount121;
    cmsUInt32Number TagLinkedOffsetCount122;
    cmsUInt32Number TagLinkedSizeCount122;
    cmsUInt32Number TagLinkedOffsetCount123;
    cmsUInt32Number TagLinkedSizeCount123;
    cmsUInt32Number TagLinkedOffsetCount124;
    cmsUInt32Number TagLinkedSizeCount124;
    cmsUInt32Number TagLinkedOffsetCount125;
    cmsUInt32Number TagLinkedSizeCount125;
    cmsUInt32Number TagLinkedOffsetCount126;
    cmsUInt32Number TagLinkedSizeCount126;
    cmsUInt32Number TagLinkedOffsetCount127;
    cmsUInt32Number TagLinkedSizeCount127;
    cmsUInt32Number TagLinkedOffsetCount128;
    cmsUInt32Number TagLinkedSizeCount128;
    cmsUInt32Number TagLinkedOffsetCount129;
    cmsUInt32Number TagLinkedSizeCount129;
    cmsUInt32Number TagLinkedOffsetCount130;
    cmsUInt32Number TagLinkedSizeCount130;
    cmsUInt32Number TagLinkedOffsetCount131;
    cmsUInt32Number TagLinkedSizeCount131;
    cmsUInt32Number TagLinkedOffsetCount132;
    cmsUInt32Number TagLinkedSizeCount132;
    cmsUInt32Number TagLinkedOffsetCount133;
    cmsUInt32Number TagLinkedSizeCount133;
    cmsUInt32Number TagLinkedOffsetCount134;
    cmsUInt32Number TagLinkedSizeCount134;
    cm