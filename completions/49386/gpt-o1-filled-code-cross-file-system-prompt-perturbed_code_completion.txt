for (i = 0; i < TagCount; i++) {

        cmsUInt32Number Sig, Off, Sz;
        
        // Read tag signature, offset and size
        if (!_cmsReadUInt32Number(io, &Sig) ||
            !_cmsReadUInt32Number(io, &Off) ||
            !_cmsReadUInt32Number(io, &Sz))
        {
            return FALSE;
        }

        // Check boundaries against file size and header size
        if (Off + Sz > Icc->IOhandler->ReportedSize || Off + Sz > HeaderSize) {
            // Skip invalid entries
            continue;
        }

        // Store the tag entry
        Icc->TagNames[Icc->TagCount]   = (cmsTagSignature) Sig;
        Icc->TagOffsets[Icc->TagCount] = Off;
        Icc->TagSizes[Icc->TagCount]   = Sz;
        Icc->TagLinked[Icc->TagCount]  = 0;  // No link by default

        // Look for links
        for (j = 0; j < Icc->TagCount; j++) {
            if (Icc->TagOffsets[j] == Off && Icc->TagSizes[j] == Sz) {
                // Found a matching offset/size, link them
                Icc->TagLinked[Icc->TagCount] = Icc->TagNames[j];
                break;
            }
        }

        Icc->TagCount++;
    }

    return TRUE;