for (i = 0; i < TagCount; i++) {
        cmsTagSignature sig;
        cmsUInt32Number offset, size;

        if (!_cmsReadUInt32Number(io, &sig) ||
            !_cmsReadUInt32Number(io, &offset) ||
            !_cmsReadUInt32Number(io, &size)) {
            return FALSE;
        }

        // Check if the tag is within the bounds of the file
        if (offset + size > HeaderSize) {
            cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Tag offset out of bounds");
            return FALSE;
        }

        // Record the tag information
        Icc->TagSignatures[Icc->TagCount] = sig;
        Icc->TagOffsets[Icc->TagCount] = offset;
        Icc->TagSizes[Icc->TagCount] = size;
        Icc->TagLinked[Icc->TagCount] = 0; // Initialize linked tag to 0
        Icc->TagCount++;
    }

    // Set links between tags
    if (!SetLinks(Icc)) return FALSE;

    return TRUE;