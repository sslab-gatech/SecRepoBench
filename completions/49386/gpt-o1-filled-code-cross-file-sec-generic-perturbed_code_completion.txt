for (i = 0; i < TagCount; i++) {

        cmsUInt32Number sig, off, sz;

        // Read tag signature, offset, and size
        if (!_cmsReadUInt32Number(io, &sig)) return FALSE;
        if (!_cmsReadUInt32Number(io, &off)) return FALSE;
        if (!_cmsReadUInt32Number(io, &sz)) return FALSE;

        // Basic sanity checks to ensure the tag is within the file bounds
        if (off > HeaderSize || sz > HeaderSize || off > (HeaderSize - sz)) {
            cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Tag %u out of range", sig);
            return FALSE;
        }

        // Store the tag information
        Icc->TagSignature[Icc->TagCount] = sig;
        Icc->TagOffsets[Icc->TagCount]   = off;
        Icc->TagSizes[Icc->TagCount]     = sz;
        Icc->TagLinked[Icc->TagCount]    = 0;

        // Search for any existing tag with the same offset and size to link them
        for (j = 0; j < Icc->TagCount; j++) {
            if (Icc->TagOffsets[j] == off && Icc->TagSizes[j] == sz) {
                Icc->TagLinked[Icc->TagCount] = Icc->TagSignature[j];
                break;
            }
        }

        // Increment the count of valid tags
        Icc->TagCount++;
    }

    return TRUE;