for (i = 0; i < TagCount; i++) {
        // Read tag entry
        if (io->Read(io, &TagEntry, sizeof(cmsTagEntry), 1) != 1) {
            cmsSignalError(Icc->ContextID, cmsERROR_READ, "Cannot read tag entry");
            return FALSE;
        }

        // Adjust endianness of tag entry fields
        TagEntry.TagSignature = _cmsAdjustEndianess32(TagEntry.TagSignature);
        TagEntry.Offset = _cmsAdjustEndianess32(TagEntry.Offset);
        TagEntry.Size = _cmsAdjustEndianess32(TagEntry.Size);

        // Perform sanity checks on the tag entry
        if (TagEntry.Offset + TagEntry.Size > HeaderSize || TagEntry.Size == 0) {
            cmsSignalError(Icc->ContextID, cmsERROR_CORRUPTION_DETECTED, 
                           "Tag entry out of bounds or invalid size (TagSignature: %u)", TagEntry.TagSignature);
            return FALSE;
        }

        // Record tag entry in the Icc structure
        Icc->TagNames[Icc->TagCount] = TagEntry.TagSignature;
        Icc->TagOffsets[Icc->TagCount] = TagEntry.Offset;
        Icc->TagSizes[Icc->TagCount] = TagEntry.Size;

        // Check for linked tags
        Icc->TagLinked[Icc->TagCount] = 0; // Initialize as not linked
        for (j = 0; j < Icc->TagCount; j++) {
            if (Icc->TagOffsets[j] == TagEntry.Offset && Icc->TagSizes[j] == TagEntry.Size) {
                Icc->TagLinked[Icc->TagCount] = Icc->TagNames[j];
                break;
            }
        }

        // Increment the tag count
        Icc->TagCount++;
    }

    // Set up links between tags
    if (!SetLinks(Icc)) {
        cmsSignalError(Icc->ContextID, cmsERROR_CORRUPTION_DETECTED, "Error setting tag links");
        return FALSE;
    }

    return TRUE;