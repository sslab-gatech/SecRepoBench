for (i = 0; i < TagCount; i++) {

        if (!_cmsReadUInt32Number(io, &TagEntry.sig)) return FALSE;
        if (!_cmsReadUInt32Number(io, &TagEntry.offset)) return FALSE;
        if (!_cmsReadUInt32Number(io, &TagEntry.size)) return FALSE;

        // Basic sanity checks
        if (TagEntry.offset > HeaderSize || TagEntry.size > HeaderSize ||
            TagEntry.offset + TagEntry.size > HeaderSize) {
            cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Tag %d: Bad offset or size", i);
            continue;
        }

        // Store tag info
        Icc ->TagNames[Icc ->TagCount] = (cmsTagSignature) _cmsAdjustEndianess32(TagEntry.sig);
        Icc ->TagOffsets[Icc ->TagCount] = _cmsAdjustEndianess32(TagEntry.offset);
        Icc ->TagSizes[Icc ->TagCount] = _cmsAdjustEndianess32(TagEntry.size);
        Icc ->TagLinked[Icc ->TagCount] = (cmsTagSignature) 0;

        // Check for linked tags
        for (j = 0; j < Icc ->TagCount; j++) {
            if (Icc ->TagOffsets[j] == Icc ->TagOffsets[Icc ->TagCount] &&
                Icc ->TagSizes[j] == Icc ->TagSizes[Icc ->TagCount]) {
                Icc ->TagLinked[Icc ->TagCount] = Icc ->TagNames[j];
                break;
            }
        }

        Icc ->TagCount++;
    }

    if (!SetLinks(Icc)) return FALSE;
    return TRUE;