for (i=0; i < Icc -> TagCount; i++) {

    if (Icc ->TagNames[i] == (cmsTagSignature) 0) continue;   // It is just a placeholder

    // Read the tag entry
    if (io -> Read(io, &TagEntry, sizeof(cmsTagEntry), 1)!= 1) {
        return FALSE;
    }

    // Adjust endianness
    Icc -> TagNames[i] = (cmsTagSignature) _cmsAdjustEndianess32((cmsUInt32Number) TagEntry.sig);
    Icc -> TagOffsets[i] = _cmsAdjustEndianess32(TagEntry.offset);
    Icc -> TagSizes[i] = _cmsAdjustEndianess32(TagEntry.size);

    // Check for valid tag
    if (Icc -> TagSizes[i] < 8) {
        cmsSignalError(Icc ->ContextID, cmsERROR_CORRUPTION_DETECTED, "Corrupted tag directory");
        return FALSE;
    }

    // Check for valid offset
    if (Icc -> TagOffsets[i] + Icc -> TagSizes[i] > HeaderSize) {
        cmsSignalError(Icc ->ContextID, cmsERROR_CORRUPTION_DETECTED, "Corrupted tag directory");
        return FALSE;
    }

    // Check for linked tags
    Icc -> TagLinked[i] = (cmsTagSignature) 0;
    if (i > 0) {
        if (Icc -> TagOffsets[i] == Icc -> TagOffsets[i-1] && Icc -> TagSizes[i] == Icc -> TagSizes[i-1]) {
            Icc -> TagLinked[i] = Icc -> TagNames[i-1];
        }
    }
}