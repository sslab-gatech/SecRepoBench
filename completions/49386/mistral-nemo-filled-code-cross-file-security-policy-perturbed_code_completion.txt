for (i = 0; i < TagCount; i++) {
    if (!_cmsReadTagEntry(io, &TagEntry)) return FALSE;
    if (TagEntry.size == 0 || TagEntry.offset == 0) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Invalid tag size or offset");
        return FALSE;
    }
    if (TagEntry.offset >= HeaderSize) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Tag offset out of bounds");
        return FALSE;
    }
    if (TagEntry.offset + TagEntry.size > HeaderSize) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Tag size out of bounds");
        return FALSE;
    }
    if (Icc -> TagCount >= MAX_TABLE_TAG) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Too many tags");
        return FALSE;
    }
    Icc ->TagSignatures[Icc -> TagCount] = TagEntry.signature;
    Icc ->TagOffsets[Icc -> TagCount] = TagEntry.offset;
    Icc ->TagSizes[Icc -> TagCount] = TagEntry.size;
    Icc ->TagLinked[Icc -> TagCount] = 0;
    Icc -> TagCount++;
}