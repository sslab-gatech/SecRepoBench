for (i = 0; i < TagCount; i++) {
        if (!_cmsReadUInt32Number(io, &TagEntry.sig) ||
            !_cmsReadUInt32Number(io, &TagEntry.offset) ||
            !_cmsReadUInt32Number(io, &TagEntry.size)) {
            return FALSE;
        }

        // Check for tag validity
        if (TagEntry.offset + TagEntry.size > HeaderSize || TagEntry.size == 0 || TagEntry.offset == 0) {
            continue;
        }

        Icc->Tag[Icc->TagCount].sig = TagEntry.sig;
        Icc->TagOffsets[Icc->TagCount] = TagEntry.offset;
        Icc->TagSizes[Icc->TagCount] = TagEntry.size;
        Icc->TagLinked[Icc->TagCount] = 0;
        Icc->TagCount++;
    }

    // Set links between tags
    if (!SetLinks(Icc)) return FALSE;

    return TRUE;