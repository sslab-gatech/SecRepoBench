for (i = 0; i < TagCount; i++) {
        cmsTagEntry* entry = &Icc->TagEntries[Icc->TagCount];

        // Read the tag signature, offset, and size
        if (!_cmsReadUInt32Number(io, &entry->sig) || 
            !_cmsReadUInt32Number(io, &entry->offset) || 
            !_cmsReadUInt32Number(io, &entry->size)) {
            return FALSE;
        }

        // Perform sanity checks
        if (entry->offset + entry->size > Icc->IOhandler->ReportedSize) {
            cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Tag offset/size out of bounds");
            return FALSE;
        }

        // Store the tag entry
        Icc->TagCount++;

        // Check for linked tags
        if (entry->sig == cmsLINKED_TAG) {
            Icc->TagLinked[Icc->TagCount - 1] = entry->sig;
        }
    }

    // Set links for the tags
    SetLinks(Icc);

    return TRUE;