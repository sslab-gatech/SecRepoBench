for (i = 0; i < TagCount; i++) {

        if (!io->Read(io, &TagEntry, sizeof(cmsTagEntry), 1)) return FALSE;

        TagEntry.sig    = _cmsAdjustEndianess32(TagEntry.sig);
        TagEntry.offset = _cmsAdjustEndianess32(TagEntry.offset);
        TagEntry.size   = _cmsAdjustEndianess32(TagEntry.size);

        // Basic sanity check
        if (TagEntry.offset + TagEntry.size > HeaderSize) {
            cmsSignalError(Icc->ContextID, cmsERROR_BAD_TAG, "Tag %d has invalid offset/size. Profile is corrupted.", i);
            return FALSE;
        }

        if (TagEntry.size <= 0) {
            cmsSignalError(Icc->ContextID, cmsERROR_BAD_TAG, "Tag %d has zero size. Profile is corrupted.", i);
            return FALSE;
        }

        Icc->TagNames[Icc->TagCount]   = TagEntry.sig;
        Icc->TagOffsets[Icc->TagCount] = TagEntry.offset;
        Icc->TagSizes[Icc->TagCount]   = TagEntry.size;
        Icc->TagPtrs[Icc->TagCount] = NULL; // No data yet
        Icc->TagTypeHandlers[Icc->TagCount] = NULL; // No handler yet
        Icc->TagSaveAsRaw[Icc->TagCount] = FALSE; // Not raw by default

        // Check for links
        for (j = 0; j < Icc->TagCount; j++) {

            if (Icc->TagOffsets[j] == TagEntry.offset &&
                Icc->TagSizes[j] == TagEntry.size) {

                Icc->TagLinked[Icc->TagCount] = Icc->TagNames[j];
                break; // Found a link
            }
            else
                Icc->TagLinked[Icc->TagCount] = (cmsTagSignature)0; // No link
        }

        Icc->TagCount++;
    }

    return TRUE;