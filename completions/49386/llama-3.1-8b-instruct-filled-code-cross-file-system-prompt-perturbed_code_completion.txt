// Loop through each tag entry in the profile's tag directory, reading the tag signature,
// offset, and size from the IO handler. Perform basic sanity checks to ensure the tag
// falls within the bounds of the file. If a tag passes the checks, record its signature,
// offset, and size in the Icc structure. Additionally, search for and record any links
// between tags that share the same offset and size, indicating they are linked. Finally,
// increment the tag count for each valid tag entry processed. Return TRUE if the tags are successfully read and processed.
for (i=0; i < TagCount; i++) {
    cmsUInt32Number Offset;
    cmsUInt32Number Size;
    cmsTagSignature Sig;
    cmsUInt32Number TagOffset;
    cmsUInt32Number TagSize;
    cmsUInt32Number j;

    if (!_cmsReadUInt32Number(io, &Offset)) return FALSE;
    if (!_cmsReadUInt32Number(io, &Size)) return FALSE;
    if (!_cmsReadUInt32Number(io, &Sig)) return FALSE;

    // Check if the tag falls within the bounds of the file
    if (Offset + Size > HeaderSize) {
        cmsSignalError(Icc ->ContextID, cmsERROR_RANGE, "Tag %d out of bounds", i);
        return FALSE;
    }

    // Check if the tag is already in the list
    j = _cmsSearchTag(Icc, Sig, FALSE);
    if (j >= 0) {
        // Tag already exists, increment its count
        Icc ->TagCounts[j]++;
    } else {
        // Tag does not exist, add it to the list
        Icc ->TagOffsets[Icc ->TagCount] = Offset;
        Icc ->TagSizes[Icc ->TagCount]   = Size;
        Icc ->TagSignatures[Icc ->TagCount] = Sig;
        Icc ->TagCounts[Icc ->TagCount] = 1;
        Icc ->TagLinked[Icc ->TagCount] = 0;
        Icc ->TagCount++;
    }

    // Check for linked tags
    if (Size == 0) {
        // Tag is a link, find the linked tag
        TagOffset = Offset;
        TagSize = Size;
        while (TagSize == 0) {
            if (!_cmsReadUInt32Number(io, &TagOffset)) return FALSE;
            if (!_cmsReadUInt32Number(io, &TagSize)) return FALSE;
            j = _cmsSearchTag(Icc, Sig, FALSE);
            if (j >= 0) {
                // Tag already exists, increment its count
                Icc ->TagCounts[j]++;
                break;
            } else {
                // Tag does not exist, add it to the list
                Icc ->TagOffsets[Icc ->TagCount] = TagOffset;
                Icc ->TagSizes[Icc ->TagCount]   = TagSize;
                Icc ->TagSignatures[Icc ->TagCount] = Sig;
                Icc ->TagCounts[Icc ->TagCount] = 1;
                Icc ->TagLinked[Icc ->TagCount] = Sig;
                Icc ->TagCount++;
            }
        }
    }
}
SetLinks(Icc);
return TRUE;