for (i = 0; i < TagCount; i++) {
    // Read tag entry: signature, offset, size
    if (!_cmsReadUInt32Number(io, &TagEntry.sig) ||
        !_cmsReadUInt32Number(io, &TagEntry.offset) ||
        !_cmsReadUInt32Number(io, &TagEntry.size)) {
        return FALSE;
    }

    // Sanity check: tag must be within file bounds
    if (TagEntry.offset + TagEntry.size > HeaderSize ||
        TagEntry.offset < sizeof(cmsICCHeader)) {
        cmsSignalError(Icc->ContextID, cmsERROR_RANGE, "Tag %d out of profile bounds", i);
        continue;
    }

    // Store tag info
    Icc->TagNames[Icc->TagCount]   = TagEntry.sig;
    Icc->TagOffsets[Icc->TagCount] = TagEntry.offset;
    Icc->TagSizes[Icc->TagCount]   = TagEntry.size;
    Icc->TagLinked[Icc->TagCount]  = 0;

    // Check for links: if another tag has same offset and size, mark as linked
    for (j = 0; j < Icc->TagCount; j++) {
        if (Icc->TagOffsets[j] == TagEntry.offset &&
            Icc->TagSizes[j] == TagEntry.size) {
            Icc->TagLinked[Icc->TagCount] = Icc->TagNames[j];
            break;
        }
    }

    Icc->TagCount++;
}

return TRUE;