// Read each entry in the tag directory and perform necessary validations
    for (i = 0; i < TagCount; i++) {

        if (!_cmsReadUInt32Number(io, &TagEntry.sig) ||
            !_cmsReadUInt32Number(io, &TagEntry.offset) ||
            !_cmsReadUInt32Number(io, &TagEntry.size))
        {
            cmsSignalError(Icc->ContextID, cmsERROR_READ, "Error reading tag directory");
            return FALSE;
        }

        // Adjust endianness
        TagEntry.sig    = _cmsAdjustEndianess32(TagEntry.sig);
        TagEntry.offset = _cmsAdjustEndianess32(TagEntry.offset);
        TagEntry.size   = _cmsAdjustEndianess32(TagEntry.size);

        // Check for plausible range
        if ((TagEntry.offset + TagEntry.size) > HeaderSize) {
            cmsSignalError(Icc->ContextID, cmsERROR_RANGE,
                           "Tag offset+size (%u + %u) extends beyond profile size %u",
                           TagEntry.offset, TagEntry.size, HeaderSize);
            return FALSE;
        }

        // Don't store invalid or empty signatures
        if (TagEntry.sig == 0) {
            continue;
        }

        // Store it in the profile structure
        Icc->TagNames[Icc->TagCount]   = (cmsTagSignature) TagEntry.sig;
        Icc->TagOffsets[Icc->TagCount] = TagEntry.offset;
        Icc->TagSizes[Icc->TagCount]   = TagEntry.size;
        Icc->TagPtrs[Icc->TagCount]    = NULL;
        Icc->TagTypeHandlers[Icc->TagCount] = NULL;
        Icc->TagSaveAsRaw[Icc->TagCount]    = FALSE;

        // By default, this tag is not linked
        Icc->TagLinked[Icc->TagCount] = (cmsTagSignature) 0;

        // Check if there is any previously read tag with same offset & size => link
        for (j = 0; j < Icc->TagCount; j++) {
            if (Icc->TagOffsets[j] == TagEntry.offset &&
                Icc->TagSizes[j]   == TagEntry.size)
            {
                // Found a duplicate => link
                Icc->TagLinked[Icc->TagCount] = Icc->TagNames[j];
                break;
            }
        }

        Icc->TagCount++;
    }

    // All tags have been successfully read
    return TRUE;