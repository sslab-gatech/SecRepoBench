for (i = 0; i < TagCount; i++) {
        if (!_cmsReadTagEntry(io, &TagEntry)) return FALSE;

        // Adjust endianness
        TagEntry.TagSignature = _cmsAdjustEndianess32(TagEntry.TagSignature);
        TagEntry.Offset = _cmsAdjustEndianess32(TagEntry.Offset);
        TagEntry.Size = _cmsAdjustEndianess32(TagEntry.Size);

        // Sanity check
        if (TagEntry.Offset + TagEntry.Size > HeaderSize) {
            cmsSignalError(Icc->ContextID, cmsERROR_CORRUPTION_DETECTED, "Tag %d is out of bounds", i);
            return FALSE;
        }

        // Store the tag
        Icc->TagNames[i] = TagEntry.TagSignature;
        Icc->TagOffsets[i] = TagEntry.Offset;
        Icc->TagSizes[i] = TagEntry.Size;
        Icc->TagLinked[i] = 0; // Initialize as not linked

        // Check for links
        for (j = 0; j < i; j++) {
            if (Icc->TagOffsets[j] == TagEntry.Offset && Icc->TagSizes[j] == TagEntry.Size) {
                Icc->TagLinked[i] = Icc->TagNames[j];
                break;
            }
        }

        Icc->TagCount++;
    }

    // Set links
    if (!SetLinks(Icc)) return FALSE;

    return TRUE;