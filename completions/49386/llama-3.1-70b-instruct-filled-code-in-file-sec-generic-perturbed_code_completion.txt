for (i=0; i < Icc -> TagCount; i++) {

    if (Icc ->TagNames[i] == (cmsTagSignature) 0) continue;   // It is just a placeholder

    // Read the tag signature
    if (!io -> Read(io, &TagEntry.sig, sizeof(cmsTagSignature), 1)) return FALSE;

    // Read the tag offset
    if (!_cmsReadUInt32Number(io, &TagEntry.offset)) return FALSE;

    // Read the tag size
    if (!_cmsReadUInt32Number(io, &TagEntry.size)) return FALSE;

    // Check for corrupted profiles
    if (TagEntry.offset + TagEntry.size > Icc ->IOhandler ->ReportedSize) {

        cmsSignalError(Icc ->ContextID, cmsERROR_CORRUPTION_DETECTED, "Corrupted profile");
        return FALSE;
    }

    // Keep track of the tag
    Icc -> TagNames[i] = TagEntry.sig;
    Icc -> TagOffsets[i] = TagEntry.offset;
    Icc -> TagSizes[i] = TagEntry.size;
    Icc -> TagPtrs[i] = NULL;
    Icc -> TagTypeHandlers[i] = NULL;
    Icc -> TagSaveAsRaw[i] = FALSE;
    Icc -> TagLinked[i] = (cmsTagSignature) 0;
}