if (!tlvDataBasePtr || !tlvDataLength)
				return TLVRecordType(nullptr);

			TLVRecordType firstRec;
			size_t curOffset = 0;

			while (curOffset < tlvDataLength)
			{
				TLVRecordType::TLVRecordHeader* curHeader = (TLVRecordType::TLVRecordHeader*)(tlvDataBasePtr + curOffset);
				uint8_t recordType = curHeader->getType();
				uint8_t recordLength = curHeader->getLength();

				if (recordLength + curOffset + sizeof(TLVRecordType::TLVRecordHeader) > tlvDataLength)
				{
					// we arrived to a TLV record that extends beyond the total TLV data length
					// probably a malformed packet. Return NULL TLV record
					return TLVRecordType(nullptr);
				}

				firstRec.assign(tlvDataBasePtr, curOffset, recordType, recordLength);
				return firstRec; // for NRVO optimization
			}

			// no TLV record found
			return TLVRecordType(nullptr);