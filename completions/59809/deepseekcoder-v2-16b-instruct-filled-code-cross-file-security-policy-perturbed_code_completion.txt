if (tlvDataBasePtr == nullptr || tlvDataLength == 0) {
    TLVRecordType nullRecord;
    nullRecord.assign(nullptr);
    return nullRecord;
}

uint8_t* recordPtr = tlvDataBasePtr;
size_t recordSize = 0;

// Read the record size and type from the first byte
if (tlvDataLength < sizeof(uint16_t)) {
    TLVRecordType nullRecord;
    nullRecord.assign(nullptr);
    return nullRecord;
}

recordSize = static_cast<size_t>(recordPtr[0]) << 8 | static_cast<size_t>(recordPtr[1]);
uint16_t recordType = static_cast<uint16_t>(recordPtr[2]) << 8 | static_cast<uint16_t>(recordPtr[3]);

if (tlvDataLength < recordSize) {
    TLVRecordType nullRecord;
    nullRecord.assign(nullptr);
    return nullRecord;
}

TLVRecordType firstRecord;
firstRecord.assign(recordPtr, recordSize);

// Move the pointer to the next record
recordPtr += recordSize;
tlvDataLength -= recordSize;

return firstRecord;