if (tlvDataBasePtr == nullptr || tlvDataLength == 0)
{
    return TLVRecordType(nullptr);
}

TLVRecordType record(tlvDataBasePtr);
if (record.getTotalSize() == 0 || record.getTotalSize() > tlvDataLength)
{
    return TLVRecordType(nullptr);
}

return record;