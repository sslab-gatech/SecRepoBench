if (tlvDataBasePtr == NULL || tlvDataLength == 0) {
    return TLVRecordType(nullptr);
}

TLVRecordType record;
record.assign(tlvDataBasePtr, tlvDataLength);

if (record.getSize() > tlvDataLength) {
    record.assign(nullptr);
    return record;
}

return record;