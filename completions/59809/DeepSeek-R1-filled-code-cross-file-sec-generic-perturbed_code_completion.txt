if (tlvDataBasePtr == nullptr || tlvDataLength == 0)
{
    TLVRecordType nullRec;
    nullRec.assign(nullptr);
    return nullRec;
}

TLVRecordType firstRec;
firstRec.assign(tlvDataBasePtr);

if (firstRec.isNull() || firstRec.getTotalSize() > tlvDataLength)
{
    firstRec.assign(nullptr);
}

return firstRec;