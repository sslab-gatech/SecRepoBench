TLVRecordType getFirstTLVRecord(uint8_t* tlvDataBasePtr, size_t tlvDataLength) const
{
    if (tlvDataBasePtr == nullptr || tlvDataLength == 0)
    {
        return TLVRecordType(nullptr);
    }

    // Check if the TLV record length is less than or equal to the data length
    if (tlvDataLength < sizeof(TLVRecordType::Header))
    {
        return TLVRecordType(nullptr);
    }

    // Extract the TLV record header from the byte stream
    TLVRecordType::Header* header = reinterpret_cast<TLVRecordType::Header*>(tlvDataBasePtr);

    // Check if the TLV record is valid
    if (header->length > tlvDataLength || header->length < sizeof(TLVRecordType::Header))
    {
        return TLVRecordType(nullptr);
    }

    // Create a TLVRecordType instance from the extracted header
    TLVRecordType record(header);

    // Check if the TLV record is null
    if (record.isNull())
    {
        return TLVRecordType(nullptr);
    }

    return record;
}