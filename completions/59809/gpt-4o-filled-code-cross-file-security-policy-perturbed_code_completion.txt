if (tlvDataBasePtr == nullptr || tlvDataLength == 0)
{
    TLVRecordType nullRecord;
    nullRecord.assign(nullptr);
    return nullRecord;
}

TLVRecordType firstRecord;
size_t recordSize = firstRecord.getSize();

if (recordSize == 0 || recordSize > tlvDataLength)
{
    firstRecord.assign(nullptr);
    return firstRecord;
}

uint8_t* recordEndPtr = tlvDataBasePtr + recordSize;
if (recordEndPtr > tlvDataBasePtr + tlvDataLength)
{
    firstRecord.assign(nullptr);
    return firstRecord;
}

firstRecord.assign(tlvDataBasePtr);
return firstRecord;