if (tlvDataBasePtr == NULL || tlvDataLength == 0)
{
    return TLVRecordType(NULL);
}

uint8_t* recBasePtr = tlvDataBasePtr;
uint8_t recType = *recBasePtr;
uint8_t recLen = *(recBasePtr + 1);

if (recBasePtr + recLen + 2 > tlvDataBasePtr + tlvDataLength)
{
    return TLVRecordType(NULL);
}

return TLVRecordType(recBasePtr, recType, recLen);