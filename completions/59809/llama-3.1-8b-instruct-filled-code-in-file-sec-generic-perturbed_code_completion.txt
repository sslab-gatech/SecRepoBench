TLVRecordType getFirstTLVRecord(uint8_t* tlvDataBasePtr, size_t tlvDataLength) const
{
    if (tlvDataBasePtr == NULL || tlvDataLength == 0)
        return TLVRecordType(NULL);

    TLVRecordType resRec(NULL); // for NRVO optimization

    // Check if the first TLV record is out of bounds of the TLV records memory
    if ((tlvDataBasePtr - (uint8_t*)m_Data) < 0)
        return resRec;

    // Check if the first TLV record is out of bounds of the TLV records memory
    if (tlvDataBasePtr - (uint8_t*)m_Data + (int)tlvDataLength >= (int)tlvDataLength)
        return resRec;

    resRec.assign(tlvDataBasePtr);
    if (resRec.getTotalSize() == 0)
        resRec.assign(NULL);

    return resRec;
}