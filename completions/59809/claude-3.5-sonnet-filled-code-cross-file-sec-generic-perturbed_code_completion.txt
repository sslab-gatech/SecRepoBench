if (tlvDataBasePtr == nullptr || tlvDataLength == 0)
{
    return TLVRecordType(nullptr);
}

TLVRecordType record;
record.assign(tlvDataBasePtr);

if (record.getTotalSize() > tlvDataLength)
{
    return TLVRecordType(nullptr);
}

return record;