if (tlvDataBasePtr == NULL || tlvDataLength == 0)
{
    return TLVRecordType(NULL);
}

uint8_t* curPtr = tlvDataBasePtr;
uint8_t* endPtr = tlvDataBasePtr + tlvDataLength;

if (curPtr + 1 >= endPtr)
{
    return TLVRecordType(NULL);
}

uint8_t type = *curPtr;
uint8_t length = *(curPtr + 1);

if (curPtr + 2 + length > endPtr)
{
    return TLVRecordType(NULL);
}

return TLVRecordType(curPtr, type, length);