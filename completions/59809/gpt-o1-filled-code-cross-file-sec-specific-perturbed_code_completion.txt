if (tlvDataBasePtr == NULL || tlvDataLength < 2)
{
    TLVRecordType nullRec;
    nullRec.assign(NULL);
    return nullRec;
}

TLVRecordType firstRec;
firstRec.assign(tlvDataBasePtr, tlvDataLength);

// Ensure we don't reference beyond bounds
if (firstRec.isNull() || firstRec.getTotalSize() > tlvDataLength)
{
    TLVRecordType nullRec;
    nullRec.assign(NULL);
    return nullRec;
}

return firstRec;