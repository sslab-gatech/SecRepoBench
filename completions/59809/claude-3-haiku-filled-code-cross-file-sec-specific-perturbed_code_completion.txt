TLVRecordType getFirstTLVRecord(uint8_t* tlvDataBasePtr, size_t tlvDataLength) const
{
    TLVRecordType tlvRecord;

    if (tlvDataBasePtr == nullptr || tlvDataLength == 0)
    {
        tlvRecord.assign(nullptr);
        return tlvRecord;
    }

    uint8_t* currentPtr = tlvDataBasePtr;
    size_t remainingLength = tlvDataLength;

    // Check if there is at least one TLV record
    if (remainingLength < sizeof(TLVRecordHeader))
    {
        tlvRecord.assign(nullptr);
        return tlvRecord;
    }

    // Extract the first TLV record
    TLVRecordHeader* header = reinterpret_cast<TLVRecordHeader*>(currentPtr);
    size_t recordLength = header->length + sizeof(TLVRecordHeader);

    // Ensure the record length does not exceed the remaining data length
    if (recordLength > remainingLength)
    {
        tlvRecord.assign(nullptr);
        return tlvRecord;
    }

    tlvRecord.assign(header, recordLength);
    return tlvRecord;
}