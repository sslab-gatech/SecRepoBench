if (tlvDataBasePtr == nullptr || tlvDataLength == 0)
{
    return TLVRecordType(nullptr);
}

if (tlvDataLength < sizeof(uint32_t))
{
    return TLVRecordType(nullptr);
}

uint32_t recordType = *(uint32_t*)tlvDataBasePtr;
size_t recordLength = sizeof(uint32_t) + ((recordType >> 24) & 0xFF);

if (recordLength > tlvDataLength)
{
    return TLVRecordType(nullptr);
}

return TLVRecordType(tlvDataBasePtr);