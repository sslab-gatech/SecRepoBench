if (tlvDataBasePtr == nullptr || tlvDataLength == 0)
{
    TLVRecordType nullRecord;
    nullRecord.assign(nullptr);
    return nullRecord;
}

// Ensure the buffer has enough data for at least one TLV record header
if (tlvDataLength < sizeof(TLVRecordHeader))
{
    TLVRecordType nullRecord;
    nullRecord.assign(nullptr);
    return nullRecord;
}

// Safely parse the first TLV record
TLVRecordType firstRecord;
firstRecord.parse(tlvDataBasePtr, tlvDataLength);
return firstRecord;