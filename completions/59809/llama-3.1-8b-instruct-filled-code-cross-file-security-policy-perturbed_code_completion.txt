TLVRecordType getFirstTLVRecord(uint8_t* tlvDataBasePtr, size_t tlvDataLength) const
{
    if (tlvDataBasePtr == nullptr || tlvDataLength == 0)
    {
        TLVRecordType record;
        record.assign(NULL);
        return record;
    }

    size_t recordSize = 0;
    size_t totalSize = 0;
    uint8_t* recordBase = tlvDataBasePtr;

    // Check if the total size of the record does not exceed the allocated data length
    if (recordBase + sizeof(size_t) > tlvDataBasePtr + tlvDataLength)
    {
        TLVRecordType record;
        record.assign(NULL);
        return record;
    }

    // Read the record size
    recordSize = *reinterpret_cast<const size_t*>(recordBase);
    totalSize = recordSize;

    // Check if the total size of the record does not exceed the allocated data length
    if (recordBase + totalSize > tlvDataBasePtr + tlvDataLength)
    {
        TLVRecordType record;
        record.assign(NULL);
        return record;
    }

    // Check if there are records present and that their total size is non-zero
    if (totalSize == 0)
    {
        TLVRecordType record;
        record.assign(NULL);
        return record;
    }

    // Create a TLVRecordType instance
    TLVRecordType record(recordBase, recordSize);

    return record;
}