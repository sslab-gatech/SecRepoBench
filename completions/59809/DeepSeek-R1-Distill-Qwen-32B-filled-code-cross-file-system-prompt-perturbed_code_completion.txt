if (tlvDataBasePtr == NULL || tlvDataLength == 0)
{
    return TLVRecordType(nullptr);
}

if (tlvDataLength < 2)
{
    return TLVRecordType(nullptr);
}

uint8_t type = tlvDataBasePtr[0];
uint8_t length = tlvDataBasePtr[1];
size_t recordSize = 2 + length;

if (recordSize > tlvDataLength)
{
    return TLVRecordType(nullptr);
}

return TLVRecordType(type, length, tlvDataBasePtr + 2);