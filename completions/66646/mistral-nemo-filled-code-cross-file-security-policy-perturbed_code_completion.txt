case DW_FORM_ref8:
    READ_UNALIGNED_CK(dbg, offset, Dwarf_Unsigned,
        attribute->ar_debug_ptr, DWARF_64BIT_SIZE,
        error, section_end);
    goto fixoffset;

case DW_FORM_ref_udata:
    {
        Dwarf_Byte_Ptr ptr = attribute->ar_debug_ptr;
        Dwarf_Unsigned localoffset = 0;

        DECODE_LEB128_UWORD_CK(ptr, localoffset,
            dbg, error, section_end);
        offset = localoffset;

        fixoffset: /* we have a local offset, make it global */

        /* check legality of offset */
        if (offset >= cu_context->cc_length +
            cu_context->cc_length_size +
            cu_context->cc_extension_size) {
            _dwarf_error(dbg, error, DW_DLE_ATTR_FORM_OFFSET_BAD);
            return DW_DLV_ERROR;
        }

        /* globalize the offset */
        offset += cu_context->cc_debug_offset;
    }
    break;