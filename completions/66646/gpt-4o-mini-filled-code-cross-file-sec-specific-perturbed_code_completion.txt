case DW_FORM_ref1:
    case DW_FORM_ref2:
    case DW_FORM_ref4: {
        Dwarf_Byte_Ptr ptr = attribute->ar_debug_ptr;
        Dwarf_Unsigned localoffset = 0;

        if ((ptr + sizeof(Dwarf_Unsigned)) > section_end) {
            _dwarf_error_string(dbg, error,
                DW_DLE_REF_OFFSET_NOT_HANDLED,
                "DW_DLE_REF_OFFSET_NOT_HANDLED: "
                "Reference offset runs off the end of its section");
            return DW_DLV_ERROR;
        }

        switch (attribute->ar_attribute_form) {
            case DW_FORM_ref1:
                localoffset = *(Dwarf_Small *)ptr;
                break;
            case DW_FORM_ref2:
                READ_UNALIGNED_CK(dbg, localoffset, Dwarf_Unsigned,
                    ptr, 2, error, section_end);
                break;
            case DW_FORM_ref4:
                READ_UNALIGNED_CK(dbg, localoffset, Dwarf_Unsigned,
                    ptr, 4, error, section_end);
                break;
        }
        offset = localoffset;

        /* check legality of offset */
        if (offset >= cu_context->cc_length +
            cu_context->cc_length_size +
            cu_context->cc_extension_size) {
            _dwarf_error(dbg, error, DW_DLE_ATTR_FORM_OFFSET_BAD);
            return DW_DLV_ERROR;
        }

        /* globalize the offset */
        offset += cu_context->cc_debug_offset;
    }
    break;