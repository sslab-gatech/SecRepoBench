case DW_FORM_ref1:
    if (loc_ptr >= section_end) {
        _dwarf_error(dbg,error,DW_DLE_LOCEXPR_OFF_SECTION_END);
        return DW_DLV_ERROR;
    }
    offset = *(Dwarf_Small *) loc_ptr;
    loc_ptr++;
    if (loc_ptr > section_end) {
        _dwarf_error(dbg,error,DW_DLE_LOCEXPR_OFF_SECTION_END);
        return DW_DLV_ERROR;
    }
    offset += 1;
    break;

case DW_FORM_ref2:
    READ_UNALIGNED_CK(dbg, offset, Dwarf_Unsigned, loc_ptr, 2,
        error, section_end);
    loc_ptr += 2;
    offset += 2;
    break;

case DW_FORM_ref4:
    READ_UNALIGNED_CK(dbg, offset, Dwarf_Unsigned, loc_ptr, 4,
        error, section_end);
    loc_ptr += 4;
    offset += 4;
    break;