->ar_debug_ptr,
            DWARF_64BIT_SIZE,
            error,section_end);
        SIGN_EXTEND(ret_value,DWARF_64BIT_SIZE);
        *return_sval = (Dwarf_Signed) ret_value;
        return DW_DLV_OK;
        }

    case DW_FORM_sdata: {
        Dwarf_Unsigned leblen = 0;
        Dwarf_Signed num = 0;
        DECODE_LEB128_SWORD_LEN_CK(attr->ar_debug_ptr,num,leblen,
            dbg,error,section_end);
        *return_sval = num;
        return DW_DLV_OK;
    }
    default:
        generate_form_error(dbg,error,attr->ar_attribute_form,
            DW_DLE_ATTR_FORM_BAD,
            "DW_DLE_ATTR_FORM_BAD",
            "dwarf_formsdata");
        return DW_DLV_ERROR;
    }
}

int
dwarf_formstring(Dwarf_Attribute attr,
    char ** return_string, Dwarf_Error * error)
{
    Dwarf_Debug dbg = 0;
    Dwarf_CU_Context cu_context = 0;
    Dwarf_Byte_Ptr section_end = 0;
    Dwarf_Byte_Ptr data = 0;
    Dwarf_Unsigned length = 0;
    int res = 0;

    res  = get_attr_dbg(&dbg,&cu_context,attr,error);
    if (res != DW_DLV_OK) {
        return res;
    }
    section_end =
        _dwarf_calculate_info_section_end_ptr(cu_context);
    data = attr->ar_debug_ptr;
    if (data >= section_end) {
        _dwarf_error(dbg, error, DW_DLE_DIE_BAD);
        return DW_DLV_ERROR;
    }
    length = attr->ar_length;
    if (length == 0) {
        *return_string = NULL;
        return DW_DLV_OK;
    }
    if (data + length > section_end) {
        _dwarf_error(dbg, error, DW_DLE_DIE_BAD);
        return DW_DLV_ERROR;
    }
    *return_string = (char *)data;
    return DW_DLV_OK;
}

int
dwarf_formblock(Dwarf_Attribute attr,
    Dwarf_Byte ** return_block,
    Dwarf_Unsigned * return_length,
    Dwarf_Error * error)
{
    Dwarf_Debug dbg = 0;
    Dwarf_CU_Context cu_context = 0;
    Dwarf_Byte_Ptr section_end = 0;
    Dwarf_Byte_Ptr data = 0;
    Dwarf_Unsigned length = 0;
    int res = 0;

    res  = get_attr_dbg(&dbg,&cu_context,attr,error);
    if (res != DW_DLV_OK) {
        return res;
    }
    section_end =
        _dwarf_calculate_info_section_end_ptr(cu_context);
    data = attr->ar_debug_ptr;
    if (data >= section_end) {
        _dwarf_error(dbg, error, DW_DLE_DIE_BAD);
        return DW_DLV_ERROR;
    }
    length = attr->ar_length;
    if (length == 0) {
        *return_block = NULL;
        *return_length = 0;
        return DW_DLV_OK;
    }
    if (data + length > section_end) {
        _dwarf_error(dbg, error, DW_DLE_DIE_BAD);
        return DW_DLV_ERROR;
    }
    *return_block = data;
    *return_length = length;
    return DW_DLV_OK;
}

int
dwarf_formblock2(Dwarf_Attribute attr,
    Dwarf_Byte ** return_block,
    Dwarf_Unsigned * return_length,
    Dwarf_Error * error)
{
    Dwarf_Debug dbg = 0;
    Dwarf_CU_Context cu_context = 0;
    Dwarf_Byte_Ptr section_end = 0;
    Dwarf_Byte_Ptr data = 0;
    Dwarf_Unsigned length = 0;
    int res = 0;

    res  = get_attr_dbg(&dbg,&cu_context,attr,error);
    if (res != DW_DLV_OK) {
        return res;
    }
    section_end =
        _dwarf_calculate_info_section_end_ptr(cu_context);
    data = attr->ar_debug_ptr;
    if (data >= section_end) {
        _dwarf_error(dbg, error, DW_DLE_DIE_BAD);
        return DW_DLV_ERROR;
    }
    length = attr->ar_length;
    if (length == 0) {
        *return_block = NULL;
        *return_length = 0;
        return DW_DLV_OK;
    }
    if (data + length > section_end) {
        _dwarf_error(dbg, error, DW_DLE_DIE_BAD);
        return DW_DLV_ERROR;
    }
    *return_block = data;
    *return_length = length;
    return DW_DLV_OK;
}

int
dwarf_formblock_data(Dwarf_Attribute attr,
    Dwarf_Byte ** return_block,
    Dwarf_Unsigned * return_length,
    Dwarf_Error * error)
{
    Dwarf_Debug dbg = 0;
    Dwarf_CU_Context cu_context = 0;
    Dwarf_Byte_Ptr section_end = 0;
    Dwarf_Byte_Ptr data = 0;
    Dwarf_Unsigned length = 0;
    int res = 0;

    res  = get_attr_dbg(&dbg,&cu_context,attr,error);
    if (res != DW_DLV_OK) {
        return res;
    }
    section_end =
        _dwarf_calculate_info_section_end_ptr(cu_context);
    data = attr->ar_debug_ptr;
    if (data >= section_end) {
        _dwarf_error(dbg, error, DW_DLE_DIE_BAD);
        return DW_DLV_ERROR;
    }
    length = attr->ar_length;
    if (length == 0) {
        *return_block = NULL;
        *return_length = 0;
        return DW_DLV_OK;
    }
    if (data + length > section_end) {
        _dwarf_error(dbg, error, DW_DLE_DIE_BAD);
        return DW_DLV_ERROR;
    }
    *return_block = data;
    *return_length = length;
    return DW_DLV_OK;
}

int
dwarf_formblock_data2(Dwarf_Attribute attr,
    Dwarf_Byte ** return_block,
    Dwarf_Unsigned * return_length,
    Dwarf_Error * error)
{
    Dwarf_Debug dbg = 0;
    Dwarf_CU_Context cu_context = 0;
    Dwarf_Byte_Ptr section_end = 0;
    Dwarf_Byte_Ptr data = 0;
    Dwarf_Unsigned length = 0;
    int res = 0;

    res  = get_attr_dbg(&dbg,&cu_context,attr,error);
    if (res != DW_DLV_OK) {
        return res;
    }
    section_end =
        _dwarf_calculate_info_section_end_ptr(cu_context);
    data = attr->ar_debug_ptr;
    if (data >= section_end) {
        _dwarf_error(dbg, error, DW_DLE_DIE_BAD);
        return DW_DLV_ERROR;
    }
    length = attr->ar_length;
    if (length == 0) {
        *return_block = NULL;
        *return_length = 0;
        return DW_DLV_OK;
    }
    if (data + length > section_end) {
        _dwarf_error(dbg, error, DW_DLE_DIE_BAD);
        return DW_DLV_ERROR;
    }
    *return_block = data;
    *return_length = length;
    return DW_DLV_OK;
}

int
dwarf_formblock_data4(Dwarf_Attribute attr,
    Dwarf_Byte ** return_block,
    Dwarf_Unsigned * return_length,
    Dwarf_Error * error)
{
    Dwarf_Debug dbg = 0;
    Dwarf_CU_Context cu_context = 0;
    Dwarf_Byte_Ptr section_end = 0;
    Dwarf_Byte_Ptr data = 0;
    Dwarf_Unsigned length = 0;
    int res = 0;

    res  = get_attr_dbg(&dbg,&cu_context,attr,error);
    if (res != DW_DLV_OK) {
        return res;
    }
    section_end =
        _dwarf_calculate_info_section_end_ptr(cu_context);
    data = attr->ar_debug_ptr;
    if (data >= section_end) {
        _dwarf_error(dbg, error, DW_DLE_DIE_BAD);
        return DW_DLV_ERROR;
    }
    length = attr->ar_length;
    if (length == 0) {
        *return_block = NULL;
        *return_length = 0;
        return DW_DLV_OK;
    }
    if (data + length > section_end) {
        _dwarf_error(dbg, error, DW_DLE_DIE_BAD);
        return DW_DLV_ERROR;
    }
    *return_block = data;
    *return_length = length;
    return DW_DLV_OK;
}

int
dwarf_formblock_data8(Dwarf_Attribute attr,
    Dwarf_Byte ** return_block,
    Dwarf_Unsigned * return_length,
    Dwarf_Error * error)
{
    Dwarf_Debug dbg = 0;
    Dwarf_CU_Context cu_context = 0;
    Dwarf_Byte_Ptr section_end = 0;
    Dwarf_Byte_Ptr data = 0;
    Dwarf_Unsigned length = 0;
    int res = 0;

    res  = get_attr_dbg(&dbg,&cu_context,attr,error);
    if (res != DW_DLV_OK) {
        return res;
    }
    section_end =
        _dwarf_calculate_info_section_end_ptr(cu_context);
    data = attr->ar_debug_ptr;
    if (data >= section_end) {
        _dwarf_error(dbg, error, DW_DLE_DIE_BAD);
        return DW_DLV_ERROR;
    }
    length = attr->ar_length;
    if (length == 0) {
        *return_block = NULL;
        *return_length = 0;
        return DW_DLV_OK;
    }
    if (data + length > section_end) {
        _dwarf_error(dbg, error, DW_DLE_DIE_BAD);
        return DW_DLV_ERROR;
    }
    *return_block = data;
    *return_length = length;
    return DW_DLV_OK;
}

int
dwarf_formexprloc(Dwarf_Attribute attr,
    Dwarf_Byte ** return_block,
    Dwarf_Unsigned * return_length,
    Dwarf_Error * error)
{
    Dwarf_Debug dbg = 0;
    Dwarf_CU_Context cu_context = 0;
    Dwarf_Byte_Ptr section_end = 0;
    Dwarf_Byte_Ptr data = 0;
    Dwarf_Unsigned length = 0;
    int res = 0;

    res  = get_attr_dbg(&dbg,&cu_context,attr,error);
    if (res != DW_DLV_OK) {
        return res;
    }
    section_end =
        _dwarf_calculate_info_section_end_ptr(cu_context);
    data = attr->ar_debug_ptr;
    if (data >= section_end) {
        _dwarf_error(dbg, error, DW_DLE