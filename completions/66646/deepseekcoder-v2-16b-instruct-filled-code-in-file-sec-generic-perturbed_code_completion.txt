READ_UNALIGNED_CK(dbg, ret_value, Dwarf_Signed,
            attr->ar_debug_ptr,
            DWARF_64BIT_SIZE,
            error,section_end);
        SIGN_EXTEND(ret_value,DWARF_64BIT_SIZE);
        *return_sval = (Dwarf_Signed) ret_value;
        return DW_DLV_OK;
        }

    case DW_FORM_sdata: {
        Dwarf_Unsigned leblen = 0;
        Dwarf_Signed num;
        DECODE_LEB128_SWORD_LEN_CK(attr->ar_debug_ptr,num,leblen,
            dbg,error,section_end);
        *return_sval = num;
        return DW_DLV_OK;
    }
    default:
        generate_form_error(dbg,error,attr->ar_attribute_form,
            DW_DLE_ATTR_FORM_BAD,
            "DW_DLE_ATTR_FORM_BAD",
            "dwarf_formsdata");
        return DW_DLV_ERROR;
    }
}

int
dwarf_formstring(Dwarf_Attribute attr,
    char ** return_string, Dwarf_Error * error)
{
    Dwarf_Debug dbg = 0;
    Dwarf_CU_Context cu_context = 0;
    Dwarf_Byte_Ptr section_end = 0;
    Dwarf_Byte_Ptr data = 0;
    Dwarf_Unsigned length = 0;
    int res = 0;

    res  = get_attr_dbg(&dbg,&cu_context,attr,error);
    if (res != DW_DLV_OK) {
        return res;
    }
    section_end =
        _dwarf_calculate_info_section_end_ptr(cu_context);
    data = attr->ar_debug_ptr;
    if (attr->ar_attribute_form == DW_FORM_string) {
        length = strlen((char *)data);
    } else if (attr->ar_attribute_form == DW_FORM_strp) {
        READ_UNALIGNED_CK(dbg, length, Dwarf_Unsigned,
            data, cu_context->cc_length_size,
            error,section_end);
    } else {
        generate_form_error(dbg,error,attr->ar_attribute_form,
            DW_DLE_ATTR_FORM_BAD,
            "DW_DLE_ATTR_FORM_BAD",
            "dwarf_formstring");
        return DW_DLV_ERROR;
    }
    *return_string = (char *)data;
    return DW_DLV_OK;
}

int
dwarf_formref_addr(Dwarf_Attribute attr,
    Dwarf_Addr * return_addr, Dwarf_Error * error)
{
    Dwarf_Debug dbg = 0;
    Dwarf_CU_Context cu_context = 0;
    Dwarf_Byte_Ptr section_end = 0;
    Dwarf_Unsigned length_size = 0;
    Dwarf_Addr ret_addr = 0;

    int res  = get_attr_dbg(&dbg,&cu_context,attr,error);
    if (res != DW_DLV_OK) {
        return res;
    }
    section_end =
        _dwarf_calculate_info_section_end_ptr(cu_context);
    length_size = cu_context->cc_length_size;
    if (length_size == 4) {
        READ_UNALIGNED_CK(dbg, ret_addr, Dwarf_Addr,
            attr->ar_debug_ptr,
            DWARF_32BIT_SIZE,
            error,section_end);
    } else if (length_size == 8) {
        READ_UNALIGNED_CK(dbg, ret_addr, Dwarf_Addr,
            attr->ar_debug_ptr,
            DWARF_64BIT_SIZE,
            error,section_end);
    } else {
        _dwarf_error(dbg, error,
            DW_DLE_FORM_SEC_OFFSET_LENGTH_BAD);
        return DW_DLV_ERROR;
    }
    *return_addr = ret_addr;
    return DW_DLV_OK;
}

int
dwarf_formaddrx(Dwarf_Attribute attr,
    Dwarf_Unsigned * return_index, Dwarf_Error * error)
{
    Dwarf_Debug dbg = 0;
    Dwarf_CU_Context cu_context = 0;
    Dwarf_Byte_Ptr section_end = 0;
    Dwarf_Unsigned index = 0;
    Dwarf_Unsigned length_size = 0;

    int res  = get_attr_dbg(&dbg,&cu_context,attr,error);
    if (res != DW_DLV_OK) {
        return res;
    }
    section_end =
        _dwarf_calculate_info_section_end_ptr(cu_context);
    length_size = cu_context->cc_length_size;
    if (length_size == 4) {
        DECODE_LEB128_UWORD_CK(attr->ar_debug_ptr,index,
            dbg,error,section_end);
    } else if (length_size == 8) {
        DECODE_LEB128_UWORD_CK(attr->ar_debug_ptr,index,
            dbg,error,section_end);
    } else {
        _dwarf_error(dbg, error,
            DW_DLE_FORM_SEC_OFFSET_LENGTH_BAD);
        return DW_DLV_ERROR;
    }
    *return_index = index;
    return DW_DLV_OK;
}

int
dwarf_formaddrx1(Dwarf_Attribute attr,
    Dwarf_Unsigned * return_index, Dwarf_Error * error)
{
    Dwarf_Debug dbg = 0;
    Dwarf_CU_Context cu_context = 0;
    Dwarf_Byte_Ptr section_end = 0;
    Dwarf_Unsigned index = 0;

    int res  = get_attr_dbg(&dbg,&cu_context,attr,error);
    if (res != DW_DLV_OK) {
        return res;
    }
    section_end =
        _dwarf_calculate_info_section_end_ptr(cu_context);
    if (attr->ar_debug_ptr[0] > 0xff) {
        _dwarf_error(dbg, error, DW_DLE_DATA_TOO_LARGE);
        return DW_DLV_ERROR;
    }
    index = attr->ar_debug_ptr[0];
    *return_index = index;
    return DW_DLV_OK;
}

int
dwarf_formaddrx2(Dwarf_Attribute attr,
    Dwarf_Unsigned * return_index, Dwarf_Error * error)
{
    Dwarf_Debug dbg = 0;
    Dwarf_CU_Context cu_context = 0;
    Dwarf_Byte_Ptr section_end = 0;
    Dwarf_Unsigned index = 0;

    int res  = get_attr_dbg(&dbg,&cu_context,attr,error);
    if (res != DW_DLV_OK) {
        return res;
    }
    section_end =
        _dwarf_calculate_info_section_end_ptr(cu_context);
    if (attr->ar_debug_ptr[0] > 0xff ||
        attr->ar_debug_ptr[1] > 0xff) {
        _dwarf_error(dbg, error, DW_DLE_DATA_TOO_LARGE);
        return DW_DLV_ERROR;
    }
    index = (attr->ar_debug_ptr[0] << 8) | attr->ar_debug_ptr[1];
    *return_index = index;
    return DW_DLV_OK;
}

int
dwarf_formaddrx3(Dwarf_Attribute attr,
    Dwarf_Unsigned * return_index, Dwarf_Error * error)
{
    Dwarf_Debug dbg = 0;
    Dwarf_CU_Context cu_context = 0;
    Dwarf_Byte_Ptr section_end = 0;
    Dwarf_Unsigned index = 0;

    int res  = get_attr_dbg(&dbg,&cu_context,attr,error);
    if (res != DW_DLV_OK) {
        return res;
    }
    section_end =
        _dwarf_calculate_info_section_end_ptr(cu_context);
    if (attr->ar_debug_ptr[0] > 0xff ||
        attr->ar_debug_ptr[1] > 0xff ||
        attr->ar_debug_ptr[2] > 0xff) {
        _dwarf_error(dbg, error, DW_DLE_DATA_TOO_LARGE);
        return DW_DLV_ERROR;
    }
    index = (attr->ar_debug_ptr[0] << 16) |
        (attr->ar_debug_ptr[1] << 8) |
        attr->ar_debug_ptr[2];
    *return_index = index;
    return DW_DLV_OK;
}

int
dwarf_formaddrx4(Dwarf_Attribute attr,
    Dwarf_Unsigned * return_index, Dwarf_Error * error)
{
    Dwarf_Debug dbg = 0;
    Dwarf_CU_Context cu_context = 0;
    Dwarf_Byte_Ptr section_end = 0;
    Dwarf_Unsigned index = 0;

    int res  = get_attr_dbg(&dbg,&cu_context,attr,error);
    if (res != DW_DLV_OK) {
        return res;
    }
    section_end =
        _dwarf_calculate_info_section_end_ptr(cu_context);
    if (attr->ar_debug_ptr[0] > 0xff ||
        attr->ar_debug_ptr[1] > 0xff ||
        attr->ar_debug_ptr[2] > 0xff ||
        attr->ar_debug_ptr[3] > 0xff) {
        _dwarf_error(dbg, error, DW_DLE_DATA_TOO_LARGE);
        return DW_DLV_ERROR;
    }
    index = (attr->ar_debug_ptr[0] << 24) |
        (attr->ar_debug_ptr[1] << 16) |
        (attr->ar_debug_ptr[2] << 8) |
        attr->ar_debug_ptr[3];
    *return_index = index;
    return DW_DLV_OK;
}

int
dwarf_formaddrx_sup(Dwarf_Attribute attr,
    Dwarf_Unsigned * return_index, Dwarf_Error * error)
{
    Dwarf_Debug dbg = 0;
    Dwarf_CU_Context cu_context = 0;
    Dwarf_Byte_Ptr section_end = 0;
    Dwarf_Unsigned index = 0;
    Dwarf_Unsigned length_size = 0;

    int res  = get_attr_dbg(&dbg,&cu_context,attr,error);
    if (res != DW_DLV_OK) {
        return res;
    }
    section_end =
        _dwarf_calculate_info_section_end_ptr(cu_context);
    length_size = cu_context->cc_length_size;
    if (length_size == 4) {
        DECODE_LEB128_UWORD_CK(attr->ar_debug_ptr,index,
            dbg,error,section_end);
    } else if (length_size == 8) {
        DECODE_LEB128_UWORD_CK(attr->ar_debug_ptr,index,
            dbg,error,section_end);
    } else {
        _dwarf_error(dbg, error,
            DW_DLE_FORM_SEC_OFFSET_LENGTH_BAD);
        return DW_DLV_ERROR;
    }
    *return_index = index;
    return DW_DLV_OK;
}

int
dwarf_formstrp_sup(Dwarf_Attribute attr,
    char ** return_string, Dwarf_Error * error)
{
    Dwarf_Debug dbg = 0;
    Dwarf_CU_Context cu_context = 0;
    Dwarf_Byte_Ptr section_end = 0;
    Dwarf_Unsigned length_size = 0;
    Dwarf_Unsigned length = 0;
    Dwarf_Byte_Ptr data = 0;
    int res = 0;

    res  = get_attr_dbg(&dbg,&cu_context,