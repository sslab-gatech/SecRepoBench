// Extract the filename from the content disposition line based on its format.
char *filename = NULL;
u_int8_t filename_len = 0;

// Allocate memory for the filename and copy the appropriate substring from the content disposition line.
filename_len = http_packet_struct->content_disposition_line.len - attachment_len - 2; // subtract 2 for quotes
if (filename_len > 0) {
    filename = malloc(filename_len + 1); // allocate memory including null terminator
    if (filename != NULL) {
        memcpy(filename, &http_packet_struct->content_disposition_line.ptr[attachment_len + 1], filename_len); // skip opening quote
        filename[filename_len] = '\0'; // Ensure the filename is null-terminated after copying
    }
}