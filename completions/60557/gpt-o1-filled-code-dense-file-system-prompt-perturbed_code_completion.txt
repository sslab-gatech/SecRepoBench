{
  char *filename;
  u_int8_t offset = 1; /* Skip the initial quote */

  /* Find the closing quote or reach the end of the line */
  while (((attachment_len + offset) < http_packet_struct->content_disposition_line.len) &&
         (http_packet_struct->content_disposition_line.ptr[attachment_len + offset] != '\"')) {
    offset++;
  }

  /* Allocate space for the filename (+1 for '\0') */
  filename = ndpi_malloc(offset);
  if(filename != NULL) {
    memcpy(filename,
           &http_packet_struct->content_disposition_line.ptr[attachment_len + 1],
           offset - 1);
    filename[offset - 1] = '\0'; /* Null-terminate */

    NDPI_LOG_INFO(ndpi_struct, "Extracted filename from Content-Disposition: %s", filename);

    /* Use or store filename as needed, then free if no longer needed */
    ndpi_free(filename);
  }
}