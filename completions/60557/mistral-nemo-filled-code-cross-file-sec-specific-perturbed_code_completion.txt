if(http_packet_struct->content_disposition_line.ptr[attachment_len] == '\"') {
    u_int8_t filename_len = 0;
    const char *filename_start = &http_packet_struct->content_disposition_line.ptr[attachment_len + 1];

    /* Find the length of the filename by searching for the closing quote */
    while(http_packet_struct->content_disposition_line.ptr[filename_len + attachment_len + 1] != '\"' &&
          filename_len < http_packet_struct->content_disposition_line.len - attachment_len - 1) {
      filename_len++;
    }

    if(filename_len > 0) {
      char *filename = (char *)ndpi_malloc(filename_len + 1);
      if(filename != NULL) {
        memcpy(filename, filename_start, filename_len);
        filename[filename_len] = '\0';
        /* Use the filename as needed */
        /* Ensure to free the allocated memory when done */
        ndpi_free(filename);
      }
    }
  }