{
  /* We have confirmed an initial double quote, so let's locate the closing quote
   * to determine the substring length for the filename. */
  int start_offset = attachment_len + 1;
  int remaining_len = filename_len - 1; /* Subtract the initial double quote */
  int extracted_len = 0;
  /* Find the next double quote or end of line. */
  while (extracted_len < remaining_len &&
         http_packet_struct->content_disposition_line.ptr[start_offset + extracted_len] != '\"') {
    extracted_len++;
  }

  if (extracted_len > 0) {
    /* Allocate space for the filename plus null terminator. Use a safe allocator if available. */
    char *filename = (char *)ndpi_calloc(extracted_len + 1, sizeof(char));
    if (filename != NULL) {
      /* Copy the substring for the filename and ensure null termination. */
      memcpy(filename,
             &http_packet_struct->content_disposition_line.ptr[start_offset],
             extracted_len);
      filename[extracted_len] = '\0';

      /* Set the extracted filename in the flow or handle as appropriate. */
      flow->http.filename = filename; /* Example usage */
    }
  }
}