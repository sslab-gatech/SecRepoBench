if((double_dot = strchr(buf, ':'))!= NULL)
  double_dot[0] = '\0';

ip_addr.s_addr = inet_addr(buf);
if(strcmp(inet_ntoa(ip_addr), buf) == 0) {
  char str[64];

  snprintf(str, sizeof(str), "Found host %s", buf);
  ndpi_set_risk(ndpi_struct, flow, NDPI_NUMERIC_IP_HOST, str);
}