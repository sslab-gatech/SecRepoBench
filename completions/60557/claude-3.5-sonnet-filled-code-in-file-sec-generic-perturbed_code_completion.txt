char *filename = ndpi_malloc(filename_len + 1);
if (filename != NULL) {
  if (http_packet_struct->content_disposition_line.ptr[attachment_len] == '\"') {
    strncpy(filename, (char*)&http_packet_struct->content_disposition_line.ptr[attachment_len + 1], filename_len - 1);
    filename[filename_len - 2] = '\0'; // Remove the closing quote
  } else {
    strncpy(filename, (char*)&http_packet_struct->content_disposition_line.ptr[attachment_len], filename_len);
    filename[filename_len] = '\0';
  }
}