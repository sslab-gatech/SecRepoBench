{
  // Allocate memory for the filename
  char *filename = (char *)malloc(filename_len + 1);
  if (filename == NULL) {
    NDPI_LOG_ERR(ndpi_struct, "Memory allocation failed for filename");
    return flow->category; // Return current category if memory allocation fails
  }

  // Copy the filename from the content disposition line
  strncpy(filename, (const char *)&http_packet_struct->content_disposition_line.ptr[attachment_len + 1], filename_len);
  filename[filename_len] = '\0'; // Ensure null-termination

  // Log the extracted filename for debugging
  NDPI_LOG_DBG2(ndpi_struct, "Extracted filename: %s", filename);

  // Free the allocated memory after use
  free(filename);
}