{
  char *filename_start = (char *)&http_packet_struct->content_disposition_line.ptr[attachment_len + 1];
  char *filename_end = strchr(filename_start, '\"');

  if(filename_end != NULL) {
    size_t filename_length = filename_end - filename_start;

    if(filename_length > 0) {
      char *filename = (char *)malloc(filename_length + 1);
      if(filename != NULL) {
        strncpy(filename, filename_start, filename_length);
        filename[filename_length] = '\0'; // Null-terminate the filename

        NDPI_LOG_INFO(ndpi_struct, "Extracted filename: %s", filename);
        free(filename);
      }
    }
  }
}