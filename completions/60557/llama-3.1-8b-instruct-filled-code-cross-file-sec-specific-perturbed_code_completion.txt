if(http_packet_struct->content_disposition_line.len > attachment_len) {
  u_int8_t filename_len = http_packet_struct->content_disposition_line.len - attachment_len;
  int i;

  if(http_packet_struct->content_disposition_line.ptr[attachment_len] == '\"') {
    /* Allocate memory for the filename and copy the appropriate substring from the content disposition line */
    char *filename = malloc(filename_len + 1);
    if (filename!= NULL) {
      /* Ensure the filename is null-terminated after copying */
      memcpy(filename, &http_packet_struct->content_disposition_line.ptr[attachment_len + 1], filename_len);
      filename[filename_len] = '\0';

      /* Check for attachment */
      for(i = 0; binary_file_ext[i]!= NULL; i++) {
        /* Use memcmp in case content-disposition contains binary data */
        if(memcmp(filename, binary_file_ext[i], strlen(binary_file_ext[i])) == 0) {
          char str[64];

          snprintf(str, sizeof(str), "Found file extn %s", binary_file_ext[i]);
          flow->guessed_category = flow->category = NDPI_PROTOCOL_CATEGORY_DOWNLOAD_FT;
          ndpi_set_binary_application_transfer(ndpi_struct, flow, str);
          NDPI_LOG_INFO(ndpi_struct, "found executable HTTP transfer");
          free(filename);
          return(flow->category);
        }
      }

      free(filename);
    }
  }

  if(filename_len > ATTACHMENT_LEN) {
    attachment_len += filename_len-ATTACHMENT_LEN-1;

    if((attachment_len+ATTACHMENT_LEN) <= http_packet_struct->content_disposition_line.len) {
      for(i = 0; binary_file_ext[i]!= NULL; i++) {
        /* Use memcmp in case content-disposition contains binary data */
        if(memcmp(&http_packet_struct->content_disposition_line.ptr[attachment_len],
                  binary_file_ext[i], ATTACHMENT_LEN) == 0) {
          char str[64];

          snprintf(str, sizeof(str), "Found file extn %s", binary_file_ext[i]);
          flow->guessed_category = flow->category = NDPI_PROTOCOL_CATEGORY_DOWNLOAD_FT;
          ndpi_set_binary_application_transfer(ndpi_struct, flow, str);
          NDPI_LOG_INFO(ndpi_struct, "found executable HTTP transfer");
          return(flow->category);
        }
      }
    }
  }
}