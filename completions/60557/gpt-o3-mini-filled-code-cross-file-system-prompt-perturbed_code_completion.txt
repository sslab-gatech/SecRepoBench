{
  const char *filename_start = http_packet_struct->content_disposition_line.ptr + attachment_len + 1;
  const char *filename_end = strchr(filename_start, '\"');
  if(filename_end == NULL)
    break;
  filename_len = (u_int8_t)(filename_end - filename_start);
  char *filename = (char *)malloc(filename_len + 1);
  if(filename == NULL)
    break;
  memcpy(filename, filename_start, filename_len);
  filename[filename_len] = '\0';
  // Optionally, store the allocated filename in a relevant field of flow for later use.
  NDPI_LOG_DBG2(ndpi_struct, "Extracted filename: %s", filename);
  free(filename);
}