const char *start = http_packet_struct->content_disposition_line.ptr + attachment_len + 1;
size_t remaining = http_packet_struct->content_disposition_line.len - (attachment_len + 1);
const char *end_quote = memchr(start, '\"', remaining);
if(end_quote) {
    filename_len = end_quote - start;
    attachment_len += 1;
} else {
    filename_len = remaining;
    attachment_len += 1;
}
char *filename = ndpi_malloc(filename_len + 1);
if(filename) {
    memcpy(filename, start, filename_len);
    filename[filename_len] = '\0';
    ndpi_free(filename);
}