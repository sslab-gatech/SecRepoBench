{
	      char *filename = (char *)malloc(filename_len + 1);
              if (filename == NULL) {
                  /* Handle memory allocation failure */
                  return flow->category;
              }
	      memcpy(filename, &http_packet_struct->content_disposition_line.ptr[attachment_len + 1], filename_len);

	      // Ensure null-termination
	      int filename_length = strnlen(filename, filename_len);
	      filename[filename_length] = '\0';


	      attachment_len++;
	      NDPI_LOG_INFO(ndpi_struct, "HTTP attachment: %s", filename);
              free(filename);

	} else {
	  attachment_len++;
	}
}