char *filename = NULL;
int filename_len = http_packet_struct->content_disposition_line.len - attachment_len;
if(http_packet_struct->content_disposition_line.ptr[attachment_len] == '\"') {
    filename = (char *)malloc(filename_len + 1);
    if(filename != NULL) {
        strncpy(filename, (char *)&http_packet_struct->content_disposition_line.ptr[attachment_len + 1], filename_len - 2);
        filename[filename_len - 2] = '\0';
    }
} else {
    filename = (char *)malloc(filename_len + 1);
    if(filename != NULL) {
        strncpy(filename, (char *)&http_packet_struct->content_disposition_line.ptr[attachment_len], filename_len);
        filename[filename_len] = '\0';
    }
}