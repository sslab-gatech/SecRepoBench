{
	  attachment_len++;
	  if (filename_len > 0) {
	    size_t filename_len_with_null = filename_len + 1;
	    if (filename_len_with_null > SIZE_MAX / sizeof(char)) {
	      // Handle potential integer overflow. Log an error or take other appropriate action.
	      NDPI_LOG_ERR(ndpi_struct, "Integer overflow detected during filename allocation");
	      return flow->category;
	    }

	    if ((flow->http.filename = (char *)malloc(filename_len_with_null * sizeof(char))) == NULL) {
	      NDPI_LOG_ERR(ndpi_struct, "Memory allocation failed for filename");
	      return flow->category;
	    }
	    memcpy(flow->http.filename, &http_packet_struct->content_disposition_line.ptr[attachment_len], filename_len);
	    flow->http.filename[filename_len] = '\0';
	  }
	}