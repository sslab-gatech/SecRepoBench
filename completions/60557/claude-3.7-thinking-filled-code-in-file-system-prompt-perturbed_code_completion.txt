{
  /* Format: attachment; filename="filename.ext" */
  u_int8_t filename_start = attachment_len + 1; /* +1 for the opening quote */
  const u_int8_t *filename_end = (const u_int8_t *)memchr(&http_packet_struct->content_disposition_line.ptr[filename_start], '"', 
                                                        http_packet_struct->content_disposition_line.len - filename_start);
  
  if(filename_end) {
    filename_len = filename_end - &http_packet_struct->content_disposition_line.ptr[filename_start];
    
    flow->http.filename = ndpi_malloc(filename_len + 1);
    if(flow->http.filename) {
      strncpy(flow->http.filename, (const char *)&http_packet_struct->content_disposition_line.ptr[filename_start], filename_len);
      flow->http.filename[filename_len] = '\0';
    }
  }
}