{
        // Check for the presence of a closing quote
        if (http_packet_struct->content_disposition_line.ptr[attachment_len + filename_len - 1] == '\"') {
          filename_len--; // Adjust length to exclude the closing quote
        }

        // Allocate memory for the filename, ensuring it's null-terminated
        flow->http.filename = ndpi_malloc(filename_len + 1);
        if (flow->http.filename) {
          // Copy the filename from the content disposition line
          strncpy(flow->http.filename, (char*)&http_packet_struct->content_disposition_line.ptr[attachment_len], filename_len);
          flow->http.filename[filename_len] = '\0'; // Null-terminate the filename
        }
      }