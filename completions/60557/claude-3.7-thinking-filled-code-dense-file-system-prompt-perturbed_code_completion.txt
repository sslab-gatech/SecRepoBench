{
  // Skip the opening double quote
  attachment_len++;
  filename_len--;
  
  // Look for the closing double quote
  for(i = 0; i < filename_len; i++) {
    if(http_packet_struct->content_disposition_line.ptr[attachment_len + i] == '\"') {
      filename_len = i;
      break;
    }
  }
  
  // Allocate memory for the filename
  flow->http.filename = ndpi_malloc(filename_len + 1);
  if(flow->http.filename != NULL) {
    // Copy the filename from the content disposition line
    strncpy(flow->http.filename, (const char *)&http_packet_struct->content_disposition_line.ptr[attachment_len], filename_len);
    // Add null terminator
    flow->http.filename[filename_len] = '\0';
  }
}