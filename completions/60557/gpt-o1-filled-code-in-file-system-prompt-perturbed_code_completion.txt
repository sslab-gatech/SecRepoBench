{
  /* Find the terminating quote for the filename */
  u_int8_t start = attachment_len + 1;
  u_int8_t end = start;

  for (; end < http_packet_struct->content_disposition_line.len; end++) {
    if (http_packet_struct->content_disposition_line.ptr[end] == '\"') {
      u_int8_t fname_len = end - start;
      flow->http.filename = ndpi_malloc(fname_len + 1);
      if (flow->http.filename) {
        memcpy(flow->http.filename,
               &http_packet_struct->content_disposition_line.ptr[start],
               fname_len);
        flow->http.filename[fname_len] = '\0';
      }
      break;
    }
  }
}