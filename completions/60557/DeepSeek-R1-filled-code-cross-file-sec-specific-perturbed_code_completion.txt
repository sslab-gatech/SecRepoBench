const char *filename_start = http_packet_struct->content_disposition_line.ptr + attachment_len + 1;
size_t remaining = http_packet_struct->content_disposition_line.len - (attachment_len + 1);
const char *end_quote = memchr(filename_start, '\"', remaining);
size_t filename_len_actual = end_quote ? (end_quote - filename_start) : remaining;
char *filename = (char *)ndpi_malloc(filename_len_actual + 1);
if (filename) {
    memcpy(filename, filename_start, filename_len_actual);
    filename[filename_len_actual] = '\0';
    ndpi_free(filename);
}
attachment_len += 1;
filename_len = filename_len_actual;