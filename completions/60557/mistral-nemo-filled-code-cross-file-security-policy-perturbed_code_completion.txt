if(http_packet_struct->content_disposition_line.ptr[attachment_len] == '\"') {
    filename_len--; /* Subtract one for the opening quote */
    if(filename_len > 0) {
      char *filename = (char *)ndpi_malloc(filename_len + 1);
      if(filename != NULL) {
        memcpy(filename, &http_packet_struct->content_disposition_line.ptr[attachment_len + 1], filename_len);
        filename[filename_len] = '\0'; /* Null-terminate the filename */
        /* Use the filename as needed */
        ndpi_free(filename);
      }
    }
  }