{
    filename_len--;
    attachment_len++;
}
char *filename = NULL;
if(filename_len > 0) {
    filename = (char*)ndpi_malloc(filename_len + 1);
    if(filename != NULL) {
        strncpy(filename, (const char*)&http_packet_struct->content_disposition_line.ptr[attachment_len], filename_len);
        filename[filename_len] = '\0';
    }
}