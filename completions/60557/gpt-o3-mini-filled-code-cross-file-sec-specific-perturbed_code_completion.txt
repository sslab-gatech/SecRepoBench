{
    const u_int8_t *orig_ptr = http_packet_struct->content_disposition_line.ptr;
    /* Skip the opening quote */
    const u_int8_t *start = orig_ptr + attachment_len + 1;
    u_int8_t extracted_len = 0;

    /* Find the closing quote without overrunning the buffer */
    while ((attachment_len + 1 + extracted_len) < http_packet_struct->content_disposition_line.len &&
           start[extracted_len] != '\"') {
        extracted_len++;
    }

    /* Allocate memory for the filename plus null terminator */
    char *filename = (char *)malloc(extracted_len + 1);
    if (filename == NULL) {
        /* In case of allocation failure, skip extraction */
        return flow->category;
    }

    memcpy(filename, start, extracted_len);
    filename[extracted_len] = '\0';

    /* Update the content disposition line to reference the extracted filename */
    http_packet_struct->content_disposition_line.ptr = (u_int8_t *)filename;
    http_packet_struct->content_disposition_line.len = extracted_len;
    filename_len = extracted_len;
}