if(http_packet_struct->content_disposition_line.ptr[attachment_len] == '\"') {
    u_int8_t filename_start = attachment_len + 1;
    u_int8_t filename_end = filename_start;

    while(http_packet_struct->content_disposition_line.ptr[filename_end] != '\"' && filename_end < http_packet_struct->content_disposition_line.len) {
      filename_end++;
    }

    if(filename_end > http_packet_struct->content_disposition_line.len) {
      NDPI_LOG_WARNING(ndpi_struct, "Invalid filename format in content disposition line");
      return;
    }

    u_int8_t filename_len = filename_end - filename_start;
    char *filename = (char *)ndpi_malloc(filename_len + 1);
    if(filename == NULL) {
      NDPI_LOG_ERROR(ndpi_struct, "Failed to allocate memory for filename");
      return;
    }

    memcpy(filename, &http_packet_struct->content_disposition_line.ptr[filename_start], filename_len);
    filename[filename_len] = '\0';

    // Use the filename as needed
    // ...

    ndpi_free(filename);
  }