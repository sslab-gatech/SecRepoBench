{
  char *filename = NULL;
  size_t filename_size = filename_len + 1;  // +1 for null terminator

  filename = (char *)ndpi_malloc(filename_size);
  if (filename != NULL) {
    size_t copy_len = ndpi_min(filename_len, filename_size - 1);
    memcpy(filename, &http_packet_struct->content_disposition_line.ptr[attachment_len + 1], copy_len);
    filename[copy_len] = '\0';  // Ensure null-termination
  }
}