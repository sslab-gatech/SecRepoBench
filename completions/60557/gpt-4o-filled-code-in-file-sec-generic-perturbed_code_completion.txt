{
  char *filename_start = (char *)&http_packet_struct->content_disposition_line.ptr[attachment_len + 1];
  char *filename_end = memchr(filename_start, '\"', filename_len - 1);

  if (filename_end != NULL) {
    size_t filename_length = filename_end - filename_start;
    flow->http.filename = ndpi_malloc(filename_length + 1);

    if (flow->http.filename != NULL) {
      strncpy(flow->http.filename, filename_start, filename_length);
      flow->http.filename[filename_length] = '\0';
    }
  }
}