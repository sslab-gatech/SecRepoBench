{
  const char *start = http_packet_struct->content_disposition_line.ptr + attachment_len + 1;
  /* Look for the closing quote within the remaining buffer */
  const char *end = memchr(start, '\"', http_packet_struct->content_disposition_line.len - attachment_len - 1);
  if(end == NULL) {
    /* If no closing quote is found, consider the rest of the line as the filename */
    end = http_packet_struct->content_disposition_line.ptr + http_packet_struct->content_disposition_line.len;
  }
  /* Adjust filename_len to the length between the quotes */
  filename_len = end - (http_packet_struct->content_disposition_line.ptr + attachment_len + 1);
  
  /* Allocate memory for the filename plus null terminator */
  char *filename = (char *)malloc(filename_len + 1);
  if(filename == NULL) {
    /* Allocation failed, so return the current category without further processing */
    return(flow->category);
  }
  memcpy(filename, start, filename_len);
  filename[filename_len] = '\0';
  
  NDPI_LOG_INFO(ndpi_struct, "Attachment filename: %s", filename);
  
  free(filename);
  
  /* Update attachment_len to skip the opening quote */
  attachment_len++;
}