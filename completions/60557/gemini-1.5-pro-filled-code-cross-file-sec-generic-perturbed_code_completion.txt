{
	  char *filename = (char *)malloc(filename_len + 1);
	  if (filename == NULL) {
	    return flow->category; // Or handle the error appropriately
	  }
	  memcpy(filename, &http_packet_struct->content_disposition_line.ptr[attachment_len + 1], filename_len);

	  // Find the closing quote
	  char *end_quote = strchr(filename, '"');
	  if (end_quote != NULL) {
	    *end_quote = '\0'; // Null-terminate at the closing quote
	    filename_len = end_quote - filename; // Adjust filename_len
	  } else {
	    filename[filename_len] = '\0'; // Null-terminate if no closing quote found
	  }


	  // ... rest of the code using filename and filename_len
          // Remember to free(filename) when it's no longer needed.
	}
}