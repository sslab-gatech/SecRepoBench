{
  /* Extract the filename starting from the character after the initial quote */
  char *filename_start = (char*)&http_packet_struct->content_disposition_line.ptr[attachment_len + 1];
  /* Remaining length up to the next quote */
  u_int8_t remaining_len = filename_len - 1;
  /* Search for the ending quote in the substring */
  char *filename_end = memchr(filename_start, '\"', remaining_len);

  if (filename_end != NULL) {
    u_int8_t actual_filename_len = (u_int8_t)(filename_end - filename_start);
    /* Allocate memory for the filename and ensure null termination */
    char *filename = ndpi_calloc(1, actual_filename_len + 1);

    if (filename != NULL) {
      memcpy(filename, filename_start, actual_filename_len);
      filename[actual_filename_len] = '\0';
      /* Assuming flow->http.filename exists to store the extracted filename */
      flow->http.filename = filename;
    }
  }
}