char* filename = NULL;
int filename_len = packet->content_disposition_line.len - attachment_len;
filename = ndpi_malloc(filename_len + 1);
if(filename) {
    strncpy(filename, (char*)&packet->content_disposition_line.ptr[attachment_len + 1], filename_len);
    filename[filename_len] = '\0';
    flow->http.filename = filename;
}