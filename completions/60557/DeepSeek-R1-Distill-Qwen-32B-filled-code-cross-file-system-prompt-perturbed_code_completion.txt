const char *filename_start = &http_packet_struct->content_disposition_line.ptr[attachment_len + 1];
const char *end_quote = strchr(filename_start, '"');
u_int8_t filename_len = (end_quote != NULL) ? (end_quote - filename_start) : http_packet_struct->content_disposition_line.len - (attachment_len + 1);
char *filename = malloc(filename_len + 1);
if(filename != NULL) {
  memcpy(filename, filename_start, filename_len);
  filename[filename_len] = '\0';
}