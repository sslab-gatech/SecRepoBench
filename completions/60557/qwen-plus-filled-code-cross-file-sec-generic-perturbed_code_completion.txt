char *filename = NULL;

/* Check for valid content-disposition format */
if(http_packet_struct->content_disposition_line.ptr[attachment_len] == '\"') {
  u_int8_t start = attachment_len + 1; /* Skip the opening quote */
  u_int8_t end = start;

  /* Find the closing quote */
  while(end < http_packet_struct->content_disposition_line.len && 
        http_packet_struct->content_disposition_line.ptr[end] != '\"') {
    end++;
  }

  if(end > start) {
    /* Allocate memory for the filename including null terminator */
    filename = malloc((end - start + 1) * sizeof(char));
    if(filename != NULL) {
      memcpy(filename, &http_packet_struct->content_disposition_line.ptr[start], end - start);
      filename[end - start] = '\0'; /* Null-terminate the string */
      
      /* Use the filename as needed */
      NDPI_LOG_INFO(ndpi_struct, "Extracted filename: %s", filename);
      
      /* Free the allocated memory after use */
      free(filename);
    }
  }
}