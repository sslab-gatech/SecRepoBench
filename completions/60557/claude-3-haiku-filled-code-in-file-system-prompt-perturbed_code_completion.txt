char *filename = NULL;
if(packet->content_disposition_line.ptr[attachment_len] == '\"') {
  filename = ndpi_malloc(filename_len - 1);
  if(filename) {
    strncpy(filename, (char*)&packet->content_disposition_line.ptr[attachment_len + 1], filename_len - 2);
    filename[filename_len - 2] = '\0';
  }
} else {
  filename = ndpi_malloc(filename_len);
  if(filename) {
    strncpy(filename, (char*)&packet->content_disposition_line.ptr[attachment_len], filename_len);
    filename[filename_len - 1] = '\0';
  }
}
flow->http.filename = filename;