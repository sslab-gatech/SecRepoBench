for (hb_set_t::iterator iter = initial_gids_to_retain->begin();
       iter != initial_gids_to_retain->end();
       ++iter)
  {
    full_glyphs_to_retain->add (*iter);
    hb_vector_t<hb_codepoint_t> components;
    if (glyf.get_components (*iter, &components))
    {
      for (unsigned int i = 0; i < components.len; i++)
      {
        full_glyphs_to_retain->add (components[i]);
      }
    }
  }
  hb_set_destroy (initial_gids_to_retain);
  glyphs->resize (full_glyphs_to_retain->size());
  _create_old_gid_to_new_gid_map (*glyphs, codepoint_to_glyph);
  cmap.fini();
  glyf.fini();
  return full_glyphs_to_retain;