while (initial_gids_to_retain->next (&gid))
  {
    full_glyphs_to_retain->add (gid);
    glyphs->push (gid);
    _add_composite_glyphs (face, &glyf, gid, full_glyphs_to_retain, glyphs);
  }

  hb_set_destroy (initial_gids_to_retain);

  cmap.fini ();
  glyf.fini ();

  return full_glyphs_to_retain;
}