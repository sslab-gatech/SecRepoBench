zval *pmembers;

	PHP_VAR_UNSERIALIZE_INIT(var_hash);

	s = p = (const unsigned char*)serialized_data_buffer;

	if (*p!= 'x' || *++p != ':') {
		goto outexcept;
	}
	++p;

	if (!php_var_unserialize(&intern->count, &p, s + buf_len, &var_hash) || Z_TYPE(intern->count) != IS_LONG) {
		goto outexcept;
	}

	if (Z_LVAL(intern->count) < 0) {
		goto outexcept;
	}

	--p; /* for ';' */
	if (*p != ';') {
		goto outexcept;
	}
	++p;

	/* storage */
	if (*p!='a' || *++p != ':') {
		goto outexcept;
	}
	++p;
	if (!php_var_unserialize(&intern->storage, &p, s + buf_len, &var_hash) || Z_TYPE(intern->storage) != IS_ARRAY) {
		goto outexcept;
	}