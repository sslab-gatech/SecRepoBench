size_t count = 0;
	zval *pmembers;

	php_unserialize_data_t var_hash;
	PHP_VAR_UNSERIALIZE_INIT(var_hash);

	/* storage */
	if (*p != 'x' || *++p != ':') {
		goto outexcept;
	}
	++p;

	if (!php_var_unserialize(&count, &p, s + buf_len, &var_hash) || count < 0) {
		goto outexcept;
	}

	for (size_t i = 0; i < count; i++) {
		zval obj, inf;

		if (*p != 'O') {
			goto outexcept;
		}
		if (!php_var_unserialize(&obj, &p, s + buf_len, &var_hash)) {
			goto outexcept;
		}

		if (*p != ';') {
			goto outexcept;
		}
		++p;

		if (!php_var_unserialize(&inf, &p, s + buf_len, &var_hash)) {
			goto outexcept;
		}

		spl_object_storage_attach(intern, Z_OBJ(obj), &inf);
		zval_ptr_dtor(&obj);
		zval_ptr_dtor(&inf);
	}

	PHP_VAR_UNSERIALIZE_DESTROY(var_hash);