if (zend_parse_parameters(ZEND_NUM_ARGS(), "s", &serialized_data_buffer, &buf_len) == FAILURE) {
		RETURN_THROWS();
	}

	if (buf_len == 0) {
		return;
	}

	p = (const unsigned char*)serialized_data_buffer;
	s = p;

	PHP_VAR_UNSERIALIZE_INIT(var_hash);

	/* storage */
	if (*p != 'x' || *++p != ':') {
		goto outexcept;
	}
	++p;

	pcount = var_tmp_var(&var_hash);
	if (!php_var_unserialize(pcount, &p, s + buf_len, &var_hash) || Z_TYPE_P(pcount) != IS_LONG) {
		goto outexcept;
	}

	while (Z_LVAL_P(pcount)-- > 0) {
		zval *pobject, *pinf;
		zend_object *obj;
		spl_SplObjectStorageElement *pelement, element;

		pobject = var_tmp_var(&var_hash);
		if (!php_var_unserialize(pobject, &p, s + buf_len, &var_hash) || Z_TYPE_P(pobject) != IS_OBJECT) {
			goto outexcept;
		}

		obj = Z_OBJ_P(pobject);

		if (*p != ',') {
			goto outexcept;
		}
		++p;

		pinf = var_tmp_var(&var_hash);
		if (!php_var_unserialize(pinf, &p, s + buf_len, &var_hash)) {
			goto outexcept;
		}

		if (spl_object_storage_get_hash(&key, intern, obj) == FAILURE) {
			goto outexcept;
		}

		pelement = spl_object_storage_get(intern, &key);

		if (pelement) {
			zval_ptr_dtor(&pelement->inf);
			ZVAL_COPY(&pelement->inf, pinf);
		} else {
			element.obj = obj;
			GC_ADDREF(obj);
			ZVAL_COPY(&element.inf, pinf);
			if (key.key) {
				pelement = zend_hash_update_mem(&intern->storage, key.key, &element, sizeof(spl_SplObjectStorageElement));
			} else {
				pelement = zend_hash_index_update_mem(&intern->storage, key.h, &element, sizeof(spl_SplObjectStorageElement));
			}
		}
		spl_object_storage_free_hash(intern, &key);

		if (*p != ';') {
			goto outexcept;
		}
		++p;
	}