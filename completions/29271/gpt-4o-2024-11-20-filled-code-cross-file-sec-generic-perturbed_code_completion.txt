/* storage */
	s = p = (const unsigned char*)serialized_data_buffer;
	PHP_VAR_UNSERIALIZE_INIT(var_hash);

	if (*p != 'x' || *++p != ':') {
		goto outexcept;
	}
	++p;

	zval *zcount;
	zcount = var_tmp_var(&var_hash);
	if (!php_var_unserialize(zcount, &p, s + buf_len, &var_hash) || Z_TYPE_P(zcount) != IS_LONG) {
		goto outexcept;
	}

	zend_long count = Z_LVAL_P(zcount);
	if (count < 0) {
		goto outexcept;
	}

	while (count-- > 0) {
		zval *obj, *inf;

		if (*p != 'o' || *++p != ':') {
			goto outexcept;
		}
		++p;

		obj = var_tmp_var(&var_hash);
		if (!php_var_unserialize(obj, &p, s + buf_len, &var_hash) || Z_TYPE_P(obj) != IS_OBJECT) {
			goto outexcept;
		}

		if (*p == ';') {
			++p;
			ZVAL_UNDEF(&tmp);
			inf = &tmp;
		} else {
			inf = var_tmp_var(&var_hash);
			if (!php_var_unserialize(inf, &p, s + buf_len, &var_hash)) {
				goto outexcept;
			}
		}

		spl_SplObjectStorageElement *element = spl_object_storage_get(intern, obj, 1);
		if (element) {
			if (!Z_ISUNDEF(element->inf)) {
				zval_ptr_dtor(&element->inf);
			}
			ZVAL_COPY(&element->inf, inf);
		}
	}