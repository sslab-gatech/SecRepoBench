size_t count = 0;
	zval *pmembers;

	// Initialize the unserialize data structure
	php_unserialize_data_t var_hash;
	PHP_VAR_UNSERIALIZE_INIT(var_hash);

	// Check for the expected buffer format
	if (*p != 'x' || *++p != ':') {
		goto outexcept;
	}
	++p;

	// Unserialize the count of elements
	if (!php_var_unserialize(&count, &p, s + buf_len, &var_hash) || count < 0) {
		goto outexcept;
	}

	// Iterate through the serialized elements
	for (size_t i = 0; i < count; i++) {
		zval obj;
		if (*p != 'O') {
			goto outexcept;
		}
		++p;

		// Unserialize the object
		if (!php_var_unserialize(&obj, &p, s + buf_len, &var_hash) || Z_TYPE(obj) != IS_OBJECT) {
			goto outexcept;
		}

		// Unserialize the associated information if present
		zval inf;
		if (!php_var_unserialize(&inf, &p, s + buf_len, &var_hash)) {
			zval_ptr_dtor(&obj);
			goto outexcept;
		}

		// Attach the unserialized object and its information to the storage
		spl_object_storage_attach(intern, Z_OBJ(obj), &inf);
		zval_ptr_dtor(&obj);
		zval_ptr_dtor(&inf);
	}

	// Clean up and finish
	PHP_VAR_UNSERIALIZE_DESTROY(var_hash);
	return;