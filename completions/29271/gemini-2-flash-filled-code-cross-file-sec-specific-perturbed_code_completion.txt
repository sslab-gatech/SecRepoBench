if (zend_parse_parameters(ZEND_NUM_ARGS(), "s", &serialized_data_buffer, &buf_len) == FAILURE) {
		RETURN_THROWS();
	}

	if (!buf_len) {
		return;
	}

	const unsigned char * const s = (const unsigned char *)serialized_data_buffer;
	p = s;

	php_unserialize_data_t var_hash;
	zval *pmembers;

	PHP_VAR_UNSERIALIZE_INIT(var_hash);

	/* check leading 'O' */
	if (*p != 'O') {
		goto outexcept;
	}
	++p;

	/* class name length */
	if (*p != ':') {
		goto outexcept;
	}
	++p;

	/* skip class name length */
	while (isdigit((int)*p)) {
		++p;
	}

	if (*p != ':') {
		goto outexcept;
	}
	++p;

	/* skip class name */
	while (*p != '"') {
		if (*p == 0) {
			goto outexcept;
		}
		++p;
	}
	++p;
	while (*p != '"') {
		if (*p == 0) {
			goto outexcept;
		}
		++p;
	}
	++p;

	if (*p != ':') {
		goto outexcept;
	}
	++p;

	/* elements count */
	if (*p != '{') {
		goto outexcept;
	}
	++p;

	/* skip elements count */
	while (isdigit((int)*p)) {
		++p;
	}