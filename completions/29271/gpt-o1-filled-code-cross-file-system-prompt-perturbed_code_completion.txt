{
	zval *zcount, *zobj, *zinf;
	zend_long i, count;

	/* Expect an integer count of stored objects */
	if (*p != 'i' || *++p != ':') {
		goto outexcept;
	}
	++p;

	zcount = var_tmp_var(&var_hash);
	if (!php_var_unserialize(zcount, &p, s + buf_len, &var_hash) || Z_TYPE_P(zcount) != IS_LONG) {
		goto outexcept;
	}
	count = Z_LVAL_P(zcount);

	if (*p != ';') {
		goto outexcept;
	}
	++p;

	/* Unserialize each stored object and its associated info */
	for (i = 0; i < count; i++) {
		zobj = var_tmp_var(&var_hash);
		if (!php_var_unserialize(zobj, &p, s + buf_len, &var_hash) || Z_TYPE_P(zobj) != IS_OBJECT) {
			goto outexcept;
		}

		zinf = var_tmp_var(&var_hash);
		if (!php_var_unserialize(zinf, &p, s + buf_len, &var_hash)) {
			goto outexcept;
		}

		/* Associate object and info with our internal storage */
		{
			spl_SplObjectStorageElement *element;
			element = spl_object_storage_get(intern, Z_OBJ_P(zobj), 1);
			ZVAL_COPY(&element->inf, zinf);
		}
	}
}