{
	zval *num;
	zend_long count, i;

	num = var_tmp_var(&var_hash);
	if (!php_var_unserialize(num, &p, s + buf_len, &var_hash) || Z_TYPE_P(num) != IS_LONG) {
		goto outexcept;
	}
	count = Z_LVAL_P(num);
	for (i = 0; i < count; i++) {
		zval *obj, *inf = NULL;

		obj = var_tmp_var(&var_hash);
		if (!php_var_unserialize(obj, &p, s + buf_len, &var_hash) || Z_TYPE_P(obj) != IS_OBJECT) {
			goto outexcept;
		}

		/* Check if additional information is present.
		   Its presence is signaled by a ':' delimiter. */
		if (*p == ':') {
			++p;
			inf = var_tmp_var(&var_hash);
			if (!php_var_unserialize(inf, &p, s + buf_len, &var_hash)) {
				goto outexcept;
			}
		}
		spl_object_storage_attach(intern, Z_OBJ_P(obj), inf);
	}
}