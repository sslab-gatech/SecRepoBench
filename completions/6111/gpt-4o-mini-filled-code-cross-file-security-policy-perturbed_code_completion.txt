// Initialize a linked list to store image profiles
  ImageProfile *profile_list = NULL;
  size_t profile_count = 0;

  // Read profiles from the Postscript file
  while (fgets(buffer, sizeof(buffer), file) != NULL)
  {
    if (strstr(buffer, ICCProfile) != NULL)
    {
      // Allocate memory for a new profile
      ImageProfile *new_profile = (ImageProfile *)malloc(sizeof(ImageProfile));
      if (new_profile == NULL)
      {
        // Handle memory allocation failure
        ThrowException(exception, ResourceLimitError, "MemoryAllocationFailed", NULL);
        return NULL;
      }

      // Read the profile data and validate its size
      size_t data_size = ReadProfileData(file, new_profile->data, sizeof(new_profile->data));
      if (data_size > sizeof(new_profile->data))
      {
        // Handle buffer overflow risk
        free(new_profile);
        ThrowException(exception, ResourceLimitError, "ProfileDataTooLarge", NULL);
        return NULL;
      }

      // Add the new profile to the linked list
      new_profile->next = profile_list;
      profile_list = new_profile;
      profile_count++;
    }
  }

  // Process the profiles as needed
  ProcessImageProfiles(postscript_image, profile_list);

  // Clean up the linked list
  while (profile_list != NULL)
  {
    ImageProfile *temp = profile_list;
    profile_list = profile_list->next;
    free(temp);
  }