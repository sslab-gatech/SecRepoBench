// <MASK>
  // Ensure the input filename is not too long to prevent buffer overflow
  if (strlen(image_info->filename) >= MagickPathExtent)
  {
    (void) ThrowMagickException(exception,GetMagickModule(),OptionError,
      "FilenameTooLong","`%s'",image_info->filename);
    return((Image *) NULL);
  }

  // Safely copy the input filename to the local variable
  (void) CopyMagickString(input_filename, image_info->filename, MagickPathExtent);

  // Open the input file securely
  filedescriptor = open(input_filename, O_RDONLY);
  if (filedescriptor == -1)
  {
    (void) ThrowMagickException(exception, GetMagickModule(), FileOpenError,
      "UnableToOpenFile", "`%s'", input_filename);
    return((Image *) NULL);
  }

  // Create a temporary file for processing
  if (AcquireUniqueFilename(filename) == MagickFalse)
  {
    (void) ThrowMagickException(exception, GetMagickModule(), FileOpenError,
      "UnableToCreateTemporaryFile", "`%s'", filename);
    (void) close(filedescriptor);
    return((Image *) NULL);
  }

  // Safely copy the input file to the temporary file
  {
    ssize_t bytes_read, bytes_written;
    char buffer[MagickPathExtent];
    int temp_file = open(filename, O_WRONLY | O_CREAT | O_TRUNC, S_IRUSR | S_IWUSR);
    if (temp_file == -1)
    {
      (void) ThrowMagickException(exception, GetMagickModule(), FileOpenError,
        "UnableToCreateTemporaryFile", "`%s'", filename);
      (void) close(filedescriptor);
      return((Image *) NULL);
    }

    while ((bytes_read = read(filedescriptor, buffer, sizeof(buffer))) > 0)
    {
      bytes_written = write(temp_file, buffer, (size_t) bytes_read);
      if (bytes_written != bytes_read)
      {
        (void) ThrowMagickException(exception, GetMagickModule(), FileWriteError,
          "UnableToWriteTemporaryFile", "`%s'", filename);
        (void) close(filedescriptor);
        (void) close(temp_file);
        return((Image *) NULL);
      }
    }

    (void) close(temp_file);
  }

  (void) close(filedescriptor);

  // Initialize the ImageInfo structure for reading the Postscript image
  read_info = CloneImageInfo(image_info);
  (void) CopyMagickString(read_info->filename, filename, MagickPathExtent);

  // Read the Postscript image using the delegate
  postscript_image = ReadImage(read_info, exception);
  read_info = DestroyImageInfo(read_info);

  if (postscript_image == (Image *) NULL)
  {
    (void) ThrowMagickException(exception, GetMagickModule(), DelegateError,
      "UnableToReadPostscriptImage", "`%s'", filename);
    return((Image *) NULL);
  }

  // Clean up the temporary file
  (void) RelinquishUniqueFileResource(filename);