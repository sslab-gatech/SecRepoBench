// Create a linked list to store profiles and prevent buffer overflow
LinkedListInfo *profiles = CreateLinkedList(0, 0, 0, 0);

// Initialize variables to track the current profile and its size
ProfileInfo *current_profile = (ProfileInfo *) NULL;
size_t current_profile_size = 0;

// Iterate over the image list and process each image
for (next = GetFirstImageInList(postscript_image); next!= (Image *) NULL; next = GetNextImageInList(next))
{
    // Check if the image has a profile
    if (next->profile!= (void *) NULL)
    {
        // Get the profile size
        size_t profile_size = GetBlobSize(next->profile);

        // Check if the profile size exceeds the current buffer capacity
        if (profile_size > current_profile_size)
        {
            // If necessary, dynamically expand the buffer to accommodate the profile
            if (current_profile!= (ProfileInfo *) NULL)
            {
                current_profile = (ProfileInfo *) ResizeQuantumMemory(current_profile, profile_size);
                if (current_profile == (ProfileInfo *) NULL)
                {
                    // Handle memory allocation error
                }
            }
            else
            {
                current_profile = (ProfileInfo *) AcquireQuantumMemory(profile_size, sizeof(*current_profile));
                if (current_profile == (ProfileInfo *) NULL)
                {
                    // Handle memory allocation error
                }
            }

            // Update the current profile size
            current_profile_size = profile_size;
        }

        // Copy the profile to the buffer
        (void) CopyMagickMemory(current_profile, next->profile, profile_size);

        // Add the profile to the linked list
        (void) InsertValueInLinkedList(profiles, current_profile);
    }
}

// Clean up
if (current_profile!= (ProfileInfo *) NULL)
{
    current_profile = (ProfileInfo *) RelinquishMagickMemory(current_profile);
}
profiles = DestroyLinkedList(profiles);