Image
    *image,
    *next,
    *postscript_image;

  MagickBooleanType
    status;

  MagickOffsetType
    scene;

  size_t
    columns,
    rows;

  RectangleInfo
    page;

  /*
    Open image file.
  */
  assert(image_info != (const ImageInfo *) NULL);
  assert(image_info->signature == MagickCoreSignature);
  assert(exception != (ExceptionInfo *) NULL);
  assert(exception->signature == MagickCoreSignature);
  image=AcquireImage(image_info,exception);
  status=OpenBlob(image_info,image,ReadBinaryBlobMode,exception);
  if (status == MagickFalse)
    {
      image=DestroyImageList(image);
      return((Image *) NULL);
    }
  (void) CopyMagickString(input_filename,image->filename,MagickPathExtent);
  filedescriptor=AcquireUniqueFileResource(postscript_filename);
  if (filedescriptor == -1)
    {
      ThrowFileException(exception,FileOpenError,"UnableToCreateTemporaryFile",
        postscript_filename);
      image=DestroyImageList(image);
      return((Image *) NULL);
    }
  (void) WriteBlobStringWithFileDescriptor(filedescriptor,"%!PS-Adobe-3.0\n");
  (void) WriteBlobStringWithFileDescriptor(filedescriptor,"%%BoundingBox: 0 0 612 792\n");
  (void) WriteBlobStringWithFileDescriptor(filedescriptor,"%%Pages: 1\n");
  (void) WriteBlobStringWithFileDescriptor(filedescriptor,"%%EndComments\n");
  (void) WriteBlobStringWithFileDescriptor(filedescriptor,"%%BeginProlog\n");
  (void) WriteBlobStringWithFileDescriptor(filedescriptor,"%%EndProlog\n");
  (void) WriteBlobStringWithFileDescriptor(filedescriptor,"%%Page: 1 1\n");
  (void) WriteBlobStringWithFileDescriptor(filedescriptor,"%%BeginPageSetup\n");
  (void) WriteBlobStringWithFileDescriptor(filedescriptor,"%%EndPageSetup\n");
  (void) WriteBlobStringWithFileDescriptor(filedescriptor,"%%Trailer\n");
  (void) WriteBlobStringWithFileDescriptor(filedescriptor,"%%EOF\n");
  (void) close(filedescriptor);

  /*
    Render Postscript with Ghostscript.
  */
  columns=0;
  rows=0;
  page.width=0;
  page.height=0;
  page.x=0;
  page.y=0;
  read_info=CloneImageInfo(image_info);
  (void) CopyMagickString(read_info->filename,postscript_filename,
    MagickPathExtent);
  (void) CopyMagickString(command,"gs",MagickPathExtent);
  option=GetImageOption(image_info,"ps:use-cropbox");
  if (IsStringTrue(option) != MagickFalse)
    (void) ConcatenateMagickString(command," -dUseCropBox",MagickPathExtent);
  density=GetImageOption(image_info,"density");
  if (density == (const char *) NULL)
    density=PSDensityGeometry;
  (void) FormatLocaleString(geometry,MagickPathExtent,"-g%.20gx%.20g",
    (double) page.width,(double) page.height);
  (void) FormatLocaleString(command+strlen(command),MagickPathExtent,
    " -q -dSAFER -dBATCH -dNOPAUSE -dNOPROMPT -dMaxBitmap=500000000 "
    "-dAlignToPixels=0 -dGridFitTT=0 -sDEVICE=pnmraw -dTextAlphaBits=4 "
    "-dGraphicsAlphaBits=4 -r%s -sOutputFile=%%stdout %s -c quit",
    density,geometry);
  status=InvokePostscriptDelegate(MagickFalse,command,message,exception);
  if (status == MagickFalse)
    {
      (void) RelinquishUniqueFileResource(postscript_filename);
      image=DestroyImageList(image);
      return((Image *) NULL);
    }
  postscript_image=ReadPNMImage(read_info,exception);
  (void) RelinquishUniqueFileResource(postscript_filename);
  read_info=DestroyImageInfo(read_info);
  if (postscript_image == (Image *) NULL)
    {
      image=DestroyImageList(image);
      return((Image *) NULL);
    }