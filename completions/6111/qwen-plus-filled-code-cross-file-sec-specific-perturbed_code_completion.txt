// Allocate memory for the input_filename and ensure it's within safe bounds
if (strlen(image_info->filename) >= MagickPathExtent)
{
  ThrowReaderException(CorruptImageError, "Input filename too long");
}
 strncpy(input_filename, image_info->filename, MagickPathExtent - 1);
 input_filename[MagickPathExtent - 1] = '\0';

 // Open the input file descriptor securely
 filedescriptor = AcquireUniqueFileResource(postscript_filename);
 if (filedescriptor == -1)
 {
   ThrowReaderException(ResourceLimitError, "Unable to create temporary postscript file");
 }

 // Create symbolic link safely
 if (symlink(input_filename, postscript_filename) < 0)
 {
   (void) CloseFile(filedescriptor);
   ThrowReaderException(CorruptImageError, "Failed to create symbolic link");
 }

 // Initialize hex character mapping safely
 unsigned char hex_map[256];
 for (int i = 0; i < 256; ++i)
 {
   hex_map[i] = 255; // Invalid by default
 }
 for (int i = '0'; i <= '9'; ++i)
 {
   hex_map[i] = i - '0';
 }
 for (int i = 'A'; i <= 'F'; ++i)
 {
   hex_map[i] = i - 'A' + 10;
 }
 for (int i = 'a'; i <= 'f'; ++i)
 {
   hex_map[i] = i - 'a' + 10;
 }

 // Set page density with secure bounds checking
 density = GetImageOption(image_info, "density");
 if (density != NULL && strlen(density) >= MagickPathExtent)
 {
   ThrowReaderException(CorruptImageError, "Density value too long");
 }

 // Determine page geometry safely
 option = GetImageOption(image_info, "page");
 if (option != NULL && strlen(option) >= MagickPathExtent)
 {
   ThrowReaderException(CorruptImageError, "Page option value too long");
 }
 else if (option != NULL)
 {
   if (!ParseGeometry(option, &geometry_info))
   {
     ThrowReaderException(CorruptImageError, "Invalid page geometry");
   }
 }

 // Ghostscript control file rendering setup
 snprintf(command, MagickPathExtent, "gs -dQUIET -dSAFER -dBATCH -dNOPAUSE "
   "-sDEVICE=%s -r%.20g -g%lux%lu -sOutputFile=\"-\" \"%s\"",
   delegate_info->decode_name, resolution, (unsigned long) columns,
   (unsigned long) rows, postscript_filename);

 // Execute Ghostscript delegate command securely
 postscript_image = ReadImages(read_info, "png:-", exception);
 if (postscript_image == (Image *) NULL)
 {
   ThrowReaderException(CorruptImageError, "Ghostscript failed to render image");
 }

 // Cleanup resources
 (void) RelinquishUniqueFileResource(postscript_filename);