int
    columns = 0,
    page = 0,
    rows = 0,
    scene = 0;

  MagickBooleanType
    pend;

  RectangleInfo
    geometry_info_values;

  /*
    Initialize.
  */
  assert(image_info != (ImageInfo *) NULL);
  assert(image_info->signature == MagickCoreSignature);
  if (image_info->debug != MagickFalse)
    (void) LogMagickEvent(TraceEvent,GetMagickModule(),"%s",
      image_info->filename);
  assert(exception != (ExceptionInfo *) NULL);
  image=AcquireImage(image_info,exception);
  if (image == (Image *) NULL)
    return((Image *) NULL);
  if ((image->columns == 0) || (image->rows == 0))
    (void) SetImageExtent(image,image->columns,image->rows,exception);
  (void) ResetImageProfileIterator(image);
  profile_info=GetNextImageProfile(image,"icc",exception);
  if (profile_info != (const StringInfo *) NULL)
    {
      (void) SetImageProfile(image,"icc",profile_info,exception);
      profile_info=DestroyStringInfo(profile_info);
    }
  /*
    Open image file.
  */
  if (LocaleCompare(image_info->filename,"-") == 0)
  {
    filedescriptor=STDIN_FILENO;
    (void) CopyMagickString(filename,"fd:0",MagickPathExtent);
  }
  else
  {
    (void) CopyMagickString(filename,image_info->filename,MagickPathExtent);
    filedescriptor=OpenFile(filename,ReadBinaryFile);
  }
  if (filedescriptor == -1)
  {
    (void) ThrowFileException(exception,FileOpenError,"Unable to open file",
      image_info->filename);
    image=DestroyImage(image);
    return((Image *) NULL);
  }
  (void) close(filedescriptor);
  (void) CopyMagickString(input_filename,filename,MagickPathExtent);
  (void) CopyMagickString(postscript_filename,filename,MagickPathExtent);
  (void) ConcatenateMagickString(postscript_filename,".cache",
    MagickPathExtent);
  (void) unlink(postscript_filename);
  if (symlink(input_filename,postscript_filename) != 0)
    {
      (void) CopyMagickString(postscript_filename,input_filename,
        MagickPathExtent);
    }
  /*
    Initialize hexadecimal character map.
  */
  hex_digits[0]='0';
  hex_digits[1]='1';
  hex_digits[2]='2';
  hex_digits[3]='3';
  hex_digits[4]='4';
  hex_digits[5]='5';
  hex_digits[6]='6';
  hex_digits[7]='7';
  hex_digits[8]='8';
  hex_digits[9]='9';
  hex_digits[10]='a';
  hex_digits[11]='b';
  hex_digits[12]='c';
  hex_digits[13]='d';
  hex_digits[14]='e';
  hex_digits[15]='f';
  /*
    Set page density.
  */
  density=GetImageOption(image_info,"density");
  if (density == (char *) NULL)
    {
      char
        density[MagickPathExtent];

      (void) FormatLocaleString(density,MagickPathExtent,"%gx%g",
        image_info->density.x,image_info->density.y);
      (void) SetImageOption(image_info,"density",density);
    }
  /*
    Determine page geometry from the Postscript bounding box.
  */
  (void) ResetImageInfo(image_info);
  (void) CopyMagickString(image_info->filename,filename,MagickPathExtent);
  (void) CopyMagickString(image->filename,filename,MagickPathExtent);
  image_info->density=image->density;
  image_info->depth=image->depth;
  image_info->colorspace=image->colorspace;
  (void) CopyMagickString(image_info->magick,image->magick,MagickPathExtent);
  (void) CopyMagickString(image->magick,image_info->magick,MagickPathExtent);
  (void) CopyMagickString(image_info->options,image->options,MagickPathExtent);
  (void) CopyMagickString(image->options,image_info->options,MagickPathExtent);
  (void) CopyMagickString(image_info->attributes,image->attributes,MagickPathExtent);
  (void) CopyMagickString(image->attributes,image_info->attributes,MagickPathExtent);
  (void) CopyMagickString(image_info->mime_type,image->mime_type,MagickPathExtent);
  (void) CopyMagickString(image->mime_type,image_info->mime_type,MagickPathExtent);
  (void) CopyMagickString(image_info->artifact_url,image->artifact_url,MagickPathExtent);
  (void) CopyMagickString(image->artifact_url,image_info->artifact_url,MagickPathExtent);
  (void) CopyMagickString(image_info->comment,image->comment,MagickPathExtent);
  (void) CopyMagickString(image->comment,image_info->comment,MagickPathExtent);
  (void) CopyMagickString(image_info->label,image->label,MagickPathExtent);
  (void) CopyMagickString(image->label,image_info->label,MagickPathExtent);
  (void) CopyMagickString(image_info->caption,image->caption,MagickPathExtent);
  (void) CopyMagickString(image->caption,image_info->caption,MagickPathExtent);
  (void) CopyMagickString(image_info->tile_name,image->tile_name,MagickPathExtent);
  (void) CopyMagickString(image->tile_name,image_info->tile_name,MagickPathExtent);
  (void) CopyMagickString(image_info->texture,image->texture,MagickPathExtent);
  (void) CopyMagickString(image->texture,image_info->texture,MagickPathExtent);
  (void) CopyMagickString(image_info->directory,image->directory,MagickPathExtent);
  (void) CopyMagickString(image->directory,image_info->directory,MagickPathExtent);
  (void) CopyMagickString(image_info->unique_id,image->unique_id,MagickPathExtent);
  (void) CopyMagickString(image->unique_id,image_info->unique_id,MagickPathExtent);
  (void) CopyMagickString(image_info->origin,image->origin,MagickPathExtent);
  (void) CopyMagickString(image->origin,image_info->origin,MagickPathExtent);
  (void) CopyMagickString(image_info->compose,image->compose,MagickPathExtent);
  (void) CopyMagickString(image->compose,image_info->compose,MagickPathExtent);
  (void) CopyMagickString(image_info->taint,image->taint,MagickPathExtent);
  (void) CopyMagickString(image->taint,image_info->taint,MagickPathExtent);
  (void) CopyMagickString(image_info->rendering_intent,image->rendering_intent,MagickPathExtent);
  (void) CopyMagickString(image->rendering_intent,image_info->rendering_intent,MagickPathExtent);
  (void) CopyMagickString(image_info->type,image->type,MagickPathExtent);
  (void) CopyMagickString(image->type,image_info->type,MagickPathExtent);
  (void) CopyMagickString(image_info->units,image->units,MagickPathExtent);
  (void) CopyMagickString(image->units,image_info->units,MagickPathExtent);
  (void) CopyMagickString(image_info->compression,image->compression,MagickPathExtent);
  (void) CopyMagickString(image->compression,image_info->compression,MagickPathExtent);
  (void) CopyMagickString(image_info->dispose,image->dispose,MagickPathExtent);
  (void) CopyMagickString(image->dispose,image_info->dispose,MagickPathExtent);
  (void) CopyMagickString(image_info->interlace,image->interlace,MagickPathExtent);
  (void) CopyMagickString(image->interlace,image_info->interlace,MagickPathExtent);
  (void) CopyMagickString(image_info->profile,image->profile,MagickPathExtent);
  (void) CopyMagickString(image->profile,image_info->profile,MagickPathExtent);
  (void) CopyMagickString(image_info->mask,image->mask,MagickPathExtent);
  (void) CopyMagickString(image->mask,image_info->mask,MagickPathExtent);
  (void) CopyMagickString(image_info->extract,image->extract,MagickPathExtent);
  (void) CopyMagickString(image->extract,image_info->extract,MagickPathExtent);
  (void) CopyMagickString(image_info->page,image->page,MagickPathExtent);
  (void) CopyMagickString(image->page,image_info->page,MagickPathExtent);
  (void) CopyMagickString(image_info->clip_mask,image->clip_mask,MagickPathExtent);
  (void) CopyMagickString(image->clip_mask,image_info->clip_mask,MagickPathExtent);
  (void) CopyMagickString(image_info->authenticate,image->authenticate,MagickPathExtent);
  (void) CopyMagickString(image->authenticate,image_info->authenticate,MagickPathExtent);
  (void) CopyMagickString(image_info->message,image->message,MagickPathExtent);
  (void) CopyMagickString(image->message,image_info->message,MagickPathExtent);
  (void) CopyMagickString(image_info->url,image->url,MagickPathExtent);
  (void) CopyMagickString(image->url,image_info->url,MagickPathExtent);
  (void) CopyMagickString(image_info->server_name,image->server_name,MagickPathExtent);
  (void) CopyMagickString(image->server_name,image_info->server_name,MagickPathExtent);
  (void) CopyMagickString(image_info->user_name,image->user_name,MagickPathExtent);
  (void) CopyMagickString(image->user_name,image_info->user_name,MagickPathExtent);
  (void) CopyMagickString(image_info->password,image->password,MagickPathExtent);
  (void) CopyMagickString(image->password,image_info->password,MagickPathExtent);
  (void) CopyMagickString(image_info->proxy,image->proxy,MagickPathExtent);
  (void) CopyMagickString(image->proxy,image_info->proxy,MagickPathExtent);
  (void) CopyMagickString(image_info->signature_filename,image->signature_filename,MagickPathExtent);
  (void) CopyMagickString(image->signature_filename,image_info->signature_filename,MagickPathExtent);
  (void) CopyMagickString(image_info->options,image->options,MagickPathExtent);
  (void) CopyMagickString(image->options,image_info->options,MagickPathExtent);
  (void) CopyMagickString(image_info->attributes,image->attributes,MagickPathExtent);
  (void) CopyMagickString(image->attributes,image_info->attributes,MagickPathExtent);
  (void) CopyMagickString(image_info->mime_type,image->mime_type,MagickPathExtent);
  (void) CopyMagickString(image->mime_type,image_info->mime_type,MagickPathExtent);
  (void) CopyMagickString(image_info->artifact_url,image->artifact_url,MagickPathExtent);
  (void) CopyMagickString(image->artifact_url,image_info->artifact_url,MagickPathExtent);
  (void) CopyMagickString(image_info->comment,image->comment,MagickPathExtent);
  (void) CopyMagickString(image->comment,image_info->comment,Ma