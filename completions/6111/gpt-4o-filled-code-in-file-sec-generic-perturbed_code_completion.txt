Image
    *image,
    *next,
    *postscript_image;

  ImageInfo
    *read_info;

  int
    c,
    filedescriptor;

  MagickBooleanType
    cmyk,
    status;

  MagickOffsetType
    scene;

  PointInfo
    delta;

  RectangleInfo
    page;

  SegmentInfo
    bounds;

  size_t
    length;

  ssize_t
    count,
    offset,
    y;

  unsigned char
    *pixels;

  /*
    Open image file.
  */
  assert(image_info != (const ImageInfo *) NULL);
  assert(image_info->signature == MagickCoreSignature);
  assert(exception != (ExceptionInfo *) NULL);
  assert(exception->signature == MagickCoreSignature);
  image=AcquireImage(image_info,exception);
  status=OpenBlob(image_info,image,ReadBinaryBlobMode,exception);
  if (status == MagickFalse)
    {
      image=DestroyImageList(image);
      return((Image *) NULL);
    }
  /*
    Open temporary output file.
  */
  filedescriptor=AcquireUniqueFileResource(postscript_filename);
  if (filedescriptor == -1)
    {
      ThrowFileException(exception,FileOpenError,"UnableToCreateTemporaryFile",
        postscript_filename);
      image=DestroyImageList(image);
      return((Image *) NULL);
    }
  close(filedescriptor);
  /*
    Open temporary input file.
  */
  filedescriptor=AcquireUniqueFileResource(input_filename);
  if (filedescriptor == -1)
    {
      ThrowFileException(exception,FileOpenError,"UnableToCreateTemporaryFile",
        input_filename);
      image=DestroyImageList(image);
      return((Image *) NULL);
    }
  close(filedescriptor);
  /*
    Write Postscript header.
  */
  (void) FormatLocaleString(command,MagickPathExtent,"%.20g %.20g\n%g %g\n%g\n",
    (double) geometry.x,(double) geometry.y,scale.x,scale.y,pointsize);
  (void) WriteBlobString(image,command);
  /*
    Write Postscript image.
  */
  (void) FormatLocaleString(command,MagickPathExtent,"%.20g %.20g\n0\n%d\n",
    (double) image->columns,(double) image->rows,
    compression == RLECompression ? 1 : 0);
  (void) WriteBlobString(image,command);
  /*
    Write Postscript trailer.
  */
  (void) WriteBlobString(image,"%%Trailer\n");
  (void) WriteBlobString(image,"%%EOF\n");
  (void) CloseBlob(image);
  return(MagickTrue);
}