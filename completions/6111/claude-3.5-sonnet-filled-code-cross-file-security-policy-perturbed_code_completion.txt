Image
  *image,
  *next,
  *postscript_image;

char
  *options,
  postscript_filename[MagickPathExtent];

const DelegateInfo
  *delegate_info;

GeometryInfo
  geometry_info;

ImageInfo
  *read_info;

MagickBooleanType
  status;

PointInfo
  delta;

RectangleInfo
  page;

ssize_t
  columns,
  rows,
  scene;

// Initialize variables
image=AcquireImage(image_info,exception);
read_info=CloneImageInfo(image_info);
options=InterpretImageProperties((ImageInfo *) NULL,image,image_info->filename,
  exception);
if (options == (char *) NULL)
  ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");

// Create a temporary file for processing
status=AcquireUniqueSymbolicLink(image_info->filename,input_filename);
if (status == MagickFalse)
  ThrowFileException(exception,FileOpenError,"UnableToCreateTemporaryFile",
    image_info->filename);

// Set up Ghostscript delegate
delegate_info=GetDelegateInfo("ps:alpha",(char *) NULL,exception);
if (delegate_info == (const DelegateInfo *) NULL)
  {
    (void) RelinquishUniqueFileResource(input_filename);
    image=DestroyImage(image);
    return((Image *) NULL);
  }

// Process the Postscript file
(void) FormatLocaleString(command,MagickPathExtent,
  GetDelegateCommands(delegate_info),
  read_info->antialias != MagickFalse ? 4 : 1,
  read_info->antialias != MagickFalse ? 4 : 1,
  density,read_info->monochrome != MagickFalse ? "bitcmyk" : "cmyk",
  options,input_filename,postscript_filename);

status=InvokeDelegate(read_info,image,command,exception);
(void) RelinquishUniqueFileResource(input_filename);
(void) RelinquishUniqueFileResource(postscript_filename);
options=DestroyString(options);
if (status == MagickFalse)
  {
    image=DestroyImage(image);
    return((Image *) NULL);
  }

// Read the processed image
(void) FormatLocaleString(filename,MagickPathExtent,"%s.miff",
  postscript_filename);
(void) CopyMagickString(read_info->filename,filename,MagickPathExtent);
postscript_image=ReadImage(read_info,exception);
if (postscript_image == (Image *) NULL)
  {
    image=DestroyImage(image);
    return((Image *) NULL);
  }

(void) RelinquishUniqueFileResource(filename);
(void) RelinquishUniqueFileResource(postscript_filename);