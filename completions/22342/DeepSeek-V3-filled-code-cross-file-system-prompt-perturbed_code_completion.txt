{
    if(packet->payload_packet_len < 4)
      return;

    /* Check TPKT header */
    if((packet->payload[0] == 0x03) && (packet->payload[1] == 0x00)) {
      u_int16_t len = ntohs(*(u_int16_t*)&packet->payload[2]);

      if(len == packet->payload_packet_len) {
	/* H.323 */
	if((packet->payload[4] == 0x08) && (packet->payload[5] == 0x00)) {
	  NDPI_LOG_INFO(ndpi_struct, "found H.323 broadcast\n");
	  ndpi_set_detected_protocol(ndpi_struct, stream, NDPI_PROTOCOL_H323, NDPI_PROTOCOL_UNKNOWN);
	  return;
	}
      }
    }

    if(packet->udp != NULL) {
      sport = ntohs(packet->udp->source), dport = ntohs(packet->udp->dest);

      if((packet->payload_packet_len >= 4) &&
	 ((sport == 1719) || (dport == 1719) || (sport == 1720) || (dport == 1720))) {
	if((packet->payload[0] == 0x16) && (packet->payload[1] == 0x80)) {
	  NDPI_LOG_INFO(ndpi_struct, "found H.323\n");
	  ndpi_set_detected_protocol(ndpi_struct, stream, NDPI_PROTOCOL_H323, NDPI_PROTOCOL_UNKNOWN);
	  return;
	}
      }
    }

    NDPI_EXCLUDE_PROTO(ndpi_struct, stream);
}