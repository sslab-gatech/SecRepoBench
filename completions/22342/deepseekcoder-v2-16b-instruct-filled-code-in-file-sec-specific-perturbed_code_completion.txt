if((packet->tcp != NULL) && (packet->tcp->dest != ntohs(102))) {
    u_int8_t *packet_data = packet->payload;
    u_int16_t packet_len = packet->payload_packet_len;

    if (packet_len >= sizeof(struct tpkt)) {
      struct tpkt *tpkt_header = (struct tpkt *)packet_data;

      if (tpkt_header->version == 3 && tpkt_header->reserved == 0) {
        u_int16_t tpkt_len = ntohs(tpkt_header->len);

        if (tpkt_len >= sizeof(struct tpkt) && tpkt_len <= packet_len) {
          u_int8_t *payload = packet_data + sizeof(struct tpkt);
          u_int16_t payload_len = packet_len - sizeof(struct tpkt);

          // Check for specific H.323 payload patterns
          if (payload_len >= 12 && payload[0] == 0x00 && payload[1] == 0x00 && payload[2] == 0x00) {
            NDPI_LOG_INFO(ndpi_struct, "Detected H.323 protocol\n");
            stream->detected_protocol = NDPI_PROTOCOL_H323;
            return;
          }
        }
      }
    }
  }