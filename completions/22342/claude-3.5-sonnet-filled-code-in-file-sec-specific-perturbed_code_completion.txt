{
    if(packet->payload_packet_len >= sizeof(struct tpkt)) {
      struct tpkt *t = (struct tpkt*)packet->payload;
      u_int16_t len = ntohs(t->len);

      if((len == packet->payload_packet_len) && (t->version == 3)) {
        if((packet->payload[4] == 0x08) && (packet->payload[5] == 0x02)) {
          NDPI_LOG_INFO(ndpi_struct, "found H323 broadcast\n");
          ndpi_set_detected_protocol(ndpi_struct, stream, NDPI_PROTOCOL_H323, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI);
          return;
        } else if(packet->payload[4] != 0x03) {
          NDPI_LOG_DBG(ndpi_struct, "found H323\n");
          ndpi_set_detected_protocol(ndpi_struct, stream, NDPI_PROTOCOL_H323, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI);
          return;
        }
      }
    }
  }

  if(packet->udp != NULL) {
    sport = ntohs(packet->udp->source), dport = ntohs(packet->udp->dest);

    if((packet->payload_packet_len >= 6)
       && ((packet->payload[0] == 0x80) || (packet->payload[0] == 0x81))
       && (packet->payload[1] == 0x08)
       && (packet->payload[2] == 0xe7)
       && (packet->payload[4] == 0x00)
       && (packet->payload[5] == 0x00)) {
      NDPI_LOG_INFO(ndpi_struct, "found H323 broadcast\n");
      ndpi_set_detected_protocol(ndpi_struct, stream, NDPI_PROTOCOL_H323, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI);
      return;
    }
  }

  NDPI_EXCLUDE_PROTO(ndpi_struct, stream);