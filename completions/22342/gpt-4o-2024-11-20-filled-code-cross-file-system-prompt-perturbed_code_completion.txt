{
    u_int16_t len;

    if(packet->payload_packet_len < 4) return;

    len = ntohs(get_u_int16_t(packet->payload, 2));

    if((packet->payload[0] == 0x03) && (packet->payload[1] == 0x00) &&
       (len == (packet->payload_packet_len - 4))) {
      if((packet->payload[4] == 0x08) && (packet->payload[5] == 0x02)) {
        NDPI_LOG_INFO(ndpi_struct, "found H323\n");
        ndpi_set_detected_protocol(ndpi_struct, stream, NDPI_PROTOCOL_H323, NDPI_PROTOCOL_UNKNOWN);
        return;
      } else if((packet->payload[4] == 0x03) && (packet->payload[5] == 0x00)) {
        NDPI_LOG_INFO(ndpi_struct, "found RDP\n");
        ndpi_set_detected_protocol(ndpi_struct, stream, NDPI_PROTOCOL_RDP, NDPI_PROTOCOL_UNKNOWN);
        return;
      }
    }

    if(packet->udp != NULL) {
      dport = ntohs(packet->udp->dest);
      sport = ntohs(packet->udp->source);

      if((packet->payload_packet_len > 12) &&
         (packet->payload[0] == 0x00) && (packet->payload[1] == 0x01) &&
         (packet->payload[2] == 0x00) && (packet->payload[3] == 0x04)) {
        NDPI_LOG_INFO(ndpi_struct, "found H323 broadcast\n");
        ndpi_set_detected_protocol(ndpi_struct, stream, NDPI_PROTOCOL_H323, NDPI_PROTOCOL_UNKNOWN);
        return;
      }
    }

    NDPI_EXCLUDE_PROTO(ndpi_struct, stream);
  }