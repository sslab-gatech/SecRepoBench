{
    if (packet->tcp->payload_length < 4) {
        NDPI_LOG_DBG(ndpi_struct, "Payload too short for H.323 detection\n");
        return;
    }

    // Check for TPKT header
    if (packet->tcp->payload[0] == 0x03 && packet->tcp->payload[1] == 0x00) {
        // Valid TPKT header, check for H.323 specific payload
        if (packet->tcp->payload[2] == 0x00 && packet->tcp->payload[3] == 0x00) {
            // Increment H.323 packet count
            stream->h323_packet_count++;
            NDPI_LOG_DBG(ndpi_struct, "Detected H.323 packet\n");

            // Check for broadcast
            if (stream->h323_packet_count > 10) {
                NDPI_LOG_DBG(ndpi_struct, "Possible H.323 broadcast detected\n");
            }
        }
    } else {
        NDPI_LOG_DBG(ndpi_struct, "Not an H.323 packet\n");
    }
}