{
    // Check if the packet is using TCP
    if (packet->tcp != NULL) {
        // Get source and destination ports
        sport = ntohs(packet->tcp->source);
        dport = ntohs(packet->tcp->dest);

        // Check if the payload length is sufficient for TPKT
        if (packet->payload_packet_length >= 4) {
            // Check for TPKT header
            if (packet->payload[0] == 0x03 && packet->payload[1] == 0x00) {
                // Check for H.323 specific payload
                if (packet->payload[2] == 0x00 && packet->payload[3] == 0x00) {
                    // Increment H.323 packet count
                    stream->h323_packet_count++;

                    // Check for broadcast
                    if (dport == 1719 || sport == 1719) {
                        stream->h323_broadcast = 1;
                    }
                }
            }
        }
    }
}