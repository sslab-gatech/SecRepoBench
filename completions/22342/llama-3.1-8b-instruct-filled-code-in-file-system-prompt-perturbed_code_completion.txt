if((packet->tcp!= NULL) && (packet->tcp->dest!= ntohs(102))) 
  {
    if(packet->payload_len >= 4) 
    {
      struct tpkt *tpkt = (struct tpkt *)packet->payload;
      if(tpkt->version == 0x01 && tpkt->reserved == 0x00 && tpkt->len == ntohs(102)) 
      {
        if(packet->tcp->dest == ntohs(102)) 
        {
          if(packet->payload_len >= 102) 
          {
            if(packet->payload[102] == 0x00 && packet->payload[103] == 0x00 && packet->payload[104] == 0x00 && packet->payload[105] == 0x00) 
            {
              ndpi_struct->h323_count++;
              if(packet->payload_len >= 106 && packet->payload[106] == 0x00 && packet->payload[107] == 0x00 && packet->payload[108] == 0x00 && packet->payload[109] == 0x00) 
              {
                ndpi_struct->h323_broadcast++;
              }
            }
          }
        }
        else 
        {
          dport = ntohs(packet->tcp->dest);
          sport = ntohs(packet->tcp->source);
          if(packet->payload_len >= 102) 
          {
            if(packet->payload[102] == 0x00 && packet->payload[103] == 0x00 && packet->payload[104] == 0x00 && packet->payload[105] == 0x00) 
            {
              ndpi_struct->h323_count++;
              if(packet->payload_len >= 106 && packet->payload[106] == 0x00 && packet->payload[107] == 0x00 && packet->payload[108] == 0x00 && packet->payload[109] == 0x00) 
              {
                ndpi_struct->h323_broadcast++;
              }
            }
          }
        }
      }
    }
  }
  else if((packet->udp!= NULL) && (packet->udp->dest!= ntohs(102))) 
  {
    if(packet->payload_len >= 4) 
    {
      struct tpkt *tpkt = (struct tpkt *)packet->payload;
      if(tpkt->version == 0x01 && tpkt->reserved == 0x00 && tpkt->len == ntohs(102)) 
      {
        dport = ntohs(packet->udp->dest);
        sport = ntohs(packet->udp->source);
        if(packet->payload_len >= 102) 
        {
          if(packet->payload[102] == 0x00 && packet->payload[103] == 0x00 && packet->payload[104] == 0x00 && packet->payload[105] == 0x00) 
          {
            ndpi_struct->h323_count++;
            if(packet->payload_len >= 106 && packet->payload[106] == 0x00 && packet->payload[107] == 0x00 && packet->payload[108] == 0x00 && packet->payload[109] == 0x00) 
            {
              ndpi_struct->h323_broadcast++;
            }
          }
        }
      }
    }
  }