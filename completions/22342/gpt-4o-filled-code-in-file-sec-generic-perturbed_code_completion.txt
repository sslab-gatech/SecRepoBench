{
    struct tpkt *tpkt_header;
    u_int16_t payload_len;

    if(packet->payload_packet_len < sizeof(struct tpkt)) return;

    tpkt_header = (struct tpkt*)packet->payload;
    payload_len = ntohs(tpkt_header->len);

    if(tpkt_header->version != 3 || payload_len < 4 || payload_len > packet->payload_packet_len) return;

    if(packet->payload[4] == 0x08 && packet->payload[5] == 0x02) {
      NDPI_LOG_INFO(ndpi_struct, "found H.323\n");
      ndpi_set_detected_protocol(ndpi_struct, stream, NDPI_PROTOCOL_H323);
    }
  }