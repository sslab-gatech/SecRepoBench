{
    struct tpkt *tpkt = (struct tpkt*)packet->payload;

    if(packet->payload_packet_len >= sizeof(struct tpkt) &&
       tpkt->version == 3 && tpkt->reserved == 0 &&
       ntohs(tpkt->len) == packet->payload_packet_len) {

      if(packet->payload[sizeof(struct tpkt)] == 0x08 &&
         packet->payload[sizeof(struct tpkt) + 1] == 0x02) {
        NDPI_LOG_INFO(ndpi_struct, "found H.323\n");
        ndpi_set_detected_protocol(ndpi_struct, stream, NDPI_PROTOCOL_H323);
        return;
      }
    }
  }

  if(packet->udp != NULL) {
    sport = ntohs(packet->udp->source);
    dport = ntohs(packet->udp->dest);

    if((sport == 1719 || dport == 1719) && packet->payload_packet_len > 12) {
      if(packet->payload[0] == 0x03 && packet->payload[1] == 0x00 &&
         packet->payload[2] == 0x00 && packet->payload[3] == 0x08) {
        NDPI_LOG_INFO(ndpi_struct, "found H.323 RAS\n");
        ndpi_set_detected_protocol(ndpi_struct, stream, NDPI_PROTOCOL_H323);
        return;
      }
    }
  }

  NDPI_EXCLUDE_PROTO(ndpi_struct, stream);