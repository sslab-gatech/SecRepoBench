{
    u_int16_t len;
    u_int8_t *payload = packet->payload;
    u_int16_t payload_len = packet->payload_packet_len;

    if(payload_len < 4) return;

    len = ntohs(get_u_int16_t(payload, 2));

    if((payload[0] == 0x03) && (payload[1] == 0x00) && (len == payload_len)) {
      if((payload[4] == 0x08) && (payload[5] == 0x02) && (payload[6] == 0x00) && (payload[7] == 0x00)) {
        NDPI_LOG_INFO(ndpi_struct, "found H.323\n");
        ndpi_set_detected_protocol(ndpi_struct, stream, NDPI_PROTOCOL_H323);
      } else if((payload[4] == 0x03) && (payload[5] == 0x00) && (payload[6] == 0x01) && (payload[7] == 0x00)) {
        NDPI_LOG_INFO(ndpi_struct, "found RDP\n");
        ndpi_set_detected_protocol(ndpi_struct, stream, NDPI_PROTOCOL_RDP);
      }
    }
  }