if (packet->udp != NULL) {
    sport = ntohs(packet->udp->source);
    dport = ntohs(packet->udp->dest);
    if (packet->payload_len >= 8) {
      if ((packet->payload[0] == 0x03) && (packet->payload[1] == 0x03)) {
        stream->protocol = NDPI_PROTOCOL_H323;
        stream->detected_protocol_id = NDPI_PROTOCOL_H323;
        NDPI_LOG_DBG(ndpi_struct, "H323 detected\n");
      }
    }
  } else if ((packet->tcp != NULL) && (packet->payload_len >= 8)) {
    if ((packet->payload[0] == 0x03) && (packet->payload[1] == 0x03)) {
      stream->protocol = NDPI_PROTOCOL_H323;
      stream->detected_protocol_id = NDPI_PROTOCOL_H323;
      NDPI_LOG_DBG(ndpi_struct, "H323 detected\n");
    }
  }
}