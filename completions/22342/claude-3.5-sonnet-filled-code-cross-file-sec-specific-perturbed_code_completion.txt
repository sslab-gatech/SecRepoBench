{
    if(packet->payload_packet_len >= 4) {
      u_int16_t tpkt_len = ntohs(get_u_int16_t(packet->payload, 2));

      if(tpkt_len == packet->payload_packet_len) {
        if((packet->payload[0] == 0x03) && (packet->payload[1] == 0) &&
           (packet->payload[4] == 0x08) && (packet->payload[5] == 0x02)) {
          NDPI_LOG_INFO(ndpi_struct, "Found H323\n");
          ndpi_set_detected_protocol(ndpi_struct, stream, NDPI_PROTOCOL_H323, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI);
          stream->h323_valid_packets++;

          if(packet->iph != NULL) {
            if(((ntohl(packet->iph->daddr) & 0xF0000000) == 0xE0000000) ||
               ((ntohl(packet->iph->daddr) & 0xFF000000) == 0xFF000000))
              stream->h323_broadcast++;
          }
          return;
        }
      }
    }
  }

  if(packet->udp != NULL) {
    sport = ntohs(packet->udp->source), dport = ntohs(packet->udp->dest);

    if((packet->payload_packet_len >= 6)
       && ((dport == 1719) || (sport == 1719))
       && ((packet->payload[0] == 0x16) || (packet->payload[0] == 0x15))
       && (packet->payload[1] == 0x80)
       && (packet->payload[4] == 0x06)
       && (packet->payload[5] == 0x00)) {
      NDPI_LOG_INFO(ndpi_struct, "Found H323 (RAS)\n");
      ndpi_set_detected_protocol(ndpi_struct, stream, NDPI_PROTOCOL_H323, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI);
      return;
    }
  }

  NDPI_EXCLUDE_PROTO(ndpi_struct, stream);