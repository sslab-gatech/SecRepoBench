if (packet->tcp != NULL && packet->payload_packet_len > 0) {
  u_int16_t tpkt_len = ntohs(*(u_int16_t*)(packet->payload));
  if (tpkt_len == packet->payload_packet_len) {
    if (packet->payload[2] == 0x03) { // H.323 uses TPKT with DT=3
      stream->h323_packets++;
      if (stream->h323_packets == 1) {
        stream->h323_broadcast = (packet->payload[3] == 0x01); // Check for H.323 broadcast
      }
    }
  }
}