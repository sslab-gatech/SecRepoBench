if (packet->tcp != NULL) {
    if (ndpi_search_h323_tcp(ndpi_struct, stream) == 1) {
      stream->detected_protocol_id = NDPI_PROTOCOL_H323;
    }
  } else if (packet->udp != NULL) {
    sport = ntohs(packet->udp->source);
    dport = ntohs(packet->udp->dest);
    if (ndpi_search_h323_udp(ndpi_struct, stream) == 1) {
      stream->detected_protocol_id = NDPI_PROTOCOL_H323;
    }
  }