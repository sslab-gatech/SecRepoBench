{
    // Check if the TCP payload length is sufficient for TPKT header
    if (packet->tcp->payload_length >= sizeof(struct tpkthdr)) {
      struct tpkthdr *tpkthdr = (struct tpkthdr *)packet->tcp->payload;

      // Validate the TPKT header
      if (tpkthdr->length > 0 && tpkthdr->length <= packet->tcp->payload_length - sizeof(struct tpkthdr)) {
        // Check for specific byte patterns to identify H.323
        if (tpkthdr->type == TPKT_TYPE && is_h323_payload(tpkthdr->payload, tpkthdr->length)) {
          // Increment the count of valid H.323 packets
          ndpi_struct->h323_packet_count++;
          // Additional logic to identify H.323 broadcast can be added here
        }
      }
    }
  }