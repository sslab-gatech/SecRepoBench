if((packet->tcp != NULL) && (packet->tcp->dest != ntohs(102))) {
    if(packet->payload_packet_len >= 4) {
      u_int8_t tpkt_version = packet->payload[0] & 0xC0;
      if(tpkt_version == 0x00) {
        u_int16_t tpkt_length = ntohs(*(u_int16_t *)(packet->payload + 2));
        if(tpkt_length >= 4 && tpkt_length <= packet->payload_packet_len) {
          u_int8_t h225_packet_type = packet->payload[4];
          if(h225_packet_type == 0x01 || h225_packet_type == 0x02 || h225_packet_type == 0x03) {
            NDPI_LOG_INFO(ndpi_struct, "found H.323\n");
            flow->detected_protocol = NDPI_PROTOCOL_H323;
            ndpi_int_h323_add_connection(ndpi_struct, flow);
            return;
          }
        }
      }
    }
  } else if(packet->udp != NULL) {
    sport = ntohs(packet->udp->source);
    dport = ntohs(packet->udp->dest);
    if(sport == 102 || dport == 102) {
      if(packet->payload_packet_len >= 4) {
        u_int8_t tpkt_version = packet->payload[0] & 0xC0;
        if(tpkt_version == 0x00) {
          u_int16_t tpkt_length = ntohs(*(u_int16_t *)(packet->payload + 2));
          if(tpkt_length >= 4 && tpkt_length <= packet->payload_packet_len) {
            u_int8_t h225_packet_type = packet->payload[4];
            if(h225_packet_type == 0x01 || h225_packet_type == 0x02 || h225_packet_type == 0x03) {
              NDPI_LOG_INFO(ndpi_struct, "found H.323\n");
              flow->detected_protocol = NDPI_PROTOCOL_H323;
              ndpi_int_h323_add_connection(ndpi_struct, flow);
              return;
            }
          }
        }
      }
    }
  }
  NDPI_EXCLUDE_PROTO(ndpi_struct, flow);