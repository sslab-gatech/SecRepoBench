if(packet->payload_packet_len >= 4) {
    if(packet->payload[0] == 0x03) {
      u_int16_t tpk_len = ntohs(get_u_int16_t(packet->payload, 2));

      if(tpk_len == packet->payload_packet_len) {
        if(packet->payload_packet_len >= 11) {
          if(packet->payload[5] == 0x08 && packet->payload[6] == 0x02 && packet->payload[7] == 0x01) {
            NDPI_LOG_INFO(ndpi_struct, "found H.323\n");
            ndpi_set_detected_protocol(ndpi_struct, stream, NDPI_PROTOCOL_H323, NDPI_PROTOCOL_UNKNOWN);
            return;
          }
        }
      }
    }
  }

  if(packet->udp != NULL) {
    sport = ntohs(packet->udp->source);
    dport = ntohs(packet->udp->dest);

    if(packet->payload_packet_len >= 12) {
      if(packet->payload[0] == 0x00 && packet->payload[1] == 0x01 && packet->payload[2] == 0x00 && packet->payload[3] == 0x04) {
        if(packet->payload[4] == 0x00 && packet->payload[5] == 0x00 && packet->payload[6] == 0x00 && packet->payload[7] == 0x00) {
          if(packet->payload[8] == 0x00 && packet->payload[9] == 0x00 && packet->payload[10] == 0x00 && packet->payload[11] == 0x00) {
            NDPI_LOG_INFO(ndpi_struct, "found H.323 UDP\n");
            ndpi_set_detected_protocol(ndpi_struct, stream, NDPI_PROTOCOL_H323, NDPI_PROTOCOL_UNKNOWN);
            return;
          }
        }
      }
    }
  }