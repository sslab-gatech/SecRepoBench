if (packet->payload_packet_len >= 4) {
    // Check for TPKT header (first byte should be 0x03)
    if (packet->payload[0] == 0x03) {
      // Check if the length of the payload is sufficient for TPKT
      if (packet->payload_packet_len >= 7) {
        // Check the length field in the TPKT header (bytes 2 and 3)
        u_int16_t length = (packet->payload[2] << 8) | packet->payload[3];
        if (length + 4 <= packet->payload_packet_len) {
          // Valid TPKT packet, increment H.323 packet count
          stream->h323_packet_count++;
          // Check for H.323 broadcast (specific byte patterns)
          if (packet->payload[4] == 0x00 && packet->payload[5] == 0x00) {
            stream->h323_broadcast = 1;
          }
        }
      }
    }
  }