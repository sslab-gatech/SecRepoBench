{
    if (packet->payload_packet_len < 4) {
      return;
    }

    if (packet->payload[0] == 0x03 && packet->payload[1] == 0 && packet->payload[2] < 5 && packet->payload[3] == 0) {
      NDPI_LOG_DBG(ndpi_struct, "found H.323 (tpkt)\n");
      ndpi_int_h323_detect_num++;

      if (packet->payload[2] == 3) {
        NDPI_LOG_DBG(ndpi_struct, "found H.323 broadcast\n");
        ndpi_int_broadcast_h323_detect_num++;
      }

      NDPI_BITMASK_SET_ALL(ndpi_struct->src_or_dst_port_bitmask);
      return;
    }

    // Check for RDP to avoid false positives (H.323 and RDP use TPKT)
    if (packet->payload[0] == 3 && packet->payload[1] == 0 && packet->payload[2] == 3 && packet->payload[3] == 0) {
      if (packet->payload_packet_len >= 13 && packet->payload[12] == 0x03 && packet->payload[13] == 0x00 && packet->payload[14] == 0x00 && packet->payload[15] < 0x09) {
        return;
      }
    }
  } else if(packet->udp != NULL) {
    sport = ntohs(packet->udp->source), dport = ntohs(packet->udp->dest);

    if (packet->payload_packet_len > 12 && packet->payload[0] == 0x08 && packet->payload[1] == 0x00 && packet->payload[2] == 0x45 && packet->payload[3] == 0x00 && packet->payload[9] == 0x11) {
      NDPI_LOG_DBG(ndpi_struct, "found H.323 broadcast\n");
      ndpi_int_broadcast_h323_detect_num++;
      NDPI_BITMASK_SET(ndpi_struct->src_or_dst_port_bitmask, sport);
      NDPI_BITMASK_SET(ndpi_struct->src_or_dst_port_bitmask, dport);
      return;
    }
  }
}