if((packet->tcp != NULL) && (packet->tcp->dest == ntohs(1720))) {
  u_int16_t tpkt_len = 0;
  u_int8_t *tpkt_payload = NULL;

  tpkt_len = packet->payload_length - 4;
  tpkt_payload = (u_int8_t *)packet->payload + 4;

  if(tpkt_len < 4) {
    NDPI_LOG_DBG(ndpi_struct, "Invalid TPKT length\n");
    return;
  }

  if((tpkt_payload[0] == 0x03) && (tpkt_payload[1] == 0x00) && (tpkt_payload[2] == 0x00) && (tpkt_payload[3] == 0x00)) {
    stream->h323_valid_packets++;
    if(stream->h323_valid_packets == 1) {
      stream->h323_broadcast = 1;
    }
  } else if((packet->udp != NULL) && (packet->udp->dest == ntohs(1719))) {
    sport = ntohs(packet->udp->source);
    dport = ntohs(packet->udp->dest);

    if((packet->payload_length >= 12) && (tpkt_len == 4)) {
      if((tpkt_payload[0] == 0x00) && (tpkt_payload[1] == 0x00) && (tpkt_payload[2] == 0x00) && (tpkt_payload[3] == 0x00)) {
        stream->h323_broadcast = 1;
      }
    }
  } else {
    stream->h323_valid_packets = 0;
    stream->h323_broadcast = 0;
  }
}