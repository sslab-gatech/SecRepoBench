{
  u_int realm_len;
  char realm_str[48];

  if(realm_offset < packet->payload_packet_len) {
    realm_len = packet->payload[realm_offset];
    if((realm_len + realm_offset) < packet->payload_packet_len) {
      if(realm_len >= sizeof(realm_str))
        realm_len = sizeof(realm_str) - 1;
      realm_offset += 1;
      memcpy(realm_str, &packet->payload[realm_offset], realm_len);
      realm_str[realm_len] = '\0';
      for(i = 0; i < realm_len; i++)
        realm_str[i] = tolower((unsigned char)realm_str[i]);
      snprintf(kerberos_flow->protos.kerberos.domain, sizeof(kerberos_flow->protos.kerberos.domain), "%s", realm_str);
    }
  }
}