for (i = 0; i < 20; i++)
  if (packet->payload[realm_offset + i] == 0x1b)
    break;

realm_offset += i;
realm_len = packet->payload[realm_offset];

if ((realm_len + realm_offset) < packet->payload_packet_len) {
  char realm_str[48];

  if (realm_len > sizeof(realm_str) - 1)
    realm_len = sizeof(realm_str) - 1;

  realm_offset += 1;
  strncpy(realm_str, (char *)&packet->payload[realm_offset], realm_len);
  realm_str[realm_len] = '\0';
  for (i = 0; i < realm_len; i++)
    realm_str[i] = tolower(realm_str[i]);

#ifdef KERBEROS_DEBUG
  printf("[AS-REQ][s/dport: %u/%u][Kerberos Realm][len: %u][%s]\n", sport, dport, realm_len, realm_str);
#endif

  snprintf(kerberos_flow->protos.kerberos.domain, sizeof(kerberos_flow->protos.kerberos.domain), "%s", realm_str);
}