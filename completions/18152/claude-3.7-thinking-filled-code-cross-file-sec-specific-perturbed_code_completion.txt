c->isize = (int32_t)x[7];

// Calculate the new data length
new_l_data = block_len - 32 + c->l_extranul;

// Check for integer overflow and invalid data length
if (new_l_data < c->l_extranul || block_len < 32)
    return -4;

// Sanity check for query name length
if (c->l_qname < 1 || c->l_qname > 255)
    return -4;

// Reallocate memory if needed
if (b->m_data < new_l_data) {
    uint8_t *new_data;
    new_data = realloc(b->data, new_l_data);
    if (!new_data) return -4;
    b->data = new_data;
    b->m_data = new_l_data;
}

// Set the data length
b->l_data = new_l_data;

// Read query name
if (bgzf_read(filepointer, b->data, c->l_qname) != c->l_qname)
    return -4;

// Add padding nulls
if (c->l_extranul)
    memset(b->data + c->l_qname, '\0', c->l_extranul);