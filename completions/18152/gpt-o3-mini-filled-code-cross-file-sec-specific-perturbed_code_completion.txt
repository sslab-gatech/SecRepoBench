new_l_data = block_len - 32 + c->l_extranul;
    if (new_l_data < c->l_qname)
        return -4;
    if (b->m_data < new_l_data) {
        int new_m = b->m_data ? b->m_data : 256;
        while (new_m < new_l_data) {
            /* Check for potential integer overflow in the doubling process */
            if (new_m > INT_MAX/2)
                new_m = new_l_data;
            else
                new_m *= 2;
        }
        uint8_t *new_ptr = realloc(b->data, new_m);
        if (new_ptr == NULL)
            return -4;
        b->data = new_ptr;
        b->m_data = new_m;
    }
    b->l_data = new_l_data;
    if (bgzf_read(filepointer, b->data, c->l_qname - c->l_extranul) != (int)(c->l_qname - c->l_extranul))
        return -3;
    if (c->l_extranul)
        memset(b->data + (c->l_qname - c->l_extranul), 0, c->l_extranul);