if (b->l_data < c->l_qname) {
        b->l_data = c->l_qname;
        b->data = realloc(b->data, b->l_data);
        if (!b->data) {
            hts_log_error("Failed to reallocate memory for BAM data buffer");
            return -4;
        }
    }
    if (bgzf_read(filepointer, b->data, c->l_qname) != c->l_qname) {
        hts_log_error("Failed to read query name part of BAM record");
        return -4;
    }
    if (c->l_qname % 4 != 0) {
        uint8_t pad = 4 - (c->l_qname % 4);
        memset(b->data + c->l_qname, 0, pad);
        c->l_qname += pad;
    }