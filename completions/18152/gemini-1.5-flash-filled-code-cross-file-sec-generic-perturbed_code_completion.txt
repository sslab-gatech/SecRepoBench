c->isize = (int32_t)x[7];
    new_l_data = c->l_qname + c->n_cigar * 4 + c->l_extranul + c->l_qseq;
    if (c->l_qseq > 0 && (c->flag & BAM_FPAIRED) && !(c->flag & BAM_FPROPER_PAIR) && c->mpos >= 0) {
        if (c->pos > c->mpos) new_l_data += 8; // add 8 bytes for mate CIGAR
    }
    if (new_l_data > INT_MAX) return -4;
    b->l_data = new_l_data;
    if (b->m_data < new_l_data) {
        kstring_t str;
        str.l = str.m = 0; str.s = 0;
        if (kputsn(b->data, b->l_data, &str) < 0) return -4;
        free(b->data);
        b->data = str.s;
        b->m_data = str.m;
    }
    if (bgzf_read(filepointer, b->data, c->l_qname) != c->l_qname) return -4;
    memset(b->data + c->l_qname, 0, c->l_extranul);