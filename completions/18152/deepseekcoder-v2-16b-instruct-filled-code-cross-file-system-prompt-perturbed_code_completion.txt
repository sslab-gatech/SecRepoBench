// Allocate or reallocate memory for the BAM data buffer to accommodate the new data size.
    new_l_data = c->l_qname + b->l_data;
    if (new_l_data > b->m_data) {
        uint8_t *new_data = realloc(b->data, new_l_data);
        if (!new_data) {
            free(b->data);
            b->data = NULL;
            return -4;
        }
        b->data = new_data;
        b->m_data = new_l_data;
    }

    // Read the query name part of the BAM record into the buffer.
    if (bgzf_read(filepointer, b->data, c->l_qname) != c->l_qname)
        return -4;

    // Pad the query name with extra nulls if necessary.
    if (c->l_qname % 4 != 0) {
        uint8_t *padding = b->data + c->l_qname;
        int padding_len = 4 - c->l_qname % 4;
        memset(padding, 0, padding_len);
    }