if (b->l_data < c->l_qname) {
        b->l_data = c->l_qname;
        b->data = realloc(b->data, b->l_data);
        if (!b->data) {
            hts_log_error("Failed to reallocate memory for BAM data buffer");
            return -4;
        }
    }
    if (bgzf_read(filepointer, b->data, c->l_qname) != c->l_qname) {
        hts_log_error("Failed to read query name part of BAM record");
        return -4;
    }
    if (c->l_qname % 4 != 0) {
        b->data[c->l_qname] = '\0';
        b->l_data = c->l_qname + 1;
    }
    return 0;