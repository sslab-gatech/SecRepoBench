// Calculate the new length for data allocation, considering extra nulls.
    new_l_data = c->l_qname + c->l_extranul + (c->l_qname % 4 != 0 ? 4 - (c->l_qname % 4) : 0);
    
    // Check for overflow and consistency errors in data lengths.
    if (new_l_data < c->l_qname || new_l_data > INT32_MAX - 32) {
        return -4; // Invalid length
    }

    // Allocate or reallocate memory for the BAM data buffer to accommodate the new data size.
    if (new_l_data > b->l_data) {
        uint8_t *new_data = realloc(b->data, new_l_data);
        if (!new_data) return -1; // Memory allocation failed
        b->data = new_data;
        b->l_data = new_l_data;
    }

    // Read the query name part of the BAM record into the buffer.
    if (bgzf_read(filepointer, b->data, c->l_qname) != c->l_qname) {
        return -4; // Read error
    }

    // Pad the query name with extra nulls if necessary.
    memset(b->data + c->l_qname, 0, c->l_extranul);