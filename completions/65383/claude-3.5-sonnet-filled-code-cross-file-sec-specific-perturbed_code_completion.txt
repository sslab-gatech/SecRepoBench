case 'Z': case 'H':
    if (aux_limit - aux < 4)
        goto err;

    if (!tm->blk) {
        if (!(tm->blk = cram_new_block(EXTERNAL, key)))
            goto err;
        codec->u.e_byte_array_len.val_codec->out = tm->blk;
    }

    aux += 3;
    while (aux < aux_limit && *aux) {
        BLOCK_APPEND_CHAR(tm->blk, *aux);
        aux++;
    }
    if (aux >= aux_limit)
        goto err;
    BLOCK_APPEND_CHAR(tm->blk, *aux);
    aux++;
    break;

case 'B':
    if (aux_limit - aux < 5)
        goto err;

    if (!tm->blk) {
        if (!(tm->blk = cram_new_block(EXTERNAL, key)))
            goto err;
        codec->u.e_byte_array_len.val_codec->out = tm->blk;
    }

    {
        int type = aux[3], nel;
        uint32_t count;
        int nel_bytes = aux[3] == 'c' || aux[3] == 'C' ? 1 :
                        aux[3] == 's' || aux[3] == 'S' ? 2 :
                        aux[3] == 'i' || aux[3] == 'I' || aux[3] == 'f' ? 4 : 8;

        if (aux_limit - aux < 8)
            goto err;
        count = le_to_u32(&aux[4]);
        nel = count * nel_bytes;
        aux += 8;

        if (aux_limit - aux < nel)
            goto err;

        BLOCK_APPEND(tm->blk, &count, 4);
        BLOCK_APPEND_CHAR(tm->blk, type);
        BLOCK_APPEND(tm->blk, aux, nel);
        aux += nel;
    }
    break;