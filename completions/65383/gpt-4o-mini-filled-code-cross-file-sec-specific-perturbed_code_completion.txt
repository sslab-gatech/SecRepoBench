case 'H': {
            size_t len = strlen((char *)aux + 3);
            if (aux_limit - aux < 3 + len + 1)
                goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux += 3;
            BLOCK_APPEND(tm->blk, aux, len);
            BLOCK_APPEND_CHAR(tm->blk, '\0');
            aux += len + 1;
            break;
        }

        case 'B': {
            // Handle byte array of variable size
            int count = *(aux + 3);
            int subtype = aux[2];
            size_t data_size = count * (subtype == 'c' || subtype == 'C' ? 1 :
                                         subtype == 's' || subtype == 'S' ? 2 :
                                         subtype == 'i' || subtype == 'I' || subtype == 'f' ? 4 : 0);
            if (aux_limit - aux < 3 + 1 + data_size)
                goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux += 3;
            BLOCK_APPEND(tm->blk, aux, data_size);
            aux += data_size;
            break;
        }