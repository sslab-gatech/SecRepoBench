case 'H':
            if (aux_limit - aux < 3+1)
                goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux+=3;
            //codec->encode(s, codec, aux, 1);
            BLOCK_APPEND_CHAR(tm->blk, *aux);
            aux++;
            break;

        case 'B': {
            int len, type;
            if (aux_limit - aux < 3+2)
                goto err;

            aux+=3;
            len = aux[0];
            type = aux[1];
            aux+=2;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            if (aux_limit - aux < len)
                goto err;

            //codec->encode(s, codec, aux, len);
            BLOCK_APPEND(tm->blk, aux, len);
            aux+=len;
            break;
        }