case 'Z': {
            int len = strlen(aux+3);
            if (aux_limit - aux < 3+len+1)
                goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux+=3;
            //codec->encode(s, codec, aux, len);
            BLOCK_APPEND(tm->blk, aux, len);
            aux+=len;
            break;
        }
        case 'H': {
            int len = 0;
            char *p = aux+3;
            while (*p) {
                if (!isxdigit(*p)) {
                    hts_log_error("Invalid hex character in aux field");
                    goto err;
                }
                p++;
                len++;
            }
            if (aux_limit - aux < 3+len+1)
                goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux+=3;
            //codec->encode(s, codec, aux, len);
            BLOCK_APPEND(tm->blk, aux, len);
            aux+=len;
            break;
        }
        case 'B': {
            int sub_type = aux[3];
            int count = le_to_u16(aux+4);
            int len = count * (sub_type == 'c' ? 1 : (sub_type == 's' ? 2 : 4));
            if (aux_limit - aux < 3+2+len)
                goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux+=6;
            //codec->encode(s, codec, aux, len);
            BLOCK_APPEND(tm->blk, aux, len);
            aux+=len;
            break;
        }