case 'Z': {
            int len = strlen(aux + 3) + 1;
            if (aux_limit - aux < 3 + len)
                goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux += 3;
            //codec->encode(s, codec, aux, len);
            BLOCK_APPEND(tm->blk, aux, len);
            aux += len;
            break;
        }
        case 'H': {
            int len = strlen(aux + 3) + 1;
            if (aux_limit - aux < 3 + len)
                goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux += 3;
            //codec->encode(s, codec, aux, len);
            BLOCK_APPEND(tm->blk, aux, len);
            aux += len;
            break;
        }
        case 'B': {
            int type = aux[3];
            int count = bam_aux2i(aux + 4);
            int len = 5 + count * (type == 'c' ? 1 : type == 'C' ? 1 : type == 's' ? 2 : type == 'S' ? 2 : type == 'i' ? 4 : type == 'I' ? 4 : type == 'f' ? 4 : 0);
            if (aux_limit - aux < len)
                goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux += 5;
            //codec->encode(s, codec, aux, count * (type == 'c' ? 1 : type == 'C' ? 1 : type == 's' ? 2 : type == 'S' ? 2 : type == 'i' ? 4 : type == 'I' ? 4 : type == 'f' ? 4 : 0));
            BLOCK_APPEND(tm->blk, aux, count * (type == 'c' ? 1 : type == 'C' ? 1 : type == 's' ? 2 : type == 'S' ? 2 : type == 'i' ? 4 : type == 'I' ? 4 : type == 'f' ? 4 : 0));
            aux += count * (type == 'c' ? 1 : type == 'C' ? 1 : type == 's' ? 2 : type == 'S' ? 2 : type == 'i' ? 4 : type == 'I' ? 4 : type == 'f' ? 4 : 0);
            break;
        }