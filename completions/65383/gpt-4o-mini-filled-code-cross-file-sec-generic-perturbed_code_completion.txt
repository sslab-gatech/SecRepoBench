case 'H': {
            size_t len = strlen(aux + 3) + 1; // +1 for null terminator
            if (aux_limit - aux < 3 + len) goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux += 3;
            BLOCK_APPEND(tm->blk, aux, len);
            aux += len;
            break;
        }

        case 'B': {
            // Handle byte array of variable size
            int count = bam_aux2i_end((uint8_t *)aux + 3, (uint8_t *)aux_limit);
            if (count < 0) goto err;

            size_t total_size = count * sizeof(uint8_t); // Adjust based on subtype
            if (aux_limit - aux < 3 + total_size) goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux += 3;
            BLOCK_APPEND(tm->blk, aux, total_size);
            aux += total_size;
            break;
        }