case 'H': {
            // string as byte_array_stop
            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_stop.content_id = key;
                codec->out = tm->blk;
            }

            aux+=3;
            while (aux < aux_limit && *aux++);
            codec->encode(s, codec, aux, aux - orig - 3);
            break;
        }

        case 'B': {
            // Byte array
            int32_t count = le_to_i32(aux+3);
            int type_size = 0;
            switch (aux[2]) {
            case 'c': case 'C': type_size = 1; break;
            case 's': case 'S': type_size = 2; break;
            case 'i': case 'I': case 'f': type_size = 4; break;
            default:
                hts_log_error("Unknown sub-type '%c' for aux type 'B'", aux[2]);
                goto err;
            }
            int len = 5 + count * type_size;
            if (aux_limit - aux < len)
                goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux+=3;
            codec->encode(s, codec, aux, len);
            aux+=len;
            break;
        }