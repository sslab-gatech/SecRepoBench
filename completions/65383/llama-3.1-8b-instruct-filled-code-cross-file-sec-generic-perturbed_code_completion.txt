case 'Z': 
// Case handlers for auxiliary fields of types 'H' and 'B' in BAM records.
// Handles 'H' type (hexadecimal string) by creating a new block if necessary,
// and encoding the data from the auxiliary fields.
// For 'B' type (byte array), computes the length based on the sub-type and count,
// allocates blocks as needed, and encodes the data.
// Checks for sufficient data remaining in the auxiliary field buffer before processing.
// Updates the auxiliary field pointer appropriately after encoding.
// <MASK>
default:
    if (aux[2] == 'Z') {
        // Handle 'Z' type (string) by creating a new block if necessary,
        // and encoding the data from the auxiliary fields.
        if (!tm->blk) {
            if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                goto err;
            codec->u.e_byte_array_len.val_codec->out = tm->blk;
        }

        // Compute the length of the string
        int len = 0;
        while (aux < aux_limit && *aux!= '\0') {
            len++;
            aux++;
        }

        // Encode the string
        BLOCK_APPEND(tm->blk, aux, len);
        aux += len;

        // Update the auxiliary field pointer
        cr->aux_size += len + 3;
    } else if (aux[2] == 'B') {
        // Handle 'B' type (byte array) by computing the length based on the sub-type and count,
        // allocating blocks as needed, and encoding the data.
        int len = 0;
        switch(aux[3]) {
        case 'A': case 'C': case 'c':
            len = 1;
            break;
        case 'S': case's':
            len = 2;
            break;
        case 'I': case 'i': case 'f':
            len = 4;
            break;
        default:
            hts_log_error("Unsupported SAM aux type '%c'", aux[3]);
            goto err;
        }

        // Encode the byte array
        BLOCK_APPEND(tm->blk, aux, len);
        aux += len;

        // Update the auxiliary field pointer
        cr->aux_size += len + 3;
    } else {
        hts_log_error("Unknown aux type '%c'", aux[2]);
        goto err;
    }