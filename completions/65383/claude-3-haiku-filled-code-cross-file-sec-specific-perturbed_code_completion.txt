case 'H':
    if (aux_limit - aux < 2)
        goto err;

    if (!tm->blk) {
        if (!(tm->blk = cram_new_block(EXTERNAL, key)))
            goto err;
        codec->u.e_byte_array_len.val_codec->out = tm->blk;
    }

    // Hexadecimal string
    while (aux < aux_limit && *aux != 0) {
        if (aux_limit - aux < 1)
            goto err;
        BLOCK_APPEND_CHAR(tm->blk, *aux);
        aux++;
    }
    aux++;
    break;

case 'B':
    if (aux_limit - aux < 2)
        goto err;

    // Byte array
    int sub_type = aux[2];
    int count = bam_aux_len((char *)aux) - 3;
    int elem_size;
    switch (sub_type) {
    case 'c': case 'C': elem_size = 1; break;
    case 's': case 'S': elem_size = 2; break;
    case 'i': case 'I': case 'f': elem_size = 4; break;
    default:
        hts_log_error("Unsupported BAM 'B' sub-type '%c'", sub_type);
        goto err;
    }

    if (aux_limit - aux < 3 + count * elem_size)
        goto err;

    if (!tm->blk) {
        if (!(tm->blk = cram_new_block(EXTERNAL, key)))
            goto err;
        codec->u.e_byte_array_len.val_codec->out = tm->blk;
    }

    BLOCK_APPEND(tm->blk, aux+3, count * elem_size);
    aux += 3 + count * elem_size;
    break;