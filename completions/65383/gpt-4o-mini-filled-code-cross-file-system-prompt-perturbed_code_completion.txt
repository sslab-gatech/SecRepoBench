if (aux[2] == 'H') {
                // Handle 'H' type (hexadecimal string)
                if (aux_limit - aux < 3 + 1)
                    goto err;

                if (!tm->blk) {
                    if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                        goto err;
                    codec->u.e_byte_array_len.val_codec->out = tm->blk;
                }

                aux += 3;
                // codec->encode(s, codec, aux, 1); // Encoding for 'H' type
                BLOCK_APPEND_CHAR(tm->blk, *aux);
                aux++;
            } else if (aux[2] == 'B') {
                // Handle 'B' type (byte array)
                int count = bam_aux2i_end((uint8_t *)aux + 3, (uint8_t *)aux_limit);
                if (count < 0)
                    goto err;

                if (!tm->blk) {
                    if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                        goto err;
                    codec->u.e_byte_array_len.val_codec->out = tm->blk;
                }

                aux += 3;
                // codec->encode(s, codec, aux, count); // Encoding for 'B' type
                BLOCK_APPEND(tm->blk, aux, count);
                aux += count;
            }