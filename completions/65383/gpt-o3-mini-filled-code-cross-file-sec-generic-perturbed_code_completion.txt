case 'Z': {
    if (aux_limit - aux < 4)
        goto err;
    aux += 3; // skip tag name and type
    char *start = aux;
    while (aux < aux_limit && *aux != '\0')
        aux++;
    if (aux == aux_limit)
        goto err; // missing null terminator
    size_t str_len = (aux - start) + 1; // include null terminator
    if (!tm->blk) {
        tm->blk = cram_new_block(EXTERNAL, key);
        if (!tm->blk)
            goto err;
        codec->u.e_byte_array_len.val_codec->out = tm->blk;
    }
    BLOCK_APPEND(tm->blk, start, str_len);
    aux++; // skip the null terminator
    break;
}