case 'H':
            if (aux_limit - aux < 3+1)
                goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux+=3;
            //codec->encode(s, codec, aux, 1);
            {
                char *t = aux;
                while (aux < aux_limit &&
                       ((*aux >= '0' && *aux <= '9') ||
                        (*aux >= 'A' && *aux <= 'F') ||
                        (*aux >= 'a' && *aux <= 'f')))
                    aux++;
                BLOCK_APPEND(tm->blk, t, aux-t);
            }
            break;

        case 'B': {
            int num;
            size_t sz;

            if (aux_limit - aux < 4)
                goto err;

            switch (aux[3]) {
            case 'c': num = 1; break;
            case 'C': num = 2; break;
            case 's': num = 2; break;
            case 'S': num = 2; break;
            case 'i': num = 4; break;
            case 'I': num = 4; break;
            case 'f': num = 4; break;
            default:
                hts_log_error("Unknown 'B' sub-type '%c'", aux[3]);
                goto err;
            }

            // Find number of elements in array
            char *end;
            size_t count = strtol(aux+4, &end, 10);
            if (aux+4 == end) {
                hts_log_error("Missing count in 'B' array");
                goto err;
            }

            sz = count * num;
            if (aux_limit - aux < 5 + strlen(aux+4) + sz)
                goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux+=4;
            while (*aux && !isdigit(*aux))
                aux++;

            aux = end;
            if (*aux == ',')
                aux++;

            //codec->encode(s, codec, aux, sz);
            BLOCK_APPEND(tm->blk, aux, sz);
            aux+=sz;
            break;
        }