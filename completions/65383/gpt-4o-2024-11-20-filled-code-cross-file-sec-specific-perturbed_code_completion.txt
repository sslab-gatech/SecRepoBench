case 'H': {
            // Hexadecimal string
            if (aux_limit - aux < 3)
                goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux += 3;
            char *end = aux;
            while (end < aux_limit && *end != '\0') {
                end++;
            }
            if (end >= aux_limit)
                goto err;

            size_t len = end - aux;
            BLOCK_APPEND(tm->blk, aux, len);
            aux += len + 1; // Skip null terminator
            break;
        }

        case 'B': {
            // Byte array
            if (aux_limit - aux < 8)
                goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux += 3;
            char sub_type = *aux++;
            int32_t count;
            memcpy(&count, aux, 4);
            aux += 4;

            size_t elem_size;
            switch (sub_type) {
                case 'c': case 'C': elem_size = 1; break;
                case 's': case 'S': elem_size = 2; break;
                case 'i': case 'I': case 'f': elem_size = 4; break;
                default:
                    hts_log_error("Unknown sub-type '%c' in B tag", sub_type);
                    goto err;
            }

            size_t total_size = elem_size * count;
            if (aux_limit - aux < total_size)
                goto err;

            BLOCK_APPEND(tm->blk, &sub_type, 1);
            BLOCK_APPEND(tm->blk, &count, 4);
            BLOCK_APPEND(tm->blk, aux, total_size);
            aux += total_size;
            break;
        }