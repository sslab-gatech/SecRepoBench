case 'H': // Case handlers for auxiliary fields of type 'H' (hexadecimal string)
    if (!tm->blk) {
        if (!(tm->blk = cram_new_block(EXTERNAL, key)))
            goto err;
        codec->u.e_byte_array_len.val_codec->out = tm->blk;
    }

    while (aux_limit - aux > 0 && *aux != 0) {
        BLOCK_APPEND_CHAR(tm->blk, *aux);
        aux++;
    }
    BLOCK_APPEND_CHAR(tm->blk, 0);
    break;

case 'B': // Case handlers for auxiliary fields of type 'B' (byte array)
    if (aux_limit - aux < 2)
        goto err;

    int sub_type = *aux++;
    int count = bam_aux_len((char *)aux);
    if (aux_limit - aux < count)
        goto err;

    if (!tm->blk) {
        if (!(tm->blk = cram_new_block(EXTERNAL, key)))
            goto err;
        codec->u.e_byte_array_len.val_codec->out = tm->blk;
    }

    switch (sub_type) {
    case 'c': case 'C':
        BLOCK_APPEND(tm->blk, aux, count);
        aux += count;
        break;
    case 's': case 'S':
        for (i = 0; i < count/2; i++) {
            int16_t val = le_to_i16(aux);
            BLOCK_APPEND(tm->blk, &val, 2);
            aux += 2;
        }
        break;
    case 'i': case 'I': case 'f':
        for (i = 0; i < count/4; i++) {
            int32_t val = le_to_i32(aux);
            BLOCK_APPEND(tm->blk, &val, 4);
            aux += 4;
        }
        break;
    case 'd':
        for (i = 0; i < count/8; i++) {
            double val = le_to_double(aux);
            BLOCK_APPEND(tm->blk, &val, 8);
            aux += 8;
        }
        break;
    default:
        hts_log_error("Unknown 'B' sub-type '%c'", sub_type);
        goto err;
    }
    break;