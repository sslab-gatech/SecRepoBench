case 'H':
    if (aux_limit - aux < 4)
        goto err;

    if (!tm->blk) {
        if (!(tm->blk = cram_new_block(EXTERNAL, key)))
            goto err;
        codec->out = tm->blk;
    }

    aux+=3;
    if (aux_limit - aux < *aux + 1)
        goto err;
    //codec->encode(s, codec, aux+1, *aux);
    BLOCK_APPEND(tm->blk, aux+1, *aux);
    aux += *aux + 1;
    break;

case 'B': {
    int type, count;

    if (aux_limit - aux < 5)
        goto err;

    if (!tm->blk) {
        if (!(tm->blk = cram_new_block(EXTERNAL, key)))
            goto err;
        codec->u.e_byte_array_len.val_codec->out = tm->blk;
    }

    type  = aux[3];
    count = bam_auxB_len(aux+3);

    if (aux_limit - aux < 4 + count * bam_auxB_type_size(type))
        goto err;

    aux+=4;
    //codec->encode(s, codec, aux, count * bam_auxB_type_size(type));
    BLOCK_APPEND(tm->blk, aux, count * bam_auxB_type_size(type));
    aux += count * bam_auxB_type_size(type);

    break;
}