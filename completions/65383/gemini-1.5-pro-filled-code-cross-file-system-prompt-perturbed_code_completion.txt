case 'H':
            if (aux_limit - aux < 3+2)
                goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            aux+=3;
            int hex_len = strlen(aux);
            if (aux_limit - aux < hex_len || (hex_len & 1))
                goto err;
            if (cram_encode_aux_hex(tm->blk, aux, hex_len) < 0)
                goto err;
            aux += hex_len;
            break;

        case 'B': {
            char type;
            int32_t count;

            if (aux_limit - aux < 4)
                goto err;

            type  = aux[3];
            aux+=4;

            if (aux_limit - aux < 4)
                goto err;

            count = bam_aux2i((uint8_t *)aux);
            aux+=4;

            if (aux_limit - aux < count *
                (type=='c'?1:(type=='s'?2:(type=='i' || type=='f'?4:8))))
                goto err;

            if (!tm->blk) {
                if (!(tm->blk = cram_new_block(EXTERNAL, key)))
                    goto err;
                codec->u.e_byte_array_len.val_codec->out = tm->blk;
            }

            if (cram_encode_aux_b(tm->blk, type, count, aux) < 0)
                goto err;

            aux += count * (type=='c'?1:(type=='s'?2:(type=='i' || type=='f'?4:8)));
            break;
        }