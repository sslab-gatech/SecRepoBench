i=0;
while (1) {
    if (i >= vosh_size - 7) break;
    if (decoderconfig[i] == 0x00 && decoderconfig[i+1] == 0x00 && decoderconfig[i+2] == 0x01) {
        if (!memcmp(decoderconfig+i+3, "DivX", 4)) {
            if ((i+7 < vosh_size) && (decoderconfig[i+7] == 'p')) {
                decoderconfig[i+7] = 'n';
                ctx->forced_packed = GF_TRUE;
            }
            break;
        }
        i += 3;
    } else {
        i++;
    }
}