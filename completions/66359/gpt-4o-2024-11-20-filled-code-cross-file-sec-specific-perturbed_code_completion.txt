// Ensure we do not exceed the buffer size to prevent heap overflow
			if (i + 4 >= vosh_size) {
				break;
			}

			// Check for MPEG start code pattern (0x00 0x00 0x01)
			if (decoderconfig[i] == 0x00 && decoderconfig[i + 1] == 0x00 && decoderconfig[i + 2] == 0x01) {
				// Check for "DivX" pattern after the start code
				if ((i + 8 <= vosh_size) && 
					decoderconfig[i + 3] == 'D' && decoderconfig[i + 4] == 'i' &&
					decoderconfig[i + 5] == 'v' && decoderconfig[i + 6] == 'X') {
					ctx->is_packed = GF_TRUE;
					break;
				}
			}

			// Increment index to continue searching
			i++;