/* Skip the '&' character. */
    NEXT;

    /* Parse the entity reference name. */
    xmlChar *name = xmlParseName(ctxt);
    if (name == NULL) {
        xmlFatalErrMsg(ctxt, XML_ERR_NAME_REQUIRED,
                       "xmlParseReference: no name\n");
        return;
    }

    /* Check for the terminating ';'. */
    if (RAW != ';') {
        xmlFatalErr(ctxt, XML_ERR_ENTITYREF_SEMICOL_MISSING, NULL);
        xmlFree(name);
        return;
    }
    NEXT;

    /* Attempt to retrieve the entity. */
    ent = xmlGetPredefinedEntity(name);
    if ((ent == NULL) && (ctxt->sax != NULL) && (ctxt->sax->getEntity != NULL))
        ent = ctxt->sax->getEntity(ctxt->userData, name);

    /* Free the temporary name buffer. */
    xmlFree(name);

    /* If no entity was found, just return. */
    if (ent == NULL)
        return;

    /* Store the entity's checked status for later use. */
    entity_checked_status = ent->checked;

    /* Handle predefined entities by directly inlining their content if possible. */
    if (ent->etype == XML_INTERNAL_PREDEFINED_ENTITY) {
        val = ent->content;
        if (val == NULL)
            return;
        if ((ctxt->sax != NULL) && (ctxt->sax->characters != NULL) &&
            (!ctxt->disableSAX)) {
            ctxt->sax->characters(ctxt->userData, val, xmlStrlen(val));
        }
        return;
    }