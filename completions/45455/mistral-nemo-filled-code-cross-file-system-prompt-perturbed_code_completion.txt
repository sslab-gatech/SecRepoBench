/*
     * Parse the entity reference from the XML parser context.
     * Check if the entity is null and return if it is.
     * Store the entity's checked status for later use.
     * Handle the special case for predefined entities:
     *  - Retrieve the content of the entity.
     *  - Check if the content is null and return if it is.
     *  - Inline the entity content using the SAX character handler if available.
     */
    if (ent == NULL) {
        xmlFatalErrMsgStr(ctxt, XML_ERR_UNDECLARED_ENTITY,
                         "Entity '%s' not defined\n", ent->name);
        return;
    }

    if (ent->etype == XML_INTERNAL_PREDEFINED_ENTITY ||
        ent->etype == XML_EXTERNAL_PREDEFINED_ENTITY) {
        val = xmlStringDecodeEntities(ctxt, ent->content, 0, 0, 0, 0);
        if (val == NULL) {
            xmlFatalErrMsgStr(ctxt, XML_ERR_INTERNAL_ERROR,
                             "Entity '%s' has null content\n", ent->name);
            return;
        }
        if ((ctxt->sax != NULL) && (ctxt->sax->characters != NULL) &&
            (!ctxt->disableSAX))
            ctxt->sax->characters(ctxt->userData, val, xmlStrlen(val));
        xmlFree(val);
        return;
    }

    if (ctxt->replaceEntities) {
        if ((ctxt->sax != NULL) && (ctxt->sax->reference != NULL) &&
            (!ctxt->disableSAX))
            ctxt->sax->reference(ctxt->userData, ent->name);
        return;
    }

    if ((ctxt->sax != NULL) && (ctxt->sax->reference != NULL) &&
        (!ctxt->disableSAX))
        ctxt->sax->reference(ctxt->userData, ent->name);