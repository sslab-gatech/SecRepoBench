ent = xmlParseStringEntityRef(ctxt, &CUR_PTR);
if (ent == NULL) {
    return;
}
entity_checked_status = ent->checked;

// Handle predefined entities
if ((ctxt->options & XML_PARSE_OLDSAX) == 0) {
    if (xmlStrEqual(ent->name, BAD_CAST "amp") ||
        xmlStrEqual(ent->name, BAD_CAST "lt") ||
        xmlStrEqual(ent->name, BAD_CAST "gt") ||
        xmlStrEqual(ent->name, BAD_CAST "apos") ||
        xmlStrEqual(ent->name, BAD_CAST "quot")) {
        val = xmlStringDecodeEntities(NULL, ent->content, XML_SUBSTITUTE_REF, 0, 0, 0);
        if (val == NULL) {
            return;
        }
        if ((ctxt->sax != NULL) && (ctxt->sax->characters != NULL) &&
            (!ctxt->disableSAX)) {
            ctxt->sax->characters(ctxt->userData, val, xmlStrlen(val));
        }
        xmlFree(val);
        return;
    }
}