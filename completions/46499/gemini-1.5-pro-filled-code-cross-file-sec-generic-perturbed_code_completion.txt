while(i < payload_len && packet_payload[i] != ' ' && numbers_left > 0) {
  if(isdigit(packet_payload[i]) == 0) {
    return;
  }
  while(i < payload_len && packet_payload[i] != ' ') {
    i++;
  }
  i++;
  numbers_left--;
}

if(numbers_left != 0 || i >= payload_len) {
  return;
}

while(i < payload_len && isalnum(packet_payload[i])) {
  i++;
}

if(i+1 != payload_len || packet_payload[i] != '\n') {
  return;
}

connection_flow->tinc_state++;

if(connection_flow->tinc_state > 3) {
  if(ndpi_struct->tinc_cache == NULL) {
    if((ndpi_struct->tinc_cache = cache_init(1000000, sizeof(struct tinc_cache_entry))) == NULL) {
      NDPI_LOG_ERR(ndpi_struct, "Error: initializing tinc cache failed\n");
      return;
    }
  }

  if(cache_add(ndpi_struct->tinc_cache, &connection_flow->tinc_cache_entry, sizeof(connection_flow->tinc_cache_entry)) == CACHE_NO_ERROR) {
    NDPI_LOG_INFO(ndpi_struct, "found tinc tcp connection\n");
    ndpi_set_detected_protocol(ndpi_struct, connection_flow, NDPI_PROTOCOL_TINC, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI_CACHE);
  }
}