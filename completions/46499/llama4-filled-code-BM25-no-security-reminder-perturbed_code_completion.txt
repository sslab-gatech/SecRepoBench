while(i < payload_len && (packet_payload[i] >= '0' && packet_payload[i] <= '9')) i++;
if(--numbers_left == 0) i++; /* move to the next expected number or newline */
if(i < payload_len && packet_payload[i] == ' ') {
  i++;
} else {
  break; /* incorrect format */
}
} /* end of for */
if(i < payload_len && packet_payload[i] == '\n') {
  if(numbers_left == 0) {
    connection_flow->tinc_state++;
    if(ndpi_struct->tinc_cache == NULL) {
      ndpi_struct->tinc_cache = cache_init();
    }
    if(ndpi_struct->tinc_cache != NULL) {
      struct tinc_cache_entry tinc_cache_entry = {
        .src_address = connection_flow->tinc_cache_entry.src_address,
        .dst_address = connection_flow->tinc_cache_entry.dst_address,
        .dst_port = connection_flow->tinc_cache_entry.dst_port
      };
      cache_add(ndpi_struct->tinc_cache, &tinc_cache_entry, sizeof(tinc_cache_entry));
    }
    NDPI_LOG_INFO(ndpi_struct, "found tinc tcp connection\n");
    ndpi_set_detected_protocol(ndpi_struct, connection_flow, NDPI_PROTOCOL_TINC, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI_CACHE);
  }
}