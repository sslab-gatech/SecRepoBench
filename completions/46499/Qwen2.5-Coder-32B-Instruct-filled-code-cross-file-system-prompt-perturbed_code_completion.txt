while(i < payload_len && packet_payload[i] != '\n') {
  if(packet_payload[i] >= '0' && packet_payload[i] <= '9') {
    numbers_left--;
    while(i < payload_len && packet_payload[i] >= '0' && packet_payload[i] <= '9') {
      i++;
    }
  } else if(packet_payload[i] == ' ') {
    i++;
  } else {
    break;
  }
}

if(numbers_left == 0 && packet_payload[i] == '\n') {
  connection_flow->tinc_state++;
  if(connection_flow->tinc_state > 3) {
    if(ndpi_struct->tinc_cache == NULL) {
      ndpi_struct->tinc_cache = cache_init();
    }
    if(ndpi_struct->tinc_cache != NULL) {
      cache_add(ndpi_struct->tinc_cache, &connection_flow->tinc_cache_entry, sizeof(connection_flow->tinc_cache_entry));
      NDPI_LOG_INFO(ndpi_struct, "found tinc tcp connection\n");
      ndpi_set_detected_protocol(ndpi_struct, connection_flow, NDPI_PROTOCOL_TINC, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI_CACHE);
    }
  }
}