u_int32_t number_start = i;
while (i < payload_len && packet_payload[i] != ' ') {
  if (!isdigit(packet_payload[i])) {
    return; // Exit if a non-digit character is found where a digit is expected.
  }
  i++;
}
if (i >= payload_len || numbers_left == 0) {
  return; // Exit if the format does not match or no more numbers are expected.
}

number_start = ++i; // Move to the next number after the space.
numbers_left--;
if (packet_payload[i] == '\n') {
  connection_flow->tinc_state++;
  
  if (connection_flow->tinc_state > 4 && ndpi_struct->tinc_cache != NULL) {
    cache_add(ndpi_struct->tinc_cache, &connection_flow->tinc_cache_entry, sizeof(connection_flow->tinc_cache_entry));
  }

  NDPI_LOG_INFO(ndpi_struct, "found tinc tcp connection\n");
  ndpi_set_detected_protocol(ndpi_struct, connection_flow, NDPI_PROTOCOL_TINC, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI_CACHE);
}