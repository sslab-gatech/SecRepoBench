{
    /* Validate that exactly 4 numeric sequences are present, each terminated by a space */
    while (numbers_left > 0 && i < payload_len) {
        /* Ensure that the current character is a digit */
        if (!isdigit(packet_payload[i])) {
            break;
        }
        /* Skip over the digits of the current number */
        while (i < payload_len && isdigit(packet_payload[i])) {
            i++;
        }
        /* Expect a space after the number */
        if (i >= payload_len || packet_payload[i] != ' ') {
            break;
        }
        i++;  /* Skip the space */
        numbers_left--;
    }
    if (numbers_left != 0) {
        break;
    }
    /* Continue scanning until the newline character is found */
    while (i < payload_len && packet_payload[i] != '\n') {
        i++;
    }
    if (i >= payload_len || packet_payload[i] != '\n') {
        break;
    }
    /* Format successfully identified; progress the state */
    connection_flow->tinc_state++;
    /* Once the state passes a threshold (e.g. > 3) and cache exists, add an entry */
    if (connection_flow->tinc_state > 3 && ndpi_struct->tinc_cache != NULL) {
        cache_add(ndpi_struct->tinc_cache, &connection_flow->tinc_cache_entry,
                  sizeof(connection_flow->tinc_cache_entry));
    }
    NDPI_LOG_INFO(ndpi_struct, "found tinc tcp connection\n");
    ndpi_set_detected_protocol(ndpi_struct, connection_flow, NDPI_PROTOCOL_TINC,
                               NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI_CACHE);
    return;
}