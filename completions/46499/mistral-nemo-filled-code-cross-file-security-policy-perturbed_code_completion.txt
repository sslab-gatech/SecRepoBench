u_int16_t i = 3;
u_int8_t numbers_left = 4;
while (numbers_left > 0 && i < payload_len) {
  if (!isdigit(packet_payload[i])) {
    break;
  }
  i++;
  numbers_left--;
}
if (numbers_left == 0 && packet_payload[i++] == ' ' && i < payload_len) {
  while (i < payload_len && isalnum(packet_payload[i])) {
    i++;
  }
  if (packet_payload[i++] == '\n' && i < payload_len) {
    if (connection_flow->tinc_state == 2) {
      if (ndpi_struct->tinc_cache == NULL) {
        ndpi_struct->tinc_cache = cache_init(ndpi_struct->cache_mem, ndpi_struct->cache_size, sizeof(struct tinc_cache_entry));
      }
      cache_add(ndpi_struct->tinc_cache, &connection_flow->tinc_cache_entry, sizeof(struct tinc_cache_entry));
      connection_flow->tinc_state++;
      NDPI_LOG_INFO(ndpi_struct, "found tinc tcp connection\n");
      ndpi_set_detected_protocol(ndpi_struct, connection_flow, NDPI_PROTOCOL_TINC, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI_CACHE);
    } else if (connection_flow->tinc_state == 3) {
      cache_remove(ndpi_struct->tinc_cache, &connection_flow->tinc_cache_entry, sizeof(struct tinc_cache_entry));
      NDPI_LOG_INFO(ndpi_struct, "tinc tcp connection closed\n");
      ndpi_set_detected_protocol(ndpi_struct, connection_flow, NDPI_PROTOCOL_TINC, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI_CACHE);
      connection_flow->tinc_state = 0;
    }
  }
}