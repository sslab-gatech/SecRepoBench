{
    /* Validate four numeric sequences, each followed by a space */
    while (numbers_left > 0 && i < payload_len) {
        if (!isdigit(packet_payload[i])) {
            break;
        }
        while (i < payload_len && isdigit(packet_payload[i])) {
            i++;
        }
        if (i >= payload_len || packet_payload[i] != ' ') {
            break;
        }
        i++; // Skip the space after the number
        numbers_left--;
    }
    if (numbers_left != 0) {
        break;
    }

    /* Continue scanning for alphanumeric characters until a newline is found */
    while (i < payload_len && packet_payload[i] != '\n') {
        if (!isalnum(packet_payload[i]) && packet_payload[i] != ' ') {
            break;
        }
        i++;
    }
    if (i >= payload_len || packet_payload[i] != '\n') {
        break;
    }

    /* Format correctly identified, update state and add an entry in cache if present */
    connection_flow->tinc_state++;
    if (ndpi_struct->tinc_cache != NULL) {
        struct tinc_cache_entry cache_entry = {
            .src_address = connection_flow->tinc_cache_entry.src_address,
            .dst_address = connection_flow->tinc_cache_entry.dst_address,
            .dst_port    = connection_flow->tinc_cache_entry.dst_port
        };
        cache_add(ndpi_struct->tinc_cache, &cache_entry, sizeof(cache_entry));
    }
    NDPI_LOG_INFO(ndpi_struct, "found tinc tcp connection\n");
    ndpi_set_detected_protocol(ndpi_struct, connection_flow, NDPI_PROTOCOL_TINC, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI_CACHE);
    return;
}