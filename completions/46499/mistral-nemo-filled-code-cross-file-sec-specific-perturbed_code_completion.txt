u_int16_t i = 3;
while(i < payload_len && packet_payload[i++] != ' ');
if(i+3 == payload_len && memcmp((packet_payload+i), "17\n", 3) == 0) {
  connection_flow->tinc_state++;
  return;
}

if(connection_flow->tinc_state > 2) {
  if(ndpi_struct->tinc_cache == NULL) {
    ndpi_struct->tinc_cache = cache_init(ndpi_struct->cache_mem, ndpi_struct->cache_size, ndpi_struct->cache_max_entries);
  }

  struct tinc_cache_entry tinc_cache_entry = {
    .src_address = connection_flow->tinc_cache_entry.src_address,
    .dst_address = connection_flow->tinc_cache_entry.dst_address,
    .dst_port = connection_flow->tinc_cache_entry.dst_port
  };

  cache_add(ndpi_struct->tinc_cache, &tinc_cache_entry, sizeof(tinc_cache_entry));

  NDPI_LOG_INFO(ndpi_struct, "found tinc tcp connection\n");
  ndpi_set_detected_protocol(ndpi_struct, connection_flow, NDPI_PROTOCOL_TINC, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI_CACHE);
}