while(i < payload_len && numbers_left > 0) {
  // Check for a sequence of digits
  u_int16_t start = i;
  while(i < payload_len && packet_payload[i] >= '0' && packet_payload[i] <= '9') i++;
  if(i == start) break; // No digits found
  if(i >= payload_len || packet_payload[i] != ' ') break; // Not followed by space
  i++; // Skip the space
  numbers_left--;
}
if(numbers_left == 0 && i < payload_len) {
  // Scan for alphanumeric until newline
  while(i < payload_len && ((packet_payload[i] >= 'a' && packet_payload[i] <= 'z') ||
                            (packet_payload[i] >= 'A' && packet_payload[i] <= 'Z') ||
                            (packet_payload[i] >= '0' && packet_payload[i] <= '9'))) i++;
  if(i < payload_len && packet_payload[i] == '\n') {
    connection_flow->tinc_state++;
    if(connection_flow->tinc_state > 3) {
      if(ndpi_struct->tinc_cache == NULL)
        ndpi_struct->tinc_cache = cache_new();
      if(ndpi_struct->tinc_cache != NULL) {
        cache_add(ndpi_struct->tinc_cache, &connection_flow->tinc_cache_entry, sizeof(connection_flow->tinc_cache_entry));
      }
      NDPI_LOG_INFO(ndpi_struct, "found tinc tcp connection\n");
      ndpi_set_detected_protocol(ndpi_struct, connection_flow, NDPI_PROTOCOL_TINC, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI);
    }
    return;
  }
}