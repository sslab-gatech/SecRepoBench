while(i < payload_len && numbers_left > 0) {
  // Skip the number
  while(i < payload_len && packet_payload[i] >= '0' && packet_payload[i] <= '9')
    i++;

  if(i >= payload_len || packet_payload[i] != ' ')
    break; // Expected a space after the number

  i++; // Move past the space
  numbers_left--;
}

if(numbers_left == 0) {
  // All required numbers found, now look for the newline
  while(i < payload_len && packet_payload[i] != '\n')
    i++;

  // Check if we found the newline
  if(i < payload_len && packet_payload[i] == '\n') {
    connection_flow->tinc_state++;

    if(connection_flow->tinc_state > 3) {
      // Ensure cache exists
      if(ndpi_struct->tinc_cache == NULL)
        ndpi_struct->tinc_cache = cache_new(NULL);

      if(ndpi_struct->tinc_cache != NULL) {
        // Add entry to cache
        cache_add(ndpi_struct->tinc_cache, 
                  &connection_flow->tinc_cache_entry, 
                  sizeof(connection_flow->tinc_cache_entry));

        NDPI_LOG_INFO(ndpi_struct, "found tinc tcp connection\n");
        ndpi_set_detected_protocol(ndpi_struct, connection_flow, 
                                  NDPI_PROTOCOL_TINC, NDPI_PROTOCOL_UNKNOWN, 
                                  NDPI_CONFIDENCE_DPI);
        return;
      }
    }
    return;
  }
}