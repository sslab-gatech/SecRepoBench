while(i < payload_len && numbers_left > 0) {
  if(packet_payload[i] >= '0' && packet_payload[i] <= '9') {
    u_int16_t j = i;
    while(j < payload_len && packet_payload[j] >= '0' && packet_payload[j] <= '9') {
      j++;
    }
    if(j < payload_len && packet_payload[j] =='') {
      numbers_left--;
      i = j + 1;
    } else {
      break;
    }
  } else {
    break;
  }
}
if(numbers_left == 0) {
  while(i < payload_len && packet_payload[i]!= '\n') {
    i++;
  }
  if(i < payload_len && packet_payload[i] == '\n') {
    connection_flow->tinc_state++;
    if(connection_flow->tinc_state > 3) {
      if(ndpi_struct->tinc_cache == NULL) {
        ndpi_struct->tinc_cache = cache_init();
      }
      if(ndpi_struct->tinc_cache!= NULL) {
        struct tinc_cache_entry tinc_cache_entry = {
         .src_address = packet->iph->saddr,
         .dst_address = packet->iph->daddr,
         .dst_port = packet->tcp->dest
        };
        cache_add(ndpi_struct->tinc_cache, &tinc_cache_entry, sizeof(tinc_cache_entry));
      }
      NDPI_LOG_INFO(ndpi_struct, "found tinc tcp connection\n");
      ndpi_set_detected_protocol(ndpi_struct, connection_flow, NDPI_PROTOCOL_TINC, NDPI_PROTOCOL_UNKNOWN, NDPI_CONFIDENCE_DPI_CACHE);
    }
  }
}