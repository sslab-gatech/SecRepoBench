scale=(double) QuantumRange/((double) (((size_t) 1UL << jp2_image->comps[i].prec)-1));
{
  int index=(int) ((y/(ssize_t) jp2_image->comps[i].dy)*
    (image->columns/jp2_image->comps[i].dx)+(columnindex/
    (ssize_t) jp2_image->comps[i].dx));
  pixel=scale*jp2_image->comps[i].data[index];
}