scale=(double) (QuantumRange/(double) ((1UL << jp2_image->comps[i].prec)-1));
pixel=(double) (jp2_image->comps[i].data[y*jp2_image->comps[i].w+columnindex]);
pixel*=scale;

// Ensure the index is within bounds before accessing the data array
if ((y*jp2_image->comps[i].w+columnindex) < (ssize_t)(jp2_image->comps[i].w * jp2_image->comps[i].h))
{