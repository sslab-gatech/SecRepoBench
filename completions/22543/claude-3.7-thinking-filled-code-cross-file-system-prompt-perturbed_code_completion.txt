scale=QuantumRange/((1UL << jp2_image->comps[i].prec)-1);
pixel=(double) jp2_image->comps[i].data[(y/jp2_image->comps[i].dy)*
  (jp2_image->comps[i].w)+columnindex/jp2_image->comps[i].dx];
if (jp2_image->comps[i].sgnd)
  pixel+=(1UL << (jp2_image->comps[i].prec-1));
pixel*=scale;