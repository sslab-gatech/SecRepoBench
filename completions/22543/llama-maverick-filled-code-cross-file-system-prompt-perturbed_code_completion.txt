scale=(double) (((size_t) 1UL << jp2_image->comps[i].prec)-1)/QuantumRange;
if (jp2_image->comps[i].sgnd != 0)
  pixel=(double) (((int) jp2_image->comps[i].data[(y/jp2_image->comps[i].dy*
    image->columns/jp2_image->comps[i].dx+columnindex/
    jp2_image->comps[i].dx)]+((int) (1UL << (jp2_image->comps[i].prec-1))));
else
  pixel=(double) jp2_image->comps[i].data[(y/jp2_image->comps[i].dy*
    image->columns/jp2_image->comps[i].dx+columnindex/
    jp2_image->comps[i].dx)];
pixel*=scale;