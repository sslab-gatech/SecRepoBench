scale=(double) (((size_t) 1UL << jp2_image->comps[i].prec)-1)/
          QuantumRange;
        if (jp2_image->comps[i].sgnd == 1)
          pixel=scale*(jp2_image->comps[i].data[y*
            (size_t) (jp2_image->comps[i].w)+columnindex]-
            ((size_t) 1 << (jp2_image->comps[i].prec-1))-1);
        else
          pixel=scale*jp2_image->comps[i].data[y*
            (size_t) jp2_image->comps[i].w+columnindex];