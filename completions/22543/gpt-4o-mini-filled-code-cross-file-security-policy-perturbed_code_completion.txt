scale = (double)(((size_t)1UL << jp2_image->comps[i].prec) - 1) / QuantumRange;
        if (columnindex >= 0 && columnindex < (ssize_t)image->columns && 
            y >= 0 && y < (ssize_t)image->rows) {
          pixel = scale * (double)(jp2_image->comps[i].data[y * jp2_image->comps[i].w + columnindex]);
        }