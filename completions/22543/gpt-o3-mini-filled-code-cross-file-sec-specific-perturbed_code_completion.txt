scale=(double) QuantumRange/(((size_t) 1UL << jp2_image->comps[i].prec)-1);
{
  ssize_t comp_x, comp_y, comp_width;
  comp_x=columnindex/jp2_image->comps[i].dx;
  comp_y=y/jp2_image->comps[i].dy;
  comp_width=jp2_image->comps[i].w/jp2_image->comps[i].dx;
  pixel=(double) jp2_image->comps[i].data[comp_y*comp_width+comp_x];
}