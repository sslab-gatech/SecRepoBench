scale=(double) (((size_t) 1UL << jp2_image->comps[i].prec)-1);
        if (jp2_image->comps[i].sgnd != 0)
          scale=scale/2.0;
        pixel=(double) jp2_image->comps[i].data[
          (ssize_t) (y/jp2_image->comps[i].dy*image->columns+
          columnindex)/jp2_image->comps[i].dx];
        if (jp2_image->comps[i].sgnd != 0)
          pixel+=(1.0 << (jp2_image->comps[i].prec-1));
        pixel=QuantumRange*(pixel/scale);