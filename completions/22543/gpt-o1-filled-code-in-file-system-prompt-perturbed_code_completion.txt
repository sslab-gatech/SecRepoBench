scale = (double) QuantumRange / (double) ((1ULL << jp2_image->comps[i].prec) - 1);
pixel = scale * (double) jp2_image->comps[i].data[
  (y / jp2_image->comps[i].dy) *
  (jp2_image->comps[i].w / jp2_image->comps[i].dx) +
  (columnindex / jp2_image->comps[i].dx)
];