scale=(double) QuantumRange/((double) ((size_t) 1UL << jp2_image->comps[i].prec)-1.0);
if (jp2_image->comps[i].sgnd != 0)
  pixel=(double) (jp2_image->comps[i].data[y*jp2_image->comps[i].w+columnindex]+
    ((int) ((size_t) 1UL << (jp2_image->comps[i].prec-1))));
else
  pixel=(double) jp2_image->comps[i].data[y*jp2_image->comps[i].w+columnindex];
pixel*=scale;