scale = (double)(((size_t)1UL << jp2_image->comps[i].prec) - 1) / QuantumRange;
pixel = (double)(jp2_image->comps[i].data[y / jp2_image->comps[i].dy * 
        (jp2_image->comps[i].w / jp2_image->comps[i].dx) + 
        columnindex / jp2_image->comps[i].dx]) / scale;