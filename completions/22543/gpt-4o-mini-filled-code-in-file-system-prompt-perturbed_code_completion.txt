pixel=(double) jp2_image->comps[i].data[y/jp2_image->comps[i].dy*image->columns/jp2_image->comps[i].dx+x/jp2_image->comps[i].dx);
scale=(double) (((size_t) 1UL << jp2_image->comps[i].prec)-1)/QuantumRange;