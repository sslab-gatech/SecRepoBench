if (!checkcpdtable.empty()) {
    for (size_t j = 0; j < checkcpdtable.size(); ++j) {
        if (isRevSubset(checkcpdtable[j].pattern2.c_str(), st.c_str() + i - 1, i)) {
            std::string newword = st.substr(0, i - checkcpdtable[j].pattern2.size());
            newword.append(checkcpdtable[j].pattern3);
            newword.append(st.substr(i));
            
            st = newword;
            i = i - checkcpdtable[j].pattern2.size() + checkcpdtable[j].pattern3.size();
            len = st.size();
            
            if (i < 0) i = 0;
            if (i > len) i = len;
            
            setcminmax(&cmin, &cmax, st.c_str(), len);
            
            break;
        }
    }
}