int denom = arrayZ[i].fromCoord - arrayZ[i-1].fromCoord;
if (denom == 0) {
  // Handle the case where two fromCoords are equal
  return arrayZ[i-1].toCoord;
} else {
  // Perform linear interpolation between the two segments
  return arrayZ[i-1].toCoord +
         ((arrayZ[i].toCoord - arrayZ[i-1].toCoord) *
          (inputvalue - arrayZ[i-1].fromCoord) + denom/2) / denom;
}