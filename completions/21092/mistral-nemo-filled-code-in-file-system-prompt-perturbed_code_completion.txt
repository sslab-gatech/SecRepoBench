if (inputvalue <= arrayZ[0].fromCoord)
  return inputvalue;
else if (inputvalue >= arrayZ[len-1].fromCoord)
  return inputvalue - arrayZ[len-1].fromCoord + arrayZ[len-1].toCoord;

int i = 0;
int j = len - 1;
while (i < j) {
  int mid = (i + j) / 2;
  if (inputvalue < arrayZ[mid].fromCoord)
    j = mid;
  else
    i = mid + 1;
}

int denom = arrayZ[i].fromCoord - arrayZ[i-1].fromCoord;
return arrayZ[i-1].toCoord +
       ((arrayZ[i].toCoord - arrayZ[i-1].toCoord) * (inputvalue - arrayZ[i-1].fromCoord) + denom/2) / denom;