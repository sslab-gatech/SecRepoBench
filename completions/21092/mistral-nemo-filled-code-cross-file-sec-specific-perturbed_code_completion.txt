if (inputvalue <= arrayZ[0].fromCoord)
  return inputvalue - arrayZ[0].fromCoord + arrayZ[0].toCoord;

unsigned int i = 1;
unsigned int denom = arrayZ[i].fromCoord - arrayZ[i-1].fromCoord;
while (inputvalue > arrayZ[i].fromCoord)
{
  i++;
  denom = arrayZ[i].fromCoord - arrayZ[i-1].fromCoord;
}

return arrayZ[i-1].toCoord +
       ((arrayZ[i].toCoord - arrayZ[i-1].toCoord) *
        (inputvalue - arrayZ[i-1].fromCoord) + denom/2) / denom;