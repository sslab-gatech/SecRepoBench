for (unsigned int i = 1; i < len; ++i) {
      if (inputvalue <= arrayZ[i].fromCoord) {
        return arrayZ[i-1].toCoord +
               ((arrayZ[i].toCoord - arrayZ[i-1].toCoord) *
                (inputvalue - arrayZ[i-1].fromCoord) + denom/2) / denom;
      }
    }
    // If the input value is greater than the last fromCoord, use the last segment's toCoord.
    return arrayZ[len-1].toCoord;
#undef toCoord
#undef fromCoord