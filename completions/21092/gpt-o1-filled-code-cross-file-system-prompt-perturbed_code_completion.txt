{
  if (inputvalue <= arrayZ[0].fromCoord)
    return inputvalue - arrayZ[0].fromCoord + arrayZ[0].toCoord;

  unsigned int i;
  for (i = 1; i < len; i++)
  {
    if (inputvalue < arrayZ[i].fromCoord)
      break;

    // Handle the case where two fromCoords are equal
    if (arrayZ[i].fromCoord == arrayZ[i - 1].fromCoord)
    {
      if (inputvalue == arrayZ[i].fromCoord)
        return arrayZ[i - 1].toCoord;
    }
  }

  // If the value is beyond the last fromCoord, clamp to the last segment
  if (i == len)
    i = len - 1;

  int denom = arrayZ[i].fromCoord - arrayZ[i - 1].fromCoord;
  if (!denom)
    return arrayZ[i - 1].toCoord;
}