int i;
for (i = 0; i < len; i++)
{
  if (inputvalue <= arrayZ[i].fromCoord)
  {
    if (i == 0)
      return inputvalue - arrayZ[i].fromCoord + arrayZ[i].toCoord;
    else
      return arrayZ[i-1].toCoord +
             ((arrayZ[i].toCoord - arrayZ[i-1].toCoord) *
              (inputvalue - arrayZ[i-1].fromCoord) + (arrayZ[i].fromCoord - arrayZ[i-1].fromCoord)/2) /
             (arrayZ[i].fromCoord - arrayZ[i-1].fromCoord);
  }
}
// Handle the case where the input value is beyond the last segment
if (i == len)
  return arrayZ[i-1].toCoord +
         ((arrayZ[i-1].toCoord - arrayZ[i-2].toCoord) *
          (inputvalue - arrayZ[i-2].fromCoord) + (arrayZ[i-1].fromCoord - arrayZ[i-2].fromCoord)/2) /
         (arrayZ[i-1].fromCoord - arrayZ[i-2].fromCoord);