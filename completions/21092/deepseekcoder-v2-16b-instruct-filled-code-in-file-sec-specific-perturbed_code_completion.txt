unsigned int i = 1;
    while (i < len && inputvalue > arrayZ[i].fromCoord) i++;
    if (i == 0) return arrayZ[0].toCoord;
    if (i == len) return arrayZ[len-1].toCoord;

    F2DOT14 denom = arrayZ[i].fromCoord - arrayZ[i-1].fromCoord;
    if (denom == 0) return arrayZ[i-1].toCoord;

    return arrayZ[i-1].toCoord +
	   ((arrayZ[i].toCoord - arrayZ[i-1].toCoord) *
	    (inputvalue - arrayZ[i-1].fromCoord) + denom/2) / denom;