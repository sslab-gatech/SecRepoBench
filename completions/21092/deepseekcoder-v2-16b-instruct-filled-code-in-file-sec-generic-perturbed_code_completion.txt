// Calculate the denominator for linear interpolation between two segments.
    F2DOT14 denom = arrayZ[i].fromCoord - arrayZ[i-1].fromCoord;
    if (denom == 0) {
        // Handle the case where the denominator is zero to avoid division by zero.
        // This is a simple fallback, you might want to handle this case more gracefully.
        return arrayZ[i-1].toCoord;
    }

    // Perform linear interpolation between the two segments.
    return arrayZ[i-1].toCoord +
           ((arrayZ[i].toCoord - arrayZ[i-1].toCoord) *
            (inputvalue - arrayZ[i-1].fromCoord) + denom/2) / denom;