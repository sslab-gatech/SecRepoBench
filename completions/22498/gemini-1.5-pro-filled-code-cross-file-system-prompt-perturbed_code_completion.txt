for(a = 0; a < packet->payload_packet_len - 1 && packet->parsed_lines < NDPI_MAX_PACKET_LINES; a++) {
    if(packet->payload[a] == '\r' && packet->payload[a + 1] == '\n') {
      packet->line[packet->parsed_lines].len =
	(u_int16_t)(((unsigned long) &packet->payload[a]) -
		    ((unsigned long) packet->line[packet->parsed_lines].ptr));

      if(packet->line[packet->parsed_lines].len == 0)
	packet->empty_line_position_in_packet = packet->parsed_lines;

      packet->parsed_lines++;
      if(packet->parsed_lines < NDPI_MAX_PACKET_LINES) {
	packet->line[packet->parsed_lines].ptr = &packet->payload[a + 2];
	packet->line[packet->parsed_lines].len = 0;
      }
      a++;

      if(packet->payload[a + 1] == '\r' && packet->payload[a + 2] == '\n') {
	if(dataflow->initial_binary_bytes_parsed == 0) {
	  dataflow->initial_binary_bytes = &packet->payload[a + 3];
	  dataflow->initial_binary_bytes_len = packet->payload_packet_len - (a + 3);
	  dataflow->initial_binary_bytes_parsed = 1;
	}
	break;
      }
    }
  }