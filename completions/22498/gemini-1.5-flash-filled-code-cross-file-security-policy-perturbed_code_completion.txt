for(a = 0; a < packet->payload_packet_len; a++) {
    if(a + 1 < packet->payload_packet_len) {
      if(packet->payload[a] == '\r' && packet->payload[a+1] == '\n') {
	packet->line[packet->parsed_lines].len = (u_int16_t) (a - ((unsigned long)packet->line[packet->parsed_lines].ptr - (unsigned long)packet->payload));
	if(a + 2 < packet->payload_packet_len) {
	  if(packet->payload[a+2] == '\r' && packet->payload[a+3] == '\n') {
	    a += 4;
	    if (dataflow->initial_binary_bytes == NULL) {
	      dataflow->initial_binary_bytes = &packet->payload[a];
	      dataflow->initial_binary_bytes_len = packet->payload_packet_len - a;
	    }
	  } else {
	    a += 2;
	  }
	} else {
	  a += 2;
	}
	packet->parsed_lines++;
	if(packet->parsed_lines >= NDPI_MAX_PACKET_LINES)
	  break;
	packet->line[packet->parsed_lines].ptr = &packet->payload[a];
	packet->line[packet->parsed_lines].len = 0;
      }
    }
  }