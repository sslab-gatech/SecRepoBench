while (a < end) {
    if(packet->payload[a] == 0x0d) {
      if(a + 1 < end && packet->payload[a + 1] == 0x0a) {
        packet->line[packet->parsed_lines].len = (u_int16_t)(a - packet->line[packet->parsed_lines].ptr);
        packet->parsed_lines++;
        a++; // Skip the next character (0x0a)
      }
      a++; // Move to the next character
      continue;
    } else if(packet->payload[a] == 0x0a) {
      packet->line[packet->parsed_lines].len = (u_int16_t)(a - packet->line[packet->parsed_lines].ptr);
      packet->parsed_lines++;
    }
    a++;
  }