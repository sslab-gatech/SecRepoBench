for(a = 0; a < packet->payload_packet_len; a++) {
    if((packet->payload[a] == '\r') && (a+1 < packet->payload_packet_len) && (packet->payload[a+1] == '\n')) {
      packet->line[packet->parsed_lines].len =
        (u_int16_t)(((unsigned long) &packet->payload[a]) -
                    ((unsigned long) packet->line[packet->parsed_lines].ptr));
      packet->parsed_lines++;

      if((a+3 < packet->payload_packet_len) && (packet->payload[a+2] == '\r') && (packet->payload[a+3] == '\n')) {
        dataflow->initial_binary_bytes_len = packet->payload_packet_len - (a+4);
        if(dataflow->initial_binary_bytes_len > 0) {
          memcpy(dataflow->initial_binary_bytes, &packet->payload[a+4], dataflow->initial_binary_bytes_len);
        }
        break;
      } else {
        a++;
        packet->line[packet->parsed_lines].ptr = &packet->payload[a+1];
      }
    }
  }