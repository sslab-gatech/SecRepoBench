// <MASK>
for(a = 0; a < packet->payload_packet_len; a++) {
  if(packet->payload[a] == '\r' && ((a + 1) < packet->payload_packet_len) && packet->payload[a + 1] == '\n') {
    if(packet->parsed_lines >= (NDPI_MAX_PARSE_LINES_PER_PACKET - 1)) {
      break;
    }

    packet->line[packet->parsed_lines].len = (u_int16_t)(((unsigned long) &packet->payload[a]) -
                                                        ((unsigned long) packet->line[packet->parsed_lines].ptr));
    packet->parsed_lines++;

    if(((a + 3) < packet->payload_packet_len) &&
       packet->payload[a + 2] == '\r' && packet->payload[a + 3] == '\n') {
      packet->empty_line_position = packet->parsed_lines;
      a += 2;
    }

    packet->line[packet->parsed_lines].ptr = &packet->payload[a + 2];
    packet->line[packet->parsed_lines].len = 0;
    a++;
  }
}