for(a = 0; a < packet->payload_packet_len; a++) {
    if((a > 0) && (packet->payload[a-1] == '\r') && (packet->payload[a] == '\n')) {
      if((a > 1) && (packet->payload[a-2] == '\n') && (packet->payload[a-3] == '\r')) {
        // End of headers
        packet->initial_binary_bytes_len = packet->payload_packet_len - a - 1;
        if(packet->initial_binary_bytes_len > 0) {
          memcpy(packet->initial_binary_bytes, &packet->payload[a+1], packet->initial_binary_bytes_len);
        }
        break;
      } else {
        packet->line[packet->parsed_lines].len =
          (u_int16_t)(((unsigned long) &packet->payload[a+1]) -
                      ((unsigned long) packet->line[packet->parsed_lines].ptr));
        packet->parsed_lines++;
        if(packet->parsed_lines >= MAX_PACKET_LINES)
          break;
        packet->line[packet->parsed_lines].ptr = &packet->payload[a+1];
        packet->line[packet->parsed_lines].len = 0;
      }
    }
  }