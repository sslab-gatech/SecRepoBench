{
  u_int32_t i = 0;
  /* Parse payload by scanning for "\r\n" line delimiters.
     Assume NDPI_MAX_PACKET_LINES is defined elsewhere to limit the number of parsed lines. */
  while(i < packet->payload_packet_len - 1 && packet->parsed_lines < NDPI_MAX_PACKET_LINES - 1) {
    if(packet->payload[i] == '\r' && packet->payload[i+1] == '\n') {
      // Check if we encountered the header/body separator "\r\n\r\n"
      if(i + 3 < packet->payload_packet_len &&
         packet->payload[i+2] == '\r' && packet->payload[i+3] == '\n') {
        // Store remaining bytes (after the double CRLF) as initial binary data.
        dataflow->initial_binary_bytes.ptr = &packet->payload[i+4];
        dataflow->initial_binary_bytes.len = packet->payload_packet_len - (i + 4);
        break;
      } else {
        // Set the length of the current line.
        packet->line[packet->parsed_lines].len =
          (u_int16_t)(i - ((unsigned long)packet->line[packet->parsed_lines].ptr - (unsigned long)packet->payload));
        packet->parsed_lines++;
        // If room is available, initialize the next line start pointer.
        if(packet->parsed_lines < NDPI_MAX_PACKET_LINES) {
          packet->line[packet->parsed_lines].ptr = &packet->payload[i+2];
          packet->line[packet->parsed_lines].len = 0;
        }
        i += 2;
        continue;
      }
    }
    i++;
  }

  /* If the first line begins with "HTTP/", analyze it for response status codes.
     This is a placeholder for the actual HTTP status code processing. */
  if(packet->parsed_lines > 0 && packet->line[0].len >= 5 &&
     !memcmp(packet->line[0].ptr, "HTTP/", 5)) {
    // For example, extract and process the HTTP status code here.
    // (Actual implementation depends on where and how the status code should be stored.)
  }

  /* Loop through parsed header lines to identify specific HTTP headers.
     This example demonstrates checking for "Server:", "Host:" and "Content-Type:" headers. */
  for(u_int16_t j = 1; j < packet->parsed_lines; j++) {
    if(packet->line[j].len >= 7 && !strncasecmp(packet->line[j].ptr, "Server:", 7)) {
      // Process or store the Server header information.
    } else if(packet->line[j].len >= 5 && !strncasecmp(packet->line[j].ptr, "Host:", 5)) {
      // Process or store the Host header information.
    } else if(packet->line[j].len >= 13 && !strncasecmp(packet->line[j].ptr, "Content-Type:", 13)) {
      // Process or store the Content-Type header information.
    }
    /* Add additional header processing as needed... */
  }
}