for(a = 0; a < packet->payload_packet_len; a++) {
    if(packet->parsed_lines >= NDPI_MAX_PACKET_LINES)
      break;

    if((a + 1) < packet->payload_packet_len &&
       packet->payload[a] == '\r' && packet->payload[a + 1] == '\n') {
      /* Line end found */
      packet->line[packet->parsed_lines].len = (u_int16_t)(&packet->payload[a] - packet->line[packet->parsed_lines].ptr);
      packet->parsed_lines++;

      if((a + 3) < packet->payload_packet_len &&
	 packet->payload[a + 2] == '\r' && packet->payload[a + 3] == '\n') {
	/* \r\n\r\n found */
	a += 4;
	if(a < packet->payload_packet_len) {
	  u_int remaining_len = packet->payload_packet_len - a;
	    
	  if(remaining_len > NDPI_FLOW_INITIAL_BINARY_DATA)
	    remaining_len = NDPI_FLOW_INITIAL_BINARY_DATA;

	  memcpy(dataflow->initial_binary_data, &packet->payload[a], remaining_len);
	  dataflow->initial_binary_data_len = remaining_len;
	}
	break;
      } else {
	if(packet->parsed_lines < NDPI_MAX_PACKET_LINES) {
	  packet->line[packet->parsed_lines].ptr = &packet->payload[a + 2];
	  packet->line[packet->parsed_lines].len = 0;
	  a++;
	} else
	  break;
      }
    }
  }