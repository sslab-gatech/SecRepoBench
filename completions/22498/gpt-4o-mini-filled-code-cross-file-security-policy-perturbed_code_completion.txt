u_int32_t i = 0;
  while (i < packet->payload_packet_len - 1) {
    if (packet->payload[i] == '\r' && packet->payload[i + 1] == '\n') {
      packet->line[packet->parsed_lines].len = i;
      packet->parsed_lines++;

      if (packet->parsed_lines >= MAX_LINES) {
        break; // Prevent exceeding the maximum number of lines
      }

      packet->line[packet->parsed_lines].ptr = &packet->payload[i + 2];
      packet->line[packet->parsed_lines].len = 0;
      i += 2; // Move past the "\r\n"
    } else {
      i++;
    }
  }

  // Handle the last line if it doesn't end with "\r\n"
  if (packet->parsed_lines < MAX_LINES && i < packet->payload_packet_len) {
    packet->line[packet->parsed_lines].len = i;
    packet->parsed_lines++;
  }