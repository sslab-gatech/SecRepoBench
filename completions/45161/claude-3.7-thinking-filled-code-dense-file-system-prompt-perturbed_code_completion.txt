// Check if the current bit is set in the Valid field.
if (!((yr_le64toh(tilde_header->Valid) >> bit_check) & 0x01))
  continue;

// Get the number of rows for this table.
if (fits_in_pe(pe_struct, row_offset, (matched_bits + 1) * sizeof(uint32_t)))
  num_rows = yr_le32toh(*(row_offset + matched_bits));
else
  num_rows = 0;

// Skip this table if it has no rows.
if (num_rows == 0)
{
  matched_bits++;
  continue;
}