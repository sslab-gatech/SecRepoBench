if (!fits_in_pe(pe_struct, table_offset, sizeof(uint32_t)))
      return;

    row_count = *(uint32_t*)row_offset;

    if (row_count > (0xFFFF >> 0x02))
      index_size = 4;
    else
      index_size = 2;

    if (row_count == 0)
      continue;

    if (!fits_in_pe(pe_struct, table_offset, row_count * (index_size + sizeof(uint32_t))))
      return;