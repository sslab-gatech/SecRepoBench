if (!fits_in_pe(pe_struct, table_offset, sizeof(uint32_t)))
      break;

    num_rows = yr_le32toh(*(uint32_t*)row_offset);
    if (num_rows > (0xFFFF >> (bit_check == BIT_ASSEMBLY ? 0x02 : 0x01)))
      index_size = 4;
    else
      index_size = 2;

    if (num_rows == 0)
      continue;