// <MASK>
if (valid_rows == 0)
  return;

row_offset += sizeof(uint32_t) * valid_rows;

table_offset = (uint8_t*) row_offset;
table_offset += sizeof(uint32_t) * valid_rows;

for (i = 0; i < valid_rows; i++)
{
  if (!fits_in_pe(pe_struct, table_offset, row_size))
    break;

  // Parse the table.
  // ...

  table_offset += row_size;
}