if (entry_result)
  affixed = 0;

if (!entry_result) {
  if (onlycpdrule)
    break;
  if (compoundflag &&
      !(entry_result = prefix_check(st, 0, i,
                          hu_mov_rule ? IN_CPD_OTHER : IN_CPD_BEGIN,
                          compoundflag))) {
    if (((entry_result = suffix_check(
              st, 0, i, 0, NULL, FLAG_NULL, compoundflag,
              hu_mov_rule ? IN_CPD_OTHER : IN_CPD_BEGIN)) ||
         (compoundmoresuffixes &&
          (entry_result = suffix_check_twosfx(st, 0, i, 0, NULL, compoundflag)))) &&
        !hu_mov_rule && sfx->getCont() &&
        ((compoundforbidflag &&
          TESTAFF(sfx->getCont(), compoundforbidflag,
                  sfx->getContLen())) ||
         (compoundend &&
          TESTAFF(sfx->getCont(), compoundend, sfx->getContLen())))) {
      entry_result = NULL;
    }
  }

  if (entry_result ||
      (((wordnum == 0) && compoundbegin &&
        ((entry_result = suffix_check(
              st, 0, i, 0, NULL, FLAG_NULL, compoundbegin,
              hu_mov_rule ? IN_CPD_OTHER : IN_CPD_BEGIN)) ||
         (compoundmoresuffixes &&
          (entry_result = suffix_check_twosfx(
               st, 0, i, 0, NULL,
               compoundbegin))) ||  // twofold suffixes + compound
         (entry_result = prefix_check(st, 0, i,
                            hu_mov_rule ? IN_CPD_OTHER : IN_CPD_BEGIN,
                            compoundbegin)))) ||
       ((wordnum > 0) && compoundmiddle &&
        ((entry_result = suffix_check(
              st, 0, i, 0, NULL, FLAG_NULL, compoundmiddle,
              hu_mov_rule ? IN_CPD_OTHER : IN_CPD_BEGIN)) ||
         (compoundmoresuffixes &&
          (entry_result = suffix_check_twosfx(
               st, 0, i, 0, NULL,
               compoundmiddle))) ||  // twofold suffixes + compound
         (entry_result = prefix_check(st, 0, i,
                            hu_mov_rule ? IN_CPD_OTHER : IN_CPD_BEGIN,
                            compoundmiddle))))))
    checked_prefix = 1;
  // else check forbiddenwords and needaffix
} else if (entry_result->astr && (TESTAFF(entry_result->astr, forbiddenword, entry_result->alen) ||
                        TESTAFF(entry_result->astr, needaffix, entry_result->alen) ||
                        TESTAFF(entry_result->astr, ONLYUPCASEFLAG, entry_result->alen) ||
                        (is_sug && nosuggest &&
                         TESTAFF(entry_result->astr, nosuggest, entry_result->alen)))) {
  st[i] = ch;
  break;
}

// check non_compound flag in suffix and prefix
if ((entry_result) && !hu_mov_rule &&
    ((pfx && pfx->getCont() &&
      TESTAFF(pfx->getCont(), compoundforbidflag, pfx->getContLen())) ||
     (sfx && sfx->getCont() &&
      TESTAFF(sfx->getCont(), compoundforbidflag,
              sfx->getContLen())))) {
  entry_result = NULL;
}

// check compoundend flag in suffix and prefix
if ((entry_result) && !checked_prefix && compoundend && !hu_mov_rule &&
    ((pfx && pfx->getCont() &&
      TESTAFF(pfx->getCont(), compoundend, pfx->getContLen())) ||
     (sfx && sfx->getCont() &&
      TESTAFF(sfx->getCont(), compoundend, sfx->getContLen())))) {
  entry_result = NULL;
}

// check compoundmiddle flag in suffix and prefix
if ((entry_result) && !checked_prefix && (wordnum == 0) && compoundmiddle &&
    !hu_mov_rule &&
    ((pfx && pfx->getCont() &&
      TESTAFF(pfx->getCont(), compoundmiddle, pfx->getContLen())) ||
     (sfx && sfx->getCont() &&
      TESTAFF(sfx->getCont(), compoundmiddle, sfx->getContLen())))) {
  entry_result = NULL;
}

// check forbiddenwords
if ((entry_result) && (entry_result->astr) &&
    (TESTAFF(entry_result->astr, forbiddenword, entry_result->alen) ||
     TESTAFF(entry_result->astr, ONLYUPCASEFLAG, entry_result->alen) ||
     (is_sug && nosuggest && TESTAFF(entry_result->astr, nosuggest, entry_result->alen)))) {
  return NULL;
}

// increment word number, if the second root has a compoundroot flag
if ((entry_result) && (compoundroot) &&
    (TESTAFF(entry_result->astr, compoundroot, entry_result->alen))) {
  wordnum++;
}