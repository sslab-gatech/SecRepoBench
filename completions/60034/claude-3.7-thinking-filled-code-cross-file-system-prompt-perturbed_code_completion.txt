if (entry_result && compoundforbidflag &&
    TESTAFF(entry_result->astr, compoundforbidflag, entry_result->alen)) {
  if (hu_mov_rule) {
    // LANG_hu section: spec. Hungarian rule
    // Skip entries with COMPOUNDFORBIDFLAG if using Hungarian rules
    while (entry_result &&
           TESTAFF(entry_result->astr, compoundforbidflag, entry_result->alen))
      entry_result = entry_result->next_homonym;
  } else {
    // Otherwise, reject the entry
    entry_result = NULL;
  }
}

// Check various conditions for homonyms to find a valid one
while (entry_result && !hu_mov_rule &&
       ((needaffix && TESTAFF(entry_result->astr, needaffix, entry_result->alen)) ||
        (onlyincompound && TESTAFF(entry_result->astr, onlyincompound, entry_result->alen)) ||
        !(
            // Check compound flags
            (!compoundflag || TESTAFF(entry_result->astr, compoundflag, entry_result->alen)) &&
            (!compoundbegin || !wordnum || 
             TESTAFF(entry_result->astr, compoundbegin, entry_result->alen)) &&
            (!compoundmiddle || wordnum || !words || 
             TESTAFF(entry_result->astr, compoundmiddle, entry_result->alen))
         )
       )) {
  // Try the next homonym
  entry_result = entry_result->next_homonym;
}