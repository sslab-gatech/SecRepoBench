if (entry_result && entry_result->astr) {
            while (entry_result) {
                // Check if current entry is forbidden in compounds and not allowed by Hungarian rule
                if (compoundforbidflag && TESTAFF(entry_result->astr, compoundforbidflag, entry_result->alen) && !hu_mov_rule) {
                    entry_result = entry_result->next_homonym;
                    if (simplifiedcpd) break; // Prevent infinite loop in simplified mode
                    continue;
                }
                // Check compound flags and pattern conditions
                if ((compoundflag && TESTAFF(entry_result->astr, compoundflag, entry_result->alen)) ||
                    (wordnum == 0 && compoundbegin && TESTAFF(entry_result->astr, compoundbegin, entry_result->alen)) ||
                    (wordnum > 0 && compoundmiddle && TESTAFF(entry_result->astr, compoundmiddle, entry_result->alen)) ||
                    (scpd == 0 || checkcpdtable[scpd - 1].cond == FLAG_NULL || 
                     TESTAFF(entry_result->astr, checkcpdtable[scpd - 1].cond, entry_result->alen))) {
                    break;
                }
                entry_result = entry_result->next_homonym;
            }
            if (!entry_result) affixed = 1; // No valid homonym found
        }