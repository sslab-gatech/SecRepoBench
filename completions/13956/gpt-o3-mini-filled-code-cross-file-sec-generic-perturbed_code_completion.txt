{
    const char* p = str_table_base;

    if (entry_index < 0)
        return NULL;

    for (int i = 0; i < entry_index; i++)
    {
        size_t remaining = str_table_limit - p;
        const char* null_pos = memchr(p, '\0', remaining);
        if (null_pos == NULL)
            return NULL;  // invalid entry: no null terminator found

        p = null_pos + 1;
        if (p >= str_table_limit)
            return NULL;  // reached the end of the table before desired index
    }

    // Validate that the returned entry is null-terminated within the table boundaries.
    if (memchr(p, '\0', str_table_limit - p) == NULL)
        return NULL;

    return p;
}