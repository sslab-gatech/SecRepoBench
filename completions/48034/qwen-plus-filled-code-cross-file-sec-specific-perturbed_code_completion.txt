responsetype = get16(&x, packet->payload);
rsp_ttl = ntohl(get32(&x, packet->payload));

if (rsp_ttl == 0) {
  ndpi_set_risk(ndpi_struct, flow, NDPI_SUSPICIOUS_DNS_TRAFFIC, "DNS Response with Zero TTL");
}

#ifdef DNS_DEBUG
NDPI_LOG_DBG2(ndpi_struct, "response_ttl=%u response_type=%2d\n", rsp_ttl, responsetype);
printf("[DNS] [response] ttl=%u type=%d\n", rsp_ttl, responsetype);
#endif

// Perform additional checks on the DNS response type
if ((responsetype != 0x01 /* A */) && (responsetype != 0x05 /* CNAME */) && (responsetype != 0x1C /* AAAA */)) {
  ndpi_set_risk(ndpi_struct, flow, NDPI_MALFORMED_PACKET, "Unexpected DNS Response Type");
}