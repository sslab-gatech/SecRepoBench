if(responsetype == 0x05 /* CNAME */) {
  x += data_len;
  continue; /* Skip CNAME */
}

if((((responsetype == 0x1) && (data_len == 4)) /* A */
    || ((responsetype == 0x1c) && (data_len == 16)) /* AAAA */
    )) {
  memcpy(&flow->protos.dns.rsp_addr, packet->payload + x, data_len);
  if(responsetype == 0x1c) {
    flow->protos.dns.rsp_addr6 = ntohl(*((u_int32_t*)(&packet->payload[x])));
  }
}