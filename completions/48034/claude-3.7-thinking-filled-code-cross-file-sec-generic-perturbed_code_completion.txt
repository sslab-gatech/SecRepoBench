responsetype = get16(&x, packet->payload);  /* Read type, advance x by 2 */

/* At this point, x points to the class field, which matches the comment after the mask */

/* Look ahead to read the TTL */
if((x+6) <= packet->payload_packet_len) {
  u_int16_t tmp_x = x;
  tmp_x += 2;  /* Skip class */
  rsp_ttl = get32(&tmp_x, packet->payload);

  if(rsp_ttl == 0) {
    ndpi_set_risk(ndpi_struct, flow, NDPI_SUSPICIOUS_SHORT_LIVED_DNS_ENTRY, "Zero TTL in DNS Response");
  }

#ifdef DNS_DEBUG
  NDPI_LOG_DBG2(ndpi_struct, "TTL=%u, responsetype=%u\n", rsp_ttl, responsetype);
  printf("[DNS] [response] TTL=%u, responsetype=%u\n", rsp_ttl, responsetype);
#endif
}