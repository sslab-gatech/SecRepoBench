if((x + 10) > packet->payload_packet_len) {
            break; // Prevent buffer overflow
          }

          responsetype = get16(&x, packet->payload); // Extract response type
          rsp_ttl = get32(&x, packet->payload); // Extract TTL

          if(rsp_ttl == 0) {
            ndpi_set_risk(ndpi_struct, flow, NDPI_SUSPICIOUS_TTL, "DNS Response with TTL=0");
#ifdef DNS_DEBUG
            NDPI_LOG_DBG2(ndpi_struct, "Suspicious DNS response with TTL=0, responsetype=%u\n", responsetype);
#endif
          }

#ifdef DNS_DEBUG
          NDPI_LOG_DBG2(ndpi_struct, "DNS response type=%u, TTL=%u\n", responsetype, rsp_ttl);
#endif

          // Check for specific response types
          if(responsetype == 0x05 /* CNAME */) {
            // Handle CNAME response type
            continue; // Skip further processing for CNAME
          } else if(responsetype == 0x01 /* A */ || responsetype == 0x1c /* AAAA */) {
            // Handle A or AAAA response types
            // Ensure no buffer overflow when accessing payload
            if((x + 4) <= packet->payload_packet_len) {
              memcpy(&flow->protos.dns.rsp_addr, packet->payload + x, 4);
              x += 4; // Move pointer past the address
            } else {
              break; // Prevent buffer overflow
            }
          }