{
  size_t tmp_offset = x;
  if (tmp_offset + 8 > packet->payload_packet_len) {
    break;
  }
  u_int16_t type_local = get16(&tmp_offset, packet->payload);
  /* Skip the class field (2 bytes) */
  tmp_offset += 2;
  u_int32_t ttl = get32(&tmp_offset, packet->payload);
  if (ttl == 0) {
    ndpi_set_risk(ndpi_struct, flow, NDPI_MALFORMED_PACKET, "DNS TTL is zero");
  }
#ifdef DNS_DEBUG
  NDPI_LOG_DBG2(ndpi_struct, "rsp_type=%u, ttl=%u\n", type_local, ttl);
#endif
  responsetype = type_local;
}