responsetype = get16(&x, packet->payload);
rsp_ttl = ntohl(get32(&x, packet->payload));

if (rsp_ttl == 0) {
  ndpi_set_risk(ndpi_struct, flow, NDPI_SUSPICIOUS_DNS_TTL, "DNS Response with Zero TTL");
}

#ifdef DNS_DEBUG
NDPI_LOG_DBG2(ndpi_struct, "response_type=%2d ttl=%u\n", responsetype, rsp_ttl);
printf("[DNS] [response] response_type=%d ttl=%u\n", responsetype, rsp_ttl);
#endif

if (responsetype != 0x05 /* CNAME */ && 
    responsetype != 0x1 /* A */ && 
    responsetype != 0x1c /* AAAA */) {
  ndpi_set_risk(ndpi_struct, flow, NDPI_UNUSUAL_DNS_RESPONSE_TYPE, "Unexpected DNS Response Type");
}