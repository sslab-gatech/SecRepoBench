responsetype = get16(&x, packet->payload);
rsp_ttl = ntohl(get_u_int32_t(packet->payload, x));
x += 4; // Skip TTL field

if(rsp_ttl == 0) {
  ndpi_set_risk(ndpi_struct, flow, NDPI_ZERO_TTL_SUSPICIOUS_DNS, "Zero TTL in DNS Response");
}

#ifdef DNS_DEBUG
NDPI_LOG_DBG2(ndpi_struct, "TTL: %u, Type: %u\n", rsp_ttl, responsetype);
printf("[DNS] [response] type=%d, ttl=%u\n", responsetype, rsp_ttl);
#endif