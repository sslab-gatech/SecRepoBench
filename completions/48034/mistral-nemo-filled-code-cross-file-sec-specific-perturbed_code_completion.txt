if((x+12) <= packet->payload_packet_len) {
  x += 6;
  data_len = get16(&x, packet->payload);

  if((x + data_len) <= packet->payload_packet_len) {
    // Extract the response type and TTL (Time-To-Live) from the DNS response section.
    flow->protos.dns.rsp_type = get16(&x, packet->payload);
    flow->protos.dns.rsp_ttl = get32(&x, packet->payload);

    if(flow->protos.dns.rsp_ttl == 0) {
      ndpi_set_risk(ndpi_struct, flow, NDPI_SUSPICIOUS_DNS_TTL, "Zero TTL in DNS Response");
    }

#ifdef DNS_DEBUG
    NDPI_LOG_DBG2(ndpi_struct, "TTL=%u, response_type=%u\n", flow->protos.dns.rsp_ttl, flow->protos.dns.rsp_type);
    printf("[DNS] [reply] TTL=%u, response_type=%u\n", flow->protos.dns.rsp_ttl, flow->protos.dns.rsp_type);
#endif

    // Perform a check on the DNS response type to further analyze the response.
    // ...
  }
}