responsetype = get16(&x, packet->payload);

/* Peek ahead to read the class and TTL without consuming them, so the existing
 * code that follows remains consistent. We skip 6 bytes (class + TTL) in total.
 */
if((x + 6) <= packet->payload_packet_len) {
  u_int16_t dns_class = ntohs(*(u_int16_t *)&packet->payload[x]);
  rsp_ttl = ntohl(*(u_int32_t *)&packet->payload[x + 2]);

  /* Set a risk flag if TTL is zero, indicating suspicious DNS traffic */
  if(rsp_ttl == 0) {
    ndpi_set_risk(ndpi_struct, flow, NDPI_SUSPICIOUS_DNS_TRAFFIC, "DNS response TTL=0");
  }

#ifdef DNS_DEBUG
  NDPI_LOG_DBG2(ndpi_struct, "DNS: response type=%u, class=%u, TTL=%u\n",
                responsetype, dns_class, rsp_ttl);
  printf("[DNS] [response] type=%u, class=%u, TTL=%u\n",
         responsetype, dns_class, rsp_ttl);
#endif

  /* Optionally, perform further checks on the response type or class here */
}

/* Do not advance x here, so the code that follows remains correct,
 * as it expects x to point to the 'class' field.
 */