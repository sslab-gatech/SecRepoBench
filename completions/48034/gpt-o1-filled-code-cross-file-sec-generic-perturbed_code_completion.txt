/* Extract the response type (2 bytes) */
responsetype = get16(&x, packet->payload);

/* Extract the TTL (4 bytes) */
rsp_ttl = ((u_int32_t)get16(&x, packet->payload) << 16) | get16(&x, packet->payload);

/* Set a risk flag if the TTL is zero (suspicious DNS traffic) */
if(rsp_ttl == 0) {
  ndpi_set_risk(ndpi_struct, flow, NDPI_MALFORMED_PACKET, "DNS TTL is zero");
}

/* Output debug info about TTL and response type if DNS debugging is enabled */
#ifdef DNS_DEBUG
NDPI_LOG_DBG2(ndpi_struct, "DNS response type=%u, TTL=%u\n", responsetype, rsp_ttl);
printf("[DNS] [response] type=%u, TTL=%u\n", responsetype, rsp_ttl);
#endif

/* Additional checks on the DNS response type could be performed here */