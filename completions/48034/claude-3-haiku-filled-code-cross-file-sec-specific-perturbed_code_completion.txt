// Extract the response type and TTL (Time-To-Live) from the DNS response section.
responsetype = get16(&x, packet->payload);
rsp_ttl = get32(&x, packet->payload);

#ifdef DNS_DEBUG
NDPI_LOG_DBG2(ndpi_struct, "rsp_type=%2d, rsp_ttl=%u\n", responsetype, rsp_ttl);
printf("[DNS] [response] rsp_type=%d, rsp_ttl=%u\n", responsetype, rsp_ttl);
#endif

// Set a risk flag if the TTL is zero, indicating suspicious DNS traffic.
if (rsp_ttl == 0) {
  ndpi_set_risk(ndpi_struct, flow, NDPI_SUSPICIOUS_DGA_DOMAIN, "DNS response with zero TTL");
}

// Perform a check on the DNS response type to further analyze the response.
switch (responsetype) {
  case 0x01: // A record
  case 0x1C: // AAAA record
    // Handle A and AAAA records
    break;
  case 0x05: // CNAME record
    // Handle CNAME records
    break;
  default:
    // Handle other record types
    break;
}