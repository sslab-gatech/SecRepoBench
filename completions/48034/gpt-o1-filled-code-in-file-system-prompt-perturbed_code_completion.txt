responsetype = get16(&x, packet->payload);
/* Extract TTL (time-to-live) from DNS response */
rsp_ttl = ntohl(*(u_int32_t *)&packet->payload[x]);
x += 4;

/* Set a risk alert if TTL is zero */
if(rsp_ttl == 0) {
  ndpi_set_risk(ndpi_struct, flow, NDPI_DNS_SUSPICIOUS_TRAFFIC, "DNS Answer with Zero TTL");
}

#ifdef DNS_DEBUG
NDPI_LOG_DBG2(ndpi_struct, "DNS response type=%u, TTL=%u\n", responsetype, rsp_ttl);
#endif

/* Analyze the DNS response type */
ndpi_check_dns_type(ndpi_struct, flow, responsetype);