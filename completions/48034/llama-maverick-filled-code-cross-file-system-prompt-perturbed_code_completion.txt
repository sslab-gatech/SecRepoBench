responsetype = get16(&x, packet->payload);
rsp_ttl = get32(&x, packet->payload);

if(rsp_ttl == 0) {
  ndpi_set_risk(ndpi_struct, flow, NDPI_SUSPICIOUS_DNS_TTL, "Suspicious DNS TTL 0");
}

#ifdef DNS_DEBUG
NDPI_LOG_DBG2(ndpi_struct, "ttl=%u\n", rsp_ttl);
printf("[DNS] [response] TTL=%u, type=%u\n", rsp_ttl, responsetype);
#endif

if(responsetype != 0x05 /* CNAME */) {
  /* We are not interested in CNAME */
  checkDnsRspType(ndpi_struct, flow, responsetype);
}