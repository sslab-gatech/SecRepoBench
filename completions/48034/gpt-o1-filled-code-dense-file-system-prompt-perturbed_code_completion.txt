/* Extract the DNS response type (2 bytes), class (2 bytes) and TTL (4 bytes). */
    responsetype = get16(&x, packet->payload);
    {
      u_int16_t resp_class = get16(&x, packet->payload);
      rsp_ttl = get32(&x, packet->payload);

      /* If the TTL is zero, mark this flow as suspicious. */
      if(rsp_ttl == 0) {
        ndpi_set_risk(ndpi_struct, flow, NDPI_SUSPICIOUS_DNS_TRAFFIC, "TTL=0");
      }

#ifdef DNS_DEBUG
      NDPI_LOG_DBG2(ndpi_struct, "DNS response type=%u, class=%u, TTL=%u\n",
                    responsetype, resp_class, rsp_ttl);
#endif

      /* Additional checks on the response type can be performed here if needed. */
      switch(responsetype) {
      case 0x01: /* A record */
      case 0x1C: /* AAAA record */
      case 0x05: /* CNAME record */
        /* Common types */
        break;
      default:
        /* Other record types could be examined or flagged here. */
        break;
      }
    }