responsetype = get16(&x, packet->payload);
rsp_ttl = ntohl(*(u_int32_t*)&packet->payload[x]);
x += 4;

if(rsp_ttl == 0) {
  ndpi_set_risk(ndpi_struct, flow, NDPI_DNS_SUSPICIOUS_TTL, "Zero TTL DNS Response");
}

#ifdef DNS_DEBUG
NDPI_LOG_DBG2(ndpi_struct, "TTL: %u\n", rsp_ttl);
printf("[DNS] [response] response_type=%d\n", responsetype);
#endif

ndpi_check_dns_type(ndpi_struct, flow, responsetype);