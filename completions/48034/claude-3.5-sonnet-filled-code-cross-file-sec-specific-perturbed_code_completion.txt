responsetype = get16(&x, packet->payload);
rsp_ttl = get32(&x, packet->payload);

if(rsp_ttl == 0) {
  ndpi_set_risk(ndpi_struct, flow, NDPI_ZERO_TTL_DNS_RECORD, "DNS Zero TTL");
}

#ifdef DNS_DEBUG
NDPI_LOG_DBG2(ndpi_struct, "TTL: %u, Response type: %u\n", rsp_ttl, responsetype);
printf("[DNS] [response] TTL=%u, type=%u\n", rsp_ttl, responsetype);
#endif

if(responsetype == 0xc00c) {
  x += 4;
  responsetype = get16(&x, packet->payload);
}