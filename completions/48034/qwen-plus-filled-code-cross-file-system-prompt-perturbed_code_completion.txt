responsetype = get16(&x, packet->payload);
rsp_ttl = get32(&x, packet->payload);

if (rsp_ttl == 0) {
  ndpi_set_risk(ndpi_struct, flow, NDPI_SUSPICIOUS_DNS_TRAFFIC, "DNS Response with TTL=0");
}

#ifdef DNS_DEBUG
NDPI_LOG_DBG2(ndpi_struct, "rsp_ttl=%u responsetype=%u\n", rsp_ttl, responsetype);
#endif

/* Perform additional checks based on response type */
switch(responsetype) {
  case 0x01: /* A */
    /* Handle IPv4 address response */
    break;
  case 0x05: /* CNAME */
    /* Handle canonical name response */
    break;
  case 0x1C: /* AAAA */
    /* Handle IPv6 address response */
    break;
  default:
    /* Handle other or unknown types */
    break;
}