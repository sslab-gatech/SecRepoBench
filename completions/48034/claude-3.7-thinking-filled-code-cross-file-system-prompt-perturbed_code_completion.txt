responsetype = get16(&x, packet->payload);
x += 2; /* Skip class field */
rsp_ttl = ntohl(*(u_int32_t*)&packet->payload[x]);
x += 4; /* Skip TTL field */

if(rsp_ttl == 0) {
  ndpi_set_risk(ndpi_struct, flow, NDPI_SUSPICIOUS_SHORT_TTL_DNS, "Zero TTL DNS Response");
}

#ifdef DNS_DEBUG
NDPI_LOG_DBG2(ndpi_struct, "TTL=%u, Response Type=%u\n", rsp_ttl, responsetype);
printf("[DNS] [response] TTL=%u, Response Type=%u\n", rsp_ttl, responsetype);
#endif