u_int16_t responsetype;
u_int32_t rsp_ttl;
u_int16_t num;

//...

responsetype = get16(&x, packet->payload);
rsp_ttl = get32(&x, packet->payload);

if(rsp_ttl == 0) {
  ndpi_set_risk(ndpi_struct, flow, NDPI_SUSPICIOUS_DNS_TTL, "DNS TTL is zero");
}

#ifdef DNS_DEBUG
NDPI_LOG_DBG2(ndpi_struct, "[rsp_ttl=%u][responsetype=%u]\n", rsp_ttl, responsetype);
#endif

if(responsetype == 0x05 /* CNAME */) {
  //...
}