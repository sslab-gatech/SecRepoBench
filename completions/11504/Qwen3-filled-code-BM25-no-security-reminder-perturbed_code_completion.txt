ret = parser_ctxt->freeElems;
parser_ctxt->freeElems = ret->next;
parser_ctxt->freeElemsNr--;

xmlNodeClear(ret);
ret->type = XML_ELEMENT_NODE;

if (parser_ctxt->dictNames) {
    if (lname == NULL) {
        ret->name = (xmlChar *) localname;
    } else {
        ret->name = (xmlChar *) lname;
        lname = NULL;
    }
} else {
    if (lname == NULL) {
        ret->name = xmlStrdup(localname);
    } else {
        ret->name = xmlStrdup(lname);
        xmlFree(lname);
        lname = NULL;
    }
    if (ret->name == NULL) {
        xmlSAX2ErrMemory(parser_ctxt, "xmlSAX2StartElementNs");
        xmlFreeNode(ret);
        return;
    }
}