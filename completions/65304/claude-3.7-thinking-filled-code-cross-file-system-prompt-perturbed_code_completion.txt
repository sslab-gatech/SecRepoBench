for(i=0; i<tot_signature_algorithms_len && sessoffset + (int)i + 2 <= packet->payload_packet_len; i+=2) {
  u_int16_t signature_algo = ntohs(*((u_int16_t*)&packet->payload[sessoffset+i]));
  
  // Store the signature algorithm in the structure if there's room
  if(ja.client.num_signature_algorithms < sa_size) {
    ja.client.signature_algorithms[ja.client.num_signature_algorithms++] = signature_algo;
  }
  
  // Add the signature algorithm to the string
  int rc = ndpi_snprintf(&ja.client.signature_algorithms_str[i*2], 
                         sizeof(ja.client.signature_algorithms_str) - i*2, 
                         "%02x%02x", 
                         (signature_algo >> 8) & 0xFF, 
                         signature_algo & 0xFF);
  if(rc <= 0) break;
}