for(i=0; i<sa_size && sessoffset + (int)i + 2 < packet->payload_packet_len; i++) {
		  u_int16_t signature_algo = (u_int16_t)ntohs(*((u_int16_t*)&packet->payload[sessoffset+(i*2)]));
		  char signature_str[16];

		  if(ja.client.num_signature_algorithms < MAX_NUM_JA)
		    ja.client.signature_algorithm[ja.client.num_signature_algorithms++] = signature_algo;

		  ndpi_snprintf(signature_str, sizeof(signature_str), "0x%04X", signature_algo);

		  if(i > 0) {
		    size_t current_len = strlen(ja.client.signature_algorithms_str);
		    if (current_len < sizeof(ja.client.signature_algorithms_str) - 1) {
		      strncat(ja.client.signature_algorithms_str, ",",
			      sizeof(ja.client.signature_algorithms_str) - current_len - 1);
		      current_len++;
		      if (current_len < sizeof(ja.client.signature_algorithms_str) - 1) {
			strncat(ja.client.signature_algorithms_str, signature_str,
				sizeof(ja.client.signature_algorithms_str) - current_len - 1);
		      }
		    }
		  } else {
		    strncpy(ja.client.signature_algorithms_str, signature_str, sizeof(ja.client.signature_algorithms_str) - 1);
		    ja.client.signature_algorithms_str[sizeof(ja.client.signature_algorithms_str) - 1] = '\0';
		  }
		}