ja.client.num_signature_algorithms = 0;
for(i=0; i<tot_signature_algorithms_len && sessoffset + (int)i + 2 < packet->payload_packet_len; i+=2) {
  u_int16_t signature_algo = (u_int16_t)ntohs(*((u_int16_t*)&packet->payload[sessoffset+i]));

  if(ja.client.num_signature_algorithms < MAX_NUM_TLS_SIGNATURE_ALGORITHMS)
    ja.client.signature_algorithms[ja.client.num_signature_algorithms++] = signature_algo;
  else {
    invalid_ja = 1;
#ifdef DEBUG_TLS
    printf("Client TLS Invalid num signature algorithms %u\n", ja.client.num_signature_algorithms);
#endif
  }
}

if(ja.client.num_signature_algorithms > 0) {
  int rc;
  ja.client.signature_algorithms_str[0] = '\0';
  for(i=0; i<ja.client.num_signature_algorithms; i++) {
    rc = ndpi_snprintf(&ja.client.signature_algorithms_str[i*2],
                       sizeof(ja.client.signature_algorithms_str) - i*2, "%s%04X",
                       (i > 0)? "-" : "", ja.client.signature_algorithms[i]);
    if(rc <= 0) break;
  }
}