size_t sa_size = ndpi_min(tot_signature_algorithms_len / 2, MAX_NUM_TLS_SIGNATURE_ALGORITHMS);

        for(i = 0; i < tot_signature_algorithms_len && sessoffset + (int)i + 2 <= packet->payload_packet_len; i += 2) {
            u_int16_t signature_algo = ntohs(*((u_int16_t*)&packet->payload[sessoffset + i]));

            if (sa_size > ja.client.num_signature_algorithms) {
                ja.client.signature_algorithms[ja.client.num_signature_algorithms++] = signature_algo;
            } else {
                invalid_ja = 1;
#ifdef DEBUG_TLS
                printf("Client TLS Invalid num signature algorithms %u\n", ja.client.num_signature_algorithms);
#endif
            }

            // Convert to string and append
            if (ja_str_len + 5 < JA_STR_LEN) { // Reserve space for ",XXXX"
                int rc = ndpi_snprintf(&ja.client.signature_algorithms_str[ja_str_len],
                                       JA_STR_LEN - ja_str_len,
                                       "%s%u",
                                       ja_str_len ? "," : "",
                                       signature_algo);
                if (rc > 0) ja_str_len += rc;
            }
        }