size_t sa_size = ndpi_min(tot_signature_algorithms_len / 2, MAX_NUM_TLS_SIGNATURE_ALGORITHMS);
u_int16_t signature_algorithms[sa_size];
memset(signature_algorithms, 0, sizeof(u_int16_t) * sa_size);

for(i=0; i<tot_signature_algorithms_len && sessoffset + (int)i + 2 < packet->payload_packet_len; i+=2) {
  u_int16_t signature_algo = (u_int16_t)ntohs(*((u_int16_t*)&packet->payload[sessoffset+i]));

  if(ja.client.num_signature_algorithms < MAX_NUM_JA)
    ja.client.signature_algorithms[ja.client.num_signature_algorithms++] = signature_algo;

  if(id < sa_size)
    signature_algorithms[id++] = signature_algo;

  char algo_str[32];
  int rc = snprintf(algo_str, sizeof(algo_str), "%u", signature_algo);
  if(rc > 0 && strlen(ja.client.signature_algorithms_str) + rc + 1 < sizeof(ja.client.signature_algorithms_str)) {
    strncat(ja.client.signature_algorithms_str, algo_str, rc);
    strncat(ja.client.signature_algorithms_str, ",", 1);
  }
}

if(strlen(ja.client.signature_algorithms_str) > 0 && ja.client.signature_algorithms_str[strlen(ja.client.signature_algorithms_str) - 1] == ',') {
  ja.client.signature_algorithms_str[strlen(ja.client.signature_algorithms_str) - 1] = '\0';
}