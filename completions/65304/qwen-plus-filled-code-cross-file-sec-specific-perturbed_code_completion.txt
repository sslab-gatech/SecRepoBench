u_int16_t tot_signature_algorithms_len = ntohs(*((u_int16_t*)&packet->payload[sessoffset]));
sessoffset += 2;

sa_size = ndpi_min(tot_signature_algorithms_len / 2, sa_size);

for(i = 0; i < tot_signature_algorithms_len && sessoffset + (int)i + 2 <= packet->payload_packet_len; i += 2) {
  u_int16_t signature_algo = ntohs(*((u_int16_t*)&packet->payload[sessoffset + i]));

  if(ja.client.num_signature_algorithms < MAX_NUM_JA)
    ja.client.signature_algorithms[ja.client.num_signature_algorithms++] = signature_algo;

  int rc = ndpi_snprintf(&ja.client.signature_algorithms_str[ja.client.signature_algorithms_str_len],
                         sizeof(ja.client.signature_algorithms_str) - ja.client.signature_algorithms_str_len,
                         "%s%u", (ja.client.signature_algorithms_str_len > 0) ? "," : "", signature_algo);
  if(rc > 0 && ja.client.signature_algorithms_str_len + rc < sizeof(ja.client.signature_algorithms_str))
    ja.client.signature_algorithms_str_len += rc;
  else
    break;
}