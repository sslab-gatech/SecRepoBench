// Calculate number of signature algorithms and limit to our buffer size
ja.client.num_signature_algorithms = 0;

// Process each signature algorithm
for(i=0; i<tot_signature_algorithms_len && sessoffset + i + 2 <= packet->payload_packet_len; i+=2) {
  u_int16_t signature_algo = ntohs(*((u_int16_t*)&packet->payload[sessoffset+i]));
  
  // Store algorithm if within our limit
  if(ja.client.num_signature_algorithms < sa_size) {
    ja.client.signature_algorithms[ja.client.num_signature_algorithms++] = signature_algo;
  }
  
  // Build string representation
  rc = ndpi_snprintf(&ja.client.signature_algorithms_str[i*2], 
                   sizeof(ja.client.signature_algorithms_str) - i*2, 
                   "%s%04x", 
                   (i > 0) ? "," : "", 
                   signature_algo);
  
  if(rc <= 0) break; // Error or no space left
}