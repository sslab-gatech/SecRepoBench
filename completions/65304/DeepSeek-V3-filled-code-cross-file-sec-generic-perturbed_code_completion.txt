for(i = 0; i < sa_size; i++) {
  u_int16_t signature_algo = ntohs(*((u_int16_t*)&packet->payload[sessoffset + i*2]));
  
  if(ja.client.num_signature_algorithms < MAX_NUM_JA)
    ja.client.signature_algorithms[ja.client.num_signature_algorithms++] = signature_algo;

  int rc = ndpi_snprintf(&ja.client.signature_algorithms_str[i*2], 
                        sizeof(ja.client.signature_algorithms_str) - i*2,
                        "%02X", signature_algo);
  if(rc <= 0) break;
}