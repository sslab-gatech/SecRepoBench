if (ja.client.num_signature_algorithms < MAX_NUM_JA) {
    ja.client.signature_algorithms[ja.client.num_signature_algorithms++] = signature_algo;
}

int rc = ndpi_snprintf(&ja.client.signature_algorithms_str[2 * ja.client.num_signature_algorithms - 2],
                       sizeof(ja.client.signature_algorithms_str) - (2 * ja.client.num_signature_algorithms - 2),
                       "%04x", signature_algo);
if (rc > 0) {
    ja.client.signature_algorithms_str[2 * ja.client.num_signature_algorithms - 1] = '\0'; // Null-terminate the string
}