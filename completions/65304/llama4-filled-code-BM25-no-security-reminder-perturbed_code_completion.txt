// Extract the signature algorithms from the packet payload starting from the given offset.
// Calculate the number of signature algorithms and store it in the appropriate field.
// Optionally, copy the signature algorithms into a dedicated structure if a specific flag is enabled.
// Convert each signature algorithm to a string format and append it to a string buffer for logging or further processing.
int sessoffset = offset+extension_offset, safari_signature_algorithms = 0,
  chrome_signature_algorithms = 0, duplicate_found = 0, last_signature = 0, id;
u_int16_t tot_signature_algorithms_len = ntohs(*((u_int16_t*)&packet->payload[sessoffset]));
ja.client.num_signature_algorithms = tot_signature_algorithms_len / 2;
if(ja.client.num_signature_algorithms > MAX_NUM_TLS_SIGNATURE_ALGORITHMS)
  ja.client.num_signature_algorithms = MAX_NUM_TLS_SIGNATURE_ALGORITHMS;

#ifdef DEBUG_HEURISTIC
printf("[SIGNATURE] [TLS Signature Algorithm] block_len=%u/len=%u num_signature_algorithms=%d\n", extension_len, tot_signature_algorithms_len, ja.client.num_signature_algorithms);
#endif

sessoffset += 2;
for(i=0; i<ja.client.num_signature_algorithms && sessoffset + 2 < packet->payload_packet_len; i++) {
  u_int16_t signature_algo = (u_int16_t)ntohs(*((u_int16_t*)&packet->payload[sessoffset]));
  ja.client.signature_algorithms[i] = signature_algo;

#ifdef DEBUG_HEURISTIC
  printf("[SIGNATURE] [TLS Signature Algorithm] %u/0x%04X\n", i, signature_algo);
#endif

  // ... rest of the code