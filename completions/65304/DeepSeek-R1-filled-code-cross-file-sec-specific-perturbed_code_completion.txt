ja.client.num_signature_algorithms = 0;
ja.client.signature_algorithms_str[0] = '\0';
size_t str_remaining = sizeof(ja.client.signature_algorithms_str);

for (i = 0; i < tot_signature_algorithms_len; i += 2) {
    if (sessoffset + i + 2 > packet->payload_packet_len) break;
    
    u_int16_t sig_algo = ntohs(*((u_int16_t*)&packet->payload[sessoffset + i]));
    u_int8_t first_byte = (sig_algo >> 8) & 0xFF;
    u_int8_t second_byte = sig_algo & 0xFF;

    /* Skip GREASE values */
    if (first_byte == second_byte && (first_byte & 0xF0) == 0xA0)
        continue;

    if (ja.client.num_signature_algorithms < MAX_NUM_TLS_SIGNATURE_ALGORITHMS)
        ja.client.signature_algorithms[ja.client.num_signature_algorithms++] = sig_algo;

    /* Convert to hex string with hyphen separators */
    int rc = ndpi_snprintf(&ja.client.signature_algorithms_str[strlen(ja.client.signature_algorithms_str)],
                          str_remaining,
                          "%s%04X",
                          (ja.client.num_signature_algorithms > 1) ? "-" : "",
                          sig_algo);
    
    if (rc > 0 && str_remaining > rc) {
        str_remaining -= rc;
    } else {
        break;
    }
}