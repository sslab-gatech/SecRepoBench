ja.client.num_signature_algorithms = ndpi_min(tot_signature_algorithms_len / 2, MAX_NUM_JA);

for(i=0; i<tot_signature_algorithms_len && sessoffset + (int)i + 2 < packet->payload_packet_len; i+=2) {
  u_int16_t signature_algo = ntohs(*((u_int16_t*)&packet->payload[sessoffset+i]));

  if(i/2 < sa_size) {
    ja.client.signature_algorithms[i/2] = signature_algo;
  }

  if(i > 0) {
    rc = ndpi_snprintf(&ja.client.signature_algorithms_str[i*2-1], 
                       sizeof(ja.client.signature_algorithms_str) - i*2 + 1, 
                       "-%04x", signature_algo);
  } else {
    rc = ndpi_snprintf(ja.client.signature_algorithms_str, 
                       sizeof(ja.client.signature_algorithms_str), 
                       "%04x", signature_algo);
  }

  if(rc <= 0 || (i*2 + rc) >= (int)sizeof(ja.client.signature_algorithms_str)) 
    break;
}