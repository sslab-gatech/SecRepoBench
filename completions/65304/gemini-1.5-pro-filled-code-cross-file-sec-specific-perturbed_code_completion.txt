if (tot_signature_algorithms_len + sessoffset > packet->payload_packet_len) {
			invalid_ja = 1;
			break;
		}

		ja.client.num_signature_algorithms = sa_size;
#ifdef EXTRACT_TLS_SIGNATURE_ALGORITHMS
		memcpy(ja.client.signature_algorithms, &packet->payload[sessoffset], tot_signature_algorithms_len);
#endif

		for (i = 0; i < tot_signature_algorithms_len && sessoffset + (int)i + 1 < packet->payload_packet_len; i += 2) {
			id = (packet->payload[sessoffset + i + 1] << 8) | packet->payload[sessoffset + i];

			if (i > 0) {
				int rc = ndpi_snprintf(&ja.client.signature_algorithms_str[i * 2 - 1],
					sizeof(ja.client.signature_algorithms_str) - i * 2 + 1, "-%04X", id);
				if (rc <= 0)
					break;
			}
			else {
				int rc = ndpi_snprintf(ja.client.signature_algorithms_str,
					sizeof(ja.client.signature_algorithms_str), "%04X", id);
				if (rc <= 0)
					break;
			}
		}