ja.client.num_signature_algorithms = 0;
for(i=0; i<tot_signature_algorithms_len && sessoffset + (int)i + 2 < packet->payload_packet_len; i+=2) {
  u_int16_t signature_algo = (u_int16_t)ntohs(*((u_int16_t*)&packet->payload[sessoffset+i]));

  if(last_signature == signature_algo) {
    /* Consecutive duplication */
    duplicate_found = 1;
    continue;
  } else {
    /* Check for other duplications */
    u_int all_ok = 1;

    for(j=0; j<tot_signature_algorithms_len; j+=2) {
      if(j!= i && sessoffset + (int)j + 2 < packet->payload_packet_len) {
        u_int16_t j_signature_algo = (u_int16_t)ntohs(*((u_int16_t*)&packet->payload[sessoffset+j]));

        if((signature_algo == j_signature_algo)
           && (i < j) /* Don't skip both of them */) {
#ifdef DEBUG_HEURISTIC
          printf("[SIGNATURE] [TLS Signature Algorithm] Skipping duplicate 0x%04X\n", signature_algo);
#endif

          duplicate_found = 1, all_ok = 0;
          break;
        }
      }
    }

    if(!all_ok)
      continue;
  }

  last_signature = signature_algo;

#ifdef DEBUG_HEURISTIC
  printf("[SIGNATURE] [TLS Signature Algorithm] 0x%04X\n", signature_algo);
#endif
  if(ja.client.num_signature_algorithms < MAX_NUM_TLS_SIGNATURE_ALGORITHMS)
    ja.client.signature_algorithms[ja.client.num_signature_algorithms++] = signature_algo;
  else {
    invalid_ja = 1;
#ifdef DEBUG_TLS
    printf("Client TLS Invalid num signature algorithms %u\n", ja.client.num_signature_algorithms);
#endif
  }

  if(ja.client.num_signature_algorithms < MAX_NUM_TLS_SIGNATURE_ALGORITHMS) {
    int rc = ndpi_snprintf(&ja.client.signature_algorithms_str[ja.client.num_signature_algorithms*2],
                           sizeof(ja.client.signature_algorithms_str) - ja.client.num_signature_algorithms*2,
                           "%04X", signature_algo);
    if(rc <= 0) break;
  }
}