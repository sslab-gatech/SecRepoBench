for(i=0; i<tot_signature_algorithms_len && sessoffset + (int)i + 2 <= packet->payload_packet_len; i+=2) {
  u_int16_t signature_algo = ntohs(*((u_int16_t*)&packet->payload[sessoffset+i]));

  if(ja.client.num_signature_algorithms < MAX_NUM_JA) {
    ja.client.signature_algorithms[ja.client.num_signature_algorithms++] = signature_algo;
    
    /* Add to the string representation */
    size_t offset = i > 0 ? i*2 - 1 : 0;  /* Account for dashes */
    size_t remaining = sizeof(ja.client.signature_algorithms_str) - offset;
    
    int rc;
    if(i > 0) {
      rc = ndpi_snprintf(&ja.client.signature_algorithms_str[offset], 
                          remaining, 
                          "-%04x", signature_algo);
    } else {
      rc = ndpi_snprintf(&ja.client.signature_algorithms_str[offset], 
                          remaining, 
                          "%04x", signature_algo);
    }
    
    if(rc <= 0) break;
  } else {
    invalid_ja = 1;
#ifdef DEBUG_TLS
    printf("Client TLS Invalid num signature algorithms %u\n", ja.client.num_signature_algorithms);
#endif
    break;
  }
}