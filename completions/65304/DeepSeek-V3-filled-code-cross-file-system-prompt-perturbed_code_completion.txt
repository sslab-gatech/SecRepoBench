if(ja.client.num_signature_algorithms < sa_size) {
  ja.client.signature_algorithms[ja.client.num_signature_algorithms++] = signature_algo;
}

int rc = ndpi_snprintf(&ja.client.signature_algorithms_str[ja.client.num_signature_algorithms_str],
                       sizeof(ja.client.signature_algorithms_str) - ja.client.num_signature_algorithms_str,
                       "%s%04X", (ja.client.num_signature_algorithms_str > 0) ? "," : "", signature_algo);
if(rc > 0) {
  ja.client.num_signature_algorithms_str += rc;
}