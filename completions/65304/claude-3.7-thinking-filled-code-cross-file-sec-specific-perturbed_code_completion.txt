for(i=0; i<tot_signature_algorithms_len && sessoffset + (int)i + 2 <= packet->payload_packet_len; i+=2) {
  u_int16_t signature_algo = ntohs(*((u_int16_t*)&packet->payload[sessoffset+i]));

  if(ja.client.num_signature_algorithms < sa_size) {
    ja.client.signature_algorithms[ja.client.num_signature_algorithms++] = signature_algo;
  }

  // Convert to hex string (each algorithm takes 4 hex chars)
  if(i/2*4 + 4 < sizeof(ja.client.signature_algorithms_str)) {
    snprintf(&ja.client.signature_algorithms_str[i/2*4], 5, "%04x", signature_algo);
  }
}