if (tot_signature_algorithms_len > 0 && sessoffset + tot_signature_algorithms_len <= total_len) {
    for (i = 0; i < tot_signature_algorithms_len; i += 2) {
        u_int16_t signature_algo = (u_int16_t)ntohs(*((u_int16_t*)&packet->payload[sessoffset + i]));

        if (ja.client.num_signature_algorithms < MAX_NUM_JA) {
            ja.client.signature_algorithms[ja.client.num_signature_algorithms++] = signature_algo;
        }

        // Convert signature algorithm to string format
        char algo_str[16];
        snprintf(algo_str, sizeof(algo_str), "0x%04X", signature_algo);
        strncat(ja.client.signature_algorithms_str, algo_str, sizeof(ja.client.signature_algorithms_str) - strlen(ja.client.signature_algorithms_str) - 1);
        if (i + 2 < tot_signature_algorithms_len) {
            strncat(ja.client.signature_algorithms_str, "-", sizeof(ja.client.signature_algorithms_str) - strlen(ja.client.signature_algorithms_str) - 1);
        }
    }
}