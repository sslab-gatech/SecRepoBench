static void http_process_user_agent(ndpi_detection_module_struct *ndpi_struct,
                                    struct ndpi_flow_struct *flow,
                                    const u_int8_t *payload,
                                    u_int16_t payload_len) {
  u_int16_t i, j;
  u_int16_t len;
  u_int16_t offset = 0;
  u_int16_t ua_len = 0;
  u_int16_t ua_offset = 0;
  u_int16_t ua_len_offset = 0;
  u_int16_t ua_len_len = 0;
  u_int16_t ua_len_len_offset = 0;
  u_int16_t ua_len_len_len = 0;
  u_int16_t ua_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_offset = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len = 0;
  u_int16_t ua_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_len_le