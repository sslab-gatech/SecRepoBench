ja.client.num_signature_algorithms = ndpi_min(tot_signature_algorithms_len / 2, MAX_NUM_TLS_SIGNATURE_ALGORITHMS);

#ifdef DEBUG_TLS
printf("Client TLS [SIGNATURE_ALGORITHMS: %u]\n", ja.client.num_signature_algorithms);
#endif

for(i=0; i<ja.client.num_signature_algorithms && sessoffset + (int)i*2 + 2 <= packet->payload_packet_len; i++) {
  ja.client.signature_algorithms[i] = ntohs(*((u_int16_t*)&packet->payload[sessoffset+i*2]));

  if(ja_str_len + 5 < sizeof(ja.client.signature_algorithms_str)) {
    int rc = snprintf(&ja.client.signature_algorithms_str[ja_str_len],
                      sizeof(ja.client.signature_algorithms_str) - ja_str_len,
                      "%s%04x", (i > 0) ? "-" : "",
                      ja.client.signature_algorithms[i]);
    if(rc > 0)
      ja_str_len += rc;
  }

#ifdef DEBUG_TLS
  printf("Client TLS [SIGNATURE_ALGORITHM: %04X]\n", ja.client.signature_algorithms[i]);
#endif
}