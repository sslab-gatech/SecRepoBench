int
xmlParserInputBufferGrow(xmlParserInputBufferPtr buf, int len) {
    xmlParserInputBufferPtr newbuf;
    int ret;

    if (buf == NULL)
        return(-1);
    if (buf->buffer == NULL)
        return(0);
    if (buf->error!= 0)
        return(-1);

    if (buf->buffer->size > (unsigned int) len)
        return(0);

    newbuf = xmlParserInputBufferCreate(len);
    if (newbuf == NULL) {
        xmlErrMemory(NULL, NULL);
        return(-1);
    }

    ret = xmlParserInputBufferCopy(newbuf, buf);
    if (ret < 0) {
        xmlErrMemory(NULL, NULL);
        xmlFreeParserInputBuffer(newbuf);
        return(-1);
    }

    xmlFreeParserInputBuffer(buf);
    buf = newbuf;
    return(ret);
}