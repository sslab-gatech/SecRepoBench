xmlParserInputBufferPtr newBuffer;

        newBuffer = xmlAllocParserInputBuffer(XML_CHAR_ENCODING_NONE);
        if (newBuffer == NULL) {
            xmlErrMemory(ctxt, "creating new input buffer");
            return (-1);
        }

        xmlBufShrink(in->buffer, in->rawconsumed);
        newBuffer->buffer = in->buffer;
        in->buffer = in->raw;
        in->raw = newBuffer->buffer;
        in->rawconsumed = 0;