// Create a new input buffer and assign it to the current buffer pointer.
// Shrink the existing input buffer to remove processed data.
// Move the current buffer to the raw buffer pointer.
// Update the number of processed bytes in the input structure.
xmlParserInputBufferPtr new_buf = xmlParserInputBufferCreateStatic(NULL, 0, XML_CHAR_ENCODING_NONE);
if (new_buf == NULL) {
    xmlErrMemory(ctxt, "creating new input buffer");
    return -1;
}
xmlBufFree(in->buffer);
in->buffer = new_buf->buffer;
in->raw = in->buffer;
in->cur = in->buffer->content;
in->end = in->buffer->content + in->buffer->use;
in->consumed += in->cur - in->base;
in->base = in->cur;