// Create a new input buffer and assign it to the current buffer pointer.
        xmlBufPtr newBuffer = xmlBufCreate();
        if (newBuffer == NULL) {
            xmlErrMemory(ctxt, "Failed to create new buffer");
            return (-1);
        }

        // Shrink the existing input buffer to remove processed data.
        if (xmlBufShrink(in->buffer, in->rawconsumed) == 0) {
            xmlErrMemory(ctxt, "Failed to shrink buffer");
            xmlBufFree(newBuffer);
            return (-1);
        }

        // Move the current buffer to the raw buffer pointer.
        in->raw = in->buffer;
        in->buffer = newBuffer;

        // Update the number of processed bytes in the input structure.
        inputStream->consumed += in->rawconsumed;
        in->rawconsumed = 0;