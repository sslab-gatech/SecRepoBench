// Create a new input buffer and assign it to the current buffer pointer.
// Shrink the existing input buffer to remove processed data.
// Move the current buffer to the raw buffer pointer.
// Update the number of processed bytes in the input structure.
xmlParserInputBufferPtr newBuf = xmlParserInputBufferCreateMem(NULL, 0, in->encoding);
if (newBuf == NULL) {
    xmlErrMemory(ctxt, NULL);
    return -1;
}
xmlBufFree(in->buffer);
in->buffer = newBuf->buffer;
in->raw = in->buffer;
inputStream->consumed += in->raw->use;