xmlParserInputBufferPtr newIn = xmlParserInputBufferCreateStatic(NULL, 0);
    if (newIn == NULL) {
        xmlErrMemory(ctxt, NULL);
        return (-1);
    }
    xmlBufAdd(newIn->buffer, xmlBufGetContent(in->buffer));
    xmlBufResetInput(newIn->buffer, inputStream);
    in->buffer = newIn;
    in->raw = in->buffer;
    in->rawConsumed = xmlBufGetInputPos(in->buffer);
    xmlBufShrink(in->buffer, in->rawConsumed);