xmlParserInputPtr
xmlParserGrow(xmlParserCtxtPtr ctxt)
{
    xmlParserInputPtr in = ctxt->input;
    xmlParserInputBufferPtr buf = in->buf;
    ptrdiff_t curEnd = in->end - in->cur;
    ptrdiff_t curBase = in->cur - in->base;
    int ret;

    if (buf == NULL)
        return(0);
    /* Don't grow push parser memory buffers. */
    if (((ctxt->progressive == 0) || (ctxt->inputNr > 1)) &&
        (buf->encoder == NULL) &&
        (buf->readcallback == NULL))
        return(0);
    /* Don't grow memory buffers. */
    if ((buf->encoder != NULL) && (buf->readcallback == NULL))
        return(0);
    if (curEnd >= INPUT_CHUNK)
        return(0);

    ret = xmlParserInputBufferGrow(buf, INPUT_CHUNK);
    xmlBufUpdateInput(buf->buffer, in, curBase);

    if (ret < 0) {
        xmlFatalErr(ctxt, buf->error, NULL);
    }

    return(ret);
}