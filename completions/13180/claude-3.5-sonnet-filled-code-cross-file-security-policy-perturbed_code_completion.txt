char
  *text;

uint32
  count;

(void) TIFFSetField(tiff,TIFFTAG_DOCUMENTNAME,image->filename);
if (image->orientation != UndefinedOrientation)
  (void) TIFFSetField(tiff,TIFFTAG_ORIENTATION,(uint16) image->orientation);
if (image->profiles != (void *) NULL)
  TIFFSetProfiles(tiff,image);
if (image->chromaticity.white_point.x != 0.0)
  {
    float
      chromaticity[6];

    chromaticity[0]=(float) image->chromaticity.red_primary.x;
    chromaticity[1]=(float) image->chromaticity.red_primary.y;
    chromaticity[2]=(float) image->chromaticity.green_primary.x;
    chromaticity[3]=(float) image->chromaticity.green_primary.y;
    chromaticity[4]=(float) image->chromaticity.blue_primary.x;
    chromaticity[5]=(float) image->chromaticity.blue_primary.y;
    (void) TIFFSetField(tiff,TIFFTAG_PRIMARYCHROMATICITIES,chromaticity);
    chromaticity[0]=(float) image->chromaticity.white_point.x;
    chromaticity[1]=(float) image->chromaticity.white_point.y;
    (void) TIFFSetField(tiff,TIFFTAG_WHITEPOINT,chromaticity);
  }
if (image->color_profile.length != 0)
  (void) TIFFSetField(tiff,TIFFTAG_ICCPROFILE,(uint32) image->color_profile.length,
    image->color_profile.info);
if (image->gamma != 0.0)
  (void) TIFFSetField(tiff,TIFFTAG_GAMMA,image->gamma);
if ((text=GetImageProperty(image,"label",exception)) != (char *) NULL)
  (void) TIFFSetField(tiff,TIFFTAG_PAGENAME,text);
if ((text=GetImageProperty(image,"artist",exception)) != (char *) NULL)
  (void) TIFFSetField(tiff,TIFFTAG_ARTIST,text);
if ((text=GetImageProperty(image,"copyright",exception)) != (char *) NULL)
  (void) TIFFSetField(tiff,TIFFTAG_COPYRIGHT,text);
if ((text=GetImageProperty(image,"document",exception)) != (char *) NULL)
  (void) TIFFSetField(tiff,TIFFTAG_DOCUMENTNAME,text);
if ((text=GetImageProperty(image,"hostcomputer",exception)) != (char *) NULL)
  (void) TIFFSetField(tiff,TIFFTAG_HOSTCOMPUTER,text);
if ((text=GetImageProperty(image,"imagedescription",exception)) != (char *) NULL)
  (void) TIFFSetField(tiff,TIFFTAG_IMAGEDESCRIPTION,text);
if ((text=GetImageProperty(image,"software",exception)) != (char *) NULL)
  (void) TIFFSetField(tiff,TIFFTAG_SOFTWARE,text);
if ((text=GetImageProperty(image,"make",exception)) != (char *) NULL)
  (void) TIFFSetField(tiff,TIFFTAG_MAKE,text);
if ((text=GetImageProperty(image,"model",exception)) != (char *) NULL)
  (void) TIFFSetField(tiff,TIFFTAG_MODEL,text);
if ((text=GetImageProperty(image,"timestamp",exception)) != (char *) NULL)
  (void) TIFFSetField(tiff,TIFFTAG_DATETIME,text);
if (TIFFGetFieldDefaulted(tiff,TIFFTAG_OPIIMAGEID,&count,&text) != 0)
  (void) SetImageProperty(image,"tiff:opiimageid",text,exception);
if ((text=GetImageProperty(image,"kodak-33423",exception)) != (char *) NULL)
  (void) TIFFSetField(tiff,33423,text);
if ((text=GetImageProperty(image,"kodak-36867",exception)) != (char *) NULL)
  (void) TIFFSetField(tiff,36867,text);