// Retrieve and set image properties from TIFF tags.
for (uint32 tag = TIFFTAG_ARTIST; tag <= TIFFTAG_SUBFILETYPE; tag++) {
  if (TIFFGetField(tiff, tag, &value)) {
    switch (tag) {
      case TIFFTAG_ARTIST:
        TIFFSetField(tiff, TIFFTAG_ARTIST, value);
        break;
      case TIFFTAG_COPYRIGHT:
        TIFFSetField(tiff, TIFFTAG_COPYRIGHT, value);
        break;
      case TIFFTAG_DATETIME:
        TIFFSetField(tiff, TIFFTAG_DATETIME, value);
        break;
      case TIFFTAG_DOCUMENTNAME:
        TIFFSetField(tiff, TIFFTAG_DOCUMENTNAME, value);
        break;
      case TIFFTAG_HOSTCOMPUTER:
        TIFFSetField(tiff, TIFFTAG_HOSTCOMPUTER, value);
        break;
      case TIFFTAG_MAKE:
        TIFFSetField(tiff, TIFFTAG_MAKE, value);
        break;
      case TIFFTAG_MODEL:
        TIFFSetField(tiff, TIFFTAG_MODEL, value);
        break;
      case TIFFTAG_SOFTWARE:
        TIFFSetField(tiff, TIFFTAG_SOFTWARE, value);
        break;
      case TIFFTAG_SUBFILETYPE:
        if (LocaleCompare(value, "REDUCEDIMAGE") == 0)
          TIFFSetField(tiff, TIFFTAG_SUBFILETYPE, FILETYPE_REDUCEDIMAGE);
        else if (LocaleCompare(value, "PAGE") == 0)
          TIFFSetField(tiff, TIFFTAG_SUBFILETYPE, FILETYPE_PAGE);
        else if (LocaleCompare(value, "MASK") == 0)
          TIFFSetField(tiff, TIFFTAG_SUBFILETYPE, FILETYPE_MASK);
        break;
      default:
        break;
    }
  }
}