char
  *artist,
  *copyright,
  *document,
  *make,
  *model,
  *software;

uint16
  subfiletype;

uint32
  count,
  length,
  type,
  value;

char
  message[MagickPathExtent];

for (count=0; count < TIFFNumberOfFields(tiff); count++)
{
  if (TIFFFieldInfo(tiff,count,&type,&length,&value) == MagickFalse)
    continue;
  if (length > MagickPathExtent)
    continue;
  (void) memset(message,0,sizeof(message));
  text=message;
  if (TIFFGetField(tiff,value,&text) != MagickFalse)
  {
    switch (value)
    {
      case TIFFTAG_ARTIST:
      {
        artist=AcquireMagickString(text);
        (void) SetImageProperty(img,"artist",artist,exception);
        artist=RelinquishMagickMemory(artist);
        break;
      }
      case TIFFTAG_COPYRIGHT:
      {
        copyright=AcquireMagickString(text);
        (void) SetImageProperty(img,"copyright",copyright,exception);
        copyright=RelinquishMagickMemory(copyright);
        break;
      }
      case TIFFTAG_DOCUMENTNAME:
      {
        document=AcquireMagickString(text);
        (void) SetImageProperty(img,"tiff:document",document,exception);
        document=RelinquishMagickMemory(document);
        break;
      }
      case TIFFTAG_MAKE:
      {
        make=AcquireMagickString(text);
        (void) SetImageProperty(img,"make",make,exception);
        make=RelinquishMagickMemory(make);
        break;
      }
      case TIFFTAG_MODEL:
      {
        model=AcquireMagickString(text);
        (void) SetImageProperty(img,"model",model,exception);
        model=RelinquishMagickMemory(model);
        break;
      }
      case TIFFTAG_SOFTWARE:
      {
        software=AcquireMagickString(text);
        (void) SetImageProperty(img,"software",software,exception);
        software=RelinquishMagickMemory(software);
        break;
      }
      case TIFFTAG_SUBFILETYPE:
      {
        if (TIFFGetField(tiff,TIFFTAG_SUBFILETYPE,&subfiletype) == MagickFalse)
          break;
        if (subfiletype == FILETYPE_REDUCEDIMAGE)
          (void) SetImageProperty(img,"tiff:subfiletype","REDUCEDIMAGE",exception);
        if (subfiletype == FILETYPE_PAGE)
          (void) SetImageProperty(img,"tiff:subfiletype","PAGE",exception);
        if (subfiletype == FILETYPE_MASK)
          (void) SetImageProperty(img,"tiff:subfiletype","MASK",exception);
        break;
      }
      case 33423:
      {
        (void) SetImageProperty(img,"kodak-33423",message,exception);
        break;
      }
      case 36867:
      {
        (void) SetImageProperty(img,"kodak-36867",message,exception);
        break;
      }
      case TIFFTAG_PAGENAME:
      {
        (void) SetImageProperty(img,"label",message,exception);
        break;
      }
      case TIFFTAG_IMAGEDESCRIPTION:
      {
        (void) SetImageProperty(img,"comment",message,exception);
        break;
      }
      case TIFFTAG_OPIIMAGEID:
      {
        if (count > 0)
        {
          char
            *previous_text;

          /*
            OPIIMAGEID often appears as a pair of tags with the second one
            containing the image ID string.
          */
          previous_text=message;
          if (TIFFGetField(tiff,TIFFTAG_OPIIMAGEID,&text) != MagickFalse)
            (void) SetImageProperty(img,"tiff:OPIIMAGEID",text,exception);
          else
            (void) SetImageProperty(img,"tiff:OPIIMAGEID",previous_text,exception);
        }
        break;
      }
      default:
        break;
    }
  }
}