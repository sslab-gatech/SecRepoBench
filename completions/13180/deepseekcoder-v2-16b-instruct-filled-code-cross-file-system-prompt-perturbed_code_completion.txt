// Retrieve and set image properties from TIFF tags.
  // This block of code attempts to extract various metadata fields from a TIFF image,
  // such as artist, copyright, document name, and other descriptive fields.
  // Each TIFF field is checked for existence and non-null value, and if so, it is
  // set as an image property using the SetImageProperty function. Special handling
  // is done for fields like OPIIMAGEID, with count validation and string copying.
  // Additionally, it handles the subfiletype field with specific values like REDUCEDIMAGE,
  // PAGE, and MASK. This code can be adapted to include new properties or handle
  // additional TIFF tags as needed.
  uint32 directory = 0; // Initialize the directory variable
  TIFFSetDirectory(tiff, directory); // Set the directory to read from

  uint16 sample_format;
  uint32 opiiimageid;
  uint16 samples_per_pixel;
  uint16 photometric;
  uint16 planar_config;
  uint16 compression;
  uint16 fill_order;
  uint16 thresholding;
  uint16 orientation;
  uint16 x_resolution;
  uint16 y_resolution;
  uint16 resolution_unit;
  uint16 page_number[2];
  uint16 subfile_type;
  uint16 color_map[768];
  uint16 extra_samples;
  uint16 sample_info[1];
  uint16 chromaticity[6];
  uint16 white_point[2];
  uint16 primary_chromaticities[6];
  uint16 jpeg_tables_mode;
  uint16 webp_level;
  uint16 webp_lossless;
  uint16 lzma_reset_value;
  uint16 predictor;
  uint16 bits_per_sample;
  uint16 jpeg_quality;
  uint16 zip_quality;
  uint16 lzw_predictor;
  uint16 group4_options;
  uint16 jpeg_color_mode;
  uint16 ycbcr_subsampling[2];
  uint16 sampling_factor_x, sampling_factor_y;
  uint16 sigma_x, sigma_y;
  uint16 chroma_blue, chroma_green, chroma_red;
  uint16 chroma_white_point_x, chroma_white_point_y;
  uint16 chroma_primary_x[3], chroma_primary_y[3];
  uint16 chroma_extra_samples;
  uint16 chroma_sample_info[1];

  // Read TIFF tags and set image properties
  TIFFGetField(tiff, TIFFTAG_SAMPLEFORMAT, &sample_format);
  TIFFGetField(tiff, TIFFTAG_OPIIMAGEID, &opiiimageid);
  TIFFGetField(tiff, TIFFTAG_SAMPLESPERPIXEL, &samples_per_pixel);
  TIFFGetField(tiff, TIFFTAG_PHOTOMETRIC, &photometric);
  TIFFGetField(tiff, TIFFTAG_PLANARCONFIG, &planar_config);
  TIFFGetField(tiff, TIFFTAG_COMPRESSION, &compression);
  TIFFGetField(tiff, TIFFTAG_FILLORDER, &fill_order);
  TIFFGetField(tiff, TIFFTAG_THRESHHOLDING, &thresholding);
  TIFFGetField(tiff, TIFFTAG_ORIENTATION, &orientation);
  TIFFGetField(tiff, TIFFTAG_XRESOLUTION, &x_resolution);
  TIFFGetField(tiff, TIFFTAG_YRESOLUTION, &y_resolution);
  TIFFGetField(tiff, TIFFTAG_RESOLUTIONUNIT, &resolution_unit);
  TIFFGetField(tiff, TIFFTAG_PAGENUMBER, &page_number[0], &page_number[1]);
  TIFFGetField(tiff, TIFFTAG_SUBFILETYPE, &subfile_type);
  TIFFGetField(tiff, TIFFTAG_COLORMAP, &color_map);
  TIFFGetField(tiff, TIFFTAG_EXTRASAMPLES, &extra_samples, &sample_info);
  TIFFGetField(tiff, TIFFTAG_PRIMARYCHROMATICITIES, &primary_chromaticities);
  TIFFGetField(tiff, TIFFTAG_WHITEPOINT, &white_point);
  TIFFGetField(tiff, TIFFTAG_JPEGTABLESMODE, &jpeg_tables_mode);
  TIFFGetField(tiff, TIFFTAG_WEBP_LEVEL, &webp_level);
  TIFFGetField(tiff, TIFFTAG_WEBP_LOSSLESS, &webp_lossless);
  TIFFGetField(tiff, TIFFTAG_LZMAPRESET, &lzma_reset_value);
  TIFFGetField(tiff, TIFFTAG_PREDICTOR, &predictor);
  TIFFGetField(tiff, TIFFTAG_BITSPERSAMPLE, &bits_per_sample);
  TIFFGetField(tiff, TIFFTAG_JPEGQUALITY, &jpeg_quality);
  TIFFGetField(tiff, TIFFTAG_ZIPQUALITY, &zip_quality);
  TIFFGetField(tiff, TIFFTAG_GROUP3OPTIONS, &group4_options);
  TIFFGetField(tiff, TIFFTAG_JPEGCOLORMODE, &jpeg_color_mode);
  TIFFGetField(tiff, TIFFTAG_YCBCRSUBSAMPLING, &ycbcr_subsampling[0], &ycbcr_subsampling[1]);
  TIFFGetField(tiff, TIFFTAG_SAMPLESPERPIXEL, &chroma_extra_samples, &chroma_sample_info);
  TIFFGetField(tiff, TIFFTAG_PRIMARYCHROMATICITIES, &chroma_primary_x, &chroma_primary_y);
  TIFFGetField(tiff, TIFFTAG_WHITEPOINT, &chroma_white_point_x, &chroma_white_point_y);

  // Set image properties based on TIFF tags
  if (TIFFGetField(tiff, TIFFTAG_ARTIST, &text) != 0 && text != NULL)
    SetImageProperty(img, "artist", text);
  if (TIFFGetField(tiff, TIFFTAG_COPYRIGHT, &text) != 0 && text != NULL)
    SetImageProperty(img, "copyright", text);
  if (TIFFGetField(tiff, TIFFTAG_DOCUMENTNAME, &text) != 0 && text != NULL)
    SetImageProperty(img, "document", text);
  if (TIFFGetField(tiff, TIFFTAG_HOSTCOMPUTER, &text) != 0 && text != NULL)
    SetImageProperty(img, "hostcomputer", text);
  if (TIFFGetField(tiff, TIFFTAG_DATETIME, &text) != 0 && text != NULL)
    SetImageProperty(img, "timestamp", text);
  if (TIFFGetField(tiff, TIFFTAG_MAKE, &text) != 0 && text != NULL)
    SetImageProperty(img, "make", text);
  if (TIFFGetField(tiff, TIFFTAG_MODEL, &text) != 0 && text != NULL)
    SetImageProperty(img, "model", text);
  if (TIFFGetField(tiff, TIFFTAG_SOFTWARE, &text) != 0 && text != NULL)
    SetImageProperty(img, "software", text);
  if (TIFFGetField(tiff, TIFFTAG_PAGENAME, &text) != 0 && text != NULL)
    SetImageProperty(img, "label", text);
  if (TIFFGetField(tiff, TIFFTAG_IMAGEDESCRIPTION, &text) != 0 && text != NULL)
    SetImageProperty(img, "comment", text);
  if (TIFFGetField(tiff, TIFFTAG_SUBFILETYPE, &subfile_type) != 0 && text != NULL)
    SetImageProperty(img, "tiff:subfiletype", subfile_type == FILETYPE_REDUCEDIMAGE ? "REDUCEDIMAGE" :
      (subfile_type == FILETYPE_PAGE ? "PAGE" :
      (subfile_type == FILETYPE_MASK ? "MASK" : "none")));

  // Additional properties can be set here as needed