// Retrieve and set image properties from TIFF tags.
// This block of code attempts to extract various metadata fields from a TIFF image,
// such as artist, copyright, document name, and other descriptive fields.
// Each TIFF field is checked for existence and non-null value, and if so, it is
// set as an image property using the SetImageProperty function. Special handling
// is done for fields like OPIIMAGEID, with count validation and string copying.
// Additionally, it handles the subfiletype field with specific values like REDUCEDIMAGE,
// PAGE, and MASK. This code can be adapted to include new properties or handle
// additional TIFF tags as needed.

// Retrieve TIFF tags
TIFFGetField(tiff, TIFFTAG_ARTIST, &text);
if (text!= NULL)
  (void) SetImageProperty(img, "artist", text, exception);

TIFFGetField(tiff, TIFFTAG_COPYRIGHT, &text);
if (text!= NULL)
  (void) SetImageProperty(img, "copyright", text, exception);

TIFFGetField(tiff, TIFFTAG_DOCUMENTNAME, &text);
if (text!= NULL)
  (void) SetImageProperty(img, "document", text, exception);

TIFFGetField(tiff, TIFFTAG_IMAGEDESCRIPTION, &text);
if (text!= NULL)
  (void) SetImageProperty(img, "comment", text, exception);

TIFFGetField(tiff, TIFFTAG_MAKE, &text);
if (text!= NULL)
  (void) SetImageProperty(img, "make", text, exception);

TIFFGetField(tiff, TIFFTAG_MODEL, &text);
if (text!= NULL)
  (void) SetImageProperty(img, "model", text, exception);

TIFFGetField(tiff, TIFFTAG_SOFTWARE, &text);
if (text!= NULL)
  (void) SetImageProperty(img, "software", text, exception);

TIFFGetField(tiff, TIFFTAG_DATETIME, &text);
if (text!= NULL)
  (void) SetImageProperty(img, "timestamp", text, exception);

TIFFGetField(tiff, TIFFTAG_HOSTCOMPUTER, &text);
if (text!= NULL)
  (void) SetImageProperty(img, "host", text, exception);

TIFFGetField(tiff, TIFFTAG_PAGENAME, &text);
if (text!= NULL)
  (void) SetImageProperty(img, "label", text, exception);

TIFFGetField(tiff, TIFFTAG_OPIIMAGEID, &text, &count);
if ((text!= NULL) && (count > 0))
  {
    size_t
      length;

    length=strlen(text);
    if (length > 0)
      {
        char
          *value;

        value=(char *) AcquireQuantumMemory(length+1,sizeof(*value));
        if (value!= NULL)
          {
            (void) CopyMagickString(value,text,length+1);
            (void) SetImageProperty(img, "OPI:ImageID", value, exception);
            value=(char *) RelinquishMagickMemory(value);
          }
      }
  }

TIFFGetField(tiff, TIFFTAG_SUBFILETYPE, &type);
if (type == FILETYPE_REDUCEDIMAGE)
  (void) SetImageProperty(img, "tiff:subfiletype", "REDUCEDIMAGE", exception);
else if (type == FILETYPE_PAGE)
  (void) SetImageProperty(img, "tiff:subfiletype", "PAGE", exception);
else if (type == FILETYPE_MASK)
  (void) SetImageProperty(img, "tiff:subfiletype", "MASK", exception);

TIFFGetField(tiff, TIFFTAG_INKSET, &type);
if (type == INKSET_CMYK)
  (void) SetImageProperty(img, "tiff:inkset", "CMYK", exception);

TIFFGetField(tiff, TIFFTAG_DOTRANGE, &count, &length);
if ((count > 0) && (length > 0))
  {
    size_t
      length;

    length=strlen(text);
    if (length > 0)
      {
        char
          *value;

        value=(char *) AcquireQuantumMemory(length+1,sizeof(*value));
        if (value!= NULL)
          {
            (void) CopyMagickString(value,text,length+1);
            (void) SetImageProperty(img, "tiff:dot-range", value, exception);
            value=(char *) RelinquishMagickMemory(value);
          }
      }
  }

TIFFGetField(tiff, TIFFTAG_TARGETPRINTER, &text);
if (text!= NULL)
  (void) SetImageProperty(img, "tiff:target-printer", text, exception);

TIFFGetField(tiff, TIFFTAG_WHITEPOINT, &count, &length);
if ((count > 0) && (length > 0))
  {
    size_t
      length;

    length=strlen(text);
    if (length > 0)
      {
        char
          *value;

        value=(char *) AcquireQuantumMemory(length+1,sizeof(*value));
        if (value!= NULL)
          {
            (void) CopyMagickString(value,text,length+1);
            (void) SetImageProperty(img, "tiff:white-point", value, exception);
            value=(char *) RelinquishMagickMemory(value);
          }
      }
  }

TIFFGetField(tiff, TIFFTAG_PRIMARYCHROMATICITIES, &count, &length);
if ((count > 0) && (length > 0))
  {
    size_t
      length;

    length=strlen(text);
    if (length > 0)
      {
        char
          *value;

        value=(char *) AcquireQuantumMemory(length+1,sizeof(*value));
        if (value!= NULL)
          {
            (void) CopyMagickString(value,text,length+1);
            (void) SetImageProperty(img, "tiff:primary-chromaticities", value,
              exception);
            value=(char *) RelinquishMagickMemory(value);
          }
      }
  }

TIFFGetField(tiff, TIFFTAG_YCBCRSUBSAMPLING, &count, &length);
if ((count > 0) && (length > 0))
  {
    size_t
      length;

    length=strlen(text);
    if (length > 0)
      {
        char
          *value;

        value=(char *) AcquireQuantumMemory(length+1,sizeof(*value));
        if (value!= NULL)
          {
            (void) CopyMagickString(value,text,length+1);
            (void) SetImageProperty(img, "tiff:ycbcr-subsampling", value,
              exception);
            value=(char *) RelinquishMagickMemory(value);
          }
      }
  }

TIFFGetField(tiff, TIFFTAG_YCBCRPOSITIONING, &count, &length);
if ((count > 0) && (length > 0))
  {
    size_t
      length;

    length=strlen(text);
    if (length > 0)
      {
        char
          *value;

        value=(char *) AcquireQuantumMemory(length+1,sizeof(*value));
        if (value!= NULL)
          {
            (void) CopyMagickString(value,text,length+1);
            (void) SetImageProperty(img, "tiff:ycbcr-positioning", value,
              exception);
            value=(char *) RelinquishMagickMemory(value);
          }
      }
  }

TIFFGetField(tiff, TIFFTAG_REFERENCEBLACKWHITE, &count, &length);
if ((count > 0) && (length > 0))
  {
    size_t
      length;

    length=strlen(text);
    if (length > 0)
      {
        char
          *value;

        value=(char *) AcquireQuantumMemory(length+1,sizeof(*value));
        if (value!= NULL)
          {
            (void) CopyMagickString(value,text,length+1);
            (void) SetImageProperty(img, "tiff:reference-black-white", value,
              exception);
            value=(char *) RelinquishMagickMemory(value);
          }
      }
  }

TIFFGetField(tiff, TIFFTAG_RESOLUTIONUNIT, &type);
if (type == RESUNIT_INCH)
  (void) SetImageProperty(img, "tiff:resolution-unit", "inches", exception);
else if (type == RESUNIT_CENTIMETER)
  (void) SetImageProperty(img, "tiff:resolution-unit", "centimeters",
    exception);

TIFFGetField(tiff, TIFFTAG_XRESOLUTION, &length);
if (length > 0)
  (void) SetImageProperty(img, "tiff:x-resolution", (char *) length, exception);

TIFFGetField(tiff, TIFFTAG_YRESOLUTION, &length);
if (length > 0)
  (void) SetImageProperty(img, "tiff:y-resolution", (char *) length, exception);

TIFFGetField(tiff, TIFFTAG_XPOSITION, &length);
if (length > 0)
  (void) SetImageProperty(img, "tiff:x-position", (char *) length, exception);

TIFFGetField(tiff, TIFFTAG_YPOSITION, &length);
if (length > 0)
  (void) SetImageProperty(img, "tiff:y-position", (char *) length, exception);

TIFFGetField(tiff, TIFFTAG_IMAGEDEPTH, &length);
if (length > 0)
  (void) SetImageProperty(img, "tiff:image-depth", (char *) length, exception);

TIFFGetField(tiff, TIFFTAG_TILEDEPTH, &length);
if (length > 0)
  (void) SetImageProperty(img, "tiff:tile-depth", (char *) length, exception);

TIFFGetField(tiff, TIFFTAG_TILELENGTH, &length);
if (length > 0)
  (void) SetImageProperty(img, "tiff:tile-length", (char *) length, exception);

TIFFGetField(tiff, TIFFTAG_TILEWIDTH, &length);
if (length > 0)
  (void) SetImageProperty(img, "tiff:tile-width", (char *) length, exception);

TIFFGetField(tiff, TIFFTAG_NUMBEROFINKS, &length);
if (length > 0)
  (void) SetImageProperty(img, "tiff:number-of-inks", (char *) length, exception);

TIFFGetField(tiff, TIFFTAG_INKSET, &type);
if (type == INKSET_CMYK)
  (void) SetImageProperty(img, "tiff:inkset", "CMYK", exception);

TIFFGetField(tiff, TIFFTAG_DOTRANGE, &count, &length);
if ((count > 0) && (length > 0))
  {
    size_t
      length;

    length=strlen(text);
    if (length > 0)
      {
        char
          *value;

        value=(char *) AcquireQuantumMemory(length+1,sizeof(*value));
        if (value!= NULL)
          {
            (void) CopyMagickString(value,text,length+1);
            (void) SetImageProperty(img, "tiff:dot-range", value, exception);
            value=(char *) RelinquishMagickMemory(value);
          }
      }
  }

TIFFGetField(tiff, TIFFTAG_TARGETPRINTER, &text);
if (text!= NULL)
  (void) SetImageProperty(img, "tiff:target-printer", text, exception);

TIFFGetField(tiff, TIFFTAG_WHITEPOINT, &count, &length);
if ((count > 0) && (length > 0))
  {
    size_t
      length;

    length=strlen(text);
    if (length > 0)
      {
        char
          *value;

        value=(char *) AcquireQuantumMemory(length+1,sizeof(*value));
        if (value!= NULL)
          {
            (void) CopyMagickString(value,text,length+1);
            (void) SetImageProperty(img, "tiff:white-point", value, exception);
            value=(char *) RelinquishMagickMemory(value);
          }
      }
  }

TIFFGetField(tiff, TIFFTAG_PRIMARYCHROMATICITIES, &count, &length);
if ((count > 0) && (length > 0))
  {
    size_t
      length;

    length=strlen(text);
    if (length > 0)
      {
        char
          *value;

        value=(char *) AcquireQuantumMemory(length+1,sizeof(*value));
        if (value!= NULL)
          {
            (void) CopyMagickString(value,text,length+1);
            (void) SetImageProperty(img, "tiff:primary-chromaticities", value,
              exception);
            value=(char *) RelinquishMagickMemory(value);
          }
      }
  }

TIFFGetField(tiff, TIFFTAG_YCBCRSUBSAMPLING, &count, &length);
if ((count > 0) && (length > 0))
  {
    size_t
      length;

    length=strlen(text);
    if (length > 0)
      {
        char
          *value;

        value=(char *) AcquireQuantumMemory(length+1,sizeof(*value));
        if (value!= NULL)
          {
            (void) CopyMagickString(value,text,length+1);
            (void) SetImageProperty(img, "tiff:ycbcr-subsampling", value,
              exception);
            value=(char *) RelinquishMagickMemory(value);
          }
      }
  }

TIFFGetField(tiff, TIFFTAG_YCBCRPOSITIONING, &count, &length);
if ((count > 0) && (length > 0))
  {
    size_t
      length;

    length=strlen(text);
    if (length > 0)
      {
        char
          *value;

        value=(char *) AcquireQuantumMemory(length+1,sizeof(*value));
        if (value!= NULL)
          {
            (void) CopyMagickString(value,text,length+1);
            (void) SetImageProperty(img, "tiff:ycbcr-positioning", value,
              exception);
            value=(char *) RelinquishMagickMemory(value);
          }
      }
  }

TIFFGetFiel