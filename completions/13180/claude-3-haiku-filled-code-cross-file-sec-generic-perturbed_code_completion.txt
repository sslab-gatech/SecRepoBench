// Retrieve and set image properties from TIFF tags.
char message[MagickPathExtent];
uint32 count, length, type;

// Iterate through the TIFF tags and extract the relevant metadata fields
TIFFDirEntry *dir;
int tag_count = TIFFGetFieldCount(tiff);
for (int i = 0; i < tag_count; i++) {
    dir = TIFFGetDirEntry(tiff, i);
    if (dir != NULL) {
        switch (dir->tdir_tag) {
            case TIFFTAG_ARTIST:
                if (TIFFGetField(tiff, TIFFTAG_ARTIST, &text)) {
                    (void) SetImageProperty(img, "tiff:artist", text, exception);
                }
                break;
            case TIFFTAG_COPYRIGHT:
                if (TIFFGetField(tiff, TIFFTAG_COPYRIGHT, &text)) {
                    (void) SetImageProperty(img, "tiff:copyright", text, exception);
                }
                break;
            case TIFFTAG_DOCUMENTNAME:
                if (TIFFGetField(tiff, TIFFTAG_DOCUMENTNAME, &text)) {
                    (void) SetImageProperty(img, "tiff:document", text, exception);
                }
                break;
            case TIFFTAG_OPIIMAGEID:
                if (TIFFGetField(tiff, TIFFTAG_OPIIMAGEID, &count, &text)) {
                    if (count > 0 && text != NULL) {
                        (void) SetImageProperty(img, "tiff:opiimageid", text, exception);
                    }
                }
                break;
            case TIFFTAG_SUBFILETYPE:
                uint32 subfiletype;
                if (TIFFGetField(tiff, TIFFTAG_SUBFILETYPE, &subfiletype)) {
                    if (subfiletype == FILETYPE_REDUCEDIMAGE) {
                        (void) SetImageProperty(img, "tiff:subfiletype", "REDUCEDIMAGE", exception);
                    } else if (subfiletype == FILETYPE_PAGE) {
                        (void) SetImageProperty(img, "tiff:subfiletype", "PAGE", exception);
                    } else if (subfiletype == FILETYPE_MASK) {
                        (void) SetImageProperty(img, "tiff:subfiletype", "MASK", exception);
                    }
                }
                break;
            // Add more cases to handle additional TIFF tags as needed
        }
    }
}