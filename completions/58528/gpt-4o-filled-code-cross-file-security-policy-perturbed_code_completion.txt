for (int cand_idx = 0; cand_idx < 3; cand_idx++) {
                RefPicSet *rps = &s->rps[cand_lists[cand_idx]];
                for (refindex = 0; refindex < rps->nb_refs; refindex++) {
                    if (rpl_tmp.nb_refs < HEVC_MAX_REFS) {
                        rpl_tmp.list[rpl_tmp.nb_refs] = rps->list[refindex];
                        rpl_tmp.ref[rpl_tmp.nb_refs] = rps->ref[refindex];
                        rpl_tmp.isLongTerm[rpl_tmp.nb_refs] = (cand_lists[cand_idx] == LT_CURR);
                        rpl_tmp.nb_refs++;
                    } else {
                        av_log(s->avctx, AV_LOG_ERROR, "Exceeded maximum number of references.\n");
                        return AVERROR_INVALIDDATA;
                    }
                }
            }