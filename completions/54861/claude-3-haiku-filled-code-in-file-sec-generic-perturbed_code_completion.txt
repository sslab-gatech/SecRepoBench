// Adjust the height by 2 to accommodate certain motion compensation edge cases, if the codec is H.264, a specific VP series codec, or other relevant codec, or if low resolution is used.
if ((codeccontext->codec_id == AV_CODEC_ID_H264) ||
    (codeccontext->codec_id >= AV_CODEC_ID_VP9 && codeccontext->codec_id <= AV_CODEC_ID_VP15) ||
    (codeccontext->width < 640 || codeccontext->height < 480)) {
    *height = FFALIGN(*height, h_align) + 2;
} else {
    *height = FFALIGN(*height, h_align);
}

// Ensure that the width is at least 32, to provide enough temporary space for edge emulation during out-of-frame motion vector processing.
*width = FFMAX(*width, 32);