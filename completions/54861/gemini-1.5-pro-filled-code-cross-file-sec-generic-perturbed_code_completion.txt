if (codeccontext->codec_id == AV_CODEC_ID_H264 ||
        codeccontext->codec_id == AV_CODEC_ID_VP1  ||
        codeccontext->codec_id == AV_CODEC_ID_VP2  ||
        codeccontext->codec_id == AV_CODEC_ID_VP3  ||
        codeccontext->codec_id == AV_CODEC_ID_VP4  ||
        codeccontext->codec_id == AV_CODEC_ID_VP5  ||
        codeccontext->codec_id == AV_CODEC_ID_VP6  ||
        codeccontext->codec_id == AV_CODEC_ID_VP7  ||
        codeccontext->codec_id == AV_CODEC_ID_VP8  ||
        codeccontext->codec_id == AV_CODEC_ID_CAVS ||
        codeccontext->codec_id == AV_CODEC_ID_VC1  ||
        codeccontext->codec_id == AV_CODEC_ID_WMV1 ||
        codeccontext->codec_id == AV_CODEC_ID_WMV2 ||
        codeccontext->codec_id == AV_CODEC_ID_WMV3 ||
        codeccontext->codec_id == AV_CODEC_ID_VC1IMAGE        ||
        codeccontext->codec_id == AV_CODEC_ID_MSS1 ||
        codeccontext->codec_id == AV_CODEC_ID_MSS2 ||
        (codeccontext->codec_id == AV_CODEC_ID_SNOW && *width < 32) ||
        *height < 16) // interlaced is rounded up to 2 macroblocks
        *height += *height % h_align;

    if (*width < 32) // provide enough space for edge emulation
        *width = 32;