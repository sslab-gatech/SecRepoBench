if (codeccontext->codec_id == AV_CODEC_ID_H264 ||
    codeccontext->codec_id == AV_CODEC_ID_VP5 ||
    codeccontext->codec_id == AV_CODEC_ID_VP6 ||
    codeccontext->codec_id == AV_CODEC_ID_VP6F ||
    codeccontext->codec_id == AV_CODEC_ID_VP6A ||
    codeccontext->codec_id == AV_CODEC_ID_MPEG1VIDEO ||
    codeccontext->codec_id == AV_CODEC_ID_MPEG2VIDEO ||
    codeccontext->codec_id == AV_CODEC_ID_VC1 ||
    codeccontext->codec_id == AV_CODEC_ID_RV30 ||
    codeccontext->codec_id == AV_CODEC_ID_RV40 ||
    codeccontext->codec_id == AV_CODEC_ID_VP8 ||
    codeccontext->codec_id == AV_CODEC_ID_VP9 ||
    codeccontext->codec_id == AV_CODEC_ID_HEVC ||
    codeccontext->active_thread_type & FF_THREAD_SLICE) {
    *height = FFALIGN(*height, 2);
}

if (codeccontext->codec_id == AV_CODEC_ID_H264 || codeccontext->lowres ||
    (codeccontext->active_thread_type & FF_THREAD_SLICE)) {
    // Some motion estimation subpixel algorithms may read up to 17 bytes
    // horizontally for every vertical macroblock row, so we need to align
    // the width to ensure sufficient temporary space.
    *width = FFALIGN(*width, 32);
}