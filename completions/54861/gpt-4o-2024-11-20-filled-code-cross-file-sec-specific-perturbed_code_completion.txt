// Ensure width and height are aligned to at least 32 and 2 respectively
    *width = FFMAX(*width, 32);
    *height = FFALIGN(*height, 2);

    // If low resolution is used, adjust height to accommodate motion compensation
    if (codeccontext->lowres) {
        *height = FFALIGN(*height, 2);
    }

    // Additional alignment for specific codecs
    if (codeccontext->codec_id == AV_CODEC_ID_H264 ||
        codeccontext->codec_id == AV_CODEC_ID_HEVC ||
        codeccontext->codec_id == AV_CODEC_ID_VP8 ||
        codeccontext->codec_id == AV_CODEC_ID_VP9) {
        *height = FFALIGN(*height, 16);
    }