if (word.compare(i, compound_result->blen, compound_result->word, compound_result->blen) == 0) {
    char r = st[i + compound_result->blen];
    st[i + compound_result->blen] = '\0';

    if ((checkcompoundrep && cpdrep_check(st, st.size())) ||
        cpdwordpair_check(st, st.size())) {
      st[i + compound_result->blen] = r;
      continue;
    }

    if (forbiddenword) {
      struct hentry* fent = lookup(st.c_str(), st.size());
      if (fent && fent->astr && TESTAFF(fent->astr, forbiddenword, fent->alen)) {
        st[i + compound_result->blen] = r;
        return NULL;
      }
    }

    st[i + compound_result->blen] = r;
    return rv_first;
}