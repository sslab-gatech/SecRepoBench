{
    // Check if the current compound word part has a typical fault or forms a forbidden word pair.
    // If any such faults or forbidden word pairs are detected, reset the position in the string and
    // continue the loop.
    if ((checkcompoundrep && cpdrep_check(st, st.size())) ||
        cpdwordpair_check(st, st.size())) {
        st[i + compound_result->blen] = r;
        continue;
    }

    // If the 'forbiddenword' flag is set, look up the entire word in the dictionary to see if it's forbidden.
    // If the word is found to be forbidden, return NULL to indicate the compound word is not acceptable.
    if (forbiddenword) {
        hentry* he = lookup(st.c_str(), st.size());
        while (he && he->astr && (TESTAFF(he->astr, forbiddenword, he->alen) ||
                                  TESTAFF(he->astr, ONLYUPCASEFLAG, he->alen) ||
                                  (is_sug && nosuggest &&
                                   TESTAFF(he->astr, nosuggest, he->alen)))) {
            st[i + compound_result->blen] = r;
            return NULL;
        }
    }
}