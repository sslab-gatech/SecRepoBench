{
    if ((checkcompoundrep && cpdrep_check(st, i + compound_result->blen))
        || cpdwordpair_check(st, i + compound_result->blen)) {
        st[i + compound_result->blen] = r;
        continue;
    }

    struct hentry* forbid_entry = lookup(st.c_str(), i + compound_result->blen);
    if (forbid_entry && forbid_entry->astr
        && TESTAFF(forbid_entry->astr, forbiddenword, forbid_entry->alen)) {
        st[i + compound_result->blen] = r;
        return NULL;
    }

    st[i + compound_result->blen] = r;
}