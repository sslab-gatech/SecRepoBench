// Check if the current compound word part has a typical fault or forms a forbidden word pair.
                  if ((checkcompoundrep && cpdrep_check(st, i + compound_result->blen)) ||
                      cpdwordpair_check(st, i + compound_result->blen)) {
                    st[i + compound_result->blen] = r;
                    continue;
                  }

                  // If the 'forbiddenword' flag is set, look up the entire word in the dictionary to see if it's forbidden.
                  if (forbiddenword) {
                    struct hentry* forbidden_check = lookup(st.c_str(), i + compound_result->blen);
                    if (forbidden_check && forbidden_check->astr &&
                        TESTAFF(forbidden_check->astr, forbiddenword, forbidden_check->alen)) {
                      st[i + compound_result->blen] = r;
                      return NULL;
                    }
                  }

                  // Restore the original character at the current position after the checks.
                  st[i + compound_result->blen] = r;