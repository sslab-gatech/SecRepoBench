for (unsigned int i = 0; i < effectiveaxiscount; i++) {
  map->map (&coords[i]);
  map++;
}

if (version >= 2) {
  std::vector<float> output_coords (effectiveaxiscount);
  for (unsigned int i = 0; i < effectiveaxiscount; i++) {
    float delta = map->get_delta (coords[i]);
    output_coords[i] = clamp (coords[i] + delta, map->min_value, map->max_value);
  }
  delete map->variation_store;
  std::copy (output_coords.begin(), output_coords.end(), coords);
}