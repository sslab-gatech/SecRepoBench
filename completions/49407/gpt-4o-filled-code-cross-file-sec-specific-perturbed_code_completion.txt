std::vector<int> output_coords(effectiveaxiscount);

    for (unsigned int i = 0; i < effectiveaxiscount; i++)
    {
      coords[i] = map->map(coords[i]);
      map = &StructAfter<SegmentMaps>(*map);
    }

    if (version >= 2)
    {
      VariationStoreCache cache;
      for (unsigned int i = 0; i < effectiveaxiscount; i++)
      {
        int delta = variationIndexMap->get_delta(i, coords[i], cache);
        int transformed_value = coords[i] + delta;
        transformed_value = hb_clamp(transformed_value, min_value, max_value);
        output_coords[i] = transformed_value;
      }
      cache.deallocate();
    }
    else
    {
      for (unsigned int i = 0; i < effectiveaxiscount; i++)
      {
        output_coords[i] = coords[i];
      }
    }

    for (unsigned int i = 0; i < effectiveaxiscount; i++)
    {
      coords[i] = output_coords[i];
    }