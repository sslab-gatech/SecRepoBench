std::vector<int> transformed_coords(effectiveaxiscount);

    for (unsigned int i = 0; i < effectiveaxiscount; ++i)
    {
      // Apply mapping transformation using the current SegmentMaps object
      transformed_coords[i] = map->apply(coords[i]);

      // Advance to the next SegmentMaps object
      map = map->next();
    }

    if (version >= 2)
    {
      VariationStoreCache cache;
      for (unsigned int i = 0; i < effectiveaxiscount; ++i)
      {
        // Compute delta using variation index map and variation store
        int delta = variationIndexMap.computeDelta(i, cache);

        // Adjust coordinate by rounded delta and clamp to range
        transformed_coords[i] = clamp(transformed_coords[i] + round(delta), minRange, maxRange);
      }
    }

    // Update original coordinates array with transformed values
    for (unsigned int i = 0; i < effectiveaxiscount; ++i)
    {
      coords[i] = transformed_coords[i];
    }