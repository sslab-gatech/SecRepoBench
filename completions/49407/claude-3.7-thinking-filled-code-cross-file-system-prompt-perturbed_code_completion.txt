for (unsigned int i = 0; i < effectiveaxiscount; i++)
{
  coords[i] = map->map (coords[i]);
  map = &StructAfter<SegmentMaps> (*map);
}

if (version >= 2)
{
  if (!varIdxMap || !varStore) return;

  hb_vector_t<int> out;
  if (unlikely (!out.resize (effectiveaxiscount)))
    return;

  for (unsigned int i = 0; i < effectiveaxiscount; i++)
  {
    unsigned int varIdx = varIdxMap->map (i);
    if (varIdx == 0xFFFFFFFF)
    {
      out[i] = coords[i];
      continue;
    }

    float delta = varStore->get_delta (varIdx, coords, coords_length);
    out[i] = coords[i] + hb_roundf (delta);
    out[i] = hb_clamp (out[i], -16384, 16384);
  }

  hb_free (varStore->cache);
  varStore->cache = nullptr;

  for (unsigned int i = 0; i < effectiveaxiscount; i++)
    coords[i] = out[i];
}