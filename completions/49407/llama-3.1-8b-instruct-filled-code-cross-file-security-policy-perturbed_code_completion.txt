void map_coords (int *coords, unsigned int coords_length) const
  {
    unsigned int effectiveaxiscount = hb_min (coords_length, axisCount);

    const SegmentMaps *map = &firstAxisSegmentMaps;
    for (unsigned int i = 0; i < effectiveaxiscount; i++)
    {
      coords[i] = map->map (coords[i]);
      map = &StructAfter<SegmentMaps> (*map);
    }

    if (version >= 2)
    {
      VariationStore *var_store = new VariationStore (coords, coords_length);
      VariationIndexMap *var_index_map = new VariationIndexMap (coords, coords_length);
      for (unsigned int i = 0; i < coords_length; i++)
      {
        int delta = var_store->get_delta (coords[i], var_index_map);
        coords[i] = map->clamp (coords[i] + delta);
      }
      delete var_store;
      delete var_index_map;
    }

    // Update the original coordinates array with the transformed values
    for (unsigned int i = 0; i < effectiveaxiscount; i++)
    {
      coords[i] = map->unmap (coords[i]);
    }
  }