int *output = new int[effectiveaxiscount];
    for (unsigned int i = 0; i < effectiveaxiscount; i++)
    {
      output[i] = map->map(coords[i]);
      map = &StructAfter<SegmentMaps> (*map);
    }

    if (version >= 2)
    {
      VariationStoreCache variationStoreCache;
      variationStoreCache.allocate(variationStore, variationIndexMap, variationStoreSize);

      for (unsigned int i = 0; i < effectiveaxiscount; i++)
      {
        int variationIndex = variationIndexMap[i];
        float delta = variationStore[variationIndex];
        output[i] += round(delta);
        output[i] = hb_clamp(output[i], minValue, maxValue);
      }

      variationStoreCache.deallocate();
    }

    delete[] coords;
    coords = output;