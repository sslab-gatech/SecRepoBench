for (unsigned int i = 0; i < effectiveaxiscount; ++i) {
  coords[i] = map->apply(coords[i]);
  map++;
}

if (version >= 2) {
  std::vector<int> output(coords_length);
  VariationStoreCache variationStoreCache(this);
  for (unsigned int i = 0; i < effectiveaxiscount; ++i) {
    int variationIndex = variationIndexMap->get(i);
    int delta = variationStoreCache.getDelta(variationIndex);
    int transformed = coords[i] + round(delta);
    transformed = hb_clamp(transformed, minValue, maxValue);
    output[i] = transformed;
  }
  coords_length = output.size();
  coords = output.data();
  variationStoreCache.deallocate();
}