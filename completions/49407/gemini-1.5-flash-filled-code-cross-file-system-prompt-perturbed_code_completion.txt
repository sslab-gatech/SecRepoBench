for (unsigned int i = 0; i < effectiveaxiscount; i++)
    {
      coords[i] = map->map (coords[i]);
      map = &StructAfter<SegmentMaps> (*map);
    }

    if (version >= 2)
    {
      unsigned int variation_index_map_length = variationIndexMap.length ();
      std::vector<int> variation_store_cache (variation_index_map_length);
      std::vector<int> transformed_coords (effectiveaxiscount);

      for (unsigned int i = 0; i < effectiveaxiscount; i++)
      {
        unsigned int variation_index = variationIndexMap[i];
        int delta = variationStore[variation_index];
        transformed_coords[i] = coords[i] + delta;
        transformed_coords[i] = hb_clamp (transformed_coords[i], minCoord[i], maxCoord[i]);
      }

      for (unsigned int i = 0; i < effectiveaxiscount; i++)
        coords[i] = transformed_coords[i];
    }
  }