// <MASK>
if (version >= 2)
{
  // Allocate an output vector for the transformed coordinates
  int *output_coords = (int *) calloc(effectiveaxiscount, sizeof(int));
  if (unlikely(!output_coords))
    return;

  // For each coordinate, apply an additional transformation involving a variation index map and a variation store to compute a delta value
  for (unsigned int i = 0; i < effectiveaxiscount; i++)
  {
    int delta = 0;
    map->apply_variation_delta(coords[i], &delta);
    output_coords[i] = coords[i] + round(delta);
    output_coords[i] = hb_clamp(output_coords[i], map->get_min_value(), map->get_max_value());
    map = &StructAfter<SegmentMaps>(*map);
  }

  // Update the original coordinates array with the transformed values from the output vector
  memcpy(coords, output_coords, effectiveaxiscount * sizeof(int));

  // Deallocate the variation store cache
  map->deallocate_variation_store_cache();

  // Deallocate the output vector
  free(output_coords);
}