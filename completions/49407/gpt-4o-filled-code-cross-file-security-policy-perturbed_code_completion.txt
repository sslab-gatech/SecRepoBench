std::vector<int> output_coords(effectiveaxiscount);

    for (unsigned int i = 0; i < effectiveaxiscount; i++)
    {
      coords[i] = map->map(coords[i]);
      map = &StructAfter<SegmentMaps>(*map);
    }

    if (version >= 2)
    {
      VariationStoreCache cache;
      for (unsigned int i = 0; i < effectiveaxiscount; i++)
      {
        int delta = variationStore->compute_delta(variationIndexMap[i], coords[i], cache);
        int transformed_value = coords[i] + round(delta);
        output_coords[i] = clamp(transformed_value, min_value, max_value);
      }
      cache.deallocate();
    }
    else
    {
      for (unsigned int i = 0; i < effectiveaxiscount; i++)
      {
        output_coords[i] = coords[i];
      }
    }

    for (unsigned int i = 0; i < effectiveaxiscount; i++)
    {
      coords[i] = output_coords[i];
    }