for (unsigned int i = 0; i < effectiveaxiscount; i++)
    {
      coords[i] = map->map (coords[i]);
      map = &StructAfter<SegmentMaps> (*map);
    }

    if (version.major >= 2)
    {
      hb_vector_t<int> out;
      if (unlikely (!out.alloc (effectiveaxiscount)))
        return;

      const VariationStore &var_store = StructAfter<VariationStore> (*map);
      for (unsigned int i = 0; i < effectiveaxiscount; i++)
      {
        float delta = 0.;
        if (var_store.get_variation_index_map ().get (i, &delta))
          delta = var_store.get_delta (varIdxMap.get (i), coords, coords_length);
        out[i] = hb_clamp (coords[i] + (int) roundf (delta), -0x7FFF, 0x7FFF);
      }

      var_store.destroy_cache ();
      memcpy (coords, out.arrayZ, effectiveaxiscount * sizeof (int));
    }