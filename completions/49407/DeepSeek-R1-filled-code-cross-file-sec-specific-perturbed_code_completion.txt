for (unsigned int i = 0; i < effectiveaxiscount; i++)
    {
        coords[i] = map->map(coords[i]);
        map = &StructAfter<SegmentMaps>(*map);
    }

    if (version >= 2)
    {
        hb_vector_t<int> out;
        if (unlikely (!out.resize (effectiveaxiscount))) return;

        for (unsigned int i = 0; i < effectiveaxiscount; i++)
        {
            int v = coords[i];
            uint32_t varidx = varIndexMap.map (i);
            float delta = varStore->get_delta (varidx, coords, coords_length);
            v += roundf (delta);
            v = hb_clamp (v, -(1<<14), (1<<14)-1);
            out[i] = v;
        }

        memcpy (coords, out.arrayZ, effectiveaxiscount * sizeof (int));
        varStore->destroy_cache ();
    }