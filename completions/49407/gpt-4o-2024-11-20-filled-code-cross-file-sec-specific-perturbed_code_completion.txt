// Allocate a temporary array to store the transformed coordinates
    int *transformed_coords = (int *) hb_calloc(effectiveaxiscount, sizeof(int));
    if (unlikely(!transformed_coords)) return;

    // Apply the mapping transformation for each coordinate
    for (unsigned int i = 0; i < effectiveaxiscount; i++)
    {
      transformed_coords[i] = map->map(coords[i]);
      map = &StructAfter<SegmentMaps>(*map);
    }

    // If version is 2 or higher, apply additional processing
    if (version >= 2)
    {
      VariationStoreCache cache;
      if (unlikely(!cache.init(variationStore))) {
        hb_free(transformed_coords);
        return;
      }

      for (unsigned int i = 0; i < effectiveaxiscount; i++)
      {
        int delta = cache.get_delta(variationIndexMap.get_variation_index(i));
        transformed_coords[i] = hb_clamp<int>(transformed_coords[i] + hb_round(delta), minCoord, maxCoord);
      }
    }

    // Update the original coordinates array with the transformed values
    for (unsigned int i = 0; i < effectiveaxiscount; i++)
    {
      coords[i] = transformed_coords[i];
    }

    // Free the allocated memory for the transformed coordinates
    hb_free(transformed_coords);