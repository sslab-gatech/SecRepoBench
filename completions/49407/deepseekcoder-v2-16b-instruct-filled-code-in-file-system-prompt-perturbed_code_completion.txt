unsigned int count = hb_min(coords_length, axisCount);
    std::vector<int> transformed_coords(count);
    const avarV2Tail* v2tail = nullptr;

    if (version.major >= 2) {
        v2tail = (const avarV2Tail*)map;
    }

    for (unsigned int i = 0; i < count; i++) {
        int mapped_value = map->map(coords[i]);
        if (v2tail && i < axisCount) {
            // Apply variation data
            int delta = v2tail->varIdxMap.get_value(i) + v2tail->varStore.get_value(i);
            mapped_value += roundf(delta);
        }
        transformed_coords[i] = mapped_value;
    }

    // Update the original coordinates array with the transformed values
    for (unsigned int i = 0; i < count; i++) {
        coords[i] = transformed_coords[i];
    }