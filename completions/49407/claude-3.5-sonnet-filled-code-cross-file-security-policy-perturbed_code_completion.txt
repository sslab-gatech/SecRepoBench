for (unsigned int i = 0; i < effectiveaxiscount; i++)
{
  coords[i] = map->map (coords[i]);
  map = &StructAfter<SegmentMaps> (*map);
}

if (version >= 2)
{
  hb_vector_t<int> output;
  if (unlikely (!output.alloc (effectiveaxiscount)))
    return;

  for (unsigned int i = 0; i < effectiveaxiscount; i++)
  {
    unsigned int mapping_index = varIdxMap.map (i);
    int delta = varStore.get_delta (mapping_index, coords, effectiveaxiscount);
    output[i] = roundf (coords[i] + delta);
    output[i] = hb_clamp (output[i], axisV1Negative[i], axisV1Positive[i]);
  }

  hb_free (varStore.blob);
  hb_memcpy (coords, &output[0], effectiveaxiscount * sizeof (coords[0]));
}

for (unsigned int i = effectiveaxiscount; i < coords_length; i++)
  coords[i] = 0;