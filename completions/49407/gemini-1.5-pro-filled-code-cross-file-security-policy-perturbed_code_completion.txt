for (unsigned int i = 0; i < effectiveaxiscount; i++)
    {
      coords[i] = map->map (coords[i]);
      map = &StructAfter<SegmentMaps> (*map);
    }

    if (version < 2) return;

    unsigned int coords_length_u = coords_length; // Workaround bogus GCC warning
    int *output = (int *) hb_calloc (coords_length_u, sizeof (int));
    if (unlikely (!output)) return;

    const VariationData *variation_data = &axisVariations[0];
    for (unsigned int i = 0; i < effectiveaxiscount; i++, variation_data++)
    {
      const hb_array_t<const ItemVariationData> item_variations = variation_data->getItemVariations ();

      int delta = 0;
      if (item_variations.length)
      {
	const F2Dot14 *delta_set = variation_store->get_delta_set (variation_data->get_delta_set_index ());
	unsigned int index = variation_data->get_index_map (coords[i]);
	delta = delta_set[index].to_int ();
      }

      output[i] = coords[i] + delta;
      output[i] = hb_clamp (output[i], -16384, 16384);
    }

    variation_store->clear_cache ();

    for (unsigned int i = 0; i < coords_length_u; i++)
      coords[i] = output[i];

    hb_free (output);