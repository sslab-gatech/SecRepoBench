for (unsigned int i = 0; i < effectiveaxiscount; i++)
    {
      coords[i] = map->map (coords[i]);
      map = &StructAfter<SegmentMaps> (*map);
    }

    if (version >= 2)
    {
      int *output = (int *) hb_calloc (effectiveaxiscount, sizeof (int));
      if (unlikely (!output))
        return;

      hb_memcpy (output, coords, effectiveaxiscount * sizeof (int));

      for (unsigned int i = 0; i < effectiveaxiscount; i++)
      {
        int variation_index = variationIndexMap->get_variation_index (i);
        float delta = variationStore->get_delta (variation_index, coords);
        int adjusted_coord = coords[i] + lroundf (delta);
        output[i] = hb_clamp (adjusted_coord, minCoords[i], maxCoords[i]);
      }

      hb_memcpy (coords, output, effectiveaxiscount * sizeof (int));
      hb_free (output);
    }