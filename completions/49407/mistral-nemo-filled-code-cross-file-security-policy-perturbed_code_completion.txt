for (unsigned int i = 0; i < effectiveaxiscount; ++i) {
  coords[i] = map->apply(coords[i]);
  map++;
}

if (version >= 2) {
  std::vector<int> output(coords_length);
  VariationStoreCache variationStoreCache(variationIndexMap, variationStore);
  for (unsigned int i = 0; i < coords_length; ++i) {
    int delta = variationStoreCache.getDelta(i);
    int roundedDelta = round(delta);
    int transformedCoord = coords[i] + roundedDelta;
    transformedCoord = std::max(minValue, std::min(maxValue, transformedCoord));
    output[i] = transformedCoord;
  }
  coords = output.data();
  variationStoreCache.deallocate();
}