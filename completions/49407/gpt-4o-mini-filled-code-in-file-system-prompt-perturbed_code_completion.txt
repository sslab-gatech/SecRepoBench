std::vector<int> output_coords(effectiveaxiscount);
    for (unsigned int i = 0; i < effectiveaxiscount; i++)
    {
      output_coords[i] = map->map(coords[i]);
      map = &StructAfter<SegmentMaps>(*map);
    }

#ifndef HB_NO_VARIATIONS2
    if (version.major >= 2)
    {
      const avarV2Tail *v2 = (const avarV2Tail *)map;
      for (unsigned int i = 0; i < effectiveaxiscount; i++)
      {
        int delta = v2->varIdxMap.get_delta(coords[i]);
        output_coords[i] += delta;
      }
    }
#endif

    for (unsigned int i = 0; i < effectiveaxiscount; i++)
    {
      coords[i] = std::clamp(output_coords[i], -32768, 32767); // Assuming clamping range
    }