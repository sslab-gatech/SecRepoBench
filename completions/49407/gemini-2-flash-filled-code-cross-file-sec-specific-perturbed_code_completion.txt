for (unsigned int i = 0; i < effectiveaxiscount; i++)
    {
      coords[i] = map->map (coords[i]);
      map = &StructAfter<SegmentMaps> (*map);
    }

    if (likely (face->table.gvar && face->table.fvar && version >= 2))
    {
      VariationStoreCache *varstore_cache = face->table.gvar->get_variation_store_cache ();
      if (unlikely (!varstore_cache))
        return;

      hb_vector_t<int> transformed_coords;
      transformed_coords.resize (coords_length);

      for (unsigned int i = 0; i < coords_length; i++)
      {
        int delta = varstore_cache->get_value (i, coords);
        int transformed_coord = coords[i] + hb_round (delta);
        transformed_coords[i] = hb_clamp (transformed_coord, SHRT_MIN, SHRT_MAX);
      }

      face->table.gvar->drop_variation_store_cache (varstore_cache);

      for (unsigned int i = 0; i < coords_length; i++)
        coords[i] = transformed_coords[i];
    }