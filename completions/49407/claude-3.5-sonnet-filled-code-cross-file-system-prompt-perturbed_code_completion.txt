for (unsigned int i = 0; i < effectiveaxiscount; i++)
{
  coords[i] = map->map (coords[i]);
  map = &StructAfter<SegmentMaps> (*map);
}

if (version >= 2)
{
  hb_vector_t<int> transformed_coords;
  transformed_coords.alloc (effectiveaxiscount);

  for (unsigned int i = 0; i < effectiveaxiscount; i++)
  {
    unsigned int variation_index = varIdxMap.map (coords[i]);
    float delta = varStore.get_delta (variation_index, coords, coords_length);
    int rounded_delta = hb_roundf (delta);
    transformed_coords[i] = hb_clamp (coords[i] + rounded_delta, axisV1Ranges[i].min, axisV1Ranges[i].max);
  }

  varStore.cache_clear ();

  for (unsigned int i = 0; i < effectiveaxiscount; i++)
    coords[i] = transformed_coords[i];
}