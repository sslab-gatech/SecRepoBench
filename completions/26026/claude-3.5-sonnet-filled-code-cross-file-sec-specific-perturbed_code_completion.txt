if (chunksize > psf->filelength - psf_ftell(audio_file_private))
{
    psf_log_printf(audio_file_private, "cart : %u (too large, truncating)\n", chunksize);
    chunksize = psf->filelength - psf_ftell(audio_file_private);
}

if (chunksize > WAV_CART_MAX_CHUNK_SIZE)
{
    psf_log_printf(audio_file_private, "cart : %u (too large, truncating to %d)\n", chunksize, WAV_CART_MAX_CHUNK_SIZE);
    chunksize = WAV_CART_MAX_CHUNK_SIZE;
}