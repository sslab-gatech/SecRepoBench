unsigned int *offsets = c->allocate_size<unsigned int> ((fdCount + 1) * offsetSize);
if (unlikely (!offsets)) return_trace (false);

unsigned int offset = 0;
for (unsigned int i = 0; i < fontDicts.length; i++)
{
  if (fdmap.includes (i))
  {
    unsigned int size = FontDict::calculate_serialized_size (fontDicts[i], opszr);
    offset += size;
    c->copy_array (offsets + i * offsetSize, &offset, offsetSize);
  }
}
c->copy_array (offsets + fdCount * offsetSize, &offset, offsetSize);