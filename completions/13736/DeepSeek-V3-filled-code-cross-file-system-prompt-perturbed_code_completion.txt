unsigned int offset = 1;
unsigned int *offsetArray = (unsigned int *) c->allocate_size<unsigned int> (offsetSize * (fdCount + 1));
if (unlikely (!offsetArray)) return_trace (false);

for (unsigned int i = 0; i < fdCount; i++)
{
  if (fdmap.includes (i))
  {
    offsetArray[i] = offset;
    offset += FontDict::calculate_serialized_size (fontDicts[i], opszr, privateInfos[fdmap[i]]);
  }
  else
    offsetArray[i] = 0;
}
offsetArray[fdCount] = offset;