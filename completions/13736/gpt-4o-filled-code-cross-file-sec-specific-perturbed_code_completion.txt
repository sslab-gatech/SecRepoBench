unsigned int *offsets = (unsigned int *) malloc(fdCount * sizeof(unsigned int));
    if (!offsets) return_trace(false);

    unsigned int currentOffset = 0;
    for (unsigned int i = 0; i < fdCount; i++) {
      if (fdmap.includes(i)) {
        offsets[i] = currentOffset;
        currentOffset += fontDicts[i].get_serialized_size();
      } else {
        offsets[i] = 0; // or some invalid value indicating not included
      }
    }

    this->offsets.set(offsets, fdCount);
    free(offsets);