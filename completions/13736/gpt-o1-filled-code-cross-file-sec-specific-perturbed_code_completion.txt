// Reserve space for offset array (fdCount + 1 entries, each entry is offsetSize bytes).
    // Initialize first offset to 1, then compute subsequent offsets by accumulating
    // serialized sizes of included font dictionaries.
    if (!this->offsets.allocate(c, fdCount + 1))
      return_trace(false);

    unsigned int currentOffset = 1;
    this->offsets[0].set(currentOffset, offsetSize);

    unsigned int offsetIndex = 1;
    for (unsigned int i = 0; i < fontDicts.length; i++)
    {
      if (fdmap.includes(i))
      {
        unsigned int dictSize = FontDict::calculate_serialized_size(fontDicts[i], opszr);
        currentOffset += dictSize;
        this->offsets[offsetIndex].set(currentOffset, offsetSize);
        offsetIndex++;
      }
    }