size_t bufferSize = fdCount * offsetSize; // Calculate the required buffer size
    if (bufferSize == 0) return_trace(false); // Check for zero size to prevent allocation issues

    // Allocate memory for offsets
    unsigned char *offsets = (unsigned char *)malloc(bufferSize);
    if (offsets == NULL) return_trace(false); // Check for allocation failure

    // Initialize offsets to zero
    memset(offsets, 0, bufferSize);

    // Store offsets for each font dictionary
    size_t currentOffset = 0;
    for (unsigned int i = 0; i < fontDicts.length; i++) {
      if (fdmap.includes(i)) {
        // Calculate the offset for the current font dictionary
        size_t dictSize = fontDicts[i].getSize(); // Assuming getSize() returns the size of the font dictionary
        if (currentOffset + dictSize > bufferSize) {
          free(offsets); // Free allocated memory on overflow
          return_trace(false); // Prevent overflow
        }
        offsets[currentOffset] = (unsigned char)(currentOffset); // Store the offset
        currentOffset += dictSize; // Update current offset
      }
    }

    // Free allocated memory after use
    free(offsets);