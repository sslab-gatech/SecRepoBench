unsigned int totalSize = 0;
    unsigned int *offsets = new unsigned int[fdCount];
    
    for (unsigned int i = 0; i < fdCount; i++) {
        if (fdmap.includes(i)) {
            if (i < fdCount) {
                offsets[i] = totalSize;
                totalSize += FontDict::calculate_serialized_size(fontDicts[i], opszr, privateInfos[fdmap[i]]);
            }
        }
    }
    
    if (offsets) {
        this->offsets.set(offsets, fdCount);
    }