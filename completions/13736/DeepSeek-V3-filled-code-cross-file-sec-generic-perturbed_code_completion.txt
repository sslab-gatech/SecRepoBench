unsigned int offset = 1;
    unsigned int *offsetArray = (unsigned int *) hb_calloc (fdCount, offsetSize);
    if (unlikely (!offsetArray)) return_trace (false);

    for (unsigned int i = 0, j = 0; i < fontDicts.length; i++)
    {
      if (fdmap.includes (i))
      {
        set_offset_at (j++, offset, offsetArray, offsetSize);
        offset += FontDict::calculate_serialized_size (fontDicts[i], opszr, privateInfos[fdmap[i]]);
      }
    }
    set_offset_at (fdCount, offset, offsetArray, offsetSize);

    if (unlikely (!c->copy (offsetArray, fdCount + 1, offsetSize)))
    {
      hb_free (offsetArray);
      return_trace (false);
    }
    hb_free (offsetArray);