unsigned int offset = 0;
    unsigned int *offsets = (unsigned int *) c->allocate_size<4> (fdCount * offsetSize);
    if (unlikely (!offsets)) return_trace (false);

    for (unsigned int i = 0; i < fontDicts.length; i++)
    {
      if (fdmap.includes (i))
      {
        FontDict *dict = c->start_embed<FontDict> ();
        if (unlikely (!dict->serialize (c, fontDicts[i], opszr, privateInfos[fdmap[i]])))
          return_trace (false);
        store_offset (offsets + i, offset, offsetSize);
        offset += dict->get_length ();
      }
      else
      {
        store_offset (offsets + i, 0, offsetSize); // Set unused offsets to 0
      }
    }
    store_offset (offsets + fdCount, offset, offsetSize); // Store the final offset