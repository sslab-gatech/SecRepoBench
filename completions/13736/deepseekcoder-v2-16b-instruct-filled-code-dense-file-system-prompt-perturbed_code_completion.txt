// Allocate memory for storing offsets of font dictionaries based on the offset size and count of font dictionaries.
    // Initialize offset tracking variables for serialization of font dictionary offsets.
    // Iterate through each font dictionary, checking if it is included in the remap.
    // For included font dictionaries, set their respective offsets in a serializable format.
    // Compute and accumulate the serialized size of each included font dictionary into the offset variable.
    // Update the last offset to mark the end of the serialized data for font dictionaries.
    unsigned int totalOffset = 0;
    for (unsigned int i = 0; i < fontDicts.length; i++)
      if (fdmap.includes (i))
      {
	totalOffset += FontDict::calculate_serialized_size (fontDicts[i], opszr);
      }
    if (!c->allocate_size<HBUINT8> (offsetSize * (fontDicts.length + 1)))
      return_trace (false);

    /* serialize font dict offsets */
    unsigned int offset = 1;
    for (unsigned int i = 0; i < fontDicts.length; i++)
    {
      if (fdmap.includes (i))
      {
	CFFIndexOf<COUNT, FontDict>::set_offset_at (i, offset);
	offset += FontDict::calculate_serialized_size (fontDicts[i], opszr);
      }
    }
    CFFIndexOf<COUNT, FontDict>::set_offset_at (fontDicts.length, offset);

    /* serialize font dicts */
    for (unsigned int i = 0; i < fontDicts.length; i++)
    {
      if (fdmap.includes (i))
      {
	FontDict *dict = c->start_embed<FontDict> ();
	if (unlikely (!dict->serialize (c, fontDicts[i], opszr, privateInfos[fdmap[i]])))
	  return_trace (false);
      }
    }
    return_trace (true);