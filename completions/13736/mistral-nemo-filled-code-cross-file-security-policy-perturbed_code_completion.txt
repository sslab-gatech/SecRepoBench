unsigned int offset = 0;
    this->offsets.set_length (fontDicts.length);
    for (unsigned int i = 0; i < fontDicts.length; i++)
    {
      if (i < fontDicts.length && fdmap.includes (i))
      {
	this->offsets[i].set (offset);
	FontDict *dict = c->start_embed<FontDict> ();
	if (dict && dict->serialize (c, fontDicts[i], opszr, privateInfos[fdmap[i]]))
	{
	  offset += dict->get_serialized_size();
	}
	else
	{
	  return_trace (false);
	}
      }
    }
    this->lastOffset.set (offset);