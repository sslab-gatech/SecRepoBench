if (unlikely (!c->allocate_size<void> (offsetSize * (fdCount + 1)))) return_trace (false);
    unsigned int offset = 1;
    unsigned int current = 0;
    for (unsigned int i = 0; i < fontDicts.length; i++)
    {
      if (fdmap.includes (i))
      {
        switch (offsetSize)
        {
          case 1:
            if (unlikely (offset > 0xFFU)) return_trace (false);
            ((HBUINT8*)this->offsets)[current] = offset;
            break;
          case 2:
            ((HBUINT16*)this->offsets)[current] = offset;
            break;
          case 3:
            if (unlikely (offset > 0xFFFFFFU)) return_trace (false);
            c->copy (offset, 3, (char*)this->offsets + current * 3);
            break;
          case 4:
            ((HBUINT32*)this->offsets)[current] = offset;
            break;
          default:
            return_trace (false);
        }
        current++;
        unsigned int size = fontDicts[i].get_size (opszr, privateInfos[fdmap[i]]);
        if (unlikely (offset > UINT_MAX - size)) return_trace (false);
        offset += size;
      }
    }
    switch (offsetSize)
    {
      case 1:
        if (unlikely (offset > 0xFFU)) return_trace (false);
        ((HBUINT8*)this->offsets)[fdCount] = offset;
        break;
      case 2:
        ((HBUINT16*)this->offsets)[fdCount] = offset;
        break;
      case 3:
        if (unlikely (offset > 0xFFFFFFU)) return_trace (false);
        c->copy (offset, 3, (char*)this->offsets + fdCount * 3);
        break;
      case 4:
        ((HBUINT32*)this->offsets)[fdCount] = offset;
        break;
      default:
        return_trace (false);
    }