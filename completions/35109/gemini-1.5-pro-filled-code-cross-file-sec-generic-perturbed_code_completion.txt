while (p < end && ISDIGIT(*p)) {
    nextnumber = 10 * nextnumber + (*p - '0');
    p++;
  }
  if (p == end || *p != '$') {
    mrb_raisef(mrb, E_ARGUMENT_ERROR, "malformed name - no \\$ following number: %S", mrb_str_new_static(mrb, p, end-p));
  }
  p++;