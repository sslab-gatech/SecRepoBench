if (p >= end || !isdigit((unsigned char)*p)) {
  mrb_raise(mrb, E_ARGUMENT_ERROR, "malformed format specifier");
}
while (p < end && isdigit((unsigned char)*p)) {
  int digit = *p - '0';
  if (nextnumber > (INT_MAX - digit) / 10) {
    mrb_raise(mrb, E_ARGUMENT_ERROR, "number too large");
  }
  nextnumber = nextnumber * 10 + digit;
  p++;
}