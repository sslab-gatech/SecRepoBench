// Check for TZSP (TaZman Sniffer Protocol) encapsulation in UDP packets.
      u_int offset = ip_offset + ip_len + sizeof(struct ndpi_udphdr);
      if (offset + 2 < header->caplen) {
        u_int8_t version = packet[offset];
        u_int8_t type = packet[offset + 1];
        if (version == 1 && type == 0) { // Version 1, encapsulated Ethernet
          offset += 2; // Skip version and type
          while (offset < header->caplen) {
            u_int8_t tag_type = packet[offset];
            u_int8_t tag_length = packet[offset + 1];
            offset += 2; // Move past tag type and length
            if (tag_type == 1) { // END tag
              break;
            } else if (tag_type == 0) { // PADDING tag
              continue;
            } else {
              offset += tag_length; // Skip the tag data
            }
          }
          eth_offset = offset;
          datalink_type = DLT_EN10MB;
          goto datalink_check;
        }
      }