u_int offset = ip_offset + ip_len + sizeof(struct ndpi_udphdr);
      u_int8_t version = packet[offset];
      u_int8_t type = packet[offset + 1];

      if (version == 1 && type == 1) { // Check for TZSP version 1 and Ethernet type.
        tunnel_type = ndpi_tzsp_tunnel;
        ip_offset = offset + 2; // Adjust offset to skip TZSP header.
        datalink_type = DLT_EN10MB; // Assume encapsulated Ethernet frame.
        goto datalink_check;
      }