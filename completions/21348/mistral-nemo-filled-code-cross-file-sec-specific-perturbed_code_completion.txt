/* TZSP (TaZman Sniffer Protocol) encapsulation in UDP packets */
  if((sport == TZSP_PORT) || (dport == TZSP_PORT)) {
    u_int offset = ip_offset+ip_len+sizeof(struct ndpi_udphdr);
    u_int16_t msg_len = packet[offset+1] >> 1;
    offset += msg_len + 2; /* Skip TZSP message length and type */

    if(packet[offset] == 0xAA) {
      /* Ethernet frame encapsulated in TZSP */
      eth_offset = offset + 14; /* Skip TZSP Ethernet header */
      goto datalink_check;
    }
  }