u_int8_t tzsp_version = packet[offset];
      u_int8_t tzsp_type = packet[offset + 1];

      if (tzsp_version == 1 && tzsp_type == 0) { // Check for valid TZSP version and type
        u_int16_t encapsulated_len = ntohs(*(u_int16_t *)&packet[offset + 2]);
        if (header->caplen >= offset + 4 + encapsulated_len) {
          eth_offset = offset + 4; // Set new eth_offset to the start of the encapsulated packet
          goto datalink_check; // Recheck the datalink type with the new offset
        }
      }