u_int offset = ip_offset+ip_len+sizeof(struct ndpi_udphdr);
      u_int8_t version = packet[offset];
      u_int8_t type    = packet[offset+1];

      if(((version == 0) || (version == 1))
	 && (type == 1 /* Ethernet */)) {
	u_int16_t tzsp_tag_len = 0;

	tunnel_type = ndpi_tzsp_tunnel;

	offset += 4; /* Skip TZSP header */

	while(offset < header->caplen) {
	  u_int8_t tag_type = packet[offset];
	  u_int16_t tag_len = ntohs(*((u_int16_t*)&packet[offset+2]));

	  tzsp_tag_len += tag_len;

	  if(tag_type == 0 /* END */) {
	    eth_offset = offset + 4;
	    datalink_type = DLT_EN10MB;
	    goto datalink_check;
	  } else if(tag_type == 1 /* PADDING */) {
	    offset += 4; /* Skip padding tag */
	  } else {
	    offset += tag_len + 4; /* Skip current tag */
	  }
	}
      }