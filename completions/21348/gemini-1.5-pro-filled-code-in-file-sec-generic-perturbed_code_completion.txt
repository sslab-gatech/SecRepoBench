u_int offset = ip_offset+ip_len+sizeof(struct ndpi_udphdr);
      u_int8_t version = packet[offset];
      u_int8_t type = packet[offset+1];

      if(((version == 0) || (version == 1))
	 && (type == 1 /* Ethernet */)) {
	u_int16_t tzsp_len = ntohs(*((u_int16_t*)&packet[offset+2]));

	offset += 4;

	while(offset < header->caplen) {
	  u_int16_t tag_type = ntohs(*((u_int16_t*)&packet[offset]));
	  u_int16_t tag_len  = ntohs(*((u_int16_t*)&packet[offset+2]));

	  if(tag_type == 0 /* END */) {
	    eth_offset = offset + 4;
	    tunnel_type = ndpi_tzsp_tunnel;
	    datalink_type = DLT_EN10MB;
	    goto datalink_check;
	  } else if(tag_type == 1 /* PADDING */) {
	    offset += 4 + tag_len;
	  } else {
	    offset += 4 + tag_len;
	  }
	}
      }