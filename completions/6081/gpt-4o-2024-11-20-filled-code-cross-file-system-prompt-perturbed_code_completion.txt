c=xml;
    while (*c != '\0')
    {
      if (strncmp(c, "<!ENTITY", 8) == 0)
      {
        c += 8;
        while (isspace((int) *c))
          c++;
        if (*c == '%')
        {
          c++;
          while (isspace((int) *c))
            c++;
        }
        n=c;
        while ((*c != '\0') && !isspace((int) *c) && (*c != '>'))
          c++;
        if (*c == '\0')
          break;
        *c='\0';
        c++;
        while (isspace((int) *c))
          c++;
        if (*c == '"')
          q='"';
        else if (*c == '\'')
          q='\'';
        else
          break;
        c++;
        t=c;
        while ((*c != '\0') && (*c != q))
          c++;
        if (*c == '\0')
          break;
        *c='\0';
        c++;
        v=ConstantString(t);
        if (v == (char *) NULL)
          ThrowFatalException(ResourceLimitError,"MemoryAllocationFailed");
        index=0;
        for (i=0; predefined_entitites[i] != (char *) NULL; i+=2)
        {
          if (strcmp(predefined_entitites[i],n) == 0)
          {
            index=i;
            break;
          }
        }
        if (predefined_entitites[index] != (char *) NULL)
          predefined_entitites[index+1]=DestroyString(predefined_entitites[index+1]);
        predefined_entitites[index]=ConstantString(n);
        predefined_entitites[index+1]=v;
        continue;
      }
      else if (strncmp(c, "<!ATTLIST", 9) == 0)
      {
        c += 9;
        while ((*c != '\0') && (*c != '>'))
          c++;
        if (*c == '\0')
          break;
        c++;
        continue;
      }
      else if (strncmp(c, "<!--", 4) == 0)
      {
        c += 4;
        while ((*c != '\0') && (strncmp(c, "-->", 3) != 0))
          c++;
        if (*c == '\0')
          break;
        c += 3;
        continue;
      }
      else if (strncmp(c, "<?", 2) == 0)
      {
        c += 2;
        while ((*c != '\0') && (strncmp(c, "?>", 2) != 0))
          c++;
        if (*c == '\0')
          break;
        c += 2;
        continue;
      }
      c++;
    }