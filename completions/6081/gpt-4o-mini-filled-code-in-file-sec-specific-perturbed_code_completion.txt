while (*xml != '\0')
    {
        xml += strspn(xml, " \n\r\t");
        if (strncmp(xml, "<!ENTITY", 8) == 0)
        {
            char *entity_name = xml + 8;
            xml += strcspn(entity_name, " \n\r\t>");
            *xml = '\0'; // Terminate the entity name
            entity_name = ConstantString(entity_name);
            // Allocate memory for the entity and store it
            if (root->entities == (char **) NULL)
            {
                root->entities = (char **) AcquireQuantumMemory(2, sizeof(*root->entities));
                root->entities[0] = entity_name;
                root->entities[1] = (char *) NULL;
            }
            else
            {
                size_t i;
                for (i = 0; root->entities[i] != (char *) NULL; i += 2);
                root->entities = (char **) ResizeQuantumMemory(root->entities, (i + 3) * sizeof(*root->entities));
                root->entities[i] = entity_name;
                root->entities[i + 1] = (char *) NULL;
            }
            xml += strcspn(xml, ">");
            if (*xml == '>') xml++; // Move past the closing '>'
        }
        else if (strncmp(xml, "<!ATTLIST", 9) == 0)
        {
            // Handle ATTLIST declarations
            // Similar parsing logic as above for attributes
            // ...
        }
        else if (strncmp(xml, "<!DOCTYPE", 8) == 0)
        {
            // Handle DOCTYPE declarations
            // ...
        }
        else
        {
            // Handle other cases or break if necessary
            break;
        }
    }