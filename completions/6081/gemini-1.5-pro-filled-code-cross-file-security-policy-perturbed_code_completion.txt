if (strncmp(xml,"<!DOCTYPE",9) == 0)
      {
        xml+=9;
        while (isspace((int) ((unsigned char) *xml)) != 0)
          xml++;
        t=xml;
        while (isalnum((int) ((unsigned char) *xml)) != 0)
          xml++;
        if (t == xml)
          break; // Root element missing
        n=AcquireString(t);
        n[xml-t]='\0';
        while (isspace((int) ((unsigned char) *xml)) != 0)
          xml++;
        if (*xml == '[')
          {
            for (xml++; *xml != ']'; )
            {
              char
                *keyword;

              while (isspace((int) ((unsigned char) *xml)) != 0)
                xml++;
              t=xml;
              while (isalnum((int) ((unsigned char) *xml)) != 0)
                xml++;
              keyword=AcquireString(t);
              keyword[xml-t]='\0';
              while (isspace((int) ((unsigned char) *xml)) != 0)
                xml++;
              if (LocaleCompare(keyword,"ENTITY") == 0)
                {
                  while (isspace((int) ((unsigned char) *xml)) != 0)
                    xml++;
                  if (*xml == '%')
                    xml++;
                  while (isspace((int) ((unsigned char) *xml)) != 0)
                    xml++;
                  t=xml;
                  while (isalnum((int) ((unsigned char) *xml)) != 0)
                    xml++;
                  c=AcquireString(t);
                  c[xml-t]='\0';
                  while (isspace((int) ((unsigned char) *xml)) != 0)
                    xml++;
                  q=(*xml == '"' ? '"' : '\'');
                  for (xml++; *xml != q; xml++);
                  v=AcquireString(xml);
                  v[1]='\0';
                  xml++;
                  if (q == '"')
                    {
                      for ( ; *xml != '\0'; xml++)
                      {
                        if (*xml == '&')
                          {
                            ParseCharacterContent(root,xml,0,q);
                            break;
                          }
                        if (*xml == '"')
                          break;
                      }
                    }
                  entities=(char **) ResizeQuantumMemory(predefined_entitites,
                    (size_t) (index+2),sizeof(*entities));
                  if (entities == (char **) NULL)
                    {
                      predefined_entitites=(char **)
                        RelinquishMagickMemory(predefined_entitites);
                      ThrowFatalException(ResourceLimitError,
                        "MemoryAllocationFailed");
                    }
                  predefined_entitites=entities;
                  index=(ssize_t) predefined_entitites/sizeof(*entities)-2;
                  predefined_entitites[index]=c;
                  predefined_entitites[index+1]=v;
                  predefined_entitites[index+2]=0;
                  (void) InsertTagIntoXMLTree(root,c,v,exception);
                  keyword=DestroyString(keyword);
                  continue;
                }
              if (LocaleCompare(keyword,"ATTLIST") == 0)
                {
                  char
                    **attribute,
                    *value;

                  while (isspace((int) ((unsigned char) *xml)) != 0)
                    xml++;
                  t=xml;
                  while (isalnum((int) ((unsigned char) *xml)) != 0)
                    xml++;
                  c=AcquireString(t);
                  c[xml-t]='\0';
                  while (isspace((int) ((unsigned char) *xml)) != 0)
                    xml++;
                  t=xml;
                  while (isalnum((int) ((unsigned char) *xml)) != 0)
                    xml++;
                  v=AcquireString(t);
                  v[xml-t]='\0';
                  while (isspace((int) ((unsigned char) *xml)) != 0)
                    xml++;
                  if (*xml == '#')
                    {
                      while (isspace((int) ((unsigned char) *xml)) != 0)
                        xml++;
                      while (isalnum((int) ((unsigned char) *xml)) != 0)
                        xml++;
                      while (isspace((int) ((unsigned char) *xml)) != 0)
                        xml++;
                    }
                  q=(*xml == '"' ? '"' : '\'');
                  for (xml++; *xml != q; xml++);
                  value=AcquireString(xml);
                  value[1]='\0';
                  xml++;
                  attribute=NewMagickMemory(char **,5);
                  if (attribute == (char **) NULL)
                    {
                      predefined_entitites=(char **)
                        RelinquishMagickMemory(predefined_entitites);
                      ThrowFatalException(ResourceLimitError,
                        "MemoryAllocationFailed");
                    }
                  attribute[0]=ConstantString(c);
                  attribute[1]=ConstantString(v);
                  attribute[2]=value;
                  attribute[3]=(char *) NULL;
                  attribute[4]=(char *) NULL;
                  ParseOpenTag(root,c,attribute);
                  keyword=DestroyString(keyword);
                  continue;
                }
              keyword=DestroyString(keyword);
              if (*xml == '\0')
                break;
            }
            xml++;
          }
        while (isspace((int) ((unsigned char) *xml)) != 0)
          xml++;
        if (*xml != '>')
          break;
        xml++;
        root->node->tag=n;
        break;
      }
    if (strncmp(xml,"<!--",4) == 0) // Comment
      {
        for (xml+=4; strncmp(xml,"-->",3) != 0; xml++);
        if (*xml != '\0')
          xml+=3;
        continue;
      }
    if (strncmp(xml,"<?",2) == 0) // Processing instruction
      {
        for (xml+=2; strncmp(xml,"?>",2) != 0; xml++);
        if (*xml != '\0')
          xml+=2;
        continue;
      }
    break;