c=xml;
    while (*c != '\0')
    {
      if (*c == '<')
        {
          c++;
          if (*c == '!')
            {
              c++;
              if ((strncmp(c,"--",2) == 0) ||
                  (strncmp(c,"DOCTYPE",7) == 0))
                {
                  /*
                    Comment or DOCTYPE declaration.
                  */
                  t=c;
                  while (*c != '\0')
                  {
                    if ((strncmp(c,"-->",3) == 0) ||
                        (*c == '>'))
                      break;
                    c++;
                  }
                  if (*c != '\0')
                    c+=(*c == '>' ? 1 : 3);
                  xml=c;
                  continue;
                }
              else
                if (strncmp(c,"[CDATA[",7) == 0)
                  {
                    /*
                      CDATA section.
                    */
                    t=c;
                    while (*c != '\0')
                    {
                      if (strncmp(c,"]]>",3) == 0)
                        break;
                      c++;
                    }
                    if (*c != '\0')
                      {
                        *c='\0';
                        ParseCharacterContent(root,t+7,
                          strlen(t+7),CharacterData);
                        c+=3;
                      }
                    xml=c;
                    continue;
                  }
            }
          else
            if (*c == '?')
              {
                /*
                  Processing instruction.
                */
                t=c;
                while (*c != '\0')
                {
                  if (*c == '?')
                    {
                      c++;
                      if (*c == '>')
                        break;
                    }
                  c++;
                }
                if (*c != '\0')
                  c++;
                xml=c;
                continue;
              }
            else
              if (isalpha((int) *c) != 0)
                {
                  /*
                    Open tag.
                  */
                  t=c;
                  while (isalnum((int) *c) != 0)
                    c++;
                  q=*c;
                  *c='\0';
                  index=ParseTag(root,t,exception);
                  *c=q;
                  if (index == -1)
                    break;
                  if (q == '>')
                    {
                      xml=c+1;
                      continue;
                    }
                  if (q == '/')
                    {
                      xml=c+2;
                      continue;
                    }
                  entities=ParseAttributes(c,&n,exception);
                  if (entities == (char **) NULL)
                    break;
                  ParseOpenTag(root,t,entities);
                  entities=(char **) RelinquishMagickMemory(entities);
                  if (n != (char *) NULL)
                    {
                      xml=n+1;
                      n=(char *) NULL;
                    }
                  continue;
                }
              else
                if (*c == '/')
                  {
                    /*
                      Close tag.
                    */
                    c++;
                    t=c;
                    while (isalnum((int) *c) != 0)
                      c++;
                    q=*c;
                    *c='\0';
                    if (ParseCloseTag(root,t,exception) == MagickFalse)
                      break;
                    *c=q;
                    if (q == '>')
                      {
                        xml=c+1;
                        continue;
                      }
                  }
        }
      else
        c++;
    }