// <MASK>
  while (xml != (char *) NULL)
  {
    // Find the next DOCTYPE declaration
    c = strchr(xml, '<');
    if (c == NULL || c[1] != '!')
      break;
    c += 2;
    if (strncmp(c, "DOCTYPE", 7) != 0)
      break;
    c += 7;
    while (isspace((int)*c))
      c++;

    // Parse the DOCTYPE declaration
    if (*c != '[')
    {
      // External DOCTYPE declaration
      n = strchr(c, '>');
      if (n == NULL)
        ThrowMagickException(exception, GetMagickModule(), CorruptImageError,
          "InvalidDocumentStructure", "'%s'", xml);
      *n = '\0';
      ParseExternalDoctype(root, c, n - c, exception);
      xml = n + 1;
    }
    else
    {
      // Internal DOCTYPE declaration
      n = strchr(c, ']');
      if (n == NULL)
        ThrowMagickException(exception, GetMagickModule(), CorruptImageError,
          "InvalidDocumentStructure", "'%s'", xml);
      *n = '\0';
      ParseInternalDoctype(root, c + 1, n - (c + 1), exception);
      xml = n + 1;
    }
  }
  // </MASK>