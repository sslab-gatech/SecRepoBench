c = xml;
    while (*c != '\0')
    {
      // Skip leading whitespace
      while (isspace((unsigned char) *c))
        c++;

      // Check for ENTITY declaration
      if (strncmp(c, "<!ENTITY", 8) == 0)
      {
        c += 8; // Move past "<!ENTITY"
        while (isspace((unsigned char) *c))
          c++;

        // Parse entity name
        t = c;
        while (!isspace((unsigned char) *c) && *c != '\0' && *c != '>')
          c++;
        if (*c == '\0')
          break;

        *c = '\0'; // Null-terminate the entity name
        c++;

        // Parse entity value
        while (isspace((unsigned char) *c))
          c++;
        if (*c == '"' || *c == '\'')
        {
          q = *c; // Quote character
          c++;
          v = c;
          while (*c != q && *c != '\0')
            c++;
          if (*c == '\0')
            break;

          *c = '\0'; // Null-terminate the entity value
          c++;

          // Store the entity in predefined_entities
          index = 0;
          while (predefined_entitites[index] != (char *) NULL)
            index++;
          predefined_entitites = (char **) ResizeQuantumMemory(predefined_entitites, index + 2, sizeof(*predefined_entitites));
          if (predefined_entitites == (char **) NULL)
            ThrowFatalException(ResourceLimitError, "MemoryAllocationFailed");
          predefined_entitites[index] = ConstantString(t);
          predefined_entitites[index + 1] = ConstantString(v);
          predefined_entitites[index + 2] = (char *) NULL;
        }
      }

      // Move to the next part of the XML
      while (*c != '>' && *c != '\0')
        c++;
      if (*c == '>')
        c++;
    }