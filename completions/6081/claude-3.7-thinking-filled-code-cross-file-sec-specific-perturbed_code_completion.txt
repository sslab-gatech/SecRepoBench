xml++;
for (c=xml; (*c != '\0') && (strncmp(c, "]>", 2) != 0); c++)
{
  if (strncmp(c, "<!--", 4) == 0)
    {
      for (c+=4; (*c != '\0') && (strncmp(c, "-->", 3) != 0); c++);
      if (*c == '\0')
        break;
      c+=2;
      continue;
    }
  if (strncmp(c, "<!ENTITY", 8) == 0)
    {
      c+=8;
      while (isspace((int) ((unsigned char) *c)))
        c++;
      if (*c == '%')
        {
          c++;
          while (isspace((int) ((unsigned char) *c)))
            c++;
        }
      n=c;
      while ((*c != '\0') && !isspace((int) ((unsigned char) *c)) && 
             (*c != '>'))
        c++;
      if (*c == '\0')
        break;
      if (*c != '>')
        {
          *c='\0';
          c++;
          while (isspace((int) ((unsigned char) *c)))
            c++;
          q=*c;
          if ((q == '"') || (q == '\''))
            {
              c++;
              t=c;
              while ((*c != '\0') && (*c != q))
                c++;
              if (*c != '\0')
                {
                  *c='\0';
                  for (index=0; predefined_entitites[index] != (char *) NULL; index++);
                  entities=(char **) ResizeQuantumMemory(predefined_entitites,
                    (size_t) (index+3), sizeof(*entities));
                  if (entities == (char **) NULL)
                    break;
                  predefined_entitites=entities;
                  predefined_entitites[index]=ConstantString(n);
                  predefined_entitites[index+1]=ConstantString(t);
                  predefined_entitites[index+2]=(char *) NULL;
                }
            }
        }
    }
  if (*c == '\0')
    break;
}
xml=c;
if (*xml != '\0')
  xml+=2;