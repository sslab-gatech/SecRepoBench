for (c=xml; *c != '\0'; c++)
  {
    if (*c == '<')
    {
      if (strncmp(c, "<!DOCTYPE", 9) == 0)
      {
        // Parse DOCTYPE declaration
        ParseDoctypeDeclaration(root, c, exception);
      }
      else if (strncmp(c, "<![CDATA[", 8) == 0)
      {
        // Parse CDATA section
        ParseCdataSection(root, c, exception);
      }
      else if (strncmp(c, "<!--", 4) == 0)
      {
        // Parse comment
        ParseComment(root, c, exception);
      }
      else if (*(c+1) == '/')
      {
        // Parse closing tag
        ParseClosingTag(root, c, exception);
      }
      else
      {
        // Parse opening tag
        ParseOpenTag(root, c, exception);
      }
    }
    else if (*c == '&')
    {
      // Parse entity reference
      ParseEntityReference(root, c, exception);
    }
  }