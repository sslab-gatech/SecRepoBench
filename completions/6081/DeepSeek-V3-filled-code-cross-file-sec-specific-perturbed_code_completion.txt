c=xml;
    while ((*c != '\0') && (*c != '>'))
    {
      if (*c == '<')
        {
          c++;
          if (*c == '!')
            {
              c++;
              if ((*c == '-') && (*(c+1) == '-'))
                {
                  c+=2;
                  while ((*c != '\0') && !((*c == '-') && (*(c+1) == '-')))
                    c++;
                  if (*c != '\0')
                    c+=2;
                }
              else
                if ((*c == '[') && (strncmp(c,"[CDATA[",7) == 0))
                  {
                    c+=7;
                    while ((*c != '\0') && !((*c == ']') && (*(c+1) == ']')))
                      c++;
                    if (*c != '\0')
                      c+=2;
                  }
                else
                  if ((*c == 'D') && (strncmp(c,"DOCTYPE",7) == 0))
                    {
                      c+=7;
                      while ((*c != '\0') && (*c != '>'))
                        {
                          if (*c == '\'')
                            q='\'';
                          else
                            if (*c == '\"')
                              q='\"';
                            else
                              {
                                c++;
                                continue;
                              }
                          c++;
                          t=c;
                          while ((*c != '\0') && (*c != q))
                            c++;
                          if (*c == '\0')
                            break;
                          v=AcquireString(t);
                          v[c-t]='\0';
                          if ((strncmp(t,"SYSTEM",6) == 0) ||
                              (strncmp(t,"PUBLIC",6) == 0))
                            {
                              c++;
                              while (isspace((int) ((unsigned char) *c)) != 0)
                                c++;
                              if (*c == q)
                                {
                                  c++;
                                  continue;
                                }
                              t=c;
                              while ((*c != '\0') && (*c != q))
                                c++;
                              if (*c == '\0')
                                break;
                              v=DestroyString(v);
                              v=AcquireString(t);
                              v[c-t]='\0';
                            }
                          if (strncmp(t,"ENTITY",6) == 0)
                            {
                              char
                                *name;

                              name=v+7;
                              for (i=0; predefined_entitites[i] != (char *) NULL; i+=2)
                                if (strcmp(name,predefined_entitites[i]) == 0)
                                  {
                                    v=DestroyString(v);
                                    break;
                                  }
                              if (predefined_entitites[i] == (char *) NULL)
                                {
                                  entities=(char **) ResizeQuantumMemory(
                                    (char **) predefined_entitites,(i+3)*sizeof(*entities),
                                    sizeof(*entities));
                                  if (entities != (char **) NULL)
                                    {
                                      predefined_entitites=entities;
                                      predefined_entitites[i]=ConstantString(name);
                                      predefined_entitites[i+1]=ConstantString(v+7+
                                        strlen(name)+1);
                                      predefined_entitites[i+2]=(char *) NULL;
                                    }
                                }
                            }
                          v=DestroyString(v);
                          c++;
                        }
                    }
            }
        }
      c++;
    }
    if (*c == '>')
      {
        xml=c+1;
        break;
      }
    xml=(char *) NULL;