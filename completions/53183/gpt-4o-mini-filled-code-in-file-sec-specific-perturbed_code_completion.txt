char *endptr;
  long value = strtol(p, &endptr, 10);

  if (endptr == p || value < 0) {
    mrb_raise(mrb, E_ARGUMENT_ERROR, "invalid number");
  }

  *value_pointer = (int)value;
  return endptr;