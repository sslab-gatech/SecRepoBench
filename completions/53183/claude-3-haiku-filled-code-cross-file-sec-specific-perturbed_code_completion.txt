int i;
int sign = 1;
int64_t value = 0;

if (*p == '-') {
  sign = -1;
  p++;
}

for (i = 0; p < end && isdigit(*p); i++, p++) {
  if (value > (INT64_MAX - (*p - '0')) / 10) {
    return NULL; // Overflow detected
  }
  value = value * 10 + (*p - '0');
}

if (i == 0) {
  return NULL; // No digits found
}

*value_pointer = (int)(value * sign);
return p;