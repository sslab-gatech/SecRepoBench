const char *s = p;
long result = 0;
int sign = 1;

if (s < end && (*s == '+' || *s == '-')) {
  if (*s == '-') sign = -1;
  s++;
}

if (s == end || *s < '0' || *s > '9') {
  return NULL;  // no digits found
}

long limit = (sign == 1) ? INT_MAX : -(long)INT_MIN;
while (s < end && *s >= '0' && *s <= '9') {
  int digit = *s - '0';
  if (result > (limit - digit) / 10) {
    return NULL;  // overflow detected
  }
  result = result * 10 + digit;
  s++;
}

result *= sign;
if (result > INT_MAX || result < INT_MIN) {
  return NULL;  // final result out of int bounds
}
*value_pointer = (int)result;
const char *e = s;