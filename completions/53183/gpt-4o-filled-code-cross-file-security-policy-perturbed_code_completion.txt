const char *e = p;
  int value = 0;
  int sign = 1;

  // Skip leading whitespace
  while (e < end && isspace((unsigned char)*e)) {
    e++;
  }

  // Check for sign
  if (e < end && (*e == '-' || *e == '+')) {
    if (*e == '-') {
      sign = -1;
    }
    e++;
  }

  // Parse digits
  while (e < end && isdigit((unsigned char)*e)) {
    int digit = *e - '0';

    // Check for overflow
    if (value > (INT_MAX - digit) / 10) {
      return NULL; // Overflow occurred
    }

    value = value * 10 + digit;
    e++;
  }

  // If no digits were found, return NULL
  if (e == p || (e == p + 1 && sign != 1)) {
    return NULL;
  }

  *value_pointer = value * sign;
  return e;