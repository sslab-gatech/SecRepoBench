const char *e = p;
  int sign = 1;
  int value = 0;

  // Skip whitespace
  while (e < end && isspace((unsigned char)*e)) {
    e++;
  }

  // Check for sign
  if (e < end && (*e == '-' || *e == '+')) {
    sign = (*e == '-') ? -1 : 1;
    e++;
  }

  // Parse digits
  while (e < end && isdigit((unsigned char)*e)) {
    value = value * 10 + (*e - '0');
    e++;
  }

  // Store the result
  if (value_pointer) {
    *value_pointer = value * sign;
  }

  // Return NULL if no digits were found
  return (e == p) ? NULL : e;