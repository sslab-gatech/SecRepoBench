{
  const char *start = p;
  const char *e = NULL;
  long long result = 0;
  int sign = 1;
  int digits_found = 0;

  /* Skip leading whitespace */
  while (p < end && isspace((unsigned char)*p)) {
    p++;
  }
  if (p == end) return NULL;

  /* Check sign */
  if (*p == '+' || *p == '-') {
    if (*p == '-') {
      sign = -1;
    }
    p++;
    if (p == end) return NULL;
  }

  /* Parse digits */
  while (p < end && isdigit((unsigned char)*p)) {
    int digit = *p - '0';
    if (result > (LLONG_MAX - digit) / 10) {
      /* Overflow */
      return NULL;
    }
    result = result * 10 + digit;
    p++;
    digits_found = 1;
  }

  if (!digits_found) {
    /* No digits parsed */
    return NULL;
  }

  result *= sign;

  /* Check if result fits into int range */
  if (result < INT_MIN || result > INT_MAX) {
    return NULL;
  }
  *value_pointer = (int)result;
  e = p;
}