const char *e = p;
bool negative = false;

/* Check optional sign */
if (e < end && (*e == '-' || *e == '+')) {
  negative = (*e == '-');
  e++;
}

/* At least one digit is required */
if (e >= end || !isdigit((unsigned char)*e)) {
  return NULL;
}

/* Parse digits */
int value = 0;
for (; e < end && isdigit((unsigned char)*e); e++) {
  int digit = *e - '0';
  /* Check for potential overflow */
  if (value > (INT_MAX - digit) / 10) {
    return NULL;
  }
  value = value * 10 + digit;
}

/* Apply sign */
if (negative) {
  value = -value;
}

*value_pointer = value;