const char *s = p;
int v = 0;
int sign = 1;

/* Check for NULL pointers and invalid range */
if (!p || !end || p >= end || !value_pointer)
  return NULL;

/* Skip leading whitespace */
while (s < end && ISSPACE(*s)) s++;
if (s >= end) return NULL;  /* Only whitespace or empty string */

/* Handle sign if present */
if (*s == '-') {
  sign = -1;
  s++;
} else if (*s == '+') {
  s++;
}
if (s >= end) return NULL;  /* Only sign, no digits */

/* There must be at least one digit */
if (*s < '0' || *s > '9') return NULL;

/* Parse digits */
const char *e = s;
while (e < end && *e >= '0' && *e <= '9') {
  int digit = *e - '0';
  
  /* Check for overflow */
  if (v > (INT_MAX - digit) / 10) {
    /* Overflow would occur */
    *value_pointer = sign > 0 ? INT_MAX : INT_MIN;
    
    /* Consume remaining digits */
    while (e < end && *e >= '0' && *e <= '9') e++;
    return e;
  }
  
  v = v * 10 + digit;
  e++;
}

*value_pointer = v * sign;