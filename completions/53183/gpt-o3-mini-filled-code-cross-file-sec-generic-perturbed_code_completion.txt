const char *e = p;
int sign = 1;
long result = 0;

if (e >= end) return NULL;
if (*e == '+' || *e == '-') {
  if (*e == '-') sign = -1;
  e++;
}
if (e >= end || !isdigit((unsigned char)*e)) return NULL;

while (e < end && isdigit((unsigned char)*e)) {
  int digit = *e - '0';
  if (sign == 1) {
    if (result > (INT_MAX - digit) / 10) return NULL;  /* overflow */
  }
  else {
    if (-result < (INT_MIN + digit) / 10) return NULL;  /* underflow */
  }
  result = result * 10 + digit;
  e++;
}

*value_pointer = sign * (int)result;