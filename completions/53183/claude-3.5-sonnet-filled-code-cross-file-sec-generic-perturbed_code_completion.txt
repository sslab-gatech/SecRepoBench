const char *e = p;
long num = 0;
int sign = 1;

if (e >= end) {
    return NULL;
}

if (*e == '-') {
    sign = -1;
    e++;
}

while (e < end && ISDIGIT(*e)) {
    if (num > (LONG_MAX - (*e - '0')) / 10) {
        return NULL;  // Overflow
    }
    num = num * 10 + (*e - '0');
    e++;
}

if (e == p || (sign == -1 && e == p + 1)) {
    return NULL;  // No digits found
}

*value_pointer = (int)(num * sign);

if (*value_pointer != num * sign) {
    return NULL;  // Integer overflow
}