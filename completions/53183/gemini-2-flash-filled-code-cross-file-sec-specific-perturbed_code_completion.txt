const char *e = p;
  int val = 0;

  if (p == end) return NULL;
  if (*p == '-') {
    e++;
    if (e == end) return NULL;
    if (!isdigit((unsigned char)*e)) return NULL;
    for (; e < end; e++) {
      if (isdigit((unsigned char)*e)) {
        int digit = *e - '0';
        if (val < (INT_MIN + digit) / 10) {
          return NULL;
        }
        val = val * 10 - digit;
      } else {
        break;
      }
    }
  } else if (isdigit((unsigned char)*p)) {
    for (; e < end; e++) {
      if (isdigit((unsigned char)*e)) {
        int digit = *e - '0';
        if (val > (INT_MAX - digit) / 10) {
          return NULL;
        }
        val = val * 10 + digit;
      } else {
        break;
      }
    }
  } else {
    return NULL;
  }

  *value_pointer = val;