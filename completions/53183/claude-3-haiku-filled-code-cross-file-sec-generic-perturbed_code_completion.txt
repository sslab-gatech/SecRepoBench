int i, n = 0;
const char *e = p;

while (e < end && isdigit((unsigned char)*e)) {
  n = n * 10 + (*e - '0');
  e++;
}

if (e == p) {
  return NULL;
}

*value_pointer = n;
return e;