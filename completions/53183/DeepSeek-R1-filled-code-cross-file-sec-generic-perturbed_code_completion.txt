const char *e = p;
int sign = 1;
int value = 0;

if (p == NULL || end < p) return NULL;
if (e == end) return NULL;

if (*e == '-') {
    sign = -1;
    e++;
} else if (*e == '+') {
    e++;
}

if (e == end || !isdigit((unsigned char)*e)) return NULL;

while (e < end && isdigit((unsigned char)*e)) {
    int digit = *e - '0';
    if (sign == 1) {
        if (value > INT_MAX / 10) return NULL;
        value *= 10;
        if (value > INT_MAX - digit) return NULL;
        value += digit;
    } else {
        if (value < INT_MIN / 10) return NULL;
        value *= 10;
        if (value < INT_MIN + digit) return NULL;
        value -= digit;
    }
    e++;
}

*value_pointer = value;
return e;