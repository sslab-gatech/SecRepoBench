const char *e = p;
  int n = 0;
  int sign = 1;

  // Check for valid input
  if (p == NULL || end == NULL || p >= end || value_pointer == NULL) {
    return NULL;
  }

  // Handle sign if present
  if (*e == '-') {
    sign = -1;
    e++;
    if (e >= end) return NULL; // Just a minus sign, no digits
  }
  else if (*e == '+') {
    e++;
    if (e >= end) return NULL; // Just a plus sign, no digits
  }

  // Check if there's at least one digit
  if (e >= end || !(*e >= '0' && *e <= '9')) {
    return NULL;
  }

  // Parse digits
  while (e < end && (*e >= '0' && *e <= '9')) {
    int digit = *e - '0';
    
    // Check for overflow
    if (n > INT_MAX / 10 || (n == INT_MAX / 10 && digit > INT_MAX % 10)) {
      // Special case for INT_MIN
      if (sign < 0 && n == INT_MAX / 10 && digit == INT_MAX % 10 + 1) {
        *value_pointer = INT_MIN;
        return e + 1;  // Skip the current digi