const char *e = p;
long n = 0;
int sign = 1;

// Skip whitespace
while (e < end && (*e == ' ' || *e == '\t' || *e == '\n' || *e == '\r')) e++;

// Check for sign
if (e < end) {
  if (*e == '-') {
    sign = -1;
    e++;
  }
  else if (*e == '+') {
    e++;
  }
}

// Check if we have at least one digit
if (e < end && *e >= '0' && *e <= '9') {
  n = *e++ - '0';
  // Parse remaining digits
  while (e < end && *e >= '0' && *e <= '9') {
    // Check for overflow
    if (n > (LONG_MAX - (*e - '0')) / 10) {
      return NULL;  // Overflow
    }
    n = n * 10 + (*e - '0');
    e++;
  }
  
  // Apply sign and check for overflow
  if (sign < 0) {
    if (n > (long)INT_MAX + 1) {
      return NULL;  // Overflow
    }
    *value_pointer = (int)(-n);
  } else {
    if (n > INT_MAX) {
      return NULL;  // Overflow
    }
    *value_pointer = (int)n;
  }
  
  return e;
}

// No digits found
return NULL;