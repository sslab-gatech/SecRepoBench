int value = 0;
const char *e = NULL;
while (p < end && *p >= '0' && *p <= '9') {
  value = value * 10 + (*p - '0');
  p++;
}
if (p >= end || *p!= '$') {
  e = p;
}
else {
  e = p + 1;
}
if (value > INT_MAX) {
  mrb_raise(mrb, E_ARGUMENT_ERROR, "value too big");
}
*value_pointer = value;
return e;