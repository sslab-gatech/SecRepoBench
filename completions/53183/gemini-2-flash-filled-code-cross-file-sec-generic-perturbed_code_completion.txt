const char *e = p;
  int val = 0;

  if (p == end) return NULL;
  if (*p == '-') {
    e++;
    if (e == end || !isdigit(*e)) return NULL;
    for (; e < end; e++) {
      if (isdigit(*e)) {
        int digit = *e - '0';
        if (val < (INT_MIN + digit) / 10) return NULL;  // check for underflow
        val = val * 10 - digit;
      } else {
        break;
      }
    }
  } else if (isdigit(*p)) {
    for (; e < end; e++) {
      if (isdigit(*e)) {
        int digit = *e - '0';
        if (val > (INT_MAX - digit) / 10) return NULL;  // check for overflow
        val = val * 10 + digit;
      } else {
        break;
      }
    }
  } else {
    return NULL;
  }

  if (value_pointer) *value_pointer = val;