const char *e = p;
  int value = 0;

  while (e < end && isdigit((unsigned char)*e)) {
    int digit = *e - '0';
    if (value > (INT_MAX - digit) / 10) {
      mrb_raise(mrb, E_ARGUMENT_ERROR, "number too big");
      return NULL;
    }
    value = value * 10 + digit;
    e++;
  }

  if (e == p) {
    return NULL; // No digits found
  }

  *value_pointer = value;