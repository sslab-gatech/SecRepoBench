const char *s = p;
  int sign = 1;
  long long result = 0;

  /* Optional: skip leading whitespace characters if needed 
  while (s < end && isspace((unsigned char)*s)) {
    s++;
  }
  */

  /* Check for sign */
  if (s < end && (*s == '-' || *s == '+')) {
    if (*s == '-') {
      sign = -1;
    }
    s++;
  }

  /* Must have at least one digit */
  if (s >= end || *s < '0' || *s > '9') {
    return NULL;
  }

  /* Parse digits while validating for overflow */
  while (s < end && *s >= '0' && *s <= '9') {
    int digit = (*s - '0');
    if ((sign > 0 && result > (LLONG_MAX - digit) / 10) ||
        (sign < 0 && -result < (LLONG_MIN + digit) / 10)) {
      /* Overflow or underflow would occur */
      return NULL;
    }
    result = result * 10 + digit;
    s++;
  }

  /* Apply sign and check int range */
  result *= sign;
  if (result > INT_MAX || result < INT_MIN) {
    /* Out of the range of int */
    return NULL;
  }

  if (value_pointer) {
    *value_pointer = (int)result;
  }
  return s;