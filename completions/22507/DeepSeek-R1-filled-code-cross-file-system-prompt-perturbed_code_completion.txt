mrb_value val = GETARG();
#ifndef MRB_WITHOUT_FLOAT
        mrb_float fval = mrb_to_flo(mrb, val);
        if (!mrb_float_finite_p(fval)) {
            const char *str;
            int sign = 0;
            if (isnan(fval)) {
                str = "NaN";
                sign = 0;
            }
            else {
                str = "Inf";
                sign = mrb_float_signbit(fval) ? -1 : 1;
            }

            int has_sign = 0;
            char sign_char = 0;
            if (sign == -1) {
                sign_char = '-';
                has_sign = 1;
            }
            else if (flags & FPLUS) {
                sign_char = '+';
                has_sign = 1;
                if (width > 0) width--;
            }
            else if (flags & FSPACE) {
                sign_char = ' ';
                has_sign = 1;
                if (width > 0) width--;
            }

            int len = strlen(str) + has_sign;
            int padding = width > len ? width - len : 0;

            if (!(flags & FMINUS) && padding > 0) {
                FILL(' ', padding);
            }

            if (has_sign) {
                PUSH(&sign_char, 1);
            }

            PUSH(str, strlen(str));

            if ((flags & FMINUS) && padding > 0) {
                FILL(' ', padding);
            }

            break;
        }
#endif