mrb_value val = GETARG();
#ifndef MRB_WITHOUT_FLOAT
        double fval = mrb_float(val);
        if (isnan(fval)) {
            const char *s = "NaN";
            mrb_int slen = 3;
            if (flags & FWIDTH) {
                mrb_int pad = width - slen;
                if (pad > 0) {
                    if (!(flags & FMINUS)) {
                        FILL(' ', pad);
                    }
                    PUSH(s, slen);
                    if (flags & FMINUS) {
                        FILL(' ', pad);
                    }
                }
                else {
                    PUSH(s, slen);
                }
            }
            else {
                PUSH(s, slen);
            }
            break;
        }
        else if (isinf(fval)) {
            int negative = signbit(fval);
            const char *s;
            mrb_int slen;

            if (negative) {
                s = "-Inf";
                slen = 4;
            }
            else {
                if (flags & FPLUS) {
                    s = "+Inf";
                    slen = 4;
                }
                else if (flags & FSPACE) {
                    s = " Inf";
                    slen = 4;
                }
                else {
                    s = "Inf";
                    slen = 3;
                }
            }

            if (flags & FWIDTH) {
                mrb_int pad = width - slen;
                if (pad > 0) {
                    if (!(flags & FMINUS)) {
                        FILL(' ', pad);
                    }
                    PUSH(s, slen);
                    if (flags & FMINUS) {
                        FILL(' ', pad);
                    }
                }
                else {
                    PUSH(s, slen);
                }
            }
            else {
                PUSH(s, slen);
            }
            break;
        }