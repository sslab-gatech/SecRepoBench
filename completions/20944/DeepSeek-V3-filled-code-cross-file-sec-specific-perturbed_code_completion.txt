// Sanity checks
      if (unlikely (!loca_table || !glyf_table))
        return;

      // Initialize face
      face = faceptr;

      // Calculate num_glyphs based on loca_table length and offset format
      unsigned int loca_length = loca_table.get_length ();
      if (short_offset)
        num_glyphs = loca_length / 2 - 1;
      else
        num_glyphs = loca_length / 4 - 1;

      // Additional sanity check
      if (unlikely (num_glyphs > 0xFFFF))
        return;