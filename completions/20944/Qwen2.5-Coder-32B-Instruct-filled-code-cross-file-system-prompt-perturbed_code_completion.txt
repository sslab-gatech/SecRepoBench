// Assuming hb_face_get_table() retrieves the specified table
      const OT::HEAD &head = *hb_face_get_table<OT::HEAD>(faceptr);
      if (head.indexToLocFormat != 0 && head.indexToLocFormat != 1) {
          // Unknown format, exit without further processing
          return;
      }

      short_offset = (head.indexToLocFormat == 0) ? 2 : 4;

      hb_sanitize_context_t c;
      loca_table = *hb_face_reference_table<OT::LOCA>(faceptr, &c);
      glyf_table = *hb_face_reference_table<OT::GLYF>(faceptr, &c);

      num_glyphs = (loca_table.length - short_offset) / short_offset;