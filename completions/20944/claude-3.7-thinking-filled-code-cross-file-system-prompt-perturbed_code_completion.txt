face = faceptr;

hb_blob_t *head_blob = hb_face_reference_table (face, HB_TAG ('h','e','a','d'));
const head *head_table = (const head *) hb_blob_get_data (head_blob, nullptr);
if (head_table->indexToLocFormat > 1 || head_table->glyphDataFormat > 0)
{
  hb_blob_destroy (head_blob);
  return;
}

short_offset = 0 == head_table->indexToLocFormat;
hb_blob_destroy (head_blob);

loca_table = hb_sanitize_context_t().reference_table<loca> (face);
glyf_table = hb_sanitize_context_t().reference_table<glyf> (face);

num_glyphs = loca_table->get_num_glyphs (short_offset);