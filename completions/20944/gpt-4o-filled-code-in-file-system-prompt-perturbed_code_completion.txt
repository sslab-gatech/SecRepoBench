face = faceptr;

      hb_blob_t *head_blob = hb_sanitize_context_t().reference_table<head>(face);
      const head *head_table = head_blob->as<head>();
      if (unlikely (!head_table)) return;

      short_offset = head_table->indexToLocFormat == 0;

      loca_table = hb_sanitize_context_t().reference_table<loca>(face);
      glyf_table = hb_sanitize_context_t().reference_table<glyf>(face);

      num_glyphs = short_offset
                 ? loca_table->length / 2 - 1
                 : loca_table->length / 4 - 1;

      hb_blob_destroy(head_blob);