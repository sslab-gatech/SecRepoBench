// Assign the input face to the face member variable.
      this->face = faceptr;

      // Retrieve the 'head' table from the face and check format values.
      hb_blob_t *head_blob = hb_face_reference_table(faceptr, HB_TAG('h','e','a','d'));
      const head_table_t *head_table = (const head_table_t *) hb_blob_get_data(head_blob, nullptr);
      if (!head_table || head_table->magicNumber != 0x5F0F3CF5) {
        hb_blob_destroy(head_blob);
        return; // Exit if the head table is invalid or has an unknown format.
      }

      // Determine the short_offset based on the indexToLocFormat from the 'head' table.
      this->short_offset = head_table->indexToLocFormat == 0;

      // Reference the 'loca' and 'glyf' tables from the face using a sanitize context.
      hb_blob_t *loca_blob = hb_face_reference_table(faceptr, HB_TAG('l','o','c','a'));
      hb_blob_t *glyf_blob = hb_face_reference_table(faceptr, HB_TAG('g','l','y','f'));

      // Calculate num_glyphs using the length of the loca_table, adjusting for offset format.
      unsigned int loca_length = hb_blob_get_length(loca_blob);
      this->num_glyphs = this->short_offset ? (loca_length / 2) : (loca_length / 4);

      // Store the loca and glyf tables.
      this->loca_table = loca_blob;
      this->glyf_table = glyf_blob;

      // Clean up the head table blob.
      hb_blob_destroy(head_blob);