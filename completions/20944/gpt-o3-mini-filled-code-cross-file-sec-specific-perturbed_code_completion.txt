/* Sanity-check the loca table size to avoid heap overflows */
  size_t loca_len = hb_blob_get_length (this->loca_table);
  size_t entry_size = this->short_offset ? 2 : 4;
  /* Ensure multiplication is safe: (num_glyphs + 1) * entry_size cannot overflow */
  if (this->num_glyphs > (SIZE_MAX - entry_size) / entry_size)
    return;
  if (loca_len < (this->num_glyphs + 1) * entry_size)
    return;

  const uint8_t *loca_data = hb_blob_get_data (this->loca_table, NULL);
  uintptr_t last_offset = 0;
  if (this->short_offset)
  {
    /* Offsets are stored as 16‐bit values, multiplied by 2 */
    const uint16_t *loca16 = (const uint16_t *) loca_data;
    last_offset = (uintptr_t) hb_be16toh (loca16[this->num_glyphs]) * 2;
  }
  else
  {
    /* Offsets are stored as 32‐bit values */
    const uint32_t *loca32 = (const uint32_t *) loca_data;
    last_offset = (uintptr_t) hb_be32toh (loca32[this->num_glyphs]);
  }

  /* Verify that the glyf table is large enough */
  size_t glyf_len = hb_blob_get_length (this->glyf_table);
  if (last_offset > glyf_len)
    return;