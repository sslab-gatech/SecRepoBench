// Ensure the loca_table and glyf_table are properly initialized and valid.
      if (!loca_table || !glyf_table) {
        // If either table is missing, clean up and exit.
        faceptr->fini();
        return;
      }

      // Validate the loca_table length to prevent potential heap overflow.
      if (loca_table.length % (short_offset ? 2 : 4) != 0) {
        // If the loca_table length is invalid, clean up and exit.
        faceptr->fini();
        return;
      }

      // Calculate the number of glyphs based on the loca_table length.
      num_glyphs = loca_table.length / (short_offset ? 2 : 4) - 1;

      // Ensure num_glyphs is within a reasonable range to prevent overflows.
      if (num_glyphs < 0 || num_glyphs > MAX_GLYPHS) {
        // If num_glyphs is out of bounds, clean up and exit.
        faceptr->fini();
        return;
      }