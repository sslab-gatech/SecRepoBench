face = faceptr;
      head = hb_face_get_table (face, HB_OT_TAG_HEAD);
      if (!head) return;
      const auto *head_data = (const hb_ot_head_table_t *) head;
      if (head_data->version != 0x00010000) return;
      short_offset = head_data->indexToLocFormat;
      loca_table = hb_face_get_table (face, HB_OT_TAG_LOCA);
      glyf_table = hb_face_get_table (face, HB_OT_TAG_GLYF);
      if (!loca_table || !glyf_table) return;
      num_glyphs = (loca_table->length / (short_offset ? 4 : 2));
    }