// <MASK>
// Retrieve the 'head' table from the face and check format values.
// If format values indicate an unknown format, exit without further processing.
// Determine the short_offset based on the indexToLocFormat from the 'head' table.
// Reference the 'loca' and 'glyf' tables from the face using a sanitize context.
// Calculate num_glyphs using the length of the loca_table, adjusting for offset format.
hb_table_t const *head_table = hb_face_get_table(faceptr, HB_TAG('h','e','a','d'));
if (!head_table)
  return;

hb_tag_t const *format = hb_table_get_field(head_table, HB_TAG('f','o','r','m'));
if (format->data[0]!= 0x4 || format->data[1]!= 0x0)
  return;

hb_tag_t const *indexToLocFormat = hb_table_get_field(head_table, HB_TAG('i','n','d','e'));
if (indexToLocFormat->data[0]!= 0x0 || indexToLocFormat->data[1]!= 0x1)
  return;

hb_table_t const *loca_table = hb_face_get_table(faceptr, HB_TAG('l','o','c','a'));
hb_table_t const *glyf_table = hb_face_get_table(faceptr, HB_TAG('g','l','y','f'));

hb_sanitize_context_t context;
if (!hb_table_is_sane(loca_table, &context) ||!hb_table_is_sane(glyf_table, &context))
  return;

short_offset = hb_table_get_offset(loca_table);
num_glyphs = hb_table_get_length(loca_table) / (indexToLocFormat->data[0] == 0x0? 2 : 4);