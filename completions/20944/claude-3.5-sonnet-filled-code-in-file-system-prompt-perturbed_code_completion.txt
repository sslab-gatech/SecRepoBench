short_offset = false;
num_glyphs = 0;
loca_table = hb_blob_create_empty ();
glyf_table = hb_blob_create_empty ();
face = faceptr;

const OT::head &head = *face->table.head;
if (head.indexToLocFormat > 1 || head.glyphDataFormat > 0)
  return;

short_offset = 0 == head.indexToLocFormat;

loca_table = hb_sanitize_context_t ().reference_table<loca> (face);
glyf_table = hb_sanitize_context_t ().reference_table<glyf> (face);

num_glyphs = loca_table.get_length () / (short_offset ? 2 : 4) - 1;