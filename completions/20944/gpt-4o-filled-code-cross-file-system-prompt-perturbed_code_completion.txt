face = faceptr;

      // Retrieve the 'head' table
      const head_table_t *head = (const head_table_t *) hb_face_reference_table(face, HB_TAG('h','e','a','d'));
      if (!head || head->magicNumber != 0x5F0F3CF5) {
        // Unknown format, exit
        return;
      }

      // Determine short_offset based on indexToLocFormat
      short_offset = head->indexToLocFormat == 0;

      // Reference the 'loca' and 'glyf' tables
      loca_table = hb_face_reference_table(face, HB_TAG('l','o','c','a'));
      glyf_table = hb_face_reference_table(face, HB_TAG('g','l','y','f'));

      // Calculate num_glyphs
      unsigned int loca_length = hb_blob_get_length(loca_table);
      num_glyphs = short_offset ? loca_length / 2 : loca_length / 4;