void init (hb_face_t *faceptr)
{
  face = faceptr;
  short_offset = false;
  num_glyphs = 0;

  hb_blob_t *head_blob = hb_sanitize_context_t ().reference_table<head> (face);
  const head *head_table = head_blob->as<head> ();
  if (unlikely (head_table->indexToLocFormat > 1))
  {
    hb_blob_destroy (head_blob);
    return;
  }
  short_offset = head_table->indexToLocFormat == 0;
  hb_blob_destroy (head_blob);

  loca_table.init ();
  loca_table.sanitize (hb_sanitize_context_t ().get_relaxed ());
  glyf_table.init ();
  glyf_table.sanitize (hb_sanitize_context_t ().get_relaxed ());

  if (short_offset)
    num_glyphs = (loca_table->dataZ.get_length () / 2) - 1;
  else
    num_glyphs = (loca_table->dataZ.get_length () / 4) - 1;
}