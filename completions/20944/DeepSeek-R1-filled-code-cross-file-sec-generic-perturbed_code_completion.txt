if (loca_table.get_length () == 0)
  num_glyphs = 0;
else
{
  unsigned entry_size = short_offset ? 2 : 4;
  if (loca_table.get_length () % entry_size != 0)
    num_glyphs = 0;
  else
    num_glyphs = (loca_table.get_length () / entry_size) - 1;
}