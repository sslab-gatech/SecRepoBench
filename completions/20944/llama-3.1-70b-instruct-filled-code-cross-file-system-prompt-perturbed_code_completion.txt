face = faceptr;
hb_blob_t *head_table = hb_face_reference_table(face, HB_OT_TAG_head);
if (hb_blob_get_length(head_table) < 54) {
  hb_blob_destroy(head_table);
  return;
}
uint32_t indexToLocFormat;
hb_blob_copy_to_unsigned_int(head_table, 50, &indexToLocFormat);
if (indexToLocFormat > 1) {
  hb_blob_destroy(head_table);
  return;
}
short_offset = indexToLocFormat == 0? 2 : 4;
hb_blob_destroy(head_table);
hb_blob_t *loca_table = hb_sanitize_context_face_reference_table(face, HB_OT_TAG_loca);
hb_blob_t *glyf_table = hb_sanitize_context_face_reference_table(face, HB_OT_TAG_glyf);
num_glyphs = hb_blob_get_length(loca_table) / short_offset;