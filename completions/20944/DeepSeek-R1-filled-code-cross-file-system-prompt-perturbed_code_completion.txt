face = faceptr;

hb_blob_t *head_blob = hb_sanitize_context_t ().reference_table<head> (face);
const head_t *head = (const head_t *) hb_blob_get_data (head_blob, nullptr);
if (head->indexToLocFormat > 1)
{
  hb_blob_destroy (head_blob);
  return;
}
short_offset = head->indexToLocFormat == 0;
hb_blob_destroy (head_blob);

loca_table = hb_sanitize_context_t ().reference_table<loca> (face);
glyf_table = hb_sanitize_context_t ().reference_table<glyf> (face);

num_glyphs = hb_blob_get_length (loca_table) / (short_offset ? 2 : 4) - 1;