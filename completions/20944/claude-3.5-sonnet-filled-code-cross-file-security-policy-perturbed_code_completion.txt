face = faceptr;

const hb_face_t::hb_table_info_t *head_info = face->table.head;
if (unlikely (!head_info || !head_info->data))
  return;

const HeadTable *head_table = reinterpret_cast<const HeadTable *> (head_info->data);
if (head_table->indexToLocFormat > 1 || head_table->glyphDataFormat != 0)
  return;

short_offset = 0 == head_table->indexToLocFormat;

hb_sanitize_context_t sanitize_context;
sanitize_context.set_num_glyphs (face->get_num_glyphs ());
loca_table.sanitize (&sanitize_context, face);
glyf_table.sanitize (&sanitize_context, face);

unsigned int loca_length = loca_table.get_length ();
num_glyphs = hb_min (face->get_num_glyphs (), short_offset ? loca_length / 2 : loca_length / 4);