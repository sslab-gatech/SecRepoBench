// Calculate num_glyphs using the length of the loca_table, adjusting for offset format.
      hb_face_t::shaper_t shaper;
      hb_face_t::shaper_t::table_type_t<hb_ot_layout_t::Loca> loca_table = shaper.table<hb_ot_layout_t::Loca>();
      hb_face_t::shaper_t::table_type_t<hb_ot_layout_t::Glyf> glyf_table = shaper.table<hb_ot_layout_t::Glyf>();

      unsigned int num_glyphs = 0;
      if (loca_table.index_to_loc_format == 0) {
        num_glyphs = loca_table.length / 2;
      } else if (loca_table.index_to_loc_format == 1) {
        num_glyphs = loca_table.length / 4;
      } else {
        // Handle unknown indexToLocFormat
        return;
      }