this->face = faceptr;

      hb_blob_t *head_table = hb_face_reference_table (face, HB_TAG ('h','e','a','d'));
      if (head_table)
      {
        const char *head_data = hb_blob_get_data (head_table, NULL);
        unsigned int majorVersion = hb_get_u16 (head_data + 0);
        unsigned int indexToLocFormat = hb_get_u16 (head_data + 36);

        hb_blob_destroy (head_table);

        if (majorVersion != 1)
          return;

        if (indexToLocFormat > 1)
          return;

        short_offset = indexToLocFormat;
      }
      else
        return;

      hb_sanitize_context_t *sanitize_context = hb_sanitize_context_create ();
      loca_table = hb_face_reference_table (face, HB_TAG ('l','o','c','a'));
      glyf_table = hb_face_reference_table (face, HB_TAG ('g','l','y','f'));
      hb_sanitize_context_destroy (sanitize_context);

      if (!loca_table)
        return;

      num_glyphs = hb_blob_get_length (loca_table) / (short_offset ? 2 : 4) - 1;