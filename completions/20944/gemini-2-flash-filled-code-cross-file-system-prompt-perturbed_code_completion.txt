this->face = faceptr;
      hb_blob_t *head_table = hb_face_reference_table (faceptr, HB_TAG ('h', 'e', 'a', 'd'));
      if (head_table)
      {
        const char *head_data = hb_blob_get_data (head_table, NULL);
        hb_uint16_t majorVersion = hb_get_u16 (head_data + 0);
        hb_uint16_t minorVersion = hb_get_u16 (head_data + 2);
        hb_uint16_t indexToLocFormat = hb_get_u16 (head_data + 50);

        hb_blob_destroy (head_table);

        if (majorVersion != 1 || minorVersion != 0)
          return;

        if (indexToLocFormat == 0)
          short_offset = true;
        else if (indexToLocFormat == 1)
          short_offset = false;
        else
          return;
      }
      else
        return;

      hb_sanitize_context_t sanitize_context (faceptr->memory_mode);
      loca_table = hb_face_reference_table (faceptr, HB_TAG ('l', 'o', 'c', 'a'));
      glyf_table = hb_face_reference_table (faceptr, HB_TAG ('g', 'l', 'y', 'f'));

      if (!loca_table || !glyf_table)
      {
        hb_blob_destroy (loca_table);
        hb_blob_destroy (glyf_table);
        loca_table = NULL;
        glyf_table = NULL;
        return;
      }

      num_glyphs = hb_blob_get_length (loca_table) / (short_offset ? 2 : 4) - 1;