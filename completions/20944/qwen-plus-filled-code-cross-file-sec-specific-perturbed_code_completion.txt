// Calculate the size of loca_table and glyf_table, ensuring they are within bounds.
      unsigned int loca_table_size = faceptr->table_tags.len;
      unsigned int glyf_table_size = faceptr->num_glyphs * sizeof(unsigned int);

      // Allocate memory for loca_table and glyf_table on the heap.
      loca_table = (unsigned int *) malloc(loca_table_size);
      if (!loca_table) {
        // Handle memory allocation failure.
        return;
      }

      glyf_table = (unsigned char *) malloc(glyf_table_size);
      if (!glyf_table) {
        free(loca_table);
        return;
      }

      // Populate loca_table and glyf_table with data from the font face.
      memcpy(loca_table, faceptr->loca_data, loca_table_size);
      memcpy(glyf_table, faceptr->glyf_data, glyf_table_size);

      // Ensure that num_glyphs is calculated correctly based on loca_table.
      num_glyphs = loca_table_size / sizeof(unsigned int);

      // Verify short_offset based on indexToLocFormat.
      if (short_offset == 1) {
        // Adjust num_glyphs for 2-byte offsets.
        num_glyphs *= 2;
      }