unsigned int current_glyph = 0;
for (unsigned int i = 0; i < this->num_ranges; i++)
{
  hb_codepoint_t start_sid = this->ranges[i].start;
  unsigned int sid_count = this->ranges[i].count;

  for (unsigned int j = 0; j < sid_count && current_glyph < glyph_count; j++, current_glyph++)
  {
    hb_map_set(mapping, current_glyph, start_sid + j);
  }
  if (current_glyph >= glyph_count)
    break;
}