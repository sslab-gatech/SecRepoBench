for (unsigned int sid = 0; sid < num_glyphs; sid++)
{
  hb_codepoint_t glyph = get_glyph (sid, num_glyphs);
  if (glyph != 0)
    hb_map_set (mapping, glyph, sid);
  if (hb_map_get_population (mapping) == glyph_count)
    break;
}