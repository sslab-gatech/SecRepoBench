unsigned int glyph_idx = 0;
for (const auto &range : ranges)
{
  unsigned int start_sid = range.start_sid;
  unsigned int sid_count = range.sid_count;

  for (unsigned int i = 0; i < sid_count; ++i)
  {
    if (glyph_idx >= glyph_count)
      return;

    hb_map_set(mapping, glyph_idx, start_sid + i);
    ++glyph_idx;
  }
}