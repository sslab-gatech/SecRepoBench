{
    unsigned int glyph_id = 0;

    for (hb_map_t::const_iterator_t it = ranges.begin (); it != ranges.end () && glyph_id < glyph_count; ++it)
    {
      hb_codepoint_t start_sid = it->first;
      unsigned int sid_count = it->second;

      for (unsigned int i = 0; i < sid_count && glyph_id < glyph_count; ++i)
      {
        mapping->set (glyph_id, start_sid + i);
        glyph_id++;
      }
    }
}