{
  unsigned int glyph_id = 0;

  for (unsigned int i = 0; i < ranges.length && glyph_id < glyph_count; i++)
  {
    const Range &range = ranges[i];
    hb_codepoint_t sid = range.first_sid;

    for (unsigned int j = 0; j < range.num_sids && glyph_id < glyph_count; j++, glyph_id++)
    {
      hb_map_set(mapping, glyph_id, sid + j);
    }
  }
}