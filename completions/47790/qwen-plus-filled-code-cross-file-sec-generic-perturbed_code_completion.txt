{
  hb_codepoint_t sid = 0;
  unsigned int glyph_id = 0;

  for (const auto &range : ranges)
  {
    hb_codepoint_t start_sid = range.start_sid;
    unsigned int num_sids = range.num_sids;

    for (unsigned int i = 0; i < num_sids && glyph_id < glyph_count; ++i, ++glyph_id)
    {
      sid = start_sid + i;
      mapping->set (glyph_id, sid);

      if (glyph_id >= glyph_count)
        break;
    }

    if (glyph_id >= glyph_count)
      break;
  }
}