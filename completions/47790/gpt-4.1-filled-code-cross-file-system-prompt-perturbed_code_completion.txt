unsigned int glyph = 0;
for (unsigned int i = 0; i < ranges.len; i++)
{
  const range_t &range = ranges[i];
  unsigned int sid = range.first_sid;
  unsigned int count = range.n_sids;

  for (unsigned int j = 0; j < count && glyph < glyph_count; j++, glyph++)
    mapping->set (glyph, sid + j);

  if (glyph >= glyph_count)
    break;
}