unsigned int glyph_index = 0;
  for (unsigned int i = 0; i < num_ranges && glyph_index < glyph_count; ++i)
  {
    unsigned int start_sid = sid_ranges[i].first;
    unsigned int num_sids = sid_ranges[i].second;

    if (start_sid == 0 || num_sids == 0)
      continue;

    for (unsigned int sid_index = 0; sid_index < num_sids && glyph_index < glyph_count; ++sid_index)
    {
      unsigned int sid = start_sid + sid_index;
      hb_map_set (mapping, glyph_index, sid);
      glyph_index++;
    }
  }