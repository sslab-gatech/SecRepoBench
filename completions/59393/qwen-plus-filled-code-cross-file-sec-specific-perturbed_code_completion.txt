if (buffer == NULL || length <= 0) {
  return 0;
}

for(int i = 0; i < length; ++i) {
  if(buffer[i] == 'x' && 
     i + 4 < length && 
     memcmp(&buffer[i], "xn--", 4) == 0) {
    return 1;
  }
}

return 0;