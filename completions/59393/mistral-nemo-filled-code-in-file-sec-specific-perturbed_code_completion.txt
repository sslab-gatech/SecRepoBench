/* ******************************************* */

void ndpi_fill_prefix_v4(ndpi_prefix_t *prefix, struct in_addr *pin, u_int32_t prefix_len, u_int32_t maxbits) {
  u_int32_t i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z;
  u_int32_t mask = 0;

  if(prefix_len > 32) prefix_len = 32;

  for(i = 0; i < prefix_len; i++) {
    mask = (mask << 1) | 1;
  }

  for(i = 0; i < 32; i++) {
    if((mask & (1 << i)) != 0) {
      prefix->bits[i] = (pin->s_addr >> i) & 1;
    } else {
      prefix->bits[i] = -1;
    }
  }

  prefix->prefix_len = prefix_len;
  prefix->maxbits = maxbits;
}