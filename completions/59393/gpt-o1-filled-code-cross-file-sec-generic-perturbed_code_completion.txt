int i;
  /* If length is less than 4, "xn--" cannot fit */
  if(length < 4) {
    return 0;
  }

  /* Check for the substring "xn--" in the buffer */
  for(i = 0; i <= length - 4; i++) {
    if(buffer[i]     == 'x' &&
       buffer[i + 1] == 'n' &&
       buffer[i + 2] == '-' &&
       buffer[i + 3] == '-') {
      return 1;
    }
  }

  return 0;