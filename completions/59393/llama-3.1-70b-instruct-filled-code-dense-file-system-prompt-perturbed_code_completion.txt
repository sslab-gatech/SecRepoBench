int found = 0;
char *punycode_seq = "xn--";
int seq_len = strlen(punycode_seq);

for (int i = 0; i < length - seq_len + 1; i++) {
  if (ndpi_match_prefix((const u_int8_t *)&buffer[i], length - i, punycode_seq, seq_len)) {
    found = 1;
    break;
  }
}

return found;