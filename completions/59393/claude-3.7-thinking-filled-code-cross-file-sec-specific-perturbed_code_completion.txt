// Check for NULL buffer or insufficient length for punycode prefix
  if(buffer == NULL || length < 4)
    return 0;

  // Search through the buffer for "xn--" sequence
  for(int i = 0; i <= length - 4; i++) {
    if(buffer[i] == 'x' && buffer[i+1] == 'n' && buffer[i+2] == '-' && buffer[i+3] == '-') {
      return 1;
    }
  }

  return 0;