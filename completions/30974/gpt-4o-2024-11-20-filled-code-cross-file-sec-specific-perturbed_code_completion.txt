int64_t off_start_offset = header_len + cbytes;
    if (off_start_offset < 0 || off_start_offset >= container->len) {
      BLOSC_TRACE_ERROR("Invalid offset for the start of offsets in the frame.");
      return NULL;
    }

    uint8_t* off_start = container->cframe + off_start_offset;

    if (off_cbytes != NULL) {
      if (off_start + BLOSC2_CHUNK_CBYTES > container->cframe + container->len) {
        BLOSC_TRACE_ERROR("Invalid access to offsets in the frame.");
        return NULL;
      }
      *off_cbytes = *(int32_t*)(off_start + BLOSC2_CHUNK_CBYTES);
    }