// <MASK>
uint64_t nBytes = (static_cast<uint64_t>(nBits) + 7) / 8;
if (ptr + nBytes > compressed + nCompressed)
{
    return EXR_ERR_CORRUPT_CHUNK;
}

if (pctxt != NULL)
{
    rv = internal_exr_huf_decompress_with_context(
        pctxt, raw, nRaw, compressed, nBytes, spare, sparebytes);
}
else
{
    rv = internal_exr_huf_decompress_no_context(
        raw, nRaw, compressed, nBytes, spare, sparebytes);
}
// </MASK>